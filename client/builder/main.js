// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dojo/promise/all":function(){define(["../_base/array","../Deferred","../when"],function(p,f,b){var m=p.some;return function(l){var h,r;l instanceof Array?r=l:l&&"object"===typeof l&&(h=l);var n,g=[];if(h){r=[];for(var e in h)Object.hasOwnProperty.call(h,e)&&(g.push(e),r.push(h[e]));n={}}else r&&(n=[]);if(!r||!r.length)return(new f).resolve(n);var c=new f;c.promise.always(function(){n=g=null});var a=r.length;m(r,function(e,v){h||g.push(v);b(e,function(e){c.isFulfilled()||(n[g[v]]=
e,0===--a&&c.resolve(n))},c.reject);return c.isFulfilled()});return c.promise}})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(p,f){p.cookie=function(b,m,l){var h=document.cookie,r;if(1==arguments.length)r=(r=h.match(new RegExp("(?:^|; )"+f.escapeString(b)+"\x3d([^;]*)")))?decodeURIComponent(r[1]):void 0;else{l=l||{};h=l.expires;if("number"==typeof h){var n=new Date;n.setTime(n.getTime()+864E5*h);h=l.expires=n}h&&h.toUTCString&&(l.expires=h.toUTCString());m=encodeURIComponent(m);
var h=b+"\x3d"+m,g;for(g in l)h+="; "+g,n=l[g],!0!==n&&(h+="\x3d"+n);document.cookie=h}return r};p.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return p.cookie})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(p,f){var b={};f.setObject("dojo.regexp",
b);b.escapeString=function(b,f){return b.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(b){return f&&-1!=f.indexOf(b)?b:"\\"+b})};b.buildGroupRE=function(f,l,h){if(!(f instanceof Array))return l(f);for(var r=[],n=0;n<f.length;n++)r.push(l(f[n]));return b.group(r.join("|"),h)};b.group=function(b,f){return"("+(f?"?:":"")+b+")"};return b})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c){function a(a,c){a.canDelete&&d._remove(a.id,c.options.frameDoc,!0)}function u(a){z&&z.length&&(l.forEach(z,function(a){d._remove(a.id,a.frameDoc);a.frameDoc=null}),z=[]);return a.options.jsonp?!a.data:!0}function v(a){return!!this.scriptLoaded}function q(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function k(a,d){if(this.canDelete){var c=this.response.options;z.push({id:this.id,frameDoc:c.ioArgs?c.ioArgs.frameDoc:c.frameDoc});c.ioArgs&&
(c.ioArgs.frameDoc=null);c.frameDoc=null}d?this.reject(d):this.resolve(a)}function d(c,e,g){var n=b.parseArgs(c,b.deepCopy({},e));c=n.url;e=n.options;var l=b.deferred(n,a,u,e.jsonp?null:e.checkString?q:v,k);h.mixin(l,{id:w+t++,canDelete:!1});e.jsonp&&((new RegExp("[?\x26]"+e.jsonp+"\x3d")).test(c)||(c+=(~c.indexOf("?")?"\x26":"?")+e.jsonp+"\x3d"+(e.frameDoc?"parent.":"")+w+"_callbacks."+l.id),l.canDelete=!0,y[l.id]=function(a){n.data=a;l.handleResponse(n)});b.notify&&b.notify.emit("send",n,l.promise.cancel);
if(!e.canAttach||e.canAttach(l)){var m=d._attach(l.id,c,e.frameDoc);if(!e.jsonp&&!e.checkString)var z=r(m,x,function(a){if("load"===a.type||A.test(m.readyState))z.remove(),l.scriptLoaded=a})}r.once(m,"error",function(a){l.reject(a);d._remove(l.id,e.frameDoc,!0)});f(l);return g?l:l.promise}e.add("script-readystatechange",function(a,d){return"undefined"!==typeof d.createElement("script").onreadystatechange&&("undefined"===typeof a.opera||"[object Opera]"!==a.opera.toString())});var w=p.id.replace(/[\/\.\-]/g,
"_"),t=0,x=e("script-readystatechange")?"readystatechange":"load",A=/complete|loaded/,y=m.global[w+"_callbacks"]={},z=[];d.get=d;d._attach=function(a,d,e){e=e||c.doc;var b=e.createElement("script");b.type="text/javascript";b.src=d;b.id=a;b.async=!0;b.charset="utf-8";return e.getElementsByTagName("head")[0].appendChild(b)};d._remove=function(a,d,c){g.destroy(n.byId(a,d));y[a]&&(c?y[a]=function(){delete y[a]}:delete y[a])};d._callbacksProperty=w+"_callbacks";return d})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/on dojo/json dojo/cookie dojo/number dojo/date/locale dojo/i18n!dojo/cldr/nls/number dojox/encoding/base64 esri/lang esri/arcgis/utils esri/dijit/PopupTemplate esri/SpatialReference esri/geometry/Extent esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters esri/tasks/FeatureSet esri/symbols/PictureMarkerSymbol esri/urlUtils esri/request esri/tasks/query esri/tasks/QueryTask esri/graphicsUtils jimu/portalUrlUtils ./shared/utils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J,L,P,Q,H,K,V,S){function ba(a,d){a=a||"";for(var c=0,e=[{test:window.File&&window.FileReader&&window.FileList&&window.Blob||!D.file.isEnabledFlash(),failure:[a+"libs/polyfills/fileAPI/FileAPI.js"],callback:function(){c++;c===e.length&&d()}}],b=0;b<e.length;b++)testLoad(e[b])}function N(a,d){var c=a.match(/url\([^)]+\)/gi),e,b;if(null===c||""===d)return a;for(e=0;e<c.length;e++)if(b=c[e].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),4<=
b.length){var k=b[2];d.endWith("/")||(d+="/");a=a.replace(b[1]+k+b[3],b[1]+d+k+b[3])}return a}function M(a,d){var c=Array.isArray(d),e=c&&[]||{};c?(a=a||[],e=e.concat(a),d.forEach(function(d,c){"undefined"===typeof a[c]?e[c]=d:"object"===typeof d?e[c]=M(a[c],d):-1===a.indexOf(d)&&e.push(d)})):(a&&"object"===typeof a&&Object.keys(a).forEach(function(d){e[d]=a[d]}),Object.keys(d).forEach(function(c){e[c]="object"===typeof d[c]&&d[c]?a[c]?M(a[c],d[c]):d[c]:d[c]}));return e}function W(a,d,c){function e(a,
d){return p.isArray(a[d.key])?a[d.key][d.index]:a[d.key]}d=function(a){var d=[];a.split("_").forEach(function(a){var c=!1,e;"--"===a.slice(a.length-2)&&(c=!0,a=a.slice(0,a.length-2));e=a.search(/\[[0-9]+\]/);-1===e&&(e=a.length);d.push({key:a.slice(0,e),index:Number(a.slice(e+1,-1)),deleteFlag:c})});return d}(d);for(var b=1;b<d.length-1;b++)if(a=e(a,d[b]),!a)return;if(d[d.length-1].deleteFlag)!0===c&&(p.isArray(a[d[d.length-1].key])?delete a[d[d.length-1].key][d[d.length-1].index]:delete a[d[d.length-
1].key]);else if(p.isArray(a[d[d.length-1].key])){if(void 0===c)return a[d[d.length-1].key][d[d.length-1].index];a[d[d.length-1].key][d[d.length-1].index]=c}else{if(void 0===c)return a[d[d.length-1].key];a[d[d.length-1].key]=c}}function ga(a,d,c){function e(c){c=D.template.getSearchRange(d,c,"]");var e=d.slice(c.firstPos,c.lastPos);return-1!==c.firstPos?(e=d.slice(c.firstPos+e.indexOf("[")+1,c.lastPos-1),c=d.slice(c.lastPos+1),(e=D.getConfigElementById(a,e))?{object:e,key:"section_"+c,state:"isSection"}:
{state:"deleted"}):{state:"isNotSection"}}var b=a,k=d=d.replace(/\//g,"_"),t=e("groups\\[.+\\]");if("deleted"!==t.state&&("isSection"===t.state&&(b=t.object,k=t.key),t=e("widgets\\[.+\\]"),"delete"!==t.state))return"isSection"===t.state&&(b=t.object,k=t.key),W(b,k,c)}var D={},ja={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"};p.mixin(D,S);window.atob||(window.atob=function(a){a=k.decode(a);for(var d="",c=0,e=a.length;c<e;c++)d+=String.fromCharCode(a[c]);
return d});window.btob||(window.btob=function(a){for(var d=[],c=0,e=a.length;c<e;c++)d.push(String.charCodeAt(a[c]));return k.encode(d)});var na="unload",ca=[];require.on("error",function(a){f.forEach(ca,function(d){a.info[0]&&-1<a.info[0].indexOf(d.resKey)&&d.def.reject(a);for(var c in a.info)-1<c.indexOf(d.resKey)&&d.def.reject(a)})});D.checkError=function(a,d){ca.push({resKey:a,def:d})};D.replacePlaceHolder=function(a,d){var e=c.stringify(a),b=e.match(/\$\{(\w)+\}/g),k;if(null===b)return a;for(k=
0;k<b.length;k++){var t=b[k].match(/(\w)+/g)[0];d[t]&&(e=e.replace(b[k],d[t]))}return c.parse(e)};D.changeUnit=function(a){var d=Math.abs(a),c;a=Math.floor(d);c=Math.floor(60*(d-a));d=(60*(60*(d-a)-c)).toFixed(2);return a+"\u00b0"+(10>c?"0"+c:c)+"'"+(10>d?"0"+d:d)+'"'};D.formatTime=function(a){var d=a/1E3;a=Math.floor(d/60);d=Number(d-60*a).toFixed(1);return(10>a?"0"+a:a)+":"+(10>d?"0"+d:d)};D.parseTime=function(a){var d=/(\d{2,})\:(\d{2})\.(\d{1})/;if(!d.test(a))return console.log("wrong time format."),
-1;a=a.match(d);return 1E3*(60*parseInt(a[1],10)+parseInt(a[2],10)+parseInt(a[3],10)/10)};D.preloadImg=function(a,d){var c=[],c="string"===typeof a?[a]:a;f.forEach(c,function(a){(new Image).src=d?d+a:a})};var ea=null;D.getImagesSize=function(a){var d=new g;if(!a||0!==a.indexOf("http"))return d.reject(),d;null===ea&&(ea=b.create("img",{id:"__test-image-size",style:{position:"absolute",left:"-9999px",top:"-9999px"}},document.body));var c=e(ea,"load",function(){clearTimeout(k);k=null;c.remove();var a=
b.getContentBox(ea);1===a.w&&1===a.h||0===a.w||0===a.h?d.reject():d.resolve([a.w,a.h])},{}),k=setTimeout(function(){clearTimeout(k);k=null;d.reject()},5E3);b.setAttr(ea,"src",a);return d};D.getPositionStyle=function(a){var d={};if(!a)return d;a=p.clone(a);if(window.isRTL){var c;"undefined"!==typeof a.left&&"undefined"!==typeof a.right?(c=a.left,a.left=a.right,a.right=c):"undefined"!==typeof a.left?(a.right=a.left,delete a.left):"undefined"!==typeof a.right&&(a.left=a.right,delete a.right);"undefined"!==
typeof a.paddingLeft&&"undefined"!==typeof a.paddingRight?(c=a.paddingLeft,a.paddingLeft=a.paddingRight,a.paddingRight=c):"undefined"!==typeof a.paddingLeft?(a.paddingRight=a.paddingLeft,delete a.paddingLeft):"undefined"!==typeof a.paddingRight&&(a.paddingLeft=a.paddingRight,delete a.paddingRight)}c="left top right bottom width height padding paddingLeft paddingRight paddingTop paddingBottom".split(" ");for(var e=0;e<c.length;e++){var b=c[e];"number"===typeof a[b]?d[b]=a[b]+"px":"undefined"!==typeof a[b]?
d[b]=a[b]:"padding"===b.substr(0,7)?d[b]=0:d[b]="auto"}d.zIndex="undefined"===typeof a.zIndex?"auto":a.zIndex;return d};D.isEqual=function(a,d){function c(a,d){var k;if(null===a&&null===d||"undefined"===typeof a&&"undefined"===typeof d)return!0;if(null===a&&null!==d||null===d&&null!==a||"undefined"===typeof a&&"undefined"!==typeof d||"undefined"===typeof d&&"undefined"!==typeof a)return!1;if(isNaN(a)&&isNaN(d)&&"number"===typeof a&&"number"===typeof d||a===d)return!0;if("function"===typeof a&&"function"===
typeof d||a instanceof Date&&d instanceof Date||a instanceof RegExp&&d instanceof RegExp||a instanceof String&&d instanceof String||a instanceof Number&&d instanceof Number)return a.toString()===d.toString();if(-1<e.indexOf(a)||-1<b.indexOf(d))return!1;if(null!==d){for(k in d)if(d.hasOwnProperty(k)!==a.hasOwnProperty(k)||typeof d[k]!==typeof a[k])return!1;for(k in a){if(d.hasOwnProperty(k)!==a.hasOwnProperty(k)||typeof d[k]!==typeof a[k])return!1;switch(typeof a[k]){case "object":case "function":e.push(a);
b.push(d);if(!c(a[k],d[k]))return!1;e.pop();b.pop();break;default:if(isNaN(a[k])&&isNaN(d[k])&&"number"===typeof a[k]&&"number"===typeof d[k])return!0;if(a[k]!==d[k])return!1}}}return!0}var e,b;e=[];b=[];return c(a,d)?!0:!1};D.file={loadFileAPI:function(){var a=new g;if("unload"===na){var d=window.isBuilder?"stemapp/":"";window.FileAPI={debug:!1,flash:!0,staticPath:d+"libs/polyfills/fileAPI/",flashUrl:d+"libs/polyfills/fileAPI/FileAPI.flash.swf",flashImageUrl:d+"libs/polyfills/fileAPI/FileAPI.flash.image.swf"};
ba(d,p.hitch(this,function(){na="loaded";a.resolve()}));na="loading"}else"loaded"===na&&a.resolve();return a},supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return m("safari")&&6>m("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var a=null;if(document.all)try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(ha){a=null}else navigator.plugins&&0<navigator.plugins.length&&
(a=navigator.plugins["Shockwave Flash"]);return!!a},containSeparator:function(a){return 0<=a.indexOf("/")?!0:0<=a.indexOf("\\")?!0:!1},getNameFromPath:function(a){var d="",d=0<=a.indexOf("/")?"/":"\\";a=a.split(d);return 0<a.length?a[a.length-1]:null},getFolderFromPath:function(a){return a.substr(0,a.length-D.file.getNameFromPath(a).length)},readFile:function(a,d,c,e){if(this.supportHTML5()){var b=a.target.files[0];b&&(b.type.match(d)?b.size>=c?e({errCode:"exceed"}):(a=new FileReader,a.onload=function(a){e(null,
b.name,a.target.result)},a.readAsDataURL(b)):e({errCode:"invalidType"}))}else if(this.supportFileAPI()){var k=window.FileAPI.getFiles(a);k[0].type.match(d)?k[0].size>=c?e({errCode:"exceed"}):window.FileAPI.readAsDataURL(k[0],function(a){a&&a.result?e(null,k[0].name,a.result):e({errCode:"readError"})}):e({errCode:"invalidType"})}}};D.getUriInfo=function(a){var d,c={};d=a.indexOf("/");a.substring(0,d);d=a.substring(0,a.lastIndexOf("/")+1);c.folderUrl=require(D.getRequireConfig()).toUrl(d);c.amdFolder=
d;c.url=c.folderUrl;if(/^http(s)?:\/\//.test(a)||/^\/\//.test(a))c.isRemote=!0;return c};D.widgetJson=function(){return{addManifest2WidgetJson:function(a,d){p.mixin(a,d.properties);a.name=d.name;a.label||(a.label=d.label);a.manifest=d;a.isRemote=d.isRemote;a.isRemote&&(a.itemId=d.itemId);d.featureActions&&(a.featureActions=d.featureActions);a.icon||(a.icon=d.icon);a.thumbnail||(a.thumbnail=d.thumbnail);a.folderUrl=d.folderUrl;a.amdFolder=d.amdFolder},removeManifestFromWidgetJson:function(a){if(a.manifest){for(var d in a.manifest.properties)a[d]=
void 0;a.name=void 0;a.label=void 0;a.featureActions=void 0;a.manifest=void 0}}}}();D.getRequireConfig=function(){if(jimuConfig){var a=[];jimuConfig.widgetsPackage&&(a=a.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(a=a.concat(jimuConfig.themesPackage));jimuConfig.configsPackage&&(a=a.concat(jimuConfig.configsPackage));return{packages:a}}return{}};D.getTypeByGeometryType=function(a){var d="",c="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),
e=["esriGeometryRing","esriGeometryPolygon","esriGeometryEnvelope"];0<=["esriGeometryPoint","esriGeometryMultipoint"].indexOf(a)?d="point":0<=c.indexOf(a)?d="polyline":0<=e.indexOf(a)&&(d="polygon");return d};D.getSymbolTypeByGeometryType=function(a){var d=null;a=D.getTypeByGeometryType(a);"point"===a?d="marker":"polyline"===a?d="line":"polygon"===a&&(d="fill");return d};D.getServices=function(){return ja};D.getArcGISDefaultGeometryService=function(){return new E(ja.geometryService)};D.restoreToDefaultWebMapExtent=
function(a,d,c){var e=new g;if(!a||"esri.Map"!==a.declaredClass)return setTimeout(function(){e.reject("Invalid map.")},0),e;d=d&&d.itemInfo;if(!d)return setTimeout(function(){e.reject("Invalid itemInfo")},0),e;d=d.item&&d.item.extent;if(!d)return setTimeout(function(){e.reject("Invalid itemInfo.item.extent")}),e;var b=new x({wkid:4326}),b=new A(d[0][0],d[0][1],d[1][0],d[1][1],b);if(4326===parseInt(a.spatialReference.wkid,10))return a.setExtent(b);if(a.spatialReference.isWebMercator())return b=B.geographicToWebMercator(b),
a.setExtent(b);d=new G;d.geometries=[b];d.outSR=a.spatialReference;b=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService;b&&"esri.tasks.GeometryService"===b.declaredClass||(c&&"string"===typeof c&&p.trim(c)?(c=p.trim(c),b=new E(c)):b=D.getArcGISDefaultGeometryService());b.project(d).then(function(d){if(d=d&&d[0])return a.setExtent(d);e.reject("Invalid projected geometry.");return e},function(a){console.error(a);e.reject(a);return e});return e};D.getAncestorWindow=function(){for(var a=
window;a&&a.parent&&a!==a.parent;)a=a.parent;return a};D.getAncestorDom=function(a,d,c){if(a&&1===a.nodeType&&d&&"function"===typeof d){var e=100,k=document.body;c&&("number"===typeof c?(c=parseInt(c,10),0<c&&(e=c)):1===c.nodeType&&(k=c));for(c=0;a.parentNode&&c<e&&b.isDescendant(a.parentNode,k);){if(d(a.parentNode))return a.parentNode;a=a.parentNode;c++}}return null};D.bindClickAndDblclickEvents=function(a,d,c,b){var k=null;if(a&&1===a.nodeType&&d&&"function"===typeof d&&c&&"function"===typeof c){var t=
200;b&&"number"===typeof b&&(b=parseInt(b,10),0<b&&(t=b));var q=0,k=e(a,"click",function(a){q++;1===q?setTimeout(function(){1===q&&(q=0,d(a))},t):2===q&&(q=0,c(a))})}return k};D.isScrollToBottom=function(a){var d=b.getContentBox(a);return 1>a.scrollHeight-(a.scrollTop+d.h)};D.getAllItemTypes=function(){var a=[],a=a.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service",
"Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application","Mobile Application","Code Attachment","Operations Dashboard Add In","Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return a=a.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer",
"Layer Package","Explorer Layer"]).concat(["Geoprocessing Package","Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};D.getItemQueryStringByTypes=function(a){var d="",c=D.getAllItemTypes();if(a&&0<a.length&&0<a.length){var e="";f.forEach(a,function(d,c){e+=' type:"'+d+'" ';c!==a.length-1&&(e+=" OR ")});d=" ( "+e+" ) ";c=a.concat(c);c=f.filter(c,function(d){return f.every(a,
function(a){return 0>a.toLowerCase().indexOf(d.toLowerCase())})});f.forEach(c,function(a){d+=' -type:"'+a+'" '})}return d};D.getItemQueryStringByTypeKeywords=function(a){var d="";a&&0<a.length&&(d=' typekeywords:"'+a.join(",")+'" ');return d};D.isNotEmptyString=function(a,d){var c=a&&"string"===typeof a;return c?d?c&&p.trim(a):!0:!1};D.isValidNumber=function(a){return"number"===typeof a&&!isNaN(a)};D.isObject=function(a){return a&&"object"===typeof a};D.createWebMap=function(a,d,c,e){a=V.getStandardPortalUrl(a);
a=V.getBaseItemUrl(a);w.arcgisUrl=a;return w.createMap(d,c,e)};D.getRandomString=function(){var a=Math.random().toString();return a=a.slice(2,a.length)};D._getDomainsByServerName=function(a){var d=a.split("."),c=d.length;return f.map(d,p.hitch(this,function(a,e){var b=d.slice(e,c),k="",t=b.length-1;f.forEach(b,p.hitch(this,function(a,d){k+=a;d!==t&&(k+=".")}));return k}))};D.removeCookie=function(d,c){var e=this._getDomainsByServerName(window.location.hostname);f.forEach(e,p.hitch(this,function(e){a(d,
null,{expires:-1,path:c});a(d,null,{expires:-1,path:c,domain:e});a(d,null,{expires:-1,path:c,domain:"."+e})}))};D.isLocaleChanged=function(a,d){return!a.startWith(d)};D.hashToObject=function(a){a=a.replace("#","");a=h.queryToObject(a);for(var d in a)if(a.hasOwnProperty(d))try{a[d]=c.parse(a[d])}catch(oa){}return a};D.reCreateObject=function(a){function d(a){var e=[];a.forEach(function(a){Array.isArray(a)?e.push(d(a)):"object"===typeof a?e.push(c(a)):e.push(a)});return e}function c(a){var e={},b;for(b in a)a.hasOwnProperty(b)&&
(null===a[b]?e[b]=null:Array.isArray(a[b])?e[b]=d(a[b]):e[b]="object"===typeof a[b]?c(a[b]):a[b]);return e}return Array.isArray(a)?d(a):c(a)};D.setVerticalCenter=function(a){setTimeout(function(){var d=r(".jimu-vcenter-text",a),c,e;f.forEach(d,function(a){c=b.getContentBox(a).h;b.setStyle(a,{lineHeight:c+"px"})},this);d=r(".jimu-vcenter",a);f.forEach(d,function(a){c=b.getContentBox(a).h;e=b.getContentBox(r(a).parent()[0]).h;b.setStyle(a,{marginTop:(e-c)/2+"px"})},this)},10)};D.merge=M;D.loadStyleLink=
function(a,d,c){var k=new g,t,q=require(D.getRequireConfig()).toUrl(d);if(require.cache["url:"+q]){t=require.cache["url:"+q];var w=q.split("/").pop(),q=q.substr(0,q.length-w.length);t=N(t,q);a=c?b.create("style",{id:a,type:"text/css"},b.byId(c),"before"):b.create("style",{id:a,type:"text/css"},document.getElementsByTagName("head")[0]);a.styleSheet&&!a.sheet?a.styleSheet.cssText=t:a.appendChild(b.toDom(t));k.resolve("load");return k}t=c?b.create("link",{id:a,rel:"stylesheet",type:"text/css",href:q+
"?wab_dv\x3d"+window.deployVersion},b.byId(c),"before"):b.create("link",{id:a,rel:"stylesheet",type:"text/css",href:q+"?wab_dv\x3d"+window.deployVersion},document.getElementsByTagName("head")[0]);e(t,"load",function(){k.resolve("load")});var u=setInterval(function(){var a;if(f.some(document.styleSheets,function(c){if(c.href&&c.href.substr(c.href.indexOf(d),c.href.length)===d)return a=c,!0}))try{!k.isFulfilled()&&(a.cssRules&&a.cssRules.length||a.rules&&a.rules.length)&&k.resolve("load"),clearInterval(u)}catch(Ba){}},
50);return k};D.changeLocation=function(a){window.history.pushState&&window.history.pushState({path:a},"",a)};D.urlToObject=function(a){var d=null;-1===a.indexOf("#")?(d=L.urlToObject(a),d.hash=null):(a=a.split("#"),d=L.urlToObject(a[0]),d.hash=a[1]?-1<a[1].indexOf("\x3d")?h.queryToObject(a[1]):a[1]:null);return d};D.manifest=function(){function a(a){a.panels.forEach(function(a){a.uri="panels/"+a.name+"/Panel.js"});a.styles.forEach(function(a){a.uri="styles/"+a.name+"/style.css"});a.layouts.forEach(function(a){a.uri=
"layouts/"+a.name+"/config.json";a.icon="layouts/"+a.name+"/icon.png";a.RTLIcon="layouts/"+a.name+"/icon_rtl.png"})}return{addManifestProperies:function(d){d.icon||(d.icon=d.folderUrl+"images/icon.png?wab_dv\x3d"+window.deployVersion);d.thumbnail||(d.thumbnail=d.folderUrl+"images/thumbnail.png");"theme"===d.category?a(d):("undefined"!==typeof d["2D"]&&(d.support2D=d["2D"]),"undefined"!==typeof d["3D"]&&(d.support3D=d["3D"]),"undefined"===typeof d["2D"]&&"undefined"===typeof d["3D"]&&(d.support2D=
!0),delete d["2D"],delete d["3D"],"undefined"===typeof d.properties&&(d.properties={}),S.processWidgetProperties(d))},processManifestLabel:function(a,d){var c=d.split("-")[0];a.label=a.i18nLabels&&(a.i18nLabels[d]||a.i18nLabels[c]||a.i18nLabels.defaultLabel)||a.label||a.name;a.layouts&&f.forEach(a.layouts,function(c){var e="i18nLabels_layout_"+c.name;c.label=a[e]&&(a[e][d]||a[e].defaultLabel)||c.label||c.name});a.styles&&f.forEach(a.styles,function(c){var e="i18nLabels_style_"+c.name;c.label=a[e]&&
(a[e][d]||a[e].defaultLabel)||c.label||c.name})},addI18NLabel:function(a){var d=new g;if(a.i18nLabels)return d.resolve(a),d;a.i18nLabels={};if(a.properties&&!1===a.properties.hasLocale)return d.resolve(a),d;var c;c=a.isRemote?a.amdFolder+"nls/strings.js":a.amdFolder+"nls/strings";require(D.getRequireConfig(),["dojo/i18n!"+c],function(c){var e={};e[dojoConfig.locale]=c;S.addI18NLabelToManifest(a,null,e);d.resolve(a)});return d}}}();D.getUniqueValues=function(a,d,c,e){return function(){var d=new g;
e?d.resolve(e):d=P({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});return d}().then(function(e){return D._getUniqueValues(a,d,c,e).then(function(a){var c=[],c=D.getFieldInfoByFieldName(e.fields,d),b=null,k=0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(c.type);c&&(k&&(a=f.map(a,function(a){a=parseFloat(a);isNaN(a)&&(a=null);return a})),c.domain&&c.domain.codedValues&&0<c.domain.codedValues.length?
(b={},f.forEach(c.domain.codedValues,function(a){b[a.code]=a.name})):e.typeIdField===d&&(b={},f.forEach(e.types,function(a){b[a.id]=a.name})));return c=f.map(a,function(a){var d=null,d=null===a||void 0===a?"\x3cNull\x3e":b&&b.hasOwnProperty(a)?b[a]:k?D.localizeNumber(a):a;return{value:a,label:d}})})})};D._getUniqueValues=function(a,d,c,e){var b=new g;a=a.replace(/\/*$/g,"");c||(c="1\x3d1");/\/ImageServer$/gi.test(a)?b=D._getUniqueValuesByQueryTask(a,d,c):(b=D.getFieldInfoByFieldName(e.fields,d),b=
0<D._getCodedValuesOrTypesCount(b,e)?D._getUniqueValuesByQueryTask(a,d,c):D._getUniqueValuesByGenerateRenderer(a,d,c));return b};D._getCodedValuesOrTypesCount=function(a,d){if(a){if(a.domain&&"codedValue"===a.domain.type&&a.domain.codedValues)return a.domain.codedValues.length;if(d.typeIdField===a.name&&d.types)return d.types.length}return 0};D._getUniqueValuesByQueryTask=function(a,d,c){var e=new Q;e.where=c;e.returnDistinctValues=!0;e.returnGeometry=!1;e.outFields=[d];return(new H(a)).execute(e).then(function(a){var c=
[];a.features&&0<a.features.length&&f.forEach(a.features,function(a){a&&a.attributes&&c.push(a.attributes[d])});return c})};D._getUniqueValuesByGenerateRenderer=function(a,d,e){var b=new g;a=a.replace(/\/*$/g,"")+"/generateRenderer";d=c.stringify({type:"uniqueValueDef",uniqueValueFields:[d]});P({url:a,content:{classificationDef:d,f:"json",where:e},handleAs:"json",callbackParamName:"callback"}).then(p.hitch(this,function(a){var d=[];(a=a&&a.uniqueValueInfos)&&0<a.length&&(d=f.map(a,p.hitch(this,function(a){return a.value})));
b.resolve(d)}),p.hitch(this,function(a){b.reject(a)}));return b};D.isCodedValuesSupportFilter=function(a,d){var c=parseFloat(a.currentVersion);return d<=parseFloat(a.maxRecordCount)&&10.1<c};D.combineRadioCheckBoxWithLabel=function(a,d){var c=!1;if(a&&1===a.nodeType&&"input"===a.tagName.toLowerCase()){var e=a.getAttribute("type")||"",e=e.toLowerCase();if("radio"===e||"checkbox"===e)c=!0}e=!1;d&&1===d.nodeType&&"label"===d.tagName.toLowerCase()&&(e=!0);c&&e&&(c=a.getAttribute("id"),c||(c="input_"+
D.getRandomString(),a.setAttribute("id",c)),d.setAttribute("for",c),b.setStyle(d,"cursor","pointer"))};D.groupRadios=function(a,d){var c=[],b="radiogroup_"+D.getRandomString();f.forEach(a,function(a){a.name=b;d&&(a=e(a,"change",d),c.push(a))});return c};D.convertExtentToPolygon=function(a){var d=a.xmin,c=a.xmax,e=a.ymin,b=a.ymax;return new C({rings:[[[d,b],[c,b],[c,e],[d,e],[d,b]]],spatialReference:a.toJson()})};D.combineGeometries=function(a){function d(a){var d={points:[],spatialReference:a[0].spatialReference.toJson()};
f.forEach(a,function(a){"point"===a.type?d.points=d.points.concat([[a.x,a.y]]):"multipoint"===a.type&&(d.points=d.points.concat(a.points))});return new y(d)}function c(a){var d={paths:[],spatialReference:a[0].spatialReference.toJson()};f.forEach(a,function(a){d.paths=d.paths.concat(a.paths)});return new z(d)}function e(a){var d={rings:[],spatialReference:a[0].spatialReference.toJson()};f.forEach(a,function(a){"polygon"===a.type?d.rings=d.rings.concat(a.rings):"extent"===a.type&&(a=D.convertExtentToPolygon(a),
d.rings=d.rings.concat(a.rings))});return new C(d)}var b=null;if(a&&0<a.length)if(1===a.length)b=a[0];else{for(var k=null,t=null,q=null,w=null,g=0;g<a.length;g++){k=a[g];switch(k.type){case "point":case "multipoint":w="point";break;case "polyline":w="polyline";break;case "polygon":case "extent":w="polygon";break;default:return null}if(0===g)q=w;else if(q!==w)return null;if(g!==a.length-1&&(t=a[g+1],!k.spatialReference.equals(t.spatialReference)))return null}"point"===w?b=d(a):"polyline"===w?b=c(a):
"polygon"===w&&(b=e(a))}return b};D.combineGeometriesByGraphics=function(a){var d=null;a&&0<a.length&&(a=f.map(a,function(a){return a.geometry}),d=D.combineGeometries(a));return d};D.isFeaturelayerUrlSupportQuery=function(a,d){var c=!1,e=/\/featureserver\//gi.test(a),b=/\/mapserver\//gi.test(a);d=(d||"").toLowerCase();e?c=0<=d.indexOf("query"):b&&(c=0<=d.indexOf("data"));return c};D.isImageServiceSupportQuery=function(a){return 0<=(a||"").toLowerCase().indexOf("catalog")};D.isStringEndWith=function(a,
d){return a.lastIndexOf(d)+d.length===a.length};D.localizeNumber=function(a,d){var c=(a.toString().split(".")[1]||"").length,e="",e=d&&isFinite(d.places)&&d.places,e=0<e||0<c?"#,###,###,##0.0"+Array.prototype.join.call({length:0<e?e+1:c},"0"):"#,###,###,##0",c={locale:l.locale,pattern:e};p.mixin(c,d||{});try{return u.format(a,c)}catch(va){return console.error(va),a.toLocaleString()}};D.parseNumber=function(a,d){var c={locale:l.locale};p.mixin(c,d||{});try{return u.parse(a,c)}catch(la){return console.error(la),
a}};D.localizeDate=function(a,d){var c={locale:l.locale,fullYear:!0};p.mixin(c,d||{});try{return v.format(a,c)}catch(la){return console.error(la),"date"===c.selector?a.toLocaleDateString():"time"===c.selector?a.toLocaleTimeString():a.toLocaleString()}};D.localizeNumberByFieldInfo=function(a,d){var c=null,c=p.exists("format.places",d)&&d.format.places,c=D.localizeNumber(a,{places:c});return p.exists("format.digitSeparator",d)&&!d.format.digitSeparator?c.toString().replace(new RegExp("\\"+q.group,"g"),
""):c};D.localizeDateByFieldInfo=function(a,c){var e=null;try{var b={date:a instanceof Date?a.getTime():a},k=p.exists("format.dateFormat",c)?c.format.dateFormat:"longMonthDayYear",e=d.substitute(b,"${date}",{dateFormat:{properties:["date"],formatter:"DateFormat"+t.prototype._dateFormats[k]}})}catch(Ea){console.error(Ea),e=a}return e};D.fieldFormatter={getFormattedUrl:function(a){if(a&&"string"===typeof a){var d=a.indexOf("http:");-1===d&&(d=a.indexOf("https:"));if(-1<d&&-1===a.indexOf("href\x3d")){var c=
a.indexOf(" ",d);-1===c&&(c=a.length);var e=a.substring(d,c);a=a.substring(0,d)+'\x3cA href\x3d"'+e+'" target\x3d"_blank"\x3e'+e+"\x3c/A\x3e"+a.substring(c,a.length)}}return a||""},getFormattedNumber:function(a,d){if("number"===typeof a){var c=(a.toString().split(".")[1]||"").length;a=D.localizeNumberByFieldInfo(a,{format:{places:d&&"number"===typeof d.places?parseInt(d.places,10):c,digitSeparator:d&&d.digitSeparator}});return'\x3cspan class\x3d"jimu-numeric-value"\x3e'+(a||"")+"\x3c/span\x3e"}return a},
getFormattedDate:function(a,d){if("number"===typeof a||a instanceof Date)a=D.localizeDateByFieldInfo(a,{format:d});return a||""},getCodedValue:function(a,c){if(a&&a.codedValues){for(var e=0,b=a.codedValues.length;e<b;e++){var k=a.codedValues[e];if(d.isDefined(c)&&p.exists("code",k)&&c.toString()===k.code.toString())return k.name}return c}return c||null},getTypeName:function(a,d){for(var c=d.length,e=0;e<c;e++)if(a===d[e].id)return d[e].name;return a}};D.addRelativePathInCss=N;D.url={isAbsolute:function(a){return a?
a.startWith("http")||a.startWith("/"):!1},removeQueryParamFromUrl:function(a,d){var c=L.urlToObject(a);c.query&&delete c.query[d];var e=c.path,b;for(b in c.query)e=e===c.path?e+"?"+b+"\x3d"+c.query[b]:e+"\x26"+b+"\x3d"+c.query[b];return e},addQueryParamToUrl:function(a,d,c){a=L.urlToObject(a);a.query||(a.query={});a.query[d]=c;d=a.path;for(var e in a.query)d=d===a.path?d+"?"+e+"\x3d"+a.query[e]:d+"\x26"+e+"\x3d"+a.query[e];return d}};D.processUrlInWidgetConfig=function(a,d){if(a)return a.startWith("data:")||
a.startWith("http")||a.startWith("/")?a:a.startWith("${appPath}")?a.replace("${appPath}",window.appInfo.appPath):d+a};D.processUrlInAppConfig=function(a){if(a)return a.startWith("data:")||a.startWith("http")||a.startWith("/")?a:window.appInfo.appPath+a};D.getLocationUrlWithoutHashAndQueryParams=function(){var a=window.location,d=a.protocol+"//"+a.host+a.pathname,a=L.urlToObject(a.href);a.query&&a.query.apiurl&&(d=D.url.addQueryParamToUrl(d,"apiurl",a.query.apiurl));return d};D.getDefaultWebMapThumbnail=
function(){return require.toUrl("jimu/images/webmap.png")};D.invertColor=function(a){a=a.substring(1);3===a.length&&(a=a.slice(0,1)+a.slice(0,1)+a.slice(1,1)+a.slice(1,1)+a.slice(2,1)+a.slice(2,1));a=parseInt(a,16);return 7829367<a?"#000000":"#ffffff"};D.mixinAppConfigPosition=function(a,d){var c=p.clone(a);if(!d)return c;d=p.clone(d);var e=c.widgetOnScreen,b=d.widgetOnScreen;b&&b.widgets&&("[object Object]"===Object.prototype.toString.call(b.widgets)?f.forEach(e.widgets,function(a,d){var c;c=a.uri?
a.uri:"ph_"+d;b.widgets[c]&&b.widgets[c].position&&(b.widgets[c].position.relativeTo||(b.widgets[c].position.relativeTo="map"),a.position=b.widgets[c].position)},this):f.forEach(b.widgets,function(a,d){a.position&&!a.position.relativeTo&&(a.position.relativeTo="map");e.widgets[d]&&a.position&&(e.widgets[d].position=a.position)}));b&&b.groups&&("[object Object]"===Object.prototype.toString.call(b.groups)?f.forEach(e.groups,function(a,d){var c;c=a.label?a.label:"g_"+d;b.groups[c]&&b.groups[c].panel&&
b.groups[c].panel.position&&(b.groups[c].panel.position.relativeTo||(b.groups[c].panel.position.relativeTo="map"),a.panel.position=b.groups[c].panel.position)},this):f.forEach(b.groups,function(a,d){a.panel&&a.panel.position&&!a.panel.position.relativeTo&&(a.panel.position.relativeTo="map");e.groups[d]&&a.panel.position&&(e.groups[d].panel.position=a.panel.position)}));d.map&&d.map.position&&(c.map?c.map.position=d.map.position:c.map={position:d.map.position});d.widgetPool&&d.widgetPool.panel&&(d.widgetPool.panel.position&&
!d.widgetPool.panel.position.relativeTo&&(d.widgetPool.panel.position.relativeTo="map"),c.widgetPool.panel.position=d.widgetPool.panel.position);d.mobileLayout&&(c.mobileLayout=d.mobileLayout);return c};D.template={groupIdentification:"groups\\[.+\\]",widgetIdentification:"widgets\\[.+\\]",getSearchRange:function(a,d,c){var e=-1;d=a.search(new RegExp(d));0<=d&&(a=a.slice(d,a.length),a=a.indexOf(c),e=d+a+c.length);return{firstPos:d,lastPos:e}},setConfigValue:function(a,d,c){W(a,d,c)},getConfigValue:function(a,
d){return W(a,d)},setConfigValueWithId:function(a,d,c){ga(a,d,c)},getConfigValueWithId:function(a,d){return ga(a,d)},getKeyInfo:function(a){var d=this.getWidgetIdByKey(a);if(null!==d)return{type:"widget",id:d};a=this.getGroupIdByKey(a);return null!==a?{type:"group",id:a}:{type:"unknow",id:null}},getWidgetIdByKey:function(a){var d=D.template.getSearchRange(a,D.template.widgetIdentification,"]");if(-1===d.firstPos)a=null;else{var c=a.slice(d.firstPos,d.lastPos);a=a.slice(d.firstPos+c.indexOf("[")+1,
d.lastPos-1)}return a},getGroupIdByKey:function(a){var d=D.template.getSearchRange(a,D.template.groupIdentification,"]");if(-1===d.firstPos)a=null;else{var c=a.slice(d.firstPos,d.lastPos);a=a.slice(d.firstPos+c.indexOf("[")+1,d.lastPos-1)}return a},getConfigedWidgetsByTemplateConfig:function(a){var d=[],c=D.template.widgetIdentification+"_config",e;f.forEach(a.configurationSettings,function(a){f.forEach(a.fields,function(a){a.fieldName&&(e=D.template.getSearchRange(a.fieldName,c,"]"),0<=e.firstPos&&
(a=D.template.getWidgetIdByKey(a.fieldName),-1===d.indexOf(a)&&d.push(a)))},this)},this);return d},mergeTemplateAppConfigToAppConfig:function(a,d,c){function e(a){var d=[];f.forEach(a,function(a){a&&d.push(a)},this);return d}var b=a.widgetOnScreen,k=a.portalUrl;d.values.webmap&&(a.map.itemId=d.values.webmap);c&&(a.map.mapOptions&&D.deleteMapOptions(a.map.mapOptions),a.map.portalUrl=k,d.values.app_title||(d.values.app_title=c.title),d.values.app_subtitle||(d.values.app_subtitle=c.snippet));for(var t in d.values)"webmap"!==
t&&D.template.setConfigValueWithId(a,t,d.values[t]);a.widgetPool.widgets=e(a.widgetPool.widgets);b.widgets=e(b.widgets);if(a.widgetPool.groups)for(d=0;d<a.widgetPool.groups.length;d++)a.widgetPool.groups[d].widgets=e(a.widgetPool.groups[d].widgets);if(b.groups)for(d=0;d<b.groups.length;d++)b.groups[d].widgets=e(b.groups[d].widgets);return a}};D.deleteMapOptions=function(a){a&&(delete a.extent,delete a.lods,delete a.center,delete a.scale,delete a.zoom,delete a.maxScale,delete a.maxZoom,delete a.minScale,
delete a.minZoom)};D.graphicsExtent=function(a,d){var c=null;try{0<a.length&&(c=K.graphicsExtent(a))&&"number"===typeof d&&0<d&&(c=c.expand(d))}catch(la){console.error(la)}return c};D.sanitizeHTML=function(a){return html_sanitize(a,function(a){return a},function(a){return a})};D.stripHTML=function(a){return a?-1<a.indexOf("\x3c")&&-1<a.indexOf("\x3e")?a.replace(/<(?:.|\s)*?>/g,""):a:a};D.removeSuffixSlashes=function(a){return a.replace(/\/*$/g,"")};D.getBestDisplayAttributes=function(a,d){var c={},
e=null,b;for(b in a)e=D.getBestDisplayValue(b,a,d),c[b]=e;return c};D.getBestDisplayValue=function(a,d,c){var e="",b=null;p.isArrayLike(c)?b=D.getFieldInfoByFieldName(c,a):"object"===typeof c&&c.name===a&&(b=c);b&&(e=d[a],"esriFieldTypeDate"===b.type?e&&(a=new Date(parseInt(e,10)),e=D._tryLocaleDate(a)):"number"===typeof e&&(b.domain&&"codedValue"===b.domain.type?f.some(b.domain.codedValues,function(a){if(a.code===e)return e=a.name,!0}):e=D._tryLocaleNumber(e)));if(null===e||void 0===e)e="";return e};
D.getDefaultPortalFieldInfo=function(a){var d=a.name,d={fieldName:d,label:a.alias||d,tooltip:"",visible:!1,format:null,stringFieldOption:"textbox"};switch(a.type){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":d.format={places:0,digitSeparator:!0};break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":d.format={places:2,digitSeparator:!0};break;case "esriFieldTypeDate":d.format={dateFormat:"longMonthDayYear"}}return d};D._tryLocaleNumber=function(a){var d=D.localizeNumber(a);if(null===
d||void 0===d)d=a;return d};D._tryLocaleDate=function(a){var d=D.localizeDate(a);d||(d=a.toLocaleDateString());return d};D.getFieldInfoByFieldName=function(a,d){var c=null;a&&0<a.length&&f.some(a,p.hitch(this,function(a){return a.name===d?(c=a,!0):!1}));return c};D.containsNonLatinCharacter=function(a){for(var d=0;d<a.length;d++)if(255<a.charCodeAt(d))return!0;return!1};D.has=function(a){var d=m(a);if(d)return d;if("ie"===a.toLowerCase()){a=0;var c=/MSIE (\d+\.\d+);/.test(navigator.userAgent),e=!!navigator.userAgent.match(/Trident\/7.0/),
b=navigator.userAgent.indexOf("rv:11.0");c&&(a=Number(RegExp.$1));-1!==navigator.appVersion.indexOf("MSIE 10")&&(a=10);e&&-1!==b&&(a=11);return 11===a&&11||d}if("edge"===a.toLowerCase())return navigator.userAgent.split("Edge/")[1]||d};D.detectUserAgent=function(){var a={},d={},c=navigator.userAgent,e=navigator.platform,b=c.match(/Web[kK]it[\/]{0,1}([\d.]+)/),k=c.match(/(Android);?[\s\/]+([\d.]+)?/),t=!!c.match(/\(Macintosh\; Intel /),q=c.match(/(iPad).*OS\s([\d_]+)/),w=c.match(/(iPod)(.*OS\s([\d_]+))?/),
g=!q&&c.match(/(iPhone\sOS)\s([\d_]+)/),u=c.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),e=/Win\d{2}|Windows/.test(e),v=c.match(/Windows Phone ([\d.]+)/),n=u&&c.match(/TouchPad/),x=c.match(/Kindle\/([\d.]+)/),h=c.match(/Silk\/([\d._]+)/),f=c.match(/(BlackBerry).*Version\/([\d.]+)/),l=c.match(/(BB10).*Version\/([\d.]+)/),r=c.match(/(RIM\sTablet\sOS)\s([\d.]+)/),m=c.match(/PlayBook/),y=c.match(/Chrome\/([\d.]+)/)||c.match(/CriOS\/([\d.]+)/),A=c.match(/Firefox\/([\d.]+)/),z=c.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),
C=c.match(/MSIE\s([\d.]+)/)||c.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),B=!y&&c.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),P=B||c.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);d.webkit=!!b;d.webkit&&(d.version=b[1]);k&&(a.android=!0,a.version=k[2]);g&&!w&&(a.ios=a.iphone=!0,a.version=g[2].replace(/_/g,"."));q&&(a.ios=a.ipad=!0,a.version=q[2].replace(/_/g,"."));w&&(a.ios=a.ipod=!0,a.version=w[3]?w[3].replace(/_/g,"."):null);v&&(a.wp=!0,a.version=v[1]);u&&(a.webos=
!0,a.version=u[2]);n&&(a.touchpad=!0);f&&(a.blackberry=!0,a.version=f[2]);l&&(a.bb10=!0,a.version=l[2]);r&&(a.rimtabletos=!0,a.version=r[2]);m&&(d.playbook=!0);x&&(a.kindle=!0,a.version=x[1]);h&&(d.silk=!0,d.version=h[1]);!h&&a.android&&c.match(/Kindle Fire/)&&(d.silk=!0);y&&(d.chrome=!0,d.version=y[1]);A&&(d.firefox=!0,d.version=A[1]);z&&(a.firefoxos=!0,a.version=z[1]);C&&(d.ie=!0,d.version=C[1]);P&&(t||a.ios||e)&&(d.safari=!0,a.ios||(d.version=P[1]));B&&(d.webview=!0);a.tablet=!!(q||m||k&&!c.match(/Mobile/)||
A&&c.match(/Tablet/)||C&&!c.match(/Phone/)&&c.match(/Touch/));a.phone=!(a.tablet||a.ipod||!(k||g||u||f||l||y&&c.match(/Android/)||y&&c.match(/CriOS\/([\d.]+)/)||A&&c.match(/Mobile/)||C&&c.match(/Touch/)));return{os:a,browser:d}};D.isMobileUa=function(){var a=D.detectUserAgent();return!0===a.os.phone||!0===a.os.tablet?!0:!1};D.inMobileSize=function(){var a=b.getMarginBox(window.jimuConfig.layoutId);if(a.w<=window.jimuConfig.breakPoints[0]||a.h<=window.jimuConfig.breakPoints[0])return b.addClass(window.jimuConfig.layoutId,
"jimu-ismobile"),!0;b.removeClass(window.jimuConfig.layoutId,"jimu-ismobile");return!1};D.getObjectIdField=function(a){if(a.objectIdField)return a.objectIdField;a=a.fields;for(var d=0;d<a.length;d++){var c=a[d];if("esriFieldTypeOID"===c.type)return c.name}return null};D.isNeedHttpsButNot=function(){var a=navigator.geolocation,d=window.hasOwnProperty("isSecureContext");return(d&&window.isSecureContext||!d&&"https:"===window.location.protocol)&&a?!1:!0};D.toFeatureSet=function(a){var d=new I;"[object Object]"===
Object.prototype.toString.call(a)&&(a=[a]);d.features=a;if(0<a.length){var c;f.some(a,function(a){if(a.geometry)return c=a,!0});if(c){a=c.getLayer();var e={};a&&(d.displayFieldName=a.displayField,f.forEach(a.fields,p.hitch(this,function(a){var d=a.name;e[d]=a.alias||d})),d.fieldAliases=e);d.geometryType=c.geometry.type;d.spatialReference=c.geometry.spatialReference}}return d};D.showValidationErrorTipForFormDijit=function(a){try{!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),setTimeout(p.hitch(this,
function(){a.focusNode.blur()}),100))}catch(ha){console.error(ha)}};D.getFeatureLayerDefinition=function(a){var d=null,c=a.graphics;a.graphics=[];var e=a.toJson();a.graphics=c;e&&(d=e.layerDefinition);return d};D.simulateClickEvent=function(a){if(m("safari")){var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0);a.dispatchEvent(d)}else a.click()};D.getFeatureSetByLayerAndFeatures=function(a,d){var c=new I;c.fields=p.clone(a.fields);c.features=d;c.geometryType=a.geometryType;c.fieldAliases=
{};f.forEach(c.fields,p.hitch(this,function(a){var d=a.name;c.fieldAliases[d]=a.alias||d}));return c};D.featureAction=function(){return{zoomTo:function(a,d,c){c||(c={});c.hasOwnProperty("extentFactor")||(c.extentFactor=1.2);if(a&&d&&0<d.length){var e=f.every(d,function(a){return a&&a.spatialReference&&a.type});if(f.every(d,function(a){return a&&a.geometry&&a.geometry.spatialReference&&a.geometry.type})||e)e&&(d=f.map(d,function(a){return{geometry:a}})),1===d.length&&"point"===d[0].type?(c=15,c=-1<
a.getMaxZoom()?a.getMaxZoom():.1,a.centerAndZoom(d[0].geometry,c)):(d=K.graphicsExtent(d),a.setExtent(d.expand(c.extentFactor)))}},flash:function(a,d){function c(a,d){f.forEach(b,function(c,e){c.setSymbol(d?a:t[e]||q)})}function e(a){return function(){setTimeout(function(){c(w,!0);b[0]&&d&&d.redraw();setTimeout(function(){c(null,!1);b[0]&&d&&d.redraw();a()},200)},200)}}if(f.every(a||[],function(a){return a&&a.geometry})){var b=a,k=b[0],t=f.map(b,function(a){return a.symbol}),q=k.symbol||p.getObject("renderer.symbol",
!1,d),w=null;d&&"esriGeometryPoint"===d.geometryType?w=new J(require.toUrl("jimu")+"/images/flash.gif",20,20):(w=p.clone(q))&&(w.outline?w.outline.setColor("#ffc500"):w.setColor("#ffc500"));k&&q&&w&&d&&("esriGeometryPoint"===d.geometryType?(c(w,!0),d.redraw(),setTimeout(function(){c(null,!1);d.redraw()},2E3)):e(e(e(function(){})))())}},panTo:function(a,d){if(f.every(d||[],function(a){return a&&a.geometry})){var c;0<d.length?c=K.graphicsExtent(d).getCenter():(c=d[0].geometry,c="polyline"===c.type||
"polygon"===c.type?c.getExtent().getCenter():"extent"===c.type?c.getCenter():"multipoint"===c.type?1<c.points.length?c.getExtent().getCenter():c.getPoint(0):c);a.centerAt(c)}},showPopup:function(a,d){if(f.every(d||[],function(a){return a&&a.geometry})){var c=a.infoWindow;c.setFeatures(d);var e=d[0];"point"===e.geometry.type?c.show(e.geometry,{closetFirst:!0}):c.show(e.geometry.getExtent().getCenter(),{closetFirst:!0})}}}}();D.isInConfigOrPreviewWindow=function(){var a=!1;try{a=!window.isBuilder&&
window.parent&&window.parent!==window&&window.parent.isBuilder}catch(ha){console.log(ha),a=!1}return!!a};D.getAppHref=function(){var a="";return a=D.isInConfigOrPreviewWindow()?window.parent.location.href:window.location.href};D.getAppIdFromUrl=function(){var a=!0,d=D.getAppHref();if(-1!==d.indexOf("id\x3d")||-1!==d.indexOf("appid\x3d")||-1!==d.indexOf("apps"))a=!1;if(!0===a)return d;a=this.urlToObject(window.location.href);if(a.query&&(a.query.id||a.query.appid))return a.query.id||a.query.appid;
if(window.appInfo){if(window.appInfo.id)return window.appInfo.id;if(window.appInfo.appPath){if(a=window.appInfo.appPath.split("/"),a.length&&2<a.length)return a[a.length-2]}else console.error("CAN NOT getAppIdFromUrl")}};D.getEditorContentHeight=function(a,d,c){var e=new g;this._content=a;this._dom=d;this._domParam=c;var k=setTimeout(p.hitch(this,function(){clearTimeout(k);k=null;var a=0,d=this._domParam.contentWidth;try{var c=document.createElement("div");c.setAttribute("id","fakeContent");b.setStyle(c,
"background-size","contain");c.innerHTML=this._content;this._dom.appendChild(c);if(c){var t=r("img",c);t&&t.length&&t.style({maxWidth:d-20+"px"});b.setStyle(c,"position","absolute");b.setStyle(c,"width",d+"px");b.setStyle(c,"left","-99999px");b.setStyle(c,"top","-99999px");b.setStyle(c,"visibility","hidden");var q=b.getContentBox(c);q.h&&(a=q.h,a+=this._domParam.contentMarginTop+this._domParam.footerHeight+8)}}catch(Ca){console.error("can't getEditorContentHeight"+Ca),a=200}e.resolve(a)}),1500);return e};
D.getBase64Data=function(a){var d=new g;if(a&&a.startWith("data:image"))d.resolve(a);else try{P({url:a,handleAs:"arraybuffer"}).then(function(a){var c=new FileReader;c.onloadend=function(){d.resolve(c.result)};c.onerror=function(){d.resolve(null)};c.readAsDataURL(new Blob([a],{type:"image/png"}))},function(){d.resolve(null)})}catch(oa){console.warn(oa),d.resolve(null)}return d};D.getEditorTextColor=function(a,d){return{name:"dijit.editor.plugins.EditorTextColor",custom:{recordUID:D.getColorRecordName(a),
forceAttr:d}}};D.getEditorBackgroundColor=function(a){return{name:"dijit.editor.plugins.EditorBackgroundColor",custom:{recordUID:D.getColorRecordName(a)}}};D.getColorRecordName=function(a){return"wab_cr_"+(a||"")};return D})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(p,f,b){var m=p.NodeList;f.extend(m,{_buildArrayFromCallback:function(b){for(var h=[],f=0;f<this.length;f++){var n=b.call(this[f],this[f],h);n&&(h=h.concat(n))}return h},_getUniqueAsNodeList:function(f){for(var h=
[],l=0,n;n=f[l];l++)1==n.nodeType&&-1==b.indexOf(h,n)&&h.push(n);return this._wrap(h,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(b,h){var f=this._getUniqueAsNodeList(b),f=h?p._filterResult(f,h):f;return f._stash(this)},_getRelatedUniqueNodes:function(b,h){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(h),b)},children:function(b){return this._getRelatedUniqueNodes(b,function(b,l){return f._toArray(b.childNodes)})},closest:function(b,h){return this._getRelatedUniqueNodes(null,
function(f,n){do if(p._filterResult([f],b,h).length)return f;while(f!=h&&(f=f.parentNode)&&1==f.nodeType);return null})},parent:function(b){return this._getRelatedUniqueNodes(b,function(b,f){return b.parentNode})},parents:function(b){return this._getRelatedUniqueNodes(b,function(b,f){for(var n=[];b.parentNode;)b=b.parentNode,n.push(b);return n})},siblings:function(b){return this._getRelatedUniqueNodes(b,function(b,f){for(var n=[],g=b.parentNode&&b.parentNode.childNodes,e=0;e<g.length;e++)g[e]!=b&&
n.push(g[e]);return n})},next:function(b){return this._getRelatedUniqueNodes(b,function(b,f){for(var n=b.nextSibling;n&&1!=n.nodeType;)n=n.nextSibling;return n})},nextAll:function(b){return this._getRelatedUniqueNodes(b,function(b,f){for(var n=[],g=b;g=g.nextSibling;)1==g.nodeType&&n.push(g);return n})},prev:function(b){return this._getRelatedUniqueNodes(b,function(b,f){for(var n=b.previousSibling;n&&1!=n.nodeType;)n=n.previousSibling;return n})},prevAll:function(b){return this._getRelatedUniqueNodes(b,
function(b,f){for(var n=[],g=b;g=g.previousSibling;)1==g.nodeType&&n.push(g);return n})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(b,h){return 0!=h%2})},odd:function(){return this.filter(function(b,h){return 0==h%2})}});return m})},"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number",
"./string","./regexp"],function(p,f,b,m,l){var h={};p.setObject("dojo.number",h);h.format=function(b,g){g=p.mixin({},g||{});var e=f.normalizeLocale(g.locale),e=f.getLocalization("dojo.cldr","number",e);g.customs=e;e=g.pattern||e[(g.type||"decimal")+"Format"];return isNaN(b)||Infinity==Math.abs(b)?null:h._applyPattern(b,e,g)};h._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;h._applyPattern=function(b,g,e){e=e||{};var c=e.customs.group,a=e.customs.decimal;g=g.split(";");var u=g[0];g=g[0>b?1:0]||"-"+u;if(-1!=
g.indexOf("%"))b*=100;else if(-1!=g.indexOf("\u2030"))b*=1E3;else if(-1!=g.indexOf("\u00a4"))c=e.customs.currencyGroup||c,a=e.customs.currencyDecimal||a,g=g.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(a,c,d,b){return(a=e[["symbol","currency","displayName"][d.length-1]]||e.currency||"")?c+a+b:""});else if(-1!=g.indexOf("E"))throw Error("exponential notation not supported");var v=h._numberPatternRE,u=u.match(v);if(!u)throw Error("unable to find a number expression in pattern: "+g);!1===e.fractional&&
(e.places=0);return g.replace(v,h._formatAbsolute(b,u[0],{decimal:a,group:c,places:e.places,round:e.round}))};h.round=function(b,g,e){e=10/(e||10);return(e*+b).toFixed(g)/e};if(0==(.9).toFixed()){var r=h.round;h.round=function(b,g,e){var c=Math.pow(10,-g||0),a=Math.abs(b);if(!b||a>=c)c=0;else if(a/=c,.5>a||.95<=a)c=0;return r(b,g,e)+(0<b?c:-c)}}h._formatAbsolute=function(b,g,e){e=e||{};!0===e.places&&(e.places=0);Infinity===e.places&&(e.places=6);g=g.split(".");var c="string"==typeof e.places&&e.places.indexOf(","),
a=e.places;c?a=e.places.substring(c+1):0<=a||(a=(g[1]||[]).length);0>e.round||(b=h.round(b,a,e.round));b=String(Math.abs(b)).split(".");var u=b[1]||"";g[1]||e.places?(c&&(e.places=e.places.substring(0,c)),c=void 0!==e.places?e.places:g[1]&&g[1].lastIndexOf("0")+1,c>u.length&&(b[1]=m.pad(u,c,"0",!0)),a<u.length&&(b[1]=u.substr(0,a))):b[1]&&b.pop();a=g[0].replace(",","");c=a.indexOf("0");-1!=c&&(c=a.length-c,c>b[0].length&&(b[0]=m.pad(b[0],c)),-1==a.indexOf("#")&&(b[0]=b[0].substr(b[0].length-c)));
var a=g[0].lastIndexOf(","),v,q;-1!=a&&(v=g[0].length-a-1,g=g[0].substr(0,a),a=g.lastIndexOf(","),-1!=a&&(q=g.length-a-1));g=[];for(a=b[0];a;)c=a.length-v,g.push(0<c?a.substr(c):a),a=0<c?a.slice(0,c):"",q&&(v=q,q=void 0);b[0]=g.reverse().join(e.group||",");return b.join(e.decimal||".")};h.regexp=function(b){return h._parseInfo(b).regexp};h._parseInfo=function(b){b=b||{};var g=f.normalizeLocale(b.locale),g=f.getLocalization("dojo.cldr","number",g),e=b.pattern||g[(b.type||"decimal")+"Format"],c=g.group,
a=g.decimal,u=1;if(-1!=e.indexOf("%"))u/=100;else if(-1!=e.indexOf("\u2030"))u/=1E3;else{var v=-1!=e.indexOf("\u00a4");v&&(c=g.currencyGroup||c,a=g.currencyDecimal||a)}g=e.split(";");1==g.length&&g.push("-"+g[0]);g=l.buildGroupRE(g,function(e){e="(?:"+l.escapeString(e,".")+")";return e.replace(h._numberPatternRE,function(e){var d={signed:!1,separator:b.strict?c:[c,""],fractional:b.fractional,decimal:a,exponent:!1};e=e.split(".");var k=b.places;1==e.length&&1!=u&&(e[1]="###");1==e.length||0===k?d.fractional=
!1:(void 0===k&&(k=b.pattern?e[1].lastIndexOf("0")+1:Infinity),k&&void 0==b.fractional&&(d.fractional=!0),!b.places&&k<e[1].length&&(k+=","+e[1].length),d.places=k);e=e[0].split(",");1<e.length&&(d.groupSize=e.pop().length,1<e.length&&(d.groupSize2=e.pop().length));return"("+h._realNumberRegexp(d)+")"})},!0);v&&(g=g.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(a,c,d,e){a=l.escapeString(b[["symbol","currency","displayName"][d.length-1]]||b.currency||"");if(!a)return"";c=c?"[\\s\\xa0]":"";
e=e?"[\\s\\xa0]":"";return b.strict?c+a+e:(c&&(c+="*"),e&&(e+="*"),"(?:"+c+a+e+")?")}));return{regexp:g.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:c,decimal:a,factor:u}};h.parse=function(b,g){var e=h._parseInfo(g),c=(new RegExp("^"+e.regexp+"$")).exec(b);if(!c)return NaN;var a=c[1];if(!c[1]){if(!c[2])return NaN;a=c[2];e.factor*=-1}a=a.replace(new RegExp("["+e.group+"\\s\\xa0]","g"),"").replace(e.decimal,".");return a*e.factor};h._realNumberRegexp=function(b){b=b||{};"places"in b||(b.places=Infinity);
"string"!=typeof b.decimal&&(b.decimal=".");"fractional"in b&&!/^0/.test(b.places)||(b.fractional=[!0,!1]);"exponent"in b||(b.exponent=[!0,!1]);"eSigned"in b||(b.eSigned=[!0,!1]);var g=h._integerRegexp(b),e=l.buildGroupRE(b.fractional,function(a){var c="";a&&0!==b.places&&(c="\\"+b.decimal,c=Infinity==b.places?"(?:"+c+"\\d+)?":c+("\\d{"+b.places+"}"));return c},!0),c=l.buildGroupRE(b.exponent,function(a){return a?"([eE]"+h._integerRegexp({signed:b.eSigned})+")":""}),g=g+e;e&&(g="(?:(?:"+g+")|(?:"+
e+"))");return g+c};h._integerRegexp=function(b){b=b||{};"signed"in b||(b.signed=[!0,!1]);"separator"in b?"groupSize"in b||(b.groupSize=3):b.separator="";var g=l.buildGroupRE(b.signed,function(c){return c?"[-+]":""},!0),e=l.buildGroupRE(b.separator,function(c){if(!c)return"(?:\\d+)";c=l.escapeString(c);" "==c?c="\\s":"\u00a0"==c&&(c="\\s\\xa0");var a=b.groupSize,e=b.groupSize2;return e?(c="(?:0|[1-9]\\d{0,"+(e-1)+"}(?:["+c+"]\\d{"+e+"})*["+c+"]\\d{"+a+"})",0<a-e?"(?:"+c+"|(?:0|[1-9]\\d{0,"+(a-1)+
"}))":c):"(?:0|[1-9]\\d{0,"+(a-1)+"}(?:["+c+"]\\d{"+a+"})*)"},!0);return g+e};return h})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./_base/xhr ./json module".split(" "),function(p,f,b,m,l,h,r,n,g){b.add("dojo-preload-i18n-Api",1);r=p.i18n={};var e=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,c=function(a,d,c,b){var e=[c+b];d=d.split("-");for(var k="",t=0;t<d.length;t++)if(k+=(k?"-":"")+d[t],!a||a[k])e.push(c+k+"/"+b),e.specificity=k;return e},
a={},u=function(a,d,c){c=c?c.toLowerCase():p.locale;a=a.replace(/\./g,"/");d=d.replace(/\./g,"/");return/root/i.test(c)?a+"/nls/"+d:a+"/nls/"+c+"/"+d},v=p.getL10nName=function(a,d,c){return a=g.id+"!"+u(a,d,c)},q=function(d,e,b,k,t,q){d([e],function(w){var g=h.clone(w.root||w.ROOT),u=c(!w._v1x&&w,t,b,k);d(u,function(){for(var d=1;d<u.length;d++)g=h.mixin(h.clone(g),arguments[d]);a[e+"/"+t]=g;g.$locale=u.specificity;q()})})},k=function(a){var d=l.extraLocale||[],d=h.isArray(d)?d:[d];d.push(a);return d},
d=function(d,c,w){var g=e.exec(d),u=g[1]+"/",v=g[5]||g[4],f=u+v,l=(g=g[5]&&g[4])||p.locale||"",r=f+"/"+l,g=g?[l]:k(l),z=g.length,C=function(){--z||w(h.delegate(a[r]))},l=d.split("*"),B="preload"==l[1];if(b("dojo-preload-i18n-Api")){if(B&&(a[d]||(a[d]=1,A(l[2],n.parse(l[3]),1,c)),w(1)),(l=B)||(t&&x.push([d,c,w]),l=t&&!a[r]),l)return}else if(B){w(1);return}m.forEach(g,function(d){var e=f+"/"+d;b("dojo-preload-i18n-Api")&&y(e);a[e]?C():q(c,f,u,v,d,C)})};b("dojo-preload-i18n-Api");var w=r.normalizeLocale=
function(a){a=a?a.toLowerCase():p.locale;return"root"==a?"ROOT":a},t=0,x=[],A=r._preloadLocalizations=function(c,e,b,k){function q(a,d){k([a],d)}function g(a,d){for(var c=a.split("-");c.length;){if(d(c.join("-")))return;c.pop()}d("ROOT")}function u(){for(--t;!t&&x.length;)d.apply(null,x.shift())}function v(d){d=w(d);g(d,function(b){if(0<=m.indexOf(e,b)){var w=c.replace(/\./g,"/")+"_"+b;t++;q(w,function(c){for(var e in c){var q=c[e],w=e.match(/(.+)\/([^\/]+)$/),v;if(w&&(v=w[2],w=w[1]+"/",q._localized)){var x;
if("ROOT"===b){var n=x=q._localized;delete q._localized;n.root=q;a[f.toAbsMid(e)]=n}else x=q._localized,a[f.toAbsMid(w+v+"/"+b)]=q;b!==d&&function(c,e,b,q){var w=[],v=[];g(d,function(a){q[a]&&(w.push(f.toAbsMid(c+a+"/"+e)),v.push(f.toAbsMid(c+e+"/"+a)))});w.length?(t++,k(w,function(){for(var k=w.length-1;0<=k;k--)b=h.mixin(h.clone(b),arguments[k]),a[v[k]]=b;a[f.toAbsMid(c+e+"/"+d)]=h.clone(b);u()})):a[f.toAbsMid(c+e+"/"+d)]=b}(w,v,q,x)}}u()});return!0}return!1})}k=k||f;v();m.forEach(p.config.extraLocale,
v)},y=function(){},y=function(d){for(var c,e=d.split("/"),b=p.global[e[0]],k=1;b&&k<e.length-1;b=b[e[k++]]);b&&((c=b[e[k]])||(c=b[e[k].replace(/-/g,"_")]),c&&(a[d]=c));return c};r.getLocalization=function(a,c,e){var b;a=u(a,c,e);d(a,f,function(a){b=a});return b};return h.mixin(r,{dynamic:!0,normalize:function(a,d){return/^\./.test(a)?d(a):a},load:d,cache:a,getL10nName:v})})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(p,f){var b=/[&<>'"\/]/g,m={"\x26":"\x26amp;","\x3c":"\x26lt;",
"\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},l={};f.setObject("dojo.string",l);l.escape=function(h){return h?h.replace(b,function(b){return m[b]}):""};l.rep=function(b,f){if(0>=f||!b)return"";for(var n=[];;){f&1&&n.push(b);if(!(f>>=1))break;b+=b}return n.join("")};l.pad=function(b,f,n,g){n||(n="0");b=String(b);f=l.rep(n,Math.ceil((f-b.length)/n.length));return g?b+f:f+b};l.substitute=function(b,l,n,g){g=g||p.global;n=n?f.hitch(g,n):function(b){return b};return b.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,
function(b,c,a){if(""==c)return"$";b=f.getObject(c,!1,l);a&&(b=f.getObject(a,!1,g).call(g,b,c));a=n(b,c);if("undefined"===typeof a)throw Error('string.substitute could not find key "'+c+'" in template');return a.toString()})};l.trim=String.prototype.trim?f.trim:function(b){b=b.replace(/^\s+/,"");for(var h=b.length-1;0<=h;h--)if(/\S/.test(b.charAt(h))){b=b.substring(0,h+1);break}return b};return l})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),
function(p,f,b,m,l,h,r,n,g){function e(a,c,b,e){return e.replace(/([a-z])\1*/ig,function(d){var k,t,q=d.charAt(0);d=d.length;var w=["abbr","wide","narrow"];switch(q){case "G":k=c[4>d?"eraAbbr":"eraNames"][0>a.getFullYear()?0:1];break;case "y":k=a.getFullYear();switch(d){case 1:break;case 2:if(!b.fullYear){k=String(k);k=k.substr(k.length-2);break}default:t=!0}break;case "Q":case "q":k=Math.ceil((a.getMonth()+1)/3);t=!0;break;case "M":case "L":k=a.getMonth();3>d?(k+=1,t=!0):(q=["months","L"==q?"standAlone":
"format",w[d-3]].join("-"),k=c[q][k]);break;case "w":k=u._getWeekOfYear(a,0);t=!0;break;case "d":k=a.getDate();t=!0;break;case "D":k=u._getDayOfYear(a);t=!0;break;case "e":case "c":if(k=a.getDay(),2>d){k=(k-m.getFirstDayOfWeek(b.locale)+8)%7;break}case "E":k=a.getDay();3>d?(k+=1,t=!0):(q=["days","c"==q?"standAlone":"format",w[d-3]].join("-"),k=c[q][k]);break;case "a":q=12>a.getHours()?"am":"pm";k=b[q]||c["dayPeriods-format-wide-"+q];break;case "h":case "H":case "K":case "k":t=a.getHours();switch(q){case "h":k=
t%12||12;break;case "H":k=t;break;case "K":k=t%12;break;case "k":k=t||24}t=!0;break;case "m":k=a.getMinutes();t=!0;break;case "s":k=a.getSeconds();t=!0;break;case "S":k=Math.round(a.getMilliseconds()*Math.pow(10,d-3));t=!0;break;case "v":case "z":if(k=u._getZone(a,!0,b))break;d=4;case "Z":q=u._getZone(a,!1,b);q=[0>=q?"+":"-",r.pad(Math.floor(Math.abs(q)/60),2),r.pad(Math.abs(q)%60,2)];4==d&&(q.splice(0,0,"GMT"),q.splice(3,0,":"));k=q.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+
e);}t&&(k=r.pad(k,d));return k})}function c(a,c,b,e){var d=function(a){return a};c=c||d;b=b||d;e=e||d;var k=a.match(/(''|[^'])+/g),t="'"==a.charAt(0);f.forEach(k,function(a,d){a?(k[d]=(t?b:c)(a.replace(/''/g,"'")),t=!t):k[d]=""});return e(k.join(""))}function a(a,c,b,e){e=h.escapeString(e);b.strict||(e=e.replace(" a"," ?a"));return e.replace(/([a-z])\1*/ig,function(d){var e;e=d.charAt(0);var k=d.length,t="",q="";b.strict?(1<k&&(t="0{"+(k-1)+"}"),2<k&&(q="0{"+(k-2)+"}")):(t="0?",q="0{0,2}");switch(e){case "y":e=
"\\d{2,4}";break;case "M":case "L":2<k?(e=c["months-"+("L"==e?"standAlone":"format")+"-"+v[k-3]].slice(0).join("|"),b.strict||(e=e.replace(/\./g,""),e="(?:"+e+")\\.?")):e="1[0-2]|"+t+"[1-9]";break;case "D":e="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+t+"[1-9][0-9]|"+q+"[1-9]";break;case "d":e="3[01]|[12]\\d|"+t+"[1-9]";break;case "w":e="[1-4][0-9]|5[0-3]|"+t+"[1-9]";break;case "E":case "e":case "c":e=".+?";break;case "h":e="1[0-2]|"+t+"[1-9]";break;case "k":e="1[01]|"+t+"\\d";break;case "H":e="1\\d|2[0-3]|"+
t+"\\d";break;case "K":e="1\\d|2[0-4]|"+t+"[1-9]";break;case "m":case "s":e="[0-5]\\d";break;case "S":e="\\d{"+k+"}";break;case "a":k=b.am||c["dayPeriods-format-wide-am"];t=b.pm||c["dayPeriods-format-wide-pm"];e=k+"|"+t;b.strict||(k!=k.toLowerCase()&&(e+="|"+k.toLowerCase()),t!=t.toLowerCase()&&(e+="|"+t.toLowerCase()),-1!=e.indexOf(".")&&(e+="|"+e.replace(/\./g,"")));e=e.replace(/\./g,"\\.");break;default:e=".*"}a&&a.push(d);return"("+e+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var u={};p.setObject(g.id.replace(/\//g,
"."),u);u._getZone=function(a,c,e){return c?b.getTimezoneName(a):a.getTimezoneOffset()};u.format=function(a,b){b=b||{};var d=l.normalizeLocale(b.locale),k=b.formatLength||"short",d=u._getGregorianBundle(d),q=[],g=p.hitch(this,e,a,d,b);if("year"==b.selector)return c(d["dateFormatItem-yyyy"]||"yyyy",g);var w;"date"!=b.selector&&(w=b.timePattern||d["timeFormat-"+k])&&q.push(c(w,g));"time"!=b.selector&&(w=b.datePattern||d["dateFormat-"+k])&&q.push(c(w,g));return 1==q.length?q[0]:d["dateTimeFormat-"+k].replace(/\'/g,
"").replace(/\{(\d+)\}/g,function(a,d){return q[d]})};u.regexp=function(a){return u._parseInfo(a).regexp};u._parseInfo=function(d){d=d||{};var b=l.normalizeLocale(d.locale),b=u._getGregorianBundle(b),e=d.formatLength||"short",k=d.datePattern||b["dateFormat-"+e],q=d.timePattern||b["timeFormat-"+e],e="date"==d.selector?k:"time"==d.selector?q:b["dateTimeFormat-"+e].replace(/\{(\d+)\}/g,function(a,d){return[q,k][d]}),g=[];return{regexp:c(e,p.hitch(this,a,g,b,d)),tokens:g,bundle:b}};u.parse=function(a,
c){var d=/[\u200E\u200F\u202A\u202E]/g,e=u._parseInfo(c),k=e.tokens,q=e.bundle,d=(new RegExp("^"+e.regexp.replace(d,"")+"$",e.strict?"":"i")).exec(a&&a.replace(d,""));if(!d)return null;var g=["abbr","wide","narrow"],w=[1970,0,1,0,0,0,0],v="",d=f.every(d,function(a,d){if(!d)return!0;var b=k[d-1],e=b.length,b=b.charAt(0);switch(b){case "y":if(2!=e&&c.strict)w[0]=a;else if(100>a)a=Number(a),b=""+(new Date).getFullYear(),e=100*b.substring(0,2),b=Math.min(Number(b.substring(2,4))+20,99),w[0]=a<b?e+a:e-
100+a;else{if(c.strict)return!1;w[0]=a}break;case "M":case "L":if(2<e){if(e=q["months-"+("L"==b?"standAlone":"format")+"-"+g[e-3]].concat(),c.strict||(a=a.replace(".","").toLowerCase(),e=f.map(e,function(a){return a.replace(".","").toLowerCase()})),a=f.indexOf(e,a),-1==a)return!1}else a--;w[1]=a;break;case "E":case "e":case "c":e=q["days-"+("c"==b?"standAlone":"format")+"-"+g[e-3]].concat();c.strict||(a=a.toLowerCase(),e=f.map(e,function(a){return a.toLowerCase()}));a=f.indexOf(e,a);if(-1==a)return!1;
break;case "D":w[1]=0;case "d":w[2]=a;break;case "a":e=c.am||q["dayPeriods-format-wide-am"];b=c.pm||q["dayPeriods-format-wide-pm"];if(!c.strict){var t=/\./g;a=a.replace(t,"").toLowerCase();e=e.replace(t,"").toLowerCase();b=b.replace(t,"").toLowerCase()}if(c.strict&&a!=e&&a!=b)return!1;v=a==b?"p":a==e?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":if(23<a)return!1;w[3]=a;break;case "m":w[4]=a;break;case "s":w[5]=a;break;case "S":w[6]=a}return!0}),e=+w[3];"p"===v&&12>e?w[3]=e+12:"a"===
v&&12==e&&(w[3]=0);e=new Date(w[0],w[1],w[2],w[3],w[4],w[5],w[6]);c.strict&&e.setFullYear(w[0]);var n=k.join(""),h=-1!=n.indexOf("d"),n=-1!=n.indexOf("M");if(!d||n&&e.getMonth()>w[1]||h&&e.getDate()>w[2])return null;if(n&&e.getMonth()<w[1]||h&&e.getDate()<w[2])e=b.add(e,"hour",1);return e};var v=["abbr","wide","narrow"],q=[],k={};u.addCustomFormats=function(a,c){q.push({pkg:a,name:c});k={}};u._getGregorianBundle=function(a){if(k[a])return k[a];var d={};f.forEach(q,function(c){c=l.getLocalization(c.pkg,
c.name,a);d=p.mixin(d,c)},this);return k[a]=d};u.addCustomFormats(g.id.replace(/\/date\/locale$/,".cldr"),"gregorian");u.getNames=function(a,c,e,b){var d;b=u._getGregorianBundle(b);a=[a,e,c];"standAlone"==e&&(e=a.join("-"),d=b[e],1==d[0]&&(d=void 0));a[1]="format";return(d||b[a.join("-")]).concat()};u.isWeekend=function(a,c){var d=m.getWeekend(c),e=(a||new Date).getDay();d.end<d.start&&(d.end+=7,e<d.start&&(e+=7));return e>=d.start&&e<=d.end};u._getDayOfYear=function(a){return b.difference(new Date(a.getFullYear(),
0,1,a.getHours()),a)+1};u._getWeekOfYear=function(a,c){1==arguments.length&&(c=0);var d=(new Date(a.getFullYear(),0,1)).getDay(),e=(d-c+7)%7,e=Math.floor((u._getDayOfYear(a)+e-1)/7);d==c&&e++;return e};return u})},"dojo/date":function(){define(["./has","./_base/lang"],function(p,f){var b={getDaysInMonth:function(f){var l=f.getMonth();return 1==l&&b.isLeapYear(f)?29:[31,28,31,30,31,30,31,31,30,31,30,31][l]},isLeapYear:function(b){b=b.getFullYear();return!(b%400)||!(b%4)&&!!(b%100)},getTimezoneName:function(b){var f=
b.toString(),h="",r=f.indexOf("(");if(-1<r)h=f.substring(++r,f.indexOf(")"));else if(r=/([A-Z\/]+) \d{4}$/,f=f.match(r))h=f[1];else if(f=b.toLocaleString(),r=/ ([A-Z\/]+)$/,f=f.match(r))h=f[1];return"AM"==h||"PM"==h?"":h},compare:function(b,f,h){b=new Date(+b);f=new Date(+(f||new Date));"date"==h?(b.setHours(0,0,0,0),f.setHours(0,0,0,0)):"time"==h&&(b.setFullYear(0,0,0),f.setFullYear(0,0,0));return b>f?1:b<f?-1:0},add:function(b,f,h){var l=new Date(+b),n=!1,g="Date";switch(f){case "day":break;case "weekday":var e;
(f=h%5)?e=parseInt(h/5):(f=0<h?5:-5,e=0<h?(h-5)/5:(h+5)/5);var c=b.getDay(),a=0;6==c&&0<h?a=1:0==c&&0>h&&(a=-1);c+=f;if(0==c||6==c)a=0<h?2:-2;h=7*e+f+a;break;case "year":g="FullYear";n=!0;break;case "week":h*=7;break;case "quarter":h*=3;case "month":n=!0;g="Month";break;default:g="UTC"+f.charAt(0).toUpperCase()+f.substring(1)+"s"}if(g)l["set"+g](l["get"+g]()+h);n&&l.getDate()<b.getDate()&&l.setDate(0);return l},difference:function(f,l,h){l=l||new Date;h=h||"day";var r=l.getFullYear()-f.getFullYear(),
n=1;switch(h){case "quarter":f=f.getMonth();l=l.getMonth();n=Math.floor(l/3)+1+4*r-(Math.floor(f/3)+1);break;case "weekday":r=Math.round(b.difference(f,l,"day"));h=parseInt(b.difference(f,l,"week"));if(0==r%7)r=5*h;else{var n=0,g=f.getDay(),e=l.getDay();h=parseInt(r/7);l=r%7;f=new Date(f);f.setDate(f.getDate()+7*h);f=f.getDay();if(0<r)switch(!0){case 6==g:n=-1;break;case 0==g:n=0;break;case 6==e:n=-1;break;case 0==e:n=-2;break;case 5<f+l:n=-2}else if(0>r)switch(!0){case 6==g:n=0;break;case 0==g:n=
1;break;case 6==e:n=2;break;case 0==e:n=1;break;case 0>f+l:n=2}r=r+n-2*h}n=r;break;case "year":n=r;break;case "month":n=l.getMonth()-f.getMonth()+12*r;break;case "week":n=parseInt(b.difference(f,l,"day")/7);break;case "day":n/=24;case "hour":n/=60;case "minute":n/=60;case "second":n/=1E3;case "millisecond":n*=l.getTime()-f.getTime()}return Math.round(n)}};f.mixin(f.getObject("dojo.date",!0),b);return b})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(p,f){var b={};
p.setObject("dojo.cldr.supplemental",b);b.getFirstDayOfWeek=function(f){f={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[b._region(f)];return void 0===f?
1:f};b._region=function(b){b=f.normalizeLocale(b);b=b.split("-");var l=b[1];l?4==l.length&&(l=b[2]):l={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",
ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",
no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",
ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",
ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",
kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",
pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",
twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[b[0]];return l};b.getWeekend=function(f){var l=b._region(f);f={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[l];l={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[l];void 0===f&&(f=6);void 0===l&&(l=0);return{start:f,end:l}};
return b})},"dojox/encoding/base64":function(){define(["dojo/_base/lang"],function(p){p=p.getObject("dojox.encoding.base64",!0);p.encode=function(f){for(var b=[],m=f.length,l=m%3,m=m-l,h=0;h<m;){var r=f[h++]<<16|f[h++]<<8|f[h++];b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>18&63));b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>12&63));b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>6&
63));b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r&63))}switch(l){case 2:r=f[h++]<<16|f[h++]<<8;b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>18&63));b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>12&63));b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>6&63));b.push("\x3d");break;case 1:r=f[h++]<<16,b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>
18&63)),b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r>>>12&63)),b.push("\x3d"),b.push("\x3d")}return b.join("")};p.decode=function(f){f=f.split("");for(var b=[],m=f.length;"\x3d"==f[--m];);for(var l=0;l<m;){var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[l++])<<18;l<=m&&(h|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[l++])<<12);l<=m&&(h|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[l++])<<
6);l<=m&&(h|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(f[l++]));b.push(h>>>16&255);b.push(h>>>8&255);b.push(h&255)}for(;0==b[b.length-1];)b.pop();return b};return p})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(p,f,b,m,l,h,r,n,g){function e(a){return void 0!==a&&null!==a}function c(a){return e(a)?a:""}function a(a,d,b){var k=b.match(/([^\(]+)(\([^\)]+\))?/i),
q=m.trim(k[1]);b=d[a];var k=f.fromJson((k[2]?m.trim(k[2]):"()").replace(/^\(/,"({").replace(/\)$/,"})")),g=k.utcOffset;if(-1===p.indexOf(v,q))q=m.getObject(q),m.isFunction(q)&&(b=q(b,a,d,k));else if("number"===typeof b||"string"===typeof b&&b&&!isNaN(Number(b)))switch(b=Number(b),q){case "NumberFormat":return r.format(b,k);case "DateString":a=new Date(b);if(k.local||k.systemLocale)return k.systemLocale?a.toLocaleDateString()+(k.hideTime?"":" "+a.toLocaleTimeString()):a.toDateString()+(k.hideTime?
"":" "+a.toTimeString());a=a.toUTCString();k.hideTime&&(a=a.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,""));return a;case "DateFormat":return a=new Date(b),e(g)&&(a=l.add(a,"minute",a.getTimezoneOffset()-g)),n.format(a,k)}return c(b)}function u(a,d){var c;if(d)for(c in a)a.hasOwnProperty(c)&&(void 0===a[c]?delete a[c]:a[c]instanceof Object&&u(a[c],!0));else for(c in a)a.hasOwnProperty(c)&&void 0===a[c]&&delete a[c];return a}var v=["NumberFormat","DateString","DateFormat"],q=/<\/?[^>]+>/g;return{valueOf:function(a,
d){for(var c in a)if(a[c]==d)return c;return null},stripTags:function(a){if(a){var d=typeof a;if("string"===d)a=a.replace(q,"");else if("object"===d)for(var c in a)(d=a[c])&&"string"===typeof d&&(d=d.replace(q,"")),a[c]=d}return a},substitute:function(b,d,q){var k,g,w;e(q)&&(m.isObject(q)?(k=q.first,g=q.dateFormat,w=q.numberFormat):k=q);if(d&&"${*}"!==d)return m.replace(d,m.hitch({obj:b},function(d,b){var e=b.split(":");return 1<e.length?(b=e[0],e.shift(),a(b,this.obj,e.join(":"))):g&&-1!==p.indexOf(g.properties||
"",b)?a(b,this.obj,g.formatter||"DateString"):w&&-1!==p.indexOf(w.properties||"",b)?a(b,this.obj,w.formatter||"NumberFormat"):c(this.obj[b])}),/\$\{([^\}]+)\}/g);d=[];for(var u in b)if(q=b[u],g&&-1!==p.indexOf(g.properties||"",u)?q=a(u,b,g.formatter||"DateString"):w&&-1!==p.indexOf(w.properties||"",u)&&(q=a(u,b,w.formatter||"NumberFormat")),d.push(u+" \x3d "+c(q)+"\x3cbr/\x3e"),k)break;return d.join("")},filter:function(a,d,c){d=[m.isString(a)?a.split(""):a,c||b.global,m.isString(d)?new Function("item",
"index","array",d):d];c={};var e;a=d[0];for(e in a)d[2].call(d[e],a[e],e,a)&&(c[e]=a[e]);return c},startsWith:function(a,d,c){c=c||0;return a.indexOf(d,c)===c},endsWith:function(a,d,c){if("number"!==typeof c||!isFinite(c)||Math.floor(c)!==c||c>a.length)c=a.length;c-=d.length;a=a.indexOf(d,c);return-1!==a&&a===c},isDefined:e,fixJson:u}})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(p,f,b){p=function(){return this}();var m=p.location,l=m.pathname;b=
m.protocol;m={version:"3.21",_appBaseUrl:b+"//"+m.host+l.substring(0,l.lastIndexOf(l.split("/")[l.split("/").length-1]))};f.noGlobals||(p.esri=m);(m.dijit=m.dijit||{})._arcgisUrl=("http:"===b||"https:"===b?b:"http:")+"//www.arcgis.com/sharing/rest";return m})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct dojo/sniff ../kernel ../config ../Color ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J,L,P){function Q(a){return k({url:da.arcgisUrl+"/"+a.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function H(a,d){var c={f:"json"};d&&(c.token=d);return k({url:a,content:c,callbackParamName:"callback"},{disableIdentityLookup:!0})}function K(a){!a.layerDefinition||a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.labelingInfo||(a.showLabels=!1);a.itemProperties.layerDefinition&&
(a.layerDefinition?(a.layerDefinition.drawingInfo||(a.layerDefinition.drawingInfo=a.itemProperties.layerDefinition.drawingInfo),q.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition.definitionExpression=a.itemProperties.layerDefinition.definitionExpression),q.isDefined(a.layerDefinition.minScale)||(a.layerDefinition.minScale=a.itemProperties.layerDefinition.minScale),q.isDefined(a.layerDefinition.maxScale)||(a.layerDefinition.maxScale=a.itemProperties.layerDefinition.maxScale)):
a.layerDefinition=a.itemProperties.layerDefinition);!a.itemProperties.popupInfo||a.popupInfo||a.disablePopup||(a.popupInfo=a.itemProperties.popupInfo);q.isDefined(a.itemProperties.showLabels)&&!q.isDefined(a.showLabels)&&(a.showLabels=a.itemProperties.showLabels);q.isDefined(a.itemProperties.showLegend)&&!q.isDefined(a.showLegend)&&(a.showLegend=a.itemProperties.showLegend);q.isDefined(a.itemProperties.refreshInterval)&&!q.isDefined(a.refreshInterval)&&(a.refreshInterval=a.itemProperties.refreshInterval)}
function V(a){K(a);a.itemProperties.layerDefinition&&a.layerDefinition&&(!q.isDefined(a.layerDefinition.maximumTrackPoints)&&q.isDefined(a.itemProperties.layerDefinition.maximumTrackPoints)&&(a.layerDefinition.maximumTrackPoints=a.itemProperties.layerDefinition.maximumTrackPoints),!a.layerDefinition.definitionGeometry&&a.itemProperties.layerDefinition.definitionGeometry&&(a.layerDefinition.definitionGeometry=a.itemProperties.layerDefinition.definitionGeometry));a.itemProperties.purgeOptions&&!a.purgeOptions&&
(a.purgeOptions=a.itemProperties.purgeOptions)}function S(a,d){var c=new l,e=a.itemData,k=[],t=[];b.forEach(e.operationalLayers,function(a){if(a.itemId&&!a.type){var d=a.url.toLowerCase();-1<d.indexOf("/featureserver")||-1<d.indexOf("/mapserver/")?(t.push(a),k.push(Q(a))):-1<d.indexOf("/mapserver")&&-1===d.indexOf("/mapserver/")&&(!a.layers||!q.isDefined(a.minScale)&&!q.isDefined(a.maxScale))?(t.push(a),k.push(Q(a))):-1<d.indexOf("/imageserver")&&!q.isDefined(a.minScale)&&!q.isDefined(a.maxScale)?
(t.push(a),k.push(Q(a))):-1<d.indexOf("/streamserver")&&(t.push(a),k.push(Q(a)))}});e.baseMap&&e.baseMap.baseMapLayers&&b.forEach(e.baseMap.baseMapLayers,function(a){a.itemId&&"VectorTileLayer"!==a.layerType&&(t.push(a),k.push(Q(a)))});if(0<k.length){var w={};(new g(k)).addCallback(function(d){b.forEach(t,function(a,c){var e=d[c][1];if(e&&!(e instanceof Error)&&(w[a.itemId]=e,!a.type)){var k=a.url.toLowerCase();(-1<k.indexOf("/featureserver")||-1<k.indexOf("/mapserver/"))&&e.layers?b.forEach(e.layers,
function(d){var c="/featureserver/"+d.id;(c=k.match(c+"$")==c)||(c="/mapserver/"+d.id,c=k.match(c+"$")==c);c&&(a.itemProperties=d,K(a))}):-1<k.indexOf("/streamserver")?(a.itemProperties=e,V(a)):-1<k.indexOf("/mapserver")?(e.layers&&!a.layers&&(a.layers=e.layers),q.isDefined(e.minScale)&&!q.isDefined(a.minScale)&&(a.minScale=e.minScale),q.isDefined(e.maxScale)&&!q.isDefined(a.maxScale)&&(a.maxScale=e.maxScale),q.isDefined(e.refreshInterval)&&!q.isDefined(a.refreshInterval)&&(a.refreshInterval=e.refreshInterval),
e.visibleLayers&&!a.visibleLayers&&(a.visibleLayers=e.visibleLayers)):-1<k.indexOf("/imageserver")&&(q.isDefined(e.minScale)&&!q.isDefined(a.minScale)&&(a.minScale=e.minScale),q.isDefined(e.maxScale)&&!q.isDefined(a.maxScale)&&(a.maxScale=e.maxScale),q.isDefined(e.refreshInterval)&&!q.isDefined(a.refreshInterval)&&(a.refreshInterval=e.refreshInterval),!e.popupInfo||a.popupInfo||a.disablePopup||(a.popupInfo=e.popupInfo),e.renderingRule&&!a.renderingRule&&(a.renderingRule=e.renderingRule,e.renderingRule.functionName&&
(a.renderingRule.rasterFunction=e.renderingRule.functionName)),e.bandIds&&!a.bandIds&&(a.bandIds=e.bandIds),e.mosaicRule&&!a.mosaicRule&&(a.mosaicRule=e.mosaicRule),e.format&&!a.format&&(a.format=e.format),q.isDefined(e.compressionQuality)&&!q.isDefined(a.compressionQuality)&&(a.compressionQuality=e.compressionQuality),!e.layerDefinition||!e.layerDefinition.definitionExpression||q.isDefined(a.layerDefinition)&&q.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition=a.layerDefinition||
{},a.layerDefinition.definitionExpression=e.layerDefinition.definitionExpression))}});a.relatedItemsData=w;c.callback(a)})}else c.callback(a);return c}function ba(d,c){var e=new l,b=d.itemData,k=b.baseMap.baseMapLayers[0];if("BingMapsAerial"===k.type||"BingMapsRoad"===k.type||"BingMapsHybrid"===k.type)if(k.portalUrl&&a.id)delete c.bingMapsKey,a.id.checkSignInStatus(t.urlToObject(da.arcgisUrl).path).then(f.hitch(null,function(a,d,c,e,b){H(k.portalUrl,b.token).then(f.hitch(null,M,a,d,c,e),f.hitch(null,
W,a,d,c,e))},d,c,b,e),f.hitch(null,function(a,d,c,e,b){H(k.portalUrl).then(f.hitch(null,M,a,d,c,e),f.hitch(null,W,a,d,c,e))},d,c,b,e));else if(c.bingMapsKey){var q=new Pa({bingMapsKey:c.bingMapsKey,mapStyle:Pa.MAP_STYLE_AERIAL});m.connect(q,"onLoad",f.hitch(this,function(){e.callback([d,c])}));m.connect(q,"onError",function(a){delete c.bingMapsKey;d.itemData=ga(b);k=d.itemData.baseMap.baseMapLayers[0];k.errors=[];k.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});
e.callback([d,c])})}else d.itemData=ga(b),k=d.itemData.baseMap.baseMapLayers[0],k.errors=[],k.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),e.callback([d,c]);else e.callback([d,c]);return e}function N(a){var d=new l,c,e;a=a.itemData;var b=a.baseMap&&a.baseMap.baseMapLayers;if(eb&&!eb.supported())for(a=0;a<b.length;a++){var k=b[a];if(!k.isReference){"VectorTileLayer"===k.layerType&&(c=k.itemId,e=a);break}}c?
R(c,!1).addBoth(function(a){var c=/^https?:\/\/basemaps(dev)?\.arcgis\.com\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;a&&a.item&&c.test(a.item.url)&&(b[e]={id:"FB_"+k.id,layerType:"ArcGISTiledMapServiceLayer",opacity:"opacity"in k?k.opacity:1,visibility:"visibility"in k?k.visibility:!0,url:"http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"});d.resolve()}):d.resolve();return d}function M(a,d,c,e,b){b.bingKey?(d.bingMapsKey=b.bingKey,b=new Pa({bingMapsKey:d.bingMapsKey,
mapStyle:Pa.MAP_STYLE_AERIAL}),m.connect(b,"onLoad",f.hitch(this,function(){e.callback([a,d])})),m.connect(b,"onError",function(b){delete d.bingMapsKey;a.itemData=ga(c);b=a.itemData.baseMap.baseMapLayers[0];b.errors=[];b.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});e.callback([a,d])})):W(a,d,c,e)}function W(a,d,c,e){delete d.bingMapsKey;a.itemData=ga(c);c=a.itemData.baseMap.baseMapLayers[0];c.errors=[];c.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});
e.callback([a,d])}function ga(a){a.baseMap="BingMapsAerial"===a.baseMap.baseMapLayers[0].type?{title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===a.baseMap.baseMapLayers[0].type?{title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:{title:"Imagery with Labels",
baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};return a}function D(a,d,c,e){var k=a.dynamicLayerInfos||a.layerInfos,t=d.layers;if(t&&k)if(e.usePopupManager){var g;b.forEach(k,function(a){var d=a.id;if(!a.subLayerIds)for(a=
0;a<t.length;a++){var e=t[a];if(e.id===d&&e.popupInfo){g||(g={});g[d]={infoTemplate:new c(e.popupInfo),layerUrl:e.layerUrl};break}}});g&&a.setInfoTemplates(g)}else{var w=[],u=[],v=[],x=[],f=[],n=[];b.forEach(k,function(d){var c=d.id;if(!d.subLayerIds&&-1!==b.indexOf(a.visibleLayers,c))for(d=0;d<t.length;d++){var e=t[d];if(e.id===c){u.push(c);w.push(e.popupInfo);v.push(e.layerUrl||"");e.layerDefinition&&e.layerDefinition.definitionExpression?x.push(e.layerDefinition.definitionExpression):x.push("");
f.push(q.isDefined(e.minScale)?e.minScale:null);n.push(q.isDefined(e.maxScale)?e.maxScale:null);break}}});w.length&&(a.__popups=w,a.__popupIds=u,a.__popupUrls=v,a.__popupWhereClauses=x,a.__popupMinScales=f,a.__popupMaxScales=n,a.__resourceInfo=d.resourceInfo)}}function ja(a){if(!a)return!1;var d=(new r(da.arcgisUrl)).authority;return-1!==a.indexOf(".arcgis.com/")||-1!==a.indexOf(d)}function na(a){return a?-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/"):!1}
function ca(a){"https:"===location.protocol&&(ja(a)||na(a))&&(a=a.replace("http:","https:"));return a}function ea(a,d,c){var e=[],k;a.displayLevels||(e=b.map(a.resourceInfo.tileInfo.lods,function(a){return a.level}));a.exclusionAreas&&(k=f.clone(a.exclusionAreas),k=b.map(k,function(a){a.geometry=new A(a.geometry);return a}));e=new J(ca(a.url),{resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,displayLevels:a.displayLevels||e,id:a.id,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval,
exclusionAreas:k});c.ignorePopups||D(e,a,d,c);return e}function ua(a,d){if(!a||!d||0===d.length)return[];var c=","+d+",",e=[],b,k=",";for(b=0;b<a.length;b++)if(null!==a[b].subLayerIds){if(-1===c.indexOf(","+a[b].id+",")||-1<k.indexOf(","+a[b].id+","))k+=a[b].subLayerIds.toString()+","}else-1<c.indexOf(","+a[b].id+",")&&-1===k.indexOf(","+a[b].id+",")&&e.push(a[b].id);return e}function ha(a,d,c){var e=new ob;e.format="png24";a.resourceInfo&&a.resourceInfo.supportedImageFormatTypes&&-1<a.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")&&
(e.format="png32");var e=new F(ca(a.url),{resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,imageParameters:e,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval}),k=a.visibleLayers;if(!a.visibleLayers){var t="";b.forEach(e.layerInfos,function(a){a.defaultVisibility&&(t+=(0<t.length?",":"")+a.id)});k=t}if(a.layers&&0<a.layers.length){var q=[],g=[],w,u=[],v,x;b.forEach(a.layers,function(d){d.layerDefinition&&d.layerDefinition.definitionExpression&&(q[d.id]=
d.layerDefinition.definitionExpression);if(d.layerDefinition&&d.layerDefinition.source){w=null;x=d.layerDefinition.source;if("mapLayer"===x.type){var c=b.filter(a.resourceInfo.layers,function(a){return a.id===x.mapLayerId});c.length&&(w=f.mixin(c[0],d))}else w=f.mixin({},d);w&&(w.source=x,delete w.popupInfo,w=new Y(w),a.visibleLayers&&(c="string"==typeof a.visibleLayers?a.visibleLayers.split(","):a.visibleLayers,-1<b.indexOf(c,d.id)?w.defaultVisibility=!0:w.defaultVisibility=!1),g.push(w))}d.layerDefinition&&
d.layerDefinition.source&&d.layerDefinition.drawingInfo&&(v=new Qa(d.layerDefinition.drawingInfo),u[d.id]=v)},this);0<q.length&&e.setLayerDefinitions(q);0<g.length?(e.setDynamicLayerInfos(g,!0),0<u.length&&e.setLayerDrawingOptions(u,!0)):(k=ua(e.layerInfos,k),e.setVisibleLayers(k))}else k=ua(e.layerInfos,k),e.setVisibleLayers(k);c.ignorePopups||D(e,a,d,c);return e}function oa(a,d,c){var e=new pb;e.bandIds=a.bandIds;null!=a.format&&(e.format=a.format,null!=a.compressionQuality&&(e.compressionQuality=
a.compressionQuality));if(a.renderingRule&&a.renderingRule.rasterFunction){var b=new qb(a.renderingRule);e.renderingRule=b}a.mosaicRule&&(b=new rb(a.mosaicRule),e.mosaicRule=b);q.isDefined(a.noData)&&(e.noData=a.noData);q.isDefined(a.noDataInterpretation)&&(e.noDataInterpretation=a.noDataInterpretation);q.isDefined(a.interpolation)&&(e.interpolation=a.interpolation);b=a.layerType?"ArcGISImageServiceVectorLayer"===a.layerType:!1;q.isDefined(a.layerType)||(b=a.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===
a.resourceInfo.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===a.resourceInfo.serviceDataType));e={resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,imageServiceParameters:e,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval};e=b?new fa(ca(a.url),e):new Z(ca(a.url),e);a.layerDefinition&&(a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(b=C.fromJson(a.layerDefinition.drawingInfo.renderer),e.setRenderer(b)),a.layerDefinition.definitionExpression&&
e.setDefinitionExpression(a.layerDefinition.definitionExpression,!0));!c.ignorePopups&&a.popupInfo&&e.setInfoTemplate(new d(a.popupInfo));return e}function la(a,c,e){var k=[102113,102100,3857],t=e||new d(c[0].layerObject.fullExtent.spatialReference),g=new d(a.resourceInfo.fullExtent.spatialReference);return t.wkt==g.wkt&&(t.wkid==g.wkid||q.isDefined(t.latestWkid)&&t.latestWkid==g.wkid||q.isDefined(g.latestWkid)&&t.wkid==g.latestWkid||q.isDefined(t.latestWkid)&&t.latestWkid==g.latestWkid)||t.wkid&&
g.wkid&&b.some(k,function(a){return a===g.wkid})&&b.some(k,function(a){return a===t.wkid})?!0:!1}function va(a,d,c){if(!d[0].layerObject.tileInfo)return!1;a=a.resourceInfo.tileInfo;d=d[0].layerObject.tileInfo;c=c.width>c.height?c.width:c.height;for(var e=!1,b=!1,k=0;k<a.lods.length;k++){for(var t=a.lods[k].scale/a.dpi,q=0;q<d.lods.length;q++){var g=d.lods[q].scale/d.dpi;if(Math.abs(g-t)/g<1/c)if(e){b=!0;break}else e=!0}if(b)break}return b||e&&(1===a.lods.length||1===d.lods.length)?!0:!1}function Ea(c,
e,k,g,w,u){var v,x,l=k._clazz;if("OpenStreetMap"===c.type)v=new Ab({id:c.id,opacity:c.opacity,visible:null!==c.visibility&&void 0!==c.visibility?c.visibility:!0});else if("WFS"===c.type)g={customParameters:c.wfsInfo.customParameters,geometryType:c.layerDefinition.geometryType,id:c.id,labelingInfo:c.layerDefinition.drawingInfo.labelingInfo,maxFeatures:c.wfsInfo.maxFeatures,mode:c.mode,name:c.wfsInfo.name,showLabels:!0,swapXY:c.wfsInfo.swapXY,title:c.title,url:c.url,version:c.wfsInfo.version,visible:c.visibility,
wkid:c.layerDefinition.spatialReference.wkid},v=new Ra,v.fromJson(g,function(){q.isDefined(c.opacity)&&v.setOpacity(c.opacity);q.isDefined(c.visibility)&&v.setVisibility(c.visibility);(c.minScale||c.maxScale)&&v.setScaleRange(c.minScale,c.maxScale);v.renderer=C.fromJson(c.layerDefinition.drawingInfo.renderer);!k.ignorePopups&&c.popupInfo&&v.setInfoTemplate(new l(c.popupInfo));v.emit("fromJsonComplete")});else if("WMS"===c.type){var r=[],y=[];b.forEach(c.layers,function(a){y.push(new Bb({name:a.name,
title:a.title,legendURL:a.legendURL,queryable:a.queryable,showPopup:a.showPopup}));r.push(a.name)},this);c.visibleLayers&&(r=c.visibleLayers);g=new A(c.extent[0][0],c.extent[0][1],c.extent[1][0],c.extent[1][1],new d({wkid:4326}));g={customLayerParameters:c.customLayerParameters,customParameters:c.customParameters,extent:g,layerInfos:y,version:c.version,maxWidth:c.maxWidth,maxHeight:c.maxHeight,featureInfoFormat:c.featureInfoFormat,getFeatureInfoURL:c.featureInfoUrl,getMapURL:c.mapUrl,spatialReferences:c.spatialReferences,
title:c.title,copyright:c.copyright,minScale:c.minScale||0,maxScale:c.maxScale||0,format:c.format};v=new Ya(c.url,{id:c.id,visibleLayers:r,format:"png",transparent:c.firstLayer?!1:!0,opacity:c.opacity,visible:null!==c.visibility?c.visibility:!0,resourceInfo:g,refreshInterval:c.refreshInterval});v.spatialReference.wkid=g.spatialReferences[0]}else if("KML"===c.type){x=c.url;if(a.id){var P=a.id.findCredential(t.urlToObject(da.arcgisUrl).path);P&&(e=da.arcgisUrl.substring(da.arcgisUrl.indexOf("//")+2,
da.arcgisUrl.indexOf("/",da.arcgisUrl.indexOf("//")+3)),w=e.split("."),w=w[w.length-2]+"."+w[w.length-1],u=x.indexOf(w),-1<u&&(x="https://"+e+x.substring(u+w.length),x+="?token\x3d"+P.token))}v=new sb(x,{id:c.id,visible:null!==c.visibility?c.visibility:!0,outSR:g,refreshInterval:c.refreshInterval});m.connect(v,"onLoad",function(){(c.opacity||0===c.opacity)&&v.setOpacity(c.opacity);q.isDefined(c.minScale)&&q.isDefined(c.maxScale)&&v.setScaleRange(c.minScale,c.maxScale);c.visibleFolders&&b.forEach(v.folders,
function(a){-1<b.indexOf(c.visibleFolders,a.id)?v.setFolderVisibility(a,!0):v.setFolderVisibility(a,!1)},this)})}else if("WebTiledLayer"===c.type){if(v=new tb(c.templateUrl,{id:c.id,visible:null!==c.visibility?c.visibility:!0,opacity:c.opacity,copyright:c.copyright,fullExtent:c.fullExtent&&new A(c.fullExtent),initialExtent:c.fullExtent&&new A(c.fullExtent),subDomains:c.subDomains,tileInfo:c.tileInfo?new jb(c.tileInfo):null,refreshInterval:c.refreshInterval,wmtsInfo:c.wmtsInfo}),q.isDefined(c.minScale)||
q.isDefined(c.maxScale))v.loaded?v.setScaleRange(c.minScale,c.maxScale):m.connect(v,"onLoad",function(){v.setScaleRange(c.minScale,c.maxScale)})}else"GeoRSS"===c.type?(v=new O(c.url,{id:c.id,opacity:c.opacity,outSpatialReference:g,refreshInterval:c.refreshInterval}),m.connect(v,"onLoad",function(){!1===c.visibility&&v.hide();q.isDefined(c.minScale)&&q.isDefined(c.maxScale)&&v.setScaleRange(c.minScale,c.maxScale);var a=v.getFeatureLayers();b.forEach(a,function(d){c.pointSymbol&&"esriGeometryPoint"===
d.geometryType?(d.renderer.symbol=z.fromJson(c.pointSymbol),1===a.length&&(v.pointSymbol=z.fromJson(c.pointSymbol))):c.lineSymbol&&"esriGeometryPolyline"===d.geometryType?(d.renderer.symbol=z.fromJson(c.lineSymbol),1===a.length&&(v.polylineSymbol=z.fromJson(c.lineSymbol))):c.polygonSymbol&&"esriGeometryPolygon"===d.geometryType&&(d.renderer.symbol=z.fromJson(c.polygonSymbol),1===a.length&&(v.polygonSymbol=z.fromJson(c.polygonSymbol)))})})):"CSV"==c.type&&c.url?(g={layerDefinition:c.layerDefinition,
columnDelimiter:c.columnDelimiter,id:c.id?c.id:null,visible:null!==c.visibility?c.visibility:!0,opacity:c.opacity,refreshInterval:c.refreshInterval},c.locationInfo&&(g.latitudeFieldName=c.locationInfo.latitudeFieldName,g.longitudeFieldName=c.locationInfo.longitudeFieldName),k.ignorePopups||(g.infoTemplate=new B(c.popupInfo?c.popupInfo:qa.generateDefaultPopupInfo(c))),v=new X(c.url,g)):"VectorTileLayer"===c.layerType&&c.styleUrl?v=new eb(c.styleUrl,{id:c.id,minScale:c.minScale,maxScale:c.maxScale,
opacity:c.opacity,visible:c.visibility}):c.layerDefinition&&!c.url?(g=h.fromJson(h.toJson(c)),delete g.id,delete g.opacity,delete g.visibility,v=new L(g,{id:c.id,opacity:c.opacity,visible:c.visibility,outFields:["*"],autoGeneralize:!0}),!k.ignorePopups&&g.popupInfo&&v.setInfoTemplate(new l(g.popupInfo)),Ba(v)):"BingMapsAerial"===c.type||"BingMapsRoad"===c.type||"BingMapsHybrid"===c.type?k.bingMapsKey?(g=Pa.MAP_STYLE_AERIAL_WITH_LABELS,"BingMapsAerial"===c.type?g=Pa.MAP_STYLE_AERIAL:"BingMapsRoad"===
c.type&&(g=Pa.MAP_STYLE_ROAD),v=new Pa({bingMapsKey:k.bingMapsKey,mapStyle:g,opacity:c.opacity,id:c.id}),m.connect(v,"onError",f.hitch(this,function(a){a.errors=a.errors||[];a.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+a.type+"]"})},c))):(c.errors=c.errors||[],c.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+c.type+"]"})):c.resourceInfo&&
c.resourceInfo.mapName?v=!0===c.resourceInfo.singleFusedMapCache&&(c.baseMapLayer||la(c,e,g)&&va(c,w,u))?ea(c,l,k):ha(c,l,k):c.resourceInfo&&c.resourceInfo.pixelSizeX?v=!0===c.resourceInfo.singleFusedMapCache&&(c.baseMapLayer||la(c,e,g)&&va(c,w,u))?ea(c,l,k):oa(c,l,k):c.resourceInfo&&"Feature Layer"===c.resourceInfo.type?(c.capabilities&&(c.resourceInfo.capabilities=c.capabilities),v=new L(ca(c.url),{resourceInfo:c.resourceInfo,opacity:c.opacity,visible:c.visibility,id:c.id,mode:c.mode===L.MODE_SELECTION?
L.MODE_SELECTION:L.MODE_AUTO,editable:!1===k.editable?!1:void 0,outFields:["*"],autoGeneralize:!0,refreshInterval:c.refreshInterval}),!k.ignorePopups&&c.popupInfo&&v.setInfoTemplate(new l(c.popupInfo)),c.layerDefinition&&(c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.renderer&&(g=C.fromJson(c.layerDefinition.drawingInfo.renderer),g.isMaxInclusive=!0,v.setRenderer(g)),c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.labelingInfo&&(g=b.map(c.layerDefinition.drawingInfo.labelingInfo,
function(a){return new ub(a)}),v.setLabelingInfo(g)),c.layerDefinition.definitionExpression&&v.setDefinitionExpression(c.layerDefinition.definitionExpression),q.isDefined(c.layerDefinition.minScale)&&v.setMinScale(c.layerDefinition.minScale),q.isDefined(c.layerDefinition.maxScale)&&v.setMaxScale(c.layerDefinition.maxScale)),Ba(v)):c.resourceInfo&&c.resourceInfo.streamUrls&&(g={resourceInfo:c.resourceInfo,opacity:c.opacity,visible:c.visibility,id:c.id},c.layerDefinition&&(P=c.layerDefinition.drawingInfo,
c.layerDefinition.definitionGeometry&&(x=x||{},x.geometry=c.layerDefinition.definitionGeometry),q.isDefined(c.layerDefinition.definitionExpression)&&(x=x||{},x.where=c.layerDefinition.definitionExpression),q.isDefined(c.layerDefinition.maximumTrackPoints)&&(g.maximumTrackPoints=c.layerDefinition.maximumTrackPoints)),x&&(g.filter=x),c.purgeOptions&&(g.purgeOptions=c.purgeOptions),v=new Za(ca(c.url),g),P&&P.renderer&&(g=P.renderer,v.setRenderer(C.fromJson(g))),!k.ignorePopups&&c.popupInfo&&v.setInfoTemplate(new l(c.popupInfo)),
c.layerDefinition&&(q.isDefined(c.layerDefinition.minScale)&&v.setMinScale(c.layerDefinition.minScale),q.isDefined(c.layerDefinition.maxScale)&&v.setMaxScale(c.layerDefinition.maxScale)),n.once(v,"error",function(a){c.errors.push({message:"Error loading stream layer. Check websocket url"})}));v&&(v.arcgisProps={title:c.title},c.baseMapLayer&&(c.isReference?(v.attr("data-reference",!0),v._basemapGalleryLayerType="reference"):v._basemapGalleryLayerType="basemap"));return v}function ia(a,d,c,e,k){b.forEach(a,
function(b){b.layerObject=Ea(b,a,d,c,e,k)});var t=b.filter(a,function(a){return!a.isReference}),q=b.filter(a,function(a){return!!a.isReference});return a=t.concat(q)}function ma(a){var c=null;a=a[0];a.url&&!a.type?a.resourceInfo.spatialReference&&(c=new d,a.resourceInfo.spatialReference.wkid&&(c.wkid=a.resourceInfo.spatialReference.wkid),a.resourceInfo.spatialReference.wkt&&(c.wkt=a.resourceInfo.spatialReference.wkt)):a.type&&(-1<a.type.indexOf("BingMaps")||"OpenStreetMap"==a.type?c=new d({wkid:102100}):
"WMS"==a.type&&(c=new d({wkid:a.spatialReferences[0]})));return c}function za(a,d,c,e,k,t,q,g){b.forEach(d,function(d){d.url&&!d.type&&(d.resourceInfo=a[d.deferredsPos][1],delete d.deferredsPos)});t=t||ma(d);d=ia(d,c,t,q,g);k.callback(d);return k}function Ba(a){!window.CanvasRenderingContext2D&&a.renderer&&"esri.renderer.HeatmapRenderer"===a.renderer.declaredClass&&a.setRenderer(C.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",
outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}}))}function Ca(a,d){var c=ca(a);return k({url:c,content:{f:"json"},callbackParamName:"callback",error:function(a,e){a.message=a.message?a.message+(" [url:"+c+"]"):"[url:"+c+"]";d.push(a);u.defaults.io.errorHandler(a,e)}})}function wa(a){var d=da.arcgisUrl+"/"+a.itemId+"/data";return k({url:d,content:{f:"json"},callbackParamName:"callback",error:function(c,e){c.message=c.message?c.message+(" [url:"+d+"]"):"[url:"+d+"]";
a.errors=a.errors||[];a.errors.push(c);u.defaults.io.errorHandler(c,e)}})}function sa(a,d,c){var e=new l;if(!(c.featureCollection&&c.featureCollection.layers||c.layers))return console.log("Invalid Feature Collection item data [item id: "+a.itemId+"]: ",c),a.errors=a.errors||[],a.errors.push({message:"Invalid Feature Collection item data. [item id: "+a.itemId+"]"}),e.errback(),e;c.layers&&(c.featureCollection={layers:c.layers},delete c.layers,q.isDefined(c.showLegend)&&(c.featureCollection.showLegend=
c.showLegend,delete c.showLegend));Fa(a,c.featureCollection,d).then(function(d){c.featureCollection=d;a.featureCollection&&a.featureCollection.layers?b.forEach(c.featureCollection.layers,function(d,c){var e=a.featureCollection.layers[c];e.popupInfo||e.layerDefinition?e.layerDefinition?(q.isDefined(e.layerDefinition.minScale)&&q.isDefined(e.layerDefinition.maxScale)&&(e.layerDefinition.minScale!==d.layerDefinition.minScale||e.layerDefinition.maxScale!==d.layerDefinition.maxScale)&&(delete d.layerDefinition.minScale,
delete d.layerDefinition.maxScale),e.layerDefinition.drawingInfo&&h.toJson(e.layerDefinition.drawingInfo)!==h.toJson(d.layerDefinition.drawingInfo)&&delete d.layerDefinition.drawingInfo,e.layerDefinition.showLegend!==d.layerDefinition.showLegend&&delete d.layerDefinition.showLegend,e.layerDefinition=f.mixin(e.layerDefinition,d.layerDefinition)):e.layerDefinition=d.layerDefinition:(e.popupInfo=d.popupInfo,e.layerDefinition=d.layerDefinition);e.featureSet=d.featureSet;e.nextObjectId=d.nextObjectId}):
(a.featureCollection=a.featureCollection||{},a.featureCollection=f.mixin(a.featureCollection,c.featureCollection));e.callback(a)});return e}function Fa(a,d,c){var e=new l;p(["./csv"],function(k){var t=[];b.forEach(d.layers,function(a){a.featureSet&&a.featureSet.features&&a.featureSet.features.length&&a.featureSet.features[0].geometry&&a.featureSet.features[0].geometry.spatialReference&&(a.deferredsPos=t.length,t.push(k.projectFeatureCollection(a,c,a.featureSet.features[0].geometry.spatialReference)))});
(new g(t)).addCallback(function(){b.forEach(d.layers,function(d){q.isDefined(d.deferredsPos)&&(t[d.deferredsPos].results&&t[d.deferredsPos].results.length?d=t[d.deferredsPos].results[0]:(console.log("Errors projecting feature collection. ["+a.title+" - "+d.layerDefinition.name+"]"),d.errors=d.errors||[],d.errors.push({message:"Errors projecting feature collection. ["+a.title+" - "+d.layerDefinition.name+"]"})),delete d.deferredsPos)});e.callback(d)})});return e}function Ma(a,d,c,e,k){var t=new l,
q=new l,w=[],u;b.forEach(a.operationalLayers,function(a){a.itemId&&"Feature Collection"==a.type&&w.push(wa(a).then(f.hitch(null,sa,a,c)))});0===w.length?La(a,d,c,e,q,k):(u=new g(w),u.addCallback(function(b){La(a,d,c,e,q,k)}));q.then(function(a){w=[];b.forEach(a,function(a){var d;a=a.layerObject;a instanceof L&&!a.loaded&&!a.loadError?(d=new l,n.once(a,"load, error",function(){d.callback(a)}),w.push(d)):a&&"esri.layers.WFSLayer"===a.declaredClass&&!a.loadError&&(d=new l,n.once(a,"fromJsonComplete, error",
function(c){d.callback(a)}),w.push(d))});if(w.length){var d=new l;u=new g(w);u.addCallback(function(){d.callback(a)});return d.promise}return a}).then(function(a){var d=[];b.forEach(a,function(a){var c=a.layerObject;c instanceof L?c.loaded&&c.labelingInfo&&(a.showLabels||c._collection)&&d.push(c):c&&"esri.layers.WFSLayer"===c.declaredClass&&c.loaded&&c.labelingInfo&&d.push(c)});d.length?p(["../layers/LabelLayer"],function(c){var e=new c;b.forEach(d,function(a){e.addFeatureLayer(a)});a.push({layerObject:e});
t.callback(a)}):t.callback(a)});return t}function La(a,d,c,e,k,t){var q=[],w=[],u=[];b.forEach(a.operationalLayers,function(a,d){if(a.featureCollection&&a.featureCollection.layers){var c=a.featureCollection.layers.length;b.forEach(a.featureCollection.layers,function(e,k){var t=!0;a.visibleLayers&&-1==b.indexOf(a.visibleLayers,k)&&(t=!1);e.visibility=a.visibility&&t;e.opacity=a.opacity;e.id=(a.id||"operational"+d)+"_"+k;a.title&&(e.title=1!==c&&e.layerDefinition.name&&a.title!==e.layerDefinition.name?
a.title+" - "+e.layerDefinition.name:a.title);u.push(e)},this)}else u.push(a)});b.forEach(a.baseMap.baseMapLayers,function(a,d){a.baseMapLayer=!0;a.id=a.id||"base"+d;q.push(a)});b.forEach(u,function(a,d){a.id=a.id||"operational"+d;q.push(a)});b.forEach(q,function(a){a.url&&!a.type&&(a.deferredsPos=w.length,a.errors=a.errors||[],w.push(Ca(a.url,a.errors)))});0===w.length?(c=c||ma(q),q=ia(q,d,c,e,t),k.callback(q)):(new g(w)).addCallback(function(a){za(a,q,d,w,k,c,e,t)});return k}function Ja(a,d,c,e){var k=
a.minScale,t=a.maxScale;if(10.1>=c.version&&d)for(a=d.length-1;0<=a;a--){if(d[a].id==e)if(0==k&&0<d[a].minScale?k=d[a].minScale:0<k&&0==d[a].minScale?k=c.minScale:0<k&&0<d[a].minScale&&(k=Math.min(k,d[a].minScale)),t=Math.max(c.maxScale||0,d[a].maxScale||0),c.setScaleRange(k,t),-1<d[a].parentLayerId)e=d[a].parentLayerId;else break}else 10.1<c.version&&(b.forEach(a.layerInfos,function(a){a.id==e&&(0==k&&0<a.minScale?k=a.minScale:0<k&&0==a.minScale||0<k&&0<a.minScale&&(k=Math.min(k,a.minScale)),t=Math.max(t||
0,a.maxScale||0))}),c.setScaleRange(k,t))}function Ga(a,d,c,e){var k=a.url,t=a.__popupIds,g=a.__popupUrls,w=a.__popupWhereClauses,u=a.__popupMinScales,v=a.__popupMaxScales,x=a.__resourceInfo,n=[];b.forEach(a.__popups,function(e,f){if(e){var h,l=[];b.forEach(e.fieldInfos,function(a){"shape"!==a.fieldName.toLowerCase()&&l.push(a.fieldName)});if(a.dynamicLayerInfos&&0<a.dynamicLayerInfos.length){var r=b.filter(a.dynamicLayerInfos,function(a){return t[f]==a.id})[0].source;h=new L(k+"/dynamicLayer",{id:a.id+
"_"+t[f],source:r,outFields:l,mode:L.MODE_SELECTION,infoTemplate:e&&new c(e),drawMode:!1,visible:a.visible,autoGeneralize:!0});var y=function(c,e){0<w[c].length&&e.setDefinitionExpression(w[c]);if(q.isDefined(u[c])||q.isDefined(v[c]))if(q.isDefined(a.minScale)||q.isDefined(a.maxScale)){var b=a.minScale,k=a.maxScale;0==b&&0<u[c]?b=u[c]:0<b&&0==u[c]||0<b&&0<u[c]&&(b=Math.min(b,u[c]));k=Math.max(k||0,v[c]||0);e.setScaleRange(b,k)}else e.setScaleRange(u[c],v[c]);else Ja(a,d||x.layers,e,t[c])};h.loaded?
y(f,h):m.connect(h,"onLoad",function(a){y(f,h)})}else{var A=null,z=k+"/"+t[f];if(g[f].length)z=g[f];else if(d)for(r=0;r<d.length;r++)if(d[r].id===t[f]){A=d[r];break}h=new L(ca(z),{id:a.id+"_"+t[f],outFields:l,mode:L.MODE_SELECTION,infoTemplate:e&&new c(e),drawMode:!1,visible:a.visible,resourceInfo:A,autoGeneralize:!0});h.loaded?(0<w[f].length&&h.setDefinitionExpression(w[f]),Ja(a,d||x.layers,h,t[f])):m.connect(h,"onLoad",function(c){0<w[f].length&&h.setDefinitionExpression(w[f]);Ja(a,d||x.layers,
c,t[f])})}n.push(h)}});0<n.length&&(m.connect(a,"onVisibilityChange",f.hitch(this,function(a,d){b.forEach(a,function(a){d?a.show():a.hide()})},n)),m.connect(e,"onLayerRemove",f.hitch(this,function(a,d,c){a.id===c.id&&b.forEach(d,function(a){e.removeLayer(a)})},a,n)));delete a.__popups;delete a.__popupIds;delete a.__popupUrls;delete a.__popupWhereClauses;delete a.__popupMinScales;delete a.__popupMaxScales;delete a.__resourceInfo;return n}function Wa(a){return k({url:ca(a.url+"/layers"),content:{f:"json"},
callbackParamName:"callback",error:function(){}})}function ab(a,d,c){var e=[];b.forEach(a,function(a){var d=a.__popups;d&&1<d.length&&10<=a.version&&(a.__deferredsPos=e.length,e.push(Wa(a)))});var k=[];0<e.length?(new g(e)).addCallback(function(e){b.forEach(a,function(a){a.__popups&&0<a.__popups.length&&(a.__deferredsPos||0===a.__deferredsPos?(k=k.concat(Ga(a,e[a.__deferredsPos][1].layers,c,d)),delete a.__deferredsPos):k=k.concat(Ga(a,null,c,d)))});d.addLayers(k)}):(b.forEach(a,function(a){a.__popups&&
0<a.__popups.length&&(k=k.concat(Ga(a,null,c,d)))}),d.addLayers(k))}function ib(a){b.forEach(a,function(a){var d=a.layer;d.toJson&&(a=d.toJson(),a.featureSet&&d.name&&-1<d.name.indexOf("Text")&&b.forEach(a.featureSet.features,function(a,c){if(a.attributes.TEXT){var e=d.graphics[c];e.symbol.setText(a.attributes.TEXT);a.symbol.horizontalAlignment&&(e.symbol.align=a.symbol.horizontalAlignment);e.setSymbol(e.symbol);e.setAttributes(a.attributes)}},this))})}function Na(a){var d=6;b.forEach(a,function(a){if(a=
a.renderer)"esri.renderer.SimpleRenderer"===a.declaredClass?((a=a.symbol)&&a.xoffset&&(d=Math.max(d,Math.abs(a.xoffset))),a&&a.yoffset&&(d=Math.max(d,Math.abs(a.yoffset)))):"esri.renderer.UniqueValueRenderer"!==a.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==a.declaredClass||b.forEach(a.infos,function(a){(a=a.symbol)&&a.xoffset&&(d=Math.max(d,Math.abs(a.xoffset)));a&&a.yoffset&&(d=Math.max(d,Math.abs(a.yoffset)))})});return d}function Xa(a){var d=this,c=d.infoWindow,e=a.graphic;if(d.loaded){c.hide();
c.clearFeatures();var k=[];b.forEach(d.graphicsLayerIds,function(a){(a=d.getLayer(a))&&a instanceof L&&a.loaded&&a.visible&&(a.clearSelection(),a.infoTemplate&&!a.suspended&&k.push(a))});b.forEach(d.layerIds,function(a){(a=d.getLayer(a))&&-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")&&a.loaded&&a.visible&&a.infoTemplate&&k.push(a)});e=e&&e.getInfoTemplate()?e:null;if(k.length||e){var t=Na(k),q=a.screenPoint,g=d.toMap(new x(q.x-t,q.y+t)),t=d.toMap(new x(q.x+t,q.y-t)),g=new A(g.x,g.y,t.x,
t.y,d.spatialReference),w=new G;w.geometry=g;w.timeExtent=d.timeExtent;var u=!0,g=b.map(k,function(d){var c;-1!==d.declaredClass.indexOf("ArcGISImageServiceLayer")?(w.geometry=a.mapPoint,u=!1,c=d.queryVisibleRasters(w,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),c.addCallback(function(){return d.getVisibleRasters()})):(c=d.selectFeatures(w),c.addCallback(function(){return d.getSelectedFeatures()}));return c});e&&(t=new l,t.callback([e]),g.splice(0,0,t));if(!b.some(g,function(a){return-1===
a.fired})){var v=e?1:0;b.forEach(k,function(a){v=-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")?v+a.getVisibleRasters().length:v+a.getSelectedFeatures().length});if(!v)return}c.setFeatures(g);c.show(a.mapPoint,{closestFirst:u})}}}function T(a,d){var c=d.mapOptions||{},b;c.infoWindow||(b=new E({visibleWhenEmpty:!1},e.create("div")),c.infoWindow=b);q.isDefined(c.showInfoWindowOnClick)||d.usePopupManager||(c.showInfoWindowOnClick=!1);c=new w(a,c);m.connect(c,"onLayersAddResult",ib);return c}
function Aa(a,d,c,e,k,t){var q,g,w,u;e.map?(q=e.map,g=e.clickEventHandle,w=e.clickEventListener,u=e.errors):(q=T(e,k),k.ignorePopups||k.disableClickBehavior||k.usePopupManager||(g=m.connect(q,"onClick",Xa),w=Xa));q.addLayers(a);k.ignorePopups||k.usePopupManager||ab(a,q,k._clazz);var v=u||[];b.forEach(d,function(a){a.errors&&(v=v.concat(a.errors))},this);q.loaded?t.callback({map:q,itemInfo:c,errors:v,clickEventHandle:g,clickEventListener:w}):m.connect(q,"onLoad",function(){t.callback({map:q,itemInfo:c,
errors:v,clickEventHandle:g,clickEventListener:w})})}function ra(a,d,c,e,k){var t=[];b.forEach(k,function(a){f.isArray(a.layerObject)?b.forEach(a.layerObject,function(a){t.push(a)}):t.push(a.layerObject)});if("BingMapsAerial"===k[0].type||"BingMapsRoad"===k[0].type||"BingMapsHybrid"===k[0].type)var q=setInterval(function(){if(k[0].layerObject&&k[0].layerObject.loaded)clearInterval(q),aa(a,d,c,e,k,t);else if(k[0].errors){clearInterval(q);var b="";k[0].errors&&k[0].errors.length&&(b=" ("+k[0].errors[0].message+
")");e.errback(Error(P.arcgis.utils.baseLayerError+b))}},10);else if(!t[0]&&k[0].baseMapLayer){var g="";k[0].errors&&k[0].errors.length&&(g=" ("+k[0].errors[0].message+")");e.errback(Error(P.arcgis.utils.baseLayerError+g))}else aa(a,d,c,e,k,t)}function aa(a,c,e,k,t,g){try{var w=e.mapOptions||{};e.mapOptions=w;var x=a.item,f=a.itemData;!w.backgroundColor&&f.background&&f.background.color&&null!=f.background.color[0]&&(w.backgroundColor=v.toDojoColor(f.background.color));g=b.filter(g,q.isDefined);if(x)if(x.extent&&
x.extent.length)if(w.extent)Aa(g,t,a,c,e,k);else{var n=new A(x.extent[0][0],x.extent[0][1],x.extent[1][0],x.extent[1][1],new d({wkid:4326})),h=g[0].spatialReference;4326===h.wkid?(w.extent=n,Aa(g,t,a,c,e,k)):102100===h.wkid||102113===h.wkid||3857===h.wkid?(n.xmin=Math.max(n.xmin,-180),n.xmax=Math.min(n.xmax,180),n.ymin=Math.max(n.ymin,-89.99),n.ymax=Math.min(n.ymax,89.99),w.extent=y.geographicToWebMercator(n),Aa(g,t,a,c,e,k)):e.geometryServiceURL||u.defaults.geometryService?(e.geometryServiceURL?
new I(e.geometryServiceURL):u.defaults.geometryService).project([n],h,function(d){d=d[0];w.extent=w.extent||d;Aa(g,t,a,c,e,k)},function(){Aa(g,t,a,c,e,k)}):k.errback(Error(P.arcgis.utils.geometryServiceError))}else Aa(g,t,a,c,e,k);else Aa(g,t,a,c,e,k)}catch(yb){k.errback(yb)}}function Sa(a){var d=[];b.forEach(a.operationalLayers,function(a){a.featureCollection?d.push({featureCollection:a.featureCollection,visibility:a.visibility,title:a.title}):a.layerObject&&d.push({layer:a.layerObject,visibility:a.visibility,
title:a.title})});return d}function pa(a){var d=[];a=a.baseMap.baseMapLayers.concat(a.operationalLayers);b.forEach(a,function(a){var c={};if(a.featureCollection&&"CSV"!==a.type)!0===a.featureCollection.showLegend&&b.forEach(a.featureCollection.layers,function(e){if(!1!==e.showLegend){var b=e.layerObject.renderer;c={layer:e.layerObject,title:a.title,defaultSymbol:b&&b.defaultSymbol&&b.defaultLabel?!0:!1};1<a.featureCollection.layers.length&&(c.title+=" - "+e.layerDefinition.name);d.push(c)}});else if(a.baseMapLayer&&
!0===a.showLegend&&a.layerObject||!a.baseMapLayer&&!1!==a.showLegend&&a.layerObject&&!(a.layerObject instanceof L&&a.layerObject.mode===L.MODE_SELECTION)){var e=a.layerObject.renderer,k=a.layerObject.declaredClass,e=!e||e&&e.defaultSymbol&&e.defaultLabel?!0:!1;if(10.1>a.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===k||"esri.layers.ArcGISTiledMapServiceLayer"===k)||"esri.layers.ArcGISImageServiceLayer"===k)e=!0;c={layer:a.layerObject,title:a.title,defaultSymbol:e};a.layers&&(k=
b.map(b.filter(a.layers,function(a){return!1===a.showLegend}),function(a){return a.id}),k.length&&(c.hideLayers=k));d.push(c)}});return d}function ka(a,d){function c(a,d){b.forEach(a,function(a,c){switch(a){case "../layers/ArcGISDynamicMapServiceLayer":F=d[c];break;case "../layers/ArcGISImageServiceLayer":Z=d[c];break;case "../layers/ArcGISImageServiceVectorLayer":fa=d[c];break;case "./csv":qa=d[c];break;case "../layers/CSVLayer":X=d[c];break;case "../layers/DynamicLayerInfo":Y=d[c];break;case "../layers/GeoRSSLayer":O=
d[c];break;case "../layers/ImageParameters":ob=d[c];break;case "../layers/ImageServiceParameters":pb=d[c];break;case "../layers/KMLLayer":sb=d[c];break;case "../layers/LabelClass":ub=d[c];break;case "../layers/LayerDrawingOptions":Qa=d[c];break;case "../layers/MosaicRule":rb=d[c];break;case "../layers/OpenStreetMapLayer":Ab=d[c];break;case "../layers/RasterFunction":qb=d[c];break;case "../layers/StreamLayer":Za=d[c];break;case "../layers/TileInfo":jb=d[c];break;case "../layers/VectorTileLayer":eb=
d[c];break;case "../virtualearth/VETiledLayer":Pa=d[c];break;case "../layers/WebTiledLayer":tb=d[c];break;case "../layers/WFSLayer":Ra=d[c];break;case "../layers/WMSLayer":Ya=d[c];break;case "../layers/WMSLayerInfo":Bb=d[c]}})}var e=new l,k=a.itemData,t=[];k.baseMap&&k.baseMap.baseMapLayers&&(t=t.concat(k.baseMap.baseMapLayers));k.operationalLayers&&(t=t.concat(k.operationalLayers));for(var k=b.map(t,function(a){return a&&a.layerType}),q=[],g=[],t=!1,w=0;w<k.length;w++){switch(k[w]){case "ArcGISFeatureLayer":-1===
b.indexOf(q,"../layers/LabelClass")&&q.push("../layers/LabelClass");break;case "ArcGISImageServiceLayer":case "ArcGISTiledImageServiceLayer":-1===b.indexOf(q,"../layers/ArcGISImageServiceLayer")&&(q.push("../layers/ArcGISImageServiceLayer"),g.push("../layers/ImageServiceParameters"),g.push("../layers/MosaicRule"),g.push("../layers/RasterFunction"));break;case "ArcGISImageServiceVectorLayer":-1===b.indexOf(q,"../layers/ArcGISImageServiceVectorLayer")&&(q.push("../layers/ArcGISImageServiceVectorLayer"),
g.push("../layers/ImageServiceParameters"),g.push("../layers/MosaicRule"),g.push("../layers/RasterFunction"));break;case "ArcGISMapServiceLayer":case "ArcGISTiledMapServiceLayer":-1===b.indexOf(q,"../layers/ArcGISDynamicMapServiceLayer")&&(q.push("../layers/ArcGISDynamicMapServiceLayer"),g.push("../layers/DynamicLayerInfo"),g.push("../layers/ImageParameters"),g.push("../layers/LayerDrawingOptions"));break;case "ArcGISStreamLayer":-1===b.indexOf(q,"../layers/StreamLayer")&&q.push("../layers/StreamLayer");
break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===b.indexOf(q,"../virtualearth/VETiledLayer")&&q.push("../virtualearth/VETiledLayer");break;case "CSV":-1===b.indexOf(q,"../layers/CSVLayer")&&(q.push("../layers/CSVLayer"),g.push("./csv"));break;case "GeoRSS":-1===b.indexOf(q,"../layers/GeoRSSLayer")&&q.push("../layers/GeoRSSLayer");break;case "KML":-1===b.indexOf(q,"../layers/KMLLayer")&&q.push("../layers/KMLLayer");break;case "OpenStreetMap":-1===b.indexOf(q,"../layers/OpenStreetMapLayer")&&
q.push("../layers/OpenStreetMapLayer");break;case "VectorTileLayer":-1===b.indexOf(q,"../layers/VectorTileLayer")&&q.push("../layers/VectorTileLayer");break;case "WebTiledLayer":-1===b.indexOf(q,"../layers/WebTiledLayer")&&(q.push("../layers/WebTiledLayer"),g.push("../layers/TileInfo"));break;case "WFS":-1===b.indexOf(q,"../layers/WFSLayer")&&q.push("../layers/WFSLayer");break;case "WMS":-1===b.indexOf(q,"../layers/WMSLayer")&&(q.push("../layers/WMSLayer"),g.push("../layers/WMSLayerInfo"));break;
default:t=!0}if(t)break}t&&(q=mb,g=Fb);q.length?p(q,function(){c(q,arguments);g.length?p(g,function(){c(g,arguments);e.resolve()}):e.resolve()}):e.resolve();return e}function Ta(a,d,c,e){var k=e.itemData;k.baseMap&&k.baseMap.baseMapLayers&&k.baseMap.baseMapLayers.length&&(k.baseMap.baseMapLayers[0].firstLayer=!0);var t=d.layerMixins,q=t&&t.length;if(q){var g=function(a){for(var d=0;d<q;d++){var c=t[d];if(c.mixin)if(c.hasOwnProperty("id")){if(a.id===c.id){f.mixin(a,c.mixin);break}}else if(a.url===
c.url){f.mixin(a,c.mixin);break}}};b.forEach(k.baseMap&&k.baseMap.baseMapLayers,g);b.forEach(k.operationalLayers,g)}ka(e,d).then(function(){return N(e,d)}).then(function(){return ba(e,d)}).then(function(d){var e=d[0],k=d[1];if(e.itemData.operationalLayers&&0!==e.itemData.operationalLayers.length){var t=new l,q=e.itemData.baseMap.baseMapLayers.slice(),g=b.filter(e.itemData.baseMap.baseMapLayers,function(a){return!a.isReference});d={item:e.item,itemData:{baseMap:{baseMapLayers:g}}};e.itemData.baseMap.baseMapLayers=
b.filter(e.itemData.baseMap.baseMapLayers,function(a){return a.isReference});S(d,k).addCallback(function(d){Ma(d.itemData,k).addCallback(f.hitch(null,ra,d,a,k,t))});t.then(function(a){S(e,k).addCallback(function(d){Ma(d.itemData,k,a.map.spatialReference,g,a.map).addCallback(function(e){d.itemData.baseMap.baseMapLayers=q;ra(d,a,k,c,e)})})},f.hitch(c,c.errback))}else S(e,k).addCallback(function(d){Ma(d.itemData,k).addCallback(f.hitch(null,ra,d,a,k,c))})})}function R(a,d){"undefined"===typeof d&&(d=
!0);da._arcgisUrl&&0<da._arcgisUrl.length&&(da.arcgisUrl=da._arcgisUrl);var c=da.arcgisUrl+"/"+a,e={},b=new l;k({url:c,content:{f:"json"},callbackParamName:"callback",load:function(a){e.item=a;d?k({url:c+"/data",content:{f:"json"},callbackParamName:"callback",load:function(a){e.itemData=a;b.callback(e)},error:function(a){b.errback(a)}}):b.callback(e)},error:function(a){b.errback(a)}});return b}var da,F,Z,fa,qa,X,Y,O,ob,pb,sb,ub,Qa,rb,Ab,qb,Za,jb,eb,Pa,tb,Ra,Ya,Bb,mb="../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/ArcGISImageServiceVectorLayer ../layers/CSVLayer ../layers/GeoRSSLayer ../layers/KMLLayer ../layers/LabelClass ../layers/OpenStreetMapLayer ../layers/StreamLayer ../layers/VectorTileLayer ../virtualearth/VETiledLayer ../layers/WebTiledLayer ../layers/WFSLayer ../layers/WMSLayer".split(" "),
Fb="./csv ../layers/DynamicLayerInfo ../layers/ImageParameters ../layers/ImageServiceParameters ../layers/LayerDrawingOptions ../layers/MosaicRule ../layers/RasterFunction ../layers/TileInfo ../layers/WMSLayerInfo".split(" ");da={arcgisUrl:t.getProtocolForWebResource()+"//www.arcgis.com/sharing/rest/content/items",getItem:R,createMap:function(a,d,c){var e=new l;c=c||{};var b=c.infoTemplateClass;c._clazz=b&&(f.isObject(b)?b:f.getObject(b))||B;f.isString(a)?R(a).addCallback(f.hitch(null,Ta,d,c,e)).addErrback(f.hitch(e,
e.errback)):Ta(d,c,e,a);return e},getLayerList:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?Sa(a.itemInfo.itemData):[]},getLegendLayers:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?pa(a.itemInfo.itemData):[]},_arcgisUrl:null,_getItemProps:S,_getItemData:Q,_getBingKey:H,_portalUrlResponse:M,_portalUrlFailure:W,_processFSItemProperties:K,_processSSItemProperties:V,_getLayers:Ma,_preBuildLayerObjects:za,_buildLayerObjects:ia,_preCreateMap:ra,_getMapSR:ma,_createMap:Aa,_addSelectionLayers:ab,
_createSelectionFeatureLayers:Ga,_getServiceInfo:Ca,_getFeatureCollectionItem:wa,_mergeFeatureCollectionItem:sa,_projectFeatureCollection:Fa,_getLayersInfo:Wa,_initLayer:Ea,_loadAsCached:ea,_loadAsDynamic:ha,_processPopups:D,_onLayersAddResult:ib,_sameSpatialReferenceAsBasemap:la,_sameTilingSchemeAsBasemap:va,_showPopup:Xa,_calculateClickTolerance:Na,_getVisibleFeatureLayers:ua,_updateLayerScaleInfo:Ja,_checkUrl:ca,_isHostedService:ja,_isAgolService:na,_getLegendLayers:pa};f.setObject("arcgis.utils",
da,a);return da})},"dojo/_base/url":function(){define(["./kernel"],function(p){var f=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,b=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,m=function(){for(var l=arguments,h=[l[0]],r=1;r<l.length;r++)if(l[r]){var n=new m(l[r]+""),h=new m(h[0]+"");if(""==n.path&&!n.scheme&&!n.authority&&!n.query)null!=n.fragment&&(h.fragment=n.fragment),n=h;else if(!n.scheme&&(n.scheme=h.scheme,!n.authority&&(n.authority=h.authority,"/"!=n.path.charAt(0)))){for(var h=
(h.path.substring(0,h.path.lastIndexOf("/")+1)+n.path).split("/"),g=0;g<h.length;g++)"."==h[g]?g==h.length-1?h[g]="":(h.splice(g,1),g--):0<g&&(1!=g||""!=h[0])&&".."==h[g]&&".."!=h[g-1]&&(g==h.length-1?(h.splice(g,1),h[g-1]=""):(h.splice(g-1,2),g-=2));n.path=h.join("/")}h=[];n.scheme&&h.push(n.scheme,":");n.authority&&h.push("//",n.authority);h.push(n.path);n.query&&h.push("?",n.query);n.fragment&&h.push("#",n.fragment)}this.uri=h.join("");l=this.uri.match(f);this.scheme=l[2]||(l[1]?"":null);this.authority=
l[4]||(l[3]?"":null);this.path=l[5];this.query=l[7]||(l[6]?"":null);this.fragment=l[9]||(l[8]?"":null);null!=this.authority&&(l=this.authority.match(b),this.user=l[3]||null,this.password=l[4]||null,this.host=l[6]||l[7],this.port=l[9]||null)};m.prototype.toString=function(){return this.uri};return p._Url=m})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(p,f,b){p.DeferredList=function(m,l,h,r,n){var g=[];f.call(this);var e=this;0!==m.length||l||
this.resolve([0,[]]);var c=0;b.forEach(m,function(a,b){function u(a,k){g[b]=[a,k];c++;c===m.length&&e.resolve(g)}a.then(function(a){l?e.resolve([b,a]):u(!0,a)},function(a){h?e.reject(a):u(!1,a);if(r)return null;throw a;})})};p.DeferredList.prototype=new f;p.DeferredList.prototype.gatherResults=function(f){f=new p.DeferredList(f,!1,!0,!1);f.addCallback(function(f){var h=[];b.forEach(f,function(b){h.push(b[1])});return h});return f};return p.DeferredList})},"esri/config":function(){define(["dojo/_base/config",
"dojo/topic","dojo/has","./kernel"],function(p,f,b,m){b=function(){return this}();m={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},
zoomDuration:500,zoomRate:25,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:b.Worker&&!1,io:{errorHandler:function(b,h){f.publish("esri.Error",[b])},proxyUrl:null,alwaysUseProxy:!1,useCors:"with-credentials",corsEnabledServers:"server.arcgisonline.com services.arcgisonline.com www.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com basemaps.arcgis.com basemapsbeta.arcgis.com elevation3d.arcgis.com services.arcgis.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com services6.arcgis.com services7.arcgis.com static.arcgis.com utility.arcgisonline.com geocode.arcgis.com geoenrich.arcgis.com qaext.arcgis.com tilesqa.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com geocodeqa.arcgis.com geoenrichqa.arcgis.com dev.arcgis.com devext.arcgis.com localvtiles.arcgis.com staticdev.arcgis.com tilesdevext.arcgis.com elevation3ddev.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com geocodedev.arcgis.com geoenrichdev.arcgis.com basemapsdev.arcgis.com basemapsbetadev.arcgis.com".split(" "),
corsDetection:b.cordova?!1:!0,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5,httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}}}};p.noGlobals||(b.esriConfig=m);return m})},"esri/Color":function(){define(["dojo/_base/declare",
"dojo/_base/Color","dojo/has","./kernel"],function(p,f,b,m){p=p([f],{declaredClass:"esri.Color"});p.toJsonColor=function(b){return b&&[b.r,b.g,b.b,1<b.a?b.a:Math.round(255*b.a)]};p.toDojoColor=function(b){return b&&new f([b[0],b[1],b[2],b[3]/255])};m="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(b=0;b<m.length;b++)p[m[b]]=f[m[b]];return p})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/io/script dojo/io/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d){function w(a){a=new h(a);return(a.host+(a.port?":"+a.port:"")).toLowerCase()}function t(a){return this._xhr?this._xhr.getResponseHeader(a):null}function x(d,t,w,u){var x=!1,h=!1,y;q.isDefined(t)&&(l.isObject(t)?(x=!!t.useProxy,h=!!t.usePost,y=t.crossOrigin):x=!!t);d=l.mixin({},d);d._ssl&&(d.url=d.url.replace(/^http:/i,"https:"));10>v("ie")&&!J.test(d.url)&&(d.url=encodeURI(d.url));t=d.content;var A=d.url,z=w&&d.form,C=E;y=q.isDefined(y)?y:C.useCors;d.load=
function(a){var d;a&&(a.error?(d=l.mixin(Error(),a.error),d.log=b.isDebug):"error"===a.status&&(d=l.mixin(Error(),a),d.log=b.isDebug),d&&!q.isDefined(d.httpCode)&&(d.httpCode=d.code));return d||a};d.error=function(a,d){d&&d.xhr&&d.xhr.abort();a instanceof Error||(a=l.mixin(Error(),a));a.log=b.isDebug;C.errorHandler(a,d);return a};d._token&&(d.content=d.content||{},d.content.token=d._token);var P=0,G;t&&A&&(G=c.objectToQuery(t),P=G.length+A.length+1,v("esri-url-encodes-apostrophe")&&(P=G.replace(/'/g,
"%27").length+A.length+1));d.timeout=q.isDefined(d.timeout)?d.timeout:C.timeout;d.handleAs=d.handleAs||"json";try{var p,H,L=y&&k.canUseXhr(d.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(d.url),Q=k.hasSameOrigin(d.url,window.location.href)||L,ea=h||w||P>C.postLength?!0:!1,ua=Q||-1===d.handleAs.indexOf("json")||!d.callbackParamName||w?!1:!0,ha=k.getProxyRule(d.url)||C.alwaysUseProxy||x||(!ua||ea)&&!Q?!0:!1;w&&!v("esri-file-upload")&&!ha&&L&&(ha=!0);if(ha)if(p=k.getProxyUrl(A,y),H=p.path,
p._xo&&(L=!0),!ea&&H.length+1+P>C.postLength&&(ea=!0),d.url=H+"?"+A,ea)d.content=l.mixin(p.query||{},t);else{var oa=c.objectToQuery(l.mixin(p.query||{},t));oa&&(d.url+="?"+oa);d.content=null}if(ua&&!ea)return!q.isDefined(d.isAsync)&&4>v("ff")&&(d.isAsync=!0),n.get(B?B(d):d);var la=d.headers;!L||la&&la.hasOwnProperty("X-Requested-With")||(la=d.headers=la||{},la["X-Requested-With"]=null);if(w){var va=d.callbackParamName||"callback.html",Ea=d.callbackElementName||"textarea",ia,ma,za,Ba,Ca=z.elements?
z.elements.length:0,wa;if(t=d.content)for(ia in t)if(za=t[ia],q.isDefined(za)){ma=null;for(Ba=0;Ba<Ca;Ba++)if(wa=z.elements[Ba],wa.name===ia){ma=wa;break}ma?ma.value=za:u?z.append(ia,za):z.appendChild(e.create("input",{type:"hidden",name:ia,value:za}))}if(v("esri-file-upload"))f.forEach(z.elements,function(a){a.name===va&&z.removeChild(a)}),d.contentType=!1,d.postData=u?z:new FormData(z),delete d.form;else{z.enctype="multipart/form-data";9>v("ie")&&(z.encoding="multipart/form-data");z.method="post";
f.some(z.elements,function(a){return a.name===va})||z.appendChild(e.create("input",{type:"hidden",name:va,value:Ea}));if(-1!==A.toLowerCase().indexOf("addattachment")||-1!==A.toLowerCase().indexOf("updateattachment"))d.url=A+(-1===A.indexOf("?")?"?":"\x26")+va+"\x3d"+Ea,ha&&(d.url=H+"?"+d.url);delete d.content}}if(L&&!d.hasOwnProperty("withCredentials")&&"with-credentials"===E.useCors){u=ha?H:A;var sa=k.canUseXhr(u,!0),Fa=-1<sa?E.corsEnabledServers[sa]:null;if(Fa&&Fa.hasOwnProperty("withCredentials"))Fa.withCredentials&&
(d.withCredentials=!0);else if(a.id){var Ma=a.id.findServerInfo(u);Ma&&Ma.webTierAuth&&(d.withCredentials=!0)}}d=B?B(d):d;if(ea){if(w&&!v("esri-file-upload"))return g.send(d);!ha&&v("safari")&&(d.url+=(-1===d.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+I++);return r.post(d)}return r.get(d)}catch(La){return w=new m,w.errback(d.error(La)),w}}function A(a){var d=E.corsStatus,c=k.canUseXhr(a,!0);-1<c&&E.corsEnabledServers.splice(c,1);d[w(a)]=1;return c}function y(a){var d=E.corsStatus;
if(E.corsDetection&&E.useCors)try{var c=w(a);!v("esri-cors")||!a||-1===a.toLowerCase().indexOf("/rest/services")||k.hasSameOrigin(a,window.location.href)||k.canUseXhr(a)||d[c]||(d[c]=-1,r.get({url:a.substring(0,a.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null}}).then(function(e){e?(d[c]=2,k.canUseXhr(a)||E.corsEnabledServers.push(c)):d[c]=1},function(a){d[c]=1}))}catch(H){console.log("esri._detectCors: an unknown error occurred while detecting CORS support")}}
function z(c,e){function g(d){d._pendingDfd=x(c,e,I,J);if(!d._pendingDfd){d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;var k=Error("Deferred object is missing");k.log=b.isDebug;c._usrDfd=null;d.errback(k);d._pendingDfd=null;return d}d._pendingDfd.addCallback(function(a){d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;c._usrDfd=null;e.returnFullResponse&&(a={data:a,_xhr:d.ioArgs&&d.ioArgs.xhr,getHeader:t});d.callback(a);d._pendingDfd=null}).addErrback(function(b){var k,t,g;b&&(k=b.code,t=b.subcode,g=
(g=b.messageCode)&&g.toUpperCase());if(b&&403==k&&(4==t||b.message&&-1<b.message.toLowerCase().indexOf("ssl")&&-1===b.message.toLowerCase().indexOf("permission"))){if(!c._ssl){c._ssl=c._sslFromServer=!0;c._usrDfd=d;z(c,e);return}}else if(b&&415==b.status){if(A(c.url),!c._err415){c._err415=1;c._usrDfd=d;z(c,e);return}}else if(a.id&&-1!==f.indexOf(a.id._errorCodes,k)&&!a.id._isPublic(c.url)&&!h&&(403!=k||-1===f.indexOf(G,g)&&(!q.isDefined(t)||2==t&&c._token))){d._pendingDfd=a.id.getCredential(c.url,
{token:c._token,error:b});d._pendingDfd.addCallback(function(a){c._token=a.token;c._usrDfd=d;c._credential=a;c._ssl=c._sslFromServer||a.ssl;z(c,e)}).addErrback(function(a){c._usrDfd=null;d.errback(a);d._pendingDfd=null});return}d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;c._usrDfd=null;d.errback(b);d._pendingDfd=null})}c.url=k.fixUrl(c.url);e=e||{};var u,n=c.form,h=e.disableIdentityLookup,l=e._preLookup,B=!1;if(v("esri-workers")&&!1!==E.useWorkers)if(!0===e.useWorkers||!0===E.useWorkers)B=!0;else if(e.workerOptions){var P=
e.workerOptions;if(P.callback||P.worker&&P.worker.worker instanceof Worker)B=!0}var J=n&&v("esri-file-upload")&&n instanceof FormData,I=n&&(n.elements?f.some(n.elements,function(a){return"file"===a.type}):J),L=-1!==c.url.toLowerCase().indexOf("token\x3d")||c.content&&c.content.token||I&&f.some(n.elements,function(a){return"token"===a.name})?1:0;y(c.url);if(c._usrDfd)u=c._usrDfd;else{u=new m(d._dfdCanceller);u.addCallback(function(d){if((/\/sharing\/rest\/accounts\/self/i.test(c.url)||/\/sharing\/rest\/portals\/self/i.test(c.url))&&
!L&&!c._token&&d.user&&d.user.username){E.webTierAuthServers.push(w(c.url));d=E.corsEnabledServers;var e=k.canUseXhr(c.url,!0),b={host:w(c.url),withCredentials:!0};if(-1===e)d.push(b);else{var t=d[e];"object"===typeof t?t.withCredentials=!0:d.splice(e,1,b)}}if(d=c._credential)if(e=(e=a.id.findServerInfo(d.server))&&e.owningSystemUrl)e=e.replace(/\/?$/,"/sharing"),(d=a.id.findCredential(e,d.userId))&&-1===a.id._getIdenticalSvcIdx(e,d)&&d.resources.splice(0,0,e)});u.addBoth(function(a){delete c._credential;
!a||v("ie")&&a.nodeType||(a._ssl=c._ssl)});var D=c.load,ja=c.error;D&&u.addCallback(function(a){var d=u._pendingDfd,d=d&&d.ioArgs;return D.call(d&&d.args,a,d)});ja&&u.addErrback(function(a){var d=u._pendingDfd,d=d&&d.ioArgs;return ja.call(d&&d.args,a,d)})}!a.id||L||c._token||a.id._isPublic(c.url)||h&&!l||!(n=a.id.findCredential(c.url))||(c._token=n.token,c._ssl=n.ssl);B?e.workerOptions&&e.workerOptions.worker?(C||(C=r),r=e.workerOptions.worker,g(u)):p(["./workers/RequestClient"],function(a){C||(C=
r);if(e.workerOptions){var d=e.workerOptions;r=a.getClient(d.callback,d.cbFunction)}else r=a.getClient();g(u)}):(C&&(r=C,C=null),g(u));return u}var C=null,B,E=u.defaults.io,G=["COM_0056","COM_0057"],I=0,J=/%[0-9A-F]{2}/i;z._request=x;z._disableCors=A;z._detectCors=y;z.setRequestPreCallback=function(a){B=a};return z})},"dojo/io/script":function(){define("../_base/connect ../_base/kernel ../_base/lang ../sniff ../_base/window ../_base/xhr ../dom ../dom-construct ../request/script ../aspect".split(" "),
function(p,f,b,m,l,h,r,n,g,e){f.deprecated("dojo/io/script","Use dojo/request/script.","2.0");var c={get:function(a){var b,v=this._makeScriptDeferred(a,function(a){b&&b.cancel()}),q=v.ioArgs;h._ioAddQueryToUrl(q);h._ioNotifyStart(v);b=g.get(q.url,{timeout:a.timeout,jsonp:q.jsonp,checkString:a.checkString,ioArgs:q,frameDoc:a.frameDoc,canAttach:function(a){q.requestId=a.id;q.scriptId=a.scriptId;q.canDelete=a.canDelete;return c._canAttach(q)}},!0);e.around(b,"isValid",function(a){return function(d){c._validCheck(v);
return a.call(this,d)}});b.then(function(){v.resolve(v)}).otherwise(function(a){v.ioArgs.error=a;v.reject(a)});return v},attach:g._attach,remove:g._remove,_makeScriptDeferred:function(a,e){var b=h._ioSetArgs(a,e||this._deferredCancel,this._deferredOk,this._deferredError),q=b.ioArgs;q.id=f._scopeName+"IoScript"+(a.callbackSuffix||this._counter++);q.canDelete=!1;q.jsonp=a.callbackParamName||a.jsonp;q.jsonp&&(q.query=q.query||"",0<q.query.length&&(q.query+="\x26"),q.query+=q.jsonp+"\x3d"+(a.frameDoc?
"parent.":"")+f._scopeName+".io.script.jsonp_"+q.id+"._jsonpCallback",q.frameDoc=a.frameDoc,q.canDelete=!0,b._jsonpCallback=this._jsonpCallback,this["jsonp_"+q.id]=b);b.addBoth(function(a){q.canDelete&&(a instanceof Error?c["jsonp_"+q.id]._jsonpCallback=function(){delete c["jsonp_"+q.id];if(q.requestId)f.global[g._callbacksProperty][q.requestId]()}:c._addDeadScript(q))});return b},_deferredCancel:function(a){a.canceled=!0},_deferredOk:function(a){a=a.ioArgs;return a.json||a.scriptLoaded||a},_deferredError:function(a,
c){console.log("dojo.io.script error",a);return a},_deadScripts:[],_counter:1,_addDeadScript:function(a){c._deadScripts.push({id:a.id,frameDoc:a.frameDoc});a.frameDoc=null},_validCheck:function(a){if((a=c._deadScripts)&&0<a.length){for(var e=0;e<a.length;e++)c.remove(a[e].id,a[e].frameDoc),delete c["jsonp_"+a[e].id],a[e].frameDoc=null;c._deadScripts=[]}return!0},_ioCheck:function(a){a=a.ioArgs;return a.json||a.scriptLoaded&&!a.args.checkString?!0:(a=a.args.checkString)&&eval("typeof("+a+") !\x3d 'undefined'")},
_resHandle:function(a){c._ioCheck(a)?a.callback(a):a.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},_jsonpCallback:function(a){this.ioArgs.json=a;if(this.ioArgs.requestId)f.global[g._callbacksProperty][this.ioArgs.requestId](a)}};b.setObject("dojo.io.script",c);return c})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){b.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");h=u._iframeName;h=h.substring(0,h.lastIndexOf("_"));var v=m.delegate(u,{create:function(){return v._frame=u.create.apply(u,arguments)},get:null,post:null,send:function(c){var e,d=l._ioSetArgs(c,function(a){e&&e.cancel()},function(a){var d=null;a=a.ioArgs;try{var c=a.handleAs;"xml"===c||"html"===c?d=e.response.data:(d=e.response.text,"json"===c?d=f.fromJson(d):"javascript"===c&&(d=b.eval(d)))}catch(B){d=
B}return d},function(a,d){d.ioArgs._hasError=!0;return a}),q=d.ioArgs,t="GET",g=n.byId(c.form);c.method&&"POST"===c.method.toUpperCase()&&g&&(t="POST");c={method:t,handleAs:"json"===c.handleAs||"javascript"===c.handleAs?"text":c.handleAs,form:c.form,query:g?null:c.content,data:g?c.content:null,timeout:c.timeout,ioArgs:q};c.method&&(c.method=c.method.toUpperCase());if(p.ioPublish&&b.publish&&!1!==q.args.ioPublish)var v=a.after(u,"_notifyStart",function(a){a.options.ioArgs===q&&(v.remove(),l._ioNotifyStart(d))},
!0);e=u(q.url,c,!0);q._callNext=e._callNext;e.then(function(){d.resolve(d)}).otherwise(function(a){d.ioArgs.error=a;d.reject(a)});return d},_iframeOnload:r.global[h+"_onload"]});m.setObject("dojo.io.iframe",v);return v})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a){function u(a){return!this.isFulfilled()}function v(a){return!!this._finished}
function q(a,c){if(!c)try{var e=a.options,b=d.doc(d._frame),k=e.handleAs;if("html"!==k){if("xml"===k)if("html"===b.documentElement.tagName.toLowerCase()){n("a",b.documentElement).orphan();var t=b.documentElement.innerText||b.documentElement.textContent,t=t.replace(/>\s+</g,"\x3e\x3c");a.text=h.trim(t)}else a.data=b;else a.text=b.getElementsByTagName("textarea")[0].value;l(a)}else a.data=b}catch(G){c=G}c?this.reject(c):this._finished?this.resolve(a):this.reject(Error("Invalid dojo/request/iframe request state"))}
function k(a){this._callNext()}function d(a,c,e){var g=m.parseArgs(a,m.deepCreate(x,c),!0);a=g.url;c=g.options;if("GET"!==c.method&&"POST"!==c.method)throw Error(c.method+" not supported by dojo/request/iframe");d._frame||(d._frame=d.create(d._iframeName,t+"();"));a=m.deferred(g,null,u,v,q,k);a._callNext=function(){this._calledNext||(this._calledNext=!0,d._currentDfd=null,d._fireNextRequest())};a._legacy=e;d._dfdQueue.push(a);d._fireNextRequest();b(a);return e?a:a.promise}var w=p.id.replace(/[\/\.\-]/g,
"_"),t=w+"_onload";a.global[t]||(a.global[t]=function(){var a=d._currentDfd;if(a){var b=e.byId(a.response.options.form)||a._tmpForm;if(b){for(var k=a._contentToClean,t=0;t<k.length;t++)for(var q=k[t],g=0;g<b.childNodes.length;g++){var w=b.childNodes[g];if(w.name===q){c.destroy(w);break}}a._originalAction&&b.setAttribute("action",a._originalAction);a._originalMethod&&(b.setAttribute("method",a._originalMethod),b.method=a._originalMethod);a._originalTarget&&(b.setAttribute("target",a._originalTarget),
b.target=a._originalTarget)}a._tmpForm&&(c.destroy(a._tmpForm),delete a._tmpForm);a._finished=!0}else d._fireNextRequest()});var x={method:"POST"};d.create=function(d,e,b){if(a.global[d])return a.global[d];if(a.global.frames[d])return a.global.frames[d];b||(g("config-useXDomain")&&!g("config-dojoBlankHtmlUrl")&&console.warn("dojo/request/iframe: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),
b=g("config-dojoBlankHtmlUrl")||f.toUrl("dojo/resources/blank.html"));e=c.place('\x3ciframe id\x3d"'+d+'" name\x3d"'+d+'" src\x3d"'+b+'" onload\x3d"'+e+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',a.body());return a.global[d]=e};d.doc=function(d){if(d.contentDocument)return d.contentDocument;var c=d.name;if(c){var e=a.doc.getElementsByTagName("iframe");if(d.document&&e[c].contentWindow&&e[c].contentWindow.document)return e[c].contentWindow.document;
if(a.doc.frames[c]&&a.doc.frames[c].document)return a.doc.frames[c].document}return null};d.setSrc=function(d,c,e){d=a.global.frames[d.name];d.contentWindow&&(d=d.contentWindow);try{e?d.location.replace(c):d.location=c}catch(C){console.log("dojo/request/iframe.setSrc: ",C)}};d._iframeName=w+"_IoIframe";d._notifyStart=function(){};d._dfdQueue=[];d._currentDfd=null;d._fireNextRequest=function(){var b;try{if(!d._currentDfd&&d._dfdQueue.length){do b=d._currentDfd=d._dfdQueue.shift();while(b&&(b.canceled||
b.isCanceled&&b.isCanceled())&&d._dfdQueue.length);if(!b||b.canceled||b.isCanceled&&b.isCanceled())d._currentDfd=null;else{var k=b.response,t=k.options,q=b._contentToClean=[],g=e.byId(t.form),u=m.notify,v=t.data||null,x;b._legacy||"POST"!==t.method||g?"GET"===t.method&&g&&-1<k.url.indexOf("?")&&(x=k.url.slice(k.url.indexOf("?")+1),v=h.mixin(r.queryToObject(x),v)):g=b._tmpForm=c.create("form",{name:w+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},a.body());if(g){if(!b._legacy){var f=
g;do f=f.parentNode;while(f&&f!==a.doc.documentElement);f||(g.style.position="absolute",g.style.left="-1000px",g.style.top="-1000px",a.body().appendChild(g));g.name||(g.name=w+"_form")}if(v){var f=function(a,d){c.create("input",{type:"hidden",name:a,value:d},g);q.push(a)},n;for(n in v){var l=v[n];if(h.isArray(l)&&1<l.length)for(x=0;x<l.length;x++)f(n,l[x]);else g[n]?g[n].value=l:f(n,l)}}var p=g.getAttributeNode("action"),H=g.getAttributeNode("method"),K=g.getAttributeNode("target");k.url&&(b._originalAction=
p?p.value:null,p?p.value=k.url:g.setAttribute("action",k.url));b._legacy?H&&H.value||(H?H.value=t.method:g.setAttribute("method",t.method)):(b._originalMethod=H?H.value:null,H?H.value=t.method:g.setAttribute("method",t.method));b._originalTarget=K?K.value:null;K?K.value=d._iframeName:g.setAttribute("target",d._iframeName);g.target=d._iframeName;u&&u.emit("send",k,b.promise.cancel);d._notifyStart(k);g.submit()}else t="",k.options.data&&(t=k.options.data,"string"!==typeof t&&(t=r.objectToQuery(t))),
f=k.url+(-1<k.url.indexOf("?")?"\x26":"?")+t,u&&u.emit("send",k,b.promise.cancel),d._notifyStart(k),d.setSrc(d._frame,f,!0)}}}catch(V){b.reject(V)}};m.addCommonMethods(d,["GET","POST"]);return d})},"esri/sniff":function(){define(["dojo/_base/sniff","./kernel"],function(p,f){var b=function(){return this}(),m=p("ff"),l=p("ie"),h=void 0===l&&7<=p("trident"),r=p("edge"),n=p("webkit"),g=p("opera"),e=p("chrome"),c=p("safari"),a=navigator.userAgent,u;(u=a.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&
p.add("esri-iphone",parseFloat(u[2].replace("_",".")));(u=a.match(/Android\s+(\d+\.\d+)/i))&&p.add("esri-android",parseFloat(u[1]));(u=a.match(/Fennec\/(\d+\.\d+)/i))&&p.add("esri-fennec",parseFloat(u[1]));0<=a.indexOf("BlackBerry")&&0<=a.indexOf("WebKit")&&p.add("esri-blackberry",1);p.add("esri-touch",p("esri-iphone")||p("esri-android")||p("esri-blackberry")||6<=p("esri-fennec")||(m||n)&&document.createTouch?!0:!1);(u=a.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&p.add("esri-mobile",
u);p.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled);f._getDOMAccessor=function(a){var c="";m?c="Moz":n?c="Webkit":l?c="ms":g&&(c="O");return c+a.charAt(0).toUpperCase()+a.substr(1)};p.add("esri-phonegap",!!b.cordova);p.add("esri-cors",p("esri-phonegap")||b.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest);p.add("esri-file-upload",b.FormData&&b.FileList?!0:!1);p.add("esri-workers",b.Worker?!0:!1);p.add("esri-transforms",h||r||9<=l||3.5<=m||4<=e||3.1<=c||10.5<=g||3.2<=
p("esri-iphone")||2.1<=p("esri-android"));p.add("esri-transitions",h||r||10<=l||4<=m||4<=e||3.1<=c||10.5<=g||3.2<=p("esri-iphone")||2.1<=p("esri-android"));p.add("esri-transforms3d",h||r||10<=m||12<=e||4<=c||3.2<=p("esri-iphone")||3<=p("esri-android"));p.add("esri-url-encodes-apostrophe",function(){if(b.document)return!1;var a=b.document.createElement("a");a.href="?'";return-1<a.href.indexOf("?%27")});3>p("esri-android")&&(p.add("esri-transforms",!1,!1,!0),p.add("esri-transitions",!1,!1,!0),p.add("esri-transforms3d",
!1,!1,!0));p.add("esri-will-change",p("esri-transforms")&&(52<=e||9.1<=c));f._css=function(a){var b=p("esri-transforms3d");void 0!==a&&null!==a?b=a:b&&(e||c&&!p("esri-iphone"))&&(b=!1);var k=b?"translate3d(":"translate(",d=b?e?",-1px)":",0px)":")",w=b?"scale3d(":"scale(",t=b?",1)":")",u=b?"rotate3d(0,0,1,":"rotate(",v=b?"matrix3d(":"matrix(",f=b?",0,0,":",",h=b?",0,0,0,0,1,0,":",",r=b?",0,1)":")";return{names:{transition:n&&"-webkit-transition"||m&&"MozTransition"||g&&"OTransition"||l&&"msTransition"||
"transition",transform:n&&"-webkit-transform"||m&&"MozTransform"||g&&"OTransform"||l&&"msTransform"||"transform",transformName:n&&"-webkit-transform"||m&&"-moz-transform"||g&&"-o-transform"||l&&"-ms-transform"||"transform",origin:n&&"-webkit-transform-origin"||m&&"MozTransformOrigin"||g&&"OTransformOrigin"||l&&"msTransformOrigin"||"transformOrigin",endEvent:n&&"webkitTransitionEnd"||m&&"transitionend"||g&&"oTransitionEnd"||l&&"MSTransitionEnd"||"transitionend"},translate:function(a,c){return k+a+
"px,"+c+"px"+d},scale:function(a){return w+a+","+a+t},rotate:function(a){return u+a+"deg)"},matrix:function(a){return v+a.xx+","+a.xy+f+a.yx+","+a.yy+h+a.dx.toFixed(10)+(m?"px,":",")+a.dy.toFixed(10)+(m?"px":"")+r},getScaleFromMatrix:function(a){if(!a)return 1;a=a.toLowerCase();var d=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(d.length,a.indexOf(",")))}}};return p})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),
function(p,f,b,m,l,h,r,n,g){var e=function(){return this}(),c={},a=r.defaults.io,u=/^[a-z][a-z0-9\+\-\.]*:/i,v=/^\s*http:/i;c.isHTTP=function(a){var c=e.location.protocol;return null==a?"http:"===c||"https:"===c:a?"https:"===c:"http:"===c};c.getProtocolForWebResource=function(a){return c.isHTTP()?e.location.protocol:a?"https:":"http:"};c.urlToObject=function(a){var c={},d=new b(a),e=a.indexOf("?");null===d.query?c={path:a,query:null}:(c.path=a.substring(0,e),c.query=m.queryToObject(d.query));d.fragment&&
(c.hash=d.fragment,null===d.query&&(c.path=c.path.substring(0,c.path.length-(d.fragment.length+1))));return c};c.getProxyUrl=function(b,k){var d=p.isString(b)?0===p.trim(b).toLowerCase().indexOf("https:"):b,q=a.proxyUrl,t,u,v=g.io.proxyNotSet;p.isString(b)&&(u=c.getProxyRule(b))&&(q=u.proxyUrl);if(!q)throw console.log(v),Error(v);d&&!1!==k&&0!==e.location.href.toLowerCase().indexOf("https:")&&(d=q,0!==d.toLowerCase().indexOf("http")&&(d=c.getAbsoluteUrl(d)),d=d.replace(/^http:/i,"https:"),c.canUseXhr(d)&&
(q=d,t=1));q=c.urlToObject(q);q._xo=t;return q};c.addProxy=function(e){var b=c.getProxyRule(e),d;b?d=c.urlToObject(b.proxyUrl):a.alwaysUseProxy&&(d=c.getProxyUrl());d&&(b=c.urlToObject(e),e=d.path+"?"+b.path,(d=m.objectToQuery(p.mixin(d.query||{},b.query)))&&(e+="?"+d));return e};c.addProxyRule=function(e){var b=e.urlPrefix=c.urlToObject(e.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),d=a.proxyRules,q,t=d.length,g,u=t;for(q=0;q<t;q++)if(g=d[q].urlPrefix,0===
b.indexOf(g)){if(b.length===g)return-1;u=q;break}else 0===g.indexOf(b)&&(u=q+1);d.splice(u,0,e);return u};c.getProxyRule=function(e){var b=a.proxyRules,d=b.length,q=c.urlToObject(e).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),t;for(e=0;e<d;e++)if(0===q.indexOf(b[e].urlPrefix)){t=b[e];break}return t};c.hasSameOrigin=function(a,c,d){a=a.toLowerCase();c=c.toLowerCase();var k=e.location.href.toLowerCase();a=0===a.indexOf("http")?new b(a):k=new b(k);c=0===c.indexOf("http")?
new b(c):p.isString(k)?new b(k):k;return(d||a.scheme===c.scheme)&&a.host===c.host&&a.port===c.port};c.canUseXhr=function(e,b){var d=n("esri-phonegap")?!0:!1,k=c.hasSameOrigin,t=a.corsEnabledServers,q,g=-1;!d&&n("esri-cors")&&t&&t.length&&(d=f.some(t,function(a,d){var c=a&&"object"===typeof a?a.host:a;return c&&(q=0!==p.trim(c).toLowerCase().indexOf("http"),k(e,q?"http://"+c:c)||q&&k(e,"https://"+c))?(g=d,!0):!1}));return b?g:d};c.getAbsoluteUrl=function(a){var b=c.getProtocolForWebResource();return p.isString(a)&&
!u.test(a)?0===a.indexOf("//")?b+a:0===a.indexOf("/")?b+"//"+e.location.host+a:l._appBaseUrl+a:a};c.fixUrl=function(a){a=c.getAbsoluteUrl(a);a=c.upgradeToHTTPS(a);return a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")};c.normalize=function(a){return c.fixUrl(a)};c.upgradeToHTTPS=function(a){var b=r.defaults.io.httpsDomains,d=c.isHTTP(!1),g=c.isHTTP(!0);if(!v.test(a))return a;a=p.trim(a);var t=a.indexOf("/",7),t=-1===t?a:a.slice(0,t),t=t.toLowerCase().slice(7);if(d&&t===e.location.host)return a;
d=!1;if(g&&t===e.location.host)d=!0;else if(b)for(g=0;g<b.length;g++){var q=b[g];if(t===q||h.endsWith(t,"."+q)){d=!0;break}}d&&(a=a.replace(v,"https:"));return a};return c})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(p,f,b){return{_dfdCanceller:function(b){b.canceled=!0;var f=b._pendingDfd;-1===b.fired&&f&&-1===f.fired&&f.cancel();b._pendingDfd=null},_fixDfd:function(b){var f=b.then;b.then=function(b,l,n){if(b){var g=b;b=function(e){return e&&e._argsArray?
g.apply(null,e):g(e)}}return f.call(this,b,l,n)};return b},_resDfd:function(b,f,h){var l=f.length;1===l?h?b.errback(f[0]):b.callback(f[0]):1<l?(f._argsArray=!0,b.callback(f)):b.callback()}}})},"esri/SpatialReference":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ./kernel ./lang".split(" "),function(p,f,b,m,l,h){m=[-2.0037508342788905E7,2.0037508342788905E7];l=[-2.0037508342787E7,2.0037508342787E7];return p(null,{declaredClass:"esri.SpatialReference",constructor:function(f){f&&
(b.isObject(f)?b.mixin(this,f):b.isString(f)?this.wkt=f:this.wkid=f)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:m,origin:l,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:m,origin:l,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:m,origin:l,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:m,origin:l,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==f.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==f.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(b){var f=!1;b&&(f=this.isWebMercator()&&4326===b.wkid||b.isWebMercator()&&4326===this.wkid);return f},isWebMercator:function(){return this._isWebMercator()},equals:function(b){var f=!1;b&&(this===b&&
(f=!0),this.wkid||b.wkid?f=this.wkid===b.wkid||this.isWebMercator()&&b.isWebMercator()||this.wkid===b.latestWkid||b.wkid===this.latestWkid:this.wkt&&b.wkt&&(f=this.wkt.toUpperCase()===b.wkt.toUpperCase()));return f},toJson:function(){var b=null,f=h.isDefined;f(this.wkid)?b={wkid:this.wkid}:f(this.wkt)&&(b={wkt:this.wkt});b&&f(this.latestWkid)&&(b.latestWkid=this.latestWkid);return b}})})},"esri/map":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/event dojo/on dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/a11yclick dijit/registry ./kernel ./config ./sniff ./lang ./_coremap ./MapNavigationManager dojo/i18n!./nls/jsapi".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C){var B={up:"panUp",right:"panRight",down:"panDown",left:"panLeft"},E={upperRight:"panUpperRight",lowerRight:"panLowerRight",lowerLeft:"panLowerLeft",upperLeft:"panUpperLeft"},G=m.connect,I=m.disconnect,J=u.create,L=q.set,P=l.hitch,Q=v.getMarginBox,H=f.deprecated,K=l.mixin,V=0;return b(y,{declaredClass:"esri.Map",constructor:function(a,d){K(this,{_slider:null,_navDiv:null,_mapParams:K({attributionWidth:.45,slider:!0,nav:!1,logo:!0,sliderStyle:"small",
sliderPosition:"top-left",sliderOrientation:"vertical",autoResize:!0},d||{})});K(this,{isDoubleClickZoom:!1,isShiftDoubleClickZoom:!1,isClickRecenter:!1,isScrollWheelZoom:!1,isPan:!1,isRubberBandZoom:!1,isKeyboardNavigation:!1,isPanArrows:!1,isZoomSlider:!1});l.isFunction(w._css)&&(w._css=w._css(this._mapParams.force3DTransforms),this.force3DTransforms=this._mapParams.force3DTransforms);var c=x("esri-transforms")&&x("esri-transitions");this.navigationMode=this._mapParams.navigationMode||c&&"css-transforms"||
"classic";"css-transforms"!==this.navigationMode||c||(this.navigationMode="classic");this.fadeOnZoom=A.isDefined(this._mapParams.fadeOnZoom)?this._mapParams.fadeOnZoom:"css-transforms"===this.navigationMode;"css-transforms"!==this.navigationMode&&(this.fadeOnZoom=!1);this.setMapCursor("default");this.smartNavigation=d&&d.smartNavigation;if(!(A.isDefined(this.smartNavigation)||!x("mac")||x("esri-touch")||x("esri-pointer")||3.5>=x("ff"))){var e=navigator.userAgent.match(/Mac\s+OS\s+X\s+([\d]+)(\.|\_)([\d]+)\D/i);
e&&A.isDefined(e[1])&&A.isDefined(e[3])&&(c=parseInt(e[1],10),e=parseInt(e[3],10),this.smartNavigation=10<c||10===c&&6<=e)}this.showAttribution=A.isDefined(this._mapParams.showAttribution)?this._mapParams.showAttribution:!0;this._onLoadHandler_connect=G(this,"onLoad",this,"_onLoadInitNavsHandler");var b=J("div",{"class":"esriControlsBR"+(this._mapParams.nav?" withPanArrows":"")},this.root);if(this.showAttribution)if(c=l.getObject("esri.dijit.Attribution",!1))this._initAttribution(c,b);else{var t=
V++,q=this;this._rids&&this._rids.push(t);p(["./dijit/Attribution"],function(a){var d=q._rids?h.indexOf(q._rids,t):-1;-1!==d&&(q._rids.splice(d,1),q._initAttribution(a,b))})}this._mapParams.logo&&(c={},6===x("ie")&&(c.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+p.toUrl("./images/map/logo-med.png")+"')"),this._ogol=J("div",{style:c,tabIndex:"0",title:"Esri"},b),this._setLogoSize(),this._onMapResizeLogo_connect=G(this,"onResize",this,
"_setLogoSize"),this._ogol_connect=G(this._ogol,k,this,"_openLogoLink"));this.navigationManager=new z(this);d&&d.basemap&&(this._onLoadFix=!0,this.setBasemap(d.basemap),this._onLoadFix=!1);if(this.autoResize=this._mapParams.autoResize)c=this._getEnclosingResizableWidget(this.container)||window,e=this.resize,this._rszSignal=n.pausable(c,"resize",e),this._oriSignal=n.pausable(window,"orientationchange",e),g.after(c,"resize",e,!0),this._startResizeTimer()},_startResizeTimer:function(){clearTimeout(this._persistentTimer);
this._persistentTimer=setTimeout(this._timedResize,2*this.resizeDelay)},_getEnclosingResizableWidget:function(a){var c=d.getEnclosingWidget(a);return c?c.resize?c:this._getEnclosingResizableWidget(a.parentNode):c},_setLogoSize:function(){this._ogol&&(25E4>this.root.clientWidth*this.root.clientHeight?(a.remove(this._ogol,"logo-med"),a.add(this._ogol,"logo-sm")):(a.remove(this._ogol,"logo-sm"),a.add(this._ogol,"logo-med")))},_initAttribution:function(d,c){var e=J("span",{"class":"esriAttribution"},
c,"first");L(e,"maxWidth",Math.floor(this.width*this._mapParams.attributionWidth)+"px");this._connects.push(G(e,k,function(){a.contains(this,"esriAttributionOpen")?a.remove(this,"esriAttributionOpen"):this.scrollWidth>this.clientWidth&&a.add(this,"esriAttributionOpen")}));this.attribution=new d({map:this},e)},_cleanUp:function(){this.disableMapNavigation();this.navigationManager.destroy();var a=this._slider;a&&a.destroy&&!a._destroyed&&a.destroy();var a=this._navDiv,d=this.attribution;a&&u.destroy(a);
d&&d.destroy();this._connects.push(this._slider_connect,this._ogol_connect,this._rszSignal,this._oriSignal);h.forEach(this._connects,I);clearInterval(this._persistentTimer);this.attribution=this.navigationManager=this._rids=this._connects=this._slider_connect=this._ogol_connect=this._rszSignal=this._oriSignal=this._persistentTimer=null;this.inherited("_cleanUp",arguments)},_isPanningOrZooming:function(){return this.__panning||this.__zooming},_canZoom:function(a){var d=this.getLevel();return!this.__tileInfo||
!(d===this.getMinZoom()&&0>a||d===this.getMaxZoom()&&0<a)},_onLoadInitNavsHandler:function(){this.enableMapNavigation();this._createNav();if("small"===this._mapParams.sliderStyle||!this._createSlider)this._createSimpleSlider();else if(this._mapParams.slider){var a=-1!==this._getSliderClass(!0).indexOf("Horizontal"),a=[a?"dijit.form.HorizontalSlider":"dijit.form.VerticalSlider",a?"dijit.form.HorizontalRule":"dijit.form.VerticalRule",a?"dijit.form.HorizontalRuleLabels":"dijit.form.VerticalRuleLabels"];
if(h.some(a,function(a){return!l.getObject(a,!1)})){var a=h.map(a,function(a){return a.replace(/\./g,"/")}),d=V++,c=this;this._rids&&this._rids.push(d);p(a,function(){var a=c._rids?h.indexOf(c._rids,d):-1;-1!==a&&(c._rids.splice(a,1),c._createSlider.apply(c,arguments))})}else a=h.map(a,function(a){return l.getObject(a,!1)}),this._createSlider.apply(this,a)}I(this._onLoadHandler_connect)},_createNav:function(){if(this._mapParams.nav){var d,c,e,b=a.add,k=this.id;this._navDiv=J("div",{id:k+"_navdiv"},
this.root);b(this._navDiv,"navDiv");var t=this.width/2,g=this.height/2,q;for(e in B)c=B[e],d=J("div",{id:k+"_pan_"+e},this._navDiv),b(d,"fixedPan "+c),"up"===e||"down"===e?(q=parseInt(Q(d).w,10)/2,L(d,{left:t-q+"px",zIndex:30})):(q=parseInt(Q(d).h,10)/2,L(d,{top:g-q+"px",zIndex:30})),this._connects.push(G(d,"onclick",P(this,this[c])));this._onMapResizeNavHandler_connect=G(this,"onResize",this,"_onMapResizeNavHandler");for(e in E)c=E[e],d=J("div",{id:k+"_pan_"+e,style:{zIndex:30}},this._navDiv),b(d,
"fixedPan "+c),this._connects.push(G(d,"onclick",P(this,this[c])));this.isPanArrows=!0}},_onMapResizeNavHandler:function(a,d,c){a=this.id;d/=2;c/=2;var b=e.byId,k,t,g;for(k in B)t=b(a+"_pan_"+k),"up"===k||"down"===k?(g=parseInt(Q(t).w,10)/2,L(t,"left",d-g+"px")):(g=parseInt(Q(t).h,10)/2,L(t,"top",c-g+"px"))},_createSimpleSlider:function(){if(this._mapParams.slider){var d=this._slider=J("div",{id:this.id+"_zoom_slider","class":this._getSliderClass(),style:{zIndex:30}}),c=J("div",{"class":"esriSimpleSliderIncrementButton",
tabIndex:"0",role:"button"},d),b=J("div",{"class":"esriSimpleSliderDecrementButton",tabIndex:"0",role:"button"},d);this._addZoomButtonTooltips(c,b);this._incButton=c;this._decButton=b;this._simpleSliderZoomHandler(null,null,null,this.getLevel());var t=C.widgets.zoomSlider;this._addZoomButtonIcon(c,"+",t.zoomIn);this._addZoomButtonIcon(b,"\x26minus;",t.zoomOut);8>x("ie")&&a.add(b,"dj_ie67Fix");this._connects.push(G(c,k,this,this._simpleSliderChangeHandler));this._connects.push(G(b,k,this,this._simpleSliderChangeHandler));
(-1<this.getMaxZoom()||-1<this.getMinZoom())&&this._connects.push(G(this,"onZoomEnd",this,this._simpleSliderZoomHandler));10>x("ie")&&e.setSelectable(d,!1);this.root.appendChild(d);this.isZoomSlider=!0}},_simpleSliderChangeHandler:function(a){r.stop(a);a=-1!==a.currentTarget.className.indexOf("IncrementButton")?!0:!1;this._extentUtil({numLevels:a?1:-1})},_simpleSliderZoomHandler:function(d,c,e,b){var k;d=this._incButton;c=this._decButton;-1<b&&b===this.getMaxZoom()?k=d:-1<b&&b===this.getMinZoom()&&
(k=c);k?(a.add(k,"esriSimpleSliderDisabledButton"),a.remove(k===d?c:d,"esriSimpleSliderDisabledButton")):(a.remove(d,"esriSimpleSliderDisabledButton"),a.remove(c,"esriSimpleSliderDisabledButton"))},_getSliderClass:function(a){a=a?"Large":"Simple";var d=this._mapParams.sliderOrientation,c=this._mapParams.sliderPosition||"",d=d&&"horizontal"===d.toLowerCase()?"esri"+a+"SliderHorizontal":"esri"+a+"SliderVertical";if(c)switch(c.toLowerCase()){case "top-left":c="esri"+a+"SliderTL";break;case "top-right":c=
"esri"+a+"SliderTR";break;case "bottom-left":c="esri"+a+"SliderBL";break;case "bottom-right":c="esri"+a+"SliderBR"}return"esri"+a+"Slider "+d+" "+c},_addZoomButtonIcon:function(a,d,c){u.create("span",{"aria-hidden":"true",role:"presentation",innerHTML:d},a);u.create("span",{"class":"esriIconFallbackText",innerHTML:c},a)},_addZoomButtonTooltips:function(a,d){var e=C.widgets.zoomSlider;c.set(a,"title",e.zoomIn);c.set(d,"title",e.zoomOut)},_createSlider:function(a,d,c){if(this._mapParams.slider){var e=
J("div",{id:this.id+"_zoom_slider"},this.root),b=t.defaults.map,k=this._getSliderClass(!0),g=-1!==k.indexOf("Horizontal"),q=this.getNumLevels();if(0<q){var u,w,v=this._mapParams.sliderLabels,f=!!v,n=!1!==v;if(n){var l=g?"bottomDecoration":"rightDecoration";if(!v)for(v=[],b=0;b<q;b++)v[b]="";h.forEach([{"class":"esriLargeSliderTicks",container:l,count:q,dijitClass:d},{"class":f&&"esriLargeSliderLabels",container:l,count:q,labels:v,dijitClass:c}],function(a){var c=J("div"),b=a.dijitClass;delete a.dijitClass;
e.appendChild(c);b===d?u=new b(a,c):w=new b(a,c)})}a=this._slider=new a({id:e.id,"class":k,minimum:this.getMinZoom(),maximum:this.getMaxZoom(),discreteValues:q,value:this.getLevel(),clickSelect:!0,intermediateChanges:!0,style:"z-index:30;"},e);a.startup();n&&(u.startup(),w.startup());this._slider_connect=G(a,"onChange",this,"_onSliderChangeHandler");this._connects.push(G(this,"onExtentChange",this,"_onExtentChangeSliderHandler"));this._connects.push(G(a._movable,"onFirstMove",this,"_onSliderMoveStartHandler"))}else{a=
this._slider=new a({id:e.id,"class":k,minimum:0,maximum:2,discreteValues:3,value:1,clickSelect:!0,intermediateChanges:b.sliderChangeImmediate,style:"height:50px; z-index:30;"},e);c=a.domNode.firstChild.childNodes;for(b=1;3>=b;b++)L(c[b],"visibility","hidden");a.startup();this._slider_connect=G(a,"onChange",this,"_onDynSliderChangeHandler");this._connects.push(G(this,"onExtentChange",this,"_onExtentChangeDynSliderHandler"))}b=a.incrementButton;c=a.decrementButton;g?this._addZoomButtonTooltips(b,c):
this._addZoomButtonTooltips(c,b);b.style.outline="none";c.style.outline="none";a.sliderHandle.style.outline="none";a._onKeyPress=function(){};if(g=a._movable){var r=g.onMouseDown;g.onMouseDown=function(a){9>x("ie")&&1!==a.button||r.apply(this,arguments)}}this.isZoomSlider=!0}},_onSliderMoveStartHandler:function(){I(this._slider_connect);I(this._slidermovestop_connect);this._slider_connect=G(this._slider,"onChange",this,"_onSliderChangeDragHandler");this._slidermovestop_connect=G(this._slider._movable,
"onMoveStop",this,"_onSliderMoveEndHandler")},_onSliderChangeDragHandler:function(a){this._extentUtil({targetLevel:a})},_onSliderMoveEndHandler:function(){I(this._slider_connect);I(this._slidermovestop_connect)},_onSliderChangeHandler:function(a){this.setLevel(a)},_updateSliderValue:function(a,d){I(this._slider_connect);var c=this._slider,e=c._onChangeActive;c._onChangeActive=!1;c.set("value",a);c._onChangeActive=e;this._slider_connect=G(c,"onChange",this,d)},_onExtentChangeSliderHandler:function(a,
d,c,e){I(this._slidermovestop_connect);this._updateSliderValue(e.level,"_onSliderChangeHandler")},_onDynSliderChangeHandler:function(a){this._extentUtil({numLevels:0<a?1:-1})},_onExtentChangeDynSliderHandler:function(){this._updateSliderValue(1,"_onDynSliderChangeHandler")},_openLogoLink:function(a){window.open(t.defaults.map.logoLink,"_blank");r.stop(a)},enableMapNavigation:function(){this.navigationManager.enableNavigation()},disableMapNavigation:function(){this.navigationManager.disableNavigation()},
enableDoubleClickZoom:function(){this.isDoubleClickZoom||(this.navigationManager.enableDoubleClickZoom(),this.isDoubleClickZoom=!0)},disableDoubleClickZoom:function(){this.isDoubleClickZoom&&(this.navigationManager.disableDoubleClickZoom(),this.isDoubleClickZoom=!1)},enableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom||(H(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.enableShiftDoubleClickZoom(),
this.isShiftDoubleClickZoom=!0)},disableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom&&(H(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.disableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!1)},enableClickRecenter:function(){this.isClickRecenter||(this.navigationManager.enableClickRecenter(),this.isClickRecenter=!0)},disableClickRecenter:function(){this.isClickRecenter&&
(this.navigationManager.disableClickRecenter(),this.isClickRecenter=!1)},enablePan:function(){this.isPan||(this.navigationManager.enablePan(),this.isPan=!0)},disablePan:function(){this.isPan&&(this.navigationManager.disablePan(),this.isPan=!1)},enableRubberBandZoom:function(){this.isRubberBandZoom||(this.navigationManager.enableRubberBandZoom(),this.isRubberBandZoom=!0)},disableRubberBandZoom:function(){this.isRubberBandZoom&&(this.navigationManager.disableRubberBandZoom(),this.isRubberBandZoom=!1)},
enableKeyboardNavigation:function(){this.isKeyboardNavigation||(this.navigationManager.enableKeyboardNavigation(),this.isKeyboardNavigation=!0)},disableKeyboardNavigation:function(){this.isKeyboardNavigation&&(this.navigationManager.disableKeyboardNavigation(),this.isKeyboardNavigation=!1)},enableScrollWheelZoom:function(){this.isScrollWheelZoom||(this.navigationManager.enableScrollWheelZoom(),this.isScrollWheelZoom=!0)},disableScrollWheelZoom:function(){this.isScrollWheelZoom&&(this.navigationManager.disableScrollWheelZoom(),
this.isScrollWheelZoom=!1)},enableScrollWheelPan:function(){this.isScrollWheelPan||this.navigationManager.enableScrollWheelPan()},disableScrollWheelPan:function(){this.isScrollWheelPan&&this.navigationManager.disableScrollWheelPan()},showPanArrows:function(){this._navDiv&&(this._navDiv.style.display="block",this.isPanArrows=!0)},hidePanArrows:function(){this._navDiv&&(this._navDiv.style.display="none",this.isPanArrows=!1)},showZoomSlider:function(){this._slider&&(L(this._slider.domNode||this._slider,
"visibility","inherit"),this.isZoomSlider=!0)},hideZoomSlider:function(){this._slider&&(L(this._slider.domNode||this._slider,"visibility","hidden"),this.isZoomSlider=!1)}})})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(p,f,b,m){function l(b){if((b.keyCode===p.ENTER||b.keyCode===p.SPACE)&&!/input|button|textarea/i.test(b.target.nodeName))for(b=b.target;b;b=b.parentNode)if(b.dojoClick)return!0}var h;b(document,"keydown",function(b){l(b)?(h=b.target,
b.preventDefault()):h=null});b(document,"keyup",function(f){l(f)&&f.target==h&&(h=null,b.emit(f.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:f.ctrlKey,shiftKey:f.shiftKey,metaKey:f.metaKey,altKey:f.altKey,_origType:f.type}))});var r=function(f,g){f.dojoClick=!0;return b(f,"click",g)};r.click=r;r.press=function(h,g){var e=b(h,m.press,function(a){("mousedown"!=a.type||f.isLeft(a))&&g(a)}),c=b(h,"keydown",function(a){a.keyCode!==p.ENTER&&a.keyCode!==p.SPACE||g(a)});return{remove:function(){e.remove();
c.remove()}}};r.release=function(h,g){var e=b(h,m.release,function(a){("mouseup"!=a.type||f.isLeft(a))&&g(a)}),c=b(h,"keyup",function(a){a.keyCode!==p.ENTER&&a.keyCode!==p.SPACE||g(a)});return{remove:function(){e.remove();c.remove()}}};r.move=m.move;return r})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),function(p,f,b,m,l,h,r,n,g,e){function c(a,c,e){return q&&e?function(a,d){return h(a,e,d)}:d?function(d,
e){var b=h(d,c,function(a){e.call(this,a);G=(new Date).getTime()}),k=h(d,a,function(a){(!G||(new Date).getTime()>G+1E3)&&e.call(this,a)});return{remove:function(){b.remove();k.remove()}}}:function(d,c){return h(d,a,c)}}function a(a){do if(void 0!==a.dojoClick)return a;while(a=a.parentNode)}function u(d,c,k){if(!n.isRight(d)){var g=a(d.target);if(t=!d.target.disabled&&g&&g.dojoClick)if(A=(x="useTarget"==t)?g:d.target,x&&d.preventDefault(),y=d.changedTouches?d.changedTouches[0].pageX-e.global.pageXOffset:
d.clientX,z=d.changedTouches?d.changedTouches[0].pageY-e.global.pageYOffset:d.clientY,C=("object"==typeof t?t.x:"number"==typeof t?t:0)||4,B=("object"==typeof t?t.y:"number"==typeof t?t:0)||4,!w){d=function(a){e.doc.addEventListener(a,function(d){var c=d.target;t&&!d._dojo_click&&(new Date).getTime()<=E+1E3&&("INPUT"!=c.tagName||!m.contains(c,"dijitOffScreen"))&&(d.stopPropagation(),d.stopImmediatePropagation&&d.stopImmediatePropagation(),"click"==a&&("INPUT"!=c.tagName||"radio"==c.type&&(m.contains(c,
"dijitCheckBoxInput")||m.contains(c,"mblRadioButton"))||"checkbox"==c.type&&(m.contains(c,"dijitCheckBoxInput")||m.contains(c,"mblCheckBox")))&&"TEXTAREA"!=c.tagName&&"AUDIO"!=c.tagName&&"VIDEO"!=c.tagName&&d.preventDefault())},!0)};var q=function(a){t=x?b.isDescendant(e.doc.elementFromPoint(a.changedTouches?a.changedTouches[0].pageX-e.global.pageXOffset:a.clientX,a.changedTouches?a.changedTouches[0].pageY-e.global.pageYOffset:a.clientY),A):t&&(a.changedTouches?a.changedTouches[0].target:a.target)==
A&&Math.abs((a.changedTouches?a.changedTouches[0].pageX-e.global.pageXOffset:a.clientX)-y)<=C&&Math.abs((a.changedTouches?a.changedTouches[0].pageY-e.global.pageYOffset:a.clientY)-z)<=B};w=!0;e.doc.addEventListener(c,function(a){n.isRight(a)||(q(a),x&&a.preventDefault())},!0);e.doc.addEventListener(k,function(a){if(!n.isRight(a)&&(q(a),t)){var d=function(d){var c=document.createEvent("MouseEvents");c._dojo_click=!0;c.initMouseEvent(d,!0,!0,a.view,a.detail,e.screenX,e.screenY,e.clientX,e.clientY,a.ctrlKey,
a.altKey,a.shiftKey,a.metaKey,0,null);return c};E=(new Date).getTime();var c=x?A:a.target;"LABEL"===c.tagName&&(c=b.byId(c.getAttribute("for"))||c);var e=a.changedTouches?a.changedTouches[0]:a,k=d("mousedown"),g=d("mouseup"),u=d("click");setTimeout(function(){h.emit(c,"mousedown",k);h.emit(c,"mouseup",g);h.emit(c,"click",u);E=(new Date).getTime()},0)}},!0);d("click");d("mousedown");d("mouseup")}}}var v=5>r("ios"),q=r("pointer-events")||r("MSPointer"),k=function(){var a={},d;for(d in{down:1,move:1,
up:1,cancel:1,over:1,out:1})a[d]=r("MSPointer")?"MSPointer"+d.charAt(0).toUpperCase()+d.slice(1):"pointer"+d;return a}(),d=r("touch-events"),w,t,x=!1,A,y,z,C,B,E,G,I;r("touch")&&(q?g(function(){e.doc.addEventListener(k.down,function(a){u(a,k.move,k.up)},!0)}):g(function(){function a(a){var d=l.delegate(a,{bubbles:!0});6<=r("ios")&&(d.touches=a.touches,d.altKey=a.altKey,d.changedTouches=a.changedTouches,d.ctrlKey=a.ctrlKey,d.metaKey=a.metaKey,d.shiftKey=a.shiftKey,d.targetTouches=a.targetTouches);
return d}I=e.body();e.doc.addEventListener("touchstart",function(a){G=(new Date).getTime();var d=I;I=a.target;h.emit(d,"dojotouchout",{relatedTarget:I,bubbles:!0});h.emit(I,"dojotouchover",{relatedTarget:d,bubbles:!0});u(a,"touchmove","touchend")},!0);h(e.doc,"touchmove",function(d){G=(new Date).getTime();var c=e.doc.elementFromPoint(d.pageX-(v?0:e.global.pageXOffset),d.pageY-(v?0:e.global.pageYOffset));c&&(I!==c&&(h.emit(I,"dojotouchout",{relatedTarget:c,bubbles:!0}),h.emit(c,"dojotouchover",{relatedTarget:I,
bubbles:!0}),I=c),h.emit(c,"dojotouchmove",a(d))||d.preventDefault())});h(e.doc,"touchend",function(d){G=(new Date).getTime();var c=e.doc.elementFromPoint(d.pageX-(v?0:e.global.pageXOffset),d.pageY-(v?0:e.global.pageYOffset))||e.body();h.emit(c,"dojotouchend",a(d))})}));f={press:c("mousedown","touchstart",k.down),move:c("mousemove","dojotouchmove",k.move),release:c("mouseup","dojotouchend",k.up),cancel:c(n.leave,"touchcancel",q?k.cancel:null),over:c("mouseover","dojotouchover",k.over),out:c("mouseout",
"dojotouchout",k.out),enter:n._eventHandler(c("mouseover","dojotouchover",k.over)),leave:n._eventHandler(c("mouseout","dojotouchout",k.out))};return p.touch=f})},"dijit/registry":function(){define(["dojo/_base/array","dojo/_base/window","./main"],function(p,f,b){var m={},l={},h={length:0,add:function(b){if(l[b.id])throw Error("Tried to register widget with id\x3d\x3d"+b.id+" but that id is already registered");l[b.id]=b;this.length++},remove:function(b){l[b]&&(delete l[b],this.length--)},byId:function(b){return"string"==
typeof b?l[b]:b},byNode:function(b){return l[b.getAttribute("widgetId")]},toArray:function(){var b=[],f;for(f in l)b.push(l[f]);return b},getUniqueId:function(f){var h;do h=f+"_"+(f in m?++m[f]:m[f]=0);while(l[h]);return"dijit"==b._scopeName?h:b._scopeName+"_"+h},findWidgets:function(b,f){function g(c){for(c=c.firstChild;c;c=c.nextSibling)if(1==c.nodeType){var a=c.getAttribute("widgetId");a?(a=l[a])&&e.push(a):c!==f&&g(c)}}var e=[];g(b);return e},_destroyAll:function(){b._curFocus=null;b._prevFocus=
null;b._activeStack=[];p.forEach(h.findWidgets(f.body()),function(b){b._destroyed||(b.destroyRecursive?b.destroyRecursive():b.destroy&&b.destroy())})},getEnclosingWidget:function(b){for(;b;){var f=1==b.nodeType&&b.getAttribute("widgetId");if(f)return l[f];b=b.parentNode}return null},_hash:l};return b.registry=h})},"dijit/main":function(){define(["dojo/_base/kernel"],function(p){return p.dijit})},"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./urlUtils ./PluginTarget ./Color ./arcade/Dictionary ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./layers/VectorTileLayer ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J,L,P,Q,H,K,V,S,ba,N,M,W,ga,D,ja,na,ca,ea,ua){function ha(a,d){var c=a.lods;c.sort(function(a,d){return a.scale>d.scale?-1:a.scale<d.scale?1:0});var e=[],c=n.filter(c,function(a){if(-1===Ba(e,a.scale))return e.push(a.scale),!0}),b=d.lods=[],k;n.forEach(c,function(a,d){k=b[d]=new D(a);k.level=d});d.tileInfo=new ga(Ca(a,{lods:b}))}var oa,la=N.toMapPoint,va=N.toScreenPoint,Ea=l.connect,ia=l.disconnect,ma=r.hitch,za=k.set,Ba=n.indexOf,Ca=
r.mixin,wa=0,sa=A.defaults.map,Fa=sa.layerNamePrefix,Ma=sa.graphicsLayerNamePrefix,La=new RegExp("^"+Fa+"(\\d+)$"),Ja=new RegExp("^"+Ma+"(\\d+)$"),Ga=function(){};return m([C,J],{declaredClass:"esri._CoreMap",resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',invalidBasemap:'Unable to add basemap: "${basemapName}".',
unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],load:["map"],pan:["extent","delta"],"pan-end":["extent",
"delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,
"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(d,b){var k=this;this.registerConnectEvents();Ca(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_connects:[],_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,
_cursor:null,_ratioW:1,_ratioH:1,_params:null,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[]});var t=this.container=c.byId(d),g=this.id=a.get(t,"id")||w.getUniqueId(this.declaredClass);u.add(t,"map");var f=q.getContentBox(t),x=u.add,h=v.create;this.position=new H(0,0);this._reposition();var n=this.width=0<f.w?f.w:sa.width,l=this.height=0<
f.h?f.h:sa.height,r=this.root=h("div",{id:g+"_root",style:{width:n+"px",height:l+"px",direction:"ltr"}});x(r,"esriMapContainer");f=this.__container=h("div",{id:g+"_container"},r);za(f,"position","absolute");x(f,"esriMapContainer");t.appendChild(r);t=this._params=Ca({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},b||{});this.wrapAround180=t.wrapAround180;this.optimizePanAnimation=
t.optimizePanAnimation;this.setBackgroundColor(t.backgroundColor);z.isDefined(t.resizeDelay)&&(this.resizeDelay=t.resizeDelay);t.lods&&(ha({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,y:90},spatialReference:{wkid:4326},lods:t.lods},t),this.__tileInfo=t.tileInfo);this.extent=t.extent;this._extentUtil({mapCenter:t.center,targetLevel:t.zoom,targetScale:t.scale});this.__visibleRect=new V(0,0,n,l);this.__visibleDelta=new V(0,0,n,l);g=this._layersDiv=h("div",{id:g+"_layers"});
x(g,"esriMapLayers");f.appendChild(g);this._zoomAnimDiv=h("div",{style:{position:"absolute"}});t.infoWindow?this.infoWindow=t.infoWindow:(x=this.infoWindow=new ua(t.popupOptions,h("div")),x.startup(),x._ootb=!0,za(x.domNode,"zIndex",40));t.showLabels&&(p(["./layers/LabelLayer"],function(a){oa=a;k._createLabelLayer()}),this.on("load",function(){k._createLabelLayer()}));this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:t.showInfoWindowOnClick});this._zoomStartHandler=ma(this,this._zoomStartHandler);
this._zoomingHandler=ma(this,this._zoomingHandler);this._zoomEndHandler=ma(this,this._zoomEndHandler);this._panningHandler=ma(this,this._panningHandler);this._panEndHandler=ma(this,this._panEndHandler);this._endTranslate=ma(this,this._endTranslate);this._timedResize=ma(this,this._timedResize);this._execResize=ma(this,this._execResize);this._processLabelLayers=ma(this,this._processLabelLayers);this._updateLabelLayers=ma(this,this._updateLabelLayers);this.resize=ma(this,this.resize);e.addOnWindowUnload(this,
this.destroy)},_getAbsMid:function(a){return p.toAbsMid?p.toAbsMid(a):f.id.replace(/\/[^\/]*$/ig,"/")+a},_cleanUp:function(){var a=this.infoWindow;a&&(a._ootb&&a.destroy?a.destroy():a.unsetMap(this),delete this.infoWindow);ia(this._tsTimeExtentChange_connect);this.removePlugin("./plugins/popupManager");v.destroy(this.root);this.root=null},_addLayer:function(a,d,c){if(a.id){var e=a.id.match(a instanceof W?Ja:La);e&&e[1]&&(e=Number(e[1]),wa<=e&&(wa=e+1))}var b=a.id||(a instanceof W?Ma:Fa)+wa++;a.id=
b;this._layers[b]=a;var k,t;if(d===this.layerIds||d===this.graphicsLayerIds)k=this._layerSize,this._layerSize++;a._isRefLayer="top"===c;c=!z.isDefined(c)||0>c||c>d.length||"top"===c?d.length:c;0===k&&(this._firstLayerId=b);if(!a._isRefLayer)for(;(t=this.getLayer(d[c-1]))&&t._isRefLayer;)c--;d.splice(c,0,b);var g=ma(this,this._addLayerHandler),q=this;c=this._connects;e=function(){a.loaded?q._onLoadFix?(q._onLoadFix=!1,setTimeout(function(){g(a)},0)):g(a):(q["_"+b+"_addtoken_load"]=Ea(a,"onLoad",q,
"_addLayerHandler"),q["_"+b+"_addtoken_err"]=Ea(a,"onError",q,function(c){g(a,c,d)}))};this.loaded||0===k||a.loaded&&-1===Ba(this.graphicsLayerIds,b)?e():c.push(Ea(this,"onLoad",e));return a},_addLayerHandler:function(a,d,c){var e=this.id,b=a.id,k=Ba(a instanceof W?this.graphicsLayerIds:this.layerIds,b),t=k,g=!1,q=this._params;ia(this["_"+b+"_addtoken_load"]);ia(this["_"+b+"_addtoken_err"]);if(d)delete this._layers[b],-1!==k&&(c.splice(k,1),this.onLayerAddResult(a,d));else{-1===k&&(k=Ba(this._internalLayerIds,
b),t=20+k,g=!0);if(b===this._firstLayerId){d=a.spatialReference;c=this.extent&&this.extent.spatialReference;!c||c.equals(d)||!a.tileInfo&&a.url||(c=null);c=this.spatialReference=c||d;this.wrapAround180=this.wrapAround180&&c&&c._isWrappable()?!0:!1;a.tileInfo&&(this.__tileInfo?(d=this.__tileInfo.lods,this.__tileInfo=Ca({},a.tileInfo),this.__tileInfo.lods=d):(ha(Ca({},a.tileInfo),q),this.__tileInfo=q.tileInfo));if(this.wrapAround180){d=this.__tileInfo;c=c._getInfo();if(!d||Math.abs(c.origin[0]-d.origin.x)>
c.dx)this.wrapAround180=!1;this.wrapAround180&&d&&G._addFrameInfo(d,c)}q.units=a.units;if((d=this.__tileInfo&&this.__tileInfo.lods)&&d.length){c=q.minScale;var k=q.maxScale,u=-1,w=-1,v=!1,f=!1,x;for(x=0;x<d.length;x++)0<c&&!v&&c>=d[x].scale&&(u=d[x].level,v=!0),0<k&&!f&&k>=d[x].scale&&(w=0<x?d[x-1].level:-1,f=!0);-1===q.minZoom&&(q.minZoom=0===c?d[0].level:u);-1===q.maxZoom&&(q.maxZoom=0===k?d[d.length-1].level:w);for(x=0;x<d.length;x++)q.minZoom===d[x].level&&(q.minScale=d[x].scale),q.maxZoom===
d[x].level&&(q.maxScale=d[x].scale)}else q.minZoom=q.maxZoom=q.zoom=-1}a instanceof W?(this._gc||(this._gc=new W._GraphicsContainer,this._gc._setMap(this,this._layersDiv).id=e+"_gc"),t=a._setMap(this,this._gc._surface),t.id=e+"_"+b,this._layerDivs[b]=t,this._reorderLayers(this.graphicsLayerIds)):(t=a._setMap(this,this._layersDiv,t,this.__LOD),t.id=e+"_"+b,this._layerDivs[b]=t,this._reorderLayers(this.layerIds),g||-1===a.declaredClass.indexOf("VETiledLayer")||this._onBingLayerAdd(a));b===this._firstLayerId&&
(this.graphics=new W({id:e+"_graphics",displayOnPan:q.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,20));if(a===this.graphics){c=this._layers[this._firstLayerId];e=q.zoom;t=q.scale;d=q.center;c=c.initialExtent||c.fullExtent;this._firstLayerId=null;this.extent&&(this.extent=this._convertGeometry(this,this.extent));!this.extent&&c&&(d&&(d=this._convertGeometry(c,d)),d&&(c=c.centerAt(d),d=null));if(d=this.extent||c&&new K(c.toJson()))-1<e?d=this.__getExtentForLevel(e,null,
d).extent:0<t&&(d=ba.getExtentForScale(this,t,d));if(!d){console.log("Map: "+this.invalidExtent);return}q=this._fixExtent(d,q.fitExtent);this.extent=q.extent;this.__LOD=q.lod;this.__setExtent(this.extent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);this.onLoad(this)}g||(this.onLayerAdd(a),this.onLayerAddResult(a));ia(this[b+"_addLayerHandler_connect"])}},_convertGeometry:function(a,d){var c=a&&a.spatialReference,e=d&&d.spatialReference;c&&e&&!c.equals(e)&&(c._canProject(e)?
c.isWebMercator()?d=M.geographicToWebMercator(d):4326===c.wkid&&(d=M.webMercatorToGeographic(d,!0)):(console.log("Map: "+z.substitute({geometry:e.wkid||e.wkt,map:c.wkid||c.wkt},this.invalidGeometry)),d=null));return d},_reorderLayers:function(a){var c=this.onLayerReorder,e=v.place,b=this._layerDivs,k=this._layers,t=this._gc?this._gc._surface.getEventSource():null;if(a===this.graphicsLayerIds)n.forEach(a,function(a,d){var q=b[a];q&&(e(q.getEventSource(),t,d),c(k[a],d))});else{var q=this.graphics,g=
q?q.id:null,u=this._layersDiv,w;n.forEach(a,function(a,d){w=b[a];a!==g&&w&&(e(w,u,d),c(k[a],d))});this._mapImageLyr&&this._placeMapImageLyr();t&&(t=9>d("ie")?t.parentNode:t,e(t,t.parentNode,a.length))}this.onLayersReordered([].concat(a))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor)},_zoomingHandler:function(a){var d=parseFloat(a.left),c=parseFloat(a.top);a=new K(d,c-parseFloat(a.height),d+parseFloat(a.width),c,this.spatialReference);d=this.extent.getWidth()/
a.getWidth();this.__zoom(a,d,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var a=this._zoomAnimDiv,d=a.extent,c=this.extent.getWidth()/d.getWidth(),e=a.anchor,b=a.newLod,k=a.levelChange;a.extent=a.anchor=a.levelChange=a.startingExtent=a.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(d,c,e,b,k)},_panningHandler:function(a){if(isNaN(parseFloat(a.left))||isNaN(parseFloat(a.top))){var d=Math.round,c=this._panAnim.node;a.left=-1*(this._delta.x-d(this.width/2))+"px";a.top=-1*(this._delta.y-
d(this.height/2))+"px";k.set(c,"left",a.left);k.set(c,"top",a.top)}a=new H(parseFloat(a.left),parseFloat(a.top));d=this.toMap(a);this.onPan(this.extent.offset(this.extent.xmin-d.x,this.extent.ymax-d.y),a)},_panEndHandler:function(a){this.__panning=!1;var d=Math.round;a=new H(-d(parseFloat(a.style.left)),-d(parseFloat(a.style.top)));var d=a.x,c=a.y,e=this.__visibleRect,b=this.__visibleDelta;e.x+=-d;e.y+=-c;b.x+=-d;b.y+=-c;za(this._zoomAnimDiv,{left:"0px",top:"0px"});var e=this.extent,b=this._ratioW,
k=this._ratioH,e=new K(e.xmin+d/b,e.ymin-c/k,e.xmax+d/b,e.ymax-c/k,this.spatialReference);a.setX(-a.x);a.setY(-a.y);this._delta=this._panAnim=null;this._updateExtent(e);this.onPanEnd(e,a);this._fireExtChg([e,a,!1,this.__LOD])},_fixExtent:function(a,d){for(var c=this._reshapeExtent(a),e=1.25;!0===d&&(c.extent.getWidth()<a.getWidth()||c.extent.getHeight()<a.getHeight())&&0<c.lod.level&&3>=e;)c=this._reshapeExtent(a.expand(e)),e+=.25;return c},_getFrameWidth:function(){var a=-1,d=this.spatialReference._getInfo();
this.__LOD?(d=this.__LOD._frameInfo)&&(a=d[3]):d&&(a=Math.round(2*d.valid[1]/(this.extent.getWidth()/this.width)));return a},_fixAspectRatio:function(a){var d=a.getWidth(),c=a.getHeight(),e=d/c,b=this.width/this.height,k=0,t=0;this.width>this.height?d>c?b>e?k=c*b-d:t=d/b-c:k=c*b-d:this.width<this.height?d<c?b>e?k=c*b-d:t=d/b-c:t=d/b-c:d<c?k=c-d:d>c&&(t=d/b-c);k&&(a.xmin-=k/2,a.xmax+=k/2);t&&(a.ymin-=t/2,a.ymax+=t/2);return a},_reshapeExtent:function(a){a=this._fixAspectRatio(a);return this._getAdjustedExtent(a)},
_getAdjustedExtent:function(a){if(this.__tileInfo)return G.getCandidateTileInfo(this,this.__tileInfo,a);var d=ba.getScale(this,a),c=this.getMinScale(),e=this.getMaxScale();!c||d<=c?!e||d>=e||(a=ba.getExtentForScale(this,e,a)):a=ba.getExtentForScale(this,c,a);return{extent:a}},_onBingLayerAdd:function(a){this["__"+a.id+"_vis_connect"]=l.connect(a,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(a.visible)},_onBingLayerRemove:function(a){l.disconnect(this["__"+a.id+"_vis_connect"]);
delete this["__"+a.id+"_vis_connect"];var d=n.some(this.layerIds,function(d){return(a=this._layers[d])&&a.visible&&-1!==a.declaredClass.indexOf("VETiledLayer")},this);this._toggleBingLogo(d)},_toggleBingLogo:function(a){a&&!this._bingLogo?(a={left:this._mapParams&&this._mapParams.nav?"25px":""},6===d("ie")&&(a.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+p.toUrl("./images/map/bing-logo-lg.png")+"')"),a=this._bingLogo=v.create("div",
{style:a},this.root),u.add(a,"bingLogo-lg")):!a&&this._bingLogo&&(v.destroy(this._bingLogo),delete this._bingLogo)},__panStart:function(a,d){var c=this._zoomAnim,e=this._panAnim;if(c&&c._active)c.stop(),c._fire("onEnd",[c.node]);else if(e&&e._active){e.stop();this._panAnim=null;var e=e.curve.getValue(e._getStep()),c=Math.round(parseFloat(e.left)),e=Math.round(parseFloat(e.top)),b=this.navigationManager._dragOrigin;this.__pan(c,e);b&&(b.x-=c,b.y-=e);return}this.__panning=!0;this.onPanStart(this.extent,
new H(a,d))},__pan:function(a,d){var c=this.extent,e=this._ratioW,b=this._ratioH;this.onPan(new K(c.xmin-a/e,c.ymin+d/b,c.xmax-a/e,c.ymax+d/b,this.spatialReference),new H(a,d))},__panEnd:function(a,d){var c=this.__visibleRect,e=this.__visibleDelta;c.x+=a;c.y+=d;e.x+=a;e.y+=d;var c=new H(a,d),e=this.extent,b=this._ratioW,k=this._ratioH,e=new K(e.xmin-a/b,e.ymin+d/k,e.xmax-a/b,e.ymax+d/k,this.spatialReference);this.__panning=!1;this._updateExtent(e);this.onPanEnd(e,c);this._fireExtChg([e,c,!1,this.__LOD])},
__zoomStart:function(a,d){this.__zooming=!0;this.onZoomStart(a,1,d,this.__LOD?this.__LOD.level:null)},__zoom:function(a,d,c){this.onZoom(a,d,c)},__zoomEnd:function(a,d,c,e,b){za(this._layersDiv,{left:"0px",top:"0px"});this._delta=new H(0,0);this.__visibleRect.x=this.__visibleRect.y=0;a=new K(a);this.__LOD=e;this._ratioW=this.width/a.getWidth();this._ratioH=this.height/a.getHeight();var k=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(a,b);this.onZoomEnd(a,d,c,e?e.level:null);this._fireExtChg([a,
k,b,e])},_extentUtil:function(a,d,c,e,b){var k=new h,t,q,g,u,w,v,f,x,n,l,m=this.width,y=this.height,A,C,B;a&&(t=a.numLevels,q=a.targetLevel,A=z.isDefined(q),g=a.factor,u=a.mapAnchor,w=a.screenAnchor,v=a.mapCenter,C=a.levelOrFactor,f=a.targetScale,x=z.isDefined(f)&&0<f);d&&(n=d.dx,l=d.dy,v=d.mapCenter);r.isArray(v)&&(v=new Q(v));var P=this._panAnim;d=(a=this._stopAnim())?a.divExtent:this.extent;var G=this.__tileInfo,p=this._params;if(!this.loaded){if(c)d&&(c=this._convertGeometry(d,c)),c&&(this.extent=
c,p.zoom=p.scale=-1,p.center=null);else if(v||A||x){if(v)if(d){if(v=this._convertGeometry(d,v))this.extent=d.centerAt(v),p.center=null}else p.center=v;A&&-1<q?(p.zoom=q,p.scale=-1):x&&(p.scale=f,p.zoom=-1)}k.resolve();return k}if(v&&(v=this._convertGeometry(this,v),!v)||u&&(u=this._convertGeometry(this,u),!u)||c&&(c=this._convertGeometry(this,c),!c))return k.reject(),k;P&&u&&w&&(u=la(this.extent,m,y,w));a&&u&&w&&(u=la(a.divExtent,m,y,w));A&&(G?(t=this.getMinZoom(),A=this.getMaxZoom(),q<t?q=t:q>A&&
(q=A),t=q-(a?a.level:this.getLevel())):(t=0<q?-1:1,B=C?q:null));if(!c)if(z.isDefined(t))G?(m=a?a.level:this.getLevel(),m=this.__getExtentForLevel(m+t,v,d).extent):(m=(a?a.end:this.extent).expand(B||(0<t?.5*t:2*-t)),B&&v&&(m=m.centerAt(v))),m&&(v?c=m:(n=u||d.getCenter(),y=m.getWidth(),l=m.getHeight(),m=n.x>=d.xmin&&n.x<=d.xmax?(n.x-d.xmin)/d.getWidth():.5,c=n.y>=d.ymin&&n.y<=d.ymax?(n.y-d.ymin)/d.getHeight():.5,m=n.x-m*y,n=n.y-c*l,c=new K(m,n,m+y,n+l,this.spatialReference)));else if(x)c=ba.getExtentForScale(this,
f,d);else if(z.isDefined(g))c=d.expand(g);else if(n||l)a?(c=a.end,u=c.getCenter(),B=va(c,m,y,u),B.x+=n,B.y+=l,B=la(c,m,y,B),c=c.offset(B.x-u.x,B.y-u.y)):(n=new H(m/2+n,y/2+l),n=la(d,m,y,n),y=d.getWidth(),l=d.getHeight(),m=n.x-y/2,n=n.y-l/2,c=new K(m,n,m+y,n+l,this.spatialReference));c||(v?(d=a?a.end:d,y=d.getWidth(),l=d.getHeight(),m=v.x-y/2,n=v.y-l/2,c=new K(m,n,m+y,n+l,this.spatialReference)):a&&(c=a.end));c?(this._extentDfd&&-1===this._extentDfd.fired&&(this._extentDfd.then(null,Ga),this._extentDfd.reject()),
this._extentDfd=k,this.__setExtent(c,null,w,e,a,b)):k.reject();return k},__setExtent:function(a,d,c,e,b,k){try{if(this._firstLayerId)this.extent=a;else{var t=!0,q=this.spatialReference,g=b?b.divExtent:this.extent,u=this._fixExtent(a,e||!1);a=u.extent;var w=a.getWidth(),v=a.getHeight(),f=Math.round;if(g)var x=f(1E6*g.getWidth()),h=f(1E6*w),n=f(1E6*g.getHeight()),l=f(1E6*v),t=x!==h||n!==l;var r,m,y=b&&b.rect,A=b&&b.divExtent;if(sa.zoomDuration&&t&&g){A=A||new K(g);y=y||{left:g.xmin,top:g.ymax,width:g.getWidth(),
height:g.getHeight()};m={left:a.xmin,top:a.ymax,width:w,height:v};var z=new Q(a.xmin,a.ymax,q),C=new Q(a.xmin,a.ymin,q),P=new Q(this.extent.xmin,this.extent.ymax,q),G=new Q(this.extent.xmin,this.extent.ymin,q);(r=S.getLineIntersection(P,z,G,C,q))||b||(t=!1)}this._ratioW=this.width/w;this._ratioH=this.height/v;var p=this._zoomAnimDiv;if(t)if(za(this._layersDiv,{left:"0px",top:"0px"}),d=new H(0,0),this.__visibleRect.x=this.__visibleRect.y=0,y&&m){this._delta=d;p.id="_zAD";p.startingExtent=A;p.extent=
a;p.levelChange=t;p.newLod=u.lod;p.anchor=c?c:!r&&b?b.anchor:va(this.extent,this.width,this.height,r);var E=this.extent.getWidth()/a.getWidth();1024<(1>E?1/E:E)?(this.__zoomStart(A,p.anchor),this.__zoom(A,1,p.anchor),this._fireOnScale(1,p.anchor,!0),this.__zoomEnd(a,E,p.anchor,u.lod,t)):(this._zoomAnim=B.resize({node:p,start:y,end:m,duration:sa.zoomDuration,rate:sa.zoomRate,beforeBegin:b?null:this._zoomStartHandler,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),this._fireOnScale(E,
p.anchor,k))}else this._updateExtent(a,t,k),this._fireExtChg([this.extent,d,t,this.__LOD=u.lod]);else if(!this.__panning)if(!1===this.loaded||k)this._updateExtent(a,t,k),this._fireExtChg([this.extent,d,t,this.__LOD=u.lod]);else{this.__panning=!0;y=(new V(0,0,this.width,this.height,this.spatialReference)).getCenter();y.x=f(y.x);y.y=f(y.y);var J=this._delta=this.toScreen(a.getCenter()),I=Math.abs(y.x-J.x),L=Math.abs(y.y-J.y);this.optimizePanAnimation&&(I>2*this.width||L>2*this.height)?(this.__panStart(0,
0),this.__pan(0,0),this.__visibleRect.x=this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=0,this.__panning=!1,this._delta=null,this._updateExtent(a,!1,k),this.onPanEnd(this.extent,new H(0,0)),this._fireExtChg([this.extent,new H(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new H(0,0)),this._panAnim=B.slideTo({node:p,left:y.x-J.x,top:y.y-J.y,duration:sa.panDuration,rate:sa.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),this._panAnim.play())}}}catch(Za){console.log(Za.stack),
console.error(Za)}},_fireOnScale:function(a,d,c){if("css-transforms"===this.navigationMode){var e=this.__visibleDelta;this.onScale(t.scaleAt(a,{x:-1*(this.width/2-(d.x-e.x)),y:-1*(this.height/2-(d.y-e.y))}),c)}},_stopAnim:function(){var a=this._zoomAnim,d=this._panAnim;if(a&&a._active){a.stop();var d=a.curve.getValue(a._getStep()),c=parseFloat(d.left),e=parseFloat(d.top),a=a.node;return{anchor:a.anchor,start:a.startingExtent,end:a.extent,level:a.newLod&&a.newLod.level,rect:d,divExtent:new K(c,e-parseFloat(d.height),
c+parseFloat(d.width),e,this.spatialReference)}}d&&d._active&&(d.stop(),d._fire("onEnd",[d.node]))},__getExtentForLevel:function(a,d,c){var e=this.__tileInfo,e=e&&e.lods;a=z.isDefined(a)?a:0;c=c||this.extent;d=d||c&&c.getCenter();if(e){if(d){c=this.getMinZoom();var b=this.getMaxZoom();a>b&&(a=b);a<c&&(a=c);a=e[a];e=this.width*a.resolution/2;c=this.height*a.resolution/2;return{extent:new K(d.x-e,d.y-c,d.x+e,d.y+c,d.spatialReference),lod:a}}}else if(c)return{extent:c.expand(!a||1>a?1:a).centerAt(d)};
console.log("Map: "+this.invalidExtent)},_jobs:0,_incr:function(){1===++this._jobs&&(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart())},_decr:function(){var a=--this._jobs;a?0>a&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(a,d){this[a]&&this[a].apply(this,d)},_updateExtent:function(a,d,c){this.extent=a;this._view=new P({viewingMode:"map",scale:this.getScale()});(d||c)&&this._setClipRect();if(a=this.spatialReference)a.isWebMercator()?
this.geographicExtent=M.webMercatorToGeographic(this._getAvailExtent(),!0):4326===a.wkid&&(this.geographicExtent=new K(this._getAvailExtent().toJson()))},_fireExtChg:function(a){this.attr("data-zoom",this.getZoom());this.attr("data-scale",this.getScale());this._fireEvent("onExtentChange",a);if(a=this._extentDfd)delete this._extentDfd,a.resolve()},attr:function(a,d){var c=this.container;c&&(null==d?c.removeAttribute(a):c.setAttribute(a,d));return this},onUpdateStart:function(){},onUpdateEnd:function(){},
onLoad:function(){this._setClipRect()},onBeforeUnload:function(){},onUnload:function(){},onExtentChange:function(a,d,c){},onTimeExtentChange:function(){},onLayerAdd:function(){},onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},
onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},onReposition:function(){},destroy:function(){this._destroyed||(this.onBeforeUnload(this),this.removeAllLayers(),this._cleanUp(),clearTimeout(this._resizeT),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(a){za(this.__container,"cursor",this.cursor=a)},setMapCursor:function(a){this.setCursor(this._cursor=a)},resetMapCursor:function(){this.setCursor(this._cursor)},setBackgroundColor:function(a){a&&
!a.declaredClass&&(a=new L(a));this.backgroundColor=a||null;var c="";a&&(c=9>d("ie")?a.toHex():"rgba("+a.toRgba().join(",")+")");k.set(this.root,{backgroundColor:c})},setInfoWindow:function(a){var d=this.infoWindow;d&&d.unsetMap(this);this.infoWindow=a;this.loaded&&a&&a.setMap(this)},setInfoWindowOnClick:function(a){this._params.showInfoWindowOnClick=a;this.popupManager&&this.popupManager.set("enabled",a)},getInfoWindowAnchor:function(a){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(a)||
"upperright"},toScreen:function(a,d){return va(this.extent,this.width,this.height,a,d)},toMap:function(a){return la(this.extent,this.width,this.height,a)},addLayer:function(a,d){a&&!this.getLayer(a.id)&&this._addLayer(a,a instanceof W?this.graphicsLayerIds:this.layerIds,d);return a},addLayers:function(a){var d=[],c=a.length,e,b,k=a.length;e=l.connect(this,"onLayerAddResult",function(b,k){-1!==n.indexOf(a,b)&&(c--,d.push({layer:b,success:!k,error:k}),c||(l.disconnect(e),this.onLayersAddResult(d)))});
for(b=0;b<k;b++)this.addLayer(a[b]);return this},removeLayer:function(a,d){var c=a.id,e=a instanceof W?this.graphicsLayerIds:this.layerIds,b=Ba(e,c);0<=b&&(e.splice(b,1),a instanceof W?(ia(this["_gl_"+a.id+"_click_connect"]),a.loaded&&a._unsetMap(this,this._gc._surface)):a.loaded&&(a._unsetMap(this,this._layersDiv),-1!==a.declaredClass.indexOf("VETiledLayer")&&this._onBingLayerRemove(a)),delete this._layers[c],delete this._layerDivs[c],d||this._reorderLayers(e),this.onLayerRemove(a))},removeAllLayers:function(){var a=
this.layerIds,d;for(d=a.length-1;0<=d;d--)this.removeLayer(this._layers[a[d]],1);a=this.graphicsLayerIds;for(d=a.length-1;0<=d;d--)this.removeLayer(this._layers[a[d]],1);this.onLayersRemoved()},reorderLayer:function(a,d){r.isString(a)&&(b.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",null,"v2.0"),a=this.getLayer(a));var c=a.id,e,k=a instanceof W?this.graphicsLayerIds:this.layerIds;0>d?d=0:d>=
k.length&&(d=k.length-1);e=Ba(k,c);-1!==e&&e!==d&&(k.splice(e,1),k.splice(d,0,c),this._reorderLayers(k))},getLayer:function(a){return this._layers[a]},setExtent:function(a,d){a=new K(a.toJson());var c=a.getWidth(),e=a.getHeight();return 0===c&&0===e?this.centerAt(new Q({x:a.xmin,y:a.ymin,spatialReference:a.spatialReference&&a.spatialReference.toJson()})):this._extentUtil(null,null,a,d)},centerAt:function(a){return this._extentUtil(null,{mapCenter:a})},centerAndZoom:function(a,d){return this._extentUtil({targetLevel:d,
mapCenter:a,levelOrFactor:!0})},getScale:function(){return this.__LOD?this.__LOD.scale:ba.getScale(this)},getResolution:function(){return this.__LOD?this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*ba.getUnitValueForSR(this.spatialReference)},getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},_getView:function(){return this._view},setScale:function(a){return this._extentUtil({targetScale:a})},
getLayersVisibleAtScale:function(a){var d=[];(a=a||this.getScale())&&n.forEach(this.layerIds.concat(this.graphicsLayerIds),function(c){c=this.getLayer(c);c.isVisibleAtScale(a)&&d.push(c)},this);return d},getNumLevels:function(){var a=this.getMinZoom(),d=this.getMaxZoom();return a===d&&0>a?0:d-a+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(a){if(-1<a)return this._extentUtil({targetLevel:a})},getZoom:function(){return this.getLevel()},setZoom:function(a){return this.setLevel(a)},
getMinZoom:function(){return this._params.minZoom},getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(a){var d;r.isObject(a)?(d=a,a=d.title):d=y&&y[a];if(d){this._basemapDfd&&-1===this._basemapDfd.fired&&this._basemapDfd.cancel();var c=[],e=[],b=0;n.forEach(d.baseMapLayers||d.layers,function(d){var k,t={id:d.id,displayLevels:d.displayLevels,opacity:z.isDefined(d.opacity)?d.opacity:null,visible:z.isDefined(d.visibility)?d.visibility:null};if(d.type)switch(d.type){case "OpenStreetMap":k=
new ca(t);break;case "VectorTile":k=I.normalize(d.url);k=new ea(k,t);break;default:console.log("Map.setBasemap: "+z.substitute({basemapName:a,type:d.type},this.unknownLayerType))}else k=I.normalize(d.url),k=new ja(k,t);k&&(c.push(k),e.push(d),d.isReference||b++)},this);if(c.length&&b){var k={basemapName:a,infos:e,layers:c};if(this.loaded){var t=this,q=new h(E._dfdCanceller),g=function(a){q._pendingLayers--;a=n.indexOf(k.layers,this);-1<a&&(a=q._layerEvents[a])&&(l.disconnect(a[0]),l.disconnect(a[1]));
0>=q._pendingLayers&&(delete q._layerEvents,delete t._basemapDfd,0>q.fired&&q.callback(k))};this._basemapDfd=q;q._pendingLayers=0;q._layerEvents={};n.forEach(c,function(a,d){a&&(q._pendingLayers++,a.loaded?g(a):q._layerEvents[d]=[l.connect(a,"onLoad",a,g),l.connect(a,"onError",a,g)])});q.addCallback(ma(this,this._basemapLoaded))}else this._basemapLoaded(k)}else console.log("Map.setBasemap: "+z.substitute({basemapName:a},this.invalidBasemap))}else{d=[];for(var u in y)d.push(u);console.log("Map.setBasemap: "+
z.substitute({basemapName:a,list:d.join(",")},this.unknownBasemap))}},_basemapLoaded:function(a){var d=a.layers,c=a.infos,e=0,b=!0,k;this.loaded&&(n.forEach(d,function(a,d){a.loaded&&(c[d].isReference||e++)}),b=e);b&&(this.basemapLayerIds&&(k={basemapName:this._basemap,infos:y&&y[this._basemap]&&y[this._basemap].baseMapLayers},k.basemapName||(n.forEach(this.basemapLayerIds,function(a){if(this.getLayer(a)instanceof ca)return k.basemapName="osm",k.infos=y&&y.osm&&y.osm.baseMapLayers,!1},this),k.basemapName||
(k=null))),this._removeBasemap(),this._basemap=a.basemapName,this.basemapLayerIds=this._addBasemap(d,c),this.attr("data-basemap",this.getBasemap()),this.emit("basemap-change",{current:a,previous:k}))},_addBasemap:function(a,d){var c=[],e=[],b=0;n.forEach(a,function(a,k){d[k].isReference?c.push(a):(this.addLayer(a,b++),e.push(a.id))},this);c.length&&n.forEach(c,function(a){a.attr("data-reference",!0);this.addLayer(a,"top");e.push(a.id)},this);return e},_removeBasemap:function(){var a=this.basemapLayerIds,
d;a&&a.length&&n.forEach(a,function(a){(d=this.getLayer(a))&&this.removeLayer(d)},this)},getBasemap:function(){return this._basemap||""},translate:function(a,d){a=a||0;d=d||0;if(!this._txTimer){this._tx=this._ty=0;var c=this.toScreen(this.extent.getCenter());this.__panStart(c.x,c.y)}this._tx+=a;this._ty+=d;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var a=this._tx,
d=this._ty;this._tx=this._ty=0;this.__panEnd(a,d)},setTimeExtent:function(a){a=(this.timeExtent=a)?new a.constructor(a.toJson()):null;this.onTimeExtentChange(a)},setTimeSlider:function(a){this.timeSlider&&(ia(this._tsTimeExtentChange_connect),this.timeSlider=this._tsTimeExtentChange_connect=null);a&&(this.timeSlider=a,this.setTimeExtent(a.getCurrentTimeExtent()),this._tsTimeExtentChange_connect=Ea(a,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(a){if(this.visible!==a){this.visible=
a;a||(this._display=this.container.style.display);this.container.style.display=a?this._display:"none";if(this.autoResize){var d=a?"resume":"pause";this._rszSignal[d]();this._oriSignal[d]()}a&&this.resize()}return this},resize:function(a){clearTimeout(this._resizeT);this._destroyed||(!0===a?this._execResize():this._resizeT=setTimeout(this._execResize,this.resizeDelay))},_timedResize:function(){this._resizeT||this._execResize()},_execResize:function(){clearTimeout(this._resizeT);this._resizeT=null;
this.reposition();this._resize();this.autoResize&&this._startResizeTimer()},_resize:function(){var a=this.width,d=this.height,c=k.get(this.container,"display"),e=q.getContentBox(this.container);if(!("none"===c||0>=e.w||0>=e.h||a===e.w&&d===e.h)){if(c=this._zoomAnim||this._panAnim)c.stop(),c._fire("onEnd",[c.node]);za(this.root,{width:(this.width=e.w)+"px",height:(this.height=e.h)+"px"});e=this.width;c=this.height;this.attribution&&this.attribution.domNode&&k.set(this.attribution.domNode,"maxWidth",
Math.floor(e*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,e,c);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,e,c);var b=new V(this.extent),a=(new V(b.x,b.y,e/a*b.width,c/d*b.height,this.spatialReference)).getExtent();this.onResize(a,e,c);this._extentUtil(null,null,a,null,!0)}},reposition:function(){var a=this.position,d=a.x,c=a.y;this._reposition();a=this.position;if(d!==a.x||c!==a.y)this.onReposition(a.x,a.y)},
_reposition:function(){var a=q.position(this.container,!0),d=q.getPadBorderExtents(this.container);this.position.update(a.x+d.l,a.y+d.t)},_setClipRect:function(){delete this._clip;var a=7>=d("ie")||void 0===d("ie")&&7<=d("trident")?"rect(auto,auto,auto,auto)":"auto";if(this.wrapAround180){var c=this.width,e=this.height,b=this._getFrameWidth(),k=c-b;0<k&&(a=k/2,a="rect(0px,"+(a+b)+"px,"+e+"px,"+a+"px)",e=this.extent.getWidth(),c=b/c*e,this._clip=[(e-c)/2,c])}za(this.__container,"clip",a)},_getAvailExtent:function(){var a=
this.extent,d=this._clip;if(d){if(!a._clip){var c=new V(a);c.width=d[1];c.x+=d[0];a._clip=c.getExtent()}return a._clip}return a},_fixedPan:function(a,d){return this._extentUtil(null,{dx:a,dy:d})},panUp:function(){return this._fixedPan(0,-.75*this.height)},panUpperRight:function(){return this._fixedPan(.75*this.width,-.75*this.height)},panRight:function(){return this._fixedPan(.75*this.width,0)},panLowerRight:function(){return this._fixedPan(.75*this.width,.75*this.height)},panDown:function(){return this._fixedPan(0,
.75*this.height)},panLowerLeft:function(){return this._fixedPan(-.75*this.width,.75*this.height)},panLeft:function(){return this._fixedPan(-.75*this.width,0)},panUpperLeft:function(){return this._fixedPan(-.75*this.width,-.75*this.height)},enableSnapping:function(a){a=a||{};if("esri.SnappingManager"===a.declaredClass)this.snappingManager=a;else{var d=wa++,c=this;this._rids&&this._rids.push(d);p(["./SnappingManager"],function(e){var b=c._rids?n.indexOf(c._rids,d):-1;-1!==b&&(c._rids.splice(b,1),c.snappingManager=
new e(r.mixin({map:c},a)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();this.snappingManager=null},_createLabelLayer:function(){!this._labels&&oa&&this.loaded&&(this._labels=new oa({id:"_internal_LabelLayer"}),this._labels._setMap(this,this._gc._surface),this._processLabelLayers(),this.on("layers-reordered",this._processLabelLayers))},_processLabelLayers:function(){null==this._labelProcessor&&(this._labelProcessor=setTimeout(this._updateLabelLayers,
0))},_updateLabelLayers:function(){this._labelProcessor=null;this._labels&&(this._labels.removeAllFeatureLayers(),n.forEach(this.graphicsLayerIds,function(a){a=this.getLayer(a);"function"===typeof a.applyEdits?this._labels.addFeatureLayer(a):"esri.layers.WFSLayer"===a.declaredClass&&this._labels.addFeatureLayer(a)},this))},_getMapImageLyr:function(){this.loaded&&!this._mapImageLyr&&(this._mapImageLyr=new na,this._mapImageLyr._setMap(this,this._layersDiv),this._placeMapImageLyr());return this._mapImageLyr},
_placeMapImageLyr:function(){for(var a=this.layerIds,d=this._layerDivs,c=!1,e,b,k=a.length-1;0<=k;k--)if(e=a[k],b=this.getLayer(e),e=d[e],b&&e&&!b._isReference){v.place(this._mapImageLyr._div,e,"after");c=!0;break}c||v.place(this._mapImageLyr._div,this._layersDiv,"first")}})})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(p,f){var b=p.matrix={},m={};b._degToRad=function(b){return m[b]||(m[b]=Math.PI*b/180)};b._radToDeg=function(b){return b/Math.PI*180};b.Matrix2D=function(l){if(l)if("number"==
typeof l)this.xx=this.yy=l;else if(l instanceof Array){if(0<l.length){for(var h=b.normalize(l[0]),r=1;r<l.length;++r){var n=h,g=b.normalize(l[r]),h=new b.Matrix2D;h.xx=n.xx*g.xx+n.xy*g.yx;h.xy=n.xx*g.xy+n.xy*g.yy;h.yx=n.yx*g.xx+n.yy*g.yx;h.yy=n.yx*g.xy+n.yy*g.yy;h.dx=n.xx*g.dx+n.xy*g.dy+n.dx;h.dy=n.yx*g.dx+n.yy*g.dy+n.dy}f.mixin(this,h)}}else f.mixin(this,l)};f.extend(b.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});f.mixin(b,{identity:new b.Matrix2D,flipX:new b.Matrix2D({xx:-1}),flipY:new b.Matrix2D({yy:-1}),
flipXY:new b.Matrix2D({xx:-1,yy:-1}),translate:function(f,h){return 1<arguments.length?new b.Matrix2D({dx:f,dy:h}):new b.Matrix2D({dx:f.x,dy:f.y})},scale:function(f,h){return 1<arguments.length?new b.Matrix2D({xx:f,yy:h}):"number"==typeof f?new b.Matrix2D({xx:f,yy:f}):new b.Matrix2D({xx:f.x,yy:f.y})},rotate:function(f){var h=Math.cos(f);f=Math.sin(f);return new b.Matrix2D({xx:h,xy:-f,yx:f,yy:h})},rotateg:function(f){return b.rotate(b._degToRad(f))},skewX:function(f){return new b.Matrix2D({xy:Math.tan(f)})},
skewXg:function(f){return b.skewX(b._degToRad(f))},skewY:function(f){return new b.Matrix2D({yx:Math.tan(f)})},skewYg:function(f){return b.skewY(b._degToRad(f))},reflect:function(f,h){1==arguments.length&&(h=f.y,f=f.x);var l=f*f,n=h*h,g=l+n,e=2*f*h/g;return new b.Matrix2D({xx:2*l/g-1,xy:e,yx:e,yy:2*n/g-1})},project:function(f,h){1==arguments.length&&(h=f.y,f=f.x);var l=f*f,n=h*h,g=l+n,e=f*h/g;return new b.Matrix2D({xx:l/g,xy:e,yx:e,yy:n/g})},normalize:function(f){return f instanceof b.Matrix2D?f:new b.Matrix2D(f)},
isIdentity:function(b){return 1==b.xx&&0==b.xy&&0==b.yx&&1==b.yy&&0==b.dx&&0==b.dy},clone:function(f){var h=new b.Matrix2D,l;for(l in f)"number"==typeof f[l]&&"number"==typeof h[l]&&h[l]!=f[l]&&(h[l]=f[l]);return h},invert:function(f){f=b.normalize(f);var h=f.xx*f.yy-f.xy*f.yx;return f=new b.Matrix2D({xx:f.yy/h,xy:-f.xy/h,yx:-f.yx/h,yy:f.xx/h,dx:(f.xy*f.dy-f.yy*f.dx)/h,dy:(f.yx*f.dx-f.xx*f.dy)/h})},_multiplyPoint:function(b,f,r){return{x:b.xx*f+b.xy*r+b.dx,y:b.yx*f+b.yy*r+b.dy}},multiplyPoint:function(f,
h,r){f=b.normalize(f);return"number"==typeof h&&"number"==typeof r?b._multiplyPoint(f,h,r):b._multiplyPoint(f,h.x,h.y)},multiplyRectangle:function(f,h){var l=b.normalize(f);h=h||{x:0,y:0,width:0,height:0};if(b.isIdentity(l))return{x:h.x,y:h.y,width:h.width,height:h.height};var n=b.multiplyPoint(l,h.x,h.y),g=b.multiplyPoint(l,h.x,h.y+h.height),e=b.multiplyPoint(l,h.x+h.width,h.y),l=b.multiplyPoint(l,h.x+h.width,h.y+h.height),c=Math.min(n.x,g.x,e.x,l.x),a=Math.min(n.y,g.y,e.y,l.y);return{x:c,y:a,width:Math.max(n.x,
g.x,e.x,l.x)-c,height:Math.max(n.y,g.y,e.y,l.y)-a}},multiply:function(f){for(var h=b.normalize(f),l=1;l<arguments.length;++l){var n=h,g=b.normalize(arguments[l]),h=new b.Matrix2D;h.xx=n.xx*g.xx+n.xy*g.yx;h.xy=n.xx*g.xy+n.xy*g.yy;h.yx=n.yx*g.xx+n.yy*g.yx;h.yy=n.yx*g.xy+n.yy*g.yy;h.dx=n.xx*g.dx+n.xy*g.dy+n.dx;h.dy=n.yx*g.dx+n.yy*g.dy+n.dy}return h},_sandwich:function(f,h,r){return b.multiply(b.translate(h,r),f,b.translate(-h,-r))},scaleAt:function(f,h,r,n){switch(arguments.length){case 4:return b._sandwich(b.scale(f,
h),r,n);case 3:return"number"==typeof r?b._sandwich(b.scale(f),h,r):b._sandwich(b.scale(f,h),r.x,r.y)}return b._sandwich(b.scale(f),h.x,h.y)},rotateAt:function(f,h,r){return 2<arguments.length?b._sandwich(b.rotate(f),h,r):b._sandwich(b.rotate(f),h.x,h.y)},rotategAt:function(f,h,r){return 2<arguments.length?b._sandwich(b.rotateg(f),h,r):b._sandwich(b.rotateg(f),h.x,h.y)},skewXAt:function(f,h,r){return 2<arguments.length?b._sandwich(b.skewX(f),h,r):b._sandwich(b.skewX(f),h.x,h.y)},skewXgAt:function(f,
h,r){return 2<arguments.length?b._sandwich(b.skewXg(f),h,r):b._sandwich(b.skewXg(f),h.x,h.y)},skewYAt:function(f,h,r){return 2<arguments.length?b._sandwich(b.skewY(f),h,r):b._sandwich(b.skewY(f),h.x,h.y)},skewYgAt:function(f,h,r){return 2<arguments.length?b._sandwich(b.skewYg(f),h,r):b._sandwich(b.skewYg(f),h.x,h.y)}});p.Matrix2D=b.Matrix2D;return b})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(p,f,b,m,l,h,r,n,g){var e=f.getObject("dojox.gfx",!0),c=e._base={};e._hasClass=function(a,c){var d=a.getAttribute("className");return d&&0<=(" "+d+" ").indexOf(" "+c+" ")};e._addClass=function(a,c){var d=a.getAttribute("className")||"";(!d||0>(" "+d+" ").indexOf(" "+c+" "))&&a.setAttribute("className",d+(d?" ":"")+c)};e._removeClass=function(a,c){var d=a.getAttribute("className");d&&a.setAttribute("className",d.replace(new RegExp("(^|\\s+)"+c+"(\\s+|$)"),"$1$2"))};c._getFontMeasurements=function(){var a=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,e;m("ie")&&(e=l.doc.documentElement.style.fontSize||"",e||(l.doc.documentElement.style.fontSize="100%"));var b=n.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},l.body());for(c in a)b.style.fontSize=c,a[c]=16*Math.round(12*b.offsetHeight/16)/12/1E3;
m("ie")&&(l.doc.documentElement.style.fontSize=e);l.body().removeChild(b);return a};var a=null;c._getCachedFontMeasurements=function(d){if(d||!a)a=c._getFontMeasurements();return a};var u=null,v={};c._getTextBox=function(a,c,e){var d,b,k=arguments.length,t;u||(u=n.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},l.body()));d=u;d.className="";b=d.style;b.borderWidth="0";b.margin="0";b.padding="0";b.outline="0";if(1<k&&c)for(t in c)t in v||(b[t]=c[t]);2<k&&e&&(d.className=
e);d.innerHTML=a;d.getBoundingClientRect?(b=d.getBoundingClientRect(),b={l:b.left,t:b.top,w:b.width||b.right-b.left,h:b.height||b.bottom-b.top}):b=g.getMarginBox(d);d.innerHTML="";return b};c._computeTextLocation=function(a,c,e,b){var d={};switch(a.align){case "end":d.x=a.x-c;break;case "middle":d.x=a.x-c/2;break;default:d.x=a.x}d.y=a.y-e*(b?.75:1);return d};c._computeTextBoundingBox=function(a){if(!e._base._isRendered(a))return{x:0,y:0,width:0,height:0};var d;d=a.getShape();var b=a.getFont()||e.defaultFont;
a=a.getTextWidth();b=e.normalizedLength(b.size);d=c._computeTextLocation(d,a,b,!0);return{x:d.x,y:d.y,width:a,height:b}};c._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var q=0;c._getUniqueId=function(){var a;do a=p._scopeName+"xUnique"+ ++q;while(r.byId(a));return a};var k=m("pointer-events")?"touchAction":m("MSPointer")?"msTouchAction":null;c._fixMsTouchAction=k?function(a){a.rawNode.style[k]="none"}:function(){};f.mixin(e,{defaultPath:{type:"path",path:""},
defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},
defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a=
{};return function(d){var c=a[d];if(c)return new c;c=a[d]=new Function;c.prototype=e["default"+d];return new c}}(),normalizeColor:function(a){return a instanceof b?a:new b(a)},normalizeParameters:function(a,c){var d;if(c){var e={};for(d in a)d in c&&!(d in e)&&(a[d]=c[d])}return a},makeParameters:function(a,c){var d=null;if(!c)return f.delegate(a);var e={};for(d in a)d in e||(e[d]=f.clone(d in c?c[d]:a[d]));return e},formatNumber:function(a,c){var d=a.toString();if(0<=d.indexOf("e"))d=a.toFixed(4);
else{var e=d.indexOf(".");0<=e&&5<d.length-e&&(d=a.toFixed(4))}return 0>a?d:c?" "+d:d},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var d=e.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){d.style=a[0];d.variant=a[1];d.weight=a[2];var c=a[3].indexOf("/");d.size=0>c?a[3]:a[3].substring(0,c);var b=4;0>c&&("/"==a[4]?b=6:"/"==a[4].charAt(0)&&(b=5));b<a.length&&(d.family=a.slice(b).join(" "))}return d},cm_in_pt:72/2.54,mm_in_pt:7.2/
2.54,px_in_pt:function(){return e._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*e.px_in_pt()},px2pt:function(a){return a/e.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var d=e.px_in_pt(),c=parseFloat(a);switch(a.slice(-2)){case "px":return c;case "pt":return c*d;case "in":return 72*c*d;case "pc":return 12*c*d;case "mm":return c*e.mm_in_pt*d;case "cm":return c*e.cm_in_pt*d}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,
pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,c){return a&&c&&a===c},switchTo:function(a){var d="string"==typeof a?e[a]:a;d&&(h.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){e[a]=d[a]}),"string"==typeof a?e.renderer=a:h.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return e.renderer=e[a]&&e[a].Surface===e.Surface?a:null}))}});return e})},
"esri/basemaps":function(){define(["require","dojo/has","./kernel","dojo/i18n!./nls/jsapi"],function(p,f,b,m){return{streets:{title:m.basemaps.streets,thumbnailUrl:p.toUrl("./images/basemap/streets.jpg"),itemId:"d8855ee4d3d74413babfb0f41203b168",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]},satellite:{title:m.basemaps.satellite,thumbnailUrl:p.toUrl("./images/basemap/satellite.jpg"),itemId:"86de95d4e0244cba80f0fa2c9403a7b2",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]},
hybrid:{title:m.basemaps.hybrid,thumbnailUrl:p.toUrl("./images/basemap/hybrid.jpg"),itemId:"413fd05bbd7342f5991d5ec96f4f8b18",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",isReference:!0}]},terrain:{title:m.basemaps.terrain,thumbnailUrl:p.toUrl("./images/basemap/terrain.jpg"),itemId:"aab054ab883c4a4094c72e949566ad40",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"},
{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",isReference:!0}]},topo:{title:m.basemaps.topo,thumbnailUrl:p.toUrl("./images/basemap/topo.jpg"),itemId:"6e03e8c26aad4b9c92a87c1063ddb0e3",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}]},gray:{title:m.basemaps.gray,thumbnailUrl:p.toUrl("./images/basemap/gray.jpg"),itemId:"8b3b470883a744aeb60e5fff0a319ce7",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"},
{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",isReference:!0}]},"dark-gray":{title:m.basemaps["dark-gray"],thumbnailUrl:p.toUrl("./images/basemap/dark-gray.jpg"),itemId:"da65bacab5bd4defb576f839b6b28098",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",isReference:!0}]},oceans:{title:m.basemaps.oceans,
thumbnailUrl:p.toUrl("./images/basemap/oceans.jpg"),itemId:"48b8cec7ebf04b5fbdcaf70d09daff21",baseMapLayers:[{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",isReference:!0}]},"national-geographic":{title:m.basemaps["national-geographic"],thumbnailUrl:p.toUrl("./images/basemap/national-geographic.jpg"),itemId:"509e2d6b034246d692a461724ae2d62c",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}]},
osm:{title:m.basemaps.osm,thumbnailUrl:p.toUrl("./images/basemap/osm.jpg"),itemId:"5d2bfa736f8448b3a1708e1f6be23eed",baseMapLayers:[{type:"OpenStreetMap"}]},"dark-gray-vector":{title:m.basemaps["dark-gray"],thumbnailUrl:p.toUrl("./images/basemap/dark-gray.jpg"),itemId:"850db44b9eb845d3bd42b19e8aa7a024",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/850db44b9eb845d3bd42b19e8aa7a024/resources/styles/root.json",type:"VectorTile"}]},"gray-vector":{title:m.basemaps.gray,thumbnailUrl:p.toUrl("./images/basemap/gray.jpg"),
itemId:"0e02e6f86d02455091796eaae811d9b5",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/0e02e6f86d02455091796eaae811d9b5/resources/styles/root.json",type:"VectorTile"}]},"streets-vector":{title:m.basemaps.streets,thumbnailUrl:p.toUrl("./images/basemap/streets.jpg"),itemId:"4e1133c28ac04cca97693cf336cd49ad",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/4e1133c28ac04cca97693cf336cd49ad/resources/styles/root.json",type:"VectorTile"}]},"topo-vector":{title:m.basemaps.topo,
thumbnailUrl:p.toUrl("./images/basemap/topo.jpg"),itemId:"6f65bc1351b7411588a8cb43fe23dad7",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/6f65bc1351b7411588a8cb43fe23dad7/resources/styles/root.json",type:"VectorTile"}]},"streets-night-vector":{title:m.basemaps["streets-night-vector"],thumbnailUrl:p.toUrl("./images/basemap/streets-night.jpg"),itemId:"bf79e422e9454565ae0cbe9553cf6471",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/bf79e422e9454565ae0cbe9553cf6471/resources/styles/root.json",
type:"VectorTile"}]},"streets-relief-vector":{title:m.basemaps["streets-relief-vector"],thumbnailUrl:p.toUrl("./images/basemap/streets-relief.jpg"),itemId:"2e063e709e3446459f8538ed6743f879",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/2e063e709e3446459f8538ed6743f879/resources/styles/root.json",type:"VectorTile"}]},"streets-navigation-vector":{title:m.basemaps["streets-navigation-vector"],thumbnailUrl:p.toUrl("./images/basemap/streets-navigation.jpg"),itemId:"dcbbba0edf094eaa81af19298b9c6247",
baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/dcbbba0edf094eaa81af19298b9c6247/resources/styles/root.json",type:"VectorTile"}]}}})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),function(p,f,b,m,l,h){return p([m],{declaredClass:"esri.Evented",registerConnectEvents:function(){var b=this.constructor,h=this.constructor._meta.parents,g=[{}],e={},c,a,u=function(a,c){f.isArray(a)||(a=[a]);for(var e=0;e<
a.length;e++){var d=a[e];d._meta&&d._meta.parents&&u(d._meta.parents,c);d.prototype._eventMap&&c.push(f.mixin({},d.prototype._eventMap))}return c};if(!b._onMap){u(h,g);g.push(this._eventMap);h=f.mixin.apply(this,g);for(c in this)/^on\w/.test(c)&&f.isFunction(this[c])&&(g=this._hyphenLower(c).toLowerCase(),h[g]||(e[g]={method:c}));for(a in h)c=this._onCamelCase(a),e[a]={method:c,argKeys:h[a]};b._onMap=e;return b._onMap}},on:function(h,n){if(-1<h.indexOf(",")){for(var g=h.split(/\s*,\s*/),e=g.length,
c=[];e--;)c.push(this.on(g[e],n));c.remove=function(){for(var a=0;a<c.length;a++)c[a].remove()};return c}var g=this.constructor._onMap||this.registerConnectEvents(),e="string"==typeof h&&h.toLowerCase(),a=this._onCamelCase(e),u=g&&g[e];return(a=u&&u.method||this[a]&&f.isFunction(this[a])&&a)?u&&f.isArray(u.argKeys)?(g=this._onArr2Obj(n,g[e].argKeys),b.after(this,a,g,!0)):b.after(this,a,function(a){a=a||{};a.target||(a.target=this);n.call(this,a)},!0):this.inherited(arguments)},emit:function(b,h){var g,
e,c,a,u=b.toLowerCase();a=this._onCamelCase(b);var v=this.constructor._onMap||this.registerConnectEvents();a=(c=v&&v[u]&&v[u].method||f.isFunction(this[a])&&a)&&this[c];c&&v&&v[u]&&this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},v[u].argKeys)(h);h=h||{};h.target||(h.target=this);a&&(g=e&&e.length?e:[h],g=a.apply(this,g));this.inherited(arguments,[b,h]);return g},_onObj2Arr:function(b,f){if(f){var g=this;return function(e){var c,a=[],u=f.length;for(c=0;c<u;c++)a[c]=e[f[c]];b.apply(g,
a)}}return b},_onArr2Obj:function(b,f){if(f){var g=this;return function(){var e,c={},a=arguments.length;for(e=0;e<a;e++)c[f[e]]=arguments[e];c.target||(c.target=g);b.call(g,c)}}return b},_hyphenLower:function(b){return b.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(b,g){return(g?"-":"")+b.toLowerCase()})},_onCamelCase:function(b){return"on"+b.substr(0,1).toUpperCase()+b.substr(1).replace(/\-([a-z])/g,function(b,g){return g.toUpperCase()})}})})},"esri/fx":function(){define("dojo/_base/connect dojo/_base/fx dojo/_base/lang dojo/dom dojo/dom-geometry dojo/dom-style dojo/fx dojo/has ./kernel".split(" "),
function(p,f,b,m,l,h,r,n,g){return{animateRange:function(e){var c=e.range;return new f.Animation(b.mixin({curve:new f._Line(c.start,c.end)},e))},resize:function(e){var c=e.node=m.byId(e.node),a=e.start,g=e.end;a||(a=l.getMarginBox(c),c=l.getPadBorderExtents(c),a=e.start={left:a.l+c.l,top:a.t+c.t,width:a.w-c.w,height:a.h-c.h});g||(g=e.anchor?e.anchor:{x:a.left,y:a.top},c=e.size,g=e.end={left:a.left-(c.width-a.width)*(g.x-a.left)/a.width,top:a.top-(c.height-a.height)*(g.y-a.top)/a.height,width:c.width,
height:c.height});return f.animateProperty(b.mixin({properties:{left:{start:a.left,end:g.left},top:{start:a.top,end:g.top},width:{start:a.width,end:g.width},height:{start:a.height,end:g.height}}},e))},slideTo:function(e){var c=e.node=m.byId(e.node),a=h.getComputedStyle,g=null,v=null,q=function(){return function(){var e="absolute"==c.style.position?"absolute":"relative";g="absolute"==e?c.offsetTop:parseInt(a(c).top)||0;v="absolute"==e?c.offsetLeft:parseInt(a(c).left)||0;"absolute"!=e&&"relative"!=
e&&(e=l.position(c,!0),g=e.y,v=e.x,c.style.position="absolute",c.style.top=g+"px",c.style.left=v+"px")}}();q();e=f.animateProperty(b.mixin({properties:{top:{start:g,end:e.top||0},left:{start:v,end:e.left||0}}},e));p.connect(e,"beforeBegin",e,q);return e},flash:function(e){e=b.mixin({end:"#f00",duration:500,count:1},e);e.duration/=2*e.count;var c=m.byId(e.node),a=e.start;a||(a=h.getComputedStyle(c).backgroundColor);var g=e.end,v=[],q=e.count,c={node:c,duration:e.duration};for(e=0;e<q;e++)v.push(f.animateProperty(b.mixin({properties:{backgroundColor:{start:a,
end:g}}},c))),v.push(f.animateProperty(b.mixin({properties:{backgroundColor:{start:g,end:a}}},c)));return r.chain(v)}}})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){b.isAsync||e(0,function(){c(["./fx/Toggler"])});b=b.fx={};e={_fire:function(a,c){this[a]&&this[a].apply(this,c||[]);return this}};var a=function(a){this._index=-1;this._animations=a||[];
this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;m.forEach(this._animations,function(a){a&&("undefined"!=typeof a.duration&&(this.duration+=a.duration),a.delay&&(this.duration+=a.delay))},this)};a.prototype=new f;p.extend(a,{_onAnimate:function(){this._fire("onAnimate",arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],
this._onAnimateCtx=l.after(this._current,"onAnimate",p.hitch(this,"_onAnimate"),!0),this._onEndCtx=l.after(this._current,"onEnd",p.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,c){this._current||(this._current=this._animations[this._index=0]);if(!c&&"playing"==this._current.status())return this;var e=l.after(this._current,"beforeBegin",p.hitch(this,function(){this._fire("beforeBegin")}),!0),d=l.after(this._current,"onBegin",p.hitch(this,function(a){this._fire("onBegin",arguments)}),
!0),b=l.after(this._current,"onPlay",p.hitch(this,function(a){this._fire("onPlay",arguments);e.remove();d.remove();b.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=l.after(this._current,"onAnimate",p.hitch(this,"_onAnimate"),!0);this._onEndCtx&&this._onEndCtx.remove();this._onEndCtx=l.after(this._current,"onEnd",p.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=l.after(this._current,"onPause",
p.hitch(this,function(c){this._fire("onPause",arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(a,c){this.pause();var e=this.duration*a;this._current=null;m.some(this._animations,function(a,c){if(e<=a.duration)return this._current=a,this._index=c,!0;e-=a.duration;return!1},this);this._current&&this._current.gotoPercent(e/this._current.duration);c&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);
this._current=this._animations[this._index]}var c=l.after(this._current,"onStop",p.hitch(this,function(a){this._fire("onStop",arguments);c.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});p.extend(a,e);b.chain=function(c){return new a(p.isArray(c)?c:Array.prototype.slice.call(c,0))};var u=function(a){this._animations=
a||[];this._connects=[];this.duration=this._finished=0;m.forEach(a,function(a){var d=a.duration;a.delay&&(d+=a.delay);this.duration<d&&(this.duration=d);this._connects.push(l.after(a,"onEnd",p.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=new h.Animation({curve:[0,1],duration:this.duration});var c=this;m.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(a){c._connects.push(l.after(c._pseudoAnimation,a,function(){c._fire(a,arguments)},!0))})};p.extend(u,
{_doAction:function(a,c){m.forEach(this._animations,function(e){e[a].apply(e,c)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,c){var e=this._pseudoAnimation;e[a].apply(e,c)},play:function(a,c){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(a,c){var e=this.duration*a;m.forEach(this._animations,
function(a){a.gotoPercent(a.duration<e?1:e/a.duration,c)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},destroy:function(){this.stop();m.forEach(this._connects,function(a){a.remove()})}});p.extend(u,e);b.combine=function(a){return new u(p.isArray(a)?a:Array.prototype.slice.call(a,0))};b.wipeIn=function(a){var c=a.node=r.byId(a.node),e=c.style,d;a=
h.animateProperty(p.mixin({properties:{height:{start:function(){d=e.overflow;e.overflow="hidden";if("hidden"==e.visibility||"none"==e.display)return e.height="1px",e.display="",e.visibility="",1;var a=n.get(c,"height");return Math.max(a,1)},end:function(){return c.scrollHeight}}}},a));var b=function(){e.height="auto";e.overflow=d};l.after(a,"onStop",b,!0);l.after(a,"onEnd",b,!0);return a};b.wipeOut=function(a){var c=(a.node=r.byId(a.node)).style,e;a=h.animateProperty(p.mixin({properties:{height:{end:1}}},
a));l.after(a,"beforeBegin",function(){e=c.overflow;c.overflow="hidden";c.display=""},!0);var d=function(){c.overflow=e;c.height="auto";c.display="none"};l.after(a,"onStop",d,!0);l.after(a,"onEnd",d,!0);return a};b.slideTo=function(a){var c=null,e=null,d=function(a){return function(){var d=n.getComputedStyle(a),b=d.position;c="absolute"==b?a.offsetTop:parseInt(d.top)||0;e="absolute"==b?a.offsetLeft:parseInt(d.left)||0;"absolute"!=b&&"relative"!=b&&(d=g.position(a,!0),c=d.y,e=d.x,a.style.position=
"absolute",a.style.top=c+"px",a.style.left=e+"px")}}(a.node=r.byId(a.node));d();a=h.animateProperty(p.mixin({properties:{top:a.top||0,left:a.left||0}},a));l.after(a,"beforeBegin",d,!0);return a};return b})},"esri/tileUtils":function(){define(["dojo/_base/array","dojo/has","./kernel","./geometry/Point","./geometry/Extent"],function(p,f,b,m,l){return{_addFrameInfo:function(b,f){var h,g,e=2*f.origin[1],c=f.origin[0],a=b.origin.x,u=b.width,v;p.forEach(b.lods,function(b){h=Math.round(e/b.resolution);g=
Math.ceil(h/u);v=Math.floor((c-a)/(u*b.resolution));b._frameInfo||(b._frameInfo=[g,v,v+g-1,h])})},getContainingTileCoords:function(b,f,n){var g=b.origin;n=n.resolution;return{row:Math.floor((g.y-f.y)/(b.height*n)),col:Math.floor((f.x-g.x)/(b.width*n))}},getCandidateTileInfo:function(b,f,n){var g;g=b.width;for(var e=b.height,c=n.xmax-n.xmin,a=n.ymax-n.ymin,u=b.__tileInfo===f,v=u?b.getMinZoom():-1,u=u?b.getMaxZoom():-1,q=-1,k=f.lods,d=Math.abs,w,t,x,u=-1<u?u:k.length-1,v=-1<v?v:0;v<=u;v++)if(t=k[v])if(x=
c>a?d(a-e*t.resolution):d(c-g*t.resolution),0>q||x<=q)w=t,q=x;else break;g=w;w=g.resolution;e=(n.xmin+n.xmax)/2;c=(n.ymin+n.ymax)/2;a=b.width/2*w;w*=b.height/2;e=new l(e-a,c-w,e+a,c+w,n.spatialReference);n=new m(e.xmin,e.ymax,n.spatialReference);u=g.resolution;a=f.width;c=f.height;f=f.origin;b=b.__visibleDelta;w=Math.floor;k=a*u;d=c*u;u=w((f.y-n.y)/d);q=w((n.x-f.x)/k);v=f.y-u*d;f=w(Math.abs((n.x-(f.x+q*k))*a/k))+b.x;b=w(Math.abs((n.y-v)*c/d))+b.y;return{tile:{point:n,coords:{row:u,col:q},offsets:{x:f,
y:b}},lod:g,extent:e}},getTileExtent:function(b,f,n,g){var e=b.origin;f=b.lods[f].resolution;var c=b.width,a=b.height;return new l(g*f*c+e.x,e.y-(n+1)*f*a,(g+1)*f*c+e.x,e.y-n*f*a,b.spatialReference)}}})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ../srUtils".split(" "),function(p,f,b,m,l,h,r,n){function g(a,c){89.99999<c?c=89.99999:-89.99999>c&&(c=-89.99999);var e=.017453292519943*c;return[111319.49079327169*
a,3189068.5*Math.log((1+Math.sin(e))/(1-Math.sin(e)))]}function e(a,c,e){a=a/6378137*57.29577951308232;return e?[a,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*c/6378137)))]:[a-360*Math.floor((a+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*c/6378137)))]}var c={type:"point",x:0,y:0};p=p(r,{declaredClass:"esri.geometry.Point",constructor:function(a,e,b){f.mixin(this,c);f.isArray(a)?(this.x=a[0],this.y=a[1],this.spatialReference=e):f.isObject(a)?(f.mixin(this,
a),l.isDefined(this.latitude)&&(this.y=this.latitude),l.isDefined(this.longitude)&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=n.createSpatialReference(this.spatialReference))):(this.x=a,this.y=e,this.spatialReference=b);this.verifySR()},offset:function(a,c){return new this.constructor(this.x+a,this.y+c,this.spatialReference)},setX:function(a){this.x=a;this.clearCache();return this},setY:function(a){this.y=a;this.clearCache();return this},setLongitude:function(a){var c=this.spatialReference;
c&&(c._isWebMercator()?this.setX(g(a,this.y)[0]):4326===c.wkid&&this.setX(a));return this},setLatitude:function(a){var c=this.spatialReference;c&&(c._isWebMercator()?this.setY(g(this.x,a)[1]):4326===c.wkid&&this.setY(a));return this},getLongitude:function(){var a=this.spatialReference,c;a&&(a._isWebMercator()?c=e(this.x,this.y)[0]:4326===a.wkid&&(c=this.x));return c},getLatitude:function(){var a=this.spatialReference,c;a&&(a._isWebMercator()?c=e(this.x,this.y)[1]:4326===a.wkid&&(c=this.y));return c},
update:function(a,c){this.x=a;this.y=c;this.clearCache();return this},normalize:function(){var a=this.x,c=this.spatialReference;if(c){var e=c._getInfo();if(e){var b=e.valid[0],k=e.valid[1],e=2*k;a>k?(b=Math.ceil(Math.abs(a-k)/e),a-=b*e):a<b&&(b=Math.ceil(Math.abs(a-b)/e),a+=b*e)}}return new this.constructor(a,this.y,c)},toJson:function(){var a={x:this.x,y:this.y},c=this.spatialReference;c&&(a.spatialReference=c.toJson());return a}});p.lngLatToXY=g;p.xyToLngLat=e;p.defaultProps=c;return p})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(p,f,b,m,l){return p(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(b){this.spatialReference=b;return this},verifySR:function(){this.spatialReference||this.setSpatialReference(new l(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(b){return this.cache&&this.cache[b]},setCacheValue:function(b,f){this.cache||
(this.cache={});this.cache[b]=f}})})},"esri/srUtils":function(){define(["./SpatialReference","./ImageSpatialReference","./kernel","./sniff","dojo/_base/lang"],function(p,f,b,m,l){function h(b){var f=!1;b&&(b.ics||b.icsid)&&(f=!0);return f}return{isICS:h,createSpatialReference:function(b){var n=null;b&&(n=h(b)?new f(b):new p(b));return n}}})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),function(p,f,b,m,l,
h){return p(h,{declaredClass:"esri.ImageSpatialReference",constructor:function(b){b&&(f.isObject(b)&&f.mixin(this,b),this.url||console.error("ImageSpatialReference: must provide image service URL."))},icsid:null,ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(b){var f=!1;b&&(this.icsid&&b.icsid?f=this.icsid===b.icsid:this.ics&&b.ics&&(f=this.ics===b.ics));return f},toJson:function(b){var f=null,g=l.isDefined;b=g(b)?b:!0;g(this.icsid)?f={icsid:this.icsid}:
g(this.ics)&&(f={ics:this.ics});g(this.url)&&g(f)&&b&&(f.url=this.url);return f}})})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a){var u={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},v=p(n,{declaredClass:"esri.geometry.Extent",constructor:function(c,e,d,g,t){b.mixin(this,u);b.isObject(c)?(b.mixin(this,
c),this.spatialReference&&(this.spatialReference=a.createSpatialReference(this.spatialReference))):this.update(c,e,d,g,t);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new g((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(a){var c=this.getCenter(),d=a.x-c.x;a=a.y-c.y;return new v(this.xmin+d,this.ymin+a,this.xmax+d,this.ymax+a,this.spatialReference)},
update:function(a,c,d,e,b){this.xmin=a;this.ymin=c;this.xmax=d;this.ymax=e;this.spatialReference=b;this.clearCache();return this},offset:function(a,c){return new v(this.xmin+a,this.ymin+c,this.xmax+a,this.ymax+c,this.spatialReference)},expand:function(a){var c=(1-a)/2;a=this.getWidth()*c;c*=this.getHeight();return new v(this.xmin+a,this.ymin+c,this.xmax-a,this.ymax-c,this.spatialReference)},intersects:function(a){if(!a)return!1;var c=a.type,d=this.spatialReference,b=a.spatialReference;d&&b&&!d.equals(b)&&
d._canProject(b)&&(a=d.isWebMercator()?e.geographicToWebMercator(a):e.webMercatorToGeographic(a,!0));switch(c){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var a=this._normalize(!1,!0);b.isArray(a)||(a=[a]);return a},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var a=
this.spatialReference,c=a&&a._getInfo(),d=[],e=0;if(c&&this._isOutOfBounds(c)){var b=this,e=b.xmin,g=b.ymin,u=b.ymax,f=c.valid[0],h=c.valid[1];b.getWidth()>2*h&&(b=b.getCenter(),b=new v(b.x-h,g,b.x+h,u,new r(a.toJson())));var e=b.xmin-e,n=this._normalizeX(b.xmin,c),c=this._normalizeX(b.xmax,c);n.frameId===c.frameId?d.push(new v(n.x,g,c.x,u,new r(a.toJson()))):d.push(new v(n.x,g,h,u,new r(a.toJson())),new v(f,g,c.x,u,new r(a.toJson())))}else d.push(this.getExtent());return{extents:d,marginLeft:e}},
_intersectsMultipoint:function(a){var c=a.points.length,d;for(d=0;d<c;d++)if(this.contains(a.getPoint(d)))return!0;return!1},_intersectsExtent:function(a){var c,d,e,b,g=!1;this.xmin<=a.xmin?(c=a.xmin,this.xmax<c?g=!0:e=Math.min(this.xmax,a.xmax)-c):(c=this.xmin,a.xmax<c?g=!0:e=Math.min(this.xmax,a.xmax)-c);this.ymin<=a.ymin?(d=a.ymin,this.ymax<d?g=!0:b=Math.min(this.ymax,a.ymax)-d):(d=this.ymin,a.ymax<d?g=!0:b=Math.min(this.ymax,a.ymax)-d);return g?null:new v(c,d,c+e,d+b,this.spatialReference)},_intersectsPolygon:function(a){var c=
[this.xmin,this.ymax],d=[this.xmax,this.ymax],e=[this.xmin,this.ymin],b=[this.xmax,this.ymin],q=[c,d,e,b],c=[[e,c],[c,d],[d,b],[b,e]],e=a.rings,b=e.length,u,f=new g(0,0,this.spatialReference);u=q.length;for(d=0;d<u;d++)if(f.update(q[d][0],q[d][1]),a.contains(f))return!0;f.setSpatialReference(a.spatialReference);for(var v,h,d=0;d<b;d++)if(q=e[d],u=q.length){v=q[0];f.update(v[0],v[1]);if(this.contains(f))return!0;for(a=1;a<u;a++){h=q[a];f.update(h[0],h[1]);if(this.contains(f)||this._intersectsLine([v,
h],c))return!0;v=h}}return!1},_intersectsPolyline:function(a){var c=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],d,e=a.paths,b=e.length,q,u,f,v,h=new g(0,0,a.spatialReference);for(a=0;a<b;a++)if(q=e[a],u=q.length){f=q[0];h.update(f[0],f[1]);if(this.contains(h))return!0;for(d=1;d<u;d++){v=q[d];h.update(v[0],v[1]);if(this.contains(h)||this._intersectsLine([f,v],
c))return!0;f=v}}return!1},_intersectsLine:function(a,e){var d=c._getLineIntersection2,b,k=e.length;for(b=0;b<k;b++)if(d(a,e[b]))return!0;return!1},contains:function(a){if(!a)return!1;var c=a.type;if("point"===c){var d=this.spatialReference,e=a.spatialReference,c=a.x;a=a.y;d&&e&&!d.equals(e)&&d._canProject(e)&&(a=d.isWebMercator()?g.lngLatToXY(c,a):g.xyToLngLat(c,a,!0),c=a[0],a=a[1]);return c>=this.xmin&&c<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===c?this._containsExtent(a):!1},_containsExtent:function(a){var c=
a.xmin,d=a.ymin,e=a.xmax,b=a.ymax,q=a.spatialReference;a=new g(c,d,q);c=new g(c,b,q);b=new g(e,b,q);d=new g(e,d,q);return this.contains(a)&&this.contains(c)&&this.contains(b)&&this.contains(d)?!0:!1},union:function(a){return new v(Math.min(this.xmin,a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},getExtent:function(){var a=this.spatialReference;return new v(this.xmin,this.ymin,this.xmax,this.ymax,a&&new r(a.toJson()))},_shiftCM:function(a){var c=
this.getCacheValue("_shifted");if(!c){var c=new v(this.toJson()),d=c.spatialReference;if(a=a||d._getInfo()){var b=this._getCM(a);if(b){var t=d._isWebMercator()?e.webMercatorToGeographic(b):b;c.xmin-=b.x;c.xmax-=b.x;d._isWebMercator()||(t.x=this._normalizeX(t.x,a).x);c.setSpatialReference(new r(h.substitute({Central_Meridian:t.x},4326===d.wkid?a.altTemplate:a.wkTemplate)))}}this.setCacheValue("_shifted",c)}return c},_getCM:function(a){var c;this._isOutOfBounds(a)&&(c=this.getCenter());return c},_isOutOfBounds:function(a){var c=
a.valid[0];a=a.valid[1];var d=this.xmin,e=this.xmax;return!(d>=c&&d<=a&&e>=c&&e<=a)},_normalize:function(a,c,d){var e=new v(this.toJson()),b=e.spatialReference;if(b&&(d=d||b._getInfo())){var k=f.map(this._getParts(d),function(a){return a.extent});return 2<k.length?a?this._shiftCM(d):e.update(d.valid[0],e.ymin,d.valid[1],e.ymax,b):2===k.length?a?this._shiftCM(d):c?k:{rings:f.map(k,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:b}:
k[0]||e}return e},_getParts:function(a){var c=this.getCacheValue("_parts");if(!c){var c=[],d=this.xmin,e=this.xmax,b=this.ymin,g=this.ymax,q=this.spatialReference,u=this.getWidth(),f=d,h=e,n=0,l=0,r,m;a=a||q._getInfo();r=a.valid[0];m=a.valid[1];l=this._normalizeX(d,a);d=l.x;n=l.frameId;l=this._normalizeX(e,a);e=l.x;l=l.frameId;a=d===e&&0<u;if(u>2*m){u=new v(f<h?d:e,b,m,g,q);d=new v(r,b,f<h?e:d,g,q);m=new v(0,b,m,g,q);b=new v(r,b,0,g,q);q=[];r=[];u.contains(m)&&q.push(n);u.contains(b)&&r.push(n);d.contains(m)&&
q.push(l);d.contains(b)&&r.push(l);for(g=n+1;g<l;g++)q.push(g),r.push(g);c.push({extent:u,frameIds:[n]},{extent:d,frameIds:[l]},{extent:m,frameIds:q},{extent:b,frameIds:r})}else d>e||a?c.push({extent:new v(d,b,m,g,q),frameIds:[n]},{extent:new v(r,b,e,g,q),frameIds:[l]}):c.push({extent:new v(d,b,e,g,q),frameIds:[n]});this.setCacheValue("_parts",c)}return c},_normalizeX:function(a,c){var d=0,e=c.valid[0],b=c.valid[1],k=2*b;a>b?(d=Math.ceil(Math.abs(a-b)/k),a-=d*k):a<e&&(d=Math.ceil(Math.abs(a-e)/k),
a+=d*k,d=-d);return{x:a,frameId:d}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},c=this.spatialReference;c&&(a.spatialReference=c.toJson());return a}});v.defaultProps=u;return v})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),function(p,f,b,m,l,h){function r(b,e,c,a){if("point"===b.type){var g=e(b.x,b.y,a);return new b.constructor(g[0],g[1],new l(c))}if("extent"===
b.type){var g=e(b.xmin,b.ymin,a),f=e(b.xmax,b.ymax,a);return new b.constructor(g[0],g[1],f[0],f[1],new l(c))}if("polyline"===b.type||"polygon"===b.type){var g="polyline"===b.type,q=[],k;p.forEach(g?b.paths:b.rings,function(c){q.push(k=[]);p.forEach(c,function(c){k.push(e(c[0],c[1],a))})});return g?new b.constructor({paths:q,spatialReference:new l(c)}):new b.constructor({rings:q,spatialReference:new l(c)})}if("multipoint"===b.type){var d=[];p.forEach(b.points,function(c){d.push(e(c[0],c[1],a))});return new b.constructor({points:d,
spatialReference:new l(c)})}}function n(b,e){var c=b&&(null!=b.wkid?b:b.spatialReference),a=e&&(null!=e.wkid?e:e.spatialReference);return c&&a?a.equals(c)?!0:a._canProject(c):!1}return{canProject:n,project:function(b,e){var c=b&&b.spatialReference,a=e&&(null!=e.wkid?e:e.spatialReference);c&&a?c.equals(a)?b=new b.constructor(b.toJson()):n(c,a)?a.isWebMercator()?b=r(b,h.lngLatToXY,{wkid:102100}):4326===a.wkid&&(b=r(b,h.xyToLngLat,{wkid:4326})):b=null:b=null;return b},lngLatToXY:h.lngLatToXY,xyToLngLat:h.xyToLngLat,
geographicToWebMercator:function(b){return r(b,h.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(b,e){return r(b,h.xyToLngLat,{wkid:4326},e)}}})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(p,f,b,m){function l(b,g,e){return b instanceof m?new m(b.x+e*(g.x-b.x),b.y+e*(g.y-b.y)):[b[0]+e*(g[0]-b[0]),b[1]+e*(g[1]-b[1])]}function h(b,g){return 1E-8>Math.abs(b-g)}function r(b,g,e,c){var a,u=h(b[0],g[0])?1E10:(b[1]-g[1])/(b[0]-g[0]),
f=h(e[0],c[0])?1E10:(e[1]-c[1])/(e[0]-c[0]),q=b[1]-u*b[0],k=e[1]-f*e[0];if(h(u,f)){if(h(q,k)){if(h(b[0],g[0]))if(Math.min(b[1],g[1])<Math.max(e[1],c[1])||Math.max(b[1],g[1])>Math.min(e[1],c[1]))b=(b[1]+g[1]+e[1]+c[1]-Math.min(b[1],g[1],e[1],c[1])-Math.max(b[1],g[1],e[1],c[1]))/2,a=(b-q)/u;else return null;else if(Math.min(b[0],g[0])<Math.max(e[0],c[0])||Math.max(b[0],g[0])>Math.min(e[0],c[0]))a=(b[0]+g[0]+e[0]+c[0]-Math.min(b[0],g[0],e[0],c[0])-Math.max(b[0],g[0],e[0],c[0]))/2,b=u*a+q;else return null;
return[a,b]}return null}h(u,1E10)?(a=b[0],b=f*a+k):h(f,1E10)?(a=e[0],b=u*a+q):(a=-(q-k)/(u-f),b=b[1]===g[1]?b[1]:e[1]===c[1]?e[1]:u*a+q);return[a,b]}return{getLength:function(b,g){var e=g.x-b.x,c=g.y-b.y;return Math.sqrt(e*e+c*c)},_getLength:function(b,g){var e=g[0]-b[0],c=g[1]-b[1];return Math.sqrt(e*e+c*c)},getPointOnLine:l,getMidpoint:function(b,g){return l(b,g,.5)},_equals:h,_getLineIntersection:r,getLineIntersection:function(b,g,e,c,a){(b=r([b.x,b.y],[g.x,g.y],[e.x,e.y],[c.x,c.y]))&&(b=new m(b[0],
b[1],a));return b},_getLineIntersection2:function(b,g){var e=b[0],c=b[1],a=g[0],u=g[1],f=e[0],e=e[1],q=c[0],c=c[1],k=a[0],d=a[1],a=u[0]-k,k=f-k,w=q-f,u=u[1]-d,d=e-d,t=c-e,h=u*w-a*t;if(0===h)return!1;a=(a*d-u*k)/h;k=(w*d-t*k)/h;return 0<=a&&1>=a&&0<=k&&1>=k?[f+a*(q-f),e+a*(c-e)]:!1},_pointLineDistance:function(b,g){var e=g[0],c=g[1],a=e[0],u=e[1],e=b[0],f=b[1],q=c[0]-a,k=c[1]-u,d=e-a,w=f-u,c=Math.sqrt,t=Math.pow,h=c(t(q,2)+t(k,2)),d=(d*q+w*k)/(h*h),u=u+d*k;return c(t(e-(a+d*q),2)+t(f-u,2))}}})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),
function(p,f,b,m,l,h){function r(){f.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}r.prototype={addPlugin:function(b,g){var e=this,c=this._plugins,a=new l;try{p([b],function(u){b in c?a.resolve({id:c[b].declaredId||b.replace(/\//g,".")}):(c[b]=u,h(u.add(e,g),function(){var c={id:u.declaredId||b.replace(/\//g,".")};e.emit("plugin-add",c);a.resolve(c)},function(c){a.reject(c)}))})}catch(u){a.reject(u)}return a.promise},removePlugin:function(b){if(b in this._plugins){var g=
this._plugins[b];g.remove(this);delete this._plugins[b];this.emit("plugin-remove",{id:g.declaredId||b.replace(/\//g,".")})}},_pluginsHandler:function(){var f=this;b.some(arguments,function(b){if(b&&b.plugins&&b.plugins instanceof Array){b=b.plugins;var e,c,a;for(a=0;a<b.length;a++)e=b[a],c=e instanceof Object?e.id:e,f.addPlugin(c,e.options);return!0}})}};return r})},"esri/arcade/Dictionary":function(){define(["require","exports","./languageUtils","../geometry/Geometry","./ImmutableArray"],function(p,
f,b,m,l){return function(){function f(b){this.attributes=null;this.plain=!1;this.immutable=!0;this.attributes=b instanceof f?b.attributes:void 0===b?{}:null===b?{}:b}f.prototype.field=function(b){var f=b.toLowerCase();b=this.attributes[b];if(void 0!==b)return b;for(var g in this.attributes)if(g.toLowerCase()===f)return this.attributes[g];throw Error("Field not Found");};f.prototype.setField=function(b,f){if(this.immutable)throw Error("Dictionary is Immutable");var g=b.toLowerCase();if(void 0===this.attributes[b])for(var e in this.attributes)if(e.toLowerCase()===
g){this.attributes[e]=f;return}this.attributes[b]=f};f.prototype.hasField=function(b){var f=b.toLowerCase();if(void 0!==this.attributes[b])return!0;for(var g in this.attributes)if(g.toLowerCase()===f)return!0;return!1};f.prototype.keys=function(){var b=[],f;for(f in this.attributes)b.push(f);return b=b.sort()};f.prototype.castToText=function(){var f="",h;for(h in this.attributes){""!==f&&(f+=",");var g=this.attributes[h];null==g?g="null":b.isBoolean(g)||b.isNumber(g)||b.isString(g)?f+=JSON.stringify(h)+
":"+JSON.stringify(g):g instanceof m?f+=JSON.stringify(h)+":"+b.toStringExplicit(g):g instanceof l?f+=JSON.stringify(h)+":"+b.toStringExplicit(g):g instanceof Array?f+=JSON.stringify(h)+":"+b.toStringExplicit(g):g instanceof Date?f+=JSON.stringify(h)+":"+JSON.stringify(g):null!==g&&"object"===typeof g&&void 0!==g.castToText&&(f+=JSON.stringify(h)+":"+g.castToText())}return"{"+f+"}"};return f}()})},"esri/arcade/languageUtils":function(){define("require exports ../geometry/Geometry ../moment dojo/number ./ImmutableArray ../kernel ./ImmutablePointArray ./ImmutablePathArray dojo/_base/array ../geometry/Point ./FunctionWrapper".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){function u(a,c,d){if(""===c||null===c||void 0===c||c===d||c===d)return a;do a=a.replace(c,d);while(-1!==a.indexOf(c));return a}function v(c){return c instanceof P||c instanceof a||c instanceof Q}function q(a){return"string"===typeof a||a instanceof String}function k(a){return"boolean"===typeof a}function d(a){return"number"===typeof a}function w(a){return a instanceof Array}function t(a){return a instanceof Date}function x(a,c){if(!1===isNaN(a)){if(void 0===c||null===
c||""===c)return a.toString();c=u(c,"\u2030","");c=u(c,"\u00a4","");return l.format(a,{pattern:c})}return a.toString()}function A(a,c){var d=m(a);return void 0===c||null===c||""===c?d.format():d.format(y(c))}function y(a){return a.replace(/(LTS)|L|l/g,function(a){return"["+a+"]"})}function z(a,c,d){switch(d){case "\x3e":return a>c;case "\x3c":return a<c;case "\x3e\x3d":return a>=c;case "\x3c\x3d":return a<=c}return!1}function C(a,d){if(a===d||null===a&&d===f.voidOperation||null===d&&a===f.voidOperation)return!0;
if(t(a)&&t(d))return a.getTime()===d.getTime();if(a instanceof g||a instanceof n)return a.equalityTest(d);if(a instanceof c&&d instanceof c){var b=void 0,e=void 0;f.isVersion4?(b=a.cache._arcadeCacheId,e=d.cache._arcadeCacheId):(b=a.getCacheValue("_arcadeCacheId"),e=d.getCacheValue("_arcadeCacheId"));if(void 0!==b&&null!==b)return b===e}return void 0!==a&&void 0!==d&&null!==a&&null!==d&&"object"===typeof a&&"object"===typeof d&&(a._arcadeCacheId===d._arcadeCacheId&&void 0!==a._arcadeCacheId&&null!==
a._arcadeCacheId||a._underlyingGraphic===d._underlyingGraphic&&void 0!==a._underlyingGraphic&&null!==a._underlyingGraphic)?!0:!1}function B(a,c){if(q(a))return a;if(null===a)return"";if(d(a))return x(a,c);if(k(a))return a.toString();if(t(a))return A(a,c);if(a instanceof b)return JSON.stringify(a.toJson());if(w(a)){for(var e=[],g=0;g<a.length;g++)e[g]=G(a[g]);return"["+e.join(",")+"]"}if(a instanceof h){e=[];for(g=0;g<a.length();g++)e[g]=G(a.get(g));return"["+e.join(",")+"]"}return null!==a&&"object"===
typeof a&&void 0!==a.castToText?a.castToText():v(a)?"object, Function":""}function E(a,c){if(q(a))return a;if(null===a)return"";if(d(a))return x(a,c);if(k(a))return a.toString();if(t(a))return A(a,c);if(a instanceof b)return JSON.stringify(a.toJson());if(w(a)){for(var e=[],g=0;g<a.length;g++)e[g]=G(a[g]);return"["+e.join(",")+"]"}if(a instanceof h){e=[];for(g=0;g<a.length();g++)e[g]=G(a.get(g));return"["+e.join(",")+"]"}return null!==a&&"object"===typeof a&&void 0!==a.castToText?a.castToText():v(a)?
"object, Function":""}function G(a){if(null!==a){if(k(a)||d(a)||q(a))return JSON.stringify(a);if(a instanceof b||a instanceof h||a instanceof Array)return E(a);if(a instanceof Date)return JSON.stringify(A(a,""));if(null!==a&&"object"===typeof a&&void 0!==a.castToText)return a.castToText()}return"null"}function I(a,c){return d(a)?a:null===a||""===a?0:t(a)?NaN:k(a)?a?1:0:""===a||void 0===a?NaN:void 0!==c&&q(a)?(c=u(c,"\u2030",""),c=u(c,"\u00a4",""),l.parse(a,{pattern:c})):a===f.voidOperation?0:Number(a)}
function J(a,c){var d;e.some(c.fields,function(c){c.name===a&&(d=c.domain);return!!d});return d}p=function(){return function(a){this.value=a}}();var L=function(){return function(a){this.value=a}}(),P=function(){return function(a){this.fn=a}}(),Q=function(){return function(a){this.fn=a}}();f.NativeFunction=P;f.ImplicitResult=L;f.ReturnResult=p;f.SizzleFunction=Q;f.isVersion4=0===r.version.indexOf("4.");f.voidOperation={type:"VOID"};f.breakResult={type:"BREAK"};f.continueResult={type:"CONTINUE"};f.multiReplace=
u;f.isFunctionParameter=v;f.isSimpleType=function(a){return q(a)||d(a)||t(a)||k(a)||null===a||a===f.voidOperation||"number"===typeof a?!0:!1};f.defaultUndefined=function(a,c){return void 0===a?c:a};f.isString=q;f.isBoolean=k;f.isNumber=d;f.isArray=w;f.isFeatureCursor=function(a){return a&&void 0!==a.isFeatureCursor};f.isImmutableArray=function(a){return a instanceof h};f.isDate=t;f.pcCheck=function(a,c,d){if(a.length<c||a.length>d)throw Error("Function called with wrong number of Parameters");};f.generateUUID=
function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var d=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"===c?d:d&3|8).toString(16)})};f.formatNumber=x;f.formatDate=A;f.standardiseDateFormat=y;f.greaterThanLessThan=function(a,c,b){if(null===a){if(null===c||c===f.voidOperation)return z(null,null,b);if(d(c))return z(0,c,b);if(q(c)||k(c))return z(0,I(c),b);if(t(c))return z(0,c.getTime(),b)}if(a===f.voidOperation){if(null===c||c===f.voidOperation)return z(null,
null,b);if(d(c))return z(0,c,b);if(q(c)||k(c))return z(0,I(c),b);if(t(c))return z(0,c.getTime(),b)}else if(d(a)){if(d(c))return z(a,c,b);if(k(c))return z(a,I(c),b);if(null===c||c===f.voidOperation)return z(a,0,b);if(q(c))return z(a,I(c),b);if(t(c))return z(a,c.getTime(),b)}else if(q(a)){if(q(c))return z(B(a),B(c),b);if(t(c))return z(I(a),c.getTime(),b);if(d(c))return z(I(a),c,b);if(null===c||c===f.voidOperation)return z(I(a),0,b);if(k(c))return z(I(a),I(c),b)}else if(t(a)){if(t(c))return z(a,c,b);
if(null===c||c===f.voidOperation)return z(a.getTime(),0,b);if(d(c))return z(a.getTime(),c,b);if(k(c)||q(c))return z(a.getTime(),I(c),b)}else if(k(a)){if(k(c))return z(a,c,b);if(d(c))return z(I(a),I(c),b);if(t(c))return z(I(a),c.getTime(),b);if(null===c||c===f.voidOperation)return z(I(a),0,b);if(q(c))return z(I(a),I(c),b)}return!C(a,c)||"\x3c\x3d"!==b&&"\x3e\x3d"!==b?!1:!0};f.equalityTest=C;f.toString=B;f.toNumberArray=function(a){var c=[];if(!1===w(a))return null;if(a instanceof h){for(var d=0;d<
a.length();d++)c[d]=I(a.get(d));return c}for(d=0;d<a.length;d++)c[d]=I(a[d]);return c};f.toStringExplicit=E;f.toNumber=I;f.toDate=function(a,c){if(t(a))return a;if(q(a)){var d=m(a,[void 0===c||null===c||""===c?m.ISO_8601:c]);if(d.isValid())return d.toDate()}return null};f.toDateM=function(a,c){if(t(a))return m(a);if(q(a)){var d=m(a,[void 0===c||null===c||""===c?m.ISO_8601:c]);if(d.isValid())return d}return null};f.toBoolean=function(a){if(k(a))return a;if(q(a)){if(a=a.toLowerCase(),"true"===a)return!0}else if(d(a))return 0===
a||isNaN(a)?!1:!0;return!1};f.fixSpatialReference=function(a,c){if(null===a)return null;if(null===a.spatialReference||void 0===a.spatialReference)a.spatialReference=c;return a};f.getDomainValue=function(a,c){if(!a||!a.domain)return null;var d=null;c="string"===a.field.type||"esriFieldTypeString"===a.field.type?B(c):I(c);for(var b=0;b<a.domain.codedValues.length;b++){var e=a.domain.codedValues[b];e.code===c&&(d=e)}return null===d?null:d.name};f.getDomainCode=function(a,c){if(!a||!a.domain)return null;
var d=null;c=B(c);for(var b=0;b<a.domain.codedValues.length;b++){var e=a.domain.codedValues[b];e.name===c&&(d=e)}return null===d?null:d.code};f.getDomain=function(a,c,d,b){void 0===d&&(d=null);if(!c||!c.fields)return null;for(var k=null,t=0;t<c.fields.length;t++){var g=c.fields[t];g.name.toLowerCase()===a.toString().toLowerCase()&&(k=g)}if(null===k)return null;var q,u;b||(b=d&&c.typeIdField&&d._field(c.typeIdField));null!=b&&e.some(c.types,function(a){return a.id===b?((q=a.domains&&a.domains[k.name])&&
"inherited"===q.type&&(q=J(k.name,c),u=!0),!0):!1});u||q||(q=J(a,c));return{field:k,domain:q}}})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(p,f,b){return b})},"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],function(p,f,b,m){var l={ar:1,"ar-dz":1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bs:1,cs:1,da:1,de:1,"de-at":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-nz":1,es:1,"es-do":1,et:1,fi:1,fr:1,"fr-ca":1,
"fr-ch":1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1};f.load=function(f,r,n){f=b.locale;var g=f in l;if(!g){var e=f.split("-");1<e.length&&e[0]in l&&(f=e[0],g=!0)}g?r(["moment/locale/"+f],function(){n(m)}):n(m)}})},"moment/moment":function(){(function(p,f){"object"===typeof exports&&"undefined"!==typeof module?module.exports=f():"function"===typeof define&&define.amd?define(f):p.moment=
f()})(this,function(){function p(){return Fb.apply(null,arguments)}function f(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function b(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function m(a){return"number"===typeof a||"[object Number]"===Object.prototype.toString.call(a)}function l(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function h(a,c){var d=[],b;for(b=0;b<a.length;++b)d.push(c(a[b],b));return d}
function r(a,c){return Object.prototype.hasOwnProperty.call(a,c)}function n(a,c){for(var d in c)r(c,d)&&(a[d]=c[d]);r(c,"toString")&&(a.toString=c.toString);r(c,"valueOf")&&(a.valueOf=c.valueOf);return a}function g(a,c,d,b){return Sa(a,c,d,b,!0).utc()}function e(a){null==a._pf&&(a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null});return a._pf}function c(a){if(null==a._isValid){var c=
e(a),d=bc.call(c.parsedDateParts,function(a){return null!=a}),d=!isNaN(a._d.getTime())&&0>c.overflow&&!c.empty&&!c.invalidMonth&&!c.invalidWeekday&&!c.nullInput&&!c.invalidFormat&&!c.userInvalidated&&(!c.meridiem||c.meridiem&&d);a._strict&&(d=d&&0===c.charsLeftOver&&0===c.unusedTokens.length&&void 0===c.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(a))return d;a._isValid=d}return a._isValid}function a(a){var c=g(NaN);null!=a?n(e(c),a):e(c).userInvalidated=!0;return c}function u(a){return void 0===
a}function v(a,c){var d,b,k;u(c._isAMomentObject)||(a._isAMomentObject=c._isAMomentObject);u(c._i)||(a._i=c._i);u(c._f)||(a._f=c._f);u(c._l)||(a._l=c._l);u(c._strict)||(a._strict=c._strict);u(c._tzm)||(a._tzm=c._tzm);u(c._isUTC)||(a._isUTC=c._isUTC);u(c._offset)||(a._offset=c._offset);u(c._pf)||(a._pf=e(c));u(c._locale)||(a._locale=c._locale);if(0<Jb.length)for(d in Jb)b=Jb[d],k=c[b],u(k)||(a[b]=k);return a}function q(a){v(this,a);this._d=new Date(null!=a._d?a._d.getTime():NaN);this.isValid()||(this._d=
new Date(NaN));!1===Kb&&(Kb=!0,p.updateOffset(this),Kb=!1)}function k(a){return a instanceof q||null!=a&&null!=a._isAMomentObject}function d(a){return 0>a?Math.ceil(a)||0:Math.floor(a)}function w(a){a=+a;var c=0;0!==a&&isFinite(a)&&(c=d(a));return c}function t(a,c,d){var b=Math.min(a.length,c.length),e=Math.abs(a.length-c.length),k=0,t;for(t=0;t<b;t++)(d&&a[t]!==c[t]||!d&&w(a[t])!==w(c[t]))&&k++;return k+e}function x(a){!1===p.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&
console.warn("Deprecation warning: "+a)}function A(a,c){var d=!0;return n(function(){null!=p.deprecationHandler&&p.deprecationHandler(null,a);if(d){for(var b=[],e,k=0;k<arguments.length;k++){e="";if("object"===typeof arguments[k]){e+="\n["+k+"] ";for(var t in arguments[0])e+=t+": "+arguments[0][t]+", ";e=e.slice(0,-2)}else e=arguments[k];b.push(e)}x(a+"\nArguments: "+Array.prototype.slice.call(b).join("")+"\n"+Error().stack);d=!1}return c.apply(this,arguments)},c)}function y(a,c){null!=p.deprecationHandler&&
p.deprecationHandler(a,c);Sb[a]||(x(c),Sb[a]=!0)}function z(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function C(a,c){var d=n({},a),e;for(e in c)r(c,e)&&(b(a[e])&&b(c[e])?(d[e]={},n(d[e],a[e]),n(d[e],c[e])):null!=c[e]?d[e]=c[e]:delete d[e]);for(e in a)r(a,e)&&!r(c,e)&&b(a[e])&&(d[e]=n({},d[e]));return d}function B(a){null!=a&&this.set(a)}function E(a,c){var d=a.toLowerCase();nb[d]=nb[d+"s"]=nb[c]=a}function G(a){return"string"===typeof a?nb[a]||nb[a.toLowerCase()]:
void 0}function I(a){var c={},d,b;for(b in a)r(a,b)&&(d=G(b))&&(c[d]=a[b]);return c}function J(a){var c=[],d;for(d in a)c.push({unit:d,priority:Ka[d]});c.sort(function(a,c){return a.priority-c.priority});return c}function L(a,c){return function(d){if(null!=d){if(this.isValid())this._d["set"+(this._isUTC?"UTC":"")+a](d);p.updateOffset(this,c);return this}return P(this,a)}}function P(a,c){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+c]():NaN}function Q(a,c,d){var b=""+Math.abs(a);return(0<=a?d?
"+":"":"-")+Math.pow(10,Math.max(0,c-b.length)).toString().substr(1)+b}function H(a,c,d,b){var e=b;"string"===typeof b&&(e=function(){return this[b]()});a&&(lb[a]=e);c&&(lb[c[0]]=function(){return Q(e.apply(this,arguments),c[1],c[2])});d&&(lb[d]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function K(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function V(a){var c=a.match(Tb),d,b;d=0;for(b=c.length;d<b;d++)c[d]=lb[c[d]]?lb[c[d]]:K(c[d]);return function(d){var e=
"",k;for(k=0;k<b;k++)e+=c[k]instanceof Function?c[k].call(d,a):c[k];return e}}function S(a,c){if(!a.isValid())return a.localeData().invalidDate();c=ba(c,a.localeData());Lb[c]=Lb[c]||V(c);return Lb[c](a)}function ba(a,c){function d(a){return c.longDateFormat(a)||a}var b=5;for(xb.lastIndex=0;0<=b&&xb.test(a);)a=a.replace(xb,d),xb.lastIndex=0,--b;return a}function N(a,c,d){Ob[a]=z(c)?c:function(a,b){return a&&d?d:c}}function M(a,c){return r(Ob,a)?Ob[a](c._strict,c._locale):new RegExp(W(a))}function W(a){return ga(a.replace("\\",
"").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,c,d,b,e){return c||d||b||e}))}function ga(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26")}function D(a,c){var d,b=c;"string"===typeof a&&(a=[a]);m(c)&&(b=function(a,d){d[c]=w(a)});for(d=0;d<a.length;d++)Pb[a[d]]=b}function ja(a,c){D(a,function(a,d,b,e){b._w=b._w||{};c(a,b._w,b,e)})}function na(a,c){return(new Date(Date.UTC(a,c+1,0))).getUTCDate()}function ca(a,c){var d;if(!a.isValid())return a;if("string"===typeof c)if(/^\d+$/.test(c))c=
w(c);else if(c=a.localeData().monthsParse(c),!m(c))return a;d=Math.min(a.date(),na(a.year(),c));a._d["set"+(a._isUTC?"UTC":"")+"Month"](c,d);return a}function ea(a){return null!=a?(ca(this,a),p.updateOffset(this,!0),this):P(this,"Month")}function ua(){function a(a,c){return c.length-a.length}var c=[],d=[],b=[],e,k;for(e=0;12>e;e++)k=g([2E3,e]),c.push(this.monthsShort(k,"")),d.push(this.months(k,"")),b.push(this.months(k,"")),b.push(this.monthsShort(k,""));c.sort(a);d.sort(a);b.sort(a);for(e=0;12>
e;e++)c[e]=ga(c[e]),d[e]=ga(d[e]);for(e=0;24>e;e++)b[e]=ga(b[e]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+b.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+d.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+c.join("|")+")","i")}function ha(a){return 0===a%4&&0!==a%100||0===a%400}function oa(a,c,d,b,e,k,t){c=new Date(a,c,d,b,e,k,t);100>a&&0<=a&&isFinite(c.getFullYear())&&c.setFullYear(a);return c}function la(a){var c=new Date(Date.UTC.apply(null,arguments));
100>a&&0<=a&&isFinite(c.getUTCFullYear())&&c.setUTCFullYear(a);return c}function va(a,c,d){d=7+c-d;return-((7+la(a,0,d).getUTCDay()-c)%7)+d-1}function Ea(a,c,d,b,e){d=(7+d-b)%7;b=va(a,b,e);b=1+7*(c-1)+d+b;0>=b?(c=a-1,a=(ha(c)?366:365)+b):b>(ha(a)?366:365)?(c=a+1,a=b-(ha(a)?366:365)):(c=a,a=b);return{year:c,dayOfYear:a}}function ia(a,c,d){var b=va(a.year(),c,d),b=Math.floor((a.dayOfYear()-b-1)/7)+1;1>b?(a=a.year()-1,c=b+ma(a,c,d)):b>ma(a.year(),c,d)?(c=b-ma(a.year(),c,d),a=a.year()+1):(a=a.year(),
c=b);return{week:c,year:a}}function ma(a,c,d){var b=va(a,c,d);c=va(a+1,c,d);return((ha(a)?366:365)-b+c)/7}function za(a,c,d){var b,e;a=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],b=0;7>b;++b)e=g([2E3,1]).day(b),this._minWeekdaysParse[b]=this.weekdaysMin(e,"").toLocaleLowerCase(),this._shortWeekdaysParse[b]=this.weekdaysShort(e,"").toLocaleLowerCase(),this._weekdaysParse[b]=this.weekdays(e,"").toLocaleLowerCase();if(d)c=
"dddd"===c?Ha.call(this._weekdaysParse,a):"ddd"===c?Ha.call(this._shortWeekdaysParse,a):Ha.call(this._minWeekdaysParse,a);else if("dddd"===c){c=Ha.call(this._weekdaysParse,a);if(-1!==c)return c;c=Ha.call(this._shortWeekdaysParse,a);if(-1!==c)return c;c=Ha.call(this._minWeekdaysParse,a)}else if("ddd"===c){c=Ha.call(this._shortWeekdaysParse,a);if(-1!==c)return c;c=Ha.call(this._weekdaysParse,a);if(-1!==c)return c;c=Ha.call(this._minWeekdaysParse,a)}else{c=Ha.call(this._minWeekdaysParse,a);if(-1!==c)return c;
c=Ha.call(this._weekdaysParse,a);if(-1!==c)return c;c=Ha.call(this._shortWeekdaysParse,a)}return-1!==c?c:null}function Ba(){function a(a,c){return c.length-a.length}var c=[],d=[],b=[],e=[],k,t,q,u;for(k=0;7>k;k++)t=g([2E3,1]).day(k),q=this.weekdaysMin(t,""),u=this.weekdaysShort(t,""),t=this.weekdays(t,""),c.push(q),d.push(u),b.push(t),e.push(q),e.push(u),e.push(t);c.sort(a);d.sort(a);b.sort(a);e.sort(a);for(k=0;7>k;k++)d[k]=ga(d[k]),b[k]=ga(b[k]),e[k]=ga(e[k]);this._weekdaysMinRegex=this._weekdaysShortRegex=
this._weekdaysRegex=new RegExp("^("+e.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+b.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+d.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+c.join("|")+")","i")}function Ca(){return this.hours()%12||12}function wa(a,c){H(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),c)})}function sa(a,c){return c._meridiemParse}function Fa(a){return a?a.toLowerCase().replace("_","-"):a}function Ma(a){var c=
null;if(!Da[a]&&"undefined"!==typeof module&&module&&module.exports)try{c=Gb._abbr,require("./locale/"+a),La(c)}catch(Lc){}return Da[a]}function La(a,c){var d;a&&(d=u(c)?Ga(a):Ja(a,c))&&(Gb=d);return Gb._abbr}function Ja(a,c){if(null!==c){var d=Xb;c.abbr=a;if(null!=Da[a])y("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),
d=Da[a]._config;else if(null!=c.parentLocale)if(null!=Da[c.parentLocale])d=Da[c.parentLocale]._config;else return vb[c.parentLocale]||(vb[c.parentLocale]=[]),vb[c.parentLocale].push({name:a,config:c}),null;Da[a]=new B(C(d,c));vb[a]&&vb[a].forEach(function(a){Ja(a.name,a.config)});La(a);return Da[a]}delete Da[a];return null}function Ga(a){var c;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return Gb;if(!f(a)){if(c=Ma(a))return c;a=[a]}a:{c=0;for(var d,b,e,k;c<a.length;){k=Fa(a[c]).split("-");
d=k.length;for(b=(b=Fa(a[c+1]))?b.split("-"):null;0<d;){if(e=Ma(k.slice(0,d).join("-"))){a=e;break a}if(b&&b.length>=d&&t(k,b,!0)>=d-1)break;d--}c++}a=null}return a}function Wa(a){var c;(c=a._a)&&-2===e(a).overflow&&(c=0>c[bb]||11<c[bb]?bb:1>c[$a]||c[$a]>na(c[Ua],c[bb])?$a:0>c[Ia]||24<c[Ia]||24===c[Ia]&&(0!==c[Va]||0!==c[cb]||0!==c[kb])?Ia:0>c[Va]||59<c[Va]?Va:0>c[cb]||59<c[cb]?cb:0>c[kb]||999<c[kb]?kb:-1,e(a)._overflowDayOfYear&&(c<Ua||c>$a)&&(c=$a),e(a)._overflowWeeks&&-1===c&&(c=ec),e(a)._overflowWeekday&&
-1===c&&(c=fc),e(a).overflow=c);return a}function ab(a){var c,d;c=a._i;var b=gc.exec(c)||hc.exec(c),k,t,g,q;if(b){e(a).iso=!0;c=0;for(d=Hb.length;c<d;c++)if(Hb[c][1].exec(b[1])){t=Hb[c][0];k=!1!==Hb[c][2];break}if(null==t)a._isValid=!1;else{if(b[3]){c=0;for(d=Qb.length;c<d;c++)if(Qb[c][1].exec(b[3])){g=(b[2]||" ")+Qb[c][0];break}if(null==g){a._isValid=!1;return}}if(k||null==g){if(b[4])if(ic.exec(b[4]))q="Z";else{a._isValid=!1;return}a._f=t+(g||"")+(q||"");T(a)}else a._isValid=!1}}else a._isValid=
!1}function ib(a){var c=jc.exec(a._i);null!==c?a._d=new Date(+c[1]):(ab(a),!1===a._isValid&&(delete a._isValid,p.createFromInputFallback(a)))}function Na(a,c,d){return null!=a?a:null!=c?c:d}function Xa(a){var c,d=[],b;if(!a._d){b=new Date(p.now());b=a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()];if(a._w&&null==a._a[$a]&&null==a._a[bb]){var k,t,g,q,u,f;k=a._w;if(null!=k.GG||null!=k.W||null!=k.E){if(u=1,f=4,t=Na(k.GG,a._a[Ua],ia(pa(),1,4).year),
g=Na(k.W,1),q=Na(k.E,1),1>q||7<q)c=!0}else if(u=a._locale._week.dow,f=a._locale._week.doy,g=ia(pa(),u,f),t=Na(k.gg,a._a[Ua],g.year),g=Na(k.w,g.week),null!=k.d){if(q=k.d,0>q||6<q)c=!0}else if(null!=k.e){if(q=k.e+u,0>k.e||6<k.e)c=!0}else q=u;1>g||g>ma(t,u,f)?e(a)._overflowWeeks=!0:null!=c?e(a)._overflowWeekday=!0:(c=Ea(t,g,q,u,f),a._a[Ua]=c.year,a._dayOfYear=c.dayOfYear)}a._dayOfYear&&(c=Na(a._a[Ua],b[Ua]),a._dayOfYear>(ha(c)?366:365)&&(e(a)._overflowDayOfYear=!0),c=la(c,0,a._dayOfYear),a._a[bb]=c.getUTCMonth(),
a._a[$a]=c.getUTCDate());for(c=0;3>c&&null==a._a[c];++c)a._a[c]=d[c]=b[c];for(;7>c;c++)a._a[c]=d[c]=null==a._a[c]?2===c?1:0:a._a[c];24===a._a[Ia]&&0===a._a[Va]&&0===a._a[cb]&&0===a._a[kb]&&(a._nextDay=!0,a._a[Ia]=0);a._d=(a._useUTC?la:oa).apply(null,d);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[Ia]=24)}}function T(a){if(a._f===p.ISO_8601)ab(a);else{a._a=[];e(a).empty=!0;var c=""+a._i,d,b,k,t,g,q=c.length,u=0;k=ba(a._f,a._locale).match(Tb)||[];for(d=0;d<k.length;d++){t=
k[d];if(b=(c.match(M(t,a))||[])[0])g=c.substr(0,c.indexOf(b)),0<g.length&&e(a).unusedInput.push(g),c=c.slice(c.indexOf(b)+b.length),u+=b.length;if(lb[t]){if(b?e(a).empty=!1:e(a).unusedTokens.push(t),g=a,null!=b&&r(Pb,t))Pb[t](b,g._a,g,t)}else a._strict&&!b&&e(a).unusedTokens.push(t)}e(a).charsLeftOver=q-u;0<c.length&&e(a).unusedInput.push(c);12>=a._a[Ia]&&!0===e(a).bigHour&&0<a._a[Ia]&&(e(a).bigHour=void 0);e(a).parsedDateParts=a._a.slice(0);e(a).meridiem=a._meridiem;c=a._a;d=Ia;q=a._locale;k=a._a[Ia];
u=a._meridiem;null!=u&&(null!=q.meridiemHour?k=q.meridiemHour(k,u):null!=q.isPM&&((q=q.isPM(u))&&12>k&&(k+=12),q||12!==k||(k=0)));c[d]=k;Xa(a);Wa(a)}}function Aa(a){if(!a._d){var c=I(a._i);a._a=h([c.year,c.month,c.day||c.date,c.hour,c.minute,c.second,c.millisecond],function(a){return a&&parseInt(a,10)});Xa(a)}}function ra(d){var b=d._i,t=d._f;d._locale=d._locale||Ga(d._l);if(null===b||void 0===t&&""===b)return a({nullInput:!0});"string"===typeof b&&(d._i=b=d._locale.preparse(b));if(k(b))return new q(Wa(b));
if(l(b))d._d=b;else if(f(t)){var g,u,w;if(0===d._f.length)e(d).invalidFormat=!0,d._d=new Date(NaN);else{for(b=0;b<d._f.length;b++)if(t=0,g=v({},d),null!=d._useUTC&&(g._useUTC=d._useUTC),g._f=d._f[b],T(g),c(g)&&(t+=e(g).charsLeftOver,t+=10*e(g).unusedTokens.length,e(g).score=t,null==w||t<w))w=t,u=g;n(d,u||g)}}else t?T(d):aa(d);c(d)||(d._d=null);return d}function aa(a){var c=a._i;void 0===c?a._d=new Date(p.now()):l(c)?a._d=new Date(c.valueOf()):"string"===typeof c?ib(a):f(c)?(a._a=h(c.slice(0),function(a){return parseInt(a,
10)}),Xa(a)):"object"===typeof c?Aa(a):m(c)?a._d=new Date(c):p.createFromInputFallback(a)}function Sa(a,c,d,e,k){var t={};if(!0===d||!1===d)e=d,d=void 0;var g;if(g=b(a))a:{g=a;for(var u in g){g=!1;break a}g=!0}if(g||f(a)&&0===a.length)a=void 0;t._isAMomentObject=!0;t._useUTC=t._isUTC=k;t._l=d;t._i=a;t._f=c;t._strict=e;a=new q(Wa(ra(t)));a._nextDay&&(a.add(1,"d"),a._nextDay=void 0);return a}function pa(a,c,d,b){return Sa(a,c,d,b,!1)}function ka(a,c){var d,b;1===c.length&&f(c[0])&&(c=c[0]);if(!c.length)return pa();
d=c[0];for(b=1;b<c.length;++b)if(!c[b].isValid()||c[b][a](d))d=c[b];return d}function Ta(a){a=I(a);var c=a.year||0,d=a.quarter||0,b=a.month||0,e=a.week||0,k=a.day||0;this._milliseconds=+(a.millisecond||0)+1E3*(a.second||0)+6E4*(a.minute||0)+36E5*(a.hour||0);this._days=+k+7*e;this._months=+b+3*d+12*c;this._data={};this._locale=Ga();this._bubble()}function R(a){return a instanceof Ta}function da(a){return 0>a?-1*Math.round(-1*a):Math.round(a)}function F(a,c){H(a,0,0,function(){var a=this.utcOffset(),
d="+";0>a&&(a=-a,d="-");return d+Q(~~(a/60),2)+c+Q(~~a%60,2)})}function Z(a,c){var d=(c||"").match(a);if(null===d)return null;var d=((d[d.length-1]||[])+"").match(kc)||["-",0,0],b=+(60*d[1])+w(d[2]);return 0===b?0:"+"===d[0]?b:-b}function fa(a,c){var d,b;return c._isUTC?(d=c.clone(),b=(k(a)||l(a)?a.valueOf():pa(a).valueOf())-d.valueOf(),d._d.setTime(d._d.valueOf()+b),p.updateOffset(d,!1),d):pa(a).local()}function qa(){return this.isValid()?this._isUTC&&0===this._offset:!1}function X(a,c){var d=a,
b=null;R(a)?d={ms:a._milliseconds,d:a._days,M:a._months}:m(a)?(d={},c?d[c]=a:d.milliseconds=a):(b=lc.exec(a))?(d="-"===b[1]?-1:1,d={y:0,d:w(b[$a])*d,h:w(b[Ia])*d,m:w(b[Va])*d,s:w(b[cb])*d,ms:w(da(1E3*b[kb]))*d}):(b=mc.exec(a))?(d="-"===b[1]?-1:1,d={y:Y(b[2],d),M:Y(b[3],d),w:Y(b[4],d),d:Y(b[5],d),h:Y(b[6],d),m:Y(b[7],d),s:Y(b[8],d)}):null==d?d={}:"object"===typeof d&&("from"in d||"to"in d)&&(b=pa(d.from),d=pa(d.to),b.isValid()&&d.isValid()?(d=fa(d,b),b.isBefore(d)?d=O(b,d):(d=O(d,b),d.milliseconds=
-d.milliseconds,d.months=-d.months),b=d):b={milliseconds:0,months:0},d={},d.ms=b.milliseconds,d.M=b.months);d=new Ta(d);R(a)&&r(a,"_locale")&&(d._locale=a._locale);return d}function Y(a,c){var d=a&&parseFloat(a.replace(",","."));return(isNaN(d)?0:d)*c}function O(a,c){var d={milliseconds:0,months:0};d.months=c.month()-a.month()+12*(c.year()-a.year());a.clone().add(d.months,"M").isAfter(c)&&--d.months;d.milliseconds=+c-+a.clone().add(d.months,"M");return d}function ob(a,c){return function(d,b){var e;
null===b||isNaN(+b)||(y(c,"moment()."+c+"(period, number) is deprecated. Please use moment()."+c+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),e=d,d=b,b=e);e=X("string"===typeof d?+d:d,b);pb(this,e,a);return this}}function pb(a,c,d,b){var e=c._milliseconds,k=da(c._days);c=da(c._months);if(a.isValid()){b=null==b?!0:b;e&&a._d.setTime(a._d.valueOf()+e*d);if(k&&(e=P(a,"Date")+k*d,a.isValid()))a._d["set"+(a._isUTC?"UTC":"")+"Date"](e);c&&ca(a,P(a,"Month")+
c*d);b&&p.updateOffset(a,k||c)}}function sb(a){if(void 0===a)return this._locale._abbr;a=Ga(a);null!=a&&(this._locale=a);return this}function ub(){return this._locale}function Qa(a,c){H(0,[a,a.length],0,c)}function rb(a,c,d,b,e){var k;if(null==a)return ia(this,b,e).year;k=ma(a,b,e);c>k&&(c=k);a=Ea(a,c,d,b,e);a=la(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());this.date(a.getUTCDate());return this}function Ab(a,c){c[kb]=w(1E3*("0."+a))}function qb(a){return a}function Za(a,
c,d,b){var e=Ga();c=g().set(b,c);return e[d](c,a)}function jb(a,c,d){m(a)&&(c=a,a=void 0);a=a||"";if(null!=c)return Za(a,c,d,"month");var b=[];for(c=0;12>c;c++)b[c]=Za(a,c,d,"month");return b}function eb(a,c,d,b){"boolean"!==typeof a&&(d=c=a,a=!1);m(c)&&(d=c,c=void 0);c=c||"";var e=Ga();a=a?e._week.dow:0;if(null!=d)return Za(c,(d+a)%7,b,"day");e=[];for(d=0;7>d;d++)e[d]=Za(c,(d+a)%7,b,"day");return e}function Pa(a,c,d,b){c=X(c,d);a._milliseconds+=b*c._milliseconds;a._days+=b*c._days;a._months+=b*c._months;
return a._bubble()}function tb(a){return 0>a?Math.floor(a):Math.ceil(a)}function Ra(a){return function(){return this.as(a)}}function Ya(a){return function(){return this._data[a]}}function Bb(a,c,d,b,e){return e.relativeTime(c||1,!!d,a,b)}function mb(){var a=Rb(this._milliseconds)/1E3,c=Rb(this._days),b=Rb(this._months),e,k;e=d(a/60);k=d(e/60);a%=60;e%=60;var t=d(b/12),b=b%12,g=this.asSeconds();return g?(0>g?"-":"")+"P"+(t?t+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(k||e||a?"T":"")+(k?k+"H":"")+(e?e+"M":
"")+(a?a+"S":""):"P0D"}var Fb,bc=Array.prototype.some?Array.prototype.some:function(a){for(var c=Object(this),d=c.length>>>0,b=0;b<d;b++)if(b in c&&a.call(this,c[b],b,c))return!0;return!1},Jb=p.momentProperties=[],Kb=!1,Sb={};p.suppressDeprecationWarnings=!1;p.deprecationHandler=null;var cc=Object.keys?Object.keys:function(a){var c,d=[];for(c in a)r(a,c)&&d.push(c);return d},nb={},Ka={},Tb=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,
xb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Lb={},lb={},yb=/\d/,Oa=/\d\d/,Ub=/\d{3}/,Mb=/\d{4}/,zb=/[+-]?\d{6}/,ya=/\d\d?/,Vb=/\d\d\d\d?/,Wb=/\d\d\d\d\d\d?/,Eb=/\d{1,3}/,Nb=/\d{1,4}/,Cb=/[+-]?\d{1,6}/,dc=/\d+/,Db=/[+-]?\d+/,nc=/Z|[+-]\d\d:?\d\d/gi,Ib=/Z|[+-]\d\d(?::?\d\d)?/gi,wb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ob={},Pb={},Ua=0,bb=1,$a=2,Ia=3,Va=4,cb=5,kb=6,ec=7,fc=8,Ha=Array.prototype.indexOf?Array.prototype.indexOf:
function(a){var c;for(c=0;c<this.length;++c)if(this[c]===a)return c;return-1};H("M",["MM",2],"Mo",function(){return this.month()+1});H("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});H("MMMM",0,0,function(a){return this.localeData().months(this,a)});E("month","M");Ka.month=8;N("M",ya);N("MM",ya,Oa);N("MMM",function(a,c){return c.monthsShortRegex(a)});N("MMMM",function(a,c){return c.monthsRegex(a)});D(["M","MM"],function(a,c){c[bb]=w(a)-1});D(["MMM","MMMM"],function(a,c,d,b){b=
d._locale.monthsParse(a,b,d._strict);null!=b?c[bb]=b:e(d).invalidMonth=a});var Yb=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;H("Y",0,0,function(){var a=this.year();return 9999>=a?""+a:"+"+a});H(0,["YY",2],0,function(){return this.year()%100});H(0,["YYYY",4],0,"year");H(0,["YYYYY",5],0,"year");H(0,["YYYYYY",6,!0],0,"year");E("year","y");Ka.year=1;N("Y",Db);N("YY",ya,Oa);N("YYYY",Nb,Mb);N("YYYYY",Cb,zb);N("YYYYYY",Cb,zb);D(["YYYYY","YYYYYY"],Ua);D("YYYY",function(a,c){c[Ua]=2===a.length?p.parseTwoDigitYear(a):
w(a)});D("YY",function(a,c){c[Ua]=p.parseTwoDigitYear(a)});D("Y",function(a,c){c[Ua]=parseInt(a,10)});p.parseTwoDigitYear=function(a){return w(a)+(68<w(a)?1900:2E3)};var Zb=L("FullYear",!0);H("w",["ww",2],"wo","week");H("W",["WW",2],"Wo","isoWeek");E("week","w");E("isoWeek","W");Ka.week=5;Ka.isoWeek=5;N("w",ya);N("ww",ya,Oa);N("W",ya);N("WW",ya,Oa);ja(["w","ww","W","WW"],function(a,c,d,b){c[b.substr(0,1)]=w(a)});H("d",0,"do","day");H("dd",0,0,function(a){return this.localeData().weekdaysMin(this,
a)});H("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});H("dddd",0,0,function(a){return this.localeData().weekdays(this,a)});H("e",0,0,"weekday");H("E",0,0,"isoWeekday");E("day","d");E("weekday","e");E("isoWeekday","E");Ka.day=11;Ka.weekday=11;Ka.isoWeekday=11;N("d",ya);N("e",ya);N("E",ya);N("dd",function(a,c){return c.weekdaysMinRegex(a)});N("ddd",function(a,c){return c.weekdaysShortRegex(a)});N("dddd",function(a,c){return c.weekdaysRegex(a)});ja(["dd","ddd","dddd"],function(a,
c,d,b){b=d._locale.weekdaysParse(a,b,d._strict);null!=b?c.d=b:e(d).invalidWeekday=a});ja(["d","e","E"],function(a,c,d,b){c[b]=w(a)});H("H",["HH",2],0,"hour");H("h",["hh",2],0,Ca);H("k",["kk",2],0,function(){return this.hours()||24});H("hmm",0,0,function(){return""+Ca.apply(this)+Q(this.minutes(),2)});H("hmmss",0,0,function(){return""+Ca.apply(this)+Q(this.minutes(),2)+Q(this.seconds(),2)});H("Hmm",0,0,function(){return""+this.hours()+Q(this.minutes(),2)});H("Hmmss",0,0,function(){return""+this.hours()+
Q(this.minutes(),2)+Q(this.seconds(),2)});wa("a",!0);wa("A",!1);E("hour","h");Ka.hour=13;N("a",sa);N("A",sa);N("H",ya);N("h",ya);N("HH",ya,Oa);N("hh",ya,Oa);N("hmm",Vb);N("hmmss",Wb);N("Hmm",Vb);N("Hmmss",Wb);D(["H","HH"],Ia);D(["a","A"],function(a,c,d){d._isPm=d._locale.isPM(a);d._meridiem=a});D(["h","hh"],function(a,c,d){c[Ia]=w(a);e(d).bigHour=!0});D("hmm",function(a,c,d){var b=a.length-2;c[Ia]=w(a.substr(0,b));c[Va]=w(a.substr(b));e(d).bigHour=!0});D("hmmss",function(a,c,d){var b=a.length-4,k=
a.length-2;c[Ia]=w(a.substr(0,b));c[Va]=w(a.substr(b,2));c[cb]=w(a.substr(k));e(d).bigHour=!0});D("Hmm",function(a,c,d){d=a.length-2;c[Ia]=w(a.substr(0,d));c[Va]=w(a.substr(d))});D("Hmmss",function(a,c,d){d=a.length-4;var b=a.length-2;c[Ia]=w(a.substr(0,d));c[Va]=w(a.substr(d,2));c[cb]=w(a.substr(b))});var oc=L("Hours",!0),Xb={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",
LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",ordinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),meridiemParse:/[ap]\.?m?\.?/i},Da={},vb={},Gb,gc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,hc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
ic=/Z|[+-]\d\d(?::?\d\d)?/,Hb=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Qb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",
/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],jc=/^\/?Date\((\-?\d+)/i;p.createFromInputFallback=A("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=
new Date(a._i+(a._useUTC?" UTC":""))});p.ISO_8601=function(){};var pc=A("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var c=pa.apply(null,arguments);return this.isValid()&&c.isValid()?c<this?this:c:a()}),qc=A("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var c=pa.apply(null,arguments);return this.isValid()&&c.isValid()?c>this?this:c:a()});F("Z",":");F("ZZ","");N("Z",
Ib);N("ZZ",Ib);D(["Z","ZZ"],function(a,c,d){d._useUTC=!0;d._tzm=Z(Ib,a)});var kc=/([\+\-]|\d\d)/gi;p.updateOffset=function(){};var lc=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,mc=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;X.fn=Ta.prototype;var rc=ob(1,"add"),sc=ob(-1,"subtract");p.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";p.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var $b=A("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",
function(a){return void 0===a?this.localeData():this.locale(a)});H(0,["gg",2],0,function(){return this.weekYear()%100});H(0,["GG",2],0,function(){return this.isoWeekYear()%100});Qa("gggg","weekYear");Qa("ggggg","weekYear");Qa("GGGG","isoWeekYear");Qa("GGGGG","isoWeekYear");E("weekYear","gg");E("isoWeekYear","GG");Ka.weekYear=1;Ka.isoWeekYear=1;N("G",Db);N("g",Db);N("GG",ya,Oa);N("gg",ya,Oa);N("GGGG",Nb,Mb);N("gggg",Nb,Mb);N("GGGGG",Cb,zb);N("ggggg",Cb,zb);ja(["gggg","ggggg","GGGG","GGGGG"],function(a,
c,d,b){c[b.substr(0,2)]=w(a)});ja(["gg","GG"],function(a,c,d,b){c[b]=p.parseTwoDigitYear(a)});H("Q",0,"Qo","quarter");E("quarter","Q");Ka.quarter=7;N("Q",yb);D("Q",function(a,c){c[bb]=3*(w(a)-1)});H("D",["DD",2],"Do","date");E("date","D");Ka.date=9;N("D",ya);N("DD",ya,Oa);N("Do",function(a,c){return a?c._ordinalParse:c._ordinalParseLenient});D(["D","DD"],$a);D("Do",function(a,c){c[$a]=w(a.match(ya)[0],10)});var ac=L("Date",!0);H("DDD",["DDDD",3],"DDDo","dayOfYear");E("dayOfYear","DDD");Ka.dayOfYear=
4;N("DDD",Eb);N("DDDD",Ub);D(["DDD","DDDD"],function(a,c,d){d._dayOfYear=w(a)});H("m",["mm",2],0,"minute");E("minute","m");Ka.minute=14;N("m",ya);N("mm",ya,Oa);D(["m","mm"],Va);var tc=L("Minutes",!1);H("s",["ss",2],0,"second");E("second","s");Ka.second=15;N("s",ya);N("ss",ya,Oa);D(["s","ss"],cb);var uc=L("Seconds",!1);H("S",0,0,function(){return~~(this.millisecond()/100)});H(0,["SS",2],0,function(){return~~(this.millisecond()/10)});H(0,["SSS",3],0,"millisecond");H(0,["SSSS",4],0,function(){return 10*
this.millisecond()});H(0,["SSSSS",5],0,function(){return 100*this.millisecond()});H(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});H(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});H(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});H(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});E("millisecond","ms");Ka.millisecond=16;N("S",Eb,yb);N("SS",Eb,Oa);N("SSS",Eb,Ub);var fb;for(fb="SSSS";9>=fb.length;fb+="S")N(fb,dc);for(fb="S";9>=fb.length;fb+="S")D(fb,
Ab);var vc=L("Milliseconds",!1);H("z",0,0,"zoneAbbr");H("zz",0,0,"zoneName");var U=q.prototype;U.add=rc;U.calendar=function(a,c){var d=a||pa(),b=fa(d,this).startOf("day"),b=p.calendarFormat(this,b)||"sameElse",e=c&&(z(c[b])?c[b].call(this,d):c[b]);return this.format(e||this.localeData().calendar(b,this,pa(d)))};U.clone=function(){return new q(this)};U.diff=function(a,c,b){var e;if(!this.isValid())return NaN;a=fa(a,this);if(!a.isValid())return NaN;e=6E4*(a.utcOffset()-this.utcOffset());c=G(c);if("year"===
c||"month"===c||"quarter"===c){e=12*(a.year()-this.year())+(a.month()-this.month());var k=this.clone().add(e,"months"),t;0>a-k?(t=this.clone().add(e-1,"months"),a=(a-k)/(k-t)):(t=this.clone().add(e+1,"months"),a=(a-k)/(t-k));a=-(e+a)||0;"quarter"===c?a/=3:"year"===c&&(a/=12)}else a=this-a,a="second"===c?a/1E3:"minute"===c?a/6E4:"hour"===c?a/36E5:"day"===c?(a-e)/864E5:"week"===c?(a-e)/6048E5:a;return b?a:d(a)};U.endOf=function(a){a=G(a);if(void 0===a||"millisecond"===a)return this;"date"===a&&(a="day");
return this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")};U.format=function(a){a||(a=this.isUtc()?p.defaultFormatUtc:p.defaultFormat);a=S(this,a);return this.localeData().postformat(a)};U.from=function(a,c){return this.isValid()&&(k(a)&&a.isValid()||pa(a).isValid())?X({to:this,from:a}).locale(this.locale()).humanize(!c):this.localeData().invalidDate()};U.fromNow=function(a){return this.from(pa(),a)};U.to=function(a,c){return this.isValid()&&(k(a)&&a.isValid()||pa(a).isValid())?X({from:this,
to:a}).locale(this.locale()).humanize(!c):this.localeData().invalidDate()};U.toNow=function(a){return this.to(pa(),a)};U.get=function(a){a=G(a);return z(this[a])?this[a]():this};U.invalidAt=function(){return e(this).overflow};U.isAfter=function(a,c){var d=k(a)?a:pa(a);if(!this.isValid()||!d.isValid())return!1;c=G(u(c)?"millisecond":c);return"millisecond"===c?this.valueOf()>d.valueOf():d.valueOf()<this.clone().startOf(c).valueOf()};U.isBefore=function(a,c){var d=k(a)?a:pa(a);if(!this.isValid()||!d.isValid())return!1;
c=G(u(c)?"millisecond":c);return"millisecond"===c?this.valueOf()<d.valueOf():this.clone().endOf(c).valueOf()<d.valueOf()};U.isBetween=function(a,c,d,b){b=b||"()";return("("===b[0]?this.isAfter(a,d):!this.isBefore(a,d))&&(")"===b[1]?this.isBefore(c,d):!this.isAfter(c,d))};U.isSame=function(a,c){var d=k(a)?a:pa(a);if(!this.isValid()||!d.isValid())return!1;c=G(c||"millisecond");if("millisecond"===c)return this.valueOf()===d.valueOf();d=d.valueOf();return this.clone().startOf(c).valueOf()<=d&&d<=this.clone().endOf(c).valueOf()};
U.isSameOrAfter=function(a,c){return this.isSame(a,c)||this.isAfter(a,c)};U.isSameOrBefore=function(a,c){return this.isSame(a,c)||this.isBefore(a,c)};U.isValid=function(){return c(this)};U.lang=$b;U.locale=sb;U.localeData=ub;U.max=qc;U.min=pc;U.parsingFlags=function(){return n({},e(this))};U.set=function(a,c){if("object"===typeof a){a=I(a);for(var d=J(a),b=0;b<d.length;b++)this[d[b].unit](a[d[b].unit])}else if(a=G(a),z(this[a]))return this[a](c);return this};U.startOf=function(a){a=G(a);switch(a){case "year":this.month(0);
case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":case "date":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===a&&this.weekday(0);"isoWeek"===a&&this.isoWeekday(1);"quarter"===a&&this.month(3*Math.floor(this.month()/3));return this};U.subtract=sc;U.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};U.toObject=function(){return{years:this.year(),
months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};U.toDate=function(){return new Date(this.valueOf())};U.toISOString=function(){var a=this.clone().utc();return 0<a.year()&&9999>=a.year()?z(Date.prototype.toISOString)?this.toDate().toISOString():S(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):S(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")};U.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",
c="";this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",c="Z");var a="["+a+'("]',d=0<this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(a+d+"-MM-DD[T]HH:mm:ss.SSS"+(c+'[")]'))};U.toJSON=function(){return this.isValid()?this.toISOString():null};U.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};U.unix=function(){return Math.floor(this.valueOf()/1E3)};U.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||
0)};U.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};U.year=Zb;U.isLeapYear=function(){return ha(this.year())};U.weekYear=function(a){return rb.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};U.isoWeekYear=function(a){return rb.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)};U.quarter=U.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%
3)};U.month=ea;U.daysInMonth=function(){return na(this.year(),this.month())};U.week=U.weeks=function(a){var c=this.localeData().week(this);return null==a?c:this.add(7*(a-c),"d")};U.isoWeek=U.isoWeeks=function(a){var c=ia(this,1,4).week;return null==a?c:this.add(7*(a-c),"d")};U.weeksInYear=function(){var a=this.localeData()._week;return ma(this.year(),a.dow,a.doy)};U.isoWeeksInYear=function(){return ma(this.year(),1,4)};U.date=ac;U.day=U.days=function(a){if(!this.isValid())return null!=a?this:NaN;
var c=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=a){var d=this.localeData();"string"===typeof a&&(isNaN(a)?(a=d.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,10));return this.add(a-c,"d")}return c};U.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var c=(this.day()+7-this.localeData()._week.dow)%7;return null==a?c:this.add(a-c,"d")};U.isoWeekday=function(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var c=this.localeData();a="string"===typeof a?
c.weekdaysParse(a)%7||7:isNaN(a)?null:a;return this.day(this.day()%7?a:a-7)}return this.day()||7};U.dayOfYear=function(a){var c=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==a?c:this.add(a-c,"d")};U.hour=U.hours=oc;U.minute=U.minutes=tc;U.second=U.seconds=uc;U.millisecond=U.milliseconds=vc;U.utcOffset=function(a,c){var d=this._offset||0,b;if(!this.isValid())return null!=a?this:NaN;if(null!=a){if("string"===typeof a){if(a=Z(Ib,a),null===a)return this}else 16>
Math.abs(a)&&(a*=60);!this._isUTC&&c&&(b=15*-Math.round(this._d.getTimezoneOffset()/15));this._offset=a;this._isUTC=!0;null!=b&&this.add(b,"m");d!==a&&(!c||this._changeInProgress?pb(this,X(a-d,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,p.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?d:15*-Math.round(this._d.getTimezoneOffset()/15)};U.utc=function(a){return this.utcOffset(0,a)};U.local=function(a){this._isUTC&&(this.utcOffset(0,a),this._isUTC=
!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};U.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm);else if("string"===typeof this._i){var a=Z(nc,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this};U.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?pa(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};U.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};
U.isLocal=function(){return this.isValid()?!this._isUTC:!1};U.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};U.isUtc=qa;U.isUTC=qa;U.zoneAbbr=function(){return this._isUTC?"UTC":""};U.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};U.dates=A("dates accessor is deprecated. Use date instead.",ac);U.months=A("months accessor is deprecated. Use month instead",ea);U.years=A("years accessor is deprecated. Use year instead",Zb);U.zone=A("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",
function(a,c){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,c),this):-this.utcOffset()});U.isDSTShifted=A("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!u(this._isDSTShifted))return this._isDSTShifted;var a={};v(a,this);a=ra(a);if(a._a){var c=a._isUTC?g(a._a):pa(a._a);this._isDSTShifted=this.isValid()&&0<t(a._a,c.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var xa=B.prototype;xa.calendar=
function(a,c,d){a=this._calendar[a]||this._calendar.sameElse;return z(a)?a.call(c,d):a};xa.longDateFormat=function(a){var c=this._longDateFormat[a],d=this._longDateFormat[a.toUpperCase()];if(c||!d)return c;this._longDateFormat[a]=d.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)});return this._longDateFormat[a]};xa.invalidDate=function(){return this._invalidDate};xa.ordinal=function(a){return this._ordinal.replace("%d",a)};xa.preparse=qb;xa.postformat=qb;xa.relativeTime=function(a,c,d,b){var e=
this._relativeTime[d];return z(e)?e(a,c,d,b):e.replace(/%d/i,a)};xa.pastFuture=function(a,c){var d=this._relativeTime[0<a?"future":"past"];return z(d)?d(c):d.replace(/%s/i,c)};xa.set=function(a){var c,d;for(d in a)c=a[d],z(c)?this[d]=c:this["_"+d]=c;this._config=a;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)};xa.months=function(a,c){return a?f(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||Yb).test(c)?"format":"standalone"][a.month()]:
this._months};xa.monthsShort=function(a,c){return a?f(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[Yb.test(c)?"format":"standalone"][a.month()]:this._monthsShort};xa.monthsParse=function(a,c,d){var b,e;if(this._monthsParseExact){a:{a=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],b=0;12>b;++b)e=g([2E3,b]),this._shortMonthsParse[b]=this.monthsShort(e,"").toLocaleLowerCase(),this._longMonthsParse[b]=this.months(e,
"").toLocaleLowerCase();if(d)c="MMM"===c?Ha.call(this._shortMonthsParse,a):Ha.call(this._longMonthsParse,a);else if("MMM"===c){c=Ha.call(this._shortMonthsParse,a);if(-1!==c)break a;c=Ha.call(this._longMonthsParse,a)}else{c=Ha.call(this._longMonthsParse,a);if(-1!==c)break a;c=Ha.call(this._shortMonthsParse,a)}c=-1!==c?c:null}return c}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(b=0;12>b;b++)if(e=g([2E3,b]),d&&!this._longMonthsParse[b]&&(this._longMonthsParse[b]=
new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[b]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),d||this._monthsParse[b]||(e="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[b]=new RegExp(e.replace(".",""),"i")),d&&"MMMM"===c&&this._longMonthsParse[b].test(a)||d&&"MMM"===c&&this._shortMonthsParse[b].test(a)||!d&&this._monthsParse[b].test(a))return b};xa.monthsRegex=function(a){if(this._monthsParseExact)return r(this,"_monthsRegex")||
ua.call(this),a?this._monthsStrictRegex:this._monthsRegex;r(this,"_monthsRegex")||(this._monthsRegex=wb);return this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};xa.monthsShortRegex=function(a){if(this._monthsParseExact)return r(this,"_monthsRegex")||ua.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex;r(this,"_monthsShortRegex")||(this._monthsShortRegex=wb);return this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};xa.week=function(a){return ia(a,
this._week.dow,this._week.doy).week};xa.firstDayOfYear=function(){return this._week.doy};xa.firstDayOfWeek=function(){return this._week.dow};xa.weekdays=function(a,c){return a?f(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(c)?"format":"standalone"][a.day()]:this._weekdays};xa.weekdaysMin=function(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin};xa.weekdaysShort=function(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort};xa.weekdaysParse=function(a,
c,d){var b,e;if(this._weekdaysParseExact)return za.call(this,a,c,d);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(b=0;7>b;b++)if(e=g([2E3,1]).day(b),d&&!this._fullWeekdaysParse[b]&&(this._fullWeekdaysParse[b]=new RegExp("^"+this.weekdays(e,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[b]=new RegExp("^"+this.weekdaysShort(e,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[b]=new RegExp("^"+this.weekdaysMin(e,
"").replace(".",".?")+"$","i")),this._weekdaysParse[b]||(e="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[b]=new RegExp(e.replace(".",""),"i")),d&&"dddd"===c&&this._fullWeekdaysParse[b].test(a)||d&&"ddd"===c&&this._shortWeekdaysParse[b].test(a)||d&&"dd"===c&&this._minWeekdaysParse[b].test(a)||!d&&this._weekdaysParse[b].test(a))return b};xa.weekdaysRegex=function(a){if(this._weekdaysParseExact)return r(this,"_weekdaysRegex")||Ba.call(this),a?this._weekdaysStrictRegex:
this._weekdaysRegex;r(this,"_weekdaysRegex")||(this._weekdaysRegex=wb);return this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};xa.weekdaysShortRegex=function(a){if(this._weekdaysParseExact)return r(this,"_weekdaysRegex")||Ba.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;r(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=wb);return this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};xa.weekdaysMinRegex=function(a){if(this._weekdaysParseExact)return r(this,
"_weekdaysRegex")||Ba.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;r(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=wb);return this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};xa.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};xa.meridiem=function(a,c,d){return 11<a?d?"pm":"PM":d?"am":"AM"};La("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var c=a%10,c=1===w(a%100/10)?"th":1===c?"st":2===c?"nd":3===c?"rd":"th";
return a+c}});p.lang=A("moment.lang is deprecated. Use moment.locale instead.",La);p.langData=A("moment.langData is deprecated. Use moment.localeData instead.",Ga);var db=Math.abs,wc=Ra("ms"),xc=Ra("s"),yc=Ra("m"),zc=Ra("h"),Ac=Ra("d"),Bc=Ra("w"),Cc=Ra("M"),Dc=Ra("y"),Ec=Ya("milliseconds"),Fc=Ya("seconds"),Gc=Ya("minutes"),Hc=Ya("hours"),Ic=Ya("days"),Jc=Ya("months"),Kc=Ya("years"),gb=Math.round,hb={s:45,m:45,h:22,d:26,M:11},Rb=Math.abs,ta=Ta.prototype;ta.abs=function(){var a=this._data;this._milliseconds=
db(this._milliseconds);this._days=db(this._days);this._months=db(this._months);a.milliseconds=db(a.milliseconds);a.seconds=db(a.seconds);a.minutes=db(a.minutes);a.hours=db(a.hours);a.months=db(a.months);a.years=db(a.years);return this};ta.add=function(a,c){return Pa(this,a,c,1)};ta.subtract=function(a,c){return Pa(this,a,c,-1)};ta.as=function(a){var c,d=this._milliseconds;a=G(a);if("month"===a||"year"===a)return c=this._days+d/864E5,c=this._months+4800*c/146097,"month"===a?c:c/12;c=this._days+Math.round(146097*
this._months/4800);switch(a){case "week":return c/7+d/6048E5;case "day":return c+d/864E5;case "hour":return 24*c+d/36E5;case "minute":return 1440*c+d/6E4;case "second":return 86400*c+d/1E3;case "millisecond":return Math.floor(864E5*c)+d;default:throw Error("Unknown unit "+a);}};ta.asMilliseconds=wc;ta.asSeconds=xc;ta.asMinutes=yc;ta.asHours=zc;ta.asDays=Ac;ta.asWeeks=Bc;ta.asMonths=Cc;ta.asYears=Dc;ta.valueOf=function(){return this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*w(this._months/
12)};ta._bubble=function(){var a=this._milliseconds,c=this._days,b=this._months,e=this._data;0<=a&&0<=c&&0<=b||0>=a&&0>=c&&0>=b||(a+=864E5*tb(146097*b/4800+c),b=c=0);e.milliseconds=a%1E3;a=d(a/1E3);e.seconds=a%60;a=d(a/60);e.minutes=a%60;a=d(a/60);e.hours=a%24;c+=d(a/24);a=d(4800*c/146097);b+=a;c-=tb(146097*a/4800);a=d(b/12);e.days=c;e.months=b%12;e.years=a;return this};ta.get=function(a){a=G(a);return this[a+"s"]()};ta.milliseconds=Ec;ta.seconds=Fc;ta.minutes=Gc;ta.hours=Hc;ta.days=Ic;ta.weeks=function(){return d(this.days()/
7)};ta.months=Jc;ta.years=Kc;ta.humanize=function(a){var c=this.localeData(),d;d=!a;var b=X(this).abs(),e=gb(b.as("s")),k=gb(b.as("m")),t=gb(b.as("h")),g=gb(b.as("d")),q=gb(b.as("M")),b=gb(b.as("y")),e=e<hb.s&&["s",e]||1>=k&&["m"]||k<hb.m&&["mm",k]||1>=t&&["h"]||t<hb.h&&["hh",t]||1>=g&&["d"]||g<hb.d&&["dd",g]||1>=q&&["M"]||q<hb.M&&["MM",q]||1>=b&&["y"]||["yy",b];e[2]=d;e[3]=0<+this;e[4]=c;d=Bb.apply(null,e);a&&(d=c.pastFuture(+this,d));return c.postformat(d)};ta.toISOString=mb;ta.toString=mb;ta.toJSON=
mb;ta.locale=sb;ta.localeData=ub;ta.toIsoString=A("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",mb);ta.lang=$b;H("X",0,0,"unix");H("x",0,0,"valueOf");N("x",Db);N("X",/[+-]?\d+(\.\d{1,3})?/);D("X",function(a,c,d){d._d=new Date(1E3*parseFloat(a,10))});D("x",function(a,c,d){d._d=new Date(w(a))});p.version="2.17.1";Fb=pa;p.fn=U;p.min=function(){var a=[].slice.call(arguments,0);return ka("isBefore",a)};p.max=function(){var a=[].slice.call(arguments,0);return ka("isAfter",
a)};p.now=function(){return Date.now?Date.now():+new Date};p.utc=g;p.unix=function(a){return pa(1E3*a)};p.months=function(a,c){return jb(a,c,"months")};p.isDate=l;p.locale=La;p.invalid=a;p.duration=X;p.isMoment=k;p.weekdays=function(a,c,d){return eb(a,c,d,"weekdays")};p.parseZone=function(){return pa.apply(null,arguments).parseZone()};p.localeData=Ga;p.isDuration=R;p.monthsShort=function(a,c){return jb(a,c,"monthsShort")};p.weekdaysMin=function(a,c,d){return eb(a,c,d,"weekdaysMin")};p.defineLocale=
Ja;p.updateLocale=function(a,c){if(null!=c){var d;d=Xb;null!=Da[a]&&(d=Da[a]._config);c=C(d,c);d=new B(c);d.parentLocale=Da[a];Da[a]=d;La(a)}else null!=Da[a]&&(null!=Da[a].parentLocale?Da[a]=Da[a].parentLocale:null!=Da[a]&&delete Da[a]);return Da[a]};p.locales=function(){return cc(Da)};p.weekdaysShort=function(a,c,d){return eb(a,c,d,"weekdaysShort")};p.normalizeUnits=G;p.relativeTimeRounding=function(a){return void 0===a?gb:"function"===typeof a?(gb=a,!0):!1};p.relativeTimeThreshold=function(a,c){if(void 0===
hb[a])return!1;if(void 0===c)return hb[a];hb[a]=c;return!0};p.calendarFormat=function(a,c){var d=a.diff(c,"days",!0);return-6>d?"sameElse":-1>d?"lastWeek":0>d?"lastDay":1>d?"sameDay":2>d?"nextDay":7>d?"nextWeek":"sameElse"};p.prototype=U;return p})},"esri/arcade/ImmutableArray":function(){define(["require","exports"],function(p,f){return function(){function b(b){void 0===b&&(b=[]);this._elements=b}b.prototype.length=function(){return this._elements.length};b.prototype.get=function(b){return this._elements[b]};
b.prototype.toArray=function(){for(var b=[],f=0;f<this.length();f++)b.push(this.get(f));return b};return b}()})},"esri/arcade/ImmutablePointArray":function(){define("require exports ../core/tsSupport/extendsHelper ./ImmutableArray ../geometry/Point ../kernel".split(" "),function(p,f,b,m,l,h){var r=0===h.version.indexOf("4.");return function(f){function g(b,c,a,g,v,q){b=f.call(this,b)||this;b._lazyPt=[];b._hasZ=!1;b._hasM=!1;b._spRef=c;b._hasZ=a;b._hasM=g;b._cacheId=v;b._partId=q;return b}b(g,f);g.prototype.get=
function(b){if(void 0===this._lazyPt[b]){var c=this._elements[b];if(void 0===c)return;var a=this._hasZ,e=this._hasM,g=null,g=a&&!e?new l(c[0],c[1],c[2],void 0,this._spRef):e&&a?new l(c[0],c[1],void 0,c[2],this._spRef):a&&e?new l(c[0],c[1],c[2],c[3],this._spRef):new l(c[0],c[1],this._spRef);r?g.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+b.toString():g.setCacheValue("_arcadeCacheId",this._cacheId.toString()+"-"+this._partId.toString()+"-"+b.toString());this._lazyPt[b]=
g}return this._lazyPt[b]};g.prototype.equalityTest=function(b){return b===this?!0:null===b||!1===b instanceof g?!1:b.getUniqueHash()===this.getUniqueHash()};g.prototype.getUniqueHash=function(){return this._cacheId.toString()+"-"+this._partId.toString()};return g}(m)})},"esri/core/tsSupport/extendsHelper":function(){define([],function(){return function(p,f){function b(){this.constructor=p}for(var m in f)f.hasOwnProperty(m)&&(p[m]=f[m]);p.prototype=null===f?Object.create(f):(b.prototype=f.prototype,
new b)}})},"esri/arcade/ImmutablePathArray":function(){define(["require","exports","../core/tsSupport/extendsHelper","./ImmutableArray","./ImmutablePointArray"],function(p,f,b,m,l){return function(f){function h(b,g,e,c,a){b=f.call(this,b)||this;b._lazyPath=[];b._hasZ=!1;b._hasM=!1;b._hasZ=e;b._hasM=c;b._spRef=g;b._cacheId=a;return b}b(h,f);h.prototype.get=function(b){if(void 0===this._lazyPath[b]){var g=this._elements[b];if(void 0===g)return;this._lazyPath[b]=new l(g,this._spRef,this._hasZ,this._hasM,
this._cacheId,b)}return this._lazyPath[b]};h.prototype.equalityTest=function(b){return b===this?!0:null===b||!1===b instanceof h?!1:b.getUniqueHash()===this.getUniqueHash()};h.prototype.getUniqueHash=function(){return this._cacheId.toString()};return h}(m)})},"esri/arcade/FunctionWrapper":function(){define(["require","exports"],function(p,f){return function(){return function(b,f){this.context=this.definition=null;this.definition=b;this.context=f}}()})},"esri/geometry/ScreenPoint":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","./Point"],function(p,f,b,m,l){return p(l,{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/geometry/Rect":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(p,f,b,m,l,h,r,n,g,e){var c=p(r,{declaredClass:"esri.geometry.Rect",constructor:function(a,c,b,g,k){f.mixin(this,m.defaultRect);f.isObject(a)&&"extent"===a.type&&
(c=a.ymax,b=a.getWidth(),g=a.getHeight(),k=a.spatialReference,a=a.xmin);f.isObject(a)?(f.mixin(this,a),this.spatialReference&&(this.spatialReference=e.createSpatialReference(this.spatialReference))):(this.x=a,this.y=c,this.width=b,this.height=g,this.spatialReference=k);this.verifySR()},getCenter:function(){return new n(this.x+this.width/2,this.y+this.height/2,this.spatialReference)},offset:function(a,b){return new c(this.x+a,this.y+b,this.width,this.height,this.spatialReference)},intersects:function(a){return a.x+
a.width<=this.x||a.y+a.height<=this.y||a.y>=this.y+this.height||a.x>=this.x+this.width?!1:!0},getExtent:function(){return new g(parseFloat(this.x),parseFloat(this.y)-parseFloat(this.height),parseFloat(this.x)+parseFloat(this.width),parseFloat(this.y),this.spatialReference)},update:function(a,c,b,e,k){this.x=a;this.y=c;this.width=b;this.height=e;this.spatialReference=k;this.clearCache();return this}});return c})},"esri/geometry/scaleUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../config ../lang ../WKIDUnitConversion".split(" "),
function(p,f,b,m,l,h){var r=6370997*Math.PI/180,n=m.defaults,g={getUnitValueForSR:function(b){return this.getUnitValue(b)||r},getUnitValue:function(b){var c,a,e;b&&("object"===typeof b?(c=b.wkid,a=b.wkt):"number"===typeof b?c=b:"string"===typeof b&&(a=b));c?e=h.values[h[c]]:a&&-1!==a.search(/^PROJCS/i)&&(b=/UNIT\[([^\]]+)\]\]$/i.exec(a))&&b[1]&&(e=parseFloat(b[1].split(",")[1]));return e},getScale:function(b,c,a){var e,f,q;1<arguments.length&&l.isDefined(c)&&!c.declaredClass?(e=b,f=c,c=null,q=g.getUnitValue(a)):
(e=c||b.extent,f=b.width,q=g.getUnitValue(e&&e.spatialReference));return e&&f?e.getWidth()/f*(q||r)*39.37*n.screenDPI:0},getExtentForScale:function(b,c,a){a=a||b.extent;var e;e=g.getUnitValue(b.spatialReference);return a.expand(c*b.width/(39.37*(e||r)*n.screenDPI)/a.getWidth())}};return g})},"esri/WKIDUnitConversion":function(){define(["dojo/has","./kernel"],function(p,f){var b,m={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,
20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,
3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,
3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,
3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,
5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,
6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,
6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,
6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,
6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,
6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,
7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,
22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,
30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,53048:0,53049:0,54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,
102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,
103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,
103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,
103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(b=2E3;2045>=b;b++)m[b]=0;for(b=2056;2065>=b;b++)m[b]=0;for(b=2067;2135>=b;b++)m[b]=
0;for(b=2137;2154>=b;b++)m[b]=0;for(b=2161;2170>=b;b++)m[b]=0;for(b=2172;2193>=b;b++)m[b]=0;for(b=2195;2198>=b;b++)m[b]=0;for(b=2200;2203>=b;b++)m[b]=0;for(b=2205;2217>=b;b++)m[b]=0;for(b=2222;2224>=b;b++)m[b]=1;for(b=2225;2250>=b;b++)m[b]=2;for(b=2251;2253>=b;b++)m[b]=1;for(b=2257;2264>=b;b++)m[b]=2;for(b=2274;2279>=b;b++)m[b]=2;for(b=2280;2282>=b;b++)m[b]=1;for(b=2283;2289>=b;b++)m[b]=2;for(b=2290;2292>=b;b++)m[b]=0;for(b=2308;2313>=b;b++)m[b]=0;for(b=2315;2491>=b;b++)m[b]=0;for(b=2494;2866>=b;b++)m[b]=
0;for(b=2867;2869>=b;b++)m[b]=1;for(b=2870;2888>=b;b++)m[b]=2;for(b=2891;2895>=b;b++)m[b]=2;for(b=2896;2898>=b;b++)m[b]=1;for(b=2902;2908>=b;b++)m[b]=2;for(b=2915;2920>=b;b++)m[b]=2;for(b=2921;2923>=b;b++)m[b]=1;for(b=2924;2930>=b;b++)m[b]=2;for(b=2931;2962>=b;b++)m[b]=0;for(b=2964;2968>=b;b++)m[b]=2;for(b=2969;2973>=b;b++)m[b]=0;for(b=2975;2991>=b;b++)m[b]=0;for(b=2995;3051>=b;b++)m[b]=0;for(b=3054;3079>=b;b++)m[b]=0;for(b=3081;3088>=b;b++)m[b]=0;for(b=3092;3101>=b;b++)m[b]=0;for(b=3106;3138>=b;b++)m[b]=
0;for(b=3146;3151>=b;b++)m[b]=0;for(b=3153;3166>=b;b++)m[b]=0;for(b=3168;3172>=b;b++)m[b]=0;for(b=3174;3203>=b;b++)m[b]=0;for(b=3294;3358>=b;b++)m[b]=0;for(b=3367;3403>=b;b++)m[b]=0;for(b=3408;3416>=b;b++)m[b]=0;for(b=3417;3438>=b;b++)m[b]=2;for(b=3441;3446>=b;b++)m[b]=2;for(b=3447;3450>=b;b++)m[b]=0;for(b=3451;3459>=b;b++)m[b]=2;for(b=3460;3478>=b;b++)m[b]=0;for(b=3554;3559>=b;b++)m[b]=0;for(b=3560;3570>=b;b++)m[b]=2;for(b=3571;3581>=b;b++)m[b]=0;for(b=3594;3597>=b;b++)m[b]=0;for(b=3601;3604>=b;b++)m[b]=
0;for(b=3637;3639>=b;b++)m[b]=0;for(b=3665;3667>=b;b++)m[b]=0;for(b=3693;3695>=b;b++)m[b]=0;for(b=3701;3727>=b;b++)m[b]=0;for(b=3728;3739>=b;b++)m[b]=2;for(b=3740;3751>=b;b++)m[b]=0;for(b=3753;3760>=b;b++)m[b]=2;for(b=3761;3773>=b;b++)m[b]=0;for(b=3775;3777>=b;b++)m[b]=0;for(b=3779;3781>=b;b++)m[b]=0;for(b=3783;3785>=b;b++)m[b]=0;for(b=3788;3791>=b;b++)m[b]=0;for(b=3797;3802>=b;b++)m[b]=0;for(b=3814;3816>=b;b++)m[b]=0;for(b=3825;3829>=b;b++)m[b]=0;for(b=3832;3841>=b;b++)m[b]=0;for(b=3844;3852>=b;b++)m[b]=
0;for(b=3873;3885>=b;b++)m[b]=0;for(b=3890;3893>=b;b++)m[b]=0;for(b=3907;3912>=b;b++)m[b]=0;for(b=3942;3950>=b;b++)m[b]=0;for(b=3968;3970>=b;b++)m[b]=0;for(b=3973;3976>=b;b++)m[b]=0;for(b=3986;3989>=b;b++)m[b]=0;for(b=3994;3997>=b;b++)m[b]=0;for(b=4048;4051>=b;b++)m[b]=0;for(b=4056;4063>=b;b++)m[b]=0;for(b=4093;4096>=b;b++)m[b]=0;for(b=4390;4398>=b;b++)m[b]=0;for(b=4399;4413>=b;b++)m[b]=2;for(b=4418;4433>=b;b++)m[b]=2;for(b=4455;4457>=b;b++)m[b]=2;for(b=4484;4489>=b;b++)m[b]=0;for(b=4491;4554>=b;b++)m[b]=
0;for(b=4568;4589>=b;b++)m[b]=0;for(b=4652;4656>=b;b++)m[b]=0;for(b=4766;4800>=b;b++)m[b]=0;for(b=5014;5016>=b;b++)m[b]=0;for(b=5069;5072>=b;b++)m[b]=0;for(b=5105;5130>=b;b++)m[b]=0;for(b=5173;5188>=b;b++)m[b]=0;for(b=5253;5259>=b;b++)m[b]=0;for(b=5269;5275>=b;b++)m[b]=0;for(b=5292;5311>=b;b++)m[b]=0;for(b=5329;5331>=b;b++)m[b]=0;for(b=5343;5349>=b;b++)m[b]=0;for(b=5355;5357>=b;b++)m[b]=0;for(b=5387;5389>=b;b++)m[b]=0;for(b=5459;5463>=b;b++)m[b]=0;for(b=5479;5482>=b;b++)m[b]=0;for(b=5518;5520>=b;b++)m[b]=
0;for(b=5530;5539>=b;b++)m[b]=0;for(b=5550;5552>=b;b++)m[b]=0;for(b=5562;5583>=b;b++)m[b]=0;for(b=5623;5625>=b;b++)m[b]=2;for(b=5631;5639>=b;b++)m[b]=0;for(b=5649;5653>=b;b++)m[b]=0;for(b=5663;5680>=b;b++)m[b]=0;for(b=5682;5685>=b;b++)m[b]=0;for(b=5875;5877>=b;b++)m[b]=0;for(b=5921;5940>=b;b++)m[b]=0;for(b=6050;6125>=b;b++)m[b]=0;for(b=6244;6275>=b;b++)m[b]=0;for(b=6328;6348>=b;b++)m[b]=0;for(b=6350;6356>=b;b++)m[b]=0;for(b=6366;6372>=b;b++)m[b]=0;for(b=6381;6387>=b;b++)m[b]=0;for(b=6393;6404>=b;b++)m[b]=
0;for(b=6480;6483>=b;b++)m[b]=0;for(b=6511;6514>=b;b++)m[b]=0;for(b=6579;6581>=b;b++)m[b]=0;for(b=6619;6624>=b;b++)m[b]=0;for(b=6625;6627>=b;b++)m[b]=2;for(b=6628;6632>=b;b++)m[b]=0;for(b=6634;6637>=b;b++)m[b]=0;for(b=6669;6692>=b;b++)m[b]=0;for(b=6707;6709>=b;b++)m[b]=0;for(b=6720;6723>=b;b++)m[b]=0;for(b=6732;6738>=b;b++)m[b]=0;for(b=6931;6933>=b;b++)m[b]=0;for(b=6956;6959>=b;b++)m[b]=0;for(b=7005;7007>=b;b++)m[b]=0;for(b=7057;7070>=b;b++)m[b]=2;for(b=7074;7082>=b;b++)m[b]=0;for(b=7109;7118>=b;b++)m[b]=
0;for(b=7119;7127>=b;b++)m[b]=1;for(b=7374;7376>=b;b++)m[b]=0;for(b=7528;7586>=b;b++)m[b]=0;for(b=7587;7645>=b;b++)m[b]=2;for(b=7845;7859>=b;b++)m[b]=0;for(b=20002;20032>=b;b++)m[b]=0;for(b=20062;20092>=b;b++)m[b]=0;for(b=20135;20138>=b;b++)m[b]=0;for(b=20248;20258>=b;b++)m[b]=0;for(b=20348;20358>=b;b++)m[b]=0;for(b=20436;20440>=b;b++)m[b]=0;for(b=20822;20824>=b;b++)m[b]=0;for(b=20934;20936>=b;b++)m[b]=0;for(b=21035;21037>=b;b++)m[b]=0;for(b=21095;21097>=b;b++)m[b]=0;for(b=21148;21150>=b;b++)m[b]=
0;for(b=21413;21423>=b;b++)m[b]=0;for(b=21473;21483>=b;b++)m[b]=0;for(b=21780;21782>=b;b++)m[b]=0;for(b=21891;21894>=b;b++)m[b]=0;for(b=21896;21899>=b;b++)m[b]=0;for(b=22171;22177>=b;b++)m[b]=0;for(b=22181;22187>=b;b++)m[b]=0;for(b=22191;22197>=b;b++)m[b]=0;for(b=22234;22236>=b;b++)m[b]=0;for(b=22521;22525>=b;b++)m[b]=0;for(b=22991;22994>=b;b++)m[b]=0;for(b=23028;23038>=b;b++)m[b]=0;for(b=23830;23853>=b;b++)m[b]=0;for(b=23866;23872>=b;b++)m[b]=0;for(b=23877;23884>=b;b++)m[b]=0;for(b=23886;23894>=
b;b++)m[b]=0;for(b=23946;23948>=b;b++)m[b]=0;for(b=24311;24313>=b;b++)m[b]=0;for(b=24342;24347>=b;b++)m[b]=0;for(b=24370;24374>=b;b++)m[b]=10;for(b=24375;24381>=b;b++)m[b]=0;for(b=24718;24721>=b;b++)m[b]=0;for(b=24817;24821>=b;b++)m[b]=0;for(b=24877;24882>=b;b++)m[b]=0;for(b=24891;24893>=b;b++)m[b]=0;for(b=25391;25395>=b;b++)m[b]=0;for(b=25828;25838>=b;b++)m[b]=0;for(b=26191;26195>=b;b++)m[b]=0;for(b=26391;26393>=b;b++)m[b]=0;for(b=26701;26722>=b;b++)m[b]=0;for(b=26729;26799>=b;b++)m[b]=2;for(b=26801;26803>=
b;b++)m[b]=2;for(b=26811;26813>=b;b++)m[b]=2;for(b=26847;26870>=b;b++)m[b]=2;for(b=26891;26899>=b;b++)m[b]=0;for(b=26901;26923>=b;b++)m[b]=0;for(b=26929;26946>=b;b++)m[b]=0;for(b=26948;26998>=b;b++)m[b]=0;for(b=27037;27040>=b;b++)m[b]=0;for(b=27205;27232>=b;b++)m[b]=0;for(b=27258;27260>=b;b++)m[b]=0;for(b=27391;27398>=b;b++)m[b]=0;for(b=27561;27564>=b;b++)m[b]=0;for(b=27571;27574>=b;b++)m[b]=0;for(b=27581;27584>=b;b++)m[b]=0;for(b=27591;27594>=b;b++)m[b]=0;for(b=28191;28193>=b;b++)m[b]=0;for(b=28348;28358>=
b;b++)m[b]=0;for(b=28402;28432>=b;b++)m[b]=0;for(b=28462;28492>=b;b++)m[b]=0;for(b=29118;29122>=b;b++)m[b]=0;for(b=29168;29172>=b;b++)m[b]=0;for(b=29177;29185>=b;b++)m[b]=0;for(b=29187;29195>=b;b++)m[b]=0;for(b=29900;29903>=b;b++)m[b]=0;for(b=30161;30179>=b;b++)m[b]=0;for(b=30491;30494>=b;b++)m[b]=0;for(b=30729;30732>=b;b++)m[b]=0;for(b=31251;31259>=b;b++)m[b]=0;for(b=31265;31268>=b;b++)m[b]=0;for(b=31275;31279>=b;b++)m[b]=0;for(b=31281;31297>=b;b++)m[b]=0;for(b=31461;31469>=b;b++)m[b]=0;for(b=31491;31495>=
b;b++)m[b]=0;for(b=31917;31922>=b;b++)m[b]=0;for(b=31965;32E3>=b;b++)m[b]=0;for(b=32001;32003>=b;b++)m[b]=2;for(b=32005;32031>=b;b++)m[b]=2;for(b=32033;32060>=b;b++)m[b]=2;for(b=32064;32067>=b;b++)m[b]=2;for(b=32074;32077>=b;b++)m[b]=2;for(b=32081;32086>=b;b++)m[b]=0;for(b=32107;32130>=b;b++)m[b]=0;for(b=32133;32158>=b;b++)m[b]=0;for(b=32164;32167>=b;b++)m[b]=2;for(b=32180;32199>=b;b++)m[b]=0;for(b=32201;32260>=b;b++)m[b]=0;for(b=32301;32360>=b;b++)m[b]=0;for(b=32601;32662>=b;b++)m[b]=0;for(b=32664;32667>=
b;b++)m[b]=2;for(b=32701;32761>=b;b++)m[b]=0;for(b=53001;53004>=b;b++)m[b]=0;for(b=53008;53019>=b;b++)m[b]=0;for(b=53021;53032>=b;b++)m[b]=0;for(b=53042;53046>=b;b++)m[b]=0;for(b=53074;53080>=b;b++)m[b]=0;for(b=54001;54004>=b;b++)m[b]=0;for(b=54008;54019>=b;b++)m[b]=0;for(b=54021;54032>=b;b++)m[b]=0;for(b=54042;54046>=b;b++)m[b]=0;for(b=54048;54053>=b;b++)m[b]=0;for(b=54074;54080>=b;b++)m[b]=0;for(b=102001;102040>=b;b++)m[b]=0;for(b=102042;102063>=b;b++)m[b]=0;for(b=102065;102067>=b;b++)m[b]=0;for(b=
102070;102117>=b;b++)m[b]=0;for(b=102122;102216>=b;b++)m[b]=0;for(b=102221;102377>=b;b++)m[b]=0;for(b=102382;102388>=b;b++)m[b]=0;for(b=102389;102398>=b;b++)m[b]=2;for(b=102399;102444>=b;b++)m[b]=0;for(b=102445;102447>=b;b++)m[b]=2;for(b=102448;102458>=b;b++)m[b]=0;for(b=102459;102468>=b;b++)m[b]=2;for(b=102469;102496>=b;b++)m[b]=0;for(b=102500;102519>=b;b++)m[b]=1;for(b=102520;102524>=b;b++)m[b]=0;for(b=102525;102529>=b;b++)m[b]=2;for(b=102530;102561>=b;b++)m[b]=0;for(b=102570;102588>=b;b++)m[b]=
0;for(b=102590;102598>=b;b++)m[b]=0;for(b=102601;102603>=b;b++)m[b]=0;for(b=102605;102628>=b;b++)m[b]=0;for(b=102629;102646>=b;b++)m[b]=2;for(b=102648;102700>=b;b++)m[b]=2;for(b=102701;102703>=b;b++)m[b]=0;for(b=102707;102730>=b;b++)m[b]=2;for(b=102733;102758>=b;b++)m[b]=2;for(b=102767;102798>=b;b++)m[b]=0;for(b=102965;102969>=b;b++)m[b]=0;for(b=102971;102973>=b;b++)m[b]=0;for(b=102975;102989>=b;b++)m[b]=0;for(b=102990;102992>=b;b++)m[b]=1;for(b=102997;103002>=b;b++)m[b]=0;for(b=103003;103008>=b;b++)m[b]=
2;for(b=103009;103011>=b;b++)m[b]=0;for(b=103012;103014>=b;b++)m[b]=2;for(b=103019;103021>=b;b++)m[b]=0;for(b=103022;103024>=b;b++)m[b]=2;for(b=103029;103031>=b;b++)m[b]=0;for(b=103032;103034>=b;b++)m[b]=2;for(b=103065;103068>=b;b++)m[b]=0;for(b=103074;103076>=b;b++)m[b]=0;for(b=103077;103079>=b;b++)m[b]=1;for(b=103080;103082>=b;b++)m[b]=0;for(b=103083;103085>=b;b++)m[b]=2;for(b=103090;103093>=b;b++)m[b]=0;for(b=103097;103099>=b;b++)m[b]=0;for(b=103100;103102>=b;b++)m[b]=2;for(b=103107;103109>=b;b++)m[b]=
0;for(b=103110;103112>=b;b++)m[b]=2;for(b=103113;103116>=b;b++)m[b]=0;for(b=103117;103120>=b;b++)m[b]=2;for(b=103153;103157>=b;b++)m[b]=0;for(b=103158;103162>=b;b++)m[b]=2;for(b=103163;103165>=b;b++)m[b]=0;for(b=103166;103168>=b;b++)m[b]=1;for(b=103169;103171>=b;b++)m[b]=2;for(b=103186;103188>=b;b++)m[b]=0;for(b=103189;103191>=b;b++)m[b]=2;for(b=103192;103195>=b;b++)m[b]=0;for(b=103196;103199>=b;b++)m[b]=2;for(b=103200;103224>=b;b++)m[b]=0;for(b=103225;103227>=b;b++)m[b]=1;for(b=103232;103237>=b;b++)m[b]=
0;for(b=103238;103243>=b;b++)m[b]=2;for(b=103244;103246>=b;b++)m[b]=0;for(b=103247;103249>=b;b++)m[b]=2;for(b=103254;103256>=b;b++)m[b]=0;for(b=103257;103259>=b;b++)m[b]=2;for(b=103264;103266>=b;b++)m[b]=0;for(b=103267;103269>=b;b++)m[b]=2;for(b=103300;103375>=b;b++)m[b]=0;for(b=103381;103383>=b;b++)m[b]=0;for(b=103384;103386>=b;b++)m[b]=1;for(b=103387;103389>=b;b++)m[b]=0;for(b=103390;103392>=b;b++)m[b]=2;for(b=103397;103399>=b;b++)m[b]=0;for(b=103400;103471>=b;b++)m[b]=2;for(b=103476;103478>=b;b++)m[b]=
0;for(b=103479;103481>=b;b++)m[b]=2;for(b=103486;103488>=b;b++)m[b]=0;for(b=103489;103491>=b;b++)m[b]=2;for(b=103492;103495>=b;b++)m[b]=0;for(b=103496;103499>=b;b++)m[b]=2;for(b=103528;103543>=b;b++)m[b]=0;for(b=103544;103548>=b;b++)m[b]=2;for(b=103549;103551>=b;b++)m[b]=0;for(b=103552;103554>=b;b++)m[b]=1;for(b=103555;103557>=b;b++)m[b]=2;for(b=103558;103560>=b;b++)m[b]=0;for(b=103571;103573>=b;b++)m[b]=0;for(b=103574;103576>=b;b++)m[b]=2;for(b=103577;103580>=b;b++)m[b]=0;for(b=103581;103583>=b;b++)m[b]=
2;for(b=103600;103694>=b;b++)m[b]=0;for(b=103700;103793>=b;b++)m[b]=2;for(b=103794;103871>=b;b++)m[b]=0;for(b=103900;103971>=b;b++)m[b]=2;return m})},"esri/geometry/screenUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/sniff ../kernel ./Point ./ScreenPoint ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(p,f,b,m,l,h,r,n,g,e){var c=function(){return 9>b("ie")?function(a,c,b,e,k,d,g,t,f){var q=[],u=Math.round,w,v=g.length,h,x,n,l,r,m;for(w=0;w<v;w++)if(h=g[w],l=t?t(h[0][0],
h[0][1],f):h[0],1<(n=h.length))for(r=u((l[0]-a)*b+k),m=u((c-l[1])*e+d),l=t?t(h[1][0],h[1][1],f):h[1],x=u((l[0]-a)*b+k),l=u((c-l[1])*e+d),q.push("M",r+","+m,"L",x+","+l),x=2;x<n;x++)l=t?t(h[x][0],h[x][1],f):h[x],r=u((l[0]-a)*b+k),m=u((c-l[1])*e+d),q.push(r+","+m);else r=u((l[0]-a)*b+k),m=u((c-l[1])*e+d),q.push("M",r+","+m);return q}:function(a,c,b,e,k,d,g,t,f,h){var q=[],u,w,v,x,n,l,r=Math.round;u=0;for(v=g?g.length:0;u<v;u++){n=g[u];q.push("M");w=0;for(x=n?n.length:0;w<x;w++)l=t?t(n[w][0],n[w][1],
f):n[w],q.push(r((l[0]-a)*b+k)+","+r((c-l[1])*e+d));h||q.push("Z")}return q}}();return{toScreenPoint:function(a,c,b,e,k){var d=a.spatialReference,g=e.spatialReference,t=e.x;e=e.y;d&&g&&!d.equals(g)&&d._canProject(g)&&(d=d.isWebMercator()?l.lngLatToXY(t,e):l.xyToLngLat(t,e,!0),t=d[0],e=d[1]);t=(t-a.xmin)*(c/a.getWidth());e=(a.ymax-e)*(b/a.getHeight());k||(t=Math.round(t),e=Math.round(e));return new h(t,e)},toScreenGeometry:function(a,c,b,q){var k=a.xmin,d=a.ymax,f=c/a.getWidth(),t=b/a.getHeight(),
u=p.forEach,v=Math.round;if(q instanceof l)return new l(v((q.x-k)*f),v((d-q.y)*t));if(q instanceof g){a=new g;var h=a.points;u(q.points,function(a,c){h[c]=[v((a[0]-k)*f),v((d-a[1])*t)]});return a}if(q instanceof e)return new e(v((q.xmin-k)*f),v((d-q.ymin)*t),v((q.xmax-k)*f),v((d-q.ymax)*f));if(q instanceof r){a=new r;var m=a.paths,C;u(q.paths,function(a,c){C=m[c]=[];u(a,function(a,c){C[c]=[v((a[0]-k)*f),v((d-a[1])*t)]})});return a}if(q instanceof n){a=new n;var B=a.rings,E;u(q.rings,function(a,c){E=
B[c]=[];u(a,function(a,c){E[c]=[v((a[0]-k)*f),v((d-a[1])*t)]})});return a}},_toScreenPath:function(a,b,e,g,k,d){var q=g instanceof r,t=a.spatialReference,f=g.spatialReference,u,v;t&&f&&!t.equals(f)&&t._canProject(f)&&(t.isWebMercator()?u=l.lngLatToXY:(u=l.xyToLngLat,v=!0));return c(a.xmin,a.ymax,b/a.getWidth(),e/a.getHeight(),k,d,q?g.paths:g.rings,u,v,q)},toMapPoint:function(a,c,b,e){return new l(a.xmin+e.x/(c/a.getWidth()),a.ymax-e.y/(b/a.getHeight()),a.spatialReference)},toMapGeometry:function(a,
c,b,q){var k=a.xmin,d=a.ymax,f=a.spatialReference,t=c/a.getWidth(),u=b/a.getHeight(),v=p.forEach;if(q instanceof l)return new l(k+q.x/t,d-q.y/u,f);if(q instanceof g){a=new g(f);var h=a.points;v(q.points,function(a,c){h[c]=[k+a[0]/t,d-a[1]/u]});return a}if(q instanceof e)return new e(k+q.xmin/t,d-q.ymin/u,k+q.xmax/t,d-q.ymax/u,f);if(q instanceof r){a=new r(f);var m=a.paths,C;v(q.paths,function(a,c){C=m[c]=[];v(a,function(a,c){C[c]=[k+a[0]/t,d-a[1]/u]})});return a}if(q instanceof n){a=new n(f);var B=
a.rings,E;v(q.rings,function(a,c){E=B[c]=[];v(a,function(a,c){E[c]=[k+a[0]/t,d-a[1]/u]})});return a}}}})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){var a={type:"polyline",paths:null};p=p(n,{declaredClass:"esri.geometry.Polyline",constructor:function(e){b.mixin(this,a);this.paths=[];this._path=0;e&&(b.isArray(e)?this.paths=
b.isArray(e[0][0])?e:[e]:e.paths?b.mixin(this,e):this.spatialReference=e,this.spatialReference&&(this.spatialReference=c.createSpatialReference(this.spatialReference)));this.verifySR()},addPath:function(a){this.clearCache();this._path=this.paths.length;this.paths[this._path]=[];b.isArray(a[0])?f.forEach(a,this._addPointArr,this):f.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.paths[this._path].push(a)},_addPoint:function(a){this.paths[this._path].push([a.x,a.y])},_insertPoints:function(a,
c){this.clearCache();this._path=c;this.paths[this._path]||(this.paths[this._path]=[]);f.forEach(a,this._addPoint,this)},_validateInputs:function(a,c){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)||null!==c&&void 0!==a&&(0>c||c>=this.paths[a].length)?!1:!0},getPoint:function(a,c){if(this._validateInputs(a,c))return new g(this.paths[a][c],this.spatialReference)},setPoint:function(a,c,b){if(this._validateInputs(a,c))return this.clearCache(),this.paths[a][c]=[b.x,b.y],this},insertPoint:function(a,
c,b){if(this._validateInputs(a)&&h.isDefined(c)&&0<=c&&c<=this.paths[a].length)return this.clearCache(),this.paths[a].splice(c,0,[b.x,b.y]),this},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.paths.splice(a,1)[0];var c,b=a.length,e=this.spatialReference;for(c=0;c<b;c++)a[c]=new g(a[c],e);return a}},removePoint:function(a,c){if(this._validateInputs(a,c))return this.clearCache(),new g(this.paths[a].splice(c,1)[0],this.spatialReference)},getExtent:function(){var a;
a=this.getCacheValue("_extent");var c=this.getCacheValue("_partwise");if(a)return a=new e(a),a._partwise=c,a;a=this.paths;var b=a.length;if(b&&a[0].length){var k,d,g,t,f,h,n,l,r=t=a[0][0][0],m=f=a[0][0][1],p=Math.min,G=Math.max,I=this.spatialReference,c=[],J,L,P,Q;for(h=0;h<b;h++){k=a[h];J=L=k[0]&&k[0][0];P=Q=k[0]&&k[0][1];l=k.length;for(n=0;n<l;n++)d=k[n],g=d[0],d=d[1],r=p(r,g),m=p(m,d),t=G(t,g),f=G(f,d),J=p(J,g),P=p(P,d),L=G(L,g),Q=G(Q,d);c.push(new e({xmin:J,ymin:P,xmax:L,ymax:Q,spatialReference:I?
I.toJson():null}))}a={xmin:r,ymin:m,xmax:t,ymax:f,spatialReference:I?I.toJson():null};c=1<c.length?c:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",c);a=new e(a);a._partwise=c;return a}},toJson:function(){var a={paths:b.clone(this.paths)},c=this.spatialReference;c&&(a.spatialReference=c.toJson());return a}});p.defaultProps=a;return p})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){var u={type:"polygon",rings:null},v=p(n,{declaredClass:"esri.geometry.Polygon",constructor:function(c){b.mixin(this,u);this.rings=[];this._ring=0;c&&(b.isArray(c)?this.rings=b.isArray(c[0][0])?c:[c]:c.rings?b.mixin(this,c):this.spatialReference=c,this.spatialReference&&(this.spatialReference=a.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(a){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=[];b.isArray(a[0])?
f.forEach(a,this._addPointArr,this):f.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,a.y])},_insertPoints:function(a,c){this.clearCache();this._ring=c;this.rings[this._ring]||(this.rings[this._ring]=[]);f.forEach(a,this._addPoint,this)},_validateInputs:function(a,c){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)||null!==c&&void 0!==a&&(0>c||c>=this.rings[a].length)?!1:!0},getPoint:function(a,
c){if(this._validateInputs(a,c))return new g(this.rings[a][c],this.spatialReference)},setPoint:function(a,c,d){if(this._validateInputs(a,c))return this.clearCache(),this.rings[a][c]=[d.x,d.y],this},insertPoint:function(a,c,d){if(this._validateInputs(a)&&h.isDefined(c)&&0<=c&&c<=this.rings[a].length)return this.clearCache(),this.rings[a].splice(c,0,[d.x,d.y]),this},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.rings.splice(a,1)[0];var c,d=a.length,b=this.spatialReference;
for(c=0;c<d;c++)a[c]=new g(a[c],b);return a}},removePoint:function(a,c){if(this._validateInputs(a,c))return this.clearCache(),new g(this.rings[a].splice(c,1)[0],this.spatialReference)},getExtent:function(){var a;a=this.getCacheValue("_extent");var c=this.getCacheValue("_partwise");if(a)return a=new e(a),a._partwise=c,a;a=this.rings;var d=a.length;if(d&&a[0].length){var b,t,g,f,u,v,h,n,l=f=a[0][0][0],r=u=a[0][0][1],m=Math.min,p=Math.max,L=this.spatialReference,c=[],P,Q,H,K;for(v=0;v<d;v++){b=a[v];
P=Q=b[0]&&b[0][0];H=K=b[0]&&b[0][1];n=b.length;for(h=0;h<n;h++)t=b[h],g=t[0],t=t[1],l=m(l,g),r=m(r,t),f=p(f,g),u=p(u,t),P=m(P,g),H=m(H,t),Q=p(Q,g),K=p(K,t);c.push(new e({xmin:P,ymin:H,xmax:Q,ymax:K,spatialReference:L?L.toJson():null}))}a={xmin:l,ymin:r,xmax:f,ymax:u,spatialReference:L?L.toJson():null};c=1<c.length?c:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",c);a=new e(a);a._partwise=c;return a}},contains:function(a){var c=this.rings,d,b=!1,e,q,f,u,v,h,n=c.length;d=this.spatialReference;
e=a.spatialReference;var l=a.x;a=a.y;d&&e&&!d.equals(e)&&d._canProject(e)&&(a=d.isWebMercator()?g.lngLatToXY(l,a):g.xyToLngLat(l,a,!0),l=a[0],a=a[1]);for(h=0;h<n;h++)for(d=c[h],f=d.length,v=u=0;v<f;v++)u++,u===f&&(u=0),e=d[v],q=d[u],(e[1]<a&&q[1]>=a||q[1]<a&&e[1]>=a)&&e[0]+(a-e[1])/(q[1]-e[1])*(q[0]-e[0])<l&&(b=!b);return b},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;var a=this.rings,c,d,b,e,u=[],v,h,n=Infinity,l=-Infinity,r=Infinity,m=-Infinity;f.forEach(a,
function(a){c=d=b=0;f.forEach(a,function(e,k){k<a.length-1&&(v=a[k+1],h=e[0]*v[1]-v[0]*e[1],c+=(e[0]+v[0])*h,d+=(e[1]+v[1])*h,b+=h,e[0]<n&&(n=e[0]),e[0]>l&&(l=e[0]),e[1]<r&&(r=e[1]),e[1]>m&&(m=e[1]))});0<b&&(b*=-1);b&&u.push([c,d,b/2])});u.sort(function(a,c){return a[2]-c[2]});c=d=void 0;u[0]&&(e=6*u[0][2],c=u[0][0]/e,d=u[0][1]/e,c<n||c>l||d<r||d>m)&&(c=d=void 0);if(void 0===c||void 0===d)if(a=a[0]&&a[0].length?this._getLineCentroid(a[0]):null)c=a.x,d=a.y;a=isNaN(c)||isNaN(d)?null:new g(c,d,this.spatialReference);
this.setCacheValue("_centroid",a);return a},_getLineCentroid:function(a){var b,d=0,e=0,g=0,f,q,u={x:0,y:0},v={x:0,y:0},h,n=a.length,l;for(h=0;h<n-1;h++)f=a[h],q=a[h+1],f&&q&&(u.x=f[0],u.y=f[1],v.x=q[0],v.y=q[1],b=c.getLength(u,v),0<b&&(d+=b,f=c.getMidpoint(f,q),e+=b*f[0],g+=b*f[1]));0<d?l={x:e/d,y:g/d}:a[0]&&(l={x:a[0][0],y:a[0][1]});return l},isClockwise:function(a){var c=0,d,e=a.length,g=b.isArray(a[0])?function(a,c){return a[0]*c[1]-c[0]*a[1]}:function(a,c){return a.x*c.y-c.x*a.y};for(d=0;d<e;d++)c+=
g(a[d],a[(d+1)%e]);return 0>=c/2},isSelfIntersecting:function(a){a=a||this;var b,d,e,g,f,q,u,v=a.rings.length,h;for(e=0;e<v;e++){for(b=0;b<a.rings[e].length-1;b++)for(f=[[a.rings[e][b][0],a.rings[e][b][1]],[a.rings[e][b+1][0],a.rings[e][b+1][1]]],d=e+1;d<v;d++)for(g=0;g<a.rings[d].length-1;g++)if(q=[[a.rings[d][g][0],a.rings[d][g][1]],[a.rings[d][g+1][0],a.rings[d][g+1][1]]],(u=c._getLineIntersection2(f,q))&&!(u[0]===f[0][0]&&u[1]===f[0][1]||u[0]===q[0][0]&&u[1]===q[0][1]||u[0]===f[1][0]&&u[1]===
f[1][1]||u[0]===q[1][0]&&u[1]===q[1][1]))return!0;g=a.rings[e].length;if(!(4>=g))for(b=0;b<g-3;b++)for(h=g-1,0===b&&(h=g-2),f=[[a.rings[e][b][0],a.rings[e][b][1]],[a.rings[e][b+1][0],a.rings[e][b+1][1]]],d=b+2;d<h;d++)if(q=[[a.rings[e][d][0],a.rings[e][d][1]],[a.rings[e][d+1][0],a.rings[e][d+1][1]]],(u=c._getLineIntersection2(f,q))&&!(u[0]===f[0][0]&&u[1]===f[0][1]||u[0]===q[0][0]&&u[1]===q[0][1]||u[0]===f[1][0]&&u[1]===f[1][1]||u[0]===q[1][0]&&u[1]===q[1][1]))return!0}return!1},toJson:function(){var a=
{rings:b.clone(this.rings)},c=this.spatialReference;c&&(a.spatialReference=c.toJson());return a}});v.defaultProps=u;v.createEllipse=function(a){var c=a.center.x,d=a.center.y,b=a.longAxis,e=a.shortAxis,g=a.numberOfPoints,f=a.map,q,u,h;a=[];var n=2*Math.PI/g;for(u=0;u<g;u++)q=Math.cos(u*n),h=Math.sin(u*n),q=f.toMap({x:b*q+c,y:e*h+d}),a.push(q);a.push(a[0]);c=new v(f.spatialReference);c.addRing(a);return c};v.createCircle=function(a){return v.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,
numberOfPoints:a.numberOfPoints,map:a.map})};v.fromExtent=function(a){var c=a.normalize();a=a.spatialReference;return new v({rings:f.map(c,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:a?a.toJson():null})};return v})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(p,f,b,m,l,h,r,n,g){var e={type:"multipoint",
points:null};p=p(h,{declaredClass:"esri.geometry.Multipoint",constructor:function(c){f.mixin(this,e);this.points=[];c&&(c.points?f.mixin(this,c):this.spatialReference=c,this.spatialReference&&(this.spatialReference=g.createSpatialReference(this.spatialReference)));this.verifySR()},addPoint:function(c){this.clearCache();f.isArray(c)?this.points.push(c):this.points.push([c.x,c.y]);return this},removePoint:function(c){if(this._validateInputs(c))return this.clearCache(),new r(this.points.splice(c,1)[0],
this.spatialReference)},getExtent:function(){var c=this.getCacheValue("_extent");if(c)return new n(c);var c=this.points,a=c.length;if(a){var b=c[0],e,g,k=e=b[0],d=g=b[1],f=Math.min,t=Math.max,h=this.spatialReference,l,r;for(r=0;r<a;r++)b=c[r],l=b[0],b=b[1],k=f(k,l),d=f(d,b),e=t(e,l),g=t(g,b);c={xmin:k,ymin:d,xmax:e,ymax:g,spatialReference:h?h.toJson():null};this.setCacheValue("_extent",c);return new n(c)}},_validateInputs:function(c){return null===c||0>c||c>=this.points.length?!1:!0},getPoint:function(c){if(this._validateInputs(c))return c=
this.points[c],new r(c[0],c[1],this.spatialReference)},setPoint:function(c,a){if(this._validateInputs(c))return this.clearCache(),this.points[c]=[a.x,a.y],this},toJson:function(){var c={points:f.clone(this.points)},a=this.spatialReference;a&&(c.spatialReference=a.toJson());return c}});p.defaultProps=e;return p})},"esri/layers/GraphicsLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom dojox/gfx dojox/gfx/matrix ./gfxSniff!esri-svg?dojox/gfx/filters ./layer ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget ./gfxSniff!esri-svg?dojox/gfx/svgext".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B){var E,G=-1!==g.renderer.toLowerCase().indexOf("svg"),I=-1!==g.renderer.toLowerCase().indexOf("canvas"),J=9>q("ie"),L=q("esri-touch");w=p(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(a,c){var d,b=this._connects=[];this._map=a;this._useWillChange="css-transforms"===a.navigationMode&&G&&q("esri-will-change");I?(d=h.create("div",{style:"overflow: visible; position: absolute;"},c),this._surface={getEventSource:function(){return d}},
b.push(f.connect(d,"onmousedown",this,this._canvasDownHandler)),b.push(f.connect(d,"onmouseup",this,this._canvasUpHandler)),b.push(f.connect(d,"onclick",this,this._canvasClickHandler)),E.prototype._canvas=!0):(d=(this._surface=g.createSurface(c,a.width,a.height)).getEventSource(),this._useWillChange&&r.set(d,"will-change","transform"),r.set(d=J?d.parentNode:d,{overflow:"visible",position:"absolute"}));b.push(f.connect(a,"onResize",this,"_onResizeHandler"));this._useWillChange&&(b.push(f.connect(a,
"onPan",this,"_onPanHandler")),b.push(f.connect(a,"onPanEnd",this,"_onPanEndHandler")),b.push(f.connect(a,"onExtentChange",this,"_onExtentChangeHandler")));return d},_onPanHandler:function(a,c){var d=this._map.__visibleRect,b=d.x+c.x,d=d.y+c.y;this._panDx=b;this._panDy=d;r.set(this._surface.getEventSource(),u._css.names.transform,u._css.translate(b,d))},_onPanEndHandler:function(a,c){var d=this._map.__visibleRect,b=d.x,d=d.y;this._panDx=b;this._panDy=d;r.set(this._surface.getEventSource(),u._css.names.transform,
u._css.translate(b,d))},_onExtentChangeHandler:function(a,c,d,b){d&&(this._panDy=this._panDx=0,r.set(this._surface.getEventSource(),u._css.names.transform,u._css.translate(0,0)))},_getTransform:function(){return{dx:this._panDx||0,dy:this._panDy||0}},_onResizeHandler:function(a,c,d){a=this._surface.getEventSource();var b=this._map,e;J&&r.set(a=a.parentNode,{width:c+"px",height:d+"px",clip:"rect(0px "+c+"px "+d+"px 0px)"});l.set(a,"width",c);l.set(a,"height",d);this._surface.declaredClass||m.forEach(a.childNodes,
function(a){l.set(a,"width",c);l.set(a,"height",d)});b.loaded&&(b.graphics.suspended||(b.graphics._resized=!0),m.forEach(b.graphicsLayerIds,function(a){e=b.getLayer(a);e.suspended||(e._resized=!0,e._childLayer&&(e._childLayer._resized=!0));e._updateSVGFilters(null,null,c,d)}))},_cleanUp:function(){m.forEach(this._connects,f.disconnect,f);this._map=this._surface=null},_processEvent:function(a){var c=this._map;a.screenPoint=new A(a.pageX-c.position.x,a.pageY-c.position.y);a.mapPoint=c.toMap(a.screenPoint)},
_canvasDownHandler:function(a){this._processEvent(a);this._downPt=a.screenPoint.x+","+a.screenPoint.y},_canvasUpHandler:function(a){this._processEvent(a);this._upPt=a.screenPoint.x+","+a.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(a,c,d,b){if(!a.visible||!c)return!1;var e=c.getTransformedBoundingBox(),k;return e?(k=new y(e[0].x,e[0].y,e[2].x,e[2].y),delete k.spatialReference,L?k.intersects(d):k.contains(b)):m.some(c.children||[],function(a){e=a.getTransformedBoundingBox();k=new y(e[0].x,
e[0].y,e[2].x,e[2].y);delete k.spatialReference;return L?k.intersects(d):k.contains(b)})},_canvasClickHandler:function(a){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(a);var c=this._map,d=m.map(c.graphicsLayerIds,function(a){return c.getLayer(a)});d.push(c.graphics);d.reverse();var d=m.filter(d,function(a){return a.loaded&&a._mouseEvents&&!a.suspended&&(!v.isDefined(a.opacity)||0<a.opacity)}),b=a.screenPoint,e=this._tolerance,k=b.x-e,g=b.y+e,t=b.x+e,e=b.y-e,f=new y(k,
e,t,g),k=c.toMap(new A(k,g)),t=c.toMap(new A(t,e)),g=k.spatialReference._getInfo(),q=new y(y.prototype._normalizeX(k.x,g).x,k.y,y.prototype._normalizeX(t.x,g).x,t.y,k.spatialReference),u;delete f.spatialReference;m.some(d,function(a){a=m.filter(a.graphics,function(a){return this._isPrimaryMatch(a,a.getDojoShape(),f,b)||!(!a._bgShape||!this._isPrimaryMatch(a,a._bgShape,f,b))},this);a.reverse();if(0<a.length){var c;m.some(a,function(a){return a.geometry&&q.intersects(a.geometry)?(c=a,!0):!1});if(c)return u=
c,!0}return!1},this);u&&(d=u.getLayer())&&(a.graphic=u,d.onClick(a))}}});E=p(a,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:I?"canvas-2d":g.renderer,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},constructor:function(a,c){a&&(b.isString(a)||b.isObject(a)&&(a.layerDefinition||a.query))&&(a=c);this._params=b.mixin({displayOnPan:!0,drawMode:!0,styling:!0},a||{});var d=this._params.dataAttributes;"string"===typeof d&&(d=
[d]);this.styling=G?this._params.styling:!0;this.dataAttributes=d;this.infoTemplate=a&&a.infoTemplate;this.graphics=[];this._draw=b.hitch(this,this._draw);this._refresh=b.hitch(this,this._refresh);this.registerConnectEvents()},getNode:function(){return this._div&&this._div.getEventSource()},setDrawMode:function(a){this._params.drawMode=a},renderer:null,_setMap:function(a,c){this.inherited(arguments);this._map=a;this._wrap=a.wrapAround180;this._srInfo=a.spatialReference._getInfo();this._svgFilters=
{};this._canvas?(c=g.createSurface(c.getEventSource(),a.width,a.height),r.set(c.rawNode,"position","absolute"),this._div=c.createGroup(),this._renderProto=this._div.constructor.prototype._render,this._div._render=b.hitch(this,this._canvasRender)):this._div=c.createGroup();this._bgGroup=this._div.createGroup();this._div.getEventSource().id=this.id+"_layer";this._initOpacity();return this._div},_unsetMap:function(a,c){m.forEach(this.graphics,function(a){a._shape=null});this._canvas?(c=this._div.getParent(),
c._parent={},h.destroy(c.rawNode),c.destroy()):(this._div.clear(),c.remove(this._div),h.destroy(this._div.getEventSource()));this._map=this._div=this._svgFilters=null;clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_initOpacity:function(){var a=this.opacity;v.isDefined(a)&&1>a&&this.setOpacity(a,!0)},_onZoomStartHandler:function(){d.hide(this._div.getEventSource())},_onExtentChangeHandler:function(a,c,b,e){clearTimeout(this._wakeTimer);this._wakeTimer=
null;b?(a=this._map.__visibleRect,c=this._div,this._evalSDRenderer(),this._refresh(!0),this._updateTransform(c,a.x,a.y,!0),this._renderProto&&c.surface.pendingRender?this._dirty=!0:this.suspended||d.show(c.getEventSource())):this._resized&&(this._resized=!1,this._refresh(!1));if(0<this.graphics.length)this.onUpdate()},_canvasRender:function(){var a=this._div;this._dirty&&(delete this._dirty,this.suspended||d.show(a.getEventSource()));return this._renderProto.apply(a,arguments)},_refresh:function(a){var c=
this.graphics,d=c.length,b,e=this._draw;for(b=0;b<d;b++)e(c[b],a)},refresh:function(){this._refresh(!0)},redraw:function(){this._refresh(!0)},_getTransform:function(){var a={dx:0,dy:0};this._map&&(this._map._gc._useWillChange?a=this._map._gc._getTransform():this._div&&(a=this._div.getTransform()));return a},_onPanHandler:function(a,c){this._panDx=c.x;this._panDy=c.y;var d=this._map.__visibleRect;this._updateTransform(this._div,d.x+c.x,d.y+c.y)},_onPanEndUpdateHandler:function(a,c){var d=this._map.__visibleRect;
this._params._child||c.x===this._panDx&&c.y===this._panDy?this._updateSVGFilters(-d.x,-d.y):this._updateTransform(this._div,d.x,d.y,!0);this._refresh(!1);if(this.graphics.length)this.onUpdate()},_onPanStartHandler:function(){d.hide(this._div.getEventSource())},_onPanEndHandler:function(){var a=this._map.__visibleRect,c=this._div;this._updateTransform(c,a.x,a.y,!0);this._refresh(!1);this._renderProto&&c.surface.pendingRender?this._dirty=!0:d.show(c.getEventSource());if(this.graphics.length)this.onUpdate()},
_updateTransform:function(a,c,d,b){this._map._gc._useWillChange||a.setTransform(e.translate({x:c,y:d}));b&&this._updateSVGFilters(-c,-d)},onSuspend:function(){this.inherited(arguments);d.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(a){this.inherited(arguments);a.firstOccurrence&&this._evalSDRenderer();this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(b.hitch(this,function(){this.suspended||
this._map.__zooming||this._onExtentChangeHandler(null,null,!0)}),0)},_enableDrawConnectors:function(){var a=this._map,c=f.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||(this._onPanHandler_connect=c(a,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=c(a,"onPanEnd",this,"_onPanEndUpdateHandler")):(this._onPanStartHandler_connect=c(a,"onPanStart",this,"_onPanStartHandler"),this._onPanEndHandler_connect=c(a,"onPanEnd",this,"_onPanEndHandler"));this._onZoomStartHandler_connect=
c(a,"onZoomStart",this,"_onZoomStartHandler");this._onExtentChangeHandler_connect=c(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=f.disconnect;a(this._onExtentChangeHandler_connect);a(this._onZoomStartHandler_connect);a(this._onPanHandler_connect);a(this._onPanStartHandler_connect);a(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=this._onPanEndHandler_connect=
null},_updateExtent:function(a){var c=a.geometry;if(!c)a._extent=null;else if(!(a._extent=c.getExtent())){var d,b;if("esri.geometry.Point"===c.declaredClass)d=c.x,b=c.y;else if("esri.geometry.Multipoint"===c.declaredClass)d=c.points[0][0],b=c.points[0][1];else{a._extent=null;return}a._extent=new y(d,b,d,b,c.spatialReference)}},_intersects:function(a,c,d){var b=a.spatialReference,e=c.spatialReference,k=b&&e&&!b.equals(e)&&b._canProject(e)&&4326===e.wkid;if(this._wrap&&!d){d=[];var b=a._getFrameWidth(),
g=this._srInfo,t=a._clip?a._getAvailExtent():a.extent,f,q,u,w,v=[];f=c._partwise;k&&(t=a.geographicExtent,g=e._getInfo());a=t._getParts(g);if(f&&f.length)for(c=[],e=0,k=f.length;e<k;e++)c=c.concat(f[e]._getParts(g));else c=c._getParts(g);e=0;for(k=c.length;e<k;e++)for(u=c[e],g=0,t=a.length;g<t;g++)if(w=a[g],w.extent.intersects(u.extent))for(f=0,q=u.frameIds.length;f<q;f++)d.push((w.frameIds[0]-u.frameIds[f])*b);e=0;for(k=d.length;e<k;e++)f=d[e],m.indexOf(d,f)===e&&v.push(f);return v.length?v:null}return(k?
a.geographicExtent:a.extent).intersects(c)?[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(a,c){if(this._params.drawMode&&this._map&&!this.suspended&&!this._map.__zooming&&!this._resized)try{var d=a._extent,b,e,k=!G||this.styling,g=G&&this.dataAttributes,t=a.getDojoShape(),f;if(a.visible&&d&&(b=this._intersects(this._map,d,a.geometry._originOnly))&&(e=k?this._getSymbol(a):this._defaultMarker)){if(a._offsets&&a._offsets.join(",")===
b.join(",")?f=!0:a._offsets=b,!t||c||!f){var q=a.geometry.type,d={graphic:a},u=a._bgShape,w=k&&!a.symbol?this._getRenderer(a):null,v=w&&w.backgroundFillSymbol;if("point"===q)this._isInvalidShape(e,t)&&this._removeShape(a),a._shape=this._drawPoint(this._div,a.geometry,e,a.getDojoShape(),b,w,a),k&&this._symbolizePoint(a.getDojoShape(),e,w,a);else if("multipoint"===q)this._drawMarkers(a,e,b,w),k&&this._symbolizeMarkers(a,e,w);else{var h,q=e,x,n,l;k&&(q=(h="simplemarkersymbol"===e.type||"picturemarkersymbol"===
e.type||"textsymbol"===e.type?e:null)?v:e);k&&q&&-1<q.type.indexOf("fillsymbol")&&(x=this._bgGroup,l=!(!x||!h));u&&!l&&this._removeBgShape(a);q&&(!l&&this._isInvalidShape(q,a._shape)&&this._removeShape(a,!1),n=this._drawShape(a,b,x||this._div,l?u:a.getDojoShape()),k&&this._symbolizeShape(n,q,w,q===v,a),a[l?"_bgShape":"_shape"]=n);if(h){this._isInvalidShape(h,a._shape)&&this._removeShape(a,!1);var r=a.geometry.getCentroid();(n=r&&this._drawPoint(this._div,r,h,a._shape,b,w,a))&&this._symbolizePoint(n,
h,w,a);a._shape=n}}I||(a._bgShape&&this._initNode(a,a._bgShape,a._bgShape!==u,d,g),a._shape&&this._initNode(a,a._shape,a._shape!==t,d,g));d.node=a.getNode();this.onGraphicDraw(d)}}else t&&this._removeShape(a)}catch(oa){this._errorHandler(oa,a)}},_initNode:function(a,c,d,b,e){if(c=c&&c.getNode())c.e_graphic=a,this._addDataAttrs(a,e,c),d&&(b.node=c,this.onGraphicNodeAdd(b))},_removeShape:function(a,c,d){var b=a.getDojoShape(),e=b&&b.getNode();b&&!d&&(b.removeShape(),b.destroy());a._shape=a._offsets=
null;!1!==c&&this._removeBgShape(a,d);if(e&&(e.e_graphic=null,!I))this.onGraphicNodeRemove({graphic:a,node:e})},_removeBgShape:function(a,c){var d=a._bgShape,b=d&&d.getNode();d&&!c&&(d.removeShape(),d.destroy());a._bgShape=null;if(b&&(b.e_graphic=null,!I))this.onGraphicNodeRemove({graphic:a,node:b})},_addDataAttrs:function(a,c,d){var b=a.attributes,e,k=c?c.length:0,g=this._getRenderer(a);if(d&&b){for(e=0;e<k;e++)(d=c[e])&&a.attr("data-"+d,b[d]);!this.styling&&g&&(g.getBreakIndex?(c=g.getBreakIndex(a),
a.attr("data-class-break",-1!==c?c:null)):g.getUniqueValueInfo&&(c=g.getUniqueValueInfo(a),a.attr("data-unique-value",c?c.value:null)))}},_drawShape:function(a,c,d,b){a=a.geometry;var e=a.type,k=this._map,g=k.extent,t=k.width,f=k.height,k=k.__visibleRect,q=[],u,w;u="extent"===e;if("rect"===e||u)q={x:0,y:0,spatialReference:a.spatialReference},q.x=u?a.xmin:a.x,q.y=u?a.ymax:a.y,e=C.toScreenPoint(g,t,f,q),q.x=u?a.xmax:a.x+a.width,q.y=u?a.ymin:a.y+a.height,a=C.toScreenPoint(g,t,f,q),c={x:e.x-k.x+c[0],
y:e.y-k.y,width:Math.abs(a.x-e.x),height:Math.abs(a.y-e.y)},0===c.width&&(c.width=1),0===c.height&&(c.height=1),b=this._drawRect(d,b,c);else if("polyline"===e||"polygon"===e){u=0;for(w=c.length;u<w;u++)q=q.concat(C._toScreenPath(g,t,f,a,-k.x+c[u],-k.y));b=this._drawPath(d,b,q);this._rendererLimits&&("polyline"===e?this._clipPolyline(b,a):this._clipPolygon(b,a))}return b},_drawRect:function(a,c,d){return c?c.setShape(d):a.createRect(d)},_drawImage:function(a,c,d){return c?c.setShape(d):a.createImage(d)},
_drawCircle:function(a,c,d){return c?c.setShape(d):a.createCircle(d)},_drawPath:function(){return J?function(a,c,d,b){d=b?d:d.join(" ");if(c)return c.setShape(d);c=a.createObject(b?g.Path:g.EsriPath,d);a._overrideSize(c.getEventSource());return c}:function(a,c,d,b){d=b?d:d.join(" ");return c?c.setShape(d):a.createPath(d)}}(),_drawText:function(a,c,d){return c?c.setShape(d):a.createText(d)},_evalSDRenderer:function(a){var c=this._map,d=this.renderer,b,e=this._rndForScale;c&&c.loaded&&d&&d.getRendererInfo&&
(b="zoom"===d.rangeType?d.getRendererInfoByZoom(c.getZoom()):d.getRendererInfoByScale(c.getScale()));this._rndForScale=b&&b.renderer;(c=this._getRenderer())&&c.prepareForViewChange();a||this._rndForScale==e||this.emit("renderer-change",{renderer:this._rndForScale})},_getRenderer:function(a){var c=this._rndForScale||this.renderer;a&&c&&c.getObservationRenderer&&(c=c.getObservationRenderer(a));return c},_getSymbol:function(a){var c=this._getRenderer();return a.symbol||c&&c.getSymbol(a)},_getVariable:function(a,
c,d){var b;a&&(b=(a=a.getVisualVariablesForType(c,d))&&a[0]);return b},_applyOpacity:function(a,c,d,b){c=c.getOpacity(b,{opacityInfo:d});null!=c&&(a=new k(a),a.a=c);return a},_symbolizeShape:function(a,c,d,e,k){var g=c.getStroke(),t=c.getFill(),f=c.type,q,u,w=-1!==f.indexOf("linesymbol"),v=-1!==f.indexOf("fillsymbol")?null:this._getVariable(d,"sizeInfo",!1),h=this._getVariable(d,"colorInfo",!1),x=this._getVariable(d,"opacityInfo",!1);c=w?"none"!==c.style:c.outline&&"none"!==c.outline.style;var n=
w?null:this._getVariable(d,"sizeInfo","outline"),v=(v=e?n:n||v)?d.getSize(k,{sizeInfo:v,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null;e&&(h=x=null);(h||x)&&"picturefillsymbol"!==f&&(w?(q=g&&g.color,h&&(q=d.getColor(k,{colorInfo:h})||q),q&&x&&(q=this._applyOpacity(q,d,x,k))):t&&t.toCss&&(u=t,h&&(u=d.getColor(k,{colorInfo:h})||u),u&&x&&(u=this._applyOpacity(u,d,x,k))));a.setStroke(!c||null==v&&!q?g:b.mixin({},g,null!=v?{width:v}:null,q&&{color:q})).setFill(u||t)},_smsToPath:function(){return J?
function(a,c,d,b,e,k,g,t,f){switch(c){case a.STYLE_SQUARE:return["M",e+","+g,"L",k+","+g,k+","+t,e+","+t,"X","E"];case a.STYLE_CROSS:return["M",d+","+g,"L",d+","+t,"M",e+","+b,"L",k+","+b,"E"];case a.STYLE_X:return["M",e+","+g,"L",k+","+t,"M",e+","+t,"L",k+","+g,"E"];case a.STYLE_DIAMOND:return["M",d+","+g,"L",k+","+b,d+","+t,e+","+b,"X","E"];case a.STYLE_TARGET:return["M",e+","+g,"L",k+","+g,k+","+t,e+","+t,e+","+g,"M",e-f+","+b,"L",e+","+b,"M",d+","+(g-f),"L",d+","+g,"M",k+f+","+b,"L",k+","+b,"M",
d+","+(t+f),"L",d+","+t,"E"]}}:function(a,c,d,b,e,k,g,t,f){switch(c){case a.STYLE_SQUARE:return["M",e+","+g,k+","+g,k+","+t,e+","+t,"Z"];case a.STYLE_CROSS:return["M",d+","+g,d+","+t,"M",e+","+b,k+","+b];case a.STYLE_X:return["M",e+","+g,k+","+t,"M",e+","+t,k+","+g];case a.STYLE_DIAMOND:return["M",d+","+g,k+","+b,d+","+t,e+","+b,"Z"];case a.STYLE_TARGET:return["M",e+","+g,k+","+g,k+","+t,e+","+t,e+","+g,"M",e-f+","+b,e+","+b,"M",d+","+(g-f),d+","+g,"M",k+f+","+b,k+","+b,"M",d+","+(t+f),d+","+t]}}}(),
_pathStyles:{square:1,cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(a,c){var d=c&&c.shape&&c.shape.type,b=a&&a.type,e=a&&a.style;"rect"===d&&(d="path");b&&(e=this._typeMaps[b]||e);this._pathStyles[e]&&(e="path");return"shieldlabelsymbol"===b?!0:!(!d||!e||d===e)},_drawPoint:function(a,c,d,b,k,g,f){var q=d.type,u=this._map,w=u.__visibleRect,
v=C.toScreenPoint(u.extent,u.width,u.height,c).offset(-w.x+k[0],-w.y),w=v.x,h=v.y,x;c=[];var n,l=this._getVariable(g,"rotationInfo",!1),l=l?g.getRotationAngle(f,{rotationInfo:l}):null,r=this._getVariable(g,"sizeInfo",!1),u=r?g.getSize(f,{sizeInfo:r,shape:d.style,resolution:u.getResolutionInMeters(),scale:u.getScale()}):null;l&&c.push(e.rotategAt(l,v));if(0!==d.xoffset||0!==d.yoffset)n=e.translate(d.xoffset,-d.yoffset),c.push(n);0!==d.angle&&c.push(e.rotategAt(d.angle,v));if("simplemarkersymbol"===
q)switch(x=d.style,g=Math.round,u=null!=u?u:d.size,x){case t.STYLE_SQUARE:case t.STYLE_CROSS:case t.STYLE_X:case t.STYLE_DIAMOND:d=isNaN(u)?16:u/2;x=this._drawPath(a,b,this._smsToPath(t,x,w,h,g(w-d),g(w+d),g(h-d),g(h+d)));break;case t.STYLE_TARGET:f=d._targetWidth/2;v=d._targetHeight/2;x=this._drawPath(a,b,this._smsToPath(t,x,w,h,g(w-f),g(w+f),g(h-v),g(h+v),d._spikeSize));break;case t.STYLE_PATH:x=this._drawPath(a,b,d.path,!0);d=x.getBoundingBox();a=this._getScaleMatrix(d,u);1===a.xx&&1===a.yy||c.push(e.scaleAt(a.xx,
a.yy,v));c.push(e.translate(-(d.x+d.width/2)+w,-(d.y+d.height/2)+h));break;default:d=isNaN(u)?16:u/2,x=this._drawCircle(a,b,{cx:w,cy:h,r:d})}else if("shieldlabelsymbol"===q)x=d.width,v=d.height,b=a.createGroup(),x=a.createImage({x:w-x/2,y:h-v/2,width:x,height:v,src:d.url}),b.add(x),null!=d.font&&(h+=.2*d.getHeight(),a=a.createText({type:"text",text:d.text,x:w,y:h,align:"middle",decoration:d.decoration,rotated:d.rotated,kerning:d.kerning}),a.setFont(d.font),a.setFill(d.color),b.add(a)),x=b;else if("picturemarkersymbol"===
q){if(null==u?(x=d.width,v=d.height):(v=u,x=d.width/d.height*v,n&&(null!=n.dx&&(n.dx=n.dx/d.width*x),null!=n.dy&&(n.dy=n.dy/d.height*v))),x=this._drawImage(a,b,{x:w-x/2,y:h-v/2,width:x,height:v,src:d.url}),G&&(a=x.getNode()))d=(d=this._getVariable(g,"opacityInfo",!1))?g.getOpacity(f,{opacityInfo:d}):null,null!=d?a.setAttribute("opacity",d):a.setAttribute("opacity",1)}else"textsymbol"===q&&(g=d.font,null!=u&&g&&(g=new g.constructor(g.toJson()),g.setSize(u)),x=this._drawText(a,b,{type:"text",text:d.text,
x:w,y:h,align:d.getSVGAlign(),decoration:d.decoration||g&&g.decoration,rotated:d.rotated,kerning:d.kerning}),g&&x.setFont(g),G&&(a=x.getNode(),w=d.getSVGBaseline(),h=d.getSVGBaselineShift(),a&&(a.setAttribute("dominant-baseline",w),h&&a.setAttribute("baseline-shift",h),this._applyHalo(x,d.haloColor,d.haloSize))));x.setTransform(e.multiply(c));x._wrapOffsets=k;return x},_applyHalo:function(a,c,d){var b=c&&d?this._getHaloId(c,d):null;a.setFilter(c&&d?q("webkit")||q("ff")?this._getDilateFilter(c,d,b):
this._getOffsetFilter(c,d,b):null)},_getDilateFilter:function(a,d,b){var e=this._getSVGFilter(b);e||(e=this._createSVGFilter({id:b},[c.feMorphology({operator:"dilate",radius:d,result:"dilated"}),c.feFlood({"flood-color":a.toCss(!0)}),c.feComposite({in2:"dilated",operator:"in",result:"composite"}),c.feMerge("composite","SourceGraphic")]));return e},_getOffsetFilter:function(a,d,b){var e=this._getSVGFilter(b);if(!e){a=a.toCss(!0);var e=this._offsetPrimitives,k,g=e.length,t=[],f=[];for(k=0;k<g;k++){var q=
e[k],u="offset"+q.dir,w="composite"+q.dir;f.push(w);t.push(c.feOffset({dx:q.dx*d,dy:q.dy*d,"in":"SourceAlpha",result:u}),c.feFlood({"flood-color":a}),c.feComposite({in2:u,operator:"in",result:w}))}f.push("SourceGraphic");t.push(c.feMerge.apply(c.feMerge,f));e=this._createSVGFilter({id:b},t)}return e},_offsetPrimitives:[{dir:"L",dx:-1,dy:0},{dir:"TL",dx:-1,dy:-1},{dir:"T",dx:0,dy:-1},{dir:"TR",dx:1,dy:-1},{dir:"R",dx:1,dy:0},{dir:"BR",dx:1,dy:1},{dir:"B",dx:0,dy:1},{dir:"BL",dx:-1,dy:1}],_getHaloId:function(a,
c){return"halo_"+this._map.id+"_"+this.id+"_"+a.r+"_"+a.g+"_"+a.b+"_"+a.a+"_"+c},_getSVGFilter:function(a){return this._svgFilters[a]},_createSVGFilter:function(a,d){var b=c.createFilter(a,d),e=this._map,k=e.__visibleRect;b.x=-k.x;b.y=-k.y;b.width=e.width;b.height=e.height;return this._svgFilters[a.id]=b},_updateSVGFilters:function(a,c,d,b){var e=this._svgFilters,k,g,t;for(g in e)if(k=e[g]){if(t=n.byId(g))null!=a&&t.setAttribute("x",a),null!=c&&t.setAttribute("y",c),null!=d&&t.setAttribute("width",
d),null!=b&&t.setAttribute("height",b);null!=a&&(k.x=a);null!=c&&(k.y=c);null!=d&&(k.width=d);null!=b&&(k.height=b)}},_getScaleMatrix:function(a,c){var d=a.width/a.height,b=1,e=1;isNaN(c)||(1<d?(b=c/a.width,e=c/d/a.height):(e=c/a.height,b=c*d/a.width));return{xx:b,yy:e}},_symbolizePoint:function(a,c,d,e){var k=c.type,g=c.style;if("shieldlabelsymbol"!==k&&"picturemarkersymbol"!==k){var f=c.getStroke();c=c.getFill();var g=g===t.STYLE_X||g===t.STYLE_CROSS,q=f&&f.color,u=g?q:c;if(d){var w=this._getVariable(d,
"colorInfo",!1),v=this._getVariable(d,"opacityInfo",!1);w&&(u=d.getColor(e,{colorInfo:w})||u);u&&v&&(u=this._applyOpacity(u,d,v,e));u&&(g?u!==q&&(f=f?b.mixin({},f):{},f.color=u):u!==c&&(c=u))}"textsymbol"===k?a.setFill(c):"simplemarkersymbol"===k&&a.setFill(c).setStroke(f)}},_drawMarkers:function(a,c,d,b){var e=a.geometry,k=e.points,g=a.getDojoShape()||this._div.createGroup(),t,f,u=k.length,q=[],w=0,v,h=d?d.length:0;g.children[0]&&this._isInvalidShape(c,g.children[0])&&g.clear();for(f=0;f<u;f++)for(t=
k[f],v=0;v<h;v++)q[0]=d[v],this._drawPoint(g,{x:t[0],y:t[1],spatialReference:e.spatialReference},c,g.children[w++],q,b,a);c=g.children.length;if(u*d.length<c)for(f=c-1;f>=u*d.length;f--)g.children[f].removeShape();a._shape=g},_symbolizeMarkers:function(a,c,d){var b=a.getDojoShape().children,e,k=b.length;for(e=0;e<k;e++)this._symbolizePoint(b[e],c,d,a)},_errorHandler:function(a,c){a.message=c?"Unable to draw graphic (geometry:"+(c.geometry?c.geometry.declaredClass:null)+", symbol:"+(c.symbol?c.symbol.declaredClass:
null)+"): "+a.message:"Unable to draw graphic (null): "+a.message;this.inherited(arguments)},_rendererLimits:function(){var a,c,d;q("ff")?(a=16125,c=-32250,d=32250):J?(a=1E5,c=-1E5,d=1E5):q("chrome")&&6>q("chrome")&&(a=8150,c=-1E4,d=1E4);if(a)return{clipLimit:a,rangeMin:c,rangeMax:d,clipBBox:[-a,-a,a,a],clipSegments:[[[-a,-a],[a,-a]],[[a,-a],[a,a]],[[a,a],[-a,a]],[[-a,a],[-a,-a]]]}}(),_clipPolyline:function(a,c){var d=this._getCorners(a,c),b=d.br,e=this._rendererLimits,k=e.rangeMin,g=e.rangeMax,t=
e.clipBBox,f=e.clipSegments,e=this._isPointWithinRange,u=this._isPointWithinBBox,q=this._getClipperIntersection,w=this._getPlaneIndex;if(!e(d.tl,k,g)||!e(b,k,g)){J&&this._createSegments(a);var v=[];m.forEach(a.segments,function(a){a=a.args;var c=a.length,d=[],b;for(b=0;b<c;b+=2){var e=[a[b],a[b+1]],k=[a[b+2],a[b+3]],g=u(e,t),h=u(k,t);if(g^h){if(h=q([e,k],f))g?(b?d.push(h[1]):d.push(e,h[1]),v.push(d),d=[]):d.push(h[1],k)}else g?b?d.push(k):d.push(e,k):(h=w(e,t),g=w(k,t),-1!==h&&-1!==g&&h!==g&&(e=q([e,
k],f,!0),0<e.length&&(e[h]||(h=e[h[0]]?h[0]:h[1]),e[g]||(g=e[g[0]]?g[0]:g[1]),k=e[h],e=e[g],k&&d.push(k),e&&(d.push(e),v.push(d),d=[]))))}v.push(d)});a.setShape(this._getPathStringFromPaths(v))}},_clipPolygon:function(a,c){var d=this._getCorners(a,c),e=d.br,k=this._rendererLimits,g=k.clipLimit,t=k.rangeMin,f=k.rangeMax,u=k.clipBBox,q=k.clipSegments,k=this._isPointWithinRange,w=this._isPointWithinBBox,v=this._getClipperIntersection,h=this._getPlaneIndex,x=z._pointLineDistance;k(d.tl,t,f)&&k(e,t,f)||
(J&&this._createSegments(a),d=m.filter(a.segments,function(a){return a.args&&a.args.length}),d=m.map(d,function(a){var c=a.args,d=c.length,e=[];a=[];var k;for(k=0;k<d;k+=2){var t=[c[k],c[k+1]],f=[c[k+2],c[k+3]];if(k===d-2){e.push(t);break}var n=w(t,u),l=w(f,u);e.push(t);if(n^l){if(l=v([t,f],q))t=l[1],t[n?"inOut":"outIn"]=!0,e.push(t),a.push([n?"INOUT":"OUTIN",e.length-1,l[0]])}else if(!n){var n=h(t,u),r=h(f,u);-1!==n&&-1!==r&&n!==r&&(l=v([t,f],q,!0),0<l.length?(l[n]||(n=l[n[0]]?n[0]:n[1]),l[r]||(r=
l[r[0]]?r[0]:r[1]),t=l[n],f=l[r],t&&(t.outIn=!0,e.push(t),a.push(["OUTIN",e.length-1,n])),f&&(f.inOut=!0,e.push(f),a.push(["INOUT",e.length-1,r]))):b.isArray(n)&&b.isArray(r)&&(l=n.concat(r),l.sort(),"0123"===l.join("")&&(l=[],3===n[0]+n[1]?l.push([g,-g],[-g,g]):l.push([-g,-g],[g,g]),n=x(l[0],[t,f]),t=x(l[1],[t,f]),e.push(n<t?l[0]:l[1]))))}}var y=u[0],z=u[1],A=u[2],C=u[3];m.forEach(e,function(a){a[0]<y&&(a[1]>=z&&a[1]<=C?a[0]=y:(a[0]=y,a[1]=a[1]<z?z:C))});m.forEach(e,function(a){a[1]<z&&(a[0]>=y&&
a[0]<=A?a[1]=z:(a[1]=z,a[0]=a[0]<y?y:A))});m.forEach(e,function(a){a[0]>A&&(a[1]>=z&&a[1]<=C?a[0]=A:(a[0]=A,a[1]=a[1]<z?z:C))});m.forEach(e,function(a){a[1]>C&&(a[0]>=y&&a[0]<=A?a[1]=C:(a[1]=C,a[0]=a[0]<y?y:A))});c=0;d=a.length;if(0<d){do{f=a[c];k=a[(c+1)%d];if(f[2]===k[2]&&"INOUT"===f[0]&&"OUTIN"===k[0])if(t=f[1],k=k[1],t<k)for(t+=1;t<k;t++)e[t][2]=!0;else if(t>k){for(t+=1;t<e.length;t++)e[t][2]=!0;for(t=0;t<k;t++)e[t][2]=!0}c=(c+1)%d}while(0!==c)}d=e[0];c=e[e.length-1];d[2]&&(c[2]=!0,m.some(a,function(a){return 1===
a[1]?(e.splice(e.length-1,0,b.clone(e[1])),!0):!1}));e=m.filter(e,function(a){return a[2]?!1:!0});for(c=0;c<e.length-1;c++)d=e[c],(k=e[c+1])&&d[0]===k[0]&&d[1]===k[1]&&(k.outIn?d.outIn=!0:k.inOut&&(d.inOut=!0),e.splice(c+1,1));d=Math.abs;a=[];for(c=0;c<e.length-1;c++){f=e[c];t=f[0];f=f[1];n=d(t)===g;l=d(f)===g;k=e[c+1];r=k[0];k=k[1];var p=d(r)===g,B=d(k)===g;n&&B?a.push([c+1,[t,k]]):l&&p&&a.push([c+1,[r,f]])}for(c=a.length-1;0<=c;c--)k=a[c],t=e[k[0]-1],d=e[k[0]],t.outIn||t.inOut||d.outIn||d.inOut||
e.splice(k[0],0,k[1]);d=e[0];c=e[e.length-1];d[0]===c[0]&&d[1]===c[1]||e.push(d);return e}),a.setShape(this._getPathStringFromPaths(d)))},_getCorners:function(a,c){if(J){var d=this._map,b=c.getExtent(),e=b.spatialReference,k=d.toScreen(new x(b.xmin,b.ymax,e)),d=d.toScreen(new x(b.xmax,b.ymin,e));return{tl:k,br:d}}k=a.getTransformedBoundingBox();return{tl:k[0],br:k[2]}},_createSegments:function(a){a.shape.path=a.vmlPath;a.segmented=!1;a._confirmSegmented();var c=a.segments;1<c.length&&(a.segments=
m.filter(c,function(a,c,d){c=d[c+1];return"M"===a.action&&c&&"L"===c.action?(a.args=a.args.concat(c.args),!0):!1}))},_getPathStringFromPaths:function(a){J?(a=m.map(a,function(a){return"m "+m.map(a,function(a,c){return(1===c?"l ":"")+a.join(",")}).join(" ")}),a.push("e")):a=m.map(a,function(a){return"M "+m.map(a,function(a){return a.join(",")}).join(" ")});return a.join(" ")},_isPointWithinBBox:function(a,c){var d=c[1],b=c[2],e=c[3],k=a[0],g=a[1];return k>c[0]&&k<b&&g>d&&g<e?!0:!1},_isPointWithinRange:function(a,
c,d){var b=a.x;a=a.y;return b<c||a<c||b>d||a>d?!1:!0},_getClipperIntersection:function(a,c,d){var b,e=z._getLineIntersection2,k=Math.round,g={length:0};for(b=0;4>b;b++){var t=e(a,c[b]);if(t)if(t[0]=k(t[0]),t[1]=k(t[1]),d)g[b]=t,g.length++;else return[b,t]}return d?g:null},_getPlaneIndex:function(a,c){var d=a[0],b=a[1],e=c[0],k=c[1],g=c[2],t=c[3];return d<=e?b>=k&&b<=t?3:b<k?[0,3]:[2,3]:b<=k?d>=e&&d<=g?0:d<e?[3,0]:[1,0]:d>=g?b>=k&&b<=t?1:b<k?[0,1]:[2,1]:b>=t?d>=e&&d<=g?2:d<e?[3,2]:[1,2]:-1},onGraphicAdd:function(){},
onGraphicRemove:function(){},onGraphicNodeAdd:function(){},onGraphicNodeRemove:function(){},onGraphicDraw:function(){},onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},setInfoTemplate:function(a){this.infoTemplate=a},add:function(a,c){if(a._graphicsLayer===this)return a;c||this.graphics.push(a);a._graphicsLayer=this;a._layer=this;this._updateExtent(a);this._draw(a);if(!c)this.onGraphicAdd(a);return a},remove:function(a,c,d){if(!c&&!d){c=this.graphics;if(-1===
(a=m.indexOf(c,a)))return null;a=c.splice(a,1)[0]}a.getDojoShape()&&this._removeShape(a,null,d);a._shape=a._graphicsLayer=null;this.onGraphicRemove(a);return a},clear:function(a,c){var d=this.graphics,b,e=!J;for(b=d.length-1;0<=b;b--)this.remove(d[b],null,e);this.graphics=[];if(e&&this._div){var k;this._childLayer&&(k=this._childLayer.getNode())&&k.parentNode&&k.parentNode.removeChild(k);this._bgGroup.clear();this._div.clear();this._bgGroup=this._div.createGroup();k&&this._div.getEventSource().appendChild(k);
this._initOpacity()}if(!c)this.onGraphicsClear()},_setIEOpacity:function(a,c){var d=a&&a.getNode();if(d){var b=a.strokeStyle,e=d.stroke;b&&e&&(e.opacity=b.color.a*c);b=a.fillStyle;e=d.fill;b&&e&&("tile"===e.type?r.set(d,"opacity",c):e.opacity=b.a*c)}},setOpacity:function(a,c){if(c||this.opacity!=a){var d=this._div;d&&(J?(m.forEach(this.graphics,function(c){this._setIEOpacity(c._shape,a);this._setIEOpacity(c._bgShape,a)},this),d._esriIeOpacity=a,this._bgGroup._esriIeOpacity=a):this._canvas?r.set(d.getEventSource(),
"opacity",a):d.getEventSource().setAttribute("opacity",a));this.opacity=a;if(!c)this.onOpacityChange(a)}},setRenderer:function(a){this.renderer=a;this._evalSDRenderer(!0);this.emit("renderer-change",{renderer:this._rndForScale||a})}});p=p([E,B],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this.enableMouseEvents=b.hitch(this,this.enableMouseEvents);this.disableMouseEvents=b.hitch(this,this.disableMouseEvents);this._processEvent=b.hitch(this,this._processEvent);this._initLayer()},
_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var a=this.inherited("_setMap",arguments);this.enableMouseEvents();return a},_unsetMap:function(){this.disableMouseEvents();this.inherited("_unsetMap",arguments)},_processEvent:function(a){var c=this._map,d=a.target,b;a.screenPoint=new A(a.pageX-c.position.x,a.pageY-c.position.y);for(a.mapPoint=c.toMap(a.screenPoint);d&&!(b=d.e_graphic);)d=d.parentNode;if(b)return a.graphic=b,a},_onMouseOverHandler:function(a){if(this._processEvent(a))this.onMouseOver(a)},
_onMouseMoveHandler:function(a){if(this._processEvent(a))this.onMouseMove(a)},_onMouseDragHandler:function(a){if(this._processEvent(a))this.onMouseDrag(a)},_onMouseOutHandler:function(a){if(this._processEvent(a))this.onMouseOut(a)},_onMouseDownHandler:function(a){this._downGr=this._downPt=null;this._processEvent(a)&&(f.disconnect(this._onmousemove_connect),f.disconnect(this._onmousedrag_connect),this._onmousedrag_connect=f.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),
this._downGr=a.graphic,this._downPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseDown(a))},_onMouseUpHandler:function(a){this._upGr=this._upPt=null;this._processEvent(a)&&(f.disconnect(this._onmousedrag_connect),f.disconnect(this._onmousemove_connect),this._onmousemove_connect=f.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=a.graphic,this._upPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseUp(a))},_onClickHandler:function(a){if(this._processEvent(a)){var c=
this._downGr,d=this._upGr;c&&d&&c===d&&this._downPt===this._upPt&&(J&&(u._ieGraphic=a.graphic),this.onClick(a))}},_onDblClickHandler:function(a){if(this._processEvent(a))this.onDblClick(a)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var a=f.connect,c=this._div.getEventSource();I||(this._onmouseover_connect=
a(c,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=a(c,"onmousemove",this,"_onMouseMoveHandler"),this._onmouseout_connect=a(c,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=a(c,"onmousedown",this,"_onMouseDownHandler"),this._onmouseup_connect=a(c,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=a(c,"onclick",this,"_onClickHandler"),this._ondblclick_connect=a(c,"ondblclick",this,"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var a=
f.disconnect;a(this._onmouseover_connect);a(this._onmousemove_connect);a(this._onmousedrag_connect);a(this._onmouseout_connect);a(this._onmousedown_connect);a(this._onmouseup_connect);a(this._onclick_connect);a(this._ondblclick_connect);this._mouseEvents=!1}}});p._GraphicsContainer=w;p._GraphicsLayer=E;return p})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(p,f,b){f.switchTo(b);return f})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang",
"dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(p,f,b,m,l){var h=null;b.add("vml",function(b,f,g){g.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';b="adj"in g.firstChild;g.innerHTML="";return b});return{load:function(r,n,g){function e(){n(["dojox/gfx/"+c],function(a){p.renderer=c;h=a;g(a)})}if(h&&"force"!=r)g(h);else{var c=l.forceGfxRenderer;r=!c&&(f.isString(l.gfxRenderer)?l.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var a,u;!c&&r.length;)switch(r.shift()){case "svg":"SVGAngle"in
m.global&&(c="svg");break;case "vml":b("vml")&&(c="vml");break;case "silverlight":try{b("ie")?(a=new ActiveXObject("AgControl.AgControl"),a.IsVersionSupported("1.0"))&&(u=!0):navigator.plugins["Silverlight Plug-In"]&&(u=!0)}catch(v){u=!1}finally{a=null}u&&(c="silverlight");break;case "canvas":m.global.CanvasRenderingContext2D&&(c="canvas")}"canvas"===c&&!1!==l.canvasEvents&&(c="canvasWithEvents");l.isDebug&&console.log("gfx renderer \x3d "+c);"svg"==c&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(e):
e()}}}})},"esri/layers/gfxSniff":function(){define(["dojo/has","dojox/gfx"],function(p,f){p.add("esri-svg",function(){return-1!==f.renderer.toLowerCase().indexOf("svg")});return p})},"esri/layers/layer":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/Deferred dojo/_base/json dojo/has ../Evented ../kernel ../lang ../request ../deferredUtils ../urlUtils ../SpatialReference ../geometry/Extent".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){var k=
p([n],{declaredClass:"esri.layers.Layer",_eventMap:{error:["error"],load:["layer"],"opacity-change":["opacity"],"update-end":["error"],"visibility-change":["visible"]},constructor:function(a,c){this._attrs={};a&&m.isString(a)?this._url=u.urlToObject(this.url=a):(this.url=this._url=null,(c=c||a)&&(c.layerDefinition||c.query)&&(c=null));this.spatialReference=new v(4326);this.initialExtent=new q(-180,-90,180,90,new v(4326));this._map=this._div=null;this.normalization=!0;c&&(c.id&&(this.id=c.id),!1===
c.visible&&(this.visible=!1),e.isDefined(c.opacity)&&(this.opacity=c.opacity),e.isDefined(c.minScale)&&this.setMinScale(c.minScale),e.isDefined(c.maxScale)&&this.setMaxScale(c.maxScale),this.attributionDataUrl=c.attributionDataUrl||"",this.hasAttributionData=!!this.attributionDataUrl,e.isDefined(c.showAttribution)&&(this.showAttribution=c.showAttribution),this.className=c.className,this.refreshInterval=c.refreshInterval||0);this._errorHandler=m.hitch(this,this._errorHandler);this.refresh=m.hitch(this,
this.refresh);if(this.managedSuspension){var d=this._setMap;this._setMap=function(a){var c=d.apply(this,arguments);this.evaluateSuspension();if(this.suspended&&!a.loaded)var e=b.connect(a,"onLoad",this,function(){b.disconnect(e);e=null;this.evaluateSuspension()});return c}}this.registerConnectEvents()},id:null,visible:!0,opacity:1,loaded:!1,loadError:null,minScale:0,maxScale:0,visibleAtMapScale:!1,suspended:!0,attributionDataUrl:"",hasAttributionData:!1,showAttribution:!0,refreshInterval:0,_errorHandler:function(a){this.loaded||
(this.loadError=a);this.onError(a)},_setMap:function(a,c,e,k){this._map=a;this._lyrZEHandle=b.connect(a,"onZoomEnd",this,this._processMapScale);if(a.loaded)this.visibleAtMapScale=this._isMapAtVisibleScale();else var d=b.connect(a,"onLoad",this,function(){b.disconnect(d);d=null;this._processMapScale()})},_unsetMap:function(a,c){b.disconnect(this._lyrZEHandle);this._toggleRT();this._map=this._lyrZEHandle=null;this._resumedOnce=void 0;this.suspended=!0},_cleanUp:function(){this._map=this._div=null},
_fireUpdateStart:function(){this.updating||(this.updating=!0,this.attr("data-updating",""),this._toggleRT(),this.onUpdateStart(),this._map&&this._map._incr())},_fireUpdateEnd:function(a,c){this.updating&&(this.updating=!1,this.attr("data-updating"),this._toggleRT(!0),this.onUpdateEnd(a,c),this._map&&this._map._decr())},_getToken:function(){var a=this._url,c=this.credential;return a&&a.query&&a.query.token||c&&c.token||void 0},_findCredential:function(){this.credential=g.id&&this._url&&g.id.findCredential(this._url.path)},
_useSSL:function(){var a=this._url,c=/^http:/i;this.url&&(this.url=this.url.replace(c,"https:"));a&&a.path&&(a.path=a.path.replace(c,"https:"))},refresh:function(){},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setMinScale:function(a){this.setScaleRange(a)},setMaxScale:function(a){this.setScaleRange(null,a)},setScaleRange:function(a,c){var d=e.isDefined(a),b=e.isDefined(c);this.loaded||(this._hasMin=this._hasMin||d,this._hasMax=this._hasMax||b);var k=this.minScale,
g=this.maxScale;this.minScale=(d?a:this.minScale)||0;this.maxScale=(b?c:this.maxScale)||0;if(k!==this.minScale||g!==this.maxScale)this.onScaleRangeChange(),this._processMapScale()},suspend:function(){this._suspended=!0;this.evaluateSuspension()},resume:function(){this._suspended=!1;this.evaluateSuspension()},canResume:function(){return this.loaded&&this._map&&this._map.loaded&&this.visible&&this.visibleAtMapScale&&!this._suspended},evaluateSuspension:function(){this.canResume()?this.suspended&&this._resume():
this.suspended||this._suspend()},_suspend:function(){this.suspended=!0;this.attr("data-suspended","");this._toggleRT();this.onSuspend();if(this._map)this._map.onLayerSuspend(this)},_resume:function(){this.suspended=!1;this.attr("data-suspended");var a=void 0===this._resumedOnce,c=this.className,b=this._attrs,e=this.getNode(),k;if(a){this._resumedOnce=!0;if(c&&e){var g=e.getAttribute("class")||"";(new RegExp("(^|\\s)"+c+"(\\s|$)","i")).test(g)||e.setAttribute("class",g+((g?" ":"")+c))}if(b&&e)for(k in b)b.hasOwnProperty(k)&&
e.setAttribute(k,b[k])}this._toggleRT(!0);this.onResume({firstOccurrence:a});if(this._map)this._map.onLayerResume(this)},_processMapScale:function(){var a=this.visibleAtMapScale;this.visibleAtMapScale=this._isMapAtVisibleScale();a!==this.visibleAtMapScale&&(this.onScaleVisibilityChange(),this.evaluateSuspension())},isVisibleAtScale:function(a){return a?k.prototype._isMapAtVisibleScale.apply(this,arguments):!1},_isMapAtVisibleScale:function(a,c){if(!(a||this._map&&this._map.loaded))return!1;var d=
this._map;a=a||d.getScale();var b=this.minScale,e=this.maxScale,k=!b,g=!e,f;c&&(f=d.width>d.height?d.width:d.height);k||(a<=b?k=!0:c&&(k=Math.abs(b-a)/b<1/f));g||(a>=e?g=!0:c&&(g=Math.abs(e-a)/e<1/f));return k&&g},getAttributionData:function(){var d=this.attributionDataUrl,b=new l(a._dfdCanceller);this.hasAttributionData&&d?(b._pendingDfd=c({url:d,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),b._pendingDfd.then(function(a){b.callback(a)},function(a){b.errback(a)})):(d=Error("Layer does not have attribution data"),
d.log=f.isDebug,b.errback(d));return b},getResourceInfo:function(){var a=this.resourceInfo;return m.isString(a)?h.fromJson(a):m.clone(a)},getMap:function(){return this._map},getNode:function(){return this._div},attr:function(a,c){var d=this.getNode();if("data-reference"===a&&11>r("ie"))return this;d&&(null==c?d.removeAttribute(a):d.setAttribute(a,c));this._attrs&&(null==c?delete this._attrs[a]:this._attrs[a]=c);return this},setRefreshInterval:function(a){var c=this.refreshInterval;this.refreshInterval=
a;this._toggleRT();a&&(this.updating||this.suspended||this._toggleRT(!0));if(c!==a)this.onRefreshIntervalChange();return this},_toggleRT:function(a){a&&this.refreshInterval?(clearTimeout(this._refreshT),this._refreshT=setTimeout(this.refresh,6E4*this.refreshInterval)):this._refreshT&&(clearTimeout(this._refreshT),this._refreshT=null)},setNormalization:function(a){this.normalization=a},setVisibility:function(a){this.visible!==a&&(this.visible=a,this.onVisibilityChange(this.visible),this.evaluateSuspension());
this.attr("data-hidden",a?null:"")},onLoad:function(){},onVisibilityChange:function(){},onScaleRangeChange:function(){},onScaleVisibilityChange:function(){},onSuspend:function(){},onResume:function(){},onUpdate:function(){},onUpdateStart:function(){},onUpdateEnd:function(){},onRefreshIntervalChange:function(){},onError:function(){}});return k})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(p,f,b,m,l){var h={show:function(b){if(b=
h.getNode(b))b.style.display="block"},getNode:function(b){return b&&b.domNode||b},hide:function(b){if(b=h.getNode(b))b.style.display="none"},toggle:function(b){if(b=h.getNode(b))b.style.display="none"===b.style.display?"block":"none"},documentBox:8>=l("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(b){if(b=this.getNode(b)){var h=0,g=0,e=0,c=0,a=0,u=0;return[f.connect(b,"ontouchstart",function(f){h=
f.touches[0].screenX;g=f.touches[0].screenY;e=b.scrollWidth;c=b.scrollHeight;a=b.clientWidth;u=b.clientHeight}),f.connect(b,"ontouchmove",function(f){f.preventDefault();var q=b.firstChild;q instanceof Text&&(q=b.childNodes[1]);var k=q._currentX||0,d=q._currentY||0,k=k+(f.touches[0].screenX-h);0<k?k=0:0>k&&Math.abs(k)+a>e&&(k=-1*(e-a));q._currentX=k;d+=f.touches[0].screenY-g;0<d?d=0:0>d&&Math.abs(d)+u>c&&(d=-1*(c-u));q._currentY=d;m.set(q,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+
k+"px, "+d+"px)"});h=f.touches[0].screenX;g=f.touches[0].screenY})]}}};return h})},"esri/symbols/MarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(p,f,b,m,l,h){return p(h,{declaredClass:"esri.symbol.MarkerSymbol",angle:0,xoffset:0,yoffset:0,size:12,constructor:function(b){b&&f.isObject(b)&&(this.size="auto"===this.size?this.size:m.pt2px(this.size),this.xoffset=m.pt2px(this.xoffset),this.yoffset=m.pt2px(this.yoffset),
this.angle&&(this.angle*=-1))},setAngle:function(b){this.angle=b;return this},setSize:function(b){this.size=b;return this},setOffset:function(b,f){this.xoffset=b;this.yoffset=f;return this},toJson:function(){var b=m.px2pt(this.size),b=isNaN(b)?void 0:b,h=m.px2pt(this.xoffset),h=isNaN(h)?void 0:h,g=m.px2pt(this.yoffset),g=isNaN(g)?void 0:g;return f.mixin(this.inherited("toJson",arguments),{size:"auto"===this.size?this.size:b,angle:this.angle&&-1*this.angle,xoffset:h,yoffset:g})}})})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),
function(p,f,b,m,l,h){return p(null,{declaredClass:"esri.symbol.Symbol",color:new h([0,0,0,1]),type:null,constructor:function(b){b&&f.isObject(b)&&(f.mixin(this,b),this.color&&l.isDefined(this.color[0])&&(this.color=h.toDojoColor(this.color)),(b=this.type)&&0===b.indexOf("esri")&&(this.type={esriSMS:"simplemarkersymbol",esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[b]))},
setColor:function(b){this.color=b;return this},toJson:function(){return{color:h.toJsonColor(this.color)}}})})},"esri/symbols/SimpleMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./MarkerSymbol ./SimpleLineSymbol".split(" "),function(p,f,b,m,l,h,r,n,g){var e={STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"},c={style:e.STYLE_CIRCLE,
color:[255,255,255,.25],size:12,angle:0,xoffset:0,yoffset:0};p=p(n,{declaredClass:"esri.symbol.SimpleMarkerSymbol",type:"simplemarkersymbol",_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},constructor:function(a,u,v,q){a?f.isString(a)?(this.style=a,u&&(this.size=u),v&&(this.outline=v),q&&(this.color=q)):(this.style=r.valueOf(this._styles,this.style),a.outline&&(this.outline=new g(a.outline))):(f.mixin(this,c),this.size=
l.pt2px(this.size),this.outline=new g(this.outline),this.color=new b(this.color));this.style||(this.style=e.STYLE_CIRCLE)},setStyle:function(a){this.style=a;return this},setPath:function(a){this.path=a;this.setStyle(e.STYLE_PATH);return this},setOutline:function(a){this.outline=a;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return this.color},_setDim:function(a,c,b){this._targetWidth=a;this._targetHeight=c;this._spikeSize=b},getShapeDescriptors:function(){var a,
b,g,f=this.style,k=(this.size||l.pt2px(c.size))/2,d=0-k,w=0+k,t=0-k,h=0+k;switch(f){case e.STYLE_CIRCLE:a={type:"circle",cx:0,cy:0,r:k};b=this.getFill();if(g=this.getStroke())g.style=g.style||"Solid";break;case e.STYLE_CROSS:a={type:"path",path:"M "+d+",0 L "+w+",0 M 0,"+t+" L 0,"+h+" E"};b=null;g=this.getStroke();break;case e.STYLE_DIAMOND:a={type:"path",path:"M "+d+",0 L 0,"+t+" L "+w+",0 L 0,"+h+" L "+d+",0 Z"};b=this.getFill();g=this.getStroke();break;case e.STYLE_SQUARE:a={type:"path",path:"M "+
d+","+h+" L "+d+","+t+" L "+w+","+t+" L "+w+","+h+" L "+d+","+h+" Z"};b=this.getFill();g=this.getStroke();break;case e.STYLE_X:a={type:"path",path:"M "+d+","+h+" L "+w+","+t+" M "+d+","+t+" L "+w+","+h+" E"};b=null;g=this.getStroke();break;case e.STYLE_PATH:a={type:"path",path:this.path||""},b=this.getFill(),g=this.getStroke()}return{defaultShape:a,fill:b,stroke:g}},toJson:function(){var a=this.style,c=this.outline,b=f.mixin(this.inherited("toJson",arguments),{type:"esriSMS",style:this._styles[a]});
c&&(b.outline=c.toJson());"x"!==a&&"cross"!==a||delete b.color;b.path=this.path;return r.fixJson(b)}});f.mixin(p,e);p.defaultProps=c;return p})},"esri/symbols/SimpleLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./LineSymbol".split(" "),function(p,f,b,m,l,h,r,n){var g={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_SHORTDASH:"shortdash",
STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot"},e={color:[0,0,0,1],style:g.STYLE_SOLID,width:1};p=p(n,{declaredClass:"esri.symbol.SimpleLineSymbol",type:"simplelinesymbol",_styles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",none:"esriSLSNull",insideframe:"esriSLSInsideFrame",shortdash:"esriSLSShortDash",shortdot:"esriSLSShortDot",
shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot"},constructor:function(c,a,u){c?f.isString(c)?(this.style=c,a&&(this.color=a),u&&(this.width=u)):this.style=r.valueOf(this._styles,c.style)||g.STYLE_SOLID:(f.mixin(this,e),this.color=new b(this.color),this.width=l.pt2px(this.width))},setStyle:function(c){this.style=c;return this},getStroke:function(){return this.style===g.STYLE_NULL||0===this.width?null:{color:this.color,
style:this.style,width:this.width}},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){return r.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriSLS",style:this._styles[this.style]}))}});f.mixin(p,g);p.defaultProps=e;return p})},"esri/symbols/LineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),
function(p,f,b,m,l,h){return p(h,{declaredClass:"esri.symbol.LineSymbol",constructor:function(b){f.isObject(b)?this.width=m.pt2px(this.width):this.width=12},setWidth:function(b){this.width=b;return this},toJson:function(){var b=m.px2pt(this.width),b=isNaN(b)?void 0:b;return f.mixin(this.inherited("toJson",arguments),{width:b})}})})},"esri/layers/TileInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../SpatialReference ../geometry/Point ./LOD".split(" "),
function(p,f,b,m,l,h,r,n,g){return p(null,{declaredClass:"esri.layers.TileInfo",constructor:function(e){f.mixin(this,e);this.width=this.cols;this.height=this.rows;e=this.spatialReference;var c=this.origin;e&&(e=this.spatialReference=new r(e.toJson?e.toJson():e));c&&(this.origin=new n(c.toJson?c.toJson():c),!c.spatialReference&&e&&this.origin.setSpatialReference(new r(e.toJson())));this.lods=b.map(this.lods,function(a){return new g(a)})},toJson:function(){return h.fixJson({rows:this.rows,cols:this.cols,
dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin&&this.origin.toJson(),spatialReference:this.spatialReference&&this.spatialReference.toJson(),lods:this.lods&&b.map(this.lods,function(b){return b.toJson()})})}})})},"esri/layers/LOD":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,f,b,m,l){return p(null,{declaredClass:"esri.layers.LOD",constructor:function(b){f.mixin(this,b)},toJson:function(){return l.fixJson({level:this.level,
levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}})})},"esri/layers/ArcGISTiledMapServiceLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/io-query ../kernel ../urlUtils ../SpatialReference ./TiledMapServiceLayer ./ArcGISMapServiceLayer ./TileInfo ./TimeInfo ./TileMap".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){return f([c,a],{declaredClass:"esri.layers.ArcGISTiledMapServiceLayer",_agolAttrs:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),
_isReference:!1,_referenceLayers:"Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Reference_Overlay Reference/World_Transportation".split(" "),constructor:function(a,c){c&&(c.roundrobin&&(p.deprecated(this.declaredClass+" : Constructor option 'roundrobin' deprecated. Use option 'tileServers'."),c.tileServers=c.roundrobin),this._setTileServers(c.tileServers),
this._loadCallback=c.loadCallback);this._params=b.mixin({},this._url.query);this._initLayer=b.hitch(this,this._initLayer);var d=c&&c.resourceInfo;d?this._initLayer(d):(this._load=b.hitch(this,this._load),this._load())},_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_setTileServers:function(a){if(a&&0<a.length){this.tileServers=a;var c,b=a.length;for(c=0;c<b;c++)a[c]=g.urlToObject(a[c]).path}},_initLayer:function(a,c){this.inherited(arguments);this.resourceInfo=
l.toJson(a);this.tileInfo=new u(a.tileInfo);!1!==this.resampling&&(a.capabilities&&-1<a.capabilities.indexOf("Tilemap")?(this.resampling=!0,this.tileMap=new q(this)):this.resampling=!!a.resampling);!this.spatialReference&&this.tileInfo.spatialReference&&(this.spatialReference=new e(this.tileInfo.spatialReference.toJson()));this.isPNG32="PNG24"===this.tileInfo.format||"PNG32"===this.tileInfo.format;a.timeInfo&&(this.timeInfo=new v(a.timeInfo));a.mensurationCapabilities&&(this.mensurationCapabilities=
a.mensurationCapabilities);var d=this._url.path,b=this._loadCallback,k=g.getProtocolForWebResource(!0),f=d.match(/^https?\:\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i),f=f&&f[2];if(!this.tileServers)if(a.tileServers)this._setTileServers(a.tileServers);else{var h=-1!==d.search(/^https?\:\/\/server\.arcgisonline\.com/i),n=-1!==d.search(/^https?\:\/\/services\.arcgisonline\.com/i);(h||n)&&this._setTileServers([d,d.replace(h?/server\.arcgisonline/i:
/services\.arcgisonline/i,h?"services.arcgisonline":"server.arcgisonline")])}if(f){f=f.toLowerCase();for(d=0;d<this._agolAttrs.length;d++)if(h=this._agolAttrs[d],h.toLowerCase()===f){this.hasAttributionData=!0;this.attributionDataUrl=this.attributionDataUrl||k+"//static.arcgis.com/attribution/"+h;break}for(d=0;d<this._referenceLayers.length;d++)if(h=this._referenceLayers[d],h.toLowerCase()===f){this._isReference=!0;break}}this.loaded=!0;this.onLoad(this);b&&(delete this._loadCallback,b(this))},getTileUrl:function(a,
c,b){var d=this.tileServers,e=this._getToken(),k=this._url.query;a=(d?d[c%d.length]:this._url.path)+"/tile/"+a+"/"+c+"/"+b;a=g.upgradeToHTTPS(a);this.resampling&&!this.tileMap&&(a+="?blankTile\x3dfalse");k&&(a=this.resampling&&!this.tileMap?a+("\x26"+r.objectToQuery(k)):a+("?"+r.objectToQuery(k)));!e||k&&k.token||(a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+e);a=this.addTimestampToURL(a);return g.addProxy(a)}})})},"esri/layers/TiledMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/url dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/dom dojox/collections/ArrayList dojox/gfx/matrix ../kernel ../config ../sniff ../domUtils ../tileUtils ../geometry/Point ../geometry/Rect ../geometry/Extent ./layer".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A){return p(A,{declaredClass:"esri.layers.TiledMapServiceLayer",constructor:function(a,c){f.connect(this,"onLoad",this,"_initTiledLayer");this._lowestLevel=(this._displayLevels=c?c.displayLevels:null)?this._displayLevels[0]:0;this.resampling=c?c.resampling:void 0;this._resamplingTolerance=c?c.resamplingTolerance:null;this.exclusionAreas=c?c.exclusionAreas:null;var d=b.hitch;this._addImage=d(this,this._addImage);this._tileLoadHandler=d(this,this._tileLoadHandler);
this._tileErrorHandler=d(this,this._tileErrorHandler);this._popTile=d(this,this._popTile);this._cleanUpRemovedImages=d(this,this._cleanUpRemovedImages);this._fireOnUpdateEvent=d(this,this._fireOnUpdateEvent);this._transitionEnd=d(this,this._transitionEnd);this._tileMapCallback=d(this,this._tileMapCallback)},opacity:1,isPNG32:!1,_multiple:1,isResampling:!1,_initTiledLayer:function(){var a=this.tileInfo,c=a.lods;this.resampling=null!=this.resampling?this.resampling:!1;this._tileW=a.width;this._tileH=
a.height;var b=this.scales=[],e=this._displayLevels,k=-Infinity,g=Infinity,t=this.fullExtent,f=new w(t.xmin,t.ymax),t=new w(t.xmax,t.ymin),u=d.getContainingTileCoords,v,h,n,x=c.length;for(n=0;n<x;n++)h=c[n],v=u(a,f,h),h.startTileRow=0>v.row?0:v.row,h.startTileCol=0>v.col?0:v.col,v=u(a,t,h),h.endTileRow=v.row,h.endTileCol=v.col,e&&-1===m.indexOf(e,h.level)||(b[n]=h.scale,k=h.scale>k?h.scale:k,g=h.scale<g?h.scale:g);-Infinity===k||this._hasMin||this.setMinScale(k);Infinity===g||this._hasMax||this.setMaxScale(g);
this.setExclusionAreas(this.exclusionAreas);this._patchIE=6<=q("ie")&&7>q("ie")&&(this.isPNG32||"Mixed"===a.format)},isVisibleAtScale:function(a){return a?A.prototype._isMapAtVisibleScale.call(this,a,!0):!1},_isMapAtVisibleScale:function(a){var c=this.inherited(arguments,[a,!0]);if(c){var d;d=this._map;var c=this.scales,b=d.getScale(),e=!1,k=d.width>d.height?d.width:d.height;for(d=0;d<c.length;d++)if(Math.abs(c[d]-b)/c[d]<1/k){e=!0;break}c=e}return c},_setMap:function(a,c,b,e){this.inherited(arguments);
this._map=a;var k=this._div=h.create("div",null,c),t=a.__visibleDelta,q=f.connect,w=u._css.names,n={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},x=v.defaults.map.zoomDuration;"css-transforms"===a.navigationMode?(n[w.transform]=u._css.translate(-t.x,-t.y),g.set(k,n),delete n[w.transform],n[w.transition]=w.transformName+" "+x+"ms ease",g.set(this._active=h.create("div",null,k),n),this._active._remove=0,this._passives=[]):(n.left=-t.x+"px",n.top=-t.y+"px",g.set(k,n));
this._onResizeHandler_connect=q(a,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=q(this,"onOpacityChange",this,"_opacityChangeHandler");t=this.tileInfo;q=t.spatialReference;w=q._getInfo();(this._wrap=a.wrapAround180&&q._isWrappable()&&Math.abs(w.origin[0]-t.origin.x)<=w.dx)&&d._addFrameInfo(t,w);this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension();if(this.suspended&&!a.loaded)var l=f.connect(a,"onLoad",this,function(){f.disconnect(l);l=null;this.setExclusionAreas(this.exclusionAreas);
this.evaluateSuspension()});return k},_unsetMap:function(a,c){this.suspended||this._suspendImpl();h.destroy(this._div);this._map=this._div=null;var d=f.disconnect;d(this._onResizeHandler_connect);d(this._opacityChangeHandler_connect);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(){k.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();var a=this._tiles,c=this._tileIds,d=this._loadingList,
b,e,g=f.disconnect,t=h.destroy;d&&0<d.count&&(d.forEach(function(c){if(b=a[c])g(b._onload_connect),g(b._onerror_connect),g(b._onabort_connect),b._onload_connect=b._onerror_connect=b._onabort_connect=null}),d.clear(),this._fireUpdateEnd());this._removeList.clear();for(d=c.length-1;0<=d;d--)(b=(e=c[d])&&a[e])&&t(b);if("css-transforms"===this._map.navigationMode){c=this._active;e=this._passives;var q;this._noDom=0;for(d=e.length-1;0<=d;d--)q=e[d],q._endHandle&&g(q._endHandle),q._matrix=q._multiply=q._endHandle=
null,q._marked=q._remove=0,e.splice(d,1),t(q);c._matrix=c._multiply=null;c._marked=c._remove=0}this._tileIds=this._tiles=this._tileBounds=this._ct=this._loadingList=this._removeList=this._standby=null},onResume:function(){this.inherited(arguments);this._tileIds=[];this._tiles=[];this._tileBounds=[];this._ct=null;this._removeList=new c;this._loadingList=new c;k.show(this._div);this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(b.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,
null,!0,this._map.__LOD)}),0)},_enableDrawConnectors:function(){var a=this._map,c=f.connect;if("css-transforms"===a.navigationMode){if(this._onScaleHandler_connect=c(a,"onScale",this,this._onScaleHandler),q("esri-mobile")){this._standby=[];var d=this,b=function(){d._noDom=1};this._onPanStartHandler_connect=c(a,"onPanStart",b);this._onZoomStartHandler_connect=c(a,"onZoomStart",b)}}else this._onZoomHandler_connect=c(a,"onZoom",this,"_onZoomHandler");this._onPanHandler_connect=c(a,"onPan",this,"_onPanHandler");
this._onExtentChangeHandler_connect=c(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=f.disconnect;a(this._onPanHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onPanStartHandler_connect);a(this._onZoomStartHandler_connect);this._onPanHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=this._onExtentChangeHandler_connect=this._onPanStartHandler_connect=this._onZoomStartHandler_connect=
null},_onResizeHandler:function(a,c,d){a={width:c+"px",height:d+"px"};c=g.set;c(this._div,a);if("css-transforms"===this._map.navigationMode)for(this._active&&c(this._active,a),d=this._passives.length-1;0<=d;d--)c(this._passives[d],a)},_onExtentChangeHandler:function(c,b,e,k){b=this._map;var f=this._standby,q;clearTimeout(this._wakeTimer);this._wakeTimer=null;if(!b._isPanningOrZooming()){if("css-transforms"===b.navigationMode){if(e)for(k=this._passives.length-1;0<=k;k--)q=this._passives[k],g.set(q,
u._css.names.transition,"none"),q._marked?(this._passives.splice(k,1),q.parentNode&&q.parentNode.removeChild(q),h.destroy(q)):0<q.childNodes.length&&(q._multiply=q._multiply?a.multiply(q._matrix,q._multiply):q._matrix);this._noDom=0;if(f&&f.length)for(k=f.length-1;0<=k;k--)q=f[k],g.set(q,"visibility","inherit"),this._popTile(q),f.splice(k,1)}this._fireUpdateStart();this._rrIndex=0;k=d.getCandidateTileInfo(b,this.tileInfo,c);c=b.__visibleDelta;if(!this._ct||k.lod.level!==this._ct.lod.level||e){q=k&&
this._ct&&k.lod.level!==this._ct.lod.level;this._ct=k;var v=this._tiles,w=this._tileIds,x=this._tileBounds,l=this._removeList,m,r=w.length;this._cleanUpRemovedImages();for(k=0;k<r;k++)f=w[k],m=v[f],x[f]=w[k]=null,"css-transforms"===b.navigationMode&&q&&m.parentNode&&b.fadeOnZoom&&(m._fadeOut=q,m.parentNode._remove++),l.add(m);e&&(this._tileIds=[],this._tiles=[],this._tileBounds=[])}k=c.x;e=c.y;"css-transforms"===b.navigationMode?(f={},f[u._css.names.transform]=u._css.translate(k,e),g.set(this._div,
f)):g.set(this._div,{left:k+"px",top:e+"px"});this.__coords_dx=k;this.__coords_dy=e;this._updateImages(new t(0,0,c.width,c.height));0===this._loadingList.count?(this._cleanUpRemovedImages(),this.onUpdate(),this._fireUpdateEnd()):this._fireOnUpdate=!0;e=this._tileW;v=this._tileH;c=new t(-c.x,-c.y,c.width,c.height);for(k=this._tileIds.length-1;0<=k;k--)(f=this._tileIds[k])?(q=this._tiles[f],w=n.getMarginBox(q),w=new t(w.l,w.t,e,v),"css-transforms"===b.navigationMode&&(w.x=q._left,w.y=q._top),c.intersects(w)?
this._tileBounds[f]=w:(this._loadingList.contains(f)&&this._popTile(q),h.destroy(q),this._tileIds.splice(k,1),delete this._tileBounds[f],delete this._tiles[f])):(this._tileIds.splice(k,1),delete this._tileBounds[f],delete this._tiles[f])}},_onPanHandler:function(a,c){var d=this._map,b=d.__visibleDelta.offset(c.x,c.y);this.__coords_dx=this.__coords_dy=0;"css-transforms"===d.navigationMode?(d={},d[u._css.names.transform]=u._css.translate(b.x,b.y),g.set(this._div,d),q("esri-mobile")||this._updateImages({x:-b.x,
y:-b.y,width:b.width,height:b.height})):(g.set(this._div,{left:b.x+"px",top:b.y+"px"}),this._updateImages({x:-b.x,y:-b.y,width:b.width,height:b.height}));0<this._loadingList.count&&(this._fireUpdateStart(),this._fireOnUpdate=!0)},_onScaleHandler:function(c,d){var b,e={},k=u._css.names,t=this._map,f=v.defaults.map.zoomDuration;for(b=this._passives.length-1;0<=b;b--){var q=this._passives[b];0===q.childNodes.length?(this._passives.splice(b,1),h.destroy(q)):("none"===q.style[k.transition]&&g.set(q,k.transition,
k.transformName+" "+f+"ms ease"),g.set(q,k.transition,d?"none":k.transformName+" "+f+"ms ease"),q._matrix=c,e[k.transform]=u._css.matrix(q._multiply?a.multiply(c,q._multiply):c),g.set(q,e))}this._active&&0===this._active.childNodes.length||(g.set(this._active,k.transition,d?"none":k.transformName+" "+f+"ms ease"),this._active._matrix=c,e[k.transform]=u._css.matrix(this._active._matrix),g.set(this._active,e),this._passives.push(this._active),e={position:"absolute",width:t.width+"px",height:t.height+
"px",overflow:"visible"},e[k.transition]=k.transformName+" "+f+"ms ease",g.set(this._active=h.create("div",null,this._div),e),this._active._remove=0,t.fadeOnZoom&&h.place(this._active,this._div,"first"))},_onZoomHandler:function(a,c,d){a=n.getMarginBox(this._div);d=d.offset(-a.l,-a.t);this._previousScale&&1!==c||(this._previousScale=1);var b,e=this._tileW*c,k=this._tileH*c,t=this._tileBounds,f=this._tiles,u=this._previousScale,v=this._multiple,w=g.set,h,x;if((a=q("ie"))&&8>a)m.forEach(this._tileIds,
function(a){x="";b=t[a];h=f[a].style.margin.split(" ");m.forEach(h,function(a){""!==x&&(x+=" ");a=parseFloat(a);x+=a/u*c+"px"});w(f[a],{left:b.x-(e-b.width)*(d.x-b.x)/b.width+"px",top:b.y-(k-b.height)*(d.y-b.y)/b.height+"px",margin:1!==v&&-1===x.indexOf("NaN")?x:"",zoom:c})});else{var l=e*v,r=k*v,y,A;m.forEach(this._tileIds,function(a){x="";b=t[a];y=b.x-(e-b.width)*(d.x-b.x)/b.width;A=b.y-(k-b.height)*(d.y-b.y)/b.height;h=f[a].style.margin.split(" ");m.forEach(h,function(a){""!==x&&(x+=" ");a=parseFloat(a);
x+=a/u*c+"px"});w(f[a],{left:y+"px",top:A+"px",margin:1!==v&&-1===x.indexOf("NaN")?x:"",width:l+"px",height:r+"px"})})}this._previousScale=c},_updateImages:function(a){if(this._ct){var c,d=this._tileW,b=this._tileH,e=this._ct;c=e.lod;var e=e.tile,k=e.offsets,g=e.coords,t=g.row,g=g.col,f=c.level,q=this.opacity,u=this._tileIds,v=this._loadingList,w=this._addImage,h=this._map.id,n=this.id,x=a.x,l=a.y,r=c.startTileRow,y=c.endTileRow,A=c.startTileCol,p=c.endTileCol,ja=m.indexOf,na,ca,ea=k.x-this.__coords_dx,
ua=k.y-this.__coords_dy;ca=d-ea+-a.x;var ha=b-ua+-a.y;na=Math.ceil;ca=0<ca?ca%d:d-Math.abs(ca)%d;ha=0<ha?ha%b:b-Math.abs(ha)%b;x=0<x?Math.floor((x+ea)/d):na((x-(d-ea))/d);l=0<l?Math.floor((l+ua)/b):na((l-(b-ua))/b);ua=x+na((a.width-ca)/d);a=l+na((a.height-ha)/b);var oa,la,va;this._wrap&&(oa=c._frameInfo,la=oa[0],va=oa[1],oa=oa[2]);for(ha=x;ha<=ua;ha++)for(x=l;x<=a;x++)na=t+x,ca=g+ha,this._wrap&&(ca<va?(ca%=la,ca=ca<va?ca+la:ca):ca>oa&&(ca%=la)),!this._isExcluded(f,na,ca)&&na>=r&&na<=y&&ca>=A&&ca<=
p&&(c=h+"_"+n+"_tile_"+f+"_"+x+"_"+ha,-1===ja(u,c)&&(v.add(c),u.push(c),w(f,x,na,ha,ca,c,d,b,q,e,k)))}},_cleanUpRemovedImages:function(){var a=this._removeList,c=h.destroy,d,b=u._css.names;a.forEach(function(a){a._fadeOut||(a.style.filter="",a.style.zoom=1,c(a))});if("css-transforms"===this._map.navigationMode)for(d=this._passives.length-1;0<=d;d--){var e=this._passives[d];0===e.childNodes.length?(this._passives.splice(d,1),c(e)):this._map.fadeOnZoom&&!e._marked&&e._remove===e.childNodes.length&&
(e._marked=1,2048>u._css.getScaleFromMatrix(g.get(e,b.transform))?(g.set(e,b.transition,"opacity 0.65s"),g.set(e,"opacity",0),f.disconnect(e._endHandle),e._endHandle=f.connect(e,b.endEvent,this._transitionEnd)):this._transitionEnd({propertyName:"opacity",target:e}))}a.clear()},_transitionEnd:function(a){var c=a.target;"opacity"===a.propertyName&&(f.disconnect(c._endHandle),c._endHandle=null,a=m.indexOf(this._passives,c),-1<a&&this._passives.splice(a,1),c.parentNode&&c.parentNode.removeChild(c),h.destroy(c))},
_addImage:function(a,c,d,e,k,t,q,v,w,x,n){if(this._patchIE)x=this._tiles[t]=h.create("div"),x.id=t,r.add(x,"layerTile"),g.set(x,{left:q*e-n.x+"px",top:v*c-n.y+"px",width:q+"px",height:v+"px",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this.getTileUrl(a,d,k)+"', sizingMethod\x3d'scale')"}),1>w&&g.set(x,"opacity",w),a=x.appendChild(h.create("div")),g.set(a,{opacity:0,width:q+"px",height:v+"px"}),this._div.appendChild(x),x=null,this._loadingList.remove(t),this._fireOnUpdateEvent();
else{x=this._tiles[t]=h.create("img");var l=f.connect;x.id=t;x._uid=a+"_"+d+"_"+k;x.alt="";r.add(x,"layerTile");e=q*e-n.x;n=v*c-n.y;c=this._map;var m=u._css.names;q={width:q+"px",height:v+"px",visibility:"hidden"};"css-transforms"===c.navigationMode?(q[m.transform]=u._css.translate(e,n),g.set(x,q),x._left=e,x._top=n):(q.left=e+"px",q.top=n+"px",g.set(x,q));1>w&&g.set(x,"opacity",w);x._onload_connect=l(x,"onload",this,"_tileLoadHandler");x._onerror_connect=l(x,"onerror",b.hitch(this,"_tileErrorHandler",
d,k));x._onabort_connect=l(x,"onabort",this,"_tileAbortHandler");if(this.tileMap)this.tileMap.getTile(a,d,k,t,this._tileMapCallback);else if(t=this.getTileUrl(a,d,k,x))this._failedRequests&&this._failedRequests[t]?(g.set(x,this._failedRequests[t].css),x.src=this._failedRequests[t].src,this._multiple=parseInt(this._failedRequests[t].css.width)/this._tileW,this.isResampling=1!==this._multiple):(this._multiple=1,this.isResampling=!1,x.src=t);"css-transforms"===c.navigationMode?this._active.appendChild(x):
this._div.appendChild(x);x=null}},_tileMapCallback:function(a,c){var d,b;this.suspended||(b=this._tiles[c.id]||e.byId(c.id),d=c.level+"_"+c.row+"_"+c.col,b&&b._uid===d?(this._multiple=2*(c.level-a.level)||1,this.isResampling=1!==this._multiple,d=this.tileMap.style(a,c),g.set(b,d),b.src=this.getTileUrl(a.level,a.row,a.col)):this._popTile(c))},getTileUrl:function(a,c,d){},_reCheckTS:/[\?\&]_ts=/ig,_reReplaceTS:/([\?\&]_ts=)[0-9]+/ig,addTimestampToURL:function(a){var c=this._refreshTS;c&&(a=this._reCheckTS.test(a)?
a.replace(this._reReplaceTS,"$$$1"+c):a+((-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+c));return a},refresh:function(){this.suspended||(this._refreshTS=(new Date).getTime(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},_popTile:function(a){var c=f.disconnect;c(a._onload_connect);c(a._onerror_connect);c(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null;this._loadingList.remove(a.id);this._fireOnUpdateEvent()},_tileLoadHandler:function(a){a=a.currentTarget;
this._noDom?this._standby.push(a):(g.set(a,"visibility","inherit"),this._popTile(a))},_tileAbortHandler:function(a){a=a.currentTarget;this.onError(Error("Unable to load tile: "+a.src));g.set(a,"visibility","hidden");this._popTile(a)},_tileErrorHandler:function(a,c,d){d=d.currentTarget;var b,e,k=!0;if(this.tileMap||!this.resampling)k=!1;else if(b=new l(d.src),b=b.path.split("/"),b=parseInt(b[b.length-3]),e=this._ct.lod.level-b+1,this._multiple=Math.pow(2,e),b===this._lowestLevel||0===this._resamplingTolerance||
this._resamplingTolerance&&Math.log(this._multiple)/Math.LN2>this._resamplingTolerance)k=!1;k?(this.isResampling=!0,this._resample(d,a,c)):(this.onError(Error("Unable to load tile: "+d.src)),g.set(d,"visibility","hidden"),this._popTile(d))},_resample:function(a,c,d){var b=(new l(a.src)).path.split("/"),e=this._multiple,k=parseInt(b[b.length-3])-1,t=parseInt(c/e),f=parseInt(d/e),b=d%e,u=c%e,t=this.getTileUrl(k,t,f);c=this.getTileUrl(k+Math.log(e)/Math.LN2,c,d);e={width:this._tileW*e+"px",height:this._tileH*
e+"px",margin:"-"+this._tileW*u+"px 0 0 "+("-"+this._tileH*b+"px")};this._failedRequests||(this._failedRequests={});this._failedRequests[c]={src:t,css:e};g.set(a,e);q("chrome")&&a.setAttribute("src",null);a.src=t},_fireOnUpdateEvent:function(){0===this._loadingList.count&&(this._cleanUpRemovedImages(),this._fireOnUpdate&&(this._fireOnUpdate=!1,this.onUpdate(),this._fireUpdateEnd()))},setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var c=
g.set,d,b,e;if("css-transforms"===this._map.navigationMode){if(this._active)for(e=this._active.childNodes,d=e.length-1;0<=d;d--)c(e[d],"opacity",a);for(d=this._passives.length-1;0<=d;d--)for(e=this._passives[d].childNodes,b=e.length-1;0<=b;b--)c(e[b],"opacity",a)}else for(e=this._div.childNodes,d=e.length-1;0<=d;d--)c(e[d],"opacity",a)},setExclusionAreas:function(a){this.exclusionAreas=a;if(this.loaded&&this._map&&this._map.loaded){var c=this._map.spatialReference,d=this.tileInfo,b=d.origin,e=d.lods,
k=e[0].level,g=e[e.length-1].level,t,f,q,u,v,h,n,l,m;if(this.exclusionAreas&&this.exclusionAreas.length)for(this._exclusionsPerZoom=[],f=0,q=a.length;f<q;f++){if(t=a[f],(m=t.geometry)&&"extent"===m.type&&m.xmin<=m.xmax&&m.ymin<=m.ymax){if(!c.equals(m.spatialReference))if(c._canProject(m.spatialReference))c.isWebMercator()?(l=w.lngLatToXY(m.xmin,m.ymin),m=w.lngLatToXY(m.xmax,m.ymax)):(l=w.xyToLngLat(m.xmin,m.ymin,!0),m=w.xyToLngLat(m.xmax,m.ymax,!0)),m=new x(l[0],l[1],m[0],m[1],c);else continue;n=
-1;if(t.minZoom&&-1!==t.minZoom)n=t.minZoom;else if(t.minScale&&-1!==t.minScale)for(u=0,v=e.length;u<v;u++)if(e[u].scale<=t.minScale){n=e[u].level;break}n=Math.max(n,k);l=-1;if(t.maxZoom&&-1!==t.maxZoom)l=t.maxZoom;else if(t.maxScale&&-1!==t.maxScale)for(u=0,v=e.length;u<v;u++)if(e[u].scale<t.maxScale){l=e[u-1].level;break}else if(e[u].scale===t.maxScale){l=e[u].level;break}l=-1===l?g:Math.min(l,g);for(t=n;t<=l;t++){u=0;for(v=e.length;u<v;u++)if(e[u].level===t){h=e[u];break}h&&(this._exclusionsPerZoom[t]||
(this._exclusionsPerZoom[t]=[]),u=1/h.resolution/d.rows,v=1/h.resolution/d.cols,this._exclusionsPerZoom[t].push({rowFrom:Math.floor((b.y-m.ymax)*u),rowTo:Math.ceil((b.y-m.ymin)*u),colFrom:Math.floor((m.xmin-b.x)*v),colTo:Math.ceil((m.xmax-b.x)*v)}))}}}else this._exclusionsPerZoom=null;this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}},_isExcluded:function(a,c,d){var b,e,k;if(!this._exclusionsPerZoom)return!1;b=this._exclusionsPerZoom[a];if(!b)return!1;e=0;for(k=
b.length;e<k;e++)if(a=b[e],c>=a.rowFrom&&c<a.rowTo&&d>=a.colFrom&&d<a.colTo)return!0;return!1}})})},"dojox/collections/ArrayList":function(){define(["dojo/_base/kernel","dojo/_base/array","./_base"],function(p,f,b){b.ArrayList=function(f){var l=[];f&&(l=l.concat(f));this.count=l.length;this.add=function(b){l.push(b);this.count=l.length};this.addRange=function(b){if(b.getIterator)for(b=b.getIterator();!b.atEnd();)this.add(b.get());else for(var f=0;f<b.length;f++)l.push(b[f]);this.count=l.length};this.clear=
function(){l.splice(0,l.length);this.count=0};this.clone=function(){return new b.ArrayList(l)};this.contains=function(b){for(var f=0;f<l.length;f++)if(l[f]==b)return!0;return!1};this.forEach=function(b,f){p.forEach(l,b,f)};this.getIterator=function(){return new b.Iterator(l)};this.indexOf=function(b){for(var f=0;f<l.length;f++)if(l[f]==b)return f;return-1};this.insert=function(b,f){l.splice(b,0,f);this.count=l.length};this.item=function(b){return l[b]};this.remove=function(b){b=this.indexOf(b);0<=
b&&l.splice(b,1);this.count=l.length};this.removeAt=function(b){l.splice(b,1);this.count=l.length};this.reverse=function(){l.reverse()};this.sort=function(b){b?l.sort(b):l.sort()};this.setByIndex=function(b,f){l[b]=f;this.count=l.length};this.toArray=function(){return[].concat(l)};this.toString=function(b){return l.join(b||",")}};return b.ArrayList})},"dojox/collections/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(p,f,b){p=f.getObject("dojox.collections",
!0);p.DictionaryEntry=function(b,f){this.key=b;this.value=f;this.valueOf=function(){return this.value};this.toString=function(){return String(this.value)}};p.Iterator=function(f){var l=0;this.element=f[l]||null;this.atEnd=function(){return l>=f.length};this.get=function(){return this.atEnd()?null:this.element=f[l++]};this.map=function(h,l){return b.map(f,h,l)};this.reset=function(){l=0;this.element=f[l]}};p.DictionaryIterator=function(f){var l=[],h={},m;for(m in f)h[m]||l.push(f[m]);var n=0;this.element=
l[n]||null;this.atEnd=function(){return n>=l.length};this.get=function(){return this.atEnd()?null:this.element=l[n++]};this.map=function(g,e){return b.map(l,g,e)};this.reset=function(){n=0;this.element=l[n]}};return p})},"esri/layers/ArcGISMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(p,f,b,m,l,h,r,n,g,e){return p(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",
infoTemplates:null,constructor:function(c,a){this.layerInfos=[];a&&(this.infoTemplates=a.infoTemplates||null);var b=this._params={},e=this._url.query?this._url.query.token:null;e&&(b.token=e)},setInfoTemplates:function(c){this.infoTemplates=c},_load:function(){r({url:this._url.path,content:f.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(c,
a){try{this._findCredential();(this.credential&&this.credential.ssl||c&&c._ssl)&&this._useSSL();this.description=c.description;this.copyright=c.copyrightText;this.spatialReference=c.spatialReference&&new n(c.spatialReference);this.initialExtent=c.initialExtent&&new g(c.initialExtent);this.fullExtent=c.fullExtent&&new g(c.fullExtent);this.units=c.units;this.maxRecordCount=c.maxRecordCount;this.maxImageHeight=c.maxImageHeight;this.maxImageWidth=c.maxImageWidth;this.supportsDynamicLayers=c.supportsDynamicLayers;
var f=this.layerInfos=[],v=c.layers,q=this._defaultVisibleLayers=[];b.forEach(v,function(a,c){f[c]=new e(a);a.defaultVisibility&&q.push(a.id)});this.visibleLayers||(this.visibleLayers=q);this.version=c.currentVersion;this.version||(this.version="capabilities"in c||"tables"in c?10:"supportedImageFormatTypes"in c?9.31:9.3);this.capabilities=c.capabilities;h.isDefined(c.minScale)&&!this._hasMin&&this.setMinScale(c.minScale);h.isDefined(c.maxScale)&&!this._hasMax&&this.setMaxScale(c.maxScale)}catch(k){this._errorHandler(k)}}})})},
"esri/layers/LayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,f,b,m,l){return p(null,{declaredClass:"esri.layers.LayerInfo",constructor:function(b){f.mixin(this,b)},toJson:function(){return l.fixJson({defaultVisibility:this.defaultVisibility,id:this.id,maxScale:this.maxScale,minScale:this.minScale,name:this.name,parentLayerId:this.parentLayerId,subLayerIds:this.subLayerIds})}})})},"esri/layers/TimeInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../TimeExtent ./TimeReference ./LayerTimeOptions".split(" "),
function(p,f,b,m,l,h,r){p=p(null,{declaredClass:"esri.layers.TimeInfo",constructor:function(b){null!==b&&(f.mixin(this,b),b.exportOptions&&(this.exportOptions=new r(b.exportOptions)),this.timeExtent=null,b.timeExtent&&2===b.timeExtent.length&&(this.timeExtent=new l(b.timeExtent)),this.timeReference=new h(b.timeReference))}});f.mixin(p,{UNIT_CENTURIES:"esriTimeUnitsCenturies",UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",
UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",UNIT_YEARS:"esriTimeUnitsYears"});return p})},"esri/TimeExtent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel"],function(p,f,b,m){var l=p(null,{declaredClass:"esri.TimeExtent",constructor:function(b){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(b)if(f.isArray(b)){var h=
b[0],n=b[1];this.startTime=null===h||"null"===h?null:new Date(h);this.endTime=null===n||"null"===n?null:new Date(n)}else b instanceof Date&&this._create(b,null)},offset:function(b,f){var h=new l,g=this.startTime,e=this.endTime;g&&(h.startTime=this._getOffsettedDate(g,b,f));e&&(h.endTime=this._getOffsettedDate(e,b,f));return h},intersection:function(b){return this._intersection(this,b)},toJson:function(){var b=[],f=this.startTime;b.push(f?f.getTime():"null");f=this.endTime;b.push(f?f.getTime():"null");
return b},_create:function(b,f){this.startTime=b?new Date(b.getTime()):null;this.endTime=f?new Date(f.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",
setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(b,f){if(b&&f){var h=b.startTime,g=b.endTime,
e=f.startTime,c=f.endTime,h=h?h.getTime():-Infinity,e=e?e.getTime():-Infinity,g=g?g.getTime():Infinity,c=c?c.getTime():Infinity,a,u;e>=h&&e<=g?a=e:h>=e&&h<=c&&(a=h);g>=e&&g<=c?u=g:c>=h&&c<=g&&(u=c);if(isNaN(a)||isNaN(u))return null;h=new l;h.startTime=-Infinity===a?null:new Date(a);h.endTime=Infinity===u?null:new Date(u);return h}return null},_getOffsettedDate:function(b,f,n){var g=this._refData;b=new Date(b.getTime());f&&n&&(g=g[n],b[g.setter](b[g.getter]()+f*g.multiplier));return b}});return l})},
"esri/layers/TimeReference":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,f,b,m){return p(null,{declaredClass:"esri.layers.TimeReference",constructor:function(b){b&&f.mixin(this,b)}})})},"esri/layers/LayerTimeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,f,b,m,l){return p(null,{declaredClass:"esri.layers.LayerTimeOptions",constructor:function(b){b&&f.mixin(this,b)},toJson:function(){return l.fixJson({timeDataCumulative:this.timeDataCumulative,
timeOffset:this.timeOffset,timeOffsetUnits:this.timeOffsetUnits,useTime:this.useTime})}})})},"esri/layers/TileMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/io-query ../request ../urlUtils ../sniff".split(" "),function(p,f,b,m,l,h,r,n){var g=n("esri-iphone");return p(null,{declaredClass:"esri.layers.TileMap",constructor:function(b){this.layer=b;this._tileMaps={}},getTile:function(b,c,a,g,f){b={id:g,level:b,row:c,col:a};c=this._getResamplingBudget();
0<c?this._process({tile:b,requestedTile:b,callback:f,resamplingBudget:c}):(f||this.callback).call(this,b,b)},statusOf:function(b,c,a){var e=this._getResamplingBudget();b={level:b,row:c,col:a};if(0===e)return 1;for(;0<=e;){c=this._tileToTileMap(b);if(!this._tileMaps[c.uid])return-1;c=this._tileMaps[c.uid];if(!c.promise.isFulfilled())return-1;if(this._isTileAvailable(b,c))return 1;b=this._parentTile(b);if(!b)break;e--}return 0},style:function(b,c){if(b.level!==c.level||b.row!==c.row||b.col!==c.col){for(var a=
this.layer.tileInfo,e=a.lods,f=a.cols,a=a.rows,q,k,d=e.length-1;!q||!k;)q||e[d].level!==b.level||(q=e[d]),k||e[d].level!==c.level||(k=e[d]),d--;q=Math.round(q.resolution/k.resolution);k=c.col%q*-1*f;e=c.row%q*-1*a;q={width:f*q+"px",height:a*q+"px",margin:e+"px 0 0 "+k+"px","will-change":"transform"};g&&(k=0===k?0:-1*k,e=0===e?0:-1*e,q.clip="rect("+e+"px,"+(k+f)+"px,"+(e+a)+"px,"+k+"px)");return q}},_process:function(b){var c=b.tile,a=this._tileToTileMap(c),e=this._parentTile(c);this._getTileMap(a).then(f.hitch(this,
function(g){a=g;this._isTileAvailable(c,a)?(b.callback||this.callback).call(this,c,b.requestedTile):0<b.resamplingBudget&&e?(b.resamplingBudget--,b.tile=e,this._process(b)):(b.callback||this.callback).call(this,b.requestedTile,b.requestedTile)}),f.hitch(this,function(){(b.callback||this.callback).call(this,b.requestedTile,b.requestedTile)}))},_getTileMap:function(b){var c,a,e,g,q=null;this._tileMaps[b.uid]?(b=this._tileMaps[b.uid],c=b.promise):(this._tileMaps[b.uid]=b,a=new m,h({url:this._getTileMapUrl(b.level,
b.row,b.col),handleAs:"json",callbackParamName:"callback",timeout:3E3,load:function(c){f.mixin(b,c);if(b.data&&0<b.data.length){g=b.data.length;if(1===g)q=b.data[0];else for(q=b.data[0],e=1;e<g;e++)if(b.data[e]!==q){q=null;break}null!==q&&(delete b.data,b.value=q)}a.resolve(b)},error:function(c){a.reject()}}),c=b.promise=a.promise);return c},_parentTile:function(e){var c=this.layer.tileInfo.lods,a,g,f=null;b.some(c,function(c,b){return e.level===c.level?(a=c,g=b,!0):!1});0<g&&(c=c[g-1],f={id:e.id,
level:c.level,row:Math.floor(e.row*a.resolution/c.resolution+.01),col:Math.floor(e.col*a.resolution/c.resolution+.01)});return f},_tileToTileMap:function(b){var c=8*Math.floor(b.row/8),a=8*Math.floor(b.col/8);return{uid:b.level+"_"+c+"_"+a,level:b.level,row:c,col:a}},_isTileAvailable:function(b,c){var a,e;c.valid?void 0!==c.value?a=c.value:(a=c.location.left,e=c.location.top,a=(b.row-e)*c.location.width+(b.col-a),a=a<c.data.length?c.data[a]:0):a=0;return a},_getTileMapUrl:function(b,c,a){var e=this.layer,
g=e.tileServers,f=e._getToken(),k=e._url.query;b=(g?g[c%g.length]:e._url.path)+"/tilemap/"+b+"/"+c+"/"+a+"/8/8";k&&(b+="?"+l.objectToQuery(k));!f||k&&k.token||(b+=(-1===b.indexOf("?")?"?":"\x26")+"token\x3d"+f);return b=e.addTimestampToURL(b)},_getResamplingBudget:function(){var b=this.layer,c=0;b.resampling&&(c=b._resamplingTolerance,null===c||void 0===c)&&(c=b.tileInfo.lods.length);return c}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){var v=p([u],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(a){this.inherited(arguments,[null,a]);this._mapImages=[];var c=b.hitch;this._panStart=c(this,this._panStart);this._pan=c(this,this._pan);this._extentChange=c(this,this._extentChange);this._zoom=c(this,this._zoom);this._zoomStart=c(this,this._zoomStart);this._scale=c(this,this._scale);this._resize=c(this,this._resize);f.connect(this,"onSuspend",this,this._onSuspend);
f.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(a){var c=this._mapImages.push(a),c=c-1;a._idx=c;a._layer=this;this._div&&this._createImage(a,c)},removeImage:function(a){if(a){var c=a._idx,d=this._mapImages;if(d[c]===a){delete d[c];if(c=a._node)this._clearEvents(c),c.e_idx=c.e_bl=c.e_tr=c.e_l=c.e_t=c.e_w=c.e_h=null,c.parentNode&&(c.parentNode.removeChild(c),l.destroy(c));a._node=a._idx=a._layer=null}}},removeAllImages:function(){var a=this._mapImages,
c,d=a.length;for(c=0;c<d;c++){var b=a[c];b&&this.removeImage(b)}this._mapImages=[]},getImages:function(){var a=this._mapImages,c=[],d,b=a.length;for(d=0;d<b;d++)a[d]&&c.push(a[d]);return c},setOpacity:function(a){this.opacity!=a&&(this._opacityChanged(this.opacity=a),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(a){var c=this._div,d,b;if(c)if(!g("ie")||8<g("ie"))h.set(c,"opacity",a);else for(b=c.childNodes,d=b.length,c=0;c<d;c++)h.set(b[c],"opacity",a)},_createImage:function(a,
c){var d=l.create("img");h.set(d,{position:"absolute"});1>a.opacity?h.set(d,"opacity",a.opacity):8>=g("ie")&&h.set(d,"opacity",this.opacity);!a.rotation||9>g("ie")||h.set(d,r._css.names.transform,r._css.rotate(360-a.rotation));a._node=d;d.e_idx=c;d.e_layer=this;d.e_load=f.connect(d,"onload",v.prototype._imageLoaded);d.e_error=f.connect(d,"onerror",v.prototype._imageError);d.e_abort=f.connect(d,"onabort",v.prototype._imageError);d.src=a.href},_imageLoaded:function(a,c){var d=c||a.target||a.currentTarget,
b=d.e_layer,e=b._mapImages[d.e_idx],k=b._map;k&&(k.__zooming||k.__panning||!b._sr)?b._standby.push(d):(b._clearEvents(d),e&&e._node===d&&k&&b._attach(e))},_imageError:function(a){a=a.target||a.currentTarget;var c=a.e_layer,d=c._mapImages[a.e_idx];c._clearEvents(a);d&&(d._node=null)},_clearEvents:function(a){var c=f.disconnect;c(a.e_load);c(a.e_error);c(a.e_abort);a.e_load=a.e_error=a.e_abort=a.e_layer=null},_attach:function(b){var e=b.extent,d=e.spatialReference,g=this._sr,t=this._div,f=b._node,q=
new c({x:e.xmin,y:e.ymin,spatialReference:d}),e=new c({x:e.xmax,y:e.ymax,spatialReference:d});g.equals(d)||(g.isWebMercator()&&4326===d.wkid?(q=a.geographicToWebMercator(q),e=a.geographicToWebMercator(e)):d.isWebMercator()&&4326===g.wkid&&(q=a.webMercatorToGeographic(q),e=a.webMercatorToGeographic(e)));f.e_bl=q;f.e_tr=e;b.visible&&(this._setPos(f,t._left,t._top),(this._active||t).appendChild(f))},_setPos:function(a,c,d){var b=a.e_bl,e=a.e_tr,k=this._map,b=k.toScreen(b),e=k.toScreen(e);c=b.x-c;d=e.y-
d;var g=Math.abs(e.x-b.x),b=Math.abs(b.y-e.y),e={width:g+"px",height:b+"px"},f=this._mapImages[a.e_idx];"css-transforms"===k.navigationMode?e[r._css.names.transform]=r._css.translate(c,d)+(f.rotation?" "+r._css.rotate(360-f.rotation):""):(e.left=c+"px",e.top=d+"px");h.set(a,e);a.e_l=c;a.e_t=d;a.e_w=g;a.e_h=b},managedSuspension:!0,_setMap:function(a,c){this.inherited(arguments);var d=this._div=l.create("div",null,c),b=r._css.names,k={position:"absolute"},f=a.__visibleDelta;if(!g("ie")||8<g("ie"))k.opacity=
this.opacity;"css-transforms"===a.navigationMode?(k[b.transform]=r._css.translate(f.x,f.y),h.set(d,k),d._left=f.x,d._top=f.y,k={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},this._active=l.create("div",null,d),h.set(this._active,k),this._passive=l.create("div",null,d),h.set(this._passive,k)):(d._left=0,d._top=0,h.set(d,k));this._standby=[];b=this._mapImages;f=b.length;for(k=0;k<f;k++){var q=b[k];q._node||this._createImage(q,q._idx)}e.hide(d);return d},_unsetMap:function(a,
c){this._disconnect();var d=this._div;if(d){var b=this._mapImages,e,k=b.length;for(e=0;e<k;e++){var g=b[e];if(g){var f=g._node;f&&(this._clearEvents(f),f.e_idx=f.e_bl=f.e_tr=f.e_l=f.e_t=f.e_w=f.e_h=null);g._node=null}}c.removeChild(d);l.destroy(d)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();e.hide(this._div)},_onResume:function(a){a.firstOccurrence&&(this._sr=this._map.spatialReference,this._processStandbyList());
a=this._map;var c=this._div,d=a.__visibleDelta;"css-transforms"===a.navigationMode&&(c._left=d.x,c._top=d.y,h.set(c,r._css.names.transform,r._css.translate(c._left,c._top)));this._redraw("css-transforms"===a.navigationMode);this._connect(a);e.show(c)},_connect:function(a){if(!this._connections){var c=f.connect,d="css-transforms"===a.navigationMode;this._connections=[c(a,"onPanStart",this._panStart),c(a,"onPan",this._pan),c(a,"onExtentChange",this._extentChange),d&&c(a,"onZoomStart",this._zoomStart),
d?c(a,"onScale",this._scale):c(a,"onZoom",this._zoom),d&&c(a,"onResize",this._resize)]}},_disconnect:function(){this._connections&&(m.forEach(this._connections,f.disconnect),this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(a,c){var d=this._div;d._left=this._panL+c.x;d._top=this._panT+c.y;"css-transforms"===this._map.navigationMode?h.set(d,r._css.names.transform,r._css.translate(d._left,d._top)):h.set(d,{left:d._left+"px",top:d._top+
"px"})},_extentChange:function(a,c,d){d?this._redraw("css-transforms"===this._map.navigationMode):c&&this._pan(a,c);this._processStandbyList()},_processStandbyList:function(){var a,c=this._standby;if(c&&c.length)for(a=c.length-1;0<=a;a--)this._imageLoaded(null,c[a]),c.splice(a,1)},_redraw:function(a){if(a){a=this._passive;var c=r._css.names;h.set(a,c.transition,"none");this._moveImages(a,this._active);h.set(a,c.transform,"none")}a=this._active||this._div;var c=this._div._left,d=this._div._top,b,e=
a.childNodes.length,g;for(b=0;b<e;b++)g=a.childNodes[b],this._setPos(g,c,d)},_zoom:function(a,c,d){a=this._div;var b=a._left,e=a._top,k,g=a.childNodes.length,f;for(k=0;k<g;k++){f=a.childNodes[k];var u=f.e_w*c,q=f.e_h*c,v=(d.x-b-f.e_l)*(u-f.e_w)/f.e_w,n=(d.y-e-f.e_t)*(q-f.e_h)/f.e_h,v=isNaN(v)?0:v,n=isNaN(n)?0:n;h.set(f,{left:f.e_l-v+"px",top:f.e_t-n+"px",width:u+"px",height:q+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(a,c){var d=a.childNodes,
b;b=d.length;if(0<b)for(--b;0<=b;b--)c.appendChild(d[b])},_scale:function(a,c){var d=r._css.names,b=this._passive;h.set(b,d.transition,c?"none":d.transformName+" "+n.defaults.map.zoomDuration+"ms ease");({})[d.transform]=r._css.matrix(a);h.set(b,d.transform,r._css.matrix(a))},_resize:function(a,c,d){h.set(this._active,{width:c+"px",height:d+"px"});h.set(this._passive,{width:c+"px",height:d+"px"})}});return v})},"esri/layers/OpenStreetMapLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),
function(p,f,b,m,l,h,r,n,g){return p(n,{declaredClass:"esri.layers.OpenStreetMapLayer",constructor:function(b){this.spatialReference=new h({wkid:102100});this.tileInfo=new g({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,scale:5.91657527591555E8,resolution:156543.033928},{level:1,scale:2.95828763795777E8,resolution:78271.5169639999},{level:2,scale:1.47914381897889E8,resolution:39135.7584820001},
{level:3,scale:7.3957190948944E7,resolution:19567.8792409999},{level:4,scale:3.6978595474472E7,resolution:9783.93962049996},{level:5,scale:1.8489297737236E7,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,
resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:.597164283559817},{level:19,scale:1128.497176,resolution:.298582141647617}]});this.fullExtent=
new r({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.initialExtent=new r({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.tileServers=b&&b.tileServers||["//a.tile.openstreetmap.org","//b.tile.openstreetmap.org","//c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=b?b.displayLevels:null;this.copyright=b&&b.copyright||"Map data \u00a9 OpenStreetMap contributors, CC-BY-SA";
this.loaded=!0;this.onLoad(this);(b=b&&b.loadCallback)&&b(this)},getTileUrl:function(b,c,a){b=this.tileServers[c%this.serversLength]+"/"+b+"/"+a+"/"+c+".png";b=l.normalize(b);b=this.addTimestampToURL(b);return l.addProxy(b)}})})},"esri/layers/VectorTileLayer":function(){(function(){var p=function(){var b;try{b=window.WebGLRenderingContext}catch(g){b=!1}var f;try{for(var l=document.createElement("canvas"),h=["webgl","experimental-webgl","webkit-3d","moz-webgl"],r=null,n=0;n<h.length;++n){try{r=l.getContext(h[n])}catch(g){}if(r)break}f=
r}catch(g){f=!1}return b&&f?!0:!1}(),f=["dojo/_base/lang","dojo/has","dojo/Deferred","../sniff","./layer"];p&&f.push("./VectorTileLayerImpl");define(f,function(b,f,l,h,r,n){f=n?n:r.createSubclass({declaredClass:"esri.layers.VectorTileLayer",constructor:function(){var g=new l;g.reject(Error("esri.layers.VectorTileLayer is not supported"));g.promise.otherwise(b.hitch(this,function(b){this._errorHandler(b)}))}});f.ACCESS_TOKEN=null;f.supported=function(){return p};return f})})()},"esri/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/window dojo/Stateful dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../kernel ../lang ../domUtils ../geometry/Polyline ../geometry/Polygon ../geometry/normalizeUtils ../InfoWindowBase ../PopupBase dojo/i18n!../nls/jsapi dojo/NodeList-dom require require".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B){return p([z,C,n],{declaredClass:"esri.dijit.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(d,b){this.initialize();f.mixin(this,d);this.domNode=e.byId(b);var k=this._nls=f.mixin({},B.widgets.popup),g=this.domNode;a.add(g,"esriPopup");(this._isRTL=
!v.isBodyLtr())&&q.set(g,"direction","rtl");c.set(g,"innerHTML","\x3cdiv class\x3d'esriPopupWrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+k.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton prev hidden' title\x3d'"+k.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden' title\x3d'"+k.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton maximize' title\x3d'"+
k.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close' title\x3d'"+k.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList hidden'\x3e\x3ca title\x3d"+k.NLS_zoomTo+" class\x3d'action zoomTo' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+k.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outerPointer hidden'\x3e\x3c/div\x3e");
this._sizers=l.query(".sizer",g);k=l.query(".titlePane",g)[0];e.setSelectable(k,!1);this._title=l.query(".title",k)[0];this._prevFeatureButton=l.query(".prev",k)[0];this._nextFeatureButton=l.query(".next",k)[0];this._maxButton=l.query(".maximize",k)[0];this._spinner=l.query(".spinner",k)[0];this._contentPane=l.query(".contentPane",g)[0];this._positioner=l.query(".esriPopupWrapper",g)[0];this._pointer=l.query(".pointer",g)[0];this._outerPointer=l.query(".outerPointer",g)[0];this._actionList=l.query(".actionsPane .actionList",
g)[0];this._eventConnections=[m.connect(l.query(".close",k)[0],"onclick",this,this.hide),m.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),m.connect(this._nextFeatureButton,"onclick",this,this.selectNext),m.connect(this._maxButton,"onclick",this,this._toggleSize),m.connect(l.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature),m.connect(this,"onClearFeatures",this,this._featuresCleared),m.connect(this,"onSelectionChange",this,this._featureSelected),m.connect(this,
"onDfdComplete",this,this._updateUI)];h("esri-touch")&&(g=t.setScrollable(this._contentPane),this._eventConnections.push(g[0],g[1]));this._toggleVisibility(!1)},onMaximize:function(){},onRestore:function(){},setMap:function(a){this.inherited(arguments);u.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a);this._maxHeight=q.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a){this.popupWindow&&(w.isDefined(a)&&
""!==a||(a="\x26nbsp;"),this.destroyDijits(this._title),this.place(a,this._title),this.isShowing&&(this.startupDijits(this._title),this.reposition()))},setContent:function(a){this.popupWindow&&(w.isDefined(a)&&""!==a||(a="\x26nbsp;"),this.destroyDijits(this._contentPane),this.place(a,this._contentPane),this.isShowing&&(this.startupDijits(this._contentPane),this.reposition()))},show:function(a,c){if(this.popupWindow)if(this._delayHide=!1,a){var d=this.map,b;a.spatialReference?(this.location=a,b=d.toScreen(a)):
(this.location=d.toMap(a),b=a);var e=d._getFrameWidth();if(-1!==e&&(b.x%=e,0>b.x&&(b.x+=e),d.width>e))for(d=(d.width-e)/2;b.x<d;)b.x+=e;this._maximized?this.restore():this._setPosition(b);c&&c.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this.startupDijits(this._contentPane),this.reposition(),this.showHighlight(),this.onShow())}else this._toggleVisibility(!0)},hide:function(){this.isShowing&&(this._toggleVisibility(!1),
this._unfollowMap(),this.keepHighlightOnHide||this.hideHighlight(),this.onHide())},resize:function(a,c){this.popupWindow&&(this._sizers.style({width:a+"px"}),q.set(this._contentPane,"maxHeight",c+"px"),this._maxHeight=c,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.map&&this.location&&!this._maximized&&this.isShowing&&this._setPosition(this.map.toScreen(this.location))},maximize:function(){var d=this.map;if(d&&!this._maximized&&this.popupWindow){this._maximized=
!0;var b=this._maxButton;a.remove(b,"maximize");a.add(b,"restore");c.set(b,"title",this._nls.NLS_restore);var b=this.marginLeft,e=this.marginTop,k=d.width-2*b,d=d.height-2*e;q.set(this.domNode,{left:this._isRTL?null:b+"px",right:this._isRTL?b+"px":null,top:e+"px",bottom:null});q.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=q.get(this._sizers[0],"width");this._savedHeight=q.get(this._contentPane,"maxHeight");this._sizers.style({width:k+"px"});q.set(this._contentPane,
{maxHeight:d-65+"px",height:d-65+"px"});this._showPointer("");this._unfollowMap();a.add(this.domNode,"esriPopupMaximized");this.onMaximize()}},restore:function(){if(this.map&&this._maximized&&this.popupWindow){this._maximized=!1;var d=this._maxButton;a.remove(d,"restore");a.add(d,"maximize");c.set(d,"title",this._nls.NLS_maximize);q.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();
a.remove(this.domNode,"esriPopupMaximized");this.onRestore()}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._content);b.forEach(this._eventConnections,m.disconnect);u.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=
this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},postscript:null,_highlightSetter:function(a){var c=this.highlight,d=this.map;this.highlight=a;if(d&&a!==c)if(a){if(this.enableHighlight(d),a=this.features&&this.features[this.selectedIndex])this.updateHighlight(d,a),this.showHighlight()}else this.disableHighlight(d)},
_pagingControlsSetter:function(a){var c=this.pagingControls,d=this.map;this.pagingControls=a;d&&a!==c&&this._updatePagingControls()},_pagingInfoSetter:function(a){var c=this.pagingInfo,d=this.map;this.pagingInfo=a;d&&a!==c&&this.features&&this.features.length&&this._updatePagingInfo()},_popupWindowSetter:function(a){var c=this.popupWindow,d=this.map;this.popupWindow=a;d&&a!==c&&(a?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(a){var c=this.anchor;
this.anchor=a;this.map&&a!==c&&this.reposition()},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var a=this.selectedIndex;if(0<=a){var c=this.features[a].getContent(),d;!this.titleInBody&&c&&f.isString(c.id)&&(d=k.byId(c.id))&&d.set&&/_PopupRenderer/.test(d.declaredClass)&&d.set("showTitle",!1);this.setContent(c);
this.updateHighlight(this.map,this.features[a]);this.showHighlight()}},_toggleVisibility:function(a){this._setVisibility(a);this.isShowing=a},_setVisibility:function(c){a.toggle(this.domNode,"esriPopupVisible",c);a.toggle(this.domNode,"esriPopupHidden",!c)},_waitAndHide:function(a){var c=this;this._delayHide=!0;setTimeout(function(){c._delayHide&&(c._delayHide=!1,c.hide())},a)},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[m.connect(a,"onPanStart",this,this._onPanStart),
m.connect(a,"onPan",this,this._onPan),m.connect(a,"onZoomStart",this,this._onZoomStart),m.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var a=this._handles;a&&(b.forEach(a,m.disconnect),this._handles=null)},_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,c){var d=this._panOrigin,b=c.x,e=c.y,k=d.left,g=d.top,t=d.right,d=d.bottom;k&&(k=parseFloat(k)+b+"px");g&&(g=parseFloat(g)+
e+"px");t&&(t=parseFloat(t)-b+"px");d&&(d=parseFloat(d)-e+"px");q.set(this.domNode,{left:k,top:g,right:t,bottom:d})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(a,c,d){d&&(this._setVisibility(!0),this.show(this._targetLocation||this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_setPosition:function(a){var c=a.x,d=a.y;a=this.offsetX||0;var b=this.offsetY||0,e=0,k=0,g=v.position(this.map.container,!0),t=g.w,
f=g.h,u="Left",w="bottom",h=v.getContentBox(this._positioner),x=h.w/2,n=h.h/2,l=q.get(this._sizers[0],"height")+this._maxHeight+q.get(this._sizers[2],"height"),m=l/2,y=0,A=0,z=c,C=d,p=this.anchor.toLowerCase();if("auto"===p){if(p=r.getBox)p=p(),y=Math.max(p.l,g.x),t=Math.min(p.l+p.w,g.x+g.w),A=Math.max(p.t,g.y),f=Math.min(p.t+p.h,g.y+g.h),z+=g.x,C+=g.y;g=C-A>=l;l=f-C>=l;p=t-z>=h.w;h=z-y>=h.w;C-A>m&&f-C>=m&&(p?(w="",u="Left"):h&&(w="",u="Right"));u&&w&&z-y>x&&t-z>=x&&(g?(u="",w="bottom"):l&&(u="",
w="top"));u&&w&&(p&&g?(u="Left",w="bottom"):p&&l?(u="Left",w="top"):h&&l?(u="Right",w="top"):h&&g&&(u="Right",w="bottom"))}else w=u="",-1!==p.indexOf("top")?w="bottom":-1!==p.indexOf("bottom")&&(w="top"),-1!==p.indexOf("left")?u="Right":-1!==p.indexOf("right")&&(u="Left");m=w+u;switch(m){case "top":case "bottom":k=14;break;case "Left":case "Right":e=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":k=14,e=-16}q.set(this.domNode,{left:c+"px",top:d+"px",right:null,bottom:null});
c={left:null,right:null,top:null,bottom:null};u?c[u.toLowerCase()]=e+a+"px":c.left=-x+"px";w?c[w]=k+b+"px":c.top=-n+"px";q.set(this._positioner,c);this._showPointer(m)},_showPointer:function(c){a.remove(this._pointer,"top bottom right left topLeft topRight bottomRight bottomLeft hidden".split(" "));a.remove(this._outerPointer,["right","left","hidden"]);"Right"===c||"Left"===c?(c=c.toLowerCase(),a.add(this._outerPointer,c)):a.add(this._pointer,c)},_setPagerCallbacks:function(a,c,d){if(this.pagingControls&&
(a!==this||this._pagerScope&&this._pagerScope!==this)&&a!==this._pagerScope){this._pagerScope=a;a===this&&(c=this.selectPrevious,d=this.selectNext);var b=this._eventConnections;m.disconnect(b[1]);m.disconnect(b[2]);c&&(b[1]=m.connect(this._prevFeatureButton,"onclick",a,c));d&&(b[2]=m.connect(this._nextFeatureButton,"onclick",a,d))}},_getLocation:function(a){var c,d;if(a=a&&a.geometry)switch(a.type){case "point":c=a;break;case "multipoint":c=a.getPoint(0);d=y.getDenormalizedExtent(a);break;case "polyline":case "polygon":c=
a.getPoint(0,0),d=y.getDenormalizedExtent(a)}return[c,d]},_zoomToFeature:function(a){a.preventDefault();var c=this.features,d=this.selectedIndex;a=this.map;if(c)if(d=this._getLocation(c[d]),c=d[0],d=d[1],c||(c=this.location),d&&d.intersects(this.location)||(this.location=c),d&&d.getWidth()&&d.getHeight())a.setExtent(d,!0);else{var b=a.getNumLevels(),d=a.getLevel(),e=a.getMaxZoom(),k=this.zoomFactor||1;0<b?d!==e&&(b=d+k,b>e&&(b=e),a.navigationManager._wheelZoom({value:b-d,mapPoint:c},!0)):a.navigationManager._wheelZoom({value:1/
Math.pow(2,k)*2,mapPoint:c},!0)}},_updatePagingControls:function(){var c=this._prevFeatureButton,d=this._nextFeatureButton,b=this.selectedIndex,e=this.features?this.features.length:0;this.pagingControls&&1<e?(0===b?a.add(c,"hidden"):a.remove(c,"hidden"),b===e-1?a.add(d,"hidden"):a.remove(d,"hidden")):(a.add(c,"hidden"),a.add(d,"hidden"))},_updatePagingInfo:function(){var a=this.features?this.features.length:0,c=this._nls,d="\x26nbsp;";this.pagingInfo&&1<a&&c.NLS_pagingInfo&&(d=w.substitute({index:this.selectedIndex+
1,total:a},c.NLS_pagingInfo));a&&(c=this.getSelectedFeature(),a=c.getInfoTemplate(),c=c.getTitle(),a&&!/esri\.InfoTemplate/.test(a.declaredClass)&&this.titleInBody||!c||(d=c+("\x26nbsp;"===d?"":" "+d)));this.setTitle(d)},_updateUI:function(){if(this.popupWindow){var c=this.features,d=this.deferreds,b=c?c.length:0,e=this._spinner,k=this._actionList,g=this._nls;this._updatePagingControls();this._updatePagingInfo();b?a.remove(k,"hidden"):a.add(k,"hidden");d&&d.length?c?a.remove(e,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+
g.NLS_searching+"...\x3c/div\x3e"):(a.add(e,"hidden"),b||(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+g.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay)))}}})})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),function(p,f,b,m,l,h,r){f.add("rtl-adjust-position-for-verticalScrollBar",function(g,e){var c=b.body(e),a=r.create("div",{style:{overflow:"scroll",overflowX:"visible",
direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},c,"last"),f=r.create("div",{style:{overflow:"hidden",direction:"ltr"}},a,"last"),v=0!=l.position(f).x;a.removeChild(f);c.removeChild(a);return v});f.add("position-fixed-support",function(g,e){var c=b.body(e),a=r.create("span",{style:{visibility:"hidden",position:"fixed",left:"1px",top:"1px"}},c,"last"),f=r.create("span",{style:{position:"fixed",left:"0",top:"0"}},a,"last"),v=l.position(f).x!=l.position(a).x;
a.removeChild(f);c.removeChild(a);return v});var n={getBox:function(g){g=g||b.doc;var e="BackCompat"==g.compatMode?b.body(g):g.documentElement,c=l.docScroll(g);if(f("touch")){var a=n.get(g);g=a.innerWidth||e.clientWidth;e=a.innerHeight||e.clientHeight}else g=e.clientWidth,e=e.clientHeight;return{l:c.x,t:c.y,w:g,h:e}},get:function(b){if(f("ie")&&n!==document.parentWindow){b.parentWindow.execScript("document._parentWindow \x3d window;","Javascript");var e=b._parentWindow;b._parentWindow=null;return e}return b.parentWindow||
b.defaultView},scrollIntoView:function(g,e){try{g=m.byId(g);var c=g.ownerDocument||b.doc,a=b.body(c),u=c.documentElement||a.parentNode,v=f("ie")||f("trident"),q=f("webkit");if(g!=a&&g!=u)if(!(f("mozilla")||v||q||f("opera")||f("trident")||f("edge"))&&"scrollIntoView"in g)g.scrollIntoView(!1);else{var k="BackCompat"==c.compatMode,d=Math.min(a.clientWidth||u.clientWidth,u.clientWidth||a.clientWidth),w=Math.min(a.clientHeight||u.clientHeight,u.clientHeight||a.clientHeight),c=q||k?a:u,t=e||l.position(g),
x=g.parentNode,q=function(a){return 6>=v||7==v&&k?!1:f("position-fixed-support")&&"fixed"==h.get(a,"position").toLowerCase()},n=this,r=function(a,c,d){"BODY"==a.tagName||"HTML"==a.tagName?n.get(a.ownerDocument).scrollBy(c,d):(c&&(a.scrollLeft+=c),d&&(a.scrollTop+=d))};if(!q(g))for(;x;){x==a&&(x=c);var z=l.position(x),C=q(x),p="rtl"==h.getComputedStyle(x).direction.toLowerCase();if(x==c)z.w=d,z.h=w,c==u&&(v||f("trident"))&&p&&(z.x+=c.offsetWidth-z.w),z.x=0,z.y=0;else{var E=l.getPadBorderExtents(x);
z.w-=E.w;z.h-=E.h;z.x+=E.l;z.y+=E.t;var G=x.clientWidth,I=z.w-G;0<G&&0<I&&(p&&f("rtl-adjust-position-for-verticalScrollBar")&&(z.x+=I),z.w=G);G=x.clientHeight;I=z.h-G;0<G&&0<I&&(z.h=G)}C&&(0>z.y&&(z.h+=z.y,z.y=0),0>z.x&&(z.w+=z.x,z.x=0),z.y+z.h>w&&(z.h=w-z.y),z.x+z.w>d&&(z.w=d-z.x));var J=t.x-z.x,L=t.y-z.y,P=J+t.w-z.w,Q=L+t.h-z.h,H,K;0<P*J&&(x.scrollLeft||x==c||x.scrollWidth>x.offsetHeight)&&(H=Math[0>J?"max":"min"](J,P),p&&(8==v&&!k||5<=f("trident"))&&(H=-H),K=x.scrollLeft,r(x,H,0),H=x.scrollLeft-
K,t.x-=H);0<Q*L&&(x.scrollTop||x==c||x.scrollHeight>x.offsetHeight)&&(H=Math.ceil(Math[0>L?"max":"min"](L,Q)),K=x.scrollTop,r(x,0,H),H=x.scrollTop-K,t.y-=H);x=x!=c&&!C&&x.parentNode}}}catch(V){console.error("scrollIntoView: "+V),g.scrollIntoView(!1)}}};p.setObject("dojo.window",n);return n})},"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(p,f,b,m){return p("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(b){var f=this._attrPairNames;
return f[b]?f[b]:f[b]={s:"_"+b+"Setter",g:"_"+b+"Getter"}},postscript:function(b){b&&this.set(b)},_get:function(b,f){return"function"===typeof this[f.g]?this[f.g]():this[b]},get:function(b){return this._get(b,this._getAttrNames(b))},set:function(b,f){if("object"===typeof b){for(var h in b)b.hasOwnProperty(h)&&"_watchCallbacks"!=h&&this.set(h,b[h]);return this}h=this._getAttrNames(b);var n=this._get(b,h);h=this[h.s];var g;"function"===typeof h?g=h.apply(this,Array.prototype.slice.call(arguments,1)):
this[b]=f;if(this._watchCallbacks){var e=this;m(g,function(){e._watchCallbacks(b,n,f)})}return this},_changeAttrValue:function(b,f){var h=this.get(b);this[b]=f;this._watchCallbacks&&this._watchCallbacks(b,h,f);return this},watch:function(f,h){var l=this._watchCallbacks;if(!l)var n=this,l=this._watchCallbacks=function(c,a,b,e){var g=function(e){if(e){e=e.slice();for(var d=0,k=e.length;d<k;d++)e[d].call(n,c,a,b)}};g(l["_"+c]);e||g(l["*"])};h||"function"!==typeof f?f="_"+f:(h=f,f="*");var g=l[f];"object"!==
typeof g&&(g=l[f]=[]);g.push(h);var e={};e.unwatch=e.remove=function(){var c=b.indexOf(g,h);-1<c&&g.splice(c,1)};return e}})})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Extent ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a){function u(a,c){return Math.ceil((a-c)/(2*c))}function v(a,c){var d=a.paths||a.rings,b,e,k=d.length,g;for(b=0;b<k;b++)for(g=
d[b].length,e=0;e<g;e++){var t=a.getPoint(b,e);a.setPoint(b,e,t.offset(c,0))}return a}function q(a,c){if(!(a instanceof g||a instanceof e))throw console.error("_straightLineDensify: the input geometry is neither polyline nor polygon"),Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var d=a instanceof g,b=[],k;p.forEach(d?a.paths:a.rings,function(a){b.push(k=[]);k.push([a[0][0],a[0][1]]);var d,e,g,t,f,u,q,v,w,h,x,n;for(f=0;f<a.length-1;f++){d=a[f][0];e=a[f][1];g=a[f+
1][0];t=a[f+1][1];q=Math.sqrt((g-d)*(g-d)+(t-e)*(t-e));v=(t-e)/q;w=(g-d)/q;h=q/c;if(1<h){for(u=1;u<=h-1;u++)n=u*c,x=w*n+d,n=v*n+e,k.push([x,n]);u=(q+Math.floor(h-1)*c)/2;x=w*u+d;n=v*u+e;k.push([x,n])}k.push([g,t])}});return d?new g({paths:b,spatialReference:a.spatialReference}):new e({rings:b,spatialReference:a.spatialReference})}function k(a,d,b){d&&(a=q(a,1E6),a=c.webMercatorToGeographic(a,!0));b&&(a=v(a,b));return a}function d(a,c,d){var b=a.x||a[0],e;b>c?(e=u(b,c),a.x?a=a.offset(-2*e*c,0):a[0]=
b+-2*e*c):b<d&&(e=u(b,d),a.x?a=a.offset(-2*e*d,0):a[0]=b+-2*e*d);return a}function w(a,c){var d=-1;p.forEach(c.cutIndexes,function(b,e){var k=c.geometries[e];p.forEach(k.rings||k.paths,function(a,c){p.some(a,function(d){if(!(180>d[0])){d=0;var b,e=a.length,g;for(b=0;b<e;b++)g=a[b][0],d=g>d?g:d;d=Number(d.toFixed(9));d=-360*u(d,180);e=a.length;for(b=0;b<e;b++)g=k.getPoint(c,b),k.setPoint(c,b,g.offset(d,0))}return!0})});b===d?k.rings?p.forEach(k.rings,function(c){a[b]=a[b].addRing(c)}):p.forEach(k.paths,
function(c){a[b]=a[b].addPath(c)}):(d=b,a[b]=k)});return a}function t(t,f,q,x){var n=new b;n.addCallbacks(q,x);f=f||h.defaults.geometryService;var l=[],m=[],r,y,A,z,C,B,G,E,M=0;p.forEach(t,function(c){if(c)if(r||(r=c.spatialReference,y=r._getInfo(),z=(A=r._isWebMercator())?2.0037508342788905E7:180,C=A?-2.0037508342788905E7:-180,B=A?102100:4326,G=new g({paths:[[[z,C],[z,z]]],spatialReference:{wkid:B}}),E=new g({paths:[[[C,C],[C,z]]],spatialReference:{wkid:B}})),y){var b=a.fromJson(c.toJson()),t=c.getExtent();
"point"===c.type?l.push(d(b,z,C)):"multipoint"===c.type?(b.points=p.map(b.points,function(a){return d(a,z,C)}),l.push(b)):"extent"===c.type?(b=t._normalize(null,null,y),l.push(b.rings?new e(b):b)):t?(c=2*u(t.xmin,C)*z,b=0===c?b:v(b,c),t=t.offset(c,0),t.intersects(G)&&t.xmax!==z?(M=t.xmax>M?t.xmax:M,b=k(b,A),m.push(b),l.push("cut")):t.intersects(E)&&t.xmin!==C?(M=2*t.xmax*z>M?2*t.xmax*z:M,b=k(b,A,360),m.push(b),l.push("cut")):l.push(b)):l.push(b)}else l.push(c);else l.push(c)});q=new g;x=u(M,z);for(var W=
-90,ga=x;0<x;){var D=-180+360*x;q.addPath([[D,W],[D,-1*W]]);W*=-1;x--}0<m.length&&0<ga?f?f.cut(m,q,function(a){m=w(m,a);var d=[];p.forEach(l,function(a,b){if("cut"===a){var e=m.shift();t[b].rings&&1<t[b].rings.length&&e.rings.length>=t[b].rings.length?(l[b]="simplify",d.push(e)):l[b]=!0===A?c.geographicToWebMercator(e):e}});0<d.length?f.simplify(d,function(a){p.forEach(l,function(d,b){"simplify"===d&&(l[b]=!0===A?c.geographicToWebMercator(a.shift()):a.shift())});n.callback(l)},function(a){n.errback(a)}):
n.callback(l)},function(a){n.errback(a)}):n.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):(p.forEach(l,function(a,d){if("cut"===a){var b=m.shift();l[d]=!0===A?c.geographicToWebMercator(b):b}}),n.callback(l));return n}function x(a,c,d,b){var e=!1,k;f.isObject(a)&&a&&(f.isArray(a)?a.length&&((k=a[0]&&a[0].declaredClass)&&-1!==k.indexOf("Graphic")?(a=p.map(a,function(a){return a.geometry}),e=a.length?!0:!1):k&&-1!==k.indexOf("esri.geometry.")&&(e=!0)):
(k=a.declaredClass)&&-1!==k.indexOf("FeatureSet")?(a=p.map(a.features||[],function(a){return a.geometry}),e=a.length?!0:!1):k&&-1!==k.indexOf("esri.geometry.")&&(e=!0));e&&c.push({index:d,property:b,value:a})}function A(a,c){var d=[];p.forEach(c,function(c){var b=c.i,e=a[b];c=c.p;var k;if(f.isObject(e)&&e)if(c)if("*"===c[0])for(k in e)e.hasOwnProperty(k)&&x(e[k],d,b,k);else p.forEach(c,function(a){x(f.getObject(a,!1,e),d,b,a)});else x(e,d,b)});return d}function y(a,c){var d=0,b={};p.forEach(c,function(c){var e=
c.index,k=c.property,g=c.value,t=g.length||1,u=a.slice(d,d+t);f.isArray(g)||(u=u[0]);d+=t;delete c.value;k?(b[e]=b[e]||{},b[e][k]=u):b[e]=u});return b}function z(a){for(var c=[],d=0,b=0,e=Math.min,k=Math.max,g=0;g<a.length;g++){for(var t=a[g],f=null,u=0;u<t.length;u++)f=t[u],c.push(f),0===u?b=d=f[0]:(d=e(d,f[0]),b=k(b,f[0]));f&&c.push([(d+b)/2,0])}return c}return{normalizeCentralMeridian:t,_foldCutResults:w,_prepareGeometryForCut:k,_offsetMagnitude:u,_pointNormalization:d,_updatePolyGeometry:v,_straightLineDensify:q,
_createWrappers:function(a){var c=f.isObject(a)?a.prototype:f.getObject(a+".prototype");p.forEach(c.__msigns,function(a){var d=c[a.n];c[a.n]=function(){var c=this,e=[],k,g=new b(r._dfdCanceller);a.f&&r._fixDfd(g);for(k=0;k<a.c;k++)e[k]=arguments[k];var f={dfd:g};e.push(f);var u,q=[],v;c.normalization&&!c._isTable&&(u=A(e,a.a),p.forEach(u,function(a){q=q.concat(a.value)}),q.length&&(v=t(q)));v?(g._pendingDfd=v,v.addCallbacks(function(a){g.canceled||(f.assembly=y(a,u),g._pendingDfd=d.apply(c,e))},function(d){var b=
c.declaredClass;b&&-1!==b.indexOf("FeatureLayer")?c._resolve([d],null,e[a.e],g,!0):c._errorHandler(d,e[a.e],g)})):g._pendingDfd=d.apply(c,e);return g}})},_disassemble:A,_addToBucket:x,_reassemble:y,getDenormalizedExtent:function(a){if(!a)return null;var c=a.getExtent();if(!c)return null;var d=a.spatialReference&&a.spatialReference._getInfo();if(!d)return c;var b=d.valid[0],d=d.valid[1],e=2*d,k=c.getWidth(),g=c.xmax,t=c.xmin;if("extent"===a.type||0===k||k<=d||k>e||g<b||t>d)return c;var f;switch(a.type){case "polygon":if(1<
a.rings.length)f=z(a.rings);else return c;break;case "polyline":if(1<a.paths.length)f=z(a.paths);else return c;break;case "multipoint":f=a.points}a=Math.min;for(var b=Math.max,e=new n(c.toJson()),u=0;u<f.length;u++){var q=f[u][0];0>q?(q+=d,t=b(q,t)):(q-=d,g=a(q,g))}e.xmin=g;e.xmax=t;return e.getWidth()<k?(e.xmin-=d,e.xmax-=d,e):c}}})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(p,f,b,m,l,h,
r,n){return{fromJson:function(b){if(void 0!==b.x&&void 0!==b.y)return new m(b);if(void 0!==b.paths)return new l(b);if(void 0!==b.rings)return new h(b);if(void 0!==b.points)return new r(b);if(void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax)return new n(b)},getJsonType:function(b){return b instanceof m?"esriGeometryPoint":b instanceof l?"esriGeometryPolyline":b instanceof h?"esriGeometryPolygon":b instanceof n?"esriGeometryEnvelope":b instanceof r?"esriGeometryMultipoint":null},getGeometryType:function(b){return"esriGeometryPoint"===
b?m:"esriGeometryPolyline"===b?l:"esriGeometryPolygon"===b?h:"esriGeometryEnvelope"===b?n:"esriGeometryMultipoint"===b?r:null}}})},"esri/InfoWindowBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/dom-construct dojo/has dijit/registry ./kernel ./lang ./geometry/ScreenPoint".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){return p(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var a=f.hitch;this.__set_title=a(this,
this.__set_title);this.__err_title=a(this,this.__err_title);this.__set_content=a(this,this.__set_content);this.__err_content=a(this,this.__err_content)},setMap:function(a){this.map=a},unsetMap:function(a){delete this.map},setTitle:function(){},setContent:function(){},show:function(){},hide:function(){},resize:function(){},onShow:function(){},onHide:function(){},place:function(a,c){e.isDefined(a)?f.isObject(a)?h.place(a,c,"only"):c.innerHTML=a:c.innerHTML=""},startupDijits:function(a){this._processDijits(a)},
destroyDijits:function(a){this._processDijits(a,!0)},_processDijits:function(a,c){if(a&&1===a.children.length){var e=a.children[0];if(e){var g=n.byNode(e),e=g?[g]:n.findWidgets(e);b.forEach(e,function(a){if(c){if(a._started&&!a._destroyed)try{a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy()}catch(d){console.debug("An error occurred when destroying a widget embedded within InfoWindow: "+d.message)}}else if(!a._started)try{a.startup()}catch(d){console.debug("An error occurred when starting a widget embedded within InfoWindow: "+
d.message)}})}}},__registerMapListeners:function(){this.__unregisterMapListeners();var a=this.map;this.__handles=[m.connect(a,"onPan",this,this.__onMapPan),m.connect(a,"onZoomStart",this,this.__onMapZmStart),m.connect(a,"onExtentChange",this,this.__onMapExtChg)]},__unregisterMapListeners:function(){var a=this.__handles;a&&(b.forEach(a,m.disconnect,m),this.__handles=null)},__onMapPan:function(a,c){this.move(c,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new c(this.coords));
this.hide(null,!0)},__onMapExtChg:function(a,c,b){a=this.map;var e=this.mapCoords;e?this.show(e,null,!0):(c=b?a.toScreen(this.__mcoords):this.coords.offset(c&&c.x||0,c&&c.y||0),this.show(c,null,!0))},__setValue:function(a,c){this[a].innerHTML="";var b="_dfd"+a,g=this[b];g&&-1===g.fired&&(g.cancel(),this[b]=null);e.isDefined(c)&&(c instanceof l?(this[b]=c,c.addCallbacks(this["__set"+a],this["__err"+a])):this.__render(a,c))},__set_title:function(a){this._dfd_title=null;this.__render("_title",a)},__err_title:function(a){this._dfd_title=
null},__set_content:function(a){this._dfd_content=null;this.__render("_content",a)},__err_content:function(a){this._dfd_content=null},__render:function(a,c){var b=this[a];this.place(c,b);this.isShowing&&(this.startupDijits(b),"_title"===a&&this._adjustContentArea&&this._adjustContentArea())}})})},"esri/PopupBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has ./kernel ./graphic ./geometry/Point ./geometry/jsonUtils ./geometry/mathUtils ./geometry/webMercatorUtils ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/SimpleFillSymbol ./tasks/query ./Evented require".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w){function t(a){return"sizeInfo"===a.type}return p(w,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",f.hitch(this,this._resetUpdateEndListeners));this.on("dfd-complete",
f.hitch(this,this._processFeatures));this.on("set-features",f.hitch(this,this._processFeatures))},cleanup:function(){this.features=this.deferreds=null;this._resetUpdateEndListeners()},setFeatures:function(a){if(a&&a.length){this.clearFeatures();var c,d;a[0]instanceof l?d=a:c=a;c?this._updateFeatures(null,c):(this.deferreds=d,d=d.slice(0),b.forEach(d,function(a){a.addBoth(f.hitch(this,this._updateFeatures,a))},this))}},clearFeatures:function(){this.features=this.deferreds=this._marked=null;this.count=
0;var a=this.selectedIndex;this.selectedIndex=-1;if(-1<a)this.onSelectionChange();this.onClearFeatures()},getSelectedFeature:function(){var a=this.features;if(a)return a[this.selectedIndex]},select:function(a){0>a||a>=this.count||(this.selectedIndex=a,this.onSelectionChange())},enableHighlight:function(a){this._highlighted=a.graphics.add(new n(new g(0,0,a.spatialReference)));this._highlighted.hide();this.markerSymbol||(a=this.markerSymbol=new u,a.setStyle(u.STYLE_TARGET),a._setDim(16,16,0),a.setOutline(new q(v.STYLE_SOLID,
new m([0,255,255]),2,q.CAP_ROUND,q.JOIN_ROUND)),a.setColor(new m([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new v(v.STYLE_SOLID,new m([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new k(k.STYLE_NULL,new v(v.STYLE_SOLID,new m([0,255,255]),2),new m([0,0,0,0])))},disableHighlight:function(a){var c=this._highlighted;c&&(c.hide(),a.graphics.remove(c),delete this._highlighted);this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var a=this.features&&this.features[this.selectedIndex];
this._highlighted&&a&&a.geometry&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},updateHighlight:function(a,c){var d=c.geometry,b=this._highlighted;if(d&&b){b.hide();!b._graphicsLayer&&a&&a.graphics.add(b);b.setGeometry(e.fromJson(d.toJson()));var k;switch(d.type){case "point":case "multipoint":var g=c.getLayer(),d=c.symbol||g&&g._getSymbol(c);if(g&&d){var t,f,u=0,q=0,v=0;k=c.symbol?null:g._getRenderer(c);if(g=this._getSizeInfo(k))t=f=k.getSize(c,{sizeInfo:g,
shape:d.style,resolution:a&&a.getResolutionInMeters&&a.getResolutionInMeters()});else switch(d.type){case "simplemarkersymbol":t=f=d.size||0;break;case "picturemarkersymbol":t=d.width||0,f=d.height||0}u=d.xoffset||0;q=d.yoffset||0;v=d.angle||0;k=this.markerSymbol;k.setOffset(0,0);k.setAngle(0);t&&f&&k._setDim(t+1,f+1,0);k.setOffset(u,q);k.setAngle(v)}break;case "polyline":k=this.lineSymbol;break;case "polygon":k=this.fillSymbol}b.setSymbol(k)}else b&&b.hide()},showClosestFirst:function(d){var b=this.features;
if(b&&b.length){if(1<b.length){var e,k=Infinity,g=-1,t,f=c.getLength,u,q=d.spatialReference,v,w;d=d.normalize();for(e=b.length-1;0<=e;e--)if(t=b[e].geometry){v=t.spatialReference;u=0;try{w="point"===t.type?t:t.getExtent().getCenter(),w=w.normalize(),q&&v&&!q.equals(v)&&q._canProject(v)&&(w=q.isWebMercator()?a.geographicToWebMercator(w):a.webMercatorToGeographic(w)),u=f(d,w)}catch(P){}0<u&&u<k&&(k=u,g=e)}0<g&&(b.splice(0,0,b.splice(g,1)[0]),this.select(0))}}else this.deferreds&&(this._marked=d)},_unbind:function(a){a=
b.indexOf(this.deferreds,a);if(-1!==a)return this.deferreds.splice(a,1),this.deferreds.length?1:(this.deferreds=null,2)},_fireComplete:function(a){var c=this._marked;c&&(this._marked=null,this.showClosestFirst(c));this.onDfdComplete(a)},_updateFeatures:function(a,c){if(a){if(this.deferreds){var d=this._unbind(a);if(d)if(c&&c instanceof Error){if(this._fireComplete(c),2===d)this.onSetFeatures()}else if(c&&c.length)if(this.features){var e=b.filter(c,function(a){return-1===b.indexOf(this.features,a)},
this);this.features=this.features.concat(e);this.count=this.features.length;this._fireComplete();if(2===d)this.onSetFeatures()}else{this.features=c;this.count=c.length;this.selectedIndex=0;this._fireComplete();if(2===d)this.onSetFeatures();this.select(0)}else if(this._fireComplete(),2===d)this.onSetFeatures()}}else this.features=c,this.count=c.length,this.selectedIndex=0,this.onSetFeatures(),this.select(0)},_getSizeInfo:function(a){return a?a.sizeInfo||b.filter(a.visualVariables,t)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers=
{};b.forEach(this._updateEndHandles,function(a){a.remove()});this._updateEndHandles=[]},_processFeatures:function(){b.forEach(this.features,function(a){(a=a.getLayer())&&!this._featureLayers[a.id]&&(1===a.currentMode||0===a.currentMode&&6===a.mode)&&a.objectIdField&&a.hasXYFootprint&&a.queryFeatures&&("esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType||a.hasXYFootprint())&&(this._featureLayers[a.id]=a,a=a.on("update-end",f.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(a))},
this)},_fLyrUpdateEndHandler:function(a){if(!a.error){var c=this,e=a.target,k=e.getSelectedFeatures(),g=0===e.currentMode&&6===e.mode,t={},f=[];b.forEach(this.features,function(a){if(a.getLayer()===e){var c=a.attributes[e.objectIdField];t[c]=a;f.push(c)}});f.length&&(a=new d,a.objectIds=f,e.queryFeatures(a,function(a){b.forEach(a.features,function(a){var c=t[a.attributes[e.objectIdField]],d=!1;c.geometry!==a.geometry?(c.setGeometry(a.geometry),d=!0):g&&k&&-1!==b.indexOf(k,a)&&(d=!0);d&&this._highlighted&&
c===this.getSelectedFeature()&&this._highlighted.setGeometry(a.geometry)},c)}))}}})})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),function(p,f,b,m,l,h,r,n,g){p=p(null,{declaredClass:"esri.Graphic",constructor:function(b,c,a,f){b&&!b.declaredClass?(this.geometry=b.geometry?n.fromJson(b.geometry):null,this.symbol=b.symbol?g.fromJson(b.symbol):null,this.attributes=b.attributes||
null,this.infoTemplate=b.infoTemplate?new r(b.infoTemplate):null):(this.geometry=b,this.symbol=c,this.attributes=a,this.infoTemplate=f)},_shape:null,_graphicsLayer:null,_visible:!0,visible:!0,getDojoShape:function(){return this._shape},getShapes:function(){var b=[];this._shape&&b.push(this._shape);this._bgShape&&b.push(this._bgShape);return b},getNode:function(){var b=this._shape&&this._shape.getNode();return b&&b.nodeType?b:null},getNodes:function(){var b=this.getShapes(),c,a,g=b.length,f=[];for(a=
0;a<g;a++)(c=b[a]&&b[a].getNode())&&c.nodeType&&f.push(c);return f},getLayer:function(){return this._layer},draw:function(){var b=this._graphicsLayer;b&&b._draw(this,!0);return this},setGeometry:function(b){this.geometry=b;if(b=this._graphicsLayer)b._updateExtent(this),b._draw(this,!0);return this},setSymbol:function(b,c){var a=this._graphicsLayer,e=this._shape;this.symbol=b;a&&(c&&e&&a._removeShape(this),a._draw(this,!0));return this},setAttributes:function(b){this.attributes=b;this._clearCache();
return this},setInfoTemplate:function(b){this.infoTemplate=b;return this},getInfoTemplate:function(){return this._getEffInfoTemplate()},_getEffInfoTemplate:function(){var b=this.getLayer();return this.infoTemplate||b&&b.infoTemplate},getTitle:function(){var b=this.getInfoTemplate(),c=b&&b.title;if(f.isFunction(c))c=c.call(b,this);else if(f.isString(c))var a=(b=this.getLayer())&&b._getDateOpts,c=h.substitute(this.attributes,c,{first:!0,dateFormat:a&&a.call(b)});return c},getContent:function(){var b=
this.getInfoTemplate(),c=b&&b.content;if(f.isFunction(c))c=c.call(b,this);else if(f.isString(c))var a=(b=this.getLayer())&&b._getDateOpts,c=h.substitute(this.attributes,c,{dateFormat:a&&a.call(b)});return c},attr:function(b,c){var a=this.getNodes(),e,g=a.length;for(e=0;e<g;e++)null==c?a[e].removeAttribute(b):a[e].setAttribute(b,c);return this},show:function(){this.visible=this._visible=!0;var b,c,a;if(this.getShapes().length)for(b=this.getNodes(),a=b.length,this.attr("data-hidden"),c=0;c<a;c++)l.show(b[c]);
else this._graphicsLayer&&this._graphicsLayer._draw(this,!0);return this},hide:function(){this.visible=this._visible=!1;var b=this._graphicsLayer,c,a;if(b)if("canvas-2d"===b.surfaceType)b._removeShape(this);else if(b=this.getNodes(),a=b.length)for(this.attr("data-hidden",""),c=0;c<a;c++)l.hide(b[c]);return this},toJson:function(){var b={};this.geometry&&(b.geometry=this.geometry.toJson());this.attributes&&(b.attributes=f.mixin({},this.attributes));this.symbol&&(b.symbol=this.symbol.toJson());this.infoTemplate&&
(b.infoTemplate=this.infoTemplate.toJson());return b},_getView:function(b){return(b=(b=b||this.getLayer())&&b.getMap())&&b._getView()},_getDataValue:function(b,c,a,g){var e=this._getCacheItem(b,c);if(void 0===e.value){var u=null,k=this.attributes,d=b.field;c.hasExpr?u=a.executeFunction(c.compiledFunc,a.createExecContext(this,this._getView(g))):f.isFunction(d)?u=d(this,b):k&&(u=k[d],(b=b.normalizationField)&&this._isValidNumber(u)&&(k=parseFloat(k[b]),u=this._isValidNumber(k)&&0!==k?u/k:null));this._isValidNumber(u)||
(u=null);e.value=u}return e.value},_isValidNumber:function(b){return"number"===typeof b&&!isNaN(b)&&Infinity!==b&&-Infinity!==b},_getCacheItem:function(b,c){var a=this._findCacheItem(b);a?a.version!==c.version&&(a.version=c.version,a.value=void 0):a=this._createCacheItem(b,c);return a},_findCacheItem:function(b){var c,a=this._cache;if(a){var e,g=a.length;for(e=0;e<g;e++){var f=a[e];if(f.variable===b){c=f;break}}}return c},_createCacheItem:function(b,c){var a=this._cache;a||(a=this._cache=[]);var e=
{variable:b,version:c.version,value:void 0};a.push(e);return e},_clearCache:function(){this._cache=null}});p.prototype.getShape=p.prototype.getDojoShape;return p})},"esri/InfoTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(p,f,b,m,l){return p(null,{declaredClass:"esri.InfoTemplate",constructor:function(b,l){b&&f.isObject(b)&&!f.isFunction(b)?f.mixin(this,b):(this.title=b||"${*}",this.content=l||"${*}")},setTitle:function(b){this.title=b;
return this},setContent:function(b){this.content=b;return this},toJson:function(){return l.fixJson({title:this.title,content:this.content})}})})},"esri/symbols/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./SimpleMarkerSymbol ./PictureMarkerSymbol ./SimpleLineSymbol ./CartographicLineSymbol ./SimpleFillSymbol ./PictureFillSymbol ./TextSymbol".split(" "),function(p,f,b,m,l,h,r,n,g,e){return{fromJson:function(c){var a=null;switch(c.type){case "esriSMS":a=new m(c);break;case "esriPMS":a=
new l(c);break;case "esriTS":a=new e(c);break;case "esriSLS":a=void 0!==c.cap?new r(c):new h(c);break;case "esriCLS":a=new r(c);break;case "esriSFS":a=new n(c);break;case "esriPFS":a=new g(c)}return a},getShapeDescriptors:function(c){return c&&c.getShapeDescriptors?c.getShapeDescriptors():{defaultShape:null,fill:null,stroke:null}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol".split(" "),
function(p,f,b,m,l,h,r,n){var g={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};p=p(n,{declaredClass:"esri.symbol.PictureMarkerSymbol",type:"picturemarkersymbol",constructor:function(e,c,a){e?f.isString(e)?(this.url=e,c&&(this.width=c),a&&(this.height=a)):(this.width=m.pt2px(e.width),this.height=m.pt2px(e.height),c=e.imageData,9>b("ie")||!c||(a=this.url,this.url="data:"+(e.contentType||"image")+";base64,"+c,this.imageData=a)):(f.mixin(this,g),this.width=m.pt2px(this.width),this.height=m.pt2px(this.height))},
getStroke:function(){return null},getFill:function(){return null},setWidth:function(b){this.width=b;return this},setHeight:function(b){this.height=b;return this},setUrl:function(b){b!==this.url&&(delete this.imageData,delete this.contentType);this.url=b;return this},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var b=this.url,c=
this.imageData;if(0===b.indexOf("data:"))var a=b,b=c,c=a.indexOf(";base64,")+8,c=a.substr(c);!f.isString(b)||0!==b.indexOf("/")&&0!==b.indexOf("//")&&0!==b.indexOf("./")&&0!==b.indexOf("../")||(b=r.getAbsoluteUrl(b));var a=m.px2pt(this.width),a=isNaN(a)?void 0:a,g=m.px2pt(this.height),g=isNaN(g)?void 0:g,b=h.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriPMS",url:b,imageData:c,contentType:this.contentType,width:a,height:g}));delete b.color;delete b.size;b.imageData||delete b.imageData;
return b}});p.defaultProps=g;return p})},"esri/symbols/CartographicLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./SimpleLineSymbol".split(" "),function(p,f,b,m,l,h,r,n){var g={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_INSIDE_FRAME:"insideframe",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",
STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},e={color:[0,0,0,1],style:g.STYLE_SOLID,width:1,cap:g.CAP_BUTT,join:g.JOIN_MITER,miterLimit:10};p=p(n,{declaredClass:"esri.symbol.CartographicLineSymbol",type:"cartographiclinesymbol",_caps:{butt:"esriLCSButt",round:"esriLCSRound",square:"esriLCSSquare"},_joins:{miter:"esriLJSMiter",round:"esriLJSRound",
bevel:"esriLJSBevel"},constructor:function(c,a,g,v,q,k){c?f.isString(c)?(this.style=c,a&&(this.color=a),void 0!==g&&(this.width=g),v&&(this.cap=v),q&&(this.join=q),void 0!==k&&(this.miterLimit=k)):(this.cap=r.valueOf(this._caps,c.cap),this.join=r.valueOf(this._joins,c.join),this.width=l.pt2px(c.width),this.miterLimit=l.pt2px(c.miterLimit)):(f.mixin(this,e),this.color=new b(this.color),this.width=l.pt2px(this.width),this.miterLimit=l.pt2px(this.miterLimit))},setCap:function(c){this.cap=c;return this},
setJoin:function(c){this.join=c;return this},setMiterLimit:function(c){this.miterLimit=c;return this},getStroke:function(){return f.mixin(this.inherited("getStroke",arguments),{cap:this.cap,join:this.join===g.JOIN_MITER?this.miterLimit:this.join})},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){var c=l.px2pt(this.miterLimit),c=isNaN(c)?void 0:c;return r.fixJson(f.mixin(this.inherited("toJson",
arguments),{type:"esriCLS",cap:this._caps[this.cap],join:this._joins[this.join],miterLimit:c}))}});f.mixin(p,g);p.defaultProps=e;return p})},"esri/symbols/SimpleFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./FillSymbol ./SimpleLineSymbol require".split(" "),function(p,f,b,m,l,h,r,n,g,e){var c={STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forwarddiagonal",
STYLE_BACKWARD_DIAGONAL:"backwarddiagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonalcross",STYLE_FORWARDDIAGONAL:"forwarddiagonal",STYLE_BACKWARDDIAGONAL:"backwarddiagonal",STYLE_DIAGONALCROSS:"diagonalcross"},a={style:c.STYLE_SOLID,color:[0,0,0,.25]};p=p(n,{declaredClass:"esri.symbol.SimpleFillSymbol",type:"simplefillsymbol",_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal",
cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross"},constructor:function(c,e,q){c?f.isString(c)?(this.style=c,void 0!==e&&(this.outline=e),void 0!==q&&(this.color=q)):this.style=r.valueOf(this._styles,c.style):(f.mixin(this,a),this.outline=new g(this.outline),this.color=new b(this.color))},setStyle:function(a){this.style=a;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){var a=this.style;return a===c.STYLE_NULL?null:a===c.STYLE_SOLID?this.color:
f.mixin({},l.defaultPattern,{src:e.toUrl("../images/symbol/sfs/"+a+".png"),width:10,height:10})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){return r.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriSFS",style:this._styles[this.style]}))}});f.mixin(p,c);p.defaultProps=a;return p})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),
function(p,f,b,m,l,h){return p(l,{declaredClass:"esri.symbol.FillSymbol",constructor:function(b){b&&f.isObject(b)&&b.outline&&(this.outline=new h(b.outline))},setOutline:function(b){this.outline=b;return this},toJson:function(){var b=this.inherited("toJson",arguments);this.outline&&(b.outline=this.outline.toJson());return b}})})},"esri/symbols/PictureFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./FillSymbol".split(" "),
function(p,f,b,m,l,h,r,n){var g={xoffset:0,yoffset:0,width:12,height:12};p=p(n,{declaredClass:"esri.symbol.PictureFillSymbol",type:"picturefillsymbol",xscale:1,yscale:1,xoffset:0,yoffset:0,constructor:function(e,c,a,u){e?f.isString(e)?(this.url=e,void 0!==c&&(this.outline=c),void 0!==a&&(this.width=a),void 0!==u&&(this.height=u)):(this.xoffset=m.pt2px(e.xoffset),this.yoffset=m.pt2px(e.yoffset),this.width=m.pt2px(e.width),this.height=m.pt2px(e.height),c=e.imageData,9>b("ie")||!c||(a=this.url,this.url=
"data:"+(e.contentType||"image")+";base64,"+c,this.imageData=a)):(f.mixin(this,g),this.width=m.pt2px(this.width),this.height=m.pt2px(this.height))},setWidth:function(b){this.width=b;return this},setHeight:function(b){this.height=b;return this},setOffset:function(b,c){this.xoffset=b;this.yoffset=c;return this},setUrl:function(b){b!==this.url&&(delete this.imageData,delete this.contentType);this.url=b;return this},setXScale:function(b){this.xscale=b;return this},setYScale:function(b){this.yscale=b;
return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return f.mixin({},m.defaultPattern,{src:this.url,width:this.width*this.xscale,height:this.height*this.yscale,x:this.xoffset,y:this.yoffset})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var b=this.url,c=this.imageData;if(0===b.indexOf("data:"))var a=b,b=c,c=a.indexOf(";base64,")+
8,c=a.substr(c);!f.isString(b)||0!==b.indexOf("/")&&0!==b.indexOf("//")&&0!==b.indexOf("./")&&0!==b.indexOf("../")||(b=r.getAbsoluteUrl(b));var a=m.px2pt(this.width),a=isNaN(a)?void 0:a,g=m.px2pt(this.height),g=isNaN(g)?void 0:g,v=m.px2pt(this.xoffset),v=isNaN(v)?void 0:v,q=m.px2pt(this.yoffset),q=isNaN(q)?void 0:q,b=h.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriPFS",url:b,imageData:c,contentType:this.contentType,width:a,height:g,xoffset:v,yoffset:q,xscale:this.xscale,yscale:this.yscale}));
b.imageData||delete b.imageData;return b}});p.defaultProps=g;return p})},"esri/symbols/TextSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Symbol ./Font".split(" "),function(p,f,b,m,l,h,r,n,g){var e={type:"textsymbol",x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:m.defaultFont,angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},c={start:"left",middle:"center",end:"right"},a={left:"start",center:"middle",right:"end",
justify:"start"},u={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},v=document.createElement("canvas");p=p(n,{declaredClass:"esri.symbol.TextSymbol",angle:0,xoffset:0,yoffset:0,constructor:function(a,c,d){f.mixin(this,e);this.font=new g(this.font);this.color=new r(this.color);a&&(f.isObject(a)?(f.mixin(this,a),this.color&&h.isDefined(this.color[0])&&(this.color=r.toDojoColor(this.color)),this.type="textsymbol",this.font=new g(this.font),this.xoffset=m.pt2px(this.xoffset),
this.yoffset=m.pt2px(this.yoffset),this.angle&&(this.angle*=-1),this.haloSize&&(this.haloSize=m.pt2px(this.haloSize)),this.haloColor&&(this.haloColor=r.toDojoColor(this.haloColor))):(this.text=a,c&&(this.font=c),d&&(this.color=d)));this.setAlign(this.align||this.getSVGAlign())},setFont:function(a){this.font=a;return this},setSize:function(a){this.font.size=a;return this},setAngle:function(a){this.angle=a;return this},setOffset:function(a,c){this.xoffset=a;this.yoffset=c;return this},setHaloColor:function(a){this.haloColor=
a;return this},setHaloSize:function(a){this.haloSize=a;return this},setAlign:function(a){this.align=a;this.setHorizontalAlignment(a&&c[a.toLowerCase()]||"center");return this},setHorizontalAlignment:function(a){this.horizontalAlignment=a;return this},getSVGAlign:function(){var c=this.horizontalAlignment;return c=c&&a[c.toLowerCase()]||"middle"},setVerticalAlignment:function(a){this.verticalAlignment=a;return this},getSVGBaseline:function(){var a=this.verticalAlignment;return a&&u[a.toLowerCase()]||
"alphabetic"},getSVGBaselineShift:function(){return"bottom"===this.verticalAlignment?"super":null},setDecoration:function(a){this.decoration=a;this.font||this.setFont(new g);this.font.setDecoration(a);return this},setRotated:function(a){this.rotated=a;return this},setKerning:function(a){this.kerning=a;return this},setText:function(a){this.text=a;return this},getStroke:function(){return null},getFill:function(){return this.color},getWidth:function(){var a=v&&v.getContext&&v.getContext("2d");if(a){var c=
this.font;a.font=(c.style?c.style:m.defaultFont.style)+" "+(c.weight?c.weight:m.defaultFont.weight)+" "+(c.size?c.size:m.defaultFont.size)+"px "+(c.family?c.family:m.defaultFont.family);return a.measureText(this.text).width}var a=this.getHeight(),c=0,d,b;for(d=0;d<this.text.length;d++)b=this.text.charAt(d),c=b==b.toUpperCase()?c+.7*a:c+.5*a;return c},getHeight:function(){return m.normalizedLength(this.font.size)},getShapeDescriptors:function(){var a=this.font,c;a&&(c={},a.size&&(c.size=a.size),a.style&&
(c.style=a.style),a.variant&&(c.variant=a.variant),a.decoration&&(c.decoration=a.decoration),a.weight&&(c.weight=a.weight),a.family&&(c.family=a.family));return{defaultShape:{type:"text",text:this.text,x:0,y:this.getHeight()/4,align:"middle",decoration:this.decoration||a&&a.decoration,rotated:this.rotated,kerning:this.kerning},font:c,fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=m.px2pt(this.xoffset),c=m.px2pt(this.yoffset),d=m.px2pt(this.haloSize),a=isNaN(a)?void 0:a,c=isNaN(c)?
void 0:c,d=isNaN(d)?void 0:d;return h.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriTS",backgroundColor:this.backgroundColor,borderLineColor:this.borderLineColor,borderLineSize:this.borderLineSize,haloSize:d,haloColor:this.haloColor&&r.toJsonColor(this.haloColor),verticalAlignment:this.verticalAlignment,horizontalAlignment:this.horizontalAlignment,rightToLeft:this.rightToLeft,width:this.width,angle:this.angle&&-1*this.angle,xoffset:a,yoffset:c,text:this.text,rotated:this.rotated,kerning:this.kerning,
font:this.font.toJson()}))}});f.mixin(p,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"});p.defaultProps=e;return p})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),function(p,f,b,m,l,h){p=p(null,{declaredClass:"esri.symbol.Font",constructor:function(h,n,g,e,c){h?f.isObject(h)?f.mixin(this,
h):(this.size=h,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==n&&(this.style=n),void 0!==g&&(this.variant=g),void 0!==e&&(this.weight=e),void 0!==c&&(this.family=c)):f.mixin(this,m.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>b("ie")&&this.size&&f.isString(this.size)&&-1<this.size.indexOf("em")&&(this.size=m.pt2px(12*parseFloat(this.size))+"px");this.size=this._convert2PxSize(this.size)},setSize:function(b){this.size=this._convert2PxSize(b);return this},_convert2PxSize:function(b){var h;
parseFloat(b)==b?h=b:f.isString(b)&&(-1<b.indexOf("pt")?h=m.pt2px(parseFloat(b)):-1<b.indexOf("px")?h=parseFloat(b):-1<b.indexOf("em")?h=m.pt2px(12*parseFloat(b)):-1<b.indexOf("%")&&(h=m.pt2px(.12*parseFloat(b))));return h},setStyle:function(b){this.style=b;return this},setVariant:function(b){this.variant=b;return this},setWeight:function(b){this.weight=b;return this},setFamily:function(b){this.family=b;return this},setDecoration:function(b){this.decoration=b;return this},toJson:function(){return h.fixJson({size:m.px2pt(this.size),
style:this.style,variant:this.variant,decoration:this.decoration,weight:this.weight,family:this.family})}});f.mixin(p,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"});return p})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship require require require".split(" "),
function(p,f,b,m,l,h,r,n){var g=p(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=g.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnDistinctValues:!1,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,resultOffset:null,resultRecordCount:null,resultType:null,sqlFormat:null,quantizationParameters:null,
_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(e){var c={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision,sqlFormat:this.sqlFormat},a=e&&e.geometry||this.geometry,f=this.objectIds,
v=this.outFields,q=this.outSpatialReference,k=this.groupByFieldsForStatistics,d=this.orderByFields,w=this.outStatistics;e=this.distance;a&&(c.geometry=a,c.geometryType=r.getJsonType(a),c.inSR=a.spatialReference.wkid||m.toJson(a.spatialReference.toJson()));f&&(c.objectIds=f.join(","));v&&(c.outFields=v.join(","));this.returnDistinctValues&&(c.returnDistinctValues=!0);k&&(c.groupByFieldsForStatistics=k.join(","));d&&(c.orderByFields=d.join(","));if(w){var t=[];b.forEach(w,function(a){t.push(a.toJson())});
c.outStatistics=m.toJson(t)}q?c.outSR=q.wkid||m.toJson(q.toJson()):a&&(c.outSR=a.spatialReference.wkid||m.toJson(a.spatialReference.toJson()));a=this.timeExtent;c.time=a?a.toJson().join(","):null;(a=this.relationParam)&&this.spatialRelationship===g.SPATIAL_REL_RELATION&&(c.relationParam=a);e&&(c.distance=this.distance,this.hasOwnProperty("units")?c.units=this._units[this.units]||this._units.meters:(console.warn("esri/tasks/query::no distance unit provided, defaulting to meters"),c.units=this._units.meters));
this.hasOwnProperty("start")&&(c.resultOffset=this.start,c.resultRecordCount=10,""===c.where&&(c.where="1\x3d1"));this.hasOwnProperty("num")&&(c.resultRecordCount=this.num);c.resultType=this.resultType;c.pixelSize=this.pixelSize?m.toJson(this.pixelSize.toJson()):null;c.multipatchOption=this.multipatchOption;this.quantizationParameters&&(c.quantizationParameters=m.toJson(this.quantizationParameters));c._ts=this._ts;return c}});f.mixin(g,n);return g})},"esri/tasks/SpatialRelationship":function(){define(["dojo/_base/lang",
"dojo/has","../kernel"],function(p,f,b){return{SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"}})},"esri/plugins/popupManager":function(){define(["../PopupManager"],
function(p){return{add:function(f,b){f.popupManager||(f.popupManager=new p(b),f.popupManager.setMap(f))},remove:function(f){var b=f.popupManager;b&&(b.unsetMap(),f.popupManager=void 0)}}})},"esri/PopupManager":function(){define("./geometry/Extent ./geometry/ScreenPoint ./kernel ./layerUtils ./tasks/query dijit/registry dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/has dojo/on dojo/promise/all dojo/Stateful require".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){var k;
return n(v,{declaredClass:"esri.PopupManager",enabled:!1,map:null,_mapClickHandle:null,_featureLayersCache:{},constructor:function(a){this._mapClickHandler=e.hitch(this,this._mapClickHandler)},setMap:function(a){if(this.map)if(a!==this.map)this.unsetMap();else return;this.map=a;this._setupClickHandler()},unsetMap:function(){this.map&&(this.map=null);this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null)},getMapLayer:function(a){var c;if(a&&(c=a.getLayer())&&(a=c.id,this._featureLayersCache[a])){var d=
a.lastIndexOf("_");-1<d&&(a=a.substring(0,d),c=this.map.getLayer(a))}return c},_enabledSetter:function(a){this.enabled=a;this._setupClickHandler()},_setupClickHandler:function(){this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this.enabled&&this.map&&(this._mapClickHandle=this.map.on("click",this._mapClickHandler))},_mapClickHandler:function(a){var c=this.map.infoWindow,d=a.graphic;c&&this.map.loaded&&(c.clearFeatures&&c.setFeatures?this._showPopup(a):d&&d.getInfoTemplate()&&
this._showInfoWindow(d,a.mapPoint))},_showPopup:function(a){var c=this.map,d=c.infoWindow,b=this,e=[],k=[c.graphics].concat(r.map(c.graphicsLayerIds,c.getLayer,c));r.forEach(k,function(a){a&&a.loaded&&a.infoTemplate&&!a.suspended&&e.push(a)});var u=[];r.forEach(c.layerIds,function(a){(a=c.getLayer(a))&&a.loaded&&!a.suspended&&(b._isImageServiceLayer(a)&&a.infoTemplate?e.push(a):"esri.layers.WMSLayer"===a.declaredClass&&a.getFeatureInfoURL?e.push(a):"esri.layers.ArcGISDynamicMapServiceLayer"!==a.declaredClass&&
"esri.layers.ArcGISTiledMapServiceLayer"!==a.declaredClass||!a.infoTemplates||u.push(a))});this._getSubLayerFeatureLayers(u).then(function(k){e=e.concat(k);k=null;a.graphic&&a.graphic.getInfoTemplate()&&!b._isImageServiceLayer(a.graphic._layer)&&(k=a.graphic);if(e.length||k){var t=b._calculateClickTolerance(e),u=a.screenPoint,q=c.toMap(new f(u.x-t,u.y+t)),t=c.toMap(new f(u.x+t,u.y-t)),v=new p(q.x,q.y,t.x,t.y,c.spatialReference);if(v=v.intersects(c.extent)){var h=new l,w=!!k,n=!0,q=r.map(e,function(d){var e;
h.timeExtent=d.useMapTime?c.timeExtent:null;if(b._isImageServiceLayer(d))h.geometry=a.mapPoint,n=!1,e=d.queryVisibleRasters(h,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),e.addCallback(function(){var a=d.getVisibleRasters();w=w||0<a.length;return a});else if("esri.layers.WMSLayer"===d.declaredClass){e=new g;var k=d._getPopupGraphic(c,a.screenPoint);k?(e.resolve([k]),w=!0):e.resolve([])}else b._featureLayersCache[d.id]||"function"===typeof d.queryFeatures&&(0===d.currentMode||
1===d.currentMode)?(h.geometry=v,e=d.queryFeatures(h),e.addCallback(function(a){a=a.features;a=r.filter(a,function(a){return a.visible});w=w||0<a.length;return a})):(e=new g,k=r.filter(d.graphics,function(a){return a&&a.visible&&v.intersects(a.geometry)}),w=w||0<k.length,e.resolve(k));return e});k&&(t=new g,t.resolve([k]),q.unshift(t));r.some(q,function(a){return!a.isFulfilled()})||w?(d.setFeatures(q),d.show(a.mapPoint,{closestFirst:n})):(d.hide(),d.clearFeatures())}}})},_getSubLayerFeatureLayers:function(c,
b){var d=b||new g,e=[],f=c.length,v=Math.floor(this.map.extent.getWidth()/this.map.width),h=this.map.getScale(),w=!1,n=this,l=0;a:for(;l<f;l++){var p=c[l],I=p.dynamicLayerInfos||p.layerInfos;if(I){var J=null;p._params&&(p._params.layers||p._params.dynamicLayers)&&(J=p.visibleLayers);for(var J=m._getVisibleLayers(I,J),L=m._getLayersForScale(h,I),P=I.length,Q=0;Q<P;Q++){var H=I[Q],K=H.id,V=p.infoTemplates[K];if(!H.subLayerIds&&V&&V.infoTemplate&&-1<r.indexOf(J,K)&&-1<r.indexOf(L,K)){if(!k){w=!0;break a}var S=
p.id+"_"+K,ba=this._featureLayersCache[S];ba&&ba.loadError||(ba||((ba=V.layerUrl)||(ba=H.source?this._getLayerUrl(p.url,"/dynamicLayer"):this._getLayerUrl(p.url,K)),ba=new k(ba,{id:S,drawMode:!1,mode:k.MODE_SELECTION,outFields:this._getOutFields(V.infoTemplate),resourceInfo:V.resourceInfo,source:H.source}),this._featureLayersCache[S]=ba),ba.setDefinitionExpression(p.layerDefinitions&&p.layerDefinitions[K]),ba.setGDBVersion(p.gdbVersion),ba.setInfoTemplate(V.infoTemplate),ba.setMaxAllowableOffset(v),
ba.setUseMapTime(!!p.useMapTime),p.layerDrawingOptions&&p.layerDrawingOptions[K]&&p.layerDrawingOptions[K].renderer&&ba.setRenderer(p.layerDrawingOptions[K].renderer),e.push(ba))}}}}if(w){var N=new g;q(["./layers/FeatureLayer"],function(a){k=a;N.resolve()});N.then(function(){n._getSubLayerFeatureLayers(c,d)})}else{var M=[];r.forEach(e,function(c){if(!c.loaded){var d=new g;a.once(c,"load, error",function(){d.resolve()});M.push(d.promise)}});M.length?u(M).then(function(){e=r.filter(e,function(a){return!a.loadError&&
a.isVisibleAtScale(h)});d.resolve(e)}):(e=r.filter(e,function(a){return a.isVisibleAtScale(h)}),d.resolve(e))}return d.promise},_getLayerUrl:function(a,c){var d=a.indexOf("?");return-1===d?a+"/"+c:a.substring(0,d)+"/"+c+a.substring(d)},_getOutFields:function(a){var c;a.info&&"esri.dijit.PopupTemplate"===a.declaredClass?(c=[],r.forEach(a.info.fieldInfos,function(a){var d=a.fieldName&&a.fieldName.toLowerCase();d&&"shape"!==d&&0!==d.indexOf("relationships/")&&c.push(a.fieldName)})):c=["*"];return c},
_calculateClickTolerance:function(a){var c=6,d,b;r.forEach(a,function(a){if(d=a.renderer)"esri.renderer.SimpleRenderer"===d.declaredClass?((b=d.symbol)&&b.xoffset&&(c=Math.max(c,Math.abs(b.xoffset))),b&&b.yoffset&&(c=Math.max(c,Math.abs(b.yoffset)))):"esri.renderer.UniqueValueRenderer"!==d.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==d.declaredClass||r.forEach(d.infos,function(a){(b=a.symbol)&&b.xoffset&&(c=Math.max(c,Math.abs(b.xoffset)));b&&b.yoffset&&(c=Math.max(c,Math.abs(b.yoffset)))})});
return c},_showInfoWindow:function(a,c){var d=this.map.infoWindow,b=a.geometry,b=b&&"point"===b.type?b:c,k=a.getContent();d.setTitle(a.getTitle());if(k&&e.isString(k.id)){var g=h.byId(k.id);g&&g.set&&/_PopupRenderer/.test(g.declaredClass)&&g.set("showTitle",!1)}d.setContent(k);d.show(b)},_isImageServiceLayer:function(a){return"esri.layers.ArcGISImageServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass}})})},"esri/layerUtils":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(p,f,b,m,l){return{_serializeLayerDefinitions:function(h,l){var n=[],g=/[:;]/;if(h&&(f.forEach(h,function(c,a){c&&(n.push([a,c]),!l&&g.test(c)&&(l=!0))}),0<n.length)){var e;l?(e={},f.forEach(n,function(c){e[c[0]]=c[1]}),e=b.toJson(e)):(e=[],f.forEach(n,function(c){e.push(c[0]+":"+c[1])}),e=e.join(";"));return e}return null},_serializeTimeOptions:function(h,l){if(h){var n=[];f.forEach(h,function(g,e){if(g){var c=g.toJson();l&&-1!==
f.indexOf(l,e)&&(c.useTime=!1);n.push('"'+e+'":'+b.toJson(c))}});if(n.length)return"{"+n.join(",")+"}"}},_getVisibleLayers:function(b,l){var h=[],g,e,c;if(!b)return h;if(l)for(h=l.concat(),c=0;c<b.length;c++)g=b[c],e=f.indexOf(b,g.id),g.subLayerIds&&-1<e&&(h.splice(e,1),h=h.concat(g.subLayerIds));else h=this._getDefaultVisibleLayers(b);return h},_getDefaultVisibleLayers:function(b){var h=[],n;if(!b)return h;for(n=0;n<b.length;n++)0<=b[n].parentLayerId&&-1===f.indexOf(h,b[n].parentLayerId)&&f.some(b,
function(g){return g.id===b[n].parentLayerId})||b[n].defaultVisibility&&h.push(b[n].id);return h},_getLayersForScale:function(b,l){var h=[];if(0<b&&l){var g;for(g=0;g<l.length;g++)if(!(0<=l[g].parentLayerId&&-1===f.indexOf(h,l[g].parentLayerId)&&f.some(l,function(a){return a.id===l[g].parentLayerId}))&&0<=l[g].id){var e=!0,c=l[g].maxScale,a=l[g].minScale;if(0<c||0<a)0<c&&0<a?e=c<=b&&b<=a:0<c?e=c<=b:0<a&&(e=b<=a);e&&h.push(l[g].id)}}return h}}})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang",
"./domReady","./sniff","./_base/window"],function(p,f,b,m,l){var h=l.doc.documentElement;l=m("ie");var r=m("trident"),n=m("opera"),g=Math.floor,e=m("ff"),c=p.boxModel.replace(/-/,""),n={dj_quirks:m("quirks"),dj_opera:n,dj_khtml:m("khtml"),dj_webkit:m("webkit"),dj_safari:m("safari"),dj_chrome:m("chrome"),dj_edge:m("edge"),dj_gecko:m("mozilla"),dj_ios:m("ios"),dj_android:m("android")};l&&(n.dj_ie=!0,n["dj_ie"+g(l)]=!0,n.dj_iequirks=m("quirks"));r&&(n.dj_trident=!0,n["dj_trident"+g(r)]=!0);e&&(n["dj_ff"+
g(e)]=!0);n["dj_"+c]=!0;var a="",u;for(u in n)n[u]&&(a+=u+" ");h.className=f.trim(h.className+" "+a);b(function(){if(!p.isBodyLtr()){var c="dj_rtl dijitRtl "+a.replace(/ /g,"-rtl ");h.className=f.trim(h.className+" "+c+"dj_rtl dijitRtl "+a.replace(/ /g,"-rtl "))}});return m})},"esri/MapNavigationManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/mouse dojo/keys dijit/focus ./kernel ./MouseEvents ./TouchEvents ./PointerEvents ./config ./sniff ./lang ./fx ./graphic ./tileUtils ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./symbols/SimpleFillSymbol".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z){var C=m.connect,B=m.disconnect,E=v("chrome"),G=v("safari"),I=[r.NUMPAD_PLUS,61,187,r.NUMPAD_MINUS,173,189,r.UP_ARROW,r.NUMPAD_8,r.RIGHT_ARROW,r.NUMPAD_6,r.DOWN_ARROW,r.NUMPAD_2,r.LEFT_ARROW,r.NUMPAD_4,r.PAGE_UP,r.NUMPAD_9,r.PAGE_DOWN,r.NUMPAD_3,r.END,r.NUMPAD_1,r.HOME,r.NUMPAD_7];return p(null,{declaredClass:"esri.MapNavigationManager",eventModel:"",constructor:function(b,k){this.map=b;f.mixin(this,k);var g=b.__container;v("esri-pointer")?(this.pointerEvents=
new a(g,{map:b}),this.eventModel="pointer"):v("esri-touch")?(v("ios")||(this.mouseEvents=new e(g,{map:b})),this.touchEvents=new c(g,{map:b,mouseEvents:this.mouseEvents}),this.eventModel="touch"):(this.mouseEvents=new e(g,{map:b}),this.eventModel="mouse");this._zoomRect=new d(null,new z(u.defaults.map.zoomSymbol));this._keyDx=this._keyDy=0;this._adjustPinch=f.hitch(this,this._adjustPinch);this._adjustPinchEnd=f.hitch(this,this._adjustPinchEnd)},_panInit:function(a){var c=this.mouseEvents;h.isLeft(a)&&
this.map.isPan&&!a.shiftKey&&(this._dragOrigin=new t(0,0),f.mixin(this._dragOrigin,a.screenPoint),B(this._panStartHandle),B(this._panHandle),B(this._panEndHandle),this._panStartHandle=C(c,"onMouseDragStart",this,this._panStart),this._panHandle=C(c,"onMouseDrag",this,this._pan),this._panEndHandle=C(c,"onMouseUp",this,this._panEnd),E||G)&&(a.preventDefault(),n.curNode&&n.curNode.blur())},_panStart:function(a){this.map.setCursor("move");this.map.__panStart(a.screenPoint.x,a.screenPoint.y)},_pan:function(a){this.map.__pan(a.screenPoint.x-
this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)},_panEnd:function(a){B(this._panStartHandle);B(this._panHandle);B(this._panEndHandle);this._panStartHandle=this._panHandle=this._panEndHandle=null;var c=this.map;c.__panning&&(c.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y),c.resetMapCursor())},_zoomInit:function(a){var c=this.map,d=this.pointerEvents||this.mouseEvents;(h.isLeft(a)||a.pointerType)&&c.isRubberBandZoom&&a.shiftKey&&(c.setCursor("crosshair"),this._dragOrigin=
f.mixin({},a.screenPoint),this._zoomDir=a.ctrlKey||a.metaKey?-1:1,this.pointerEvents?(this._zoomHandle=C(d,"onSwipeMove",this,this._zoom),this._zoomEndHandle=C(d,"onSwipeEnd",this,this._zoomEnd)):(this._zoomHandle=C(d,"onMouseDrag",this,this._zoom),this._zoomEndHandle=C(d,"onMouseUp",this,this._zoomEnd)),E&&a.preventDefault())},_zoom:function(a){var c=this.map,d=this._normalizeRect(a).offset(c.__visibleRect.x,c.__visibleRect.y);a=c.graphics;var b=this._zoomRect;b.geometry||c.setCursor("crosshair");
b.geometry&&a.remove(b,!0);var e=c.toMap(new t(d.x,d.y)),d=c.toMap(new t(d.x+d.width,d.y+d.height)),d=new A(e.x,e.y,d.x-e.x,e.y-d.y,c.spatialReference);d._originOnly=!0;b.setGeometry(d);a.add(b,!0)},_zoomEnd:function(a){var c=this._zoomRect,d=this.map,b=d.extent,e=d.spatialReference;B(this._zoomHandle);B(this._zoomEndHandle);this._zoomHandle=this._zoomEndHandle=null;if(d._canZoom(this._zoomDir)&&c.getDojoShape()){d.graphics.remove(c);c.geometry=null;a=this._normalizeRect(a);a.x+=d.__visibleRect.x;
a.y+=d.__visibleRect.y;if(-1===this._zoomDir){var k=b.getWidth();a=(k*d.width/a.width-k)/2;e=new x(b.xmin-a,b.ymin-a,b.xmax+a,b.ymax+a,e)}else b=d.toMap({x:a.x,y:a.y+a.height}),a=d.toMap({x:a.x+a.width,y:a.y}),e=new x(b.x,b.y,a.x,a.y,e);d._extentUtil(null,null,e)}c.getDojoShape()&&d.graphics.remove(c,!0);this._zoomDir=0;d.resetMapCursor()},_wheelZoom:function(a,c){var d=this.map;if(!c){if(d.smartNavigation&&!a.shiftKey&&!d._isPanningOrZooming()){d.disableScrollWheelZoom();this._setScrollWheelPan(!0);
this._wheelPan(a);return}var b=a.timeStamp;if(!q.isDefined(b)||0>=b)b=(new Date).getTime();if(100>(this._mwts?b-this._mwts:b))return;this._mwts=b}d._canZoom(a.value)&&d._extentUtil({numLevels:a.value,mapAnchor:a.mapPoint,screenAnchor:a.screenPoint})},_wheelPan:function(a){var c=this.map;if(a.shiftKey&&!c._isPanningOrZooming())this._setScrollWheelPan(!1),c.enableScrollWheelZoom(),this._wheelZoom(a);else{var d=0,b=0;v("ff")?a.axis===a.HORIZONTAL_AXIS?d=-a.detail:b=-a.detail:(d=a.wheelDeltaX,b=a.wheelDeltaY);
c.translate(d,b)}},_setScrollWheelPan:function(a){this.map.isScrollWheelPan=a;this.mouseEvents.enableMouseWheel(a);B(this._mwMacHandle);this._mwMacHandle=null;a&&(this._mwMacHandle=C(this.mouseEvents,"onMouseWheel",this,this._wheelPan))},_recenter:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&this.map.centerAt(a.mapPoint)},_recenterZoom:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&(a.value=a.ctrlKey||a.metaKey?-1:1,this._wheelZoom(a,!0))},_dblClickZoom:function(a){this.map._isPanningOrZooming()||
(a.value=1,this._wheelZoom(a,!0))},_twoFingerTap:function(a){this.map._isPanningOrZooming()||(a.value=-1,this._wheelZoom(a,!0))},_keyDown:function(a){var c=a.keyCode,d=this.map;if(-1!==b.indexOf(I,c)){if(c===r.NUMPAD_PLUS||61===c||187===c)d._extentUtil({numLevels:1});else if(c===r.NUMPAD_MINUS||173===c||189===c)d._extentUtil({numLevels:-1});else{d.__panning||d.__panStart(0,0);switch(c){case r.UP_ARROW:case r.NUMPAD_8:this._keyDy+=10;break;case r.RIGHT_ARROW:case r.NUMPAD_6:this._keyDx-=10;break;case r.DOWN_ARROW:case r.NUMPAD_2:this._keyDy-=
10;break;case r.LEFT_ARROW:case r.NUMPAD_4:this._keyDx+=10;break;case r.PAGE_UP:case r.NUMPAD_9:this._keyDx-=10;this._keyDy+=10;break;case r.PAGE_DOWN:case r.NUMPAD_3:this._keyDx-=10;this._keyDy-=10;break;case r.END:case r.NUMPAD_1:this._keyDx+=10;this._keyDy-=10;break;case r.HOME:case r.NUMPAD_7:this._keyDx+=10;this._keyDy+=10;break;default:return}d.__pan(this._keyDx,this._keyDy)}l.stop(a)}},_keyEnd:function(a){var c=this.map;c.__panning&&a.keyCode!==r.SHIFT&&(c.__panEnd(this._keyDx,this._keyDy),
this._keyDx=this._keyDy=0)},_swipeInit:function(a){var c=this.map,c=c._zoomAnim||c._panAnim;if(a.shiftKey)return!1;c&&c._active&&(c.stop(),c._fire("onEnd",[c.node]));this._dragOrigin=new t(0,0);f.mixin(this._dragOrigin,a.screenPoint);B(this._swipeHandle);B(this._swipeEndHandle);this._swipeHandle=C(this.touchEvents||this.pointerEvents,"onSwipeMove",this,this._swipe);this._swipeEndHandle=C(this.touchEvents||this.pointerEvents,"onSwipeEnd",this,this._swipeEnd)},_swipe:function(a){var c=this.map;c.__panning?
(this._panX=a.screenPoint.x,this._panY=a.screenPoint.y,c.__pan(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)):(c.setCursor("move"),c.__panStart(a.screenPoint.x,a.screenPoint.y))},_swipeEnd:function(a){B(this._swipeHandle);B(this._swipeEndHandle);this._swipeHandle=this._swipeEndHandle=null;var c=this.map;c.__panning&&(c.resetMapCursor(),c.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y))},_pinchInit:function(a){var c=this.map,d=c._zoomAnim||c._panAnim;
d&&d._active?(d.stop(),d._fire("onEnd",[d.node])):c.__panning&&(a.screenPoint=new t(this._panX,this._panY),a.mapPoint=c.toMap(a.screenPoint),this._swipeEnd(a));B(this._pinchHandle);B(this._pinchEndHandle);this._pinchHandle=C(this.touchEvents||this.pointerEvents,"onPinchMove",this,this._pinch);this._pinchEndHandle=C(this.touchEvents||this.pointerEvents,"onPinchEnd",this,this._pinchEnd)},_pinch:function(a){var c=this.map;if(a.screenPoints){this.currLength=y.getLength(a.screenPoints[0],a.screenPoints[1]);
var d;c.__zooming?(d=this.currLength/this._length,this._zoomStartExtent=this.__scaleExtent(c.extent,d,this._dragOrigin),c.__zoom(this._zoomStartExtent,d,this._dragOrigin)):(this._dragOrigin=new t((a.screenPoints[0].x+a.screenPoints[1].x)/2,(a.screenPoints[0].y+a.screenPoints[1].y)/2),this._length=this.currLength,c.__zoomStart(c.extent,this._dragOrigin));this._pinchScale=d;c._fireOnScale(this.currLength/this._length,this._dragOrigin,!0)}},_pinchEnd:function(a){a=this.map;B(this._pinchHandle);B(this._pinchEndHandle);
this._pinchHandle=this._pinchEndHandle=null;this._pinchScale=0;if(a.__zooming&&null===a._zoomAnim){var c=this.currLength/this._length,d=a.extent.getWidth();this._zoomAnimAnchor=a.toMap(this._dragOrigin);this._zoomStartExtent=this.__scaleExtent(a.extent,1/c,this._zoomAnimAnchor);if(a.__tileInfo){var b=w.getCandidateTileInfo(a,a.__tileInfo,this._zoomStartExtent),e=a.__getExtentForLevel(b.lod.level,this._zoomAnimAnchor),g=a.getMinZoom(),t=a.getMaxZoom(),f=e.extent,e=e.lod,q=d/f.getWidth(),v=b.lod.level;
1>c?q>c&&v--:q<c&&v++;v<g?v=g:v>t&&(v=t);v!==b.lod.level&&(e=a.__getExtentForLevel(v,this._zoomAnimAnchor),f=e.extent,e=e.lod);this._zoomEndExtent=f;this._zoomEndLod=e;a._zoomAnim=k.animateRange({range:{start:d/this._zoomStartExtent.getWidth(),end:q},duration:u.defaults.map.zoomDuration,rate:u.defaults.map.zoomRate,onAnimate:this._adjustPinch,onEnd:this._adjustPinchEnd});a._zoomAnim.play();a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin)}else this._zoomEndExtent=
this._zoomStartExtent,a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin),this._adjustPinchEnd()}},_adjustPinch:function(a){var c=this.__scaleExtent(this.map.extent,a,this._zoomAnimAnchor);this.map.__zoom(c,a,this._dragOrigin)},_adjustPinchEnd:function(){var a=this.map,c=a.extent.getWidth()/this._zoomEndExtent.getWidth(),d=this.__scaleExtent(a.extent,1/c,this._zoomAnimAnchor),b=this._dragOrigin,e=this._zoomEndLod;this._zoomStartExtent=this._zoomEndExtent=this._zoomEndLod=
this._dragOrigin=a._zoomAnim=this._zoomAnimAnchor=null;a.__zoomEnd(d,c,b,e,!0)},__scaleExtent:function(a,c,d){d=d||a.getCenter();c=a.expand(c);var b=a.xmin-(c.getWidth()-a.getWidth())*(d.x-a.xmin)/a.getWidth();d=a.ymax-(c.getHeight()-a.getHeight())*(d.y-a.ymax)/a.getHeight();return new x(b,d-c.getHeight(),b+c.getWidth(),d,a.spatialReference)},_normalizeRect:function(a){a=a.screenPoint;var c=this._dragOrigin.x,d=this._dragOrigin.y;a=new A((a.x<c?a.x:c)-this.map.__visibleRect.x,(a.y<d?a.y:d)-this.map.__visibleRect.y,
Math.abs(a.x-c),Math.abs(a.y-d));delete a.spatialReference;0===a.width&&(a.width=1);0===a.height&&(a.height=1);return a},setImmediateClick:function(a){switch(this.eventModel){case "mouse":this.mouseEvents.setImmediateClick(a);break;case "touch":this.touchEvents.setImmediateTap(a);this.mouseEvents&&this.mouseEvents.setImmediateClick(a);break;case "pointer":this.pointerEvents.setImmediateTap(a)}},enablePan:function(){this.disablePan();switch(this.eventModel){case "mouse":this._panInitHandle=C(this.mouseEvents,
"onMouseDown",this,this._panInit);break;case "touch":this._panInitHandle=C(this.mouseEvents,"onMouseDown",this,this._panInit);this._swipeInitHandle=C(this.touchEvents,"onSwipeStart",this,this._swipeInit);break;case "pointer":this._swipeInitHandle=C(this.pointerEvents,"onSwipeStart",this,this._swipeInit)}},disablePan:function(){B(this._panInitHandle);this._panInitHandle=null;B(this._swipeInitHandle);this._swipeInitHandle=null},enableRubberBandZoom:function(){this.disableRubberBandZoom();this._zoomInitHandle=
this.pointerEvents?C(this.pointerEvents,"onSwipeStart",this,this._zoomInit):C(this.mouseEvents,"onMouseDown",this,this._zoomInit)},disableRubberBandZoom:function(){B(this._zoomInitHandle);this._zoomInitHandle=null},enablePinchZoom:function(){this.disablePinchZoom();if("touch"===this.eventModel||"pointer"===this.eventModel)this._pinchInitHandle=C(this.touchEvents||this.pointerEvents,"onPinchStart",this,this._pinchInit)},disablePinchZoom:function(){B(this._pinchInitHandle);this._pinchInitHandle=null},
enableScrollWheelZoom:function(){this.disableScrollWheelZoom();this._wheelHandle=C(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelZoom)},disableScrollWheelZoom:function(){B(this._wheelHandle);this._wheelHandle=null},enableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&(this.disableScrollWheelPan(),this._setScrollWheelPan(!0))},disableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&this._setScrollWheelPan(!1)},enableDoubleClickZoom:function(){this.disableDoubleClickZoom();
switch(this.eventModel){case "mouse":this._dblClickHandle=C(this.mouseEvents,"onDblClick",this,this._dblClickZoom);break;case "touch":this._dblClickHandle=C(this.mouseEvents,"onDblClick",this,this._dblClickZoom);this._dblTapHandle=C(this.touchEvents,"onDoubleTap",this,this._dblClickZoom);this._zoomOutHandle=C(this.touchEvents,"onTwoFingerTap",this,this._twoFingerTap);break;case "pointer":this._dblTapHandle=C(this.pointerEvents,"onDoubleTap",this,this._dblClickZoom),this._zoomOutHandle=C(this.pointerEvents,
"onTwoFingerTap",this,this._twoFingerTap)}},disableDoubleClickZoom:function(){B(this._dblClickHandle);B(this._zoomOutHandle);this._dblTapHandle&&B(this._dblTapHandle);this._dblClickHandle=this._zoomOutHandle=this._dblTapHandle=null},enableShiftDoubleClickZoom:function(){this.disableShiftDoubleClickZoom();this._sDblClickHandle=C(this.pointerEvents||this.mouseEvents,"onDblClick",this,this._recenterZoom)},disableShiftDoubleClickZoom:function(){B(this._sDblClickHandle);this._sDblClickHandle=null},enableClickRecenter:function(){this.disableClickRecenter();
this._recenterHandle=C(this.pointerEvents||this.mouseEvents,"onClick",this,this._recenter)},disableClickRecenter:function(){B(this._recenterHandle);this._recenterHandle=null},enableKeyboardNavigation:function(){this.disableKeyboardNavigation();this._keyHandle=C(this.pointerEvents||this.mouseEvents,"onKeyDown",this,this._keyDown);this._keyEndHandle=C(this.pointerEvents||this.mouseEvents,"onKeyUp",this,this._keyEnd)},disableKeyboardNavigation:function(){B(this._keyHandle);B(this._keyEndHandle);this._keyHandle=
this._keyEndHandle=null},enableNavigation:function(){var a=this.map;a&&a.loaded&&(a.enableDoubleClickZoom(),a.enableClickRecenter(),a.enablePan(),a.enableRubberBandZoom(),this.enablePinchZoom(),a.enableKeyboardNavigation(),a.smartNavigation?this.enableScrollWheelPan():a.enableScrollWheelZoom())},disableNavigation:function(){var a=this.map;a&&a.loaded&&(a.disableDoubleClickZoom(),a.disableClickRecenter(),a.disablePan(),a.disableRubberBandZoom(),this.disablePinchZoom(),a.disableKeyboardNavigation(),
a.disableScrollWheelZoom(),a.smartNavigation&&this.disableScrollWheelPan())},destroy:function(){this.touchEvents&&this.touchEvents.destroy();this.mouseEvents&&this.mouseEvents.destroy();this.pointerEvents&&this.pointerEvents.destroy();var a,c=[this._panInitHandle,this._panStartHandle,this._panHandle,this._panEndHandle,this._zoomInitHandle,this._zoomHandle,this._zoomEndHandle,this._wheelHandle,this._mwMacHandle,this._dblClickHandle,this._zoomOutHandle,this._recenterHandle,this._sDblClickHandle,this._dblTapHandle,
this._keyHandle,this._keyEndHandle,this._swipeInitHandle,this._swipeHandle,this._swipeEndHandle,this._pinchInitHandle,this._pinchHandle,this._pinchEndHandle];for(a=0;a<c.length;a++)B(c[a]);this.map=this.touchEvents=this.mouseEvents=this.eventModel=this.pointerEvents=this._zoomRect=this._dragOrigin=this._panInitHandle=this._panStartHandle=this._panHandle=this._panEndHandle=this._zoomInitHandle=this._zoomHandle=this._zoomEndHandle=this._wheelHandle=this._mwMacHandle=this._dblClickHandle=this._zoomOutHandle=
this._recenterHandle=this._sDblClickHandle=this._dblTapHandle=this._keyHandle=this._keyEndHandle=this._swipeInitHandle=this._swipeHandle=this._swipeEndHandle=this._pinchInitHandle=this._pinchHandle=this._pinchEndHandle=null}})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),function(p,
f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d){var w,t,x=new (f([a,r],{curNode:null,activeStack:[],constructor:function(){var a=n.hitch(this,function(a){b.isDescendant(this.curNode,a)&&this.set("curNode",null);b.isDescendant(this.prevNode,a)&&this.set("prevNode",null)});p.before(h,"empty",a);p.before(h,"destroy",a)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(a,d){var b=this,e=a.document&&a.document.body;if(e){var k=c("pointer-events")?"pointerdown":c("MSPointer")?
"MSPointerDown":c("touch-events")?"mousedown, touchstart":"mousedown",t=g(a.document,k,function(a){a&&a.target&&null==a.target.parentNode||b._onTouchNode(d||a.target,"mouse")}),f=g(e,"focusin",function(a){if(a.target.tagName){var c=a.target.tagName.toLowerCase();"#document"!=c&&"body"!=c&&(q.isFocusable(a.target)?b._onFocusNode(d||a.target):b._onTouchNode(d||a.target))}}),u=g(e,"focusout",function(a){b._onBlurNode(d||a.target)});return{remove:function(){t.remove();f.remove();u.remove();e=t=f=u=null}}}},
_onBlurNode:function(a){a=(new Date).getTime();a<w+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(n.hitch(this,function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<t+100||(this._clearActiveWidgetsTimer=setTimeout(n.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,c){t=(new Date).getTime();
this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);l.contains(a,"dijitPopup")&&(a=a.firstChild);var d=[];try{for(;a;){var b=m.get(a,"dijitPopupParent");if(b)a=k.byId(b).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===u.body())break;a=v.get(a.ownerDocument).frameElement}else{var e=a.getAttribute&&a.getAttribute("widgetId"),g=e&&k.byId(e);!g||"mouse"==c&&g.get("disabled")||d.unshift(e);a=a.parentNode}}}catch(I){}this._setStack(d,
c)},_onFocusNode:function(a){a&&9!=a.nodeType&&(w=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,c){var d=this.activeStack,b=d.length-1,e=a.length-1;if(a[e]!=d[b]){this.set("activeStack",a);var g;for(g=b;0<=g&&d[g]!=a[g];g--)if(b=k.byId(d[g]))b._hasBeenBlurred=!0,b.set("focused",!1),b._focusManager==this&&b._onBlur(c),
this.emit("widget-blur",b,c);for(g++;g<=e;g++)if(b=k.byId(a[g]))b.set("focused",!0),b._focusManager==this&&b._onFocus(c),this.emit("widget-focus",b,c)}},focus:function(a){if(a)try{a.focus()}catch(z){}}}));e(function(){var a=x.registerWin(v.get(document));c("ie")&&g(window,"unload",function(){a&&(a.remove(),a=null)})});d.focus=function(a){x.focus(a)};for(var A in x)/^_/.test(A)||(d.focus[A]="function"==typeof x[A]?n.hitch(x,A):x[A]);x.watch(function(a,c,b){d.focus[a]=b});return x})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),
function(p,f,b,m,l,h,r){var n={_isElementShown:function(g){var e=m.get(g);return"hidden"!=e.visibility&&"collapsed"!=e.visibility&&"none"!=e.display&&"hidden"!=b.get(g,"type")},hasDefaultTabStop:function(g){switch(g.nodeName.toLowerCase()){case "a":return b.has(g,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var e;try{var c=g.contentDocument;if("designMode"in c&&"on"==c.designMode)return!0;e=c.body}catch(a){try{e=g.contentWindow.document.body}catch(u){return!1}}return e&&
("true"==e.contentEditable||e.firstChild&&"true"==e.firstChild.contentEditable);default:return"true"==g.contentEditable}},effectiveTabIndex:function(g){if(!b.get(g,"disabled"))return b.has(g,"tabIndex")?+b.get(g,"tabIndex"):n.hasDefaultTabStop(g)?0:void 0},isTabNavigable:function(b){return 0<=n.effectiveTabIndex(b)},isFocusable:function(b){return-1<=n.effectiveTabIndex(b)},_getTabNavigable:function(g){function e(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&
a.name&&a.name.toLowerCase()}function c(a){return w[e(a)]||a}var a,f,v,q,k,d,w={},t=n._isElementShown,l=n.effectiveTabIndex,m=function(c){for(c=c.firstChild;c;c=c.nextSibling)if(!(1!=c.nodeType||9>=h("ie")&&"HTML"!==c.scopeName)&&t(c)){var g=l(c);if(0<=g){if(0==g)a||(a=c),f=c;else if(0<g){if(!v||g<q)q=g,v=c;if(!k||g>=d)d=g,k=c}g=e(c);b.get(c,"checked")&&g&&(w[g]=c)}"SELECT"!=c.nodeName.toUpperCase()&&m(c)}};t(g)&&m(g);return{first:c(a),last:c(f),lowest:c(v),highest:c(k)}},getFirstInTabbingOrder:function(b,
e){var c=n._getTabNavigable(f.byId(b,e));return c.lowest?c.lowest:c.first},getLastInTabbingOrder:function(b,e){var c=n._getTabNavigable(f.byId(b,e));return c.last?c.last:c.highest}};l.mixin(r,n);return n})},"esri/MouseEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/_base/connect dojo/_base/event ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(p,f,b,m,l,h,r,n,g,e){var c=l.connect,a=l.disconnect;return p([n],{declaredClass:"esri.MouseEvents",
doubleClickDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==m("mac")?1:3,wheelDivisor:2>m("chrome")?360:120,preventPageScroll:!0,map:null,constructor:function(a,e){this.node=a;b.mixin(this,e);var g=function(a){h.stop(a);return!1};m("mozilla")&&f.style(a,"MozUserSelect","none");this._handles=[c(a,"onselectstart",g),c(a,"ondragstart",g),c(a,"onmouseenter",this,this._onMouseEnterHandler),c(a,"onmouseleave",this,this._onMouseLeaveHandler),c(a,"onmousedown",this,this._onMouseDownHandler),
c(a,"onclick",this,this._onClickHandler),c(a,"ondblclick",this,this._onDblClickHandler)];this._onMouseMoveHandler_connect=c(a,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=c(a,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=b.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;this.preventPageScroll=(g=this.map)?g.isScrollWheelZoom||g.isScrollWheelPan:this.preventPageScroll;this.enableMouseWheel(!1)},_fire:function(a,c){if(!this._preventClick||
"onClick"!==a&&"onDblClick"!==a){if(this[a])this[a](c);if(this.map&&this.map[a])this.map[a](c)}},_processEvent:function(a){a=h.fix(a,a.target);var c=this.map,b=c&&c.position;b&&("DOMMouseScroll"===a.type&&3>m("ff")?a.screenPoint=new e(window.scrollX+a.screenX-b.x,window.scrollY+a.screenY-b.y):a.screenPoint=new e(a.pageX-b.x,a.pageY-b.y),a.mapPoint=c.extent?c.toMap(a.screenPoint):new g);a.numPoints=0;return a},_onMouseEnterHandler:function(b){a(this._onKeyDown_connect);a(this._onKeyUp_connect);this._onKeyDown_connect=
c(document,"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=c(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(b))},_onMouseLeaveHandler:function(c){a(this._onKeyDown_connect);a(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(c))},_onMouseMoveHandler:function(a){this._dragEnd?this._dragEnd=!1:this._fire("onMouseMove",this._processEvent(a))},_onMouseDownHandler:function(b){a(this._onMouseMoveHandler_connect);
this._onMouseMoveHandler_connect=null;this.node.setCapture&&this.node.setCapture(!1);a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=c(document,"onmousemove",this,this._onMouseDragHandler);this._startX=b.pageX;this._startY=b.pageY;this._fire("onMouseDown",this._processEvent(b))},_onMouseUpHandler:function(b){var e=this.node;e.releaseCapture&&e.releaseCapture();a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;a(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=
c(e,"onmousemove",this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(b))},_onMouseDragHandler:function(b){a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=c(document,"onmousemove",this,this._onMouseDraggingHandler);a(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=c(document,"onmouseup",this,this._onDragMouseUpHandler);this._docLeaveConnect=c(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",this._processEvent(b))},
_onMouseDraggingHandler:function(a){h.stop(a);this._fire("onMouseDrag",this._processEvent(a))},_onDragMouseUpHandler:function(b){var e=this.node;e.releaseCapture&&e.releaseCapture();this._dragEnd=!0;a(this._docLeaveConnect);a(this._onMouseDragHandler_connect);a(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=null;this._onMouseMoveHandler_connect=c(e,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=c(e,"onmouseup",this,this._onMouseUpHandler);
b=this._processEvent(b);this._fire("onMouseDragEnd",b);this._fire("onMouseUp",b)},_onDocMouseOut:function(a){var c=9>m("ie")?a.toElement:a.relatedTarget,b=c&&c.nodeName.toLowerCase();(!c||m("chrome")&&"html"===b)&&this._onDragMouseUpHandler(a)},_onClickHandler:function(a){a=this._processEvent(a);if(a.pageX===this._startX&&a.pageY===this._startY){clearTimeout(this._clickTimer);var c={},b="movementX"in a,e;for(e in a)if(!b||"webkitMovementX"!==e&&"webkitMovementY"!==e)c[e]=a[e];this._clickEvent=c;this._clickTimer=
setTimeout(this._fireClickEvent,this.doubleClickDuration)}},_fireClickEvent:function(){clearTimeout(this._clickTimer);9>m("ie")&&(this._clickEvent.graphic=r._ieGraphic,delete r._ieGraphic);this._fire("onClick",this._clickEvent)},_onDblClickHandler:function(a){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(a))},_onMouseWheelHandler:function(a){var c=this.map;(c?c.isScrollWheelZoom||c.isScrollWheelPan:this.preventPageScroll)&&h.stop(a);var c=m("ff")||m("mozilla")?-a.detail/
this.mozWheelDivisor:a.wheelDelta/this.wheelDivisor,b=Math.abs(c),b=b<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>c?-b:b;this._fire("onMouseWheel",this._processEvent(a))},_onKeyDownHandler:function(a){this._fire("onKeyDown",a)},_onKeyUpHandler:function(a){this._fire("onKeyUp",a)},enableMouseWheel:function(b){a(this._scrollHandle);this._scrollHandle=c(this.node,m("ff")||m("mozilla")?b?"MozMousePixelScroll":"DOMMouseScroll":"onmousewheel",this,this._onMouseWheelHandler)},setImmediateClick:function(a){this.doubleClickDuration=
a?0:this._initialDuration},preventClickEvents:function(a){this._preventClick=a},destroy:function(){var c=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]),b;for(b=0;b<c.length;b++)a(c[b]);clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=
this._scrollHandle=this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null}})})},"esri/TouchEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/dom ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(p,f,b,m,l,h,r,n,g){return p([r],{declaredClass:"esri.TouchEvents",tapRadius:8,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,map:null,constructor:function(e,c){this.node=e;b.mixin(this,c);f.setSelectable(e,
!1);this._touchStart=b.hitch(this,this._touchStart);this._touchMove=b.hitch(this,this._touchMove);this._touchEnd=b.hitch(this,this._touchEnd);this._touchCancel=b.hitch(this,this._touchCancel);e.addEventListener("touchstart",this._touchStart,!1);e.addEventListener("touchmove",this._touchMove,!1);e.addEventListener("touchend",this._touchEnd,!1);e.addEventListener("touchcancel",this._touchCancel,!1);this.map&&m("ios")&&(this._mouseOver=b.hitch(this,this._mouseOver),this._mouseOut=b.hitch(this,this._mouseOut),
this._mouseDown=b.hitch(this,this._mouseDown),this._mouseUp=b.hitch(this,this._mouseUp),this._mouseClick=b.hitch(this,this._mouseClick),e.addEventListener("mouseover",this._mouseOver,!1),e.addEventListener("mouseout",this._mouseOut,!1),e.addEventListener("mousedown",this._mouseDown,!1),e.addEventListener("mouseup",this._mouseUp,!1),e.addEventListener("click",this._mouseClick,!1));this._numTouches=0;this._nodeTouches=[];this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_touchStart:function(b){var c=
this._touches,a,e=b.changedTouches.length,g,f,k,d,h=(new Date).getTime();if(!(m("android")&&m("safari")&&1===b.targetTouches.length&&b.touches.length===b.targetTouches.length&&b.targetTouches.length===b.changedTouches.length&&0===b.changedTouches[0].identifier&&c[b.changedTouches[0].identifier])){this._addTouch(b);for(a=0;a<e;a++)g=b.changedTouches[a],f=c[g.identifier]={},f.startX=g.pageX,f.startY=g.pageY,f.startTS=h,-1===this._touchIds.indexOf(g.identifier)&&this._touchIds.push(g.identifier);this._swipeActive&&
(k=this._nodeTouches[0]);this._pinchActive&&(d=this._nodeTouches[1]);1===this._numTouches?this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,k))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(b,[k,d]))):2===this._numTouches?this._swipeActive&&(k&&(f=c[this._touchIds[0]],f.startX=k.pageX,f.startY=k.pageY,f.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,k))):this._swipeActive?(this._swipeActive=
!1,this._fire("onSwipeEnd",this._processTouchEvent(b,k))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(b,[k,d])))}},_touchMove:function(b){b.preventDefault();this._updateTouch(b);var c=this._touches,a,e=b.changedTouches.length,g,f,k,d;if(!(m("android")&&m("safari")&&1===b.targetTouches.length&&b.touches.length===b.targetTouches.length&&b.targetTouches.length===b.changedTouches.length&&0===b.changedTouches[0].identifier&&c[b.changedTouches[0].identifier]&&
1<this._touchIds.length)){for(a=0;a<e;a++)if(g=b.changedTouches[a],f=c[g.identifier])k=Math.abs(g.pageX-f.startX),g=Math.abs(g.pageY-f.startY),!f.moved&&(k>=this.tapRadius||g>=this.tapRadius)&&(f.moved=f.absMoved=!0),d=d?d:f.moved;1===this._numTouches?(c=b.changedTouches[0],this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(b,c)):d&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(b,c)))):2===this._numTouches&&(a=this._nodeTouches[0],e=this._nodeTouches[1],this._pinchActive?
this._fire("onPinchMove",this._processTouchEvent(b,[a,e])):d&&(d=c[a.identifier],f=c[e.identifier],c=Math.abs(d.startX-f.startX),d=Math.abs(d.startY-f.startY),f=Math.abs(a.pageX-e.pageX),k=Math.abs(a.pageY-e.pageY),Math.abs(Math.sqrt(f*f+k*k)-Math.sqrt(c*c+d*d))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(b,[a,e])))))}},_touchEnd:function(b){this._removeTouch(b);var c=this._touches,a=b.changedTouches,e,g=a.length,f,k,d=(new Date).getTime(),h=this._touchIds;
for(e=0;e<g;e++)if(k=c[a[e].identifier])k.absMoved&&(f=!0),k.pageX=a[e].pageX,k.pageY=a[e].pageY,k.endTS=d;if(0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,a[0]));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(b,a));else{if(!f){g=Infinity;f=-Infinity;var d=Infinity,t=-Infinity,n=this.tapStartTolerance,l=[],m=!0;for(e=0;e<h.length;e++)k=c[h[e]],l.push(k),
k.startTS<g&&(g=k.startTS),k.startTS>f&&(f=k.startTS),k.endTS<d&&(d=k.endTS),k.endTS>t&&(t=k.endTS),delete c[h[e]];1===l.length&&a[0]&&(c=Math.abs(a[0].pageY-l[0].startY),Math.abs(a[0].pageX-l[0].startX)>=this.tapRadius||c>=this.tapRadius)&&(m=!1);m&&Math.abs(f-g)<=n&&Math.abs(t-d)<=n&&this._basicTap(b,l)}}else 1===this._numTouches&&this._pinchActive&&(e=this._nodeTouches[0],k=c[e.identifier],k.startX=e.pageX,k.startY=e.pageY,this._pinchActive=k.moved=!1,this._fire("onPinchEnd",this._processTouchEvent(b,
[a[0],e])))},_touchCancel:function(b){this._numTouches&&this._touchEnd(b)},_basicTap:function(b,c){var a=(new Date).getTime(),e=this;b=this._processTouchEvent(b,c);this._taps.push({touchInfos:c,ts:a,event:b});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",b);clearTimeout(this._tapTimer);this._immediate?this._analyzeTap(!0):this._tapTimer=setTimeout(function(){var a=e;e=null;clearTimeout(a._tapTimer);a._analyzeTap()},2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration)},
_analyzeTap:function(b){var c=this._taps,a=c[0],e=c[1],g=a.touchInfos,f=e&&e.touchInfos;c.length&&(b||(this._taps=[]),a&&e?g.length===f.length?e.ts-a.ts<=this.doubleTapDuration?(1===g.length?(b=Math.abs(g[0].startX-f[0].startX),g=Math.abs(g[0].startY-f[0].startY),g=b<=this.doubleTapRadius&&g<=this.doubleTapRadius):g=!0,g?this._processedDoubleTap(c):this._processedTap(e)):this._processedTap(e):this._processedTap(e):this._processedTap(a||e))},_processedTap:function(b){var c=b.event;this._fire("onProcessedTap",
c);1===b.touchInfos.length?this._fire("onTap",this._fixEvent(c)):2===b.touchInfos.length&&this._fire("onTwoFingerTap",c)},_processedDoubleTap:function(b){var c=1===b[1].touchInfos.length,a;c&&(a=[this._fixEvent(b[0].event),this._fixEvent(b[1].event)],a[1].relatedEvents=a);b=[b[0].event,b[1].event];b[1].relatedEvents=b;this._fire("onProcessedDoubleTap",b[1]);c&&(this._fire("onDoubleTap",a[1]),this._fire("onDblClick",a[1]))},_addTouch:function(b){var c=b.changedTouches,a=this._nodeTouches,e,g,f;this._numTouches+=
c.length;for(b=0;b<c.length;b++){g=a.length;f=!1;for(e=0;e<g&&!(f=a[e].identifier===c[b].identifier);e++);f?this._numTouches--:a.push(c[b])}for(b=a.length-1;0<=b;b--)l.isDescendant(a[b].target,document.body)||(a.splice(b,1),this._numTouches--);0>this._numTouches&&(this._numTouches=0)},_removeTouch:function(b){var c=[],a=[],e=b.changedTouches,g=this._nodeTouches;this._numTouches-=e.length;0>this._numTouches&&(this._numTouches=0);for(b=0;b<e.length;b++)c.push(e[b].identifier);for(b=g.length-1;0<=b;b--)-1!==
c.indexOf(g[b].identifier)&&a.push(g.splice(b,1)[0]);return a},_updateTouch:function(b){var c=[],a,e=b.changedTouches,g=this._nodeTouches;for(b=0;b<e.length;b++)c.push(e[b].identifier);for(b=0;b<g.length;b++)a=c.indexOf(g[b].identifier),-1!==a&&g.splice(b,1,e[a])},_mouseOver:function(b){this._fire("onMouseOver",this._processMouseEvent(b))},_mouseOut:function(b){this._fire("onMouseOut",this._processMouseEvent(b))},_mouseDown:function(b){this._fire("onMouseDown",this._processMouseEvent(b))},_mouseUp:function(b){this._fire("onMouseUp",
this._processMouseEvent(b))},_mouseClick:function(b){this._fire("onClick",this._processMouseEvent(b))},_fire:function(b,c){if("onDblClick"===b&&this.mouseEvents){this.mouseEvents.preventClickEvents(!0);var a=this;setTimeout(function(){a.mouseEvents.preventClickEvents(!1)},350)}if(this[b])this[b](c);if(this.map&&this.map[b])this.map[b](c)},_fixEvent:function(b){var c={},a;for(a in b)c[a]=b[a];this.map&&(c.screenPoint=c.screenPoints[0],c.mapPoint=c.mapPoints[0]);return c},_processTouchEvent:function(e,
c){var a=this.map,f=a&&a.position,h=0;if(f&&c)if(b.isArray(c)){var q,k;e.screenPoints=[];e.mapPoints=[];for(q=0;q<c.length;q++)c[q]?(k=new g(c[q].pageX-f.x,c[q].pageY-f.y),e.screenPoints.push(k),e.mapPoints.push(a.extent?a.toMap(k):new n)):h++}else e.screenPoint=new g(c.pageX-f.x,c.pageY-f.y),e.mapPoint=a.extent?a.toMap(e.screenPoint):new n;e.numPoints=c?b.isArray(c)?c.length-h:1:0;return e},_processMouseEvent:function(b){var c=this.map,a=c&&c.position;a&&(b.screenPoint=new g(b.pageX-a.x,b.pageY-
a.y),b.mapPoint=c.extent?c.toMap(b.screenPoint):new n);return b},setImmediateTap:function(b){this._immediate=b},destroy:function(){var b=this.node;b.removeEventListener("touchstart",this._touchStart,!1);b.removeEventListener("touchmove",this._touchMove,!1);b.removeEventListener("touchend",this._touchEnd,!1);b.removeEventListener("touchcancel",this._touchCancel,!1);this.map&&(b.removeEventListener("mouseover",this._mouseOver,!1),b.removeEventListener("mouseout",this._mouseOut,!1),b.removeEventListener("mousedown",
this._mouseDown,!1),b.removeEventListener("mouseup",this._mouseUp,!1),b.removeEventListener("click",this._mouseClick,!1));f.setSelectable(b,!0);clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._nodeTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/PointerEvents":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(p,f,b,m,l,h,r,n){return p([h],{declaredClass:"esri.PointerEvents",
tapRadius:8,clickRadius:2,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==m("mac")?1:3,wheelDivisor:120,preventPageScroll:!0,_dragging:!1,constructor:function(b,e){this.node=b;f.mixin(this,e);void 0!==b.style.msTouchAction?b.style.msTouchAction="none":void 0!==b.style.touchAction&&(b.style.touchAction="none");var c=navigator.msPointerEnabled,a=function(a){a.preventDefault()};b.addEventListener("selectstart",a,!1);b.addEventListener("dragstart",
a,!1);this._pointerDown=f.hitch(this,this._pointerDown);this._pointerMove=f.hitch(this,this._pointerMove);this._pointerUp=f.hitch(this,this._pointerUp);this._pointerCancel=f.hitch(this,this._pointerCancel);b.addEventListener(c?"MSPointerDown":"pointerdown",this._pointerDown,!1);b.addEventListener(c?"MSPointerMove":"pointermove",this._pointerMove,!1);b.addEventListener(c?"MSPointerUp":"pointerup",this._pointerUp,!1);b.addEventListener(c?"MSPointerCancel":"pointercancel",this._pointerCancel,!1);this.map&&
(this._mouseOver=f.hitch(this,this._mouseOver),this._mouseOut=f.hitch(this,this._mouseOut),this._mouseLeave=f.hitch(this,this._mouseLeave),this._mouseDown=f.hitch(this,this._mouseDown),this._mouseUp=f.hitch(this,this._mouseUp),this._mouseClick=f.hitch(this,this._mouseClick),this._mouseWheel=f.hitch(this,this._mouseWheel),this._mouseMove=f.hitch(this,this._mouseMove),this._mouseEnter=f.hitch(this,this._mouseEnter),this._onKeyDown=f.hitch(this,this._onKeyDown),this._onKeyUp=f.hitch(this,this._onKeyUp),
b.addEventListener("mouseover",this._mouseOver,!1),b.addEventListener("mouseout",this._mouseOut,!1),b.addEventListener("mouseleave",this._mouseLeave,!1),b.addEventListener("mousedown",this._mouseDown,!1),b.addEventListener("mouseup",this._mouseUp,!1),b.addEventListener("click",this._mouseClick,!1),b.addEventListener("mousewheel",this._mouseWheel,!1),b.addEventListener("mousemove",this._mouseMove,!1),b.addEventListener("mouseenter",this._mouseEnter,!1));this._numTouches=0;this._touches={};this._touchIds=
[];this._taps=[];this._immediate=!1},_pointerDown:function(g){if(-1<b.indexOf(this._touchIds,g.pointerId))this._pointerUp(g);else{var e=this._touches,c=g.target,a=g.pointerId,f=this._touchIds,h,q=(new Date).getTime();h=e[a]={};h.pointerId=a;h.startX=h.pageX=g.pageX;h.startY=h.pageY=g.pageY;h.startTS=q;f.push(a);this._numTouches++;c.setPointerCapture?c.setPointerCapture(a):c.msSetPointerCapture&&c.msSetPointerCapture(a);c=e[f[0]];e=e[f[1]];1!==this._numTouches&&(2===this._numTouches?this._swipeActive&&
(c&&(c.startX=c.pageX,c.startY=c.pageY,c.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(g,c))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(g,c))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(g,[c,e]))))}},_pointerMove:function(b){var e=this._touches,c=this._touchIds,a,g,f;if((a=e[b.pointerId])&&(a.pageX!==b.pageX||a.pageY!==b.pageY))if(a.pageX=b.pageX,a.pageY=b.pageY,g=Math.abs(a.pageX-
a.startX),f=Math.abs(a.pageY-a.startY),!a.moved&&(g>=this.tapRadius||f>=this.tapRadius)&&(a.moved=a.absMoved=!0),1===this._numTouches)this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(b,b)):a.moved&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(b,b)));else if(2===this._numTouches)if(a=e[c[0]],e=e[c[1]],this._pinchActive)this._fire("onPinchMove",this._processTouchEvent(b,[a,e]));else if(a.moved||e.moved){c=Math.abs(a.startX-e.startX);g=Math.abs(a.startY-e.startY);
f=Math.abs(a.pageX-e.pageX);var q=Math.abs(a.pageY-e.pageY);Math.abs(Math.sqrt(f*f+q*q)-Math.sqrt(c*c+g*g))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(b,[a,e])))}},_pointerUp:function(g){var e=this._touches,c,a=this.node,f=g.target,h=g.pointerId,q=this._touchIds,k=q.slice(0),d=b.map(k,function(a){return e[a]}),w=(new Date).getTime();if(c=e[h])if(c.pageX=g.pageX,c.pageY=g.pageY,c.endTS=w,this._numTouches--,f.releasePointerCapture?f.releasePointerCapture(h):
f.msReleasePointerCapture&&f.msReleasePointerCapture(h),0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(g,g));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(g,g));else{if(!c.absMoved){var f=Infinity,h=-Infinity,q=Infinity,w=-Infinity,t=this.tapStartTolerance,n;for(n=0;n<k.length;n++)c=d[n],c.startTS<f&&(f=c.startTS),c.startTS>h&&(h=c.startTS),c.endTS<q&&
(q=c.endTS),c.endTS>w&&(w=c.endTS);Math.abs(h-f)<=t&&Math.abs(w-q)<=t&&this._basicTap(g,d)}}else 1===this._numTouches&&this._pinchActive&&(q.splice(b.indexOf(q,g.pointerId),1),delete e[g.pointerId],c=e[q[0]],c.startX=c.pageX,c.startY=c.pageY,c.moved=!1,document.msElementsFromPoint&&(k=document.msElementsFromPoint(c.pageX,c.pageY),b.some(k,function(c){return c===a})||(this._touches={},this._touchIds=[],this._numTouches=0)),this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(g,[g,c])))},
_pointerCancel:function(b){this._numTouches&&this._pointerUp(b)},_basicTap:function(b,e){var c=(new Date).getTime(),a=this,g=this._immediate;b=this._processTouchEvent(b,e);this._taps.push({touchInfos:e,ts:c,event:b});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",b);clearTimeout(this._tapTimer);c=2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration;this._tapTimer=setTimeout(function(){var c=a;a=null;clearTimeout(c._tapTimer);c._analyzeTap(g)},g?0:c)},_analyzeTap:function(b){var e=
this._taps,c=e[0],a=e[1],g=c.touchInfos,f=a&&a.touchInfos;e.length&&(b||(this._taps=[]),c&&a?g.length===f.length?a.ts-c.ts<=this.doubleTapDuration?(1===g.length?(b=Math.abs(g[0].startX-f[0].startX),g=Math.abs(g[0].startY-f[0].startY),g=b<=this.doubleTapRadius&&g<=this.doubleTapRadius):g=!0,g?this._processedDoubleTap(e):this._processedTap(a)):this._processedTap(a):this._processedTap(a):this._processedTap(c||a))},_processedTap:function(b){var e=b.event;this._fire("onProcessedTap",e);1===b.touchInfos.length?
this._fire("onTap",this._fixEvent(e)):2===b.touchInfos.length&&this._fire("onTwoFingerTap",e)},_processedDoubleTap:function(b){var e=1===b[1].touchInfos.length,c;e&&(c=[this._fixEvent(b[0].event),this._fixEvent(b[1].event)],c[1].relatedEvents=c);b=[b[0].event,b[1].event];b[1].relatedEvents=b;this._fire("onProcessedDoubleTap",b[1]);e&&(this._fire("onDoubleTap",c[1]),this._fire("onDblClick",c[1]))},_mouseOver:function(b){this._fire("onMouseOver",this._processMouseEvent(b))},_mouseMove:function(b){this._dragging?
this._fire("onMouseDrag",this._processMouseEvent(b)):this._fire("onMouseMove",this._processMouseEvent(b))},_mouseOut:function(b){this._fire("onMouseOut",this._processMouseEvent(b))},_mouseLeave:function(b){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseOut",this._processMouseEvent(event))},_mouseDown:function(b){this._downX=b.pageX;this._downY=b.pageY;this._fire("onMouseDown",this._processMouseEvent(b));0===b.button&&
(this._dragging=!0,this._fire("onMouseDragStart",this._processMouseEvent(b)))},_mouseUp:function(b){this._dragging&&(this._dragging=!1,this._fire("onMouseDragEnd",this._processMouseEvent(b)));this._fire("onMouseUp",this._processMouseEvent(b))},_mouseClick:function(b){Math.abs(b.pageX-this._downX)<=this.clickRadius&&Math.abs(b.pageY-this._downY)<=this.clickRadius&&this._fire("onClick",this._processMouseEvent(b))},_mouseWheel:function(b){var e=this.map;(e?e.isScrollWheelZoom||e.isScrollWheelPan:this.preventPageScroll)&&
b.preventDefault();var e=b.wheelDelta?b.wheelDelta/this.wheelDivisor:-b.detail/this.mozWheelDivisor,c=Math.abs(e),c=c<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;b.value=0>e?-c:c;this._fire("onMouseWheel",this._processMouseEvent(b))},_mouseEnter:function(b){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);document.addEventListener("keydown",this._onKeyDown,!1);document.addEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseEnter",
this._processMouseEvent(b))},_onKeyDown:function(b){this._fire("onKeyDown",b)},_onKeyUp:function(b){this._fire("onKeyUp",b)},_fire:function(b,e){if(this[b])this[b](e);if(this.map&&this.map[b])this.map[b](e)},_fixEvent:function(b){var e={},c;for(c in b)e[c]=b[c];e.preventDefault=function(){b.preventDefault()};e.stopPropagation=function(){b.stopPropagation()};this.map&&(e.screenPoint=e.screenPoints[0],e.mapPoint=e.mapPoints[0]);return e},_processTouchEvent:function(b,e){var c=this.map,a=c&&c.position,
g=0;if(a&&e)if(f.isArray(e)){var h,q;b.screenPoints=[];b.mapPoints=[];for(h=0;h<e.length;h++)e[h]?(q=new n(e[h].pageX-a.x,e[h].pageY-a.y),b.screenPoints.push(q),b.mapPoints.push(c.extent?c.toMap(q):new r)):g++}else b.screenPoint=new n(e.pageX-a.x,e.pageY-a.y),b.mapPoint=c.extent?c.toMap(b.screenPoint):new r;b.numPoints=e?f.isArray(e)?e.length-g:1:0;return b},_processMouseEvent:function(b){var e=this.map,c=e&&e.position;c&&(b.screenPoint=new n(b.pageX-c.x,b.pageY-c.y),b.mapPoint=e.extent?e.toMap(b.screenPoint):
new r);return b},setImmediateTap:function(b){this._immediate=b},destroy:function(){var b=this.node;b.removeEventListener("MSPointerDown",this._pointerDown,!1);b.removeEventListener("MSPointerMove",this._pointerMove,!1);b.removeEventListener("MSPointerUp",this._pointerUp,!1);b.removeEventListener("MSPointerCancel",this._pointerCancel,!1);this.map&&(b.removeEventListener("mouseover",this._mouseOver,!1),b.removeEventListener("mousemove",this._mouseMove,!1),b.removeEventListener("mouseout",this._mouseOut,
!1),b.removeEventListener("mouseleave",this._mouseLeave,!1),b.removeEventListener("mousedown",this._mouseDown,!1),b.removeEventListener("mouseup",this._mouseUp,!1),b.removeEventListener("click",this._mouseClick,!1),b.removeEventListener("mouseenter",this._mouseEnter,!1));clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/renderers/jsonUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../Color ../symbols/jsonUtils ./SimpleRenderer ./UniqueValueRenderer ./ClassBreaksRenderer ./VectorFieldRenderer ./DotDensityRenderer ./ScaleDependentRenderer ./TimeClassBreaksAger ./TimeRampAger ./TemporalRenderer ./HeatmapRenderer".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d){return{fromJson:function(a){var b;switch(a.type||""){case "simple":b=new n(a);break;case "uniqueValue":b=new g(a);break;case "classBreaks":b=new e(a);break;case "vectorField":b=new c(a);break;case "scaleDependent":b=this._scaleDependentFromJson(a);break;case "dotDensity":b=this._dotDensityFromJson(a);break;case "temporal":b=this._temporalFromJson(a);break;case "heatmap":b=this._heatmapFromJson(a)}return b},_scaleDependentFromJson:function(a){var c={},b=
a.minScale;c.rendererInfos=p.map(a.rendererInfos,function(a){var c=a.maxScale;a={minScale:b,maxScale:c,renderer:a.renderer&&this.fromJson(a.renderer)};b=c;return a},this);return new u(c)},_dotDensityFromJson:function(c){c.backgroundColor&&f.isArray(c.backgroundColor)&&(c.backgroundColor=h.toDojoColor(c.backgroundColor));0<c.dotSize&&(c.dotSize=m.pt2px(c.dotSize));c.fields&&p.forEach(c.fields,function(a){a&&f.isArray(a.color)&&(a.color=h.toDojoColor(a.color))});c.legendOptions&&(c.legendOptions.backgroundColor&&
f.isArray(c.legendOptions.backgroundColor)&&(c.legendOptions.backgroundColor=h.toDojoColor(c.legendOptions.backgroundColor)),c.legendOptions.outline&&(c.legendOptions.outline=r.fromJson(c.legendOptions.outline)));c.outline&&(c.outline=r.fromJson(c.outline));return new a(c)},_temporalFromJson:function(a){var c,b,d;a=a||{};c=this.fromJson(a.observationRenderer);b=a.latestObservationRenderer?this.fromJson(a.latestObservationRenderer):null;d=a.trackRenderer?this.fromJson(a.trackRenderer):null;a=this._agerFromJson(a.observationAger);
return new k(c,b,d,a)},_agerFromJson:function(a){var c;a=a||{};a.colorRange||a.sizeRange||a.alphaRange?c=this._timeRampFromJson(a):a.agerClassBreakInfos&&(c=this._timeClassBreaksFromJson(a));return c},_timeRampFromJson:function(a){var c,b,d;a.colorRange&&1<a.colorRange.length&&(c=[h.toDojoColor(a.colorRange[0]),h.toDojoColor(a.colorRange[1])]);a.sizeRange&&1<a.sizeRange.length&&(b=[a.sizeRange[0],a.sizeRange[1]]);a.alphaRange&&1<a.alphaRange.length&&(d=[a.alphaRange[0]/255,a.alphaRange[1]/255]);return new q(c,
b,d)},_timeClassBreaksFromJson:function(a){var c=a.agerClassBreakInfos,b,d,e=[],k;b=v.UNIT_DAYS;switch(a.timeUnits){case "esriTimeUnitsSeconds":b=v.UNIT_SECONDS;break;case "esriTimeUnitsMilliseconds":b=v.UNIT_MILLISECONDS;break;case "esriTimeUnitsHours":b=v.UNIT_HOURS;break;case "esriTimeUnitsMinutes":b=v.UNIT_MINUTES;break;case "esriTimeUnitsMonths":b=v.UNIT_MONTHS;break;case "esriTimeUnitsWeeks":b=v.UNIT_WEEKS;break;case "esriTimeUnitsYears":b=v.UNIT_YEARS}for(k=0;k<c.length;k+=1)a=c[k],d={minAge:0,
maxAge:a.oldestAge||Infinity},a.color&&(d.color=h.toDojoColor(a.color)),a.alpha&&(d.alpha=a.alpha/255),d.size=a.size,e[k]=d;return new v(e,b)},_heatmapFromJson:function(a){var c=a.colorStops;c&&c instanceof Array&&p.forEach(c,function(a){a.color=h.toDojoColor(a.color)});return new d(a)}}})},"esri/renderers/SimpleRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(p,f,b,m,l,h,r){return p(r,{declaredClass:"esri.renderer.SimpleRenderer",
constructor:function(b){if(b&&!b.declaredClass){var g=b;this.symbol=(b=g.symbol)&&(b.declaredClass?b:h.fromJson(b));this.label=g.label;this.description=g.description}else this.symbol=b},getSymbol:function(b){return this.symbol},toJson:function(){var b=f.mixin(this.inherited(arguments),{type:"simple",label:this.label,description:this.description,symbol:this.symbol&&this.symbol.toJson()});return l.fixJson(b)}})})},"esri/renderers/Renderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojox/gfx/_base ../kernel ../Color ./arcadeUtils".split(" "),
function(p,f,b,m,l,h,r,n){var g=Math.PI,e=1;return p(null,{declaredClass:"esri.renderer.Renderer",constructor:function(c){this._cache={};if(c&&!c.declaredClass){this.rotationInfo=c.rotationInfo;if(!this.rotationInfo){var a=c.rotationType,b=c.rotationExpression;if(a||b)this.rotationInfo={type:a,expression:b}}this.setRotationInfo(this.rotationInfo);this.setSizeInfo(this._readSizeInfo(c.sizeInfo));this.setColorInfo(this._readColorInfo(c.colorInfo));this.setOpacityInfo(this._readOpacityInfo(c.transparencyInfo));
this.setVisualVariables(this._readVariables(c.visualVariables));this.setAuthoringInfo(c.authoringInfo)}this.getSymbol=f.hitch(this,this.getSymbol)},getSymbol:function(c){},_readSizeInfo:function(c){if(c){var a=c.minSize,e=c.maxSize;a&&(c.minSize="number"===typeof a?l.pt2px(a):this._readSizeInfo(a));e&&(c.maxSize="number"===typeof e?l.pt2px(e):this._readSizeInfo(e));c.stops&&b.forEach(c.stops,function(a){a.size&&"number"===typeof a.size&&(a.size=l.pt2px(a.size))})}return c},_readColorInfo:function(c){c&&
(b.forEach(c.colors,function(a,b){f.isArray(a)&&(c.colors[b]=r.toDojoColor(a))}),b.forEach(c.stops,function(a,b){a.color&&f.isArray(a.color)&&(c.stops[b].color=r.toDojoColor(a.color))}));return c},_readOpacityInfo:function(c){var a;c&&(a=f.mixin({},c),a.transparencyValues&&(a.opacityValues=b.map(a.transparencyValues,function(a){return 1-a/100}),delete a.transparencyValues),a.stops&&(a.stops=b.map(a.stops,function(a){a=f.mixin({},a);a.opacity=1-a.transparency/100;delete a.transparency;return a})));
return a},_readVariables:function(c){c&&(c=b.map(c,function(a){"sizeInfo"===a.type?a=this._readSizeInfo(a):"colorInfo"===a.type?a=this._readColorInfo(a):"transparencyInfo"===a.type&&(a=this._readOpacityInfo(a),a.type="opacityInfo");return a},this));return c},setAuthoringInfo:function(c){this.authoringInfo=c},setRotationInfo:function(c){if(c=this.rotationInfo="string"===typeof c?{field:c}:c){if(c.expression&&!f.isFunction(c.expression)&&!c.field){var a=c.expression.match(this.rotationRE);a&&a[1]&&
(c.field=a[1])}c.rotationType=c.type}this._cache.rotationInfo=this._processRotationInfo(c);return this},rotationRE:/^\[([^\]]+)\]$/i,_processRotationInfo:function(c){return this._createCache(c)},getRotationAngle:function(c,a){var b=this._getVarInfo(a&&a.rotationInfo,"rotationInfo"),e=b.variable,b=this._cache[b.cacheKey],g="arithmetic"===this._getRotationType(e),k=b&&b.hasExpr,d=null;if(e.field||k)d=this._getDataValue(c,e,null,b),null!=d&&(d=(d+(g?-90:0))*(g?-1:1));return d},_getRotationType:function(c){return c&&
("rotationInfo"===c.type?c.rotationType:c.type)},_getDataValue:function(c,a,b,e,g){e||(e=this._getVarInfo(a,b),a=e.variable,e=this._cache[e.cacheKey],"sizeInfo"===b&&(e=e.root));return c._getDataValue(a,e,n,g)},setVisualVariables:function(c){var a=this._cache;b.forEach(this.visualVariables,function(c,b){a.hasOwnProperty(b)&&(a[b]=null)},this);this.visualVariables=c;b.some(c,function(a){return!!a.target})&&c.sort(function(a,c){return a.target===c.target?0:a.target?1:-1});b.forEach(c,function(c,b){"colorInfo"===
c.type?a[b]=this._processColorInfo(c):"opacityInfo"===c.type?a[b]=this._processOpacityInfo(c):"sizeInfo"===c.type?a[b]=this._processSizeInfo(c):"rotationInfo"===c.type&&(a[b]=this._processRotationInfo(c))},this);return this},getVisualVariableValues:function(c){var a=this.visualVariables,e;a&&(e=b.map(a,function(a){var b;switch(a.type){case "sizeInfo":b=this.getSize(c,{sizeInfo:a});break;case "colorInfo":b=this.getColor(c,{colorInfo:a});break;case "opacityInfo":b=this.getOpacity(c,{opacityInfo:a});
break;case "rotationInfo":b=this.getRotationAngle(c,{rotationInfo:a})}return{variable:a,value:b}},this));return e},getFieldsUsedInExpressions:function(){var c=[];b.forEach(this._getCacheObjects(),function(a){a.syntaxTree&&(c=c.concat(n.extractFieldNames(a.syntaxTree)))});c.sort();return b.filter(c,function(a,b){return 0===b||c[b-1]!==a})},hasVisualVariables:function(c,a){return c?!!this.getVisualVariablesForType(c,a):!!(this.getVisualVariablesForType("sizeInfo",a)||this.getVisualVariablesForType("colorInfo",
a)||this.getVisualVariablesForType("opacityInfo",a)||this.getVisualVariablesForType("rotationInfo",a))},getVisualVariablesForType:function(c,a){var e=this.visualVariables,g;!a&&this[c]?("rotationInfo"===c&&(this[c].rotationType=this[c].type),g=[this[c]]):e&&(g=b.filter(e,function(b){return b.type===c&&("string"===typeof a?b.target===a:!1===a?!b.target:!0)}))&&0===g.length&&(g=void 0);return g},setSizeInfo:function(c){this.sizeInfo=this.proportionalSymbolInfo=c;this._cache.sizeInfo=this._processSizeInfo(c);
return this},_processSizeInfo:function(c){return c&&{root:this._createCache(c),minSize:this._createCache(c.minSize),maxSize:this._createCache(c.maxSize)}},_convertExpressionToArcade:function(c){c&&c.expression&&(c.valueExpression="$view.scale")},_getVarInfo:function(c,a){var e;c&&c.type===a?(e=b.indexOf(this.visualVariables,c),c=this.visualVariables[e]):(e=a,c=this[a]);return{variable:c,cacheKey:e}},setProportionalSymbolInfo:function(c){this.setSizeInfo(c);return this},getSize:function(c,a){var b=
this._getVarInfo(a&&a.sizeInfo,"sizeInfo"),e=b.variable,b=this._cache[b.cacheKey],g=null;if(e)var k=e.minSize,g=e.maxSize,k="object"===typeof k&&k?this._getSize(c,k,b&&b.minSize,a):k,g="object"===typeof g&&g?this._getSize(c,g,b&&b.maxSize,a):g,g=this._getSize(c,e,b&&b.root,a,[k,g]);return g},_getSize:function(c,a,b,e,f){var k=a.stops,d=0,q=b&&b.hasExpr,t=b&&b.ipData,h=b&&b.isScaleDriven,u="object"===typeof c&&!!c,v="number"===typeof c?c:null;if(a.field||h||q){var n=e&&e.scale,q=f?f[0]:a.minSize;f=
f?f[1]:a.maxSize;var l=a.minDataValue,m=a.maxDataValue,r=a.valueUnit||"unknown",p=a.valueRepresentation,I=a.scaleBy,J=e&&e.shape;h?v=n:"number"!==typeof v&&u&&(v=this._getDataValue(c,a,null,b));if(!this._isValidNumber(v))return null;if(k)q=this._lookupData(v,t),v=q[0],f=q[1],v===f?d=k[v].size:(v=k[v].size,k=k[f].size,d=v+(k-v)*q[2]);else if(null!=q&&null!=f&&null!=l&&null!=m)v<=l?d=q:v>=m?d=f:(k=(v-l)/(m-l),"area"===I&&J?(q=(v="circle"===J)?g*Math.pow(q/2,2):q*q,k=q+k*((v?g*Math.pow(f/2,2):f*f)-q),
d=v?2*Math.sqrt(k/g):Math.sqrt(k)):d=q+k*(f-q));else if("unknown"===r)null!=q&&null!=l&&(q&&l?(k=v/l,d="circle"===J?2*Math.sqrt(k*Math.pow(q/2,2)):"square"===J||"diamond"===J||"image"===J?Math.sqrt(k*Math.pow(q,2)):k*q):d=v+(q||l),d=d<q?q:d,null!=f&&d>f&&(d=f));else{k=(e&&e.resolution?e.resolution:1)*this._meterIn[r];if("area"===p)d=Math.sqrt(v/g)/k,d*=2;else if(d=v/k,"radius"===p||"distance"===p)d*=2;null!=q&&d<q&&(d=q);null!=f&&d>f&&(d=f)}}else d=k&&k[0]&&k[0].size,null==d&&(d=a.minSize);return d=
isNaN(d)?0:d},getSizeRangeAtScale:function(c,a){var b,e=this._getVarInfo(c,"sizeInfo"),g=this._cache[e.cacheKey],k={scale:a};if((c=e.variable)&&a){var e=c.minSize,d=c.maxSize,f=c.stops;f&&f.length?(e=f[0].size,g=f[f.length-1].size):(e="object"===typeof e&&e?this._getSize({},e,g&&g.minSize,k):e,g="object"===typeof d&&d?this._getSize({},d,g&&g.maxSize,k):d);if(null!=e||null!=g)e>g&&(b=g,g=e,e=b),b={minSize:e,maxSize:g}}return b},setColorInfo:function(c){this.colorInfo=c;this._cache.colorInfo=this._processColorInfo(c);
return this},prepareForViewChange:function(){b.forEach(this._getCacheObjects(),function(c){if(c.dependsOnView||c.isJSFunc)c.version=e++})},_viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,_createCache:function(c){var a=c&&c.valueExpression,b=n.createSyntaxTree(a),g=n.createFunction(b),q=!(!c||!c.expression)||this._viewScaleRE.test(a);return{ipData:this._interpolateData(c),hasExpr:!!a,compiledFunc:g,syntaxTree:b,isScaleDriven:q,dependsOnView:b?n.dependsOnView(b):!1,isJSFunc:f.isFunction(c&&
c.field),version:e++}},_getCacheObjects:function(c){var a;c=c||this._cache;var b=[];for(a in c){var e=c[a];c.hasOwnProperty(a)&&e&&"object"===typeof e&&(e.hasOwnProperty("version")?b.push(e):b=b.concat(this._getCacheObjects(e)))}return b},_processColorInfo:function(c){c&&(b.forEach(c.colors,function(a,b){f.isArray(a)&&(c.colors[b]=new r(a))}),b.forEach(c.stops,function(a,b){a.color&&f.isArray(a.color)&&(c.stops[b].color=new r(a.color))}));return this._createCache(c)},getColor:function(c,a){var b=
this._getVarInfo(a&&a.colorInfo,"colorInfo");return this._getColorComponent(c,b.variable,this._cache[b.cacheKey])},setOpacityInfo:function(c){this.opacityInfo=c;this._cache.opacityInfo=this._processOpacityInfo(c);return this},_processOpacityInfo:function(c){return this._createCache(c)},getOpacity:function(c,a){var b=this._getVarInfo(a&&a.opacityInfo,"opacityInfo");return this._getColorComponent(c,b.variable,this._cache[b.cacheKey],!0)},_getColorComponent:function(c,a,b,e,g){var k="number"===typeof c?
c:null,d=b&&b.hasExpr,f=b&&b.ipData,t;a&&a.field||d?("number"!==typeof k&&"object"===typeof c&&c&&(k=this._getDataValue(c,a,null,b)),this._isValidNumber(k)||(k=null),null!=k&&(t=e?this._getOpacity(k,a,f):this._getColor(k,a,f))):a&&(c=a.stops,e?(t=c&&c[0]&&c[0].opacity,null==t&&(t=a.opacityValues&&a.opacityValues[0])):t=c&&c[0]&&c[0].color||a.colors&&a.colors[0]);g&&(g.data=k,g.value=t);return g||t},_isValidNumber:function(c){return"number"===typeof c&&!isNaN(c)&&Infinity!==c&&-Infinity!==c},_interpolateData:function(c){var a;
if(c)if(c.colors||c.opacityValues){var e=(c.colors||c.opacityValues).length,g=c.minDataValue,f=(c.maxDataValue-g)/(e-1);a=[];for(c=0;c<e;c++)a[c]=g+c*f}else c.stops&&(a=b.map(c.stops,function(a){return a.value}));return a},_getOpacity:function(c,a,b){c=this._lookupData(c,b);var e;a=a||this.opacityInfo;c&&(b=c[0],e=c[1],b===e?e=this._getOpacValue(a,b):(b=this._getOpacValue(a,b),a=this._getOpacValue(a,e),e=b+(a-b)*c[2]));return e},_getOpacValue:function(c,a){return c.opacityValues?c.opacityValues[a]:
c.stops[a].opacity},_getColor:function(c,a,b){c=this._lookupData(c,b);var e;a=a||this.colorInfo;c&&(e=c[0],b=c[1],e=e===b?this._getColorObj(a,e):r.blendColors(this._getColorObj(a,e),this._getColorObj(a,b),c[2]));return e},_getColorObj:function(c,a){return c.colors?c.colors[a]:c.stops[a].color},_lookupData:function(c,a){var e;if(a){var g=0,f=a.length-1;b.some(a,function(a,b){if(c<a)return f=b,!0;g=b;return!1});e=[g,f,(c-a[g])/(a[f]-a[g])]}return e},_meterIn:{inches:1/.0254,feet:1/.3048,yards:1/.9144,
miles:1/1609.344,"nautical-miles":1/1852,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:.001,"decimal-degrees":180/20015077},_writeSizeInfo:function(c){if(c){c=f.mixin({},c);this._convertExpressionToArcade(c);var a=c.minSize,e=c.maxSize;a&&(c.minSize="number"===typeof a?l.px2pt(a):this._writeSizeInfo(a));e&&(c.maxSize="number"===typeof e?l.px2pt(e):this._writeSizeInfo(e));if(a=c.legendOptions)if(c.legendOptions=f.mixin({},a),a=a.customValues)c.legendOptions.customValues=a.slice(0);
c.stops&&(c.stops=b.map(c.stops,function(a){a=f.mixin({},a);a.size&&"number"===typeof a.size&&(a.size=l.px2pt(a.size));return a}))}return c},_writeColorInfo:function(c){c&&(c=f.mixin({},c),c.colors&&(c.colors=b.map(c.colors,function(a){return r.toJsonColor(a)})),c.stops&&(c.stops=b.map(c.stops,function(a){a=f.mixin({},a);a.color&&(a.color=r.toJsonColor(a.color));return a})),c.legendOptions&&(c.legendOptions=f.mixin({},c.legendOptions)));return c},_writeOpacityInfo:function(c){var a;c&&(a=f.mixin({},
c),a.opacityValues&&(a.transparencyValues=b.map(a.opacityValues,function(a){return 100*(1-a)}),delete a.opacityValues),a.stops&&(a.stops=b.map(a.stops,function(a){a=f.mixin({},a);a.transparency=100*(1-a.opacity);delete a.opacity;return a})),a.legendOptions&&(a.legendOptions=f.mixin({},a.legendOptions)));return a},toJson:function(){var c=this.visualVariables,a=f.clone(this.authoringInfo),e=this.getVisualVariablesForType("rotationInfo",!1),g=(e=e&&e[0])&&e.field,q;e&&e===this.rotationInfo&&(q=e.expression||
g&&(f.isFunction(g)?g:"["+g+"]"));c&&(c=b.map(c,function(a){"sizeInfo"===a.type?a=this._writeSizeInfo(a):"colorInfo"===a.type?a=this._writeColorInfo(a):"opacityInfo"===a.type?(a=this._writeOpacityInfo(a),a.type="transparencyInfo"):"rotationInfo"===a.type&&(a=f.mixin({},a));return a},this));a&&b.forEach(a.visualVariables,function(a){"opacityInfo"===a.type&&(a.type="transparencyInfo")});return{rotationType:q&&(this._getRotationType(e)||"geographic"),rotationExpression:q,colorInfo:this._writeColorInfo(this.colorInfo),
transparencyInfo:this._writeOpacityInfo(this.opacityInfo),sizeInfo:this._writeSizeInfo(this.sizeInfo),visualVariables:c,authoringInfo:a}}})})},"esri/renderers/arcadeUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../kernel","../arcade/arcade"],function(p,f,b,m,l){var h={vars:{$feature:"any",$view:"any"}},r=/^\$feature\./i,n={createSyntaxTree:function(b,e){e=e||p.clone(h);var c;try{c=b?l.parseScript(b,e):null}catch(a){c=null}return c},createFunction:function(b,e){e=e||p.clone(h);
var c="string"===typeof b?n.createSyntaxTree(b,e):b,a;try{a=c?l.compileScript(c,e):null}catch(u){a=null}return a},createExecContext:function(b,e){return{vars:{$feature:l.constructFeature(b),$view:e}}},evalSyntaxTree:function(b,e){return l.executeScript(b,e,-1)},executeFunction:function(b,e){return b?b(e,-1):null},extractFieldNames:function(b,e){var c="string"===typeof b?n.createSyntaxTree(b,e):b,c=l.extractFieldLiterals(c),a=[];f.forEach(c,function(c){r.test(c)&&(c=c.replace(r,""),a.push(c))});a.sort();
return f.filter(a,function(c,b){return 0===b||a[b-1]!==c})},dependsOnView:function(b){return l.referencesMember(b,"$view")}};return n})},"esri/arcade/arcade":function(){define("require exports ./arcadeRuntime ./parser ./Feature ./arcadeCompiler dojo/has".split(" "),function(p,f,b,m,l,h,r){f.compileScript=function(f,g){return r("csp-restrictions")?function(e,c){return b.executeScript(f,e,c)}:h.compileScript(f,g)};f.constructFeature=function(b){return l.fromFeature(b)};f.parseScript=function(b){return m.parseScript(b)};
f.validateScript=function(b,g){return m.validateScript(b,g,"simple")};f.scriptCheck=function(b,g,e){return m.scriptCheck(b,g,e,"full")};f.parseAndExecuteScript=function(f,g,e){return b.executeScript(m.parseScript(f),g,e)};f.executeScript=function(f,g,e){return b.executeScript(f,g,e)};f.referencesMember=function(f,g){return b.referencesMember(f,g)};f.referencesFunction=function(f,g){return b.referencesFunction(f,g)};f.extractFieldLiterals=function(b,g){void 0===g&&(g=!1);return m.extractFieldLiterals(b,
g)}})},"esri/arcade/arcadeRuntime":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./FunctionWrapper ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y){function z(a,
c){for(var b=[],d=0;d<c.arguments.length;d++)b.push(B(a,c.arguments[d]));return b}function C(a,c,b){try{return b(a,c,z(a,c))}catch(ea){throw ea;}}function B(b,d){try{switch(d.type){case "EmptyStatement":return e.voidOperation;case "VariableDeclarator":var k=null===d.init?null:B(b,d.init);k===e.voidOperation&&(k=null);var g=d.id.name.toLowerCase();null!==b.localScope?b.localScope[g]={value:k,valueset:!0,node:d.init}:b.globalScope[g]={value:k,valueset:!0,node:d.init};return e.voidOperation;case "VariableDeclaration":for(var f=
0;f<d.declarations.length;f++)B(b,d.declarations[f]);return e.voidOperation;case "BlockStatement":var t;a:{for(var q=e.voidOperation,f=0;f<d.body.length;f++)if(q=B(b,d.body[f]),q instanceof e.ReturnResult||q===e.breakResult||q===e.continueResult){t=q;break a}t=q}return t;case "FunctionDeclaration":var h=d.id.name.toLowerCase();b.globalScope[h]={valueset:!0,node:null,value:new v(d,b)};return e.voidOperation;case "ReturnStatement":var w;if(null===d.argument)w=new e.ReturnResult(e.voidOperation);else{var l=
B(b,d.argument);w=new e.ReturnResult(l)}return w;case "IfStatement":var n;if("AssignmentExpression"===d.test.type||"UpdateExpression"===d.test.type)throw Error(c.nodeErrorMessage(d.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var x=B(b,d.test);if(!0===x)n=B(b,d.consequent);else if(!1===x)n=null!==d.alternate?B(b,d.alternate):e.voidOperation;else throw Error(c.nodeErrorMessage(d,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));return n;case "ExpressionStatement":var m;if("AssignmentExpression"===
d.expression.type||"UpdateExpression"===d.expression.type)m=B(b,d.expression);else{var r=B(b,d.expression);m=r===e.voidOperation?e.voidOperation:new e.ImplicitResult(r)}return m;case "AssignmentExpression":var A;var z=B(b,d.right),f=null,y="";if("MemberExpression"===d.left.type){f=B(b,d.left.object);y=!0===d.left.computed?B(b,d.left.property):d.left.property.name;if(e.isArray(f))if(e.isNumber(y)){0>y&&(y=f.length+y);if(0>y||y>f.length)throw Error("Assignment outside of array bounds");if(y===f.length&&
"\x3d"!==d.operator)throw Error("Invalid Parameter");f[y]=G(z,d.operator,f[y],d)}else throw Error("Invalid Parameter");else if(f instanceof a){if(!1===e.isString(y))throw Error("Dictionary accessor must be a string");if(!0===f.hasField(y))f.setField(y,G(z,d.operator,f.field(y),d));else{if("\x3d"!==d.operator)throw Error("Invalid Parameter");f.setField(y,G(z,d.operator,null,d))}}else if(f instanceof u){if(!1===e.isString(y))throw Error("Feature accessor must be a string");if(!0===f.hasField(y))f.setField(y,
G(z,d.operator,f.field(y),d));else{if("\x3d"!==d.operator)throw Error("Invalid Parameter");f.setField(y,G(z,d.operator,null,d))}}else{if(e.isImmutableArray(f))throw Error("Array is Immutable");throw Error("Invalid Parameter");}A=e.voidOperation}else if(f=d.left.name.toLowerCase(),null!==b.localScope&&void 0!==b.localScope[f])b.localScope[f]={value:G(z,d.operator,b.localScope[f].value,d),valueset:!0,node:d.right},A=e.voidOperation;else if(void 0!==b.globalScope[f])b.globalScope[f]={value:G(z,d.operator,
b.globalScope[f].value,d),valueset:!0,node:d.right},A=e.voidOperation;else throw Error("Variable not recognised");return A;case "UpdateExpression":var p;var C,f=null,y="";if("MemberExpression"===d.argument.type){f=B(b,d.argument.object);y=!0===d.argument.computed?B(b,d.argument.property):d.argument.property.name;if(e.isArray(f))if(e.isNumber(y)){0>y&&(y=f.length+y);if(0>y||y>=f.length)throw Error("Assignment outside of array bounds");C=e.toNumber(f[y]);f[y]="++"===d.operator?C+1:C-1}else throw Error("Invalid Parameter");
else if(f instanceof a){if(!1===e.isString(y))throw Error("Dictionary accessor must be a string");if(!0===f.hasField(y))C=e.toNumber(f.field(y)),f.setField(y,"++"===d.operator?C+1:C-1);else throw Error("Invalid Parameter");}else if(f instanceof u){if(!1===e.isString(y))throw Error("Feature accessor must be a string");if(!0===f.hasField(y))C=e.toNumber(f.field(y)),f.setField(y,"++"===d.operator?C+1:C-1);else throw Error("Invalid Parameter");}else{if(e.isImmutableArray(f))throw Error("Array is Immutable");
throw Error("Invalid Parameter");}p=!1===d.prefix?C:"++"===d.operator?C+1:C-1}else if(f=d.argument.name.toLowerCase(),null!==b.localScope&&void 0!==b.localScope[f])C=e.toNumber(b.localScope[f].value),b.localScope[f]={value:"++"===d.operator?C+1:C-1,valueset:!0,node:d},p=!1===d.prefix?C:"++"===d.operator?C+1:C-1;else if(void 0!==b.globalScope[f])C=e.toNumber(b.globalScope[f].value),b.globalScope[f]={value:"++"===d.operator?C+1:C-1,valueset:!0,node:d},p=!1===d.prefix?C:"++"===d.operator?C+1:C-1;else throw Error("Variable not recognised");
return p;case "BreakStatement":return e.breakResult;case "ContinueStatement":return e.continueResult;case "ForStatement":null!==d.init&&B(b,d.init);y={testResult:!0,lastAction:e.voidOperation};do b:{A=b;z=d;p=y;if(null!==z.test){p.testResult=B(A,z.test);if(!1===p.testResult)break b;if(!0!==p.testResult)throw Error(c.nodeErrorMessage(z,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}p.lastAction=B(A,z.body);p.lastAction===e.breakResult?p.testResult=!1:p.lastAction instanceof e.ReturnResult?p.testResult=
!1:null!==z.update&&B(A,z.update)}while(!0===y.testResult);f=y.lastAction instanceof e.ReturnResult?y.lastAction:e.voidOperation;return f;case "ForInStatement":return E(b,d);case "Identifier":var I;var H;try{var na=d.name.toLowerCase();if(null!==b.localScope&&void 0!==b.localScope[na])H=b.localScope[na],!0!==H.valueset&&(H.value=B(b,H.node),H.valueset=!0),I=H.value;else if(void 0!==b.globalScope[na])H=b.globalScope[na],!0!==H.valueset&&(H.value=B(b,H.node),H.valueset=!0),I=H.value;else throw Error(c.nodeErrorMessage(d,
"RUNTIME","VARIABLENOTFOUND"));}catch(ra){throw ra;}return I;case "MemberExpression":return J(b,d);case "Literal":return d.value;case "ThisExpression":throw Error(c.nodeErrorMessage(d,"RUNTIME","NOTSUPPORTED"));case "CallExpression":return Q(b,d);case "UnaryExpression":return L(b,d);case "BinaryExpression":return P(b,d);case "LogicalExpression":var S;a:try{if("AssignmentExpression"===d.left.type||"UpdateExpression"===d.left.type)throw Error(c.nodeErrorMessage(d.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));
if("AssignmentExpression"===d.right.type||"UpdateExpression"===d.right.type)throw Error(c.nodeErrorMessage(d.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var K=[B(b,d.left),B(b,d.right)],M=K[0],V=K[1];if(e.isBoolean(M)&&e.isBoolean(V))switch(d.operator){case "||":S=M||V;break a;case "\x26\x26":S=M&&V;break a;default:throw Error(c.nodeErrorMessage(d,"RUNTIME","ONLYORORAND"));}else throw Error(c.nodeErrorMessage(d,"RUNTIME","ONLYBOOLEAN"));}catch(ra){throw ra;}return S;case "ConditionalExpression":throw Error(c.nodeErrorMessage(d,
"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{for(f=[],y=0;y<d.elements.length;y++){var W=B(b,d.elements[y]);if(e.isFunctionParameter(W))throw Error(c.nodeErrorMessage(d,"RUNTIME","FUNCTIONCONTEXTILLEGAL"));W===e.voidOperation?f.push(null):f.push(W)}}catch(ra){throw ra;}return f;case "ObjectExpression":f={};for(y=0;y<d.properties.length;y++){var D=B(b,d.properties[y]);if(e.isFunctionParameter(D.value))throw Error("Illegal Argument");if(!1===e.isString(D.key))throw Error("Illegal Argument");
f[D.key.toString()]=D.value===e.voidOperation?null:D.value}var ja=new a(f);ja.immutable=!1;return ja;case "Property":return{key:"Identifier"===d.key.type?d.key.name:B(b,d.key),value:B(b,d.value)};case "Array":throw Error(c.nodeErrorMessage(d,"RUNTIME","NOTSUPPORTED"));default:throw Error(c.nodeErrorMessage(d,"RUNTIME","UNREOGNISED"));}}catch(ra){throw ra;}}function E(b,d){var k=B(b,d.right);"VariableDeclaration"===d.left.type&&B(b,d.left);var g=null,f="VariableDeclaration"===d.left.type?d.left.declarations[0].id.name:
d.left.name;null!==b.localScope&&void 0!==b.localScope[f]&&(g=b.localScope[f]);null===g&&void 0!==b.globalScope[f]&&(g=b.globalScope[f]);if(null===g)throw Error(c.nodeErrorMessage(d,"RUNTIME","VARIABLENOTDECLARED"));if(e.isArray(k)||e.isString(k)){for(var k=k.length,t=0;t<k&&(g.value=t,f=B(b,d.body),f!==e.breakResult);t++)if(f instanceof e.ReturnResult)return f;return e.voidOperation}if(e.isImmutableArray(k)){for(t=0;t<k.length()&&(g.value=t,f=B(b,d.body),f!==e.breakResult);t++)if(f instanceof e.ReturnResult)return f;
return e.voidOperation}if(k instanceof a||k instanceof u)for(k=k.keys(),t=0;t<k.length&&(g.value=k[t],f=B(b,d.body),f!==e.breakResult);t++){if(f instanceof e.ReturnResult)return f}else return e.voidOperation}function G(a,b,d,k){switch(b){case "\x3d":return a===e.voidOperation?null:a;case "/\x3d":return e.toNumber(d)/e.toNumber(a);case "*\x3d":return e.toNumber(d)*e.toNumber(a);case "-\x3d":return e.toNumber(d)-e.toNumber(a);case "+\x3d":return e.isString(d)||e.isString(a)?e.toString(d)+e.toString(a):
e.toNumber(d)+e.toNumber(a);case "%\x3d":return e.toNumber(d)%e.toNumber(a);default:throw Error(c.nodeErrorMessage(k,"RUNTIME","OPERATORNOTRECOGNISED"));}}function I(b,d,k,g){d=d.toLowerCase();switch(d){case "hasz":return b=b.hasZ,void 0===b?!1:b;case "hasm":return b=b.hasM,void 0===b?!1:b;case "spatialreference":return d=b.spatialReference._arcadeCacheId,void 0===d&&(k=!0,Object.freeze&&Object.isFrozen(b.spatialReference)&&(k=!1),k&&(ga++,d=b.spatialReference._arcadeCacheId=ga)),b=new a({wkt:b.spatialReference.wkt,
wkid:b.spatialReference.wkid}),void 0!==d&&(b._arcadeCacheId="SPREF"+d.toString()),b}switch(b.type){case "extent":switch(d){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return b=b[d],void 0!==b?b:null;case "type":return"Extent"}break;case "polygon":switch(d){case "rings":return d=e.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===d&&(ga++,d=ga,e.isVersion4?b.cache._arcadeCacheId=d:b.setCacheValue("_arcadeCacheId",d)),b=
new x(b.rings,b.spatialReference,!0===b.hasZ,!0===b.hasM,d);case "type":return"Polygon"}break;case "point":switch(d){case "x":case "y":case "z":case "m":return void 0!==b[d]?b[d]:null;case "type":return"Point"}break;case "polyline":switch(d){case "paths":return d=e.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===d&&(ga++,d=ga,e.isVersion4?b.cache._arcadeCacheId=d:b.setCacheValue("_arcadeCacheId",d)),b=new x(b.paths,b.spatialReference,!0===b.hasZ,!0===b.hasM,d);case "type":return"Polyline"}break;
case "multipoint":switch(d){case "points":return d=e.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===d&&(ga++,d=ga,e.isVersion4?b.cache._arcadeCacheId=d:b.setCacheValue("_arcadeCacheId",d)),b=new A(b.points,b.spatialReference,!0===b.hasZ,!0===b.hasM,d,1);case "type":return"Multipoint"}}throw Error(c.nodeErrorMessage(g,"RUNTIME","PROPERTYNOTFOUND"));}function J(b,d){try{var k=B(b,d.object);if(null===k)throw Error(c.nodeErrorMessage(d,"RUNTIME","NOTFOUND"));if(!1===d.computed){if(k instanceof
a||k instanceof u)return k.field(d.property.name);if(k instanceof y)return I(k,d.property.name,b,d);throw Error(c.nodeErrorMessage(d,"RUNTIME","INVALIDTYPE"));}var g=B(b,d.property);if(k instanceof a||k instanceof u){if(e.isString(g))return k.field(g)}else if(k instanceof y){if(e.isString(g))return I(k,g,b,d)}else if(e.isArray(k)){if(e.isNumber(g)&&isFinite(g)&&Math.floor(g)===g){0>g&&(g=k.length+g);if(g>=k.length||0>g)throw Error(c.nodeErrorMessage(d,"RUNTIME","OUTOFBOUNDS"));return k[g]}}else if(e.isString(k)){if(e.isNumber(g)&&
isFinite(g)&&Math.floor(g)===g){0>g&&(g=k.length+g);if(g>=k.length||0>g)throw Error(c.nodeErrorMessage(d,"RUNTIME","OUTOFBOUNDS"));return k[g]}}else if(e.isImmutableArray(k)&&e.isNumber(g)&&isFinite(g)&&Math.floor(g)===g){0>g&&(g=k.length()+g);if(g>=k.length()||0>g)throw Error(c.nodeErrorMessage(d,"RUNTIME","OUTOFBOUNDS"));return k.get(g)}throw Error(c.nodeErrorMessage(d,"RUNTIME","INVALIDTYPE"));}catch(ua){throw ua;}}function L(a,b){try{var d=B(a,b.argument);if(e.isBoolean(d)){if("!"===b.operator)return!d;
if("-"===b.operator)return-1*e.toNumber(d);if("+"===b.operator)return 1*e.toNumber(d);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b.operator)return-1*e.toNumber(d);if("+"===b.operator)return 1*e.toNumber(d);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(ea){throw ea;}}function P(a,b){try{var d=[B(a,b.left),B(a,b.right)],k=d[0],g=d[1];switch(b.operator){case "\x3d\x3d":return e.equalityTest(k,g);case "\x3d":return e.equalityTest(k,
g);case "!\x3d":return!e.equalityTest(k,g);case "\x3c":return e.greaterThanLessThan(k,g,b.operator);case "\x3e":return e.greaterThanLessThan(k,g,b.operator);case "\x3c\x3d":return e.greaterThanLessThan(k,g,b.operator);case "\x3e\x3d":return e.greaterThanLessThan(k,g,b.operator);case "+":return e.isString(k)||e.isString(g)?e.toString(k)+e.toString(g):e.toNumber(k)+e.toNumber(g);case "-":return e.toNumber(k)-e.toNumber(g);case "*":return e.toNumber(k)*e.toNumber(g);case "/":return e.toNumber(k)/e.toNumber(g);
case "%":return e.toNumber(k)%e.toNumber(g);default:throw Error(c.nodeErrorMessage(b,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(ha){throw ha;}}function Q(a,b){try{if("Identifier"!==b.callee.type)throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==a.localScope&&void 0!==a.localScope[b.callee.name.toLowerCase()]){var d=a.localScope[b.callee.name.toLowerCase()];if(d.value instanceof e.NativeFunction)return d.value.fn(a,b);if(d.value instanceof v)return N(a,b,d.value.definition);
throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}if(void 0!==a.globalScope[b.callee.name.toLowerCase()]){d=a.globalScope[b.callee.name.toLowerCase()];if(d.value instanceof e.NativeFunction)return d.value.fn(a,b);if(d.value instanceof v)return N(a,b,d.value.definition);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(ea){throw ea;}}function H(c){return null==c?"":e.isArray(c)||e.isImmutableArray(c)?"Array":e.isDate(c)?
"Date":e.isString(c)?"String":e.isBoolean(c)?"Boolean":e.isNumber(c)?"Number":c instanceof a?"Dictionary":c instanceof u?"Feature":c instanceof h?"Point":c instanceof b?"Polygon":c instanceof l?"Polyline":c instanceof n?"Multipoint":c instanceof r?"Extent":e.isFunctionParameter(c)?"Function":c===e.voidOperation?"":"number"===typeof c&&isNaN(c)?"Number":"Unrecognised Type"}function K(a,c,b,d){try{var k=B(a,c.arguments[b]);if(e.equalityTest(k,d))return B(a,c.arguments[b+1]);var g=c.arguments.length-
b;return 1===g?B(a,c.arguments[b]):2===g?null:K(a,c,b+2,d)}catch(oa){throw oa;}}function V(a,c,b,d){try{if(!0===d)return B(a,c.arguments[b+1]);if(3===c.arguments.length-b)return B(a,c.arguments[b+2]);var k=B(a,c.arguments[b+2]);if(!1===e.isBoolean(k))throw Error("WHEN needs boolean test conditions");return V(a,c,b+2,k)}catch(ha){throw ha;}}function S(a,c){var b=a.length,d=Math.floor(b/2);if(0===b)return[];if(1===b)return[a[0]];for(var e=S(a.slice(0,d),c),b=S(a.slice(d,b),c),d=[];0<e.length||0<b.length;)if(0<
e.length&&0<b.length){var k=c(e[0],b[0]);isNaN(k)&&(k=0);0>=k?(d.push(e[0]),e=e.slice(1)):(d.push(b[0]),b=b.slice(1))}else 0<e.length?(d.push(e[0]),e=e.slice(1)):0<b.length&&(d.push(b[0]),b=b.slice(1));return d}function ba(a,c,b){try{var d=a.body;if(b.length!==a.params.length)throw Error("Invalid Parameter calls to function.");for(var k=0;k<b.length;k++)c.localScope[a.params[k].name.toLowerCase()]={d:null,value:b[k],valueset:!0,node:null};var g=B(c,d);if(g instanceof e.ReturnResult)return g.value;
if(g===e.breakResult)throw Error("Cannot Break from a Function");if(g===e.continueResult)throw Error("Cannot Continue from a Function");return g instanceof e.ImplicitResult?g.value:g}catch(oa){throw oa;}}function N(a,c,b){return C(a,c,function(c,d,e){c={spatialReference:a.spatialReference,applicationCache:void 0===a.applicationCache?null:a.applicationCache,globalScope:a.globalScope,depthCounter:a.depthCounter+1,console:a.console,localScope:{}};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");
return ba(b,c,e)})}function M(a){return function(){var c={applicationCache:void 0===a.context.applicationCache?null:a.context.applicationCache,spatialReference:a.context.spatialReference,console:a.context.console,localScope:{},depthCounter:a.context.depthCounter+1,globalScope:a.context.globalScope};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");return ba(a.definition,c,arguments)}}function W(a){console.log(a)}var ga=0,D={};q.registerFunctions(D,C);k.registerFunctions(D,C);d.registerFunctions(D,
C);w.registerFunctions(D,C);t.registerFunctions(D,C);D["typeof"]=function(a,c){return C(a,c,function(a,c,b){e.pcCheck(b,1,1);a=H(b[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};D.iif=function(a,c){try{e.pcCheck(null===c.arguments?[]:c.arguments,3,3);var b=B(a,c.arguments[0]);if(!1===e.isBoolean(b))throw Error("IF Function must have a boolean test condition");return!0===b?B(a,c.arguments[1]):B(a,c.arguments[2])}catch(ea){throw ea;}};D.decode=function(a,c){try{if(2>c.arguments.length)throw Error("Missing Parameters");
if(2===c.arguments.length)return B(a,c.arguments[1]);if(0===(c.arguments.length-1)%2)throw Error("Must have a default value result.");var b=B(a,c.arguments[0]);return K(a,c,1,b)}catch(ea){throw ea;}};D.when=function(a,c){try{if(3>c.arguments.length)throw Error("Missing Parameters");if(0===c.arguments.length%2)throw Error("Must have a default value result.");var b=B(a,c.arguments[0]);if(!1===e.isBoolean(b))throw Error("WHEN needs boolean test conditions");return V(a,c,0,b)}catch(ea){throw ea;}};D.top=
function(a,c){return C(a,c,function(a,c,b){e.pcCheck(b,2,2);if(e.isArray(b[0]))return e.toNumber(b[1])>=b[0].length?b[0].slice(0):b[0].slice(0,e.toNumber(b[1]));if(e.isImmutableArray(b[0]))return e.toNumber(b[1])>=b[0].length()?b[0].slice(0):b[0].slice(0,e.toNumber(b[1]));throw Error("Top cannot accept this parameter type");})};D.first=function(a,c){return C(a,c,function(a,c,b){e.pcCheck(b,1,1);return e.isArray(b[0])?0===b[0].length?null:b[0][0]:e.isImmutableArray(b[0])?0===b[0].length()?null:b[0].get(0):
null})};D.sort=function(a,c){return C(a,c,function(a,c,b){e.pcCheck(b,1,2);a=b[0];e.isImmutableArray(a)&&(a=a.toArray());if(!1===e.isArray(a))throw Error("Illegal Argument");if(1<b.length){if(!1===e.isFunctionParameter(b[1]))throw Error("Illegal Argument");var d=M(b[1]);a=S(a,function(a,c){return d(a,c)})}else{if(0===a.length)return[];b={};for(c=0;c<a.length;c++){var k=H(a[c]);""!==k&&(b[k]=!0)}if(!0===b.Array||!0===b.Dictionary||!0===b.Feature||!0===b.Point||!0===b.Polygon||!0===b.Polyline||!0===
b.Multipoint||!0===b.Extent||!0===b.Function)return a.slice(0);c=0;var k="",g;for(g in b)c++,k=g;a=1<c||"String"===k?S(a,function(a,c){if(null===a||void 0===a||a===e.voidOperation)return null===c||void 0===c||c===e.voidOperation?0:1;if(null===c||void 0===c||c===e.voidOperation)return-1;var b=e.toString(a),d=e.toString(c);return b<d?-1:b===d?0:1}):"Number"===k?S(a,function(a,c){return a-c}):"Boolean"===k?S(a,function(a,c){return a===c?0:c?-1:1}):"Date"===k?S(a,function(a,c){return c-a}):a.slice(0)}return a})};
f.functionHelper={fixSpatialReference:e.fixSpatialReference,parseArguments:z,standardFunction:C};f.executeScript=function(c,b,d){d||(d=new g(102100));var k=b.vars,f=b.customfunctions,t={};k||(k={});f||(f={});var q=new a({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});q.immutable=!1;t.textformatting={value:q,valueset:!0,node:null};t.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};t.pi={value:Math.PI,valueset:!0,node:null};for(var h in D)t[h]=
{value:new e.NativeFunction(D[h]),valueset:!0,node:null};for(h in f)t[h]={value:new e.NativeFunction(f[h]),"native":!0,valueset:!0,node:null};for(h in k)t[h]=k[h]instanceof m?{value:new u(k[h]),valueset:!0,node:null}:{value:k[h],valueset:!0,node:null};c=B({spatialReference:d,globalScope:t,localScope:null,console:b.console?b.console:W,depthCounter:1,applicationCache:void 0===b.applicationCache?null:b.applicationCache},c.body[0].body);c instanceof e.ReturnResult&&(c=c.value);c instanceof e.ImplicitResult&&
(c=c.value);c===e.voidOperation&&(c=null);if(c===e.breakResult)throw Error("Cannot return BREAK");if(c===e.continueResult)throw Error("Cannot return CONTINUE");if(c instanceof v)throw Error("Cannot return FUNCTION");if(c instanceof e.NativeFunction)throw Error("Cannot return FUNCTION");return c};f.extractFieldLiterals=function(a,b){void 0===b&&(b=!1);return c.findFieldLiterals(a,b)};f.validateScript=function(a,b){return c.validateScript(a,b,"simple")};f.referencesMember=function(a,b){return c.referencesMember(a,
b)};f.referencesFunction=function(a,b){return c.referencesFunction(a,b)}})},"esri/arcade/treeAnalysis":function(){define(["require","exports"],function(p,f){function b(a,c,b,e){void 0!==a.fmin&&(a.min=a.fmin);void 0!==a.fmax&&(a.max=a.fmax);return"0"!==a.min&&b.length<Number(a.min)||"*"!==a.max&&b.length>Number(a.max)?-2:1}function m(a,c,e){if(null!==e.localScope&&void 0!==e.localScope[a.toLowerCase()]){var d=e.localScope[a.toLowerCase()];if("FormulaFunction"===d.type||"any"===d.type)return void 0===
d.signature&&(d.signature={min:"0",max:"*"}),b(d.signature,a,c,e)}return void 0!==e.globalScope[a.toLowerCase()]&&(d=e.globalScope[a.toLowerCase()],"FormulaFunction"===d.type||"any"===d.type)?(void 0===d.signature&&(d.signature={min:"0",max:"*"}),b(d.signature,a,c,e)):-1}function l(a,c){void 0===c&&(c=!0);var b=u(a,"SYNTAX","UNREOGNISED");try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?u(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"):"Identifier"!==
a.id.type?u(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):null!==a.init?l(a.init,!1):"";case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)if(b=l(a.declarations[d],c),""!==b)return b;return"";case "ForInStatement":b=l(a.left,c);if(""!==b)break;if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return u(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return u(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return u(a,"SYNTAX","LEFTNOTVAR");
b=l(a.right,c);if(""!==b)break;b=l(a.body,c);if(""!==b)break;return"";case "ForStatement":if(null!==a.test&&(b=l(a.test,c),""!==b))break;if(null!==a.init&&(b=l(a.init,c),""!==b))break;if(null!==a.update&&(b=l(a.update,c),""!==b))break;if(null!==a.body&&(b=l(a.body,c),""!==b))break;return"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":b=l(a.test,c);if(""!==b)break;if(null!==a.consequent&&(b=l(a.consequent,!1),""!==b))break;if(null!==
a.alternate&&(b=l(a.alternate,!1),""!==b))break;return"";case "BlockStatement":for(var e=[],d=0;d<a.body.length;d++)"EmptyStatement"!==a.body[d].type&&e.push(a.body[d]);a.body=e;for(d=0;d<a.body.length;d++)if(b=l(a.body[d],c),""!==b)return b;return"";case "FunctionDeclaration":return!1===c?u(a,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==a.id.type?u(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):l(a.body,!1);case "ReturnStatement":return null!==a.argument?l(a.argument,c):"";case "UpdateExpression":return"Identifier"!==
a.argument.type&&"MemberExpression"!==a.argument.type?u(a,"SYNTAX","ASSIGNMENTTOVARSONLY"):l(a.argument,c);case "AssignmentExpression":if("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type)return u(a,"SYNTAX","ASSIGNMENTTOVARSONLY");b=l(a.left,c);if(""!==b)break;switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return u(a,"SYNTAX","OPERATORNOTRECOGNISED")}return l(a.right,!1);case "ExpressionStatement":return l(a.expression,!1);
case "Identifier":b="";break;case "MemberExpression":b=l(a.object,c);if(""!==b)break;return!0===a.computed?l(a.property,c):"";case "Literal":return"";case "ThisExpression":return u(a,"SYNTAX","NOTSUPPORTED");case "CallExpression":if("Identifier"!==a.callee.type)return u(a,"SYNTAX","ONLYNODESSUPPORTED");b="";for(d=0;d<a.arguments.length;d++)if(b=l(a.arguments[d],c),""!==b)return b;return"";case "UnaryExpression":b=l(a.argument,c);break;case "BinaryExpression":b=l(a.left,c);if(""!==b)break;b=l(a.right,
c);if(""!==b)break;switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:return u(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":b=l(a.left,c);if(""!==b)break;b=l(a.right);if(""!==b)break;switch(a.operator){case "\x26\x26":case "||":break;default:return u(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ConditionalExpression":return u(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":b=
"";for(d=0;d<a.elements.length&&(b=l(a.elements[d],c),""===b);d++);break;case "Array":return u(a,"SYNTAX","NOTSUPPORTED");case "ObjectExpression":b="";for(d=0;d<a.properties.length&&(b="",null!==a.properties[d].key&&("Literal"!==a.properties[d].key.type&&"Identifier"!==a.properties[d].key.type&&(b=u(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[d].key.type&&(e=a.properties[d].key.value,"string"===typeof e||e instanceof String||(b=u(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")))),
""===b&&(b=l(a.properties[d],c)),""===b);d++);break;case "Property":if("Literal"!==a.key.type&&"Identifier"!==a.key.type)return u(a,"SYNTAX","ONLYLITERAL");if("Identifier"!==a.key.type&&(b=l(a.key,c),""!==b))break;b=l(a.value,c)}return b}catch(y){throw y;}}function h(a,b){var d=u(a,"SYNTAX","UNREOGNISED"),k=null,g="";try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type)return u(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR");null!==b.localScope?void 0!==b.localScope[a.id.name.toLowerCase()]&&
a.id.name.toLowerCase():void 0!==b.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase();var f=null===a.init?"":h(a.init,b);if(""!==f)return f;null===b.localScope?b.globalScope[a.id.name.toLowerCase()]={type:"any"}:b.localScope[a.id.name.toLowerCase()]={type:"any"};return"";case "FunctionDeclaration":k=e(a.id.name.toLowerCase(),a,b);g=c(a,b);if(""!==g)return g;if(null!==b.localScope)return u(a,"SYNTAX","GLOBALFUNCTIONSONLY");k.isnative=!1;b.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",
signature:[k]};return"";case "VariableDeclaration":for(var d="",q=0;q<a.declarations.length&&(d=h(a.declarations[q],b),""===d);q++);break;case "IfStatement":d=h(a.test,b);if(""!==d)break;if("AssignmentExpression"===a.test.type||"UpdateExpression"===a.test.type)return u(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");if(null!==a.consequent&&(d=h(a.consequent,b),""!==d))break;if(null!==a.alternate&&(d=h(a.alternate,b),""!==d))break;return"";case "EmptyStatement":return"";case "BlockStatement":for(q=
0;q<a.body.length;q++)if(d=h(a.body[q],b),""!==d)return d;return"";case "ReturnStatement":return null!==a.argument?h(a.argument,b):"";case "ForInStatement":if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return u(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return u(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return u(a,"SYNTAX","LEFTNOTVAR");d=h(a.left,b);if(""!==d)break;d=h(a.right,b);if(""!==d)break;d=h(a.body,b);if(""!==d)break;return"";
case "ForStatement":if(null!==a.init&&(d=h(a.init,b),""!==d))break;if(null!==a.test&&(d=h(a.test,b),""!==d))break;if(null!==a.body&&(d=h(a.body,b),""!==d))break;if(null!==a.update&&(d=h(a.update,b),""!==d))break;return"";case "BreakStatement":return"";case "ContinueStatement":return"";case "UpdateExpression":if("Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type)return u(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var v=!1;if("MemberExpression"===a.argument.type)return h(a.argument,b);null!==
b.localScope&&void 0!==b.localScope[a.argument.name.toLowerCase()]&&(v=!0);void 0!==b.globalScope[a.argument.name.toLowerCase()]&&(v=!0);return!1===v?"Identifier "+a.argument.name+" has not been declared.":"";case "AssignmentExpression":if("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type)return u(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var l=h(a.right,b);if(""!==l)return l;v=!1;if("MemberExpression"===a.left.type)return l=h(a.left,b),""!==l?l:"";null!==b.localScope&&void 0!==b.localScope[a.left.name.toLowerCase()]&&
(v=!0);void 0!==b.globalScope[a.left.name.toLowerCase()]&&(v=!0);return!1===v?"Identifier "+a.left.name+" has not been declared.":"";case "ExpressionStatement":return h(a.expression,b);case "Identifier":var w=a.name.toLowerCase();if(null!==b.localScope&&void 0!==b.localScope[w])return"";d=void 0!==b.globalScope[w]?"":u(a,"SYNTAX","VARIABLENOTFOUND");break;case "MemberExpression":d=h(a.object,b);if(""!==d)break;return!0===a.computed?h(a.property,b):"";case "Literal":return"";case "ThisExpression":d=
u(a,"SYNTAX","NOTSUPPORTED");break;case "CallExpression":if("Identifier"!==a.callee.type)return u(a,"SYNTAX","ONLYNODESSUPPORTED");d="";for(q=0;q<a.arguments.length;q++)if(d=h(a.arguments[q],b),""!==d)return d;var n=m(a.callee.name,a.arguments,b);-1===n&&(d=u(a,"SYNTAX","NOTFOUND"));-2===n&&(d=u(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":d=h(a.argument,b);break;case "BinaryExpression":d=h(a.left,b);if(""!==d)break;d=h(a.right,b);if(""!==d)break;return"";case "LogicalExpression":d=
h(a.left,b);if(""!==d)break;if("AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type)return u(a.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");d=h(a.right,b);if(""!==d)break;return"AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type?u(a.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):"";case "ConditionalExpression":return u(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":d="";for(q=0;q<a.elements.length&&(d=h(a.elements[q],b),""===d);q++);break;case "ObjectExpression":d=
"";for(q=0;q<a.properties.length;q++){d="";if(null!==a.properties[q].key&&("Literal"!==a.properties[q].key.type&&"Identifier"!==a.properties[q].key.type&&(d=u(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[q].key.type)){var r=a.properties[q].key.value;"string"===typeof r||r instanceof String||(d=u(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}""===d&&(d=h(a.properties[q],b));if(""!==d)break}break;case "Property":if("Literal"!==a.key.type&&"Identifier"!==a.key.type)return u(a,"SYNTAX",
"ONLYLITERAL");if("Identifier"!==a.key.type&&(d=h(a.key,b),""!==d))break;d=h(a.value,b);break;case "Array":return u(a,"SYNTAX","NOTSUPPORTED")}return d}catch(J){throw J;}}function r(a,c){var b=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?r(a.init,c):b;case "FunctionDeclaration":return r(a.body,c);case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)if(r(a.declarations[d],c))return!0;return b;case "IfStatement":return r(a.test,c)||null!==a.consequent&&r(a.consequent,
c)||null!==a.alternate&&r(a.alternate,c)?!0:b;case "EmptyStatement":return b;case "BlockStatement":for(d=0;d<a.body.length;d++)if(r(a.body[d],c))return!0;return b;case "ReturnStatement":return null!==a.argument?r(a.argument,c):b;case "UpdateExpression":return r(a.argument,c);case "AssignmentExpression":return(b=r(a.right,c))?b:r(a.left,c);case "ExpressionStatement":return r(a.expression,c);case "ForInStatement":return(b=r(a.left,c))||(b=r(a.right,c))?b:b=r(a.body,c);case "ForStatement":if(null!==
a.init&&(b=r(a.init,c))||null!==a.test&&(b=r(a.test,c))||null!==a.body&&(b=r(a.body,c)))return b;null!==a.update&&(b=r(a.update,c));return b;case "BreakStatement":return b;case "ContinueStatement":return b;case "Compound":return b;case "Identifier":return c.toLowerCase()===a.name.toLowerCase();case "MemberExpression":if(b=r(a.object,c))return b;!0===a.computed&&(b=r(a.property,c));return b;case "Literal":return b;case "ThisExpression":return b;case "CallExpression":for(d=0;d<a.arguments.length;d++)r(a.arguments[d],
c)&&(b=!0);return b;case "ArrayExpression":for(d=0;d<a.elements.length;d++)r(a.elements[d],c)&&(b=!0);return b;case "UnaryExpression":return r(a.argument,c);case "BinaryExpression":return(b=r(a.left,c))?b:b=r(a.right,c);case "LogicalExpression":return(b=r(a.left,c))?b:b=r(a.right,c);case "ObjectExpression":for(d=0;d<a.properties.length;d++)r(a.properties[d],c)&&(b=!0);return b;case "Property":return b=r(a.value,c);case "ConditionalExpression":return b;case "Array":return b;default:return b}}catch(A){throw A;
}}function n(a,c){var b=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?n(a.init,c):b;case "FunctionDeclaration":return n(a.body,c);case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)if(n(a.declarations[d],c))return!0;return b;case "IfStatement":return n(a.test,c)||null!==a.consequent&&n(a.consequent,c)||null!==a.alternate&&n(a.alternate,c)?!0:b;case "EmptyStatement":return b;case "BlockStatement":for(d=0;d<a.body.length;d++)if(n(a.body[d],c))return!0;return b;
case "ReturnStatement":return null!==a.argument?n(a.argument,c):b;case "UpdateExpression":return n(a.argument,c);case "AssignmentExpression":return n(a.left,c)?!0:n(a.right,c);case "ExpressionStatement":return n(a.expression,c);case "ForInStatement":return(b=n(a.left,c))||(b=n(a.right,c))?b:b=n(a.body,c);case "ForStatement":if(null!==a.init&&(b=n(a.init,c))||null!==a.test&&(b=n(a.test,c))||null!==a.body&&(b=n(a.body,c)))return b;null!==a.update&&(b=n(a.update,c));return b;case "BreakStatement":return b;
case "ContinueStatement":return b;case "Compound":return b;case "Identifier":return b;case "MemberExpression":if(b=n(a.object,c))return b;!0===a.computed&&(b=n(a.property,c));return b;case "Literal":return b;case "ThisExpression":return b;case "CallExpression":if(a.callee.name.toLowerCase()===c.toLowerCase())return!0;for(d=0;d<a.arguments.length;d++)n(a.arguments[d],c)&&(b=!0);return b;case "ArrayExpression":for(d=0;d<a.elements.length;d++)n(a.elements[d],c)&&(b=!0);return b;case "UnaryExpression":return n(a.argument,
c);case "BinaryExpression":return(b=n(a.left,c))?b:b=n(a.right,c);case "LogicalExpression":return(b=n(a.left,c))?b:b=n(a.right,c);case "ConditionalExpression":return b;case "ObjectExpression":for(d=0;d<a.properties.length;d++)n(a.properties[d],c)&&(b=!0);return b;case "Property":return b=n(a.value,c);case "Array":return b;default:return b}}catch(A){throw A;}}function g(a,c){var b=[],d;try{switch(a.type){case "VariableDeclarator":return null!==a.init?g(a.init,c):b;case "FunctionDeclaration":return g(a.body,
c);case "VariableDeclaration":for(var e=0;e<a.declarations.length;e++)d=g(a.declarations[e],c),b=b.concat(d);return b;case "ForInStatement":return d=g(a.left,c),b=b.concat(d),d=g(a.right,c),b=b.concat(d),d=g(a.body,c),b=b.concat(d);case "ForStatement":return null!==a.init&&(d=g(a.init,c),b=b.concat(d)),null!==a.test&&(d=g(a.test,c),b=b.concat(d)),null!==a.body&&(d=g(a.body,c),b=b.concat(d)),null!==a.update&&(d=g(a.update,c),b=b.concat(d)),b;case "IfStatement":return d=g(a.test,c),b=b.concat(d),null!==
a.consequent&&(d=g(a.consequent,c),b=b.concat(d)),null!==a.alternate&&(d=g(a.alternate,c),b=b.concat(d)),b;case "EmptyStatement":return b;case "BlockStatement":for(e=0;e<a.body.length;e++)d=g(a.body[e],c),b=b.concat(d);return b;case "ReturnStatement":return null!==a.argument?g(a.argument,c):b;case "UpdateExpression":return g(a.argument,c);case "AssignmentExpression":return b=g(a.left,c),b=b.concat(g(a.right,c));case "ExpressionStatement":return g(a.expression,c);case "BreakStatement":return b;case "ContinueStatement":return b;
case "Compound":return b;case "Identifier":return b;case "MemberExpression":if("Identifier"!==a.object.type)return b;if(!1===a.computed)b.push(a.object.name.toLowerCase()+"."+a.property.name.toLowerCase());else try{"Literal"===a.property.type&&"string"===typeof a.property.value&&b.push(a.object.name.toLowerCase()+"."+a.property.value.toString().toLowerCase())}catch(y){}return b;case "Literal":return b;case "ThisExpression":return b;case "CallExpression":for(e=0;e<a.arguments.length;e++)d=g(a.arguments[e],
c),b=b.concat(d);return b;case "ArrayExpression":for(e=0;e<a.elements.length;e++)d=g(a.elements[e],c),b=b.concat(d);return b;case "UnaryExpression":return g(a.argument,c);case "ObjectExpression":for(e=0;e<a.properties.length;e++)d=g(a.properties[e],c),b=b.concat(d);return b;case "Property":return g(a.value,c);case "BinaryExpression":return d=g(a.left,c),b=b.concat(d),d=g(a.right,c),b=b.concat(d);case "LogicalExpression":return d=g(a.left,c),b=b.concat(d),d=g(a.right,c),b=b.concat(d);case "ConditionalExpression":return b;
case "Array":return b;default:return b}}catch(y){throw y;}}function e(a,c,b){b=[];if(void 0!==c.params&&null!==c.params)for(var d=0;d<c.params.length;d++)b.push("any");return{name:a,"return":"any",params:b}}function c(a,c){for(var b={globalScope:c.globalScope,localScope:{}},d=0;d<a.params.length;d++)b.localScope[a.params[d].name.toLowerCase()]={type:"any"};return h(a.body,b)}function a(a,c,b,e){var d={};if(void 0===a||null===a)a={};if(void 0===b||null===b)b={};d.infinity={type:"any"};d.textformatting=
{type:"any"};d.pi={type:"any"};for(var k in c)if("simple"!==e||"simple"===e&&"a"===c[k].av)d[k]={type:"FormulaFunction",signature:c[k]};for(c=0;c<b.length;c++)k=b[c],d[k.name]={type:"FormulaFunction",signature:k};for(k in a)d[k]=a[k],d[k].type="any";return d}function u(a,c,b){var d="";switch(c){case "SYNTAX":d="Syntax Error: ";break;case "RUNTIME":d="Runtime Error: ";break;default:d="Syntax Error: "}try{switch(a.type){case "IfStatement":switch(b){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=" Assignments not be made in logical tests";
break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=" Non Boolean used as Condition"}break;case "UpdateExpression":case "AssignmentExpression":switch(b){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=" Assignments not be made in logical tests";break;case "ASSIGNMENTTOVARSONLY":d+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":d+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(b){case "GLOBALFUNCTIONSONLY":d+=" Functions cannot be declared as variables";
break;case "FUNCTIONMUSTHAVEIDENTIFIER":d+=" Function Definition must have an identifier"}break;case "VariableDeclaration":d+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(b){case "FUNCTIONVARIABLEDECLARATOR":d+=" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":d+=" Variable Definition must have an identifier"}break;case "Identifier":d+=" Identifier Not Found. ";d+=a.name;break;case "ObjectExpression":switch(b){case "OBJECTPROPERTYMUSTBESTRING":d+=
" Property name must be a string"}break;case "ForStatement":switch(b){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=" Non Boolean used as Condition"}break;case "ForInStatement":switch(b){case "ONLY1VAR":d+=" Can only declare 1 var for use with IN";break;case "CANNOTDECLAREVAL":d+=" Can only declare value for use with IN";break;case "LEFTNOVAR":d+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":d+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":d+=
"This type cannot be used in an IN loop"}break;case "MemberExpression":switch(b){case "PROPERTYNOTFOUND":d+="Cannot find member property. ";d+=!1===a.computed?a.property.name:"";break;case "OUTOFBOUNDS":d+="Out of Bounds. ";d+=!1===a.computed?a.property.name:"";break;case "NOTFOUND":d+="Cannot call member method on null. ";d+=!1===a.computed?a.property.name:"";break;case "INVALIDTYPE":d+="Cannot call member property on object of this type. ",d+=!1===a.computed?a.property.name:""}break;case "Property":switch(b){case "ONLYLITERAL":d+=
"Property names must be literals or identifiers"}break;case "Literal":break;case "ThisExpression":d+="THIS construct is not supported.";case "CallExpression":switch(b){case "WRONGSIGNATURE":d+="Function signature does not match: ";d+=a.callee.name;break;case "ONLYNODESUPPORTED":d+="Functions must be declared.";d+=a.callee.name;break;case "NOTAFUNCTION":d+="Not a Function: ";d+=a.callee.name;break;case "NOTFOUND":d+="Function Not Found: "+a.callee.name}break;case "UnaryExpression":switch(b){case "NOTSUPPORTEDUNARYOPERATOR":d+=
"Operator "+a.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";break;case "NOTSUPPORTEDTYPE":d+="Unary operator "+a.operator+" cannot be used with this argument."}case "BinaryExpression":switch(b){case "OPERATORNOTRECOGNISED":d+="Binary Operator not recognised "+a.operator}break;case "LogicalExpression":switch(b){case "ONLYBOOLEAN":d+="Operator "+a.operator+" cannot be used. Only || or \x26\x26 are allowed values";break;case "ONLYORORAND":d+="Logical Expression "+
a.operator+" being applied to parameters that are not boolean."}return"";case "ConditionalExpression":d+="Conditional statements not supported.";break;case "ArrayExpression":switch(b){case "FUNCTIONCONTEXTILLEGAL":d+=" Cannot Put Function inside Array."}break;case "Array":d+="Expression contains unrecognised array structure.";break;default:d+="Expression contains unrecognised code structures."}}catch(A){throw A;}return d}function v(a,c,b){return{line:a.loc.start.line,character:a.loc.start.column,
reason:u(a,c,b)}}function q(a,c,b,e,g){void 0===g&&(g=!0);c={globalScope:c.globalScope,localScope:{}};for(g=0;g<a.params.length;g++)c.localScope[a.params[g].name.toLowerCase()]={type:"any"};k(a.body,c,b,e,!1)}function k(a,c,b,g,f){void 0===f&&(f=!0);if(null===a)throw Error("Unnexpexted Expression Syntax");u(a,"SYNTAX","UNREOGNISED");var d=null;try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type){g.push(v(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"));break}"Identifier"!==
a.id.type?g.push(v(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(null!==c.localScope?void 0!==c.localScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase():void 0!==c.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase(),null===c.localScope?c.globalScope[a.id.name.toLowerCase()]={type:"any"}:c.localScope[a.id.name.toLowerCase()]={type:"any"});null===a.init?"":k(a.init,c,b,g,f);break;case "FunctionDeclaration":!1===f&&g.push(v(a,"SYNTAX","GLOBALFUNCTIONSONLY"));"Identifier"!==a.id.type&&g.push(v(a,
"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"));d=e("",a,c);q(a,c,b,g,f);null!==c.localScope&&g.push(v(a,"SYNTAX","GLOBALFUNCTIONSONLY"));d.isnative=!1;"Identifier"===a.id.type&&(c.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[d]});break;case "VariableDeclaration":for(var t=0;t<a.declarations.length;t++)k(a.declarations[t],c,b,g,f);break;case "IfStatement":null!==a.test&&(k(a.test,c,b,g,f),"AssignmentExpression"!==a.test.type&&"UpdateExpression"!==a.test.type||g.push(v(a.test,"SYNTAX",
"CANNOT_USE_ASSIGNMENT_IN_CONDITION")));null!==a.consequent&&k(a.consequent,c,b,g,f);null!==a.alternate&&k(a.alternate,c,b,g,f);break;case "EmptyStatement":break;case "BlockStatement":if(null!==a.body)for(t=0;t<a.body.length;t++)k(a.body[t],c,b,g,f);break;case "ReturnStatement":null!==a.argument&&k(a.argument,c,b,g,f);break;case "ForInStatement":"VariableDeclaration"===a.left.type?(1<a.left.declarations.length&&g.push(v(a,"SYNTAX","ONLY1VAR")),null!==a.left.declarations[0].init&&g.push(v(a,"SYNTAX",
"CANNOTDECLAREVAL"))):"Identifier"!==a.left.type&&g.push(v(a,"SYNTAX","LEFTNOTVAR"));k(a.left,c,b,g,f);k(a.right,c,b,g,f);k(a.body,c,b,g,f);break;case "ForStatement":null!==a.init&&k(a.init,c,b,g,f);null!==a.test&&k(a.test,c,b,g,f);null!==a.body&&k(a.body,c,b,g,f);null!==a.update&&k(a.update,c,b,g,f);break;case "BreakStatement":break;case "ContinueStatement":break;case "UpdateExpression":"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?g.push(v(a,"SYNTAX","ASSIGNMENTTOVARSONLY")):
("Identifier"===a.argument.type&&(d=!1,!1===b&&(null!==c.localScope&&void 0!==c.localScope[a.argument.name.toLowerCase()]&&(d=!0),void 0!==c.globalScope[a.argument.name.toLowerCase()]&&(d=!0),!1===d&&g.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."}))),"MemberExpression"===a.argument.type&&k(a.argument,c,b,g,f));break;case "AssignmentExpression":"Identifier"!==a.left.type&&"MemberExpression"!==a.left.type&&
g.push(v(a,"SYNTAX","ASSIGNMENTTOVARSONLY"));switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:g.push(v(a,"SYNTAX","OPERATORNOTRECOGNISED"))}k(a.right,c,b,g,f);d=!1;"Identifier"===a.left.type&&(null!==c.localScope&&void 0!==c.localScope[a.left.name.toLowerCase()]&&(d=!0),void 0!==c.globalScope[a.left.name.toLowerCase()]&&(d=!0),!1===b&&!1===d&&g.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+
a.argument.name+" has not been declared."}));"MemberExpression"===a.left.type&&k(a.left,c,b,g,f);break;case "ExpressionStatement":k(a.expression,c,b,g,f);break;case "Identifier":var h=a.name.toLowerCase();if(null!==c.localScope&&void 0!==c.localScope[h])break;void 0===c.globalScope[h]&&!1===b&&g.push(v(a,"SYNTAX","VARIABLENOTFOUND"));break;case "MemberExpression":k(a.object,c,b,g,f);!0===a.computed&&k(a.property,c,b,g,f);break;case "Literal":return"";case "ThisExpression":g.push(v(a,"SYNTAX","NOTSUPPORTED"));
break;case "CallExpression":"Identifier"!==a.callee.type&&g.push(v(a,"SYNTAX","ONLYNODESSUPPORTED"));for(t=0;t<a.arguments.length;t++)k(a.arguments[t],c,b,g,f);var l=m(a.callee.name,a.arguments,c);!1===b&&-1===l&&g.push(v(a,"SYNTAX","NOTFOUND"));-2===l&&g.push(v(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":k(a.argument,c,b,g,f);break;case "BinaryExpression":k(a.left,c,b,g,f);k(a.right,c,b,g,f);switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;
default:g.push(v(a,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(a.operator){case "\x26\x26":case "||":break;default:g.push(v(a,"SYNTAX","OPERATORNOTRECOGNISED"))}k(a.left,c,b,g,f);"AssignmentExpression"!==a.left.type&&"UpdateExpression"!==a.left.type||g.push(v(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));k(a.right,c,b,g,f);"AssignmentExpression"!==a.right.type&&"UpdateExpression"!==a.right.type||g.push(v(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));break;case "ConditionalExpression":g.push(v(a,
"SYNTAX","NOTSUPPORTED"));break;case "ArrayExpression":for(t=0;t<a.elements.length;t++)k(a.elements[t],c,b,g,f);break;case "Array":g.push(v(a,"SYNTAX","NOTSUPPORTED"));case "ObjectExpression":for(t=0;t<a.properties.length;t++)k(a.properties[t],c,b,g,f);break;case "Property":"Literal"!==a.key.type&&"Identifier"!==a.key.type&&g.push(v(a,"SYNTAX","ONLYLITERAL"));"Literal"===a.key.type&&k(a.key,c,b,g,f);k(a.value,c,b,g,f);break;default:g.push(v(a,"SYNTAX","UNRECOGNISED"))}}catch(E){g.push({line:null===
a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Unnexpected Syntax"})}}f.functionDecls={concatenate:{min:"0",max:"*",av:"a"},split:{min:"2",max:"4",av:"a"},guid:{min:"0",max:"1",av:"a"},today:{min:"0",max:"0",av:"a"},now:{min:"0",max:"0",av:"a"},timestamp:{min:"0",max:"0",av:"a"},day:{min:"1",max:"1",av:"a"},month:{min:"1",max:"1",av:"a"},year:{min:"1",max:"1",av:"a"},hour:{min:"1",max:"1",av:"a"},second:{min:"1",max:"1",av:"a"},millisecond:{min:"1",max:"1",av:"a"},minute:{min:"1",
max:"1",av:"a"},weekday:{min:"1",max:"1",av:"a"},toutc:{min:"1",max:"1",av:"a"},tolocal:{min:"1",max:"1",av:"a"},date:{min:"0",max:"7",av:"a"},datediff:{min:"2",max:"3",av:"a"},dateadd:{min:"2",max:"3",av:"a"},trim:{min:"1",max:"1",av:"a"},text:{min:"1",max:"2",av:"a"},left:{min:"2",max:"2",av:"a"},right:{min:"2",max:"2",av:"a"},mid:{min:"2",max:"3",av:"a"},upper:{min:"1",max:"1",av:"a"},proper:{min:"1",max:"2",av:"a"},lower:{min:"1",max:"1",av:"a"},find:{min:"2",max:"3",av:"a"},iif:{min:"3",max:"3",
av:"a"},decode:{min:"2",max:"*",av:"a"},when:{min:"2",max:"*",av:"a"},defaultvalue:{min:"2",max:"2",av:"a"},isempty:{min:"1",max:"1",av:"a"},maplayer:{min:"2",max:"3",av:"f"},domaincode:{min:"3",max:"4",av:"a"},domainname:{min:"2",max:"4",av:"a"},polygon:{min:"1",max:"1",av:"a"},point:{min:"1",max:"1",av:"a"},polyline:{min:"1",max:"1",av:"a"},extent:{min:"1",max:"1",av:"a"},multipoint:{min:"1",max:"1",av:"a"},geometry:{min:"1",max:"1",av:"a"},featurelayer:{min:"1",max:"3",av:"f"},featurecollection:{min:"1",
max:"1",av:"f"},buffer:{min:"2",max:"4",av:"f"},area:{min:"1",max:"2",av:"f"},sumarea:{min:"1",max:"2",av:"f"},length:{min:"1",max:"2",av:"f"},sumlength:{min:"1",max:"2",av:"f"},count:{min:"0",max:"*",av:"a"},filter:{min:"2",max:"2",av:"f"},envelopeintersects:{min:"2",max:"2",av:"f"},intersects:{min:"2",max:"2",av:"f"},contains:{min:"2",max:"2",av:"f"},overlaps:{min:"2",max:"2",av:"f"},within:{min:"2",max:"2",av:"f"},touches:{min:"2",max:"2",av:"f"},crosses:{min:"2",max:"2",av:"f"},union:{min:"1",
max:"2",av:"f",fmin:1},difference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},intersection:{min:"2",max:"2",av:"f",fmin:2,fmax:3},symmetricdifference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},number:{min:"1",max:"2",av:"a"},acos:{min:"1",max:"1",av:"a"},asin:{min:"1",max:"1",av:"a"},atan:{min:"1",max:"1",av:"a"},atan2:{min:"2",max:"2",av:"a"},ceil:{min:"1",max:"2",av:"a"},floor:{min:"1",max:"2",av:"a"},round:{min:"1",max:"2",av:"a"},cos:{min:"1",max:"1",av:"a"},exp:{min:"1",max:"1",av:"a"},log:{min:"1",max:"1",
av:"a"},min:{min:"0",max:"*",av:"a"},console:{min:"0",max:"*",av:"a"},max:{min:"0",max:"*",av:"a"},pow:{min:"2",max:"2",av:"a"},random:{min:"0",max:"0",av:"a"},sqrt:{min:"1",max:"1",av:"a"},sin:{min:"1",max:"1",av:"a"},tan:{min:"1",max:"1",av:"a"},abs:{min:"1",max:"1",av:"a"},isnan:{min:"1",max:"1",av:"a"},stdev:{min:"0",max:"*",av:"a"},average:{min:"0",max:"*",av:"a"},mean:{min:"0",max:"*",av:"a"},sum:{min:"0",max:"*",av:"a"},variance:{min:"0",max:"*",av:"a"},distinct:{min:"0",max:"*",av:"a"},addfield:{min:"3",
max:"3",av:"f"},removefield:{min:"2",max:"2",av:"f"},aggregate:{min:"3",max:"3",av:"f"},dissolve:{min:"2",max:"3",av:"f"},changeshape:{min:"2",max:"4",av:"f"},first:{min:"1",max:"1",av:"a"},top:{min:"2",max:"2",av:"a"},orderby:{min:"2",max:"2",av:"f"},"boolean":{min:"1",max:"1",av:"a"},dictionary:{min:"0",max:"*",av:"a"},servicearea:{min:"2",max:"*",av:"f"},equals:{min:"2",max:"2",av:"a"},"typeof":{min:"1",max:"1",av:"a"},reverse:{min:"1",max:"1",av:"a"},replace:{min:"3",max:"4",av:"a"},sort:{min:"1",
max:"2",av:"a"},feature:{min:"1",max:"*",av:"a"},haskey:{min:"2",max:"2",av:"a"},indexof:{min:"2",max:"2",av:"a"},centroid:{min:"1",max:"1",av:"f"},multiparttosinglepart:{min:"1",max:"1",av:"f"}};f.checkFunctionSignature=b;f.findFunction=m;f.validateLanguageNode=l;f.testValidityOfExpression=h;f.referencesMemberImpl=r;f.referencesMember=function(a,c){return!0===r(a.body[0].body,c.toLowerCase())?!0:!1};f.referencesFunctionImpl=n;f.referencesFunction=function(a,c){return!0===n(a.body[0].body,c)?!0:!1};
f.findFieldLiteralsImpl=g;f.findFieldLiterals=function(a,c){return g(a.body[0].body,c)};f.extractFunctionDeclaration=e;f.validateFunction=c;f.constructGlobalScope=a;f.validateScript=function(c,b,e){void 0===e&&(e="full");b={globalScope:a(b.vars,f.functionDecls,b.customFunctions,e),localScope:null};return h(c.body[0].body,b)};f.validateLanguage=function(a){return"BlockStatement"!==a.body[0].body.type?"Invalid formula content.":l(a.body[0].body)};f.nodeErrorMessage=u;f.makeError=v;f.extractAllIssuesInFunction=
q;f.extractAllIssues=k;f.checkScript=function(c,b,e,g){void 0===g&&(g="full");var d=[];if("BlockStatement"!==c.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];if(null===b||void 0===b)b={vars:{},customFunctions:[]};b={globalScope:a(b.vars,f.functionDecls,b.customFunctions,g),localScope:null};try{k(c.body[0].body,b,e,d)}catch(y){}return d}})},"esri/arcade/Feature":function(){define("require exports dojo/_base/lang ../geometry/Geometry ../graphic ../geometry/jsonUtils ./Dictionary ./languageUtils ./ImmutableArray ../geometry/Point".split(" "),
function(p,f,b,m,l,h,r,n,g,e){return function(){function c(a,b,e){this._layer=this.attributes=this.geometry=null;this.immutable=this._datesfixed=!0;a instanceof c?(this.attributes=a.attributes,this.geometry=a.geometry,a._layer&&(this._layer=a._layer)):a instanceof l?(this.geometry=a.geometry,this.attributes=void 0===a.attributes?{}:null===a.attributes?{}:a.attributes,a._layer?(this._layer=a._layer,this._datesfixed=!1):a.layer&&(this._layer=a.layer,this._datesfixed=!1)):a instanceof r?(this.attributes=
a.field("attributes"),null!==this.attributes&&(this.attributes=this.attributes instanceof r?this.attributes.attributes:null),this.geometry=a.field("geometry"),null!==this.geometry&&(this.geometry instanceof r?this.geometry=c.parseGeometryFromDictionary(this.geometry):this.geometry instanceof m||(this.geometry=null))):(b instanceof m||null===b?(this.geometry=b,this.attributes=void 0===a?{}:null===a?{}:a):"string"===typeof a?(a=JSON.parse(a),null!==a.geometry&&void 0!==a.geometry&&(this.geometry=h.fromJson(a.geometry)),
this.attributes=void 0===a.attributes?{}:null===a.attributes?{}:a.attributes):(void 0===a?this.attributes={}:null===a&&(this.attributes={}),this.geometry=null),void 0!==e&&(this._layer=e))}c.prototype.castToText=function(){var a="",c;for(c in this.attributes){""!==a&&(a+=",");var b=this.attributes[c];null==b?b="null":n.isBoolean(b)||n.isNumber(b)||n.isString(b)?a+=JSON.stringify(c)+":"+JSON.stringify(b):b instanceof m?a+=JSON.stringify(c)+":"+n.toStringExplicit(b):b instanceof g?a+=JSON.stringify(c)+
":"+n.toStringExplicit(b):b instanceof Array?a+=JSON.stringify(c)+":"+n.toStringExplicit(b):b instanceof Date?a+=JSON.stringify(c)+":"+JSON.stringify(b):null!==b&&"object"===typeof b&&void 0!==b.castToText&&(a+=JSON.stringify(c)+":"+b.castToText())}return'{"geometry":'+(null===this.geometry?"null":n.toStringExplicit(this.geometry))+',"attributes":{'+a+"}}"};c.prototype._fixDates=function(){for(var a=[],c=0;c<this._layer.fields.length;c++){var b=this._layer.fields[c];"date"!==b.type&&"esriFieldTypeDate"!==
b.type||a.push(b.name)}0<a.length&&this._fixDateFields(a);this._datesfixed=!0};c.prototype._fixDateFields=function(a){this.attributes=b.mixin({},this.attributes);for(var c=0;c<a.length;c++){var e=this.attributes[a[c]];if(null!==e)if(void 0===e)for(var g in this.attributes){if(g.toLowerCase()===a[c]){e=this.attributes[g];null===e||e instanceof Date||(this.attributes[g]=new Date(e));break}}else e instanceof Date||(this.attributes[a[c]]=new Date(e))}};c.prototype.field=function(a){!1===this._datesfixed&&
this._fixDates();var c=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var b in this.attributes)if(b.toLowerCase()===c)return this.attributes[b];if(this._hasFieldDefinition(c))return null;throw Error("Field not Found");};c.prototype._hasFieldDefinition=function(a){if(null===this._layer)return!1;for(var c=0;c<this._layer.fields.length;c++)if(this._layer.fields[c].name.toLowerCase()===a)return!0;return!1};c.prototype._field=function(a){!1===this._datesfixed&&this._fixDates();var c=a.toLowerCase();
a=this.attributes[a];if(void 0!==a)return a;for(var b in this.attributes)if(b.toLowerCase()===c)return this.attributes[b];return null};c.prototype.setField=function(a,c){if(this.immutable)throw Error("Feature is Immutable");if(!1===n.isSimpleType(c))throw Error("Illegal Value Assignment to Feature");var b=a.toLowerCase();if(void 0===this.attributes[a])for(var e in this.attributes)if(e.toLowerCase()===b){this.attributes[e]=c;return}this.attributes[a]=c};c.prototype.hasField=function(a){var c=a.toLowerCase();
if(void 0!==this.attributes[a])return!0;for(var b in this.attributes)if(b.toLowerCase()===c)return!0;return this._hasFieldDefinition(c)?!0:!1};c.prototype.keys=function(){var a=[],c={},b;for(b in this.attributes)a.push(b),c[b.toLowerCase()]=1;if(null!==this._layer)for(b=0;b<this._layer.fields.length;b++){var e=this._layer.fields[b];1!==c[e.name.toLowerCase()]&&a.push(e.name)}return a=a.sort()};c.fromFeature=function(a){return new c(a)};c.parseGeometryFromDictionary=function(a){a=c.convertDictionaryToJson(a,
!0);void 0!==a.spatialreference&&(a.spatialReference=a.spatialreference,delete a.spatialreference);void 0!==a.rings&&(a.rings=this.fixPathArrays(a.rings,!0===a.hasZ,!0===a.hasM));void 0!==a.paths&&(a.paths=this.fixPathArrays(a.paths,!0===a.hasZ,!0===a.hasM));void 0!==a.points&&(a.points=this.fixPointArrays(a.points,!0===a.hasZ,!0===a.hasM));return h.fromJson(a)};c.fixPathArrays=function(a,c,b){var e=[];if(a instanceof Array)for(var k=0;k<a.length;k++)e.push(this.fixPointArrays(a[k],c,b));else if(a instanceof
g)for(k=0;k<a.length();k++)e.push(this.fixPointArrays(a.get(k),c,b));return e};c.fixPointArrays=function(a,c,b){var f=[];if(a instanceof Array)for(var k=0;k<a.length;k++){var d=a[k];d instanceof e?c&&b?f.push([d.x,d.y,d.z,d.m]):c?f.push([d.x,d.y,d.z]):b?f.push([d.x,d.y,d.m]):f.push([d.x,d.y]):f.push(d)}else if(a instanceof g)for(k=0;k<a.length();k++)d=a.get(k),d instanceof e?c&&b?f.push([d.x,d.y,d.z,d.m]):c?f.push([d.x,d.y,d.z]):b?f.push([d.x,d.y,d.m]):f.push([d.x,d.y]):f.push(d);return f};c.convertDictionaryToJson=
function(a,b){void 0===b&&(b=!1);var e={},g;for(g in a.attributes){var k=a.attributes[g];k instanceof r&&(k=c.convertDictionaryToJson(k));b?e[g.toLowerCase()]=k:e[g]=k}return e};c.parseAttributesFromDictionary=function(a){var c={},b;for(b in a.attributes){var e=a.attributes[b];if(n.isSimpleType(e))c[b]=e;else throw Error("Illegal Argument");}return c};c.fromJson=function(a){var b=null;null!==a.geometry&&void 0!==a.geometry&&(b=h.fromJson(a.geometry));var e={};if(null!==a.attributes&&void 0!==a.attributes)for(var g in a.attributes){var k=
a.attributes[g];if(n.isString(k)||n.isNumber(k)||n.isBoolean(k)||n.isDate(k))e[g]=k;else throw Error("Illegal Argument");}return new c(e,b)};c.prototype.domainValueLookup=function(a,c,b){if(null===this._layer||!this._layer.fields)return null;b=n.getDomain(a,this._layer,this,b);if(void 0===c)try{c=this.field(a)}catch(q){return null}return n.getDomainValue(b,c)};c.prototype.domainCodeLookup=function(a,c,b){if(null===this._layer||!this._layer.fields)return null;a=n.getDomain(a,this._layer,this,b);return n.getDomainCode(a,
c)};return c}()})},"esri/arcade/functions/date":function(){define(["require","exports","../../moment","../languageUtils"],function(p,f,b,m){function l(b){return null===b?b:isNaN(b.getTime())?null:b}f.registerFunctions=function(f,r){f.today=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,0,0);b=new Date;b.setHours(0,0,0,0);return b})};f.now=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,0,0);return new Date})};f.timestamp=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,0,0);b=
new Date;return b=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds())})};f.toutc=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,1,1);b=m.toDate(a[0]);return null===b?null:new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCMilliseconds())})};f.tolocal=function(f,g){return r(f,g,function(e,c,a){m.pcCheck(a,1,1);e=m.toDate(a[0]);return null===
e?null:b.utc([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]).toDate()})};f.day=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,1,1);b=m.toDate(a[0]);return null===b?NaN:b.getDate()})};f.month=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,1,1);b=m.toDate(a[0]);return null===b?NaN:b.getMonth()})};f.year=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,1,1);b=m.toDate(a[0]);return null===b?NaN:b.getFullYear()})};f.hour=
function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,1,1);b=m.toDate(a[0]);return null===b?NaN:b.getHours()})};f.second=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,1,1);b=m.toDate(a[0]);return null===b?NaN:b.getSeconds()})};f.millisecond=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,1,1);b=m.toDate(a[0]);return null===b?NaN:b.getMilliseconds()})};f.minute=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,1,1);b=m.toDate(a[0]);return null===b?NaN:b.getMinutes()})};f.weekday=
function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,1,1);b=m.toDate(a[0]);return null===b?NaN:b.getDay()})};f.date=function(f,g){return r(f,g,function(e,c,a){m.pcCheck(a,0,7);if(3===a.length)return l(new Date(m.toNumber(a[0]),m.toNumber(a[1]),m.toNumber(a[2]),0,0,0,0));if(4===a.length)return l(new Date(m.toNumber(a[0]),m.toNumber(a[1]),m.toNumber(a[2]),m.toNumber(a[3]),0,0,0));if(5===a.length)return l(new Date(m.toNumber(a[0]),m.toNumber(a[1]),m.toNumber(a[2]),m.toNumber(a[3]),m.toNumber(a[4]),
0,0));if(6===a.length)return l(new Date(m.toNumber(a[0]),m.toNumber(a[1]),m.toNumber(a[2]),m.toNumber(a[3]),m.toNumber(a[4]),m.toNumber(a[5]),0));if(7===a.length)return l(new Date(m.toNumber(a[0]),m.toNumber(a[1]),m.toNumber(a[2]),m.toNumber(a[3]),m.toNumber(a[4]),m.toNumber(a[5]),m.toNumber(a[6])));if(2===a.length){e=m.toString(a[1]);if(""===e)return null;e=m.standardiseDateFormat(e);a=b(m.toString(a[0]),e,!0);return!0===a.isValid()?a.toDate():null}if(1===a.length){if(m.isString(a[0])&&""===a[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
""))return null;e=m.toNumber(a[0]);return!1===isNaN(e)?l(new Date(e)):m.toDate(a[0])}if(0===a.length)return new Date})};f.datediff=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,2,3);b=m.toDateM(a[0]);c=m.toDateM(a[1]);if(null===b||null===c)return NaN;switch(m.toString(a[2]).toLowerCase()){case "days":case "day":case "d":return b.diff(c,"days",!0);case "months":case "month":return b.diff(c,"months",!0);case "minutes":case "minute":case "m":return"M"===a[2]?b.diff(c,"months",!0):b.diff(c,"minutes",
!0);case "seconds":case "second":case "s":return b.diff(c,"seconds",!0);case "milliseconds":case "millisecond":case "ms":return b.diff(c);case "hours":case "hour":case "h":return b.diff(c,"hours",!0);case "years":case "year":case "y":return b.diff(c,"years",!0);default:return b.diff(c)}})};f.dateadd=function(b,g){return r(b,g,function(b,c,a){m.pcCheck(a,2,3);b=m.toDateM(a[0]);if(null===b)return null;c="milliseconds";switch(m.toString(a[2]).toLowerCase()){case "days":case "day":case "d":c="days";break;
case "months":case "month":c="months";break;case "minutes":case "minute":case "m":c="M"===a[2]?"months":"minutes";break;case "seconds":case "second":case "s":c="seconds";break;case "milliseconds":case "millisecond":case "ms":c="milliseconds";break;case "hours":case "hour":case "h":c="hours";break;case "years":case "year":case "y":c="years"}b.add(m.toNumber(a[1]),c);return b.toDate()})}}})},"esri/arcade/functions/string":function(){define(["require","exports","../languageUtils","../Feature"],function(p,
f,b,m){f.registerFunctions=function(f,h){f.trim=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,1,1);return b.toString(c[0]).trim()})};f.upper=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,1,1);return b.toString(c[0]).toUpperCase()})};f.proper=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,1,2);g=1;2===c.length&&"firstword"===b.toString(c[1]).toLowerCase()&&(g=2);e=/\s/;c=b.toString(c[0]);for(var a="",f=!0,h=0;h<c.length;h++){var q=c[h];e.test(q)?1===g&&(f=!0):q.toUpperCase()!==
q.toLowerCase()&&(f?(q=q.toUpperCase(),f=!1):q=q.toLowerCase());a+=q}return a})};f.lower=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,1,1);return b.toString(c[0]).toLowerCase()})};f.guid=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,0,1);if(0<c.length)switch(b.toString(c[0]).toLowerCase()){case "digits":return b.generateUUID().replace("-","").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return b.generateUUID();case "digits-hyphen-parentheses":return"("+b.generateUUID()+
")"}return"{"+b.generateUUID()+"}"})};f.console=function(f,l){return h(f,l,function(g,e,c){0!==c.length&&(1===c.length?f.console(b.toString(c[0])):f.console(b.toString(c)));return b.voidOperation})};f.mid=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,2,3);g=b.toNumber(c[1]);if(isNaN(g))return"";0>g&&(g=0);if(2===c.length)return b.toString(c[0]).substr(g);e=b.toNumber(c[2]);if(isNaN(e))return"";0>e&&(e=0);return b.toString(c[0]).substr(g,e)})};f.find=function(f,l){return h(f,l,function(g,
e,c){b.pcCheck(c,2,3);g=0;if(2<c.length){g=b.toNumber(b.defaultUndefined(c[2],0));if(isNaN(g))return-1;0>g&&(g=0)}return b.toString(c[1]).indexOf(b.toString(c[0]),g)})};f.left=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,2,2);g=b.toNumber(c[1]);if(isNaN(g))return"";0>g&&(g=0);return b.toString(c[0]).substr(0,g)})};f.right=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,2,2);g=b.toNumber(c[1]);if(isNaN(g))return"";0>g&&(g=0);return b.toString(c[0]).substr(-1*g,g)})};f.split=function(f,
l){return h(f,l,function(g,e,c){b.pcCheck(c,2,4);g=b.toNumber(b.defaultUndefined(c[2],-1));e=b.toBoolean(b.defaultUndefined(c[3],!1));-1===g||null===g||!0===e?c=b.toString(c[0]).split(b.toString(c[1])):(isNaN(g)&&(g=-1),-1>g&&(g=-1),c=b.toString(c[0]).split(b.toString(c[1]),g));if(!1===e)return c;e=[];for(var a=0;a<c.length&&!(-1!==g&&e.length>=g);a++)""!==c[a]&&void 0!==c[a]&&e.push(c[a]);return e})};f.text=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,1,2);return b.toStringExplicit(c[0],
c[1])})};f.concatenate=function(f,l){return h(f,l,function(g,e,c){g=[];if(1>c.length)return"";if(b.isArray(c[0])){e=b.defaultUndefined(c[2],"");for(var a=0;a<c[0].length;a++)g[a]=b.toStringExplicit(c[0][a],e);return 1<c.length?g.join(c[1]):g.join("")}if(b.isImmutableArray(c[0])){e=b.defaultUndefined(c[2],"");for(a=0;a<c[0].length();a++)g[a]=b.toStringExplicit(c[0].get(a),e);return 1<c.length?g.join(c[1]):g.join("")}for(a=0;a<c.length;a++)g[a]=b.toStringExplicit(c[a]);return g.join("")})};f.reverse=
function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,1,1);if(b.isArray(c[0]))return g=c[0].slice(0),g.reverse(),g;if(b.isImmutableArray(c[0]))return g=c[0].toArray().slice(0),g.reverse(),g;throw Error("Invalid Parameter");})};f.replace=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,3,4);g=b.toString(c[0]);e=b.toString(c[1]);var a=b.toString(c[2]);return(4===c.length?b.toBoolean(c[3]):1)?b.multiReplace(g,e,a):g.replace(e,a)})};f.domainname=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,
2,4);if(c[0]instanceof m)return c[0].domainValueLookup(b.toString(c[1]),c[2],void 0===c[3]?void 0:b.toNumber(c[3]));throw Error("Invalid Parameter");})};f.domaincode=function(f,l){return h(f,l,function(g,e,c){b.pcCheck(c,3,4);if(c[0]instanceof m)return c[0].domainCodeLookup(b.toString(c[1]),c[2],void 0===c[3]?void 0:b.toNumber(c[3]));throw Error("Invalid Parameter");})}}})},"esri/arcade/functions/maths":function(){define(["require","exports","../languageUtils","dojo/number"],function(p,f,b,m){function l(b,
f,l){if("undefined"===typeof l||0===+l)return Math[b](f);f=+f;l=+l;if(isNaN(f)||"number"!==typeof l||0!==l%1)return NaN;f=f.toString().split("e");f=Math[b](+(f[0]+"e"+(f[1]?+f[1]-l:-l)));f=f.toString().split("e");return+(f[0]+"e"+(f[1]?+f[1]+l:l))}f.registerFunctions=function(f,r){f.number=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,2);e=a[0];return b.isNumber(e)?e:null===e?0:b.isDate(e)||b.isBoolean(e)||""===e||void 0===e?Number(e):b.isString(e)?void 0!==a[1]?(a=b.multiReplace(a[1],
"\u2030",""),a=b.multiReplace(a,"\u00a4",""),m.parse(e,{pattern:a})):Number(e.trim()):Number(e)})};f.abs=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.abs(b.toNumber(a[0]))})};f.acos=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.acos(b.toNumber(a[0]))})};f.asin=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.asin(b.toNumber(a[0]))})};f.atan=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.atan(b.toNumber(a[0]))})};
f.atan2=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,2,2);return Math.atan2(b.toNumber(a[0]),b.toNumber(a[1]))})};f.ceil=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,2);return 2===a.length?(e=b.toNumber(a[1]),isNaN(e)&&(e=0),l("ceil",b.toNumber(a[0]),-1*e)):Math.ceil(b.toNumber(a[0]))})};f.round=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,2);return 2===a.length?(e=b.toNumber(a[1]),isNaN(e)&&(e=0),l("round",b.toNumber(a[0]),-1*e)):Math.round(b.toNumber(a[0]))})};
f.floor=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,2);return 2===a.length?(e=b.toNumber(a[1]),isNaN(e)&&(e=0),l("floor",b.toNumber(a[0]),-1*e)):Math.floor(b.toNumber(a[0]))})};f.cos=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.cos(b.toNumber(a[0]))})};f.isnan=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return"number"===typeof a[0]&&isNaN(a[0])})};f.exp=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.exp(b.toNumber(a[0]))})};
f.log=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.log(b.toNumber(a[0]))})};f.pow=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,2,2);return Math.pow(b.toNumber(a[0]),b.toNumber(a[1]))})};f.random=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,0,0);return Math.random()})};f.sin=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.sin(b.toNumber(a[0]))})};f.sqrt=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.sqrt(b.toNumber(a[0]))})};
f.tan=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return Math.tan(b.toNumber(a[0]))})};f.defaultvalue=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,2,2);return null===a[0]||""===a[0]||void 0===a[0]?a[1]:a[0]})};f.isempty=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return null===a[0]||""===a[0]||void 0===a[0]?!0:!1})};f["boolean"]=function(f,g){return r(f,g,function(e,c,a){b.pcCheck(a,1,1);return b.toBoolean(a[0])})}}})},"esri/arcade/functions/geometry":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/jsonUtils ../languageUtils ../Dictionary ../Feature".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){f.registerFunctions=function(f,v){f.polygon=function(b,k){return v(b,k,function(d,k,f){e.pcCheck(f,1,1);d=null;if(f[0]instanceof c){if(d=e.fixSpatialReference(a.parseGeometryFromDictionary(f[0]),b.spatialReference),!1===d instanceof m)throw Error("Illegal Parameter");}else d=f[0]instanceof m?g.fromJson(f[0].toJson()):e.fixSpatialReference(new m(JSON.parse(f[0])),b.spatialReference);if(null!==d&&!1===d.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return d})};f.polyline=function(b,k){return v(b,k,function(d,k,f){e.pcCheck(f,1,1);d=null;if(f[0]instanceof c){if(d=e.fixSpatialReference(a.parseGeometryFromDictionary(f[0]),b.spatialReference),!1===d instanceof l)throw Error("Illegal Parameter");}else d=f[0]instanceof l?g.fromJson(f[0].toJson()):e.fixSpatialReference(new l(JSON.parse(f[0])),b.spatialReference);if(null!==d&&!1===d.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return d})};f.point=function(b,k){return v(b,k,function(d,k,f){e.pcCheck(f,1,1);d=null;if(f[0]instanceof c){if(d=e.fixSpatialReference(a.parseGeometryFromDictionary(f[0]),b.spatialReference),!1===d instanceof h)throw Error("Illegal Parameter");}else d=f[0]instanceof h?g.fromJson(f[0].toJson()):e.fixSpatialReference(new h(JSON.parse(f[0])),b.spatialReference);if(null!==d&&!1===d.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return d})};f.multipoint=function(b,k){return v(b,k,function(d,k,f){e.pcCheck(f,1,1);d=null;if(f[0]instanceof c){if(d=e.fixSpatialReference(a.parseGeometryFromDictionary(f[0]),b.spatialReference),!1===d instanceof n)throw Error("Illegal Parameter");}else d=f[0]instanceof n?g.fromJson(f[0].toJson()):e.fixSpatialReference(new n(JSON.parse(f[0])),b.spatialReference);if(null!==d&&!1===d.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");
return d})};f.extent=function(b,k){return v(b,k,function(d,k,f){e.pcCheck(f,1,1);d=null;f[0]instanceof c?d=e.fixSpatialReference(a.parseGeometryFromDictionary(f[0]),b.spatialReference):f[0]instanceof h?(d={xmin:f[0].x,ymin:f[0].y,xmax:f[0].x,ymax:f[0].y,spatialReference:f[0].spatialReference.toJson()},f[0].hasZ?(d.zmin=f[0].z,d.zmax=f[0].z):f[0].hasM&&(d.mmin=f[0].m,d.mmax=f[0].m),d=g.fromJson(d)):d=f[0]instanceof m?g.fromJson(f[0].getExtent().toJson()):f[0]instanceof l?g.fromJson(f[0].getExtent().toJson()):
f[0]instanceof n?g.fromJson(f[0].getExtent().toJson()):f[0]instanceof r?g.fromJson(f[0].toJson()):e.fixSpatialReference(new r(JSON.parse(f[0])),b.spatialReference);if(null!==d&&!1===d.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return d})};f.geometry=function(b,k){return v(b,k,function(d,k,f){e.pcCheck(f,1,1);d=null;d=f[0]instanceof a?e.fixSpatialReference(f[0].geometry,b.spatialReference):
f[0]instanceof c?e.fixSpatialReference(a.parseGeometryFromDictionary(f[0]),b.spatialReference):e.fixSpatialReference(g.fromJson(JSON.parse(f[0])),b.spatialReference);if(null!==d&&!1===d.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return d})};f.feature=function(f,k){return v(f,k,function(d,k,g){if(0===g.length)throw Error("Missing Parameters");d=null;if(1===g.length)if(e.isString(g[0]))d=
a.fromJson(JSON.parse(g[0]));else if(g[0]instanceof a)d=new a(g[0]);else if(g[0]instanceof b)d=new a(null,g[0]);else if(g[0]instanceof c)d=g[0].hasField("geometry")?g[0].field("geometry"):null,k=g[0].hasField("attributes")?g[0].field("attributes"):null,null!==d&&d instanceof c&&(d=a.parseGeometryFromDictionary(d)),null!==k&&(k=a.parseAttributesFromDictionary(k)),d=new a(k,d);else throw Error("Illegal Argument");else{if(2===g.length){k=d=null;if(null!==g[0])if(g[0]instanceof b)d=g[0];else if(d instanceof
c)d=a.parseGeometryFromDictionary(g[0]);else throw Error("Illegal Argument");if(null!==g[1])if(g[1]instanceof c)k=a.parseAttributesFromDictionary(g[1]);else throw Error("Illegal Argument");}else{d=null;k={};if(null!==g[0])if(g[0]instanceof b)d=g[0];else if(d instanceof c)d=a.parseGeometryFromDictionary(g[0]);else throw Error("Illegal Argument");for(var t=1;t<g.length;t+=2){var q=e.toString(g[t]),h=g[t+1];if(null===h||void 0===h||e.isString(h)||isNaN(h)||e.isDate(h)||e.isNumber(h)||e.isBoolean(h)){if(e.isFunctionParameter(h)||
!1===e.isSimpleType(h))throw Error("Illegal Argument");k[q]=h===e.voidOperation?null:h}else throw Error("Illegal Argument");}}d=new a(k,d)}d.geometry=e.fixSpatialReference(d.geometry,f.spatialReference);d.immutable=!1;return d})};f.dictionary=function(a,b){return v(a,b,function(a,b,k){if(0===k.length)throw Error("Missing Parameters");if(0!==k.length%2)throw Error("Missing Parameters");a={};for(b=0;b<k.length;b+=2){var d=e.toString(k[b]),f=k[b+1];if(null===f||void 0===f||e.isString(f)||isNaN(f)||e.isDate(f)||
e.isNumber(f)||e.isBoolean(f)){if(e.isFunctionParameter(f))throw Error("Illegal Argument");a[d]=f===e.voidOperation?null:f}else throw Error("Illegal Argument");}k=new c(a);k.immutable=!1;return k})};f.haskey=function(b,k){return v(b,k,function(b,k,f){e.pcCheck(f,2,2);b=e.toString(f[1]);if(f[0]instanceof a||f[0]instanceof c)return f[0].hasField(b);throw Error("Illegal Argument");})};f.indexof=function(a,c){return v(a,c,function(a,c,b){e.pcCheck(b,2,2);a=b[1];if(e.isArray(b[0])){for(c=0;c<b[0].length;c++)if(e.equalityTest(a,
b[0][c]))return c;return-1}if(e.isImmutableArray(b[0])){var d=b[0].length();for(c=0;c<d;c++)if(e.equalityTest(a,b[0].get(c)))return c;return-1}throw Error("Illegal Argument");})}}})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(p,f,b,m){function l(f,l,n,g){if(1===g.length){if(b.isArray(g[0]))return m.calculateStat(f,g[0],-1);if(b.isImmutableArray(g[0]))return m.calculateStat(f,g[0].toArray(),-1)}return m.calculateStat(f,g,-1)}f.registerFunctions=
function(f,m){f.stdev=function(b,f){return m(b,f,function(b,c,a){return l("stdev",b,c,a)})};f.variance=function(b,f){return m(b,f,function(b,c,a){return l("variance",b,c,a)})};f.average=function(b,f){return m(b,f,function(b,c,a){return l("mean",b,c,a)})};f.mean=function(b,f){return m(b,f,function(b,c,a){return l("mean",b,c,a)})};f.sum=function(b,f){return m(b,f,function(b,c,a){return l("sum",b,c,a)})};f.min=function(b,f){return m(b,f,function(b,c,a){return l("min",b,c,a)})};f.max=function(b,f){return m(b,
f,function(b,c,a){return l("max",b,c,a)})};f.distinct=function(b,f){return m(b,f,function(b,c,a){return l("distinct",b,c,a)})};f.count=function(f,g){return m(f,g,function(e,c,a){b.pcCheck(a,1,1);if(b.isArray(a[0])||b.isString(a[0]))return a[0].length;if(b.isImmutableArray(a[0]))return a[0].length();throw Error("Invalid Parameters for Count");})}}})},"esri/arcade/functions/fieldStats":function(){define(["require","exports","../languageUtils"],function(p,f,b){function m(b){for(var f=0,h=0;h<b.length;h++)f+=
b[h];return f/b.length}function l(b){for(var f=m(b),h=0,g=0;g<b.length;g++)h+=Math.pow(f-b[g],2);return h/b.length}f.decodeStatType=function(b){switch(b.toLowerCase()){case "distinct":return"distinct";case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";case "count":return"count"}return""};f.calculateStat=function(f,r,n){void 0===n&&(n=1E3);switch(f.toLowerCase()){case "distinct":a:{f=
n;n=[];for(var g={},e=[],c=0;c<r.length;c++){if(void 0!==r[c]&&null!==r[c]&&r[c]!==b.voidOperation){var a=r[c];if(b.isNumber(a)||b.isString(a))void 0===g[a]&&(n.push(a),g[a]=1);else{for(var h=!1,v=0;v<e.length;v++)!0===b.equalityTest(e[v],a)&&(h=!0);!1===h&&(e.push(a),n.push(a))}}if(n.length>=f&&-1!==f){r=n;break a}}r=n}return r;case "avg":case "mean":return m(b.toNumberArray(r));case "min":return Math.min.apply(Math,b.toNumberArray(r));case "sum":r=b.toNumberArray(r);for(n=f=0;n<r.length;n++)f+=
r[n];return f;case "max":return Math.max.apply(Math,b.toNumberArray(r));case "stdev":case "stddev":return Math.sqrt(l(b.toNumberArray(r)));case "var":case "variance":return l(b.toNumberArray(r));case "count":return r.length}return 0}})},"esri/arcade/parser":function(){define(["require","exports","./treeAnalysis","./lib/esprima"],function(p,f,b,m){f.parseScript=function(f){f=m.parse("function _() { "+f+"\n}");if(null===f.body||void 0===f.body)throw Error("No formula provided.");if(0===f.body.length)throw Error("No formula provided.");
if(0===f.body.length)throw Error("No formula provided.");if("BlockStatement"!==f.body[0].body.type)throw Error("Invalid formula content.");var h=b.validateLanguage(f);if(""!==h)throw Error(h);return f};f.scriptCheck=function(f,h,r,n){var g=[];try{var e=m.parse("function _() { "+f+"\n}",{tolerant:!0,loc:!0}),c=e.errors;if(0<c.length)for(var a=0;a<c.length;a++)g.push({line:c[a].lineNumber,character:c[a].column,reason:c[a].description});var u=b.checkScript(e,h,r,n);for(h=0;h<u.length;h++)g.push(u[h])}catch(v){try{"Unexpected token }"===
v.description&&(v.index=("function _() { "+f+"\n}").length-1)?g.push({line:v.lineNumber,character:v.column,reason:"Unexpected end of script"}):g.push({line:v.lineNumber,character:v.column,reason:v.description})}catch(q){}}return g};f.extractFieldLiterals=function(f,h){void 0===h&&(h=!1);return b.findFieldLiterals(f,h)};f.validateScript=function(f,h,m){void 0===m&&(m="full");return b.validateScript(f,h,m)};f.referencesMember=function(f,h){return b.referencesMember(f,h)};f.referencesFunction=function(f,
h){return b.referencesFunction(f,h)}})},"esri/arcade/lib/esprima":function(){(function(p,f){"function"===typeof define&&define.amd?define(["exports"],f):"undefined"!==typeof exports?f(exports):f(p.esprima={})})(this,function(p){function f(a,c){if(!a)throw Error("ASSERT: "+c);}function b(a){return 48<=a&&57>=a}function m(a){return 0<="0123456789abcdefABCDEF".indexOf(a)}function l(a){return 0<="01234567".indexOf(a)}function h(a){return 10===a||13===a||8232===a||8233===a}function r(a){return 36===a||
95===a||65<=a&&90>=a||97<=a&&122>=a||92===a||128<=a&&Ta.NonAsciiIdentifierStart.test(String.fromCharCode(a))}function n(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||48<=a&&57>=a||92===a||128<=a&&Ta.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function g(a){a=a.toLowerCase();switch(a.length){case 2:return"if"===a||"in"===a;case 3:return"var"===a||"for"===a;case 4:return"else"===a;case 5:return"break"===a;case 6:return"return"===a;case 8:return"function"===a.toLowerCase()||"continue"===
a;default:return!1}}function e(a,c,b,d,e){f("number"===typeof b,"Comment must have valid position");Y.lastCommentStart>=b||(Y.lastCommentStart=b,a={type:a,value:c},O.range&&(a.range=[b,d]),O.loc&&(a.loc=e),O.comments.push(a),O.attachComment&&(O.leadingComments.push(a),O.trailingComments.push(a)))}function c(a){var c,b,d;c=F-a;for(b={start:{line:Z,column:F-fa-a}};F<qa;)if(d=R.charCodeAt(F),++F,h(d)){O.comments&&(a=R.slice(c+a,F-1),b.end={line:Z,column:F-fa-1},e("Line",a,c,F-1,b));13===d&&10===R.charCodeAt(F)&&
++F;++Z;fa=F;return}O.comments&&(a=R.slice(c+a,F),b.end={line:Z,column:F-fa},e("Line",a,c,F,b))}function a(){var a,b;for(b=0===F;F<qa;)if(a=R.charCodeAt(F),32===a||9===a||11===a||12===a||160===a||5760<=a&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(a))++F;else if(h(a))++F,13===a&&10===R.charCodeAt(F)&&++F,++Z,fa=F,b=!0;else if(47===a)if(a=R.charCodeAt(F+1),47===a)++F,++F,c(2),b=!0;else if(42===a){++F;++F;a:{var d=a=void 0,f=void 0,f=void 0;O.comments&&
(a=F-2,d={start:{line:Z,column:F-fa-2}});for(;F<qa;)if(f=R.charCodeAt(F),h(f))13===f&&10===R.charCodeAt(F+1)&&++F,++Z,++F,fa=F,F>=qa&&K();else{if(42===f&&47===R.charCodeAt(F+1)){++F;++F;O.comments&&(f=R.slice(a+2,F-2),d.end={line:Z,column:F-fa},e("Block",f,a,F,d));break a}++F}K()}}else break;else if(b&&45===a)if(45===R.charCodeAt(F+1)&&62===R.charCodeAt(F+2))F+=3,c(3);else break;else if(60===a)if("!--"===R.slice(F+1,F+4))++F,++F,++F,++F,c(4);else break;else break}function u(a){var c,b,d=0;c="u"===
a?4:2;for(a=0;a<c;++a)if(F<qa&&m(R[F]))b=R[F++],d=16*d+"0123456789abcdef".indexOf(b.toLowerCase());else return"";return String.fromCharCode(d)}function v(){var a,c;a=R.charCodeAt(F++);c=String.fromCharCode(a);92===a&&(117!==R.charCodeAt(F)&&K(),++F,(a=u("u"))&&"\\"!==a&&r(a.charCodeAt(0))||K(),c=a);for(;F<qa;){a=R.charCodeAt(F);if(!n(a))break;++F;c+=String.fromCharCode(a);92===a&&(c=c.substr(0,c.length-1),117!==R.charCodeAt(F)&&K(),++F,(a=u("u"))&&"\\"!==a&&n(a.charCodeAt(0))||K(),c+=a)}return c}
function q(){var a=F,c=R.charCodeAt(F),b,d=R[F];switch(c){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++F,O.tokenize&&(40===c?O.openParenToken=O.tokens.length:123===c&&(O.openCurlyToken=O.tokens.length)),{type:T.Punctuator,value:String.fromCharCode(c),lineNumber:Z,lineStart:fa,start:a,end:F};default:if(b=R.charCodeAt(F+1),61===b)switch(c){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return F+=2,{type:T.Punctuator,
value:String.fromCharCode(c)+String.fromCharCode(b),lineNumber:Z,lineStart:fa,start:a,end:F};case 33:case 61:return F+=2,61===R.charCodeAt(F)&&++F,{type:T.Punctuator,value:R.slice(a,F),lineNumber:Z,lineStart:fa,start:a,end:F}}}c=R.substr(F,4);if("\x3e\x3e\x3e\x3d"===c)return F+=4,{type:T.Punctuator,value:c,lineNumber:Z,lineStart:fa,start:a,end:F};c=c.substr(0,3);if("\x3e\x3e\x3e"===c||"\x3c\x3c\x3d"===c||"\x3e\x3e\x3d"===c)return F+=3,{type:T.Punctuator,value:c,lineNumber:Z,lineStart:fa,start:a,end:F};
c=c.substr(0,2);if(d===c[1]&&0<="+-\x3c\x3e\x26|".indexOf(d)||"\x3d\x3e"===c)return F+=2,{type:T.Punctuator,value:c,lineNumber:Z,lineStart:fa,start:a,end:F};if(0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(d))return++F,{type:T.Punctuator,value:d,lineNumber:Z,lineStart:fa,start:a,end:F};K()}function k(){var a,c,d;d=R[F];f(b(d.charCodeAt(0))||"."===d,"Numeric literal must start with a decimal digit or a decimal point");c=F;a="";if("."!==d){a=R[F++];d=R[F];if("0"===a){if("x"===d||"X"===d){++F;for(a="";F<qa&&
m(R[F]);)a+=R[F++];0===a.length&&K();r(R.charCodeAt(F))&&K();return{type:T.NumericLiteral,value:parseInt("0x"+a,16),lineNumber:Z,lineStart:fa,start:c,end:F}}if("b"===d||"B"===d){++F;for(d="";F<qa;){a=R[F];if("0"!==a&&"1"!==a)break;d+=R[F++]}0===d.length&&K();F<qa&&(a=R.charCodeAt(F),(r(a)||b(a))&&K());return{type:T.NumericLiteral,value:parseInt(d,2),lineNumber:Z,lineStart:fa,start:c,end:F}}if("o"===d||"O"===d||l(d)){l(d)?(d=!0,a="0"+R[F++]):(d=!1,++F,a="");for(;F<qa&&l(R[F]);)a+=R[F++];d||0!==a.length||
K();(r(R.charCodeAt(F))||b(R.charCodeAt(F)))&&K();return{type:T.NumericLiteral,value:parseInt(a,8),octal:d,lineNumber:Z,lineStart:fa,start:c,end:F}}d&&b(d.charCodeAt(0))&&K()}for(;b(R.charCodeAt(F));)a+=R[F++];d=R[F]}if("."===d){for(a+=R[F++];b(R.charCodeAt(F));)a+=R[F++];d=R[F]}if("e"===d||"E"===d){a+=R[F++];d=R[F];if("+"===d||"-"===d)a+=R[F++];if(b(R.charCodeAt(F)))for(;b(R.charCodeAt(F));)a+=R[F++];else K()}r(R.charCodeAt(F))&&K();return{type:T.NumericLiteral,value:parseFloat(a),lineNumber:Z,lineStart:fa,
start:c,end:F}}function d(){X=null;a();P("Regular Expression language structures not supported")}function w(){a();d()}function t(){var a;a=O.tokens[O.tokens.length-1];if(!a)return w();if("Punctuator"===a.type){if("]"===a.value)return q();if(")"===a.value)return a=O.tokens[O.openParenToken-1],!a||"Keyword"!==a.type||"if"!==a.value.toLowerCase()&&"while"!==a.value.toLowerCase()&&"for"!==a.value.toLowerCase()&&"with"!==a.value.toLowerCase()?q():w();if("}"===a.value){if(O.tokens[O.openCurlyToken-3]&&
"Keyword"===O.tokens[O.openCurlyToken-3].type){if(a=O.tokens[O.openCurlyToken-4],!a)return q()}else if(O.tokens[O.openCurlyToken-4]&&"Keyword"===O.tokens[O.openCurlyToken-4].type){if(a=O.tokens[O.openCurlyToken-5],!a)return w()}else return q();if(0<=ra.indexOf(a.value))return q()}return w()}return"Keyword"===a.type&&"this"!==a.value?w():q()}function x(){var c;a();if(F>=qa)return{type:T.EOF,lineNumber:Z,lineStart:fa,start:F,end:F};c=R.charCodeAt(F);if(r(c)){var d;c=F;if(92===R.charCodeAt(F))d=v();
else a:{var e;for(d=F++;F<qa;){e=R.charCodeAt(F);if(92===e){F=d;d=v();break a}if(n(e))++F;else break}d=R.slice(d,F)}return{type:1===d.length?T.Identifier:g(d)?T.Keyword:"null"===d.toLowerCase()?T.NullLiteral:"true"===d.toLowerCase()||"false"===d.toLowerCase()?T.BooleanLiteral:T.Identifier,value:d,lineNumber:Z,lineStart:fa,start:c,end:F}}if(40===c||41===c||59===c)return q();if(39===c||34===c){var w="",x,y,z;e=!1;var A,p;A=Z;p=fa;c=R[F];f("'"===c||'"'===c,"String literal must starts with a quote");
d=F;for(++F;F<qa;)if(x=R[F++],x===c){c="";break}else if("\\"===x)if((x=R[F++])&&h(x.charCodeAt(0)))++Z,"\r"===x&&"\n"===R[F]&&++F,fa=F;else switch(x){case "u":case "x":if("{"===R[F]){++F;y=x=void 0;x=R[F];y=0;for("}"===x&&K();F<qa;){x=R[F++];if(!m(x))break;y=16*y+"0123456789abcdef".indexOf(x.toLowerCase())}(1114111<y||"}"!==x)&&K();x=65535>=y?String.fromCharCode(y):String.fromCharCode((y-65536>>10)+55296,(y-65536&1023)+56320);w+=x}else z=F,(y=u(x))?w+=y:(F=z,w+=x);break;case "n":w+="\n";break;case "r":w+=
"\r";break;case "t":w+="\t";break;case "b":w+="\b";break;case "f":w+="\f";break;case "v":w+="\x0B";break;default:l(x)?(y="01234567".indexOf(x),0!==y&&(e=!0),F<qa&&l(R[F])&&(e=!0,y=8*y+"01234567".indexOf(R[F++]),0<="0123".indexOf(x)&&F<qa&&l(R[F])&&(y=8*y+"01234567".indexOf(R[F++]))),w+=String.fromCharCode(y)):w+=x}else if(h(x.charCodeAt(0)))break;else w+=x;""!==c&&K();return{type:T.StringLiteral,value:w,octal:e,startLineNumber:A,startLineStart:p,lineNumber:Z,lineStart:fa,start:d,end:F}}return 46===
c?b(R.charCodeAt(F+1))?k():q():b(c)?k():O.tokenize&&47===c?t():q()}function A(){var c,b,d;a();c={start:{line:Z,column:F-fa}};b=x();c.end={line:Z,column:F-fa};b.type!==T.EOF&&(d=R.slice(b.start,b.end),c={type:Aa[b.type],value:d,range:[b.start,b.end],loc:c},b.regex&&(c.regex={pattern:b.regex.pattern,flags:b.regex.flags}),O.tokens.push(c));return b}function y(){var a;a=X;F=a.end;Z=a.lineNumber;fa=a.lineStart;X="undefined"!==typeof O.tokens?A():x();F=a.end;Z=a.lineNumber;fa=a.lineStart;return a}function z(){var a,
c,b;a=F;c=Z;b=fa;X="undefined"!==typeof O.tokens?A():x();F=a;Z=c;fa=b}function C(){this.line=Z;this.column=F-fa}function B(){this.start=new C;this.end=null}function E(a){this.start=a.type===T.StringLiteral?{line:a.startLineNumber,column:a.start-a.startLineStart}:{line:a.lineNumber,column:a.start-a.lineStart};this.end=null}function G(){F=X.start;X.type===T.StringLiteral?(Z=X.startLineNumber,fa=X.startLineStart):(Z=X.lineNumber,fa=X.lineStart);O.range&&(this.range=[F,0]);O.loc&&(this.loc=new B)}function I(a){O.range&&
(this.range=[a.start,0]);O.loc&&(this.loc=new E(a))}function J(){var c,b,d,e;c=F;b=Z;d=fa;a();e=Z!==b;F=c;Z=b;fa=d;return e}function L(a,c,b){var d=Error("Line "+a+": "+b);d.index=c;d.lineNumber=a;d.column=c-fa+1;d.description=b;return d}function P(a){var c,b;c=Array.prototype.slice.call(arguments,1);b=a.replace(/%(\d)/g,function(a,b){f(b<c.length,"Message reference must be in range");return c[b]});throw L(Z,F,b);}function Q(a){var c,b;c=Array.prototype.slice.call(arguments,1);b=a.replace(/%(\d)/g,
function(a,b){f(b<c.length,"Message reference must be in range");return c[b]});b=L(Z,F,b);if(O.errors)O.errors.push(b);else throw b;}function H(a,c){var b=ka.UnexpectedToken;a&&(b=c?c:a.type===T.EOF?ka.UnexpectedEOS:a.type===T.Identifier?ka.UnexpectedIdentifier:a.type===T.NumericLiteral?ka.UnexpectedNumber:a.type===T.StringLiteral?ka.UnexpectedString:ka.UnexpectedToken);b=b.replace("%0",a?a.value:"ILLEGAL");return a&&"number"===typeof a.lineNumber?L(a.lineNumber,a.start,b):L(Z,F,b)}function K(a,c){throw H(a,
c);}function V(a,c){var b=H(a,c);if(O.errors)O.errors.push(b);else throw b;}function S(a){var c=y();c.type===T.Punctuator&&c.value===a||K(c)}function ba(){var a;O.errors?(a=X,a.type===T.Punctuator&&","===a.value?y():a.type===T.Punctuator&&";"===a.value?(y(),V(a)):V(a,ka.UnexpectedToken)):S(",")}function N(a){var c=y();c.type===T.Keyword&&c.value.toLowerCase()===a.toLowerCase()||K(c)}function M(a){return X.type===T.Punctuator&&X.value===a}function W(a){return X.type===T.Keyword&&X.value.toLowerCase()===
a.toLowerCase()}function ga(){var c;59===R.charCodeAt(F)||M(";")?y():(c=Z,a(),Z===c&&(X.type===T.EOF||M("}")||K(X)))}function D(a){return a.type===aa.Identifier||a.type===aa.MemberExpression}function ja(a,c){var b,d,e=new G;b=da;d=Ga();da=b;return e.finishFunctionExpression(null,a,[],d)}function na(){var a,c;a=da;da=!0;c=ab();c=ja(c.params);da=a;return c}function ca(){var a,c=new G;a=y();return a.type===T.StringLiteral||a.type===T.NumericLiteral?(da&&a.octal&&V(a,ka.StrictOctalLiteral),c.finishLiteral(a)):
c.finishIdentifier(a.value)}function ea(){var a,c,b,d=new G;a=X;if(a.type===T.Identifier)return c=ca(),"get"!==a.value||M(":")||M("(")?"set"!==a.value||M(":")||M("(")?M(":")?(y(),a=wa(),d.finishProperty("init",c,a,!1,!1)):M("(")?(a=na(),d.finishProperty("init",c,a,!0,!1)):d.finishProperty("init",c,c,!1,!0):(c=ca(),S("("),a=X,a.type!==T.Identifier?(S(")"),V(a),a=ja([])):(b=[Fa()],S(")"),a=ja(b,a)),d.finishProperty("set",c,a,!1,!1)):(c=ca(),S("("),S(")"),a=ja([]),d.finishProperty("get",c,a,!1,!1));
if(a.type===T.EOF||a.type===T.Punctuator)K(a);else{c=ca();if(M(":"))return y(),a=wa(),d.finishProperty("init",c,a,!1,!1);if(M("("))return a=na(),d.finishProperty("init",c,a,!0,!1);K(y())}}function ua(a){var c=[],b,d,e={},f=String,k=new G;for(!0!==a&&S("{");!M("}");)a=ea(),b=a.key.type===aa.Identifier?a.key.name:f(a.key.value),d="init"===a.kind?pa.Data:"get"===a.kind?pa.Get:pa.Set,b="$"+b,Object.prototype.hasOwnProperty.call(e,b)?(e[b]===pa.Data?da&&d===pa.Data?Q(ka.StrictDuplicateProperty):d!==pa.Data&&
Q(ka.AccessorDataProperty):d===pa.Data?Q(ka.AccessorDataProperty):e[b]&d&&Q(ka.AccessorGetSet),e[b]|=d):e[b]=d,c.push(a),M("}")||ba();S("}");return k.finishObjectExpression(c)}function ha(){var a,c,b,e;if(M("("))return S("("),M(")")?(y(),c=Sa.ArrowParameterPlaceHolder):(++Y.parenthesisCount,c=sa(),S(")")),c;if(M("[")){c=[];var f=new G;for(S("[");!M("]");)M(",")?(y(),c.push(null)):(c.push(wa()),M("]")||S(","));y();return f.finishArrayExpression(c)}if(M("{"))return ua();a=X.type;e=new G;if(a===T.Identifier)b=
e.finishIdentifier(y().value);else if(a===T.StringLiteral||a===T.NumericLiteral)da&&X.octal&&V(X,ka.StrictOctalLiteral),b=e.finishLiteral(y());else if(a===T.Keyword){if(W("function")){e=null;var k;b=[];var g=[],t,q=new G;N("function");M("(")||(e=Fa());k=ab(c);b=k.params;g=k.defaults;a=k.stricted;c=k.firstRestricted;k.message&&(f=k.message);t=da;k=Ga();da&&c&&K(c,f);da&&a&&V(a,f);da=t;return q.finishFunctionExpression(e,b,g,k)}W("this")?(y(),b=e.finishThisExpression()):K(y())}else a===T.BooleanLiteral?
(c=y(),c.value="true"===c.value.toLowerCase(),b=e.finishLiteral(c)):a===T.NullLiteral?(c=y(),c.value=null,b=e.finishLiteral(c)):M("/")||M("/\x3d")?(b="undefined"!==typeof O.tokens?e.finishLiteral(w()):e.finishLiteral(d()),z()):K(y());return b}function oa(){var a=[];S("(");if(!M(")"))for(;F<qa;){a.push(wa());if(M(")"))break;ba()}S(")");return a}function la(){S(".");var a,c=new G;a=y();a.type===T.Identifier||a.type===T.Keyword||a.type===T.BooleanLiteral||a.type===T.NullLiteral||K(a);return c.finishIdentifier(a.value)}
function va(){var a;S("[");a=sa();S("]");return a}function Ea(){var a,c,b=new G;N("new");var d;f(Y.allowIn,"callee of new expression always allow in keyword.");d=X;for(a=W("new")?Ea():ha();;)if(M("["))c=va(),a=(new I(d)).finishMemberExpression("[",a,c);else if(M("."))c=la(),a=(new I(d)).finishMemberExpression(".",a,c);else break;c=M("(")?oa():[];return b.finishNewExpression(a,c)}function ia(){var a,c,b=X,d,e=Y.allowIn;c=X;Y.allowIn=!0;for(a=W("new")?Ea():ha();;)if(M("."))d=la(),a=(new I(c)).finishMemberExpression(".",
a,d);else if(M("("))d=oa(),a=(new I(c)).finishCallExpression(a,d);else if(M("["))d=va(),a=(new I(c)).finishMemberExpression("[",a,d);else break;Y.allowIn=e;X.type!==T.Punctuator||!M("++")&&!M("--")||J()||(D(a)||Q(ka.InvalidLHSInAssignment),c=y(),a=(new I(b)).finishPostfixExpression(c.value,a));return a}function ma(){var a,c,b;X.type!==T.Punctuator&&X.type!==T.Keyword?c=ia():M("++")||M("--")?(b=X,a=y(),c=ma(),D(c)||Q(ka.InvalidLHSInAssignment),c=(new I(b)).finishUnaryExpression(a.value,c)):M("+")||
M("-")||M("~")||M("!")?(b=X,a=y(),c=ma(),c=(new I(b)).finishUnaryExpression(a.value,c)):W("delete")||W("void")||W("typeof")?(b=X,a=y(),c=ma(),c=(new I(b)).finishUnaryExpression(a.value,c),da&&"delete"===c.operator&&c.argument.type===aa.Identifier&&Q(ka.StrictDelete)):c=ia();return c}function za(a,c){var b=0;if(a.type!==T.Punctuator&&a.type!==T.Keyword)return 0;switch(a.value){case "||":b=1;break;case "\x26\x26":b=2;break;case "|":b=3;break;case "^":b=4;break;case "\x26":b=5;break;case "\x3d\x3d":case "!\x3d":case "\x3d\x3d\x3d":case "!\x3d\x3d":b=
6;break;case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":case "instanceof":b=7;break;case "in":b=c?7:0;break;case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":b=8;break;case "+":case "-":b=9;break;case "*":case "/":case "%":b=11}return b}function Ba(){var a,c,b,d,e,f;a=X;c=ma();if(c===Sa.ArrowParameterPlaceHolder)return c;b=X;d=za(b,Y.allowIn);if(0===d)return c;b.prec=d;y();a=[a,X];f=ma();for(e=[c,b,f];0<(d=za(X,Y.allowIn));){for(;2<e.length&&d<=e[e.length-2].prec;)f=e.pop(),b=e.pop().value,
c=e.pop(),a.pop(),c=(new I(a[a.length-1])).finishBinaryExpression(b,c,f),e.push(c);b=y();b.prec=d;e.push(b);a.push(X);c=ma();e.push(c)}d=e.length-1;c=e[d];for(a.pop();1<d;)c=(new I(a.pop())).finishBinaryExpression(e[d-1].value,e[d-2],c),d-=2;return c}function Ca(a){var c,b,d,e,f,k,g;e=[];f=[];k=0;g={paramSet:{}};c=0;for(b=a.length;c<b;c+=1)if(d=a[c],d.type===aa.Identifier)e.push(d),f.push(null),Wa(g,d,d.name);else if(d.type===aa.AssignmentExpression)e.push(d.left),f.push(d.right),++k,Wa(g,d.left,
d.left.name);else return null;g.message===ka.StrictParamDupe&&(a=da?g.stricted:g.firstRestricted,K(a,g.message));0===k&&(f=[]);return{params:e,defaults:f,rest:null,stricted:g.stricted,firstRestricted:g.firstRestricted,message:g.message}}function wa(){var a,c,b,d,e;a=Y.parenthesisCount;c=e=X;var f,k;k=X;b=Ba();b!==Sa.ArrowParameterPlaceHolder&&M("?")&&(y(),f=Y.allowIn,Y.allowIn=!0,c=wa(),Y.allowIn=f,S(":"),f=wa(),b=(new I(k)).finishConditionalExpression(b,c,f));if(b===Sa.ArrowParameterPlaceHolder||
M("\x3d\x3e"))if(Y.parenthesisCount===a||Y.parenthesisCount===a+1)if(b.type===aa.Identifier?d=Ca([b]):b.type===aa.AssignmentExpression?d=Ca([b]):b.type===aa.SequenceExpression?d=Ca(b.expressions):b===Sa.ArrowParameterPlaceHolder&&(d=Ca([])),d)return a=d,e=new I(e),S("\x3d\x3e"),d=da,b=M("{")?Ga():wa(),da&&a.firstRestricted&&K(a.firstRestricted,a.message),da&&a.stricted&&V(a.stricted,a.message),da=d,e.finishArrowFunctionExpression(a.params,a.defaults,b,b.type!==aa.BlockStatement);X.type!==T.Punctuator?
a=!1:(a=X.value,a="\x3d"===a||"*\x3d"===a||"/\x3d"===a||"%\x3d"===a||"+\x3d"===a||"-\x3d"===a||"\x3c\x3c\x3d"===a||"\x3e\x3e\x3d"===a||"\x3e\x3e\x3e\x3d"===a||"\x26\x3d"===a||"^\x3d"===a||"|\x3d"===a);a&&(D(b)||Q(ka.InvalidLHSInAssignment),c=y(),a=wa(),b=(new I(e)).finishAssignmentExpression(c.value,b,a));return b}function sa(){var a,c=X;a=wa();if(M(",")){for(a=[a];F<qa&&M(",");)y(),a.push(wa());a=(new I(c)).finishSequenceExpression(a)}return a}function Fa(){var a,c=new G;a=y();a.type!==T.Identifier&&
K(a);return c.finishIdentifier(a.value)}function Ma(a){var c=null,b,d=new G;b=Fa();"const"===a?(S("\x3d"),c=wa()):M("\x3d")&&(y(),c=wa());return d.finishVariableDeclarator(b,c)}function La(a){var c=[];do{c.push(Ma(a));if(!M(","))break;y()}while(F<qa);return c}function Ja(a){var c=X.type,b,d;c===T.EOF&&K(X);if(c===T.Punctuator&&"{"===X.value){if(a){S("{");var e=X;a=F;b=Z;d=fa;y();c=M(":");X=e;F=a;Z=b;fa=d;if((X.type===T.Identifier||X.type===T.StringLiteral)&&c)return ua(!0);a=new G;for(b=[];F<qa&&
!M("}");){d=Na();if("undefined"===typeof d)break;b.push(d)}S("}");return a.finishBlockStatement(b)}return ua()}a=new G;if(c===T.Punctuator)switch(X.value){case ";":return a=new G,S(";"),a.finishEmptyStatement();case "(":return b=sa(),ga(),a.finishExpressionStatement(b)}else if(c===T.Keyword)switch(X.value.toLowerCase()){case "break":return b=null,N("break"),59===R.charCodeAt(F)?(y(),Y.inIteration||Y.inSwitch||P(ka.IllegalBreak),a=a.finishBreakStatement(null)):J()?(Y.inIteration||Y.inSwitch||P(ka.IllegalBreak),
a=a.finishBreakStatement(null)):(X.type===T.Identifier&&(b=Fa(),d="$"+b.name,Object.prototype.hasOwnProperty.call(Y.labelSet,d)||P(ka.UnknownLabel,b.name)),ga(),null!==b||Y.inIteration||Y.inSwitch||P(ka.IllegalBreak),a=a.finishBreakStatement(b)),a;case "continue":return b=null,N("continue"),59===R.charCodeAt(F)?(y(),Y.inIteration||P(ka.IllegalContinue),a=a.finishContinueStatement(null)):J()?(Y.inIteration||P(ka.IllegalContinue),a=a.finishContinueStatement(null)):(X.type===T.Identifier&&(b=Fa(),d=
"$"+b.name,Object.prototype.hasOwnProperty.call(Y.labelSet,d)||P(ka.UnknownLabel,b.name)),ga(),null!==b||Y.inIteration||P(ka.IllegalContinue),a=a.finishContinueStatement(b)),a;case "for":var f,k,g;k=Y.allowIn;f=c=e=null;N("for");S("(");if(M(";"))y();else{if(W("var")){Y.allowIn=!1;var t=new G;f=y();g=La();f=t.finishVariableDeclaration(g,f.value);Y.allowIn=k;1===f.declarations.length&&W("in")&&(y(),b=f,d=sa(),f=null)}else Y.allowIn=!1,f=sa(),Y.allowIn=k,W("in")&&(D(f)||Q(ka.InvalidLHSInForIn),y(),b=
f,d=sa(),f=null);"undefined"===typeof b&&S(";")}"undefined"===typeof b&&(M(";")||(c=sa()),S(";"),M(")")||(e=sa()));S(")");g=Y.inIteration;Y.inIteration=!0;k=Ja(!0);Y.inIteration=g;return"undefined"===typeof b?a.finishForStatement(f,c,e,k):a.finishForInStatement(b,d,k);case "function":return ib(a);case "if":return N("if"),S("("),b=sa(),S(")"),d=Ja(!0),W("else")?(y(),c=Ja(!0)):c=null,a.finishIfStatement(b,d,c);case "return":return b=null,N("return"),Y.inFunctionBody||Q(ka.IllegalReturn),32===R.charCodeAt(F)&&
r(R.charCodeAt(F+1))?(b=sa(),ga(),a=a.finishReturnStatement(b)):J()?a=a.finishReturnStatement(null):(M(";")||M("}")||X.type===T.EOF||(b=sa()),ga(),a=a.finishReturnStatement(b)),a;case "var":return N("var"),b=La(),ga(),a.finishVariableDeclaration(b,"var")}b=sa();if(b.type===aa.Identifier&&M(":"))return y(),c="$"+b.name,Object.prototype.hasOwnProperty.call(Y.labelSet,c)&&P(ka.Redeclaration,"Label",b.name),Y.labelSet[c]=!0,d=Ja(!1),delete Y.labelSet[c],a.finishLabeledStatement(b,d);ga();return a.finishExpressionStatement(b)}
function Ga(){var a,c=[],b,d,e,f,k,g=new G;for(S("{");F<qa&&X.type===T.StringLiteral;){b=X;a=Na();c.push(a);if(a.expression.type!==aa.Literal)break;a=R.slice(b.start+1,b.end-1);"use strict"===a?(da=!0,d&&V(d,ka.StrictOctalLiteral)):!d&&b.octal&&(d=b)}b=Y.labelSet;d=Y.inIteration;e=Y.inSwitch;f=Y.inFunctionBody;k=Y.parenthesizedCount;Y.labelSet={};Y.inIteration=!1;Y.inSwitch=!1;Y.inFunctionBody=!0;for(Y.parenthesizedCount=0;F<qa&&!M("}");){a=Na();if("undefined"===typeof a)break;c.push(a)}S("}");Y.labelSet=
b;Y.inIteration=d;Y.inSwitch=e;Y.inFunctionBody=f;Y.parenthesizedCount=k;return g.finishBlockStatement(c)}function Wa(a,c,b){b="$"+b;da?Object.prototype.hasOwnProperty.call(a.paramSet,b)&&(a.stricted=c,a.message=ka.StrictParamDupe):!a.firstRestricted&&Object.prototype.hasOwnProperty.call(a.paramSet,b)&&(a.firstRestricted=c,a.message=ka.StrictParamDupe);a.paramSet[b]=!0}function ab(a){a={params:[],defaultCount:0,defaults:[],firstRestricted:a};S("(");if(!M(")"))for(a.paramSet={};F<qa;){var c=a,b=void 0,
d=void 0,e=void 0,b=X,d=Fa();Wa(c,b,b.value);M("\x3d")&&(y(),e=wa(),++c.defaultCount);c.params.push(d);c.defaults.push(e);if(M(")"))break;S(",")}S(")");0===a.defaultCount&&(a.defaults=[]);return{params:a.params,defaults:a.defaults,stricted:a.stricted,firstRestricted:a.firstRestricted,message:a.message}}function ib(){var a,c=[],b=[],d,e,f,k,g,t=new G;N("function");a=Fa();d=ab(f);c=d.params;b=d.defaults;e=d.stricted;f=d.firstRestricted;d.message&&(k=d.message);g=da;d=Ga();da&&f&&K(f,k);da&&e&&V(e,k);
da=g;return t.finishFunctionDeclaration(a,c,b,d)}function Na(){if(X.type===T.Keyword)return"function"===X.value.toLowerCase()?ib():Ja(!1);if(X.type!==T.EOF)return Ja(!1)}function Xa(){var a,c,b,d=[];for(a=0;a<O.tokens.length;++a)c=O.tokens[a],b={type:c.type,value:c.value},c.regex&&(b.regex={pattern:c.regex.pattern,flags:c.regex.flags}),O.range&&(b.range=c.range),O.loc&&(b.loc=c.loc),d.push(b);O.tokens=d}var T,Aa,ra,aa,Sa,pa,ka,Ta,R,da,F,Z,fa,qa,X,Y,O;T={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,
NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};Aa={};Aa[T.BooleanLiteral]="Boolean";Aa[T.EOF]="\x3cend\x3e";Aa[T.Identifier]="Identifier";Aa[T.Keyword]="Keyword";Aa[T.NullLiteral]="Null";Aa[T.NumericLiteral]="Numeric";Aa[T.Punctuator]="Punctuator";Aa[T.StringLiteral]="String";Aa[T.RegularExpression]="RegularExpression";ra="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");
aa={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",
FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Sa={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};
pa={Data:1,Get:2,Set:4};ka={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",
MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",
StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",
AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};Ta={NonAsciiIdentifierStart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),
NonAsciiIdentifierPart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")};
I.prototype=G.prototype={processComment:function(){var a,c,b,d=O.bottomRightStack,e,f,k=d[d.length-1];if(!(this.type===aa.Program&&0<this.body.length)){if(0<O.trailingComments.length){b=[];for(e=O.trailingComments.length-1;0<=e;--e)f=O.trailingComments[e],f.range[0]>=this.range[1]&&(b.unshift(f),O.trailingComments.splice(e,1));O.trailingComments=[]}else k&&k.trailingComments&&k.trailingComments[0].range[0]>=this.range[1]&&(b=k.trailingComments,delete k.trailingComments);if(k)for(;k&&k.range[0]>=this.range[0];)a=
k,k=d.pop();if(a)a.leadingComments&&a.leadingComments[a.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=a.leadingComments,a.leadingComments=void 0);else if(0<O.leadingComments.length)for(c=[],e=O.leadingComments.length-1;0<=e;--e)f=O.leadingComments[e],f.range[1]<=this.range[0]&&(c.unshift(f),O.leadingComments.splice(e,1));c&&0<c.length&&(this.leadingComments=c);b&&0<b.length&&(this.trailingComments=b);d.push(this)}},finish:function(){O.range&&(this.range[1]=F);O.loc&&(this.loc.end=
new C,O.source&&(this.loc.source=O.source));O.attachComment&&this.processComment()},finishArrayExpression:function(a){this.type=aa.ArrayExpression;this.elements=a;this.finish();return this},finishAssignmentExpression:function(a,c,b){this.type=aa.AssignmentExpression;this.operator=a;this.left=c;this.right=b;this.finish();return this},finishBinaryExpression:function(a,c,b){this.type="||"===a||"\x26\x26"===a?aa.LogicalExpression:aa.BinaryExpression;this.operator=a;this.left=c;this.right=b;this.finish();
return this},finishBlockStatement:function(a){this.type=aa.BlockStatement;this.body=a;this.finish();return this},finishBreakStatement:function(a){this.type=aa.BreakStatement;this.label=a;this.finish();return this},finishCallExpression:function(a,c){this.type=aa.CallExpression;this.callee=a;this.arguments=c;this.finish();return this},finishConditionalExpression:function(a,c,b){this.type=aa.ConditionalExpression;this.test=a;this.consequent=c;this.alternate=b;this.finish();return this},finishContinueStatement:function(a){this.type=
aa.ContinueStatement;this.label=a;this.finish();return this},finishEmptyStatement:function(){this.type=aa.EmptyStatement;this.finish();return this},finishExpressionStatement:function(a){this.type=aa.ExpressionStatement;this.expression=a;this.finish();return this},finishForStatement:function(a,c,b,d){this.type=aa.ForStatement;this.init=a;this.test=c;this.update=b;this.body=d;this.finish();return this},finishForInStatement:function(a,c,b){this.type=aa.ForInStatement;this.left=a;this.right=c;this.body=
b;this.each=!1;this.finish();return this},finishFunctionDeclaration:function(a,c,b,d){this.type=aa.FunctionDeclaration;this.id=a;this.params=c;this.defaults=b;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishFunctionExpression:function(a,c,b,d){this.type=aa.FunctionExpression;this.id=a;this.params=c;this.defaults=b;this.body=d;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishIdentifier:function(a){this.type=aa.Identifier;
this.name=a;this.finish();return this},finishIfStatement:function(a,c,b){this.type=aa.IfStatement;this.test=a;this.consequent=c;this.alternate=b;this.finish();return this},finishLiteral:function(a){this.type=aa.Literal;this.value=a.value;this.raw=R.slice(a.start,a.end);a.regex&&(this.regex=a.regex);this.finish();return this},finishMemberExpression:function(a,c,b){this.type=aa.MemberExpression;this.computed="["===a;this.object=c;this.property=b;this.finish();return this},finishObjectExpression:function(a){this.type=
aa.ObjectExpression;this.properties=a;this.finish();return this},finishPostfixExpression:function(a,c){this.type=aa.UpdateExpression;this.operator=a;this.argument=c;this.prefix=!1;this.finish();return this},finishProgram:function(a){this.type=aa.Program;this.body=a;this.finish();return this},finishProperty:function(a,c,b,d,e){this.type=aa.Property;this.key=c;this.value=b;this.kind=a;this.method=d;this.shorthand=e;this.finish();return this},finishReturnStatement:function(a){this.type=aa.ReturnStatement;
this.argument=a;this.finish();return this},finishUnaryExpression:function(a,c){this.type="++"===a||"--"===a?aa.UpdateExpression:aa.UnaryExpression;this.operator=a;this.argument=c;this.prefix=!0;this.finish();return this},finishVariableDeclaration:function(a,c){this.type=aa.VariableDeclaration;this.declarations=a;this.kind=c;this.finish();return this},finishVariableDeclarator:function(a,c){this.type=aa.VariableDeclarator;this.id=a;this.init=c;this.finish();return this}};p.version="2.0.0-dev";p.tokenize=
function(a,c){var b,d;b=String;"string"===typeof a||a instanceof String||(a=b(a));R=a;F=0;Z=0<R.length?1:0;fa=0;qa=R.length;X=null;Y={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};O={};c=c||{};c.tokens=!0;O.tokens=[];O.tokenize=!0;O.openParenToken=-1;O.openCurlyToken=-1;O.range="boolean"===typeof c.range&&c.range;O.loc="boolean"===typeof c.loc&&c.loc;"boolean"===typeof c.comment&&c.comment&&(O.comments=[]);"boolean"===typeof c.tolerant&&c.tolerant&&(O.errors=
[]);try{z();if(X.type===T.EOF)return O.tokens;for(y();X.type!==T.EOF;)try{y()}catch(Qa){if(O.errors){O.errors.push(Qa);break}else throw Qa;}Xa();d=O.tokens;"undefined"!==typeof O.comments&&(d.comments=O.comments);"undefined"!==typeof O.errors&&(d.errors=O.errors)}catch(Qa){throw Qa;}finally{O={}}return d};p.parse=function(c,b){var d,e;e=String;"string"===typeof c||c instanceof String||(c=e(c));R=c;F=0;Z=0<R.length?1:0;fa=0;qa=R.length;X=null;Y={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,
inIteration:!1,inSwitch:!1,lastCommentStart:-1};O={};"undefined"!==typeof b&&(O.range="boolean"===typeof b.range&&b.range,O.loc="boolean"===typeof b.loc&&b.loc,O.attachComment="boolean"===typeof b.attachComment&&b.attachComment,O.loc&&null!==b.source&&void 0!==b.source&&(O.source=e(b.source)),"boolean"===typeof b.tokens&&b.tokens&&(O.tokens=[]),"boolean"===typeof b.comment&&b.comment&&(O.comments=[]),"boolean"===typeof b.tolerant&&b.tolerant&&(O.errors=[]),O.attachComment&&(O.range=!0,O.comments=
[],O.bottomRightStack=[],O.trailingComments=[],O.leadingComments=[]));try{var f;a();z();f=new G;da=!1;var k;e=[];for(var g,t,q;F<qa;){g=X;if(g.type!==T.StringLiteral)break;k=Na();e.push(k);if(k.expression.type!==aa.Literal)break;t=R.slice(g.start+1,g.end-1);"use strict"===t?(da=!0,q&&V(q,ka.StrictOctalLiteral)):!q&&g.octal&&(q=g)}for(;F<qa;){k=Na();if("undefined"===typeof k)break;e.push(k)}d=f.finishProgram(e);"undefined"!==typeof O.comments&&(d.comments=O.comments);"undefined"!==typeof O.tokens&&
(Xa(),d.tokens=O.tokens);"undefined"!==typeof O.errors&&(d.errors=O.errors)}catch(jb){throw jb;}finally{O={}}return d};p.Syntax=function(){var a,c={};"function"===typeof Object.create&&(c=Object.create(null));for(a in aa)aa.hasOwnProperty(a)&&(c[a]=aa[a]);"function"===typeof Object.freeze&&Object.freeze(c);return c}()})},"esri/arcade/arcadeCompiler":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A){function y(a,c,b){try{return b(a,null,c)}catch(ua){throw ua;}}function z(a,b){try{switch(b.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return I(a,b);case "VariableDeclaration":for(var d=[],e=0;e<b.declarations.length;e++)d.push(z(a,b.declarations[e]));return d.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":return G(a,b);case "FunctionDeclaration":var e=b.id.name.toLowerCase(),f={applicationCache:void 0===
a.applicationCache?null:a.applicationCache,spatialReference:a.spatialReference,console:a.console,symbols:a.symbols,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter+1,globalScope:a.globalScope};if(64<f.depthCounter)throw Error("Exceeded maximum function depth");for(var k="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; var lscope \x3d [];\n ",g=0;g<b.params.length;g++){var t=b.params[g].name.toLowerCase(),q=V(t,a);f.localScope._SymbolsMap[t]=
q;k+="lscope['"+q+"']\x3darguments["+g.toString()+"];\n"}k+=G(f,b.body)+"\n return lastStatement; }, runtimeCtx))";k+="\n lastStatement \x3d lc.voidOperation; \n";void 0!==a.globalScope[e]?d="gscope['"+e+"']\x3d"+k:void 0!==a.globalScope._SymbolsMap[e]?d="gscope['"+a.globalScope._SymbolsMap[e]+"']\x3d"+k:(q=V(e,a),a.globalScope._SymbolsMap[e]=q,d="gscope['"+q+"']\x3d"+k);return d;case "ReturnStatement":var h;h=null===b.argument?"return lc.voidOperation;":"return "+z(a,b.argument)+";";return h;case "IfStatement":if("AssignmentExpression"===
b.test.type||"UpdateExpression"===b.test.type)throw Error(c.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var u=z(a,b.test),l=S(a),v="var "+l+" \x3d "+u+";\n if ("+l+" \x3d\x3d\x3d true) {\n"+E(a,b.consequent)+"\n }\n",v=null!==b.alternate?v+("else if ("+l+"\x3d\x3d\x3dfalse)   { \n"+E(a,b.alternate)+"}\n"):v+("else if ("+l+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n");return v+="else { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n";
case "ExpressionStatement":var n;n="AssignmentExpression"===b.expression.type?"lastStatement \x3d lc.voidOperation; "+z(a,b.expression)+" \n ":"lastStatement \x3d "+z(a,b.expression)+";";return n;case "AssignmentExpression":return B(a,b);case "UpdateExpression":return C(a,b);case "BreakStatement":return"break;";case "ContinueStatement":return"continue;";case "ForStatement":d="lastStatement \x3d lc.voidOperation; \n";null!==b.init&&(d+=z(a,b.init));var w=S(a),m=S(a),d=d+("var "+w+" \x3d true;")+"\n do { ";
null!==b.update&&(d+=" if ("+w+"\x3d\x3d\x3dfalse) {\n "+z(a,b.update)+"  \n}\n "+w+"\x3dfalse; \n");null!==b.test&&(d+="var "+m+" \x3d "+z(a,b.test)+";",d+="if ("+m+"\x3d\x3d\x3dfalse) { break; } else if ("+m+"!\x3d\x3dtrue) { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n");d+=z(a,b.body);null!==b.update&&(d+="\n "+z(a,b.update));return d+("\n"+w+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation;");case "ForInStatement":var x=S(a),r=S(a),
y=S(a),A="var "+x+" \x3d "+z(a,b.right)+";\n";"VariableDeclaration"===b.left.type&&(A+=z(a,b.left));var p="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name,p=p.toLowerCase(),d="";null!==a.localScope&&(void 0!==a.localScope[p]?d="lscope['"+p+"']":void 0!==a.localScope._SymbolsMap[p]&&(d="lscope['"+a.localScope._SymbolsMap[p]+"']"));""===d&&(void 0!==a.globalScope[p]?d="gscope['"+p+"']":void 0!==a.globalScope._SymbolsMap[p]&&(d="gscope['"+a.globalScope._SymbolsMap[p]+"']"));
A=A+("if ("+x+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n ")+("else if (lc.isArray("+x+") || lc.isString("+x+")) {")+("var "+r+"\x3d"+x+".length; \n")+("for(var "+y+"\x3d0; "+y+"\x3c"+r+"; "+y+"++) {\n");A+=d+"\x3d"+y+";\n";A+=z(a,b.body);A+="\n}\n";A+=" lastStatement \x3d lc.voidOperation; \n";A+=" \n}\n";A+="else if (lc.isImmutableArray("+x+")) {";A=A+("var "+r+"\x3d"+x+".length(); \n")+("for(var "+y+"\x3d0; "+y+"\x3c"+r+"; "+y+"++) {\n");A+=d+"\x3d"+y+";\n";A+=z(a,b.body);A+=
"\n}\n";A+=" lastStatement \x3d lc.voidOperation; \n";A+=" \n}\n";A+="else if (( "+x+" instanceof lang.Dictionary) || ( "+x+" instanceof lang.Feature)) {";A=A+("var "+r+"\x3d"+x+".keys(); \n")+("for(var "+y+"\x3d0; "+y+"\x3c"+r+".length; "+y+"++) {\n");A+=d+"\x3d"+r+"["+y+"];\n";A+=z(a,b.body);A+="\n}\n";A+=" lastStatement \x3d lc.voidOperation; \n";A+=" \n}\n";return A+"else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return L(a,b);case "MemberExpression":var P;try{d=void 0,d=
!0===b.computed?z(a,b.property):"'"+b.property.name+"'",P="lang.member("+z(a,b.object)+","+d+")"}catch(ra){throw ra;}return P;case "Literal":return null===b.value||void 0===b.value?"null":JSON.stringify(b.value);case "ThisExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==b.callee.type)throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));var J=b.callee.name.toLowerCase(),d="";null!==a.localScope&&(void 0!==a.localScope[J]?
d="lscope['"+J+"']":void 0!==a.localScope._SymbolsMap[J]&&(d="lscope['"+a.localScope._SymbolsMap[J]+"']"));""===d&&(void 0!==a.globalScope[J]?d="gscope['"+J+"']":void 0!==a.globalScope._SymbolsMap[J]&&(d="gscope['"+a.globalScope._SymbolsMap[J]+"']"));if(""!==d)for(e="[",f=0;f<b.arguments.length;f++)0<f&&(e+=", "),e+=z(a,b.arguments[f]);else throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(ra){throw ra;}return"lang.callfunc("+d+","+(e+"]")+",runtimeCtx)";case "UnaryExpression":var Q;
try{Q="lang.unary("+z(a,b.argument)+",'"+b.operator+"')"}catch(ra){throw ra;}return Q;case "BinaryExpression":var H;try{H="lang.binary("+z(a,b.left)+","+z(a,b.right)+",'"+b.operator+"')"}catch(ra){throw ra;}return H;case "LogicalExpression":var K;try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(c.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(c.nodeErrorMessage(b.right,
"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));K="lang.logical("+z(a,b.left)+","+z(a,b.right)+",'"+b.operator+"')"}catch(ra){throw ra;}return K;case "ConditionalExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{d=[];for(e=0;e<b.elements.length;e++)"Literal"===b.elements[e].type?d.push(z(a,b.elements[e])):d.push("lang.aCheck("+z(a,b.elements[e])+",'ArrayExpression')");k="["+d.join(",")+"]"}catch(ra){throw ra;}return k;case "ObjectExpression":d="lang.dictionary([";
for(e=0;e<b.properties.length;e++){var g=b.properties[e],M="Identifier"===g.key.type?"'"+g.key.name+"'":z(a,g.key),W=z(a,g.value);0<e&&(d+=",");d+="lang.strCheck("+M+",'ObjectExpression'),lang.aCheck("+W+", 'ObjectExpression')"}return d+"])";case "Property":throw Error("Should not get here");case "Array":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));default:throw Error(c.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}}catch(ra){throw ra;}}function C(a,c){var b=null,d="";if("MemberExpression"===
c.argument.type)return b=z(a,c.argument.object),d=!0===c.argument.computed?z(a,c.argument.property):"'"+c.argument.property.name+"'","lang.memberupdate("+b+","+d+",'"+c.operator+"',"+c.prefix+")";b=c.argument.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[b])return"lang.update(lscope, '"+b+"','"+c.operator+"',"+c.prefix+")";if(void 0!==a.localScope._SymbolsMap[b])return"lang.update(lscope, '"+a.localScope._SymbolsMap[b]+"','"+c.operator+"',"+c.prefix+")"}if(void 0!==a.globalScope[b])return"lang.update(gscope, '"+
b+"','"+c.operator+"',"+c.prefix+")";if(void 0!==a.globalScope._SymbolsMap[b])return"lang.update(gscope, '"+a.globalScope._SymbolsMap[b]+"','"+c.operator+"',"+c.prefix+")";throw Error("Variable not recognised");}function B(a,c){var b=z(a,c.right),d=null,e="";if("MemberExpression"===c.left.type)return d=z(a,c.left.object),e=!0===c.left.computed?z(a,c.left.property):"'"+c.left.property.name+"'","lang.assignmember("+d+","+e+",'"+c.operator+"',"+b+");";d=c.left.name.toLowerCase();if(null!==a.localScope){if(void 0!==
a.localScope[d])return"lscope['"+d+"']\x3dlang.assign("+b+",'"+c.operator+"', lscope['"+d+"']); ";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']\x3dlang.assign("+b+",'"+c.operator+"', lscope['"+a.localScope._SymbolsMap[d]+"']); "}if(void 0!==a.globalScope[d])return"gscope['"+d+"']\x3dlang.assign("+b+",'"+c.operator+"', gscope['"+d+"']); ";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']\x3dlang.assign("+b+",'"+c.operator+
"', gscope['"+a.globalScope._SymbolsMap[d]+"']); ";throw Error("Variable not recognised");}function E(a,c){return"BlockStatement"===c.type?z(a,c):"ReturnStatement"===c.type?z(a,c):"BreakStatement"===c.type?z(a,c):"ContinueStatement"===c.type?z(a,c):"UpdateExpression"===c.type?"lastStatement \x3d "+z(a,c)+";":"ExpressionStatement"===c.type?z(a,c):"ObjectExpression"===c.type?"lastStatement \x3d "+z(a,c)+";":z(a,c)}function G(a,c){for(var b="",d=0;d<c.body.length;d++)b="ReturnStatement"===c.body[d].type?
b+(z(a,c.body[d])+" \n"):"BreakStatement"===c.body[d].type?b+(z(a,c.body[d])+" \n"):"ContinueStatement"===c.body[d].type?b+(z(a,c.body[d])+" \n"):"UpdateExpression"===c.body[d].type?b+("lastStatement \x3d "+z(a,c.body[d])+"; \n"):"ObjectExpression"===c.body[d].type?b+("lastStatement \x3d "+z(a,c.body[d])+"; \n"):b+(z(a,c.body[d])+" \n");return b}function I(a,c){var b=null===c.init?null:z(a,c.init);b===e.voidOperation&&(b=null);var d=c.id.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[d])return"lscope['"+
d+"']\x3d"+b+";";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']\x3d"+b+";";var f=V(d,a);a.localScope._SymbolsMap[d]=f;return"lscope['"+f+"']\x3d"+b+";"}if(void 0!==a.globalScope[d])return"gscope['"+d+"']\x3d"+b+";";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']\x3d"+b+";";f=V(d,a);a.globalScope._SymbolsMap[d]=f;return"gscope['"+f+"']\x3d"+b+";"}function J(b,d,f){d=d.toLowerCase();switch(d){case "hasz":return b=b.hasZ,
void 0===b?!1:b;case "hasm":return b=b.hasM,void 0===b?!1:b;case "spatialreference":return d=b.spatialReference._arcadeCacheId,void 0===d&&(f=!0,Object.freeze&&Object.isFrozen(b.spatialReference)&&(f=!1),f&&(M++,d=b.spatialReference._arcadeCacheId=M)),b=new a({wkt:b.spatialReference.wkt,wkid:b.spatialReference.wkid}),void 0!==d&&(b._arcadeCacheId="SPREF"+d.toString()),b}switch(b.type){case "extent":switch(d){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return b=
b[d],void 0!==b?b:null;case "type":return"Extent"}break;case "polygon":switch(d){case "rings":return d=e.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===d&&(M++,d=M,e.isVersion4?b.cache._arcadeCacheId=d:b.setCacheValue("_arcadeCacheId",d)),b=new t(b.rings,b.spatialReference,!0===b.hasZ,!0===b.hasM,d);case "type":return"Polygon"}break;case "point":switch(d){case "x":case "y":case "z":case "m":return void 0!==b[d]?b[d]:null;case "type":return"Point"}break;case "polyline":switch(d){case "paths":return d=
e.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===d&&(M++,d=M,e.isVersion4?b.cache._arcadeCacheId=d:b.setCacheValue("_arcadeCacheId",d)),b=new t(b.paths,b.spatialReference,!0===b.hasZ,!0===b.hasM,d);case "type":return"Polyline"}break;case "multipoint":switch(d){case "points":return d=e.isVersion4?b.cache._arcadeCacheId:b.getCacheValue("_arcadeCacheId"),void 0===d&&(M++,d=M,e.isVersion4?b.cache._arcadeCacheId=d:b.setCacheValue("_arcadeCacheId",d)),b=new x(b.points,b.spatialReference,
!0===b.hasZ,!0===b.hasM,d,1);case "type":return"Multipoint"}}throw Error(c.nodeErrorMessage(f,"RUNTIME","PROPERTYNOTFOUND"));}function L(a,b){try{var d=b.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[d])return"lscope['"+d+"']";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']"}if(void 0!==a.globalScope[d])return"gscope['"+d+"']";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']";throw Error(c.nodeErrorMessage(b,
"RUNTIME","VARIABLENOTFOUND"));}catch(ua){throw ua;}}function P(c){return null===c?"":e.isArray(c)||e.isImmutableArray(c)?"Array":e.isDate(c)?"Date":e.isString(c)?"String":e.isBoolean(c)?"Boolean":e.isNumber(c)?"Number":c instanceof a?"Dictionary":c instanceof u?"Feature":c instanceof h?"Point":c instanceof b?"Polygon":c instanceof l?"Polyline":c instanceof n?"Multipoint":c instanceof r?"Extent":e.isFunctionParameter(c)?"Function":c===e.voidOperation?"":"number"===typeof c&&isNaN(c)?"Number":"Unrecognised Type"}
function Q(a,c,b,d){try{if(e.equalityTest(c[b],d))return c[b+1];var f=c.length-b;return 1===f?c[b]:2===f?null:Q(a,c,b+2,d)}catch(oa){throw oa;}}function H(a,c,b,d){try{if(!0===d)return c[b+1];if(3===c.length-b)return c[b+2];var f=c[b+2];if(!1===e.isBoolean(f))throw Error("WHEN needs boolean test conditions");return H(a,c,b+2,f)}catch(oa){throw oa;}}function K(a,c){var b=a.length,d=Math.floor(b/2);if(0===b)return[];if(1===b)return[a[0]];for(var e=K(a.slice(0,d),c),b=K(a.slice(d,b),c),d=[];0<e.length||
0<b.length;)if(0<e.length&&0<b.length){var f=c(e[0],b[0]);isNaN(f)&&(f=0);0>=f?(d.push(e[0]),e=e.slice(1)):(d.push(b[0]),b=b.slice(1))}else 0<e.length?(d.push(e[0]),e=e.slice(1)):0<b.length&&(d.push(b[0]),b=b.slice(1));return d}function V(a,c){c.symbols.symbolCounter++;return"_T"+c.symbols.symbolCounter.toString()}function S(a){a.symbols.symbolCounter++;return"_Tvar"+a.symbols.symbolCounter.toString()}function ba(a,c,b){var d={};a||(a={});b||(b={});d._SymbolsMap={};d.textformatting=1;d.infinity=1;
d.pi=1;for(var e in c)d[e]=1;for(e in b)d[e]=1;for(e in a)d[e]=1;return d}function N(a){console.log(a)}var M=0,W={};v.registerFunctions(W,y);q.registerFunctions(W,y);k.registerFunctions(W,y);d.registerFunctions(W,y);w.registerFunctions(W,y);W["typeof"]=function(a,c){return y(a,c,function(a,c,b){e.pcCheck(b,1,1);a=P(b[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};W.iif=function(a,c){try{return y(a,c,function(a,c,b){e.pcCheck(b,3,3);if(!1===e.isBoolean(b[0]))throw Error("IF Function must have a boolean test condition");
return b[0]?b[1]:b[2]})}catch(ea){throw ea;}};W.decode=function(a,c){try{return y(a,c,function(c,b,d){if(2>d.length)throw Error("Missing Parameters");if(2===d.length)return d[1];if(0===(d.length-1)%2)throw Error("Must have a default value result.");return Q(a,d,1,d[0])})}catch(ea){throw ea;}};W.when=function(a,c){try{return y(a,c,function(c,b,d){if(3>d.length)throw Error("Missing Parameters");if(0===d.length%2)throw Error("Must have a default value result.");c=d[0];if(!1===e.isBoolean(c))throw Error("WHEN needs boolean test conditions");
return H(a,d,0,c)})}catch(ea){throw ea;}};W.top=function(a,c){return y(a,c,function(a,c,b){e.pcCheck(b,2,2);if(e.isArray(b[0]))return e.toNumber(b[1])>=b[0].length?b[0].slice(0):b[0].slice(0,e.toNumber(b[1]));if(e.isImmutableArray(b[0]))return e.toNumber(b[1])>=b[0].length()?b[0].slice(0):b[0].slice(0,e.toNumber(b[1]));throw Error("Top cannot accept this parameter type");})};W.first=function(a,c){return y(a,c,function(a,c,b){e.pcCheck(b,1,1);return e.isArray(b[0])?0===b[0].length?null:b[0][0]:e.isImmutableArray(b[0])?
0===b[0].length()?null:b[0].get(0):null})};W.sort=function(a,c){return y(a,c,function(a,c,b){e.pcCheck(b,1,2);c=b[0];e.isImmutableArray(c)&&(c=c.toArray());if(!1===e.isArray(c))throw Error("Illegal Argument");if(1<b.length){if(!1===e.isFunctionParameter(b[1]))throw Error("Illegal Argument");c=K(c,function(c,d){return ja.callfunc(b[1],[c,d],a)})}else{if(0===c.length)return[];for(var d={},f=0;f<c.length;f++){var k=P(c[f]);""!==k&&(d[k]=!0)}if(!0===d.Array||!0===d.Dictionary||!0===d.Feature||!0===d.Point||
!0===d.Polygon||!0===d.Polyline||!0===d.Multipoint||!0===d.Extent||!0===d.Function)return c.slice(0);var f=0,k="",g;for(g in d)f++,k=g;c=1<f||"String"===k?K(c,function(a,c){if(null===a||void 0===a||a===e.voidOperation)return null===c||void 0===c||c===e.voidOperation?0:1;if(null===c||void 0===c||c===e.voidOperation)return-1;var b=e.toString(a),d=e.toString(c);return b<d?-1:b===d?0:1}):"Number"===k?K(c,function(a,c){return a-c}):"Boolean"===k?K(c,function(a,c){return a===c?0:c?-1:1}):"Date"===k?K(c,
function(a,c){return c-a}):c.slice(0)}return c})};for(var ga in W)W[ga]=new e.NativeFunction(W[ga]);var D=function(){};D.prototype=W;f.functionHelper={fixSpatialReference:e.fixSpatialReference,parseArguments:function(a,c){for(var b=[],d=0;d<c.arguments.length;d++)b.push(z(a,c.arguments[d]));return b},standardFunction:y};f.executeScript=function(a,c,b){return a(c,b)};f.extractFieldLiterals=function(a,b){void 0===b&&(b=!1);return c.findFieldLiterals(a,b)};f.validateScript=function(a,b){return c.validateScript(a,
b,"simple")};f.referencesMember=function(a,b){return c.referencesMember(a,b)};f.referencesFunction=function(a,b){return c.referencesFunction(a,b)};var ja={error:function(a,b,d){throw Error(c.nodeErrorMessage(a,b,d));},functionDepthchecker:function(a,c){return function(){c.depthCounte++;if(64<c.depthCounter)throw Error("Exceeded maximum function depth");var b=a.apply(this,arguments);c.depthCounte--;return b}},aCheck:function(a,b){if(e.isFunctionParameter(a))throw Error(c.nodeErrorMessage({type:b},
"RUNTIME","FUNCTIONCONTEXTILLEGAL"));return a===e.voidOperation?null:a},Dictionary:a,Feature:u,dictionary:function(c){for(var b={},d=0;d<c.length;d+=2){if(e.isFunctionParameter(c[d+1]))throw Error("Illegal Argument");if(!1===e.isString(c[d]))throw Error("Illegal Argument");b[c[d].toString()]=c[d+1]===e.voidOperation?null:c[d+1]}c=new a(b);c.immutable=!1;return c},strCheck:function(a,c){if(!1===e.isString(a))throw Error("Illegal Argument");return a},unary:function(a,b){if(e.isBoolean(a)){if("!"===
b)return!a;if("-"===b)return-1*e.toNumber(a);if("+"===b)return 1*e.toNumber(a);throw Error(c.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b)return-1*e.toNumber(a);if("+"===b)return 1*e.toNumber(a);throw Error(c.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},logical:function(a,b,d){if(e.isBoolean(a)&&e.isBoolean(b))switch(d){case "||":return a||b;case "\x26\x26":return a&&b;default:throw Error(c.nodeErrorMessage("LogicalExpression",
"RUNTIME","ONLYORORAND"));}else throw Error(c.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));},binary:function(a,b,d){switch(d){case "\x3d\x3d":return e.equalityTest(a,b);case "\x3d":return e.equalityTest(a,b);case "!\x3d":return!e.equalityTest(a,b);case "\x3c":return e.greaterThanLessThan(a,b,d);case "\x3e":return e.greaterThanLessThan(a,b,d);case "\x3c\x3d":return e.greaterThanLessThan(a,b,d);case "\x3e\x3d":return e.greaterThanLessThan(a,b,d);case "+":return e.isString(a)||e.isString(b)?
e.toString(a)+e.toString(b):e.toNumber(a)+e.toNumber(b);case "-":return e.toNumber(a)-e.toNumber(b);case "*":return e.toNumber(a)*e.toNumber(b);case "/":return e.toNumber(a)/e.toNumber(b);case "%":return e.toNumber(a)%e.toNumber(b);default:throw Error(c.nodeErrorMessage({type:"BinaryExpression"},"RUNTIME","OPERATORNOTRECOGNISED"));}},assign:function(a,b,d){switch(b){case "\x3d":return a===e.voidOperation?null:a;case "/\x3d":return e.toNumber(d)/e.toNumber(a);case "*\x3d":return e.toNumber(d)*e.toNumber(a);
case "-\x3d":return e.toNumber(d)-e.toNumber(a);case "+\x3d":return e.isString(d)||e.isString(a)?e.toString(d)+e.toString(a):e.toNumber(d)+e.toNumber(a);case "%\x3d":return e.toNumber(d)%e.toNumber(a);default:throw Error(c.nodeErrorMessage("AssignmentExpression","RUNTIME","OPERATORNOTRECOGNISED"));}},update:function(a,c,b,d){var f=e.toNumber(a[c]);a[c]="++"===b?f+1:f-1;return!1===d?f:"++"===b?f+1:f-1},memberupdate:function(c,b,d,f){var k;if(e.isArray(c))if(e.isNumber(b)){0>b&&(b=c.length+b);if(0>
b||b>=c.length)throw Error("Assignment outside of array bounds");k=e.toNumber(c[b]);c[b]="++"===d?k+1:k-1}else throw Error("Invalid Parameter");else if(c instanceof a){if(!1===e.isString(b))throw Error("Dictionary accessor must be a string");if(!0===c.hasField(b))k=e.toNumber(c.field(b)),c.setField(b,"++"===d?k+1:k-1);else throw Error("Invalid Parameter");}else if(c instanceof u){if(!1===e.isString(b))throw Error("Feature accessor must be a string");if(!0===c.hasField(b))k=e.toNumber(c.field(b)),
c.setField(b,"++"===d?k+1:k-1);else throw Error("Invalid Parameter");}else{if(e.isImmutableArray(c))throw Error("Array is Immutable");throw Error("Invalid Parameter");}return!1===f?k:"++"===d?k+1:k-1},assignmember:function(c,b,d,f){if(e.isArray(c))if(e.isNumber(b)){0>b&&(b=c.length+b);if(0>b||b>c.length)throw Error("Assignment outside of array bounds");if(b===c.length&&"\x3d"!==d)throw Error("Invalid Parameter");c[b]=this.assign(f,d,c[b])}else throw Error("Invalid Parameter");else if(c instanceof
a){if(!1===e.isString(b))throw Error("Dictionary accessor must be a string");if(!0===c.hasField(b))c.setField(b,this.assign(f,d,c.field(b)));else{if("\x3d"!==d)throw Error("Invalid Parameter");c.setField(b,this.assign(f,d,null))}}else if(c instanceof u){if(!1===e.isString(b))throw Error("Feature accessor must be a string");if(!0===c.hasField(b))c.setField(b,this.assign(f,d,c.field(b)));else{if("\x3d"!==d)throw Error("Invalid Parameter");c.setField(b,this.assign(f,d,null))}}else{if(e.isImmutableArray(c))throw Error("Array is Immutable");
throw Error("Invalid Parameter");}},member:function(b,d){if(null===b)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","NOTFOUND"));if(b instanceof a||b instanceof u){if(e.isString(d))return b.field(d)}else if(b instanceof A){if(e.isString(d))return J(b,d,"MemberExpression")}else if(e.isArray(b)){if(e.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=b.length+d);if(d>=b.length||0>d)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return b[d]}}else if(e.isString(b)){if(e.isNumber(d)&&
isFinite(d)&&Math.floor(d)===d){0>d&&(d=b.length+d);if(d>=b.length||0>d)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return b[d]}}else if(e.isImmutableArray(b)&&e.isNumber(d)&&isFinite(d)&&Math.floor(d)===d){0>d&&(d=b.length()+d);if(d>=b.length()||0>d)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return b.get(d)}throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));},callfunc:function(a,c,b){return a instanceof e.NativeFunction?
a.fn(b,c):a instanceof e.SizzleFunction?a.fn.apply(this,c):a.apply(this,c)}};f.compileScript=function(c,b){void 0===b&&(b=null);null===b&&(b={vars:{},customfunctions:{}});var d={globalScope:ba(b.vars,W,b.customfunctions),localScope:null,console:N,symbols:{symbolCounter:0}},d=z(d,c.body[0].body);""===d&&(d="lc.voidOperation;");var f={lc:e,lang:ja,postProcess:function(a){a instanceof e.ReturnResult&&(a=a.value);a instanceof e.ImplicitResult&&(a=a.value);a===e.voidOperation&&(a=null);if(a===e.breakResult)throw Error("Cannot return BREAK");
if(a===e.continueResult)throw Error("Cannot return CONTINUE");if(e.isFunctionParameter(a))throw Error("Cannot return FUNCTION");return a},prepare:function(c,b){b||(b=new g(102100));var d=c.vars,e=c.customfunctions,f=new D;d||(d={});e||(e={});var k=new a({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});k.immutable=!1;f._SymbolsMap={textformatting:1,infinity:1,pi:1};f.textformatting=k;f.infinity=Number.POSITIVE_INFINITY;f.pi=Math.PI;for(var t in e)f[t]=e[t],
f._SymbolsMap[t]=1;for(t in d)f._SymbolsMap[t]=1,f[t]=d[t]instanceof m?new u(d[t]):d[t];return{spatialReference:b,globalScope:f,localScope:null,console:c.console?c.console:N,symbols:{symbolCounter:0},depthCounter:1,applicationCache:void 0===c.applicationCache?null:c.applicationCache}}};return(new Function("context","spatialReference","var runtimeCtx\x3dthis.prepare(context, spatialReference);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+
d+"\n return lastStatement; } \n return this.postProcess(mainBody());")).bind(f)}})},"esri/renderers/UniqueValueRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),function(p,f,b,m,l,h,r,n,g){return p(n,{declaredClass:"esri.renderer.UniqueValueRenderer",constructor:function(b,c,a,g,h){this.values=[];this._symbols={};this.infos=[];b&&!b.declaredClass?(c=b,this.defaultSymbol=(b=c.defaultSymbol)&&
(b.declaredClass?b:r.fromJson(b)),this.attributeField=c.field1,this.attributeField2=c.field2,this.attributeField3=c.field3,this.fieldDelimiter=c.fieldDelimiter,this.defaultLabel=c.defaultLabel,this.setValueExpression(c.valueExpression),this.valueExpressionTitle=c.valueExpressionTitle,this.legendOptions=c.legendOptions,c.backgroundFillSymbol&&(this.backgroundFillSymbol=r.fromJson(c.backgroundFillSymbol)),f.forEach(c.uniqueValueInfos,this._addValueInfo,this)):(this.defaultSymbol=b,this.attributeField=
c,this.attributeField2=a,this.attributeField3=g,this.fieldDelimiter=h);this._multiple=!!this.attributeField2},addValue:function(e,c){var a=b.isObject(e)?e:{value:e,symbol:c};this._addValueInfo(a)},removeValue:function(b){var c=f.indexOf(this.values,b);-1!==c&&(this.values.splice(c,1),delete this._symbols[b],this.infos.splice(c,1))},getUniqueValueInfo:function(e){var c=this.attributeField,a=e.attributes,f,h;this._compiledFunc?c=g.executeFunction(this._compiledFunc,g.createExecContext(e,e._getView())):
this._multiple?(e=this.attributeField2,f=this.attributeField3,h=[],c&&h.push(a[c]),e&&h.push(a[e]),f&&h.push(a[f]),c=h.join(this.fieldDelimiter||"")):c=b.isFunction(c)?c(e):a[c];return this._symbols[c]},setValueExpression:function(b){this.valueExpression=b;this._compiledFunc=g.createFunction(b)},getFieldsUsedInExpressions:function(){var b=this.inherited(arguments);this.valueExpression&&(b=b.concat(g.extractFieldNames(this.valueExpression)));b.sort();return f.filter(b,function(c,a){return 0===a||b[a-
1]!==c})},getSymbol:function(b){return(b=this.getUniqueValueInfo(b))&&b.symbol||this.defaultSymbol},_addValueInfo:function(b){var c=b.value;this.values.push(c);this.infos.push(b);var a=b.symbol;a&&!a.declaredClass&&(b.symbol=r.fromJson(a));this._symbols[c]=b},toJson:function(){var e=h.fixJson,c;c={type:"uniqueValue",field1:this.attributeField,field2:this.attributeField2,field3:this.attributeField3,fieldDelimiter:this.fieldDelimiter,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
legendOptions:b.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),defaultLabel:this.defaultLabel,uniqueValueInfos:f.map(this.infos||[],function(a){a=b.mixin({},a);a.symbol=a.symbol&&a.symbol.toJson();a.value+="";return e(a)})};this.backgroundFillSymbol&&(c.backgroundFillSymbol=this.backgroundFillSymbol.toJson());c=b.mixin(this.inherited(arguments),c);return e(c)}})})},"esri/renderers/ClassBreaksRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),
function(p,f,b,m,l,h,r,n,g){return p(n,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(b,c){this.breaks=[];this._symbols={};this.infos=[];this.isMaxInclusive=!0;if(b&&!b.declaredClass){var a=b;this.attributeField=a.field;this.setValueExpression(a.valueExpression);this.valueExpressionTitle=a.valueExpressionTitle;this.legendOptions=a.legendOptions;this.defaultSymbol=(b=a.defaultSymbol)&&(b.declaredClass?b:r.fromJson(b));this.backgroundFillSymbol=(b=a.backgroundFillSymbol)&&(b.declaredClass?
b:r.fromJson(b));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],a,this);var e=a.minValue;(a=a.classBreakInfos)&&a[0]&&h.isDefined(a[0].classMaxValue)&&f.forEach(a,function(a){var c=a.classMaxValue;a.minValue=e;e=a.maxValue=c},this);f.forEach(a,this._addBreakInfo,this)}else this.defaultSymbol=b,this.attributeField=c},addBreak:function(e,c,a){e=b.isObject(e)?e:{minValue:e,maxValue:c,symbol:a};this._addBreakInfo(e)},removeBreak:function(b,
c){var a,e=this.breaks,f,g=e.length,k=this._symbols;for(f=0;f<g;f++)if(a=e[f],a[0]==b&&a[1]==c){e.splice(f,1);delete k[b+"-"+c];this.infos.splice(f,1);break}},clearBreaks:function(){this.breaks=[];this._symbols={};this.infos=[]},getBreakIndex:function(e){var c=this.attributeField,a=e.attributes,f=this.breaks,h=f.length,q=this.isMaxInclusive;if(this._compiledFunc)e=g.executeFunction(this._compiledFunc,g.createExecContext(e,e._getView()));else if(b.isFunction(c))e=c(e);else{e=parseFloat(a[c]);var c=
this.normalizationType,k;if(c)if(k=parseFloat(this.normalizationTotal),a=parseFloat(a[this.normalizationField]),"log"===c)e=Math.log(e)*Math.LOG10E;else if("percent-of-total"===c&&!isNaN(k))e=e/k*100;else if("field"===c){if(isNaN(e)||isNaN(a))return-1;e/=a}}if(null!=e&&!isNaN(e)&&"number"===typeof e)for(a=0;a<h;a++)if(c=f[a],c[0]<=e&&(q?e<=c[1]:e<c[1]))return a;return-1},getBreakInfo:function(b){b=this.getBreakIndex(b);return-1!==b?this.infos[b]:null},getSymbol:function(b){return(b=this.breaks[this.getBreakIndex(b)])?
this._symbols[b[0]+"-"+b[1]]:this.defaultSymbol},setMaxInclusive:function(b){this.isMaxInclusive=b},setValueExpression:function(b){this.valueExpression=b;this._compiledFunc=g.createFunction(b)},getFieldsUsedInExpressions:function(){var b=this.inherited(arguments);this.valueExpression&&(b=b.concat(g.extractFieldNames(this.valueExpression)));b.sort();return f.filter(b,function(c,a){return 0===a||b[a-1]!==c})},_normalizationTypeEnums:[["field","esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total",
"esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks","esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],["quantile","esriClassifyQuantile"],["standard-deviation","esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"]],_copy:function(b,c,a){f.forEach(b,function(b){var e=b.split(":"),f,k,d;1<e.length&&(b=e[0],f=this["_"+b+"Enums"],"rest"===e[1]?(k="1",d="0"):"sdk"===e[1]&&(k="0",d="1"));e=c[b];if(void 0!==e&&(a[b]=
e,f&&k)){var g,t=f.length;for(g=0;g<t;g++)if(f[g][k]===e){a[b]=f[g][d];break}}},this)},_addBreakInfo:function(b){var c=b.minValue,a=b.maxValue;this.breaks.push([c,a]);this.infos.push(b);var e=b.symbol;e&&!e.declaredClass&&(b.symbol=r.fromJson(e));this._symbols[c+"-"+a]=b.symbol},toJson:function(){var e=this.infos||[],c=h.fixJson,a=e[0]&&e[0].minValue,g=this.backgroundFillSymbol,e=b.mixin(this.inherited(arguments),{type:"classBreaks",field:this.attributeField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
legendOptions:b.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:g&&g.toJson(),minValue:-Infinity===a?-Number.MAX_VALUE:a,classBreakInfos:f.map(e,function(a){a=b.mixin({},a);a.symbol=a.symbol&&a.symbol.toJson();a.classMaxValue=Infinity===a.maxValue?Number.MAX_VALUE:a.maxValue;delete a.minValue;delete a.maxValue;return c(a)})});this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk","normalizationField","normalizationTotal"],
this,e);e.hasOwnProperty("normalizationType")&&!e.normalizationType&&delete e.normalizationType;e.hasOwnProperty("classificationMethod")&&!e.classificationMethod&&delete e.classificationMethod;return c(e)}})})},"esri/renderers/VectorFieldRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/array ../kernel ../lang ../Color ./Renderer ./ClassBreaksRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils require".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v){var q=p(n,{declaredClass:"esri.renderer.VectorFieldRenderer",iconFolderPath:"../images/symbol/sfs/",constructor:function(a){h.isDefined(a)||(a={});a.attributeField=a.attributeField||"Magnitude";a.rotationInfo=a.rotationInfo||this._getRotationInfo(a);p.safeMixin(this,a);this.style=this.style||q.STYLE_SINGLE_ARROW;this.singleArrowSymbol&&(this.singleArrowSymbol=this.singleArrowSymbol.declaredClass?this.singleArrowSymbol:u.fromJson(this.singleArrowSymbol));this.renderer=
new g(this._getDefaultSymbol(),a.attributeField);this._updateRenderer(this.style);this.flowRepresentation=this.flowRepresentation||this.FLOW_FROM},getSymbol:function(a){return this.renderer&&this.renderer.getSymbol(a)},setVisualVariables:function(a){a=m.filter(a,function(a){if("sizeInfo"===a.type)return h.isDefined(this._updateSizeInfo(a))},this);this.inherited(arguments);return this},setSizeInfo:function(a){this._updateSizeInfo(a);this.inherited(arguments);return this},setProportionalSymbolInfo:function(a){this.setSizeInfo(a);
return this},setColorInfo:function(a){return this},_updateRenderer:function(a){return h.isDefined(this.renderer)?a===q.STYLE_SINGLE_ARROW?this._createSingleArrowRenderer():a===q.STYLE_BEAUFORT_KN?this._createBeaufortKnotsRenderer():a===q.STYLE_BEAUFORT_METER?this._createBeaufortMeterRenderer():a===q.STYLE_BEAUFORT_FEET?this._createBeaufortFeetRenderer():a===q.STYLE_BEAUFORT_MILE?this._createBeaufortMilesRenderer():a===q.STYLE_BEAUFORT_KM?this._createBeaufortKilometersRenderer():a===q.STYLE_OCEAN_CURRENT_M?
this._createCurrentMeterRenderer():a===q.STYLE_OCEAN_CURRENT_KN?this._createCurrentKnotsRenderer():a===q.STYLE_SCALAR?this._createSimpleScalarRenderer():a===q.STYLE_WIND_BARBS?this._createWindBarbsRenderer():this._createClassifiedArrowRenderer():Error("Invalid Renderer!")},_updateSizeInfo:function(a){return a&&h.isDefined(a.minSize)&&h.isDefined(a.maxSize)&&h.isDefined(a.minDataValue)&&h.isDefined(a.maxDataValue)?(this.style===q.STYLE_WIND_BARBS&&(a.minSize=a.maxSize),a.field=a.field||"Magnitude",
a.type="sizeInfo",a):null},_createClassifiedArrowRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([56,168,0]));var a=[0,1E-6,3.5,7,10.5,14];if(h.isDefined(this.minDataValue)&&h.isDefined(this.maxDataValue)){var c=(this.maxDataValue-this.minDataValue)/5,a=[],b,e;e=this.minDataValue;for(b=0;6>b;b++)a[b]=e,e+=c}this._addBreaks(a,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])},_createSingleArrowRenderer:function(){this.renderer.defaultSymbol=this.singleArrowSymbol||
this._getDefaultSymbol()},_createBeaufortMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks([0,
1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])},_createBeaufortFeetRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];m.forEach(a,function(c,b){a[b]*=3.28084});this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],
[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortMilesRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];m.forEach(a,function(c,b){a[b]*=2.23694});this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKilometersRenderer:function(){var a=
[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];m.forEach(a,function(c,b){a[b]*=3.6});this.renderer.defaultSymbol=this._getDefaultSymbol(new r([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createCurrentMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([177,177,177]));this._addBreaks([0,.5,1,1.5,2],[[78,26,
153],[179,27,26],[202,128,26],[177,177,177]])},_createCurrentKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new r([177,177,177]));this._addBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])},_createSimpleScalarRenderer:function(){this.renderer.defaultSymbol=new c({url:v.toUrl(this.iconFolderPath+"scalar.png"),height:20,width:20,type:"esriPMS",angle:0})},_createWindBarbsRenderer:function(){var b=
[],d,f;for(d=0;150>=d;d+=5)b.push(d);f="M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20;M25 0 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40;M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35;M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15 M25 10 M25 5 L17.5 7.5".split(";");
var g=new c({url:v.toUrl(this.iconFolderPath+"windbarb.png"),height:20,width:20,type:"esriPMS",angle:0});this.renderer.defaultSymbol=g;for(d=0;d<b.length-1;d++)0==d?this.renderer.addBreak({minValue:b[d],maxValue:b[d+1],symbol:g}):this.renderer.addBreak({minValue:b[d],maxValue:b[d+1],symbol:(new e).setPath(f[d]).setOutline((new a).setWidth(1.5)).setSize(20).setColor(new r([0,0,0,255]))})},_getDefaultSymbol:function(c){return(new e).setPath("M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z").setOutline((new a).setWidth(0)).setSize(20).setColor(c||
new r([0,92,230]))},_getRotationInfo:function(a){var c=a&&a.flowRepresentation||q.FLOW_FROM,b=a&&a.rotationField||"Direction",e=q.FLOW_FROM;return{field:function(a){a=a.attributes[b];return c===e?a:a+180},type:"geographic"}},_addBreaks:function(a,c){if(!h.isDefined(this.renderer))return Error("Invalid Renderer!");if(!(a&&c&&a.length&&c.length&&a.length>=c.length))return Error("AddBreaks: Input arguments break values and colors not valid");var b;for(b=0;b<c.length;b++)this.renderer.addBreak({minValue:a[b],
maxValue:a[b+1],symbol:this._getDefaultSymbol(new r(c[b]))})},toJson:function(){var a=f.mixin(this.inherited(arguments),{type:"vectorField",style:this.style,attributeField:this.attributeField,flowRepresentation:this.flowRepresentation});this.renderer&&this.renderer.defaultSymbol&&this.style===q.STYLE_SINGLE_ARROW&&(a.singleArrowSymbol=this.renderer.defaultSymbol.toJson());return h.fixJson(a)}});f.mixin(q,{STYLE_WIND_BARBS:"wind_speed",STYLE_SINGLE_ARROW:"single_arrow",STYLE_CLASSIFIED_ARROW:"classified_arrow",
STYLE_BEAUFORT_KN:"beaufort_kn",STYLE_BEAUFORT_METER:"beaufort_m",STYLE_BEAUFORT_MILE:"beaufort_mi",STYLE_BEAUFORT_FEET:"beaufort_ft",STYLE_BEAUFORT_KM:"beaufort_km",STYLE_OCEAN_CURRENT_M:"ocean_current_m",STYLE_OCEAN_CURRENT_KN:"ocean_current_kn",STYLE_SCALAR:"simple_scalar"},{FLOW_FROM:"flow_from",FLOW_TO:"flow_to"});return q})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){return p(e,{declaredClass:"esri.renderer.DotDensityRenderer",constructor:function(a){this.dotSize=a.dotSize||3;this.dotValue=a.dotValue;this.fields=a.fields;this.outline=a.outline;this.backgroundColor=a.backgroundColor;this.exactCount=a.exactCount||!0;this.dotShape=a.dotShape||"square";this.legendOptions=a.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=
null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1;window.CanvasRenderingContext2D||console.log("The DotDensityRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(a){var b,e;this._currentGraphic=a;if(!this._supportsCanvas)return null;this._map||(this._map=a.getLayer()._map,this._objectIdField=a.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",
f.hitch(this,function(a){this._currentMapScale=this._map.getScale();this._currentResolution=a.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]={}})));if(this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]])return b=this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]],e=this._getShapeProperties(a),b.setOffset(e.dx,e.dy),b;b=this._generateFieldsCount(this.fields,a.attributes,this.dotValue);e=this._getShapeProperties(a);
b=new c(this._generateImageSrc(e.width,e.height,b,e.minXY,e.maxXY),this.outline,e.width,e.height);b.setOffset(e.dx,e.dy);this._symbolMap[this._currentMapScale]||(this._symbolMap[this._currentMapScale]={});return this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]=b},_generateFieldsCount:function(a,c,b){var d,e;for(e=a.length-1;0<=e;e--)d=c[a[e].name]/b,a[e].numPoints=Math.round(d);return a},_getShapeProperties:function(a){var c,b,d,e;c=a.geometry.getExtent();c.contains(this._map.extent)&&
(c=this._map.extent);d=Math.ceil(c.getWidth()/this._currentResolution);e=Math.ceil(c.getHeight()/this._currentResolution);b=this._map.toScreen(new u(c.xmin,c.ymin,c.spatialReference));c=this._map.toScreen(new u(c.xmax,c.ymax,c.spatialReference));a=a.getLayer().getNode().getCTM();return{minXY:b,maxXY:c,dx:(b.x-a.e)%d,dy:(c.y-a.f)%e,width:d,height:e}},_generateImageSrc:function(a,c,b,d,e,f){var k=this.dotSize,g,t,h;this._canvas?(this._canvas.width=a,this._canvas.height=c):this._canvas=this._initCanvas(a,
c);g=this._canvas.getContext("2d");if(f=f||this.backgroundColor)g.fillStyle=f.toCss(!0),g.fillRect(0,0,a,c),g.fill();for(f=b.length-1;0<=f;f--)for(g.fillStyle=b[f].color.toCss(!0),t=b[f].numPoints-1;0<=t;t--)h=this._getRandomPoint(a,c,d,e),"square"===this.dotShape?g.fillRect(h.x,h.y,k,k):"circle"===this.dotShape&&(g.beginPath(),g.arc(h.x,h.y,k/2,0,2*Math.PI,!0)),g.fill();return this._canvas.toDataURL()},_initCanvas:function(a,c){var b=m.create("canvas",{id:"canvas",width:a+"px",height:c+"px",style:"position: absolute; left: -10000px; top: 0px;"},
null);document.body.appendChild(b);return b},_getRandomInt:function(a,c){return Math.floor(Math.random()*(c-a+1)+a)},_getRandomPoint:function(c,b,e,d){var f={},g=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&c*b>this._exactCountMinArea){c=!1;do f.x=this._getRandomInt(e.x,d.x),f.y=this._getRandomInt(d.y,e.y),c=new a(f.x,f.y),c=this._checkPointShapeBounds(c,this.dotSize+g,this._currentGraphic.geometry),!0===c&&(f.x-=e.x,f.y-=d.y);while(!1===c)}else f.x=this._getRandomInt(0,
c),f.y=this._getRandomInt(0,b);return f},_checkPointShapeBounds:function(a,c,b){var d=null,d=!1,e=!0,f=0;do{switch(f){case 1:a.x+=c;break;case 2:a.y+=c;break;case 3:a.x-=c}d=this._map.toMap(a);d=b.contains(d);!1===d&&(e=!1);f+=1}while(3>=f&&!0===e);return d},setDotSize:function(a){0<a&&(this.dotSize=a)},setDotValue:function(a){0<a&&(this.dotValue=a)},setOutline:function(a){this.outline=a},setBackgroundColor:function(a){this.backgroundColor=a},toJson:function(){var a=f.mixin(this.inherited(arguments),
{type:"dotDensity",backgroundColor:g.toJsonColor(this.backgroundColor),dotShape:this.dotShape,dotSize:0<this.dotSize?h.px2pt(this.dotSize):0,dotValue:this.dotValue,fields:b.map(this.fields,function(a){return n.fixJson({color:g.toJsonColor(a.color),name:a.name})}),legendOptions:this.legendOptions&&n.fixJson({backgroundColor:g.toJsonColor(this.legendOptions.backgroundColor),dotCoverage:this.legendOptions.dotCoverage,outline:this.legendOptions.outline&&this.legendOptions.outline.toJson(),valueUnit:this.legendOptions.valueUnit}),
outline:this.outline&&this.outline.toJson()});return n.fixJson(a)}})})},"esri/renderers/ScaleDependentRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ./Renderer".split(" "),function(p,f,b,m,l,h,r){return p(r,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(b){this.setRendererInfos(b&&b.rendererInfos||[])},setRendererInfos:function(b){this.rendererInfos=b;this._setRangeType();return this},getSymbol:function(b){var f=
this.getRendererInfo(b);return f&&f.renderer&&f.renderer.getSymbol(b)},getRendererInfo:function(b){b=b.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(b.getZoom()):this.getRendererInfoByScale(b.getScale())},getRendererInfoByZoom:function(b){var f,e=this.rendererInfos,c,a=0;do f=e[a],b>=f.minZoom&&b<=f.maxZoom&&(c=f),a++;while(!c&&a<e.length);return c},getRendererInfoByScale:function(b){var f,e=this.rendererInfos,c,a=0,h,l,q,k;do f=e[a],h=f.minScale,l=f.maxScale,q=!h,k=
!l,!q&&b<=h&&(q=!0),!k&&b>=l&&(k=!0),q&&k&&(c=f),a++;while(!c&&a<e.length);return c},addRendererInfo:function(b){var f,e=0,c,a=this.rendererInfos,h=b.hasOwnProperty("minZoom")?"minZoom":"minScale",l=a.length;do{c=a[e];if(l===e||b[h]<c[h])a.splice(e,0,b),this._setRangeType(),f=!0;e++}while(!f&&e<l);return this},_setRangeType:function(){var b=this.rendererInfos;if(b=b&&b[0])this.rangeType=b.hasOwnProperty("minZoom")?"zoom":b.hasOwnProperty("minScale")?"scale":""},toJson:function(){if("zoom"===this.rangeType)return null;
var l=this.rendererInfos||[],g=l[0]&&l[0].minScale,l=b.mixin(this.inherited(arguments),{type:"scaleDependent",minScale:0<g?g:0,rendererInfos:f.map(l,function(b){return h.fixJson({maxScale:0<b.maxScale?b.maxScale:0,renderer:b.renderer&&b.renderer.toJson()})})});return h.fixJson(l)}})})},"esri/renderers/TimeClassBreaksAger":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/date ../kernel ../lang ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(p,f,b,
m,l,h,r,n,g,e){var c=p(e,{declaredClass:"esri.renderer.TimeClassBreaksAger",constructor:function(a,b){this.infos=a;this.timeUnits=b||"day";a.sort(function(a,b){return a.minAge<b.minAge?-1:a.minAge>b.minAge?1:0})},getAgedSymbol:function(a,b){var c=b.getLayer(),e=b.attributes,k=r.isDefined;a=n.fromJson(a.toJson());var d=c._map.timeExtent.endTime;if(!d)return a;var g=l.difference(new Date(e[c._startTimeField]),d,this.timeUnits);f.some(this.infos,function(b){if(g>=b.minAge&&g<=b.maxAge){var c=b.color,
d=b.size;b=b.alpha;c&&a.setColor(c);k(d)&&this._setSymbolSize(a,d);k(b)&&a.color&&(a.color.a=b);return!0}},this);return a},toJson:function(){var a={agerClassBreakInfos:[]},b,c,e;a.timeUnits=this._getRestUnits(this.timeUnits);for(b=0;b<this.infos.length;b+=1)c=this.infos[b],e={},e.oldestAge=Infinity===c.maxAge?null:c.maxAge,e.size=c.size,c.color&&(e.color=g.toJsonColor(c.color)),c.alpha&&(e.alpha=Math.round(255*c.alpha)),a.agerClassBreakInfos[b]=e;return a},_getRestUnits:function(a){var b="esriTimeUnitsDays";
switch(a){case c.UNIT_SECONDS:b="esriTimeUnitsSeconds";break;case c.UNIT_MILLISECONDS:b="esriTimeUnitsMilliseconds";break;case c.UNIT_HOURS:b="esriTimeUnitsHours";break;case c.UNIT_MINUTES:b="esriTimeUnitsMinutes";break;case c.UNIT_MONTHS:b="esriTimeUnitsMonths";break;case c.UNIT_WEEKS:b="esriTimeUnitsWeeks";break;case c.UNIT_YEARS:b="esriTimeUnitsYears"}return b}});b.mixin(c,{UNIT_DAYS:"day",UNIT_HOURS:"hour",UNIT_MILLISECONDS:"millisecond",UNIT_MINUTES:"minute",UNIT_MONTHS:"month",UNIT_SECONDS:"second",
UNIT_WEEKS:"week",UNIT_YEARS:"year"});return c})},"esri/renderers/SymbolAger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,f,b,m){return p(null,{declaredClass:"esri.renderer.SymbolAger",getAgedSymbol:function(b,f){},_setSymbolSize:function(b,f){switch(b.type){case "simplemarkersymbol":b.setSize(f);break;case "picturemarkersymbol":b.setWidth(f);b.setHeight(f);break;case "simplelinesymbol":case "cartographiclinesymbol":b.setWidth(f);break;case "simplefillsymbol":case "picturefillsymbol":b.outline&&
b.outline.setWidth(f)}}})})},"esri/renderers/TimeRampAger":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(p,f,b,m,l,h,r,n){return p(n,{declaredClass:"esri.renderer.TimeRampAger",constructor:function(b,e,c){this.colorRange=b;this.sizeRange=e;this.alphaRange=c},getAgedSymbol:function(f,e){var c=e.getLayer(),a=e.attributes;f=h.fromJson(f.toJson());var g=c._map.timeExtent,l=g.startTime,g=g.endTime;
if(!l||!g)return f;l=l.getTime();g=g.getTime();c=new Date(a[c._startTimeField]);c=c.getTime();c<l&&(c=l);l=g===l?1:(c-l)/(g-l);if(c=this.sizeRange)a=c[0],g=c[1],c=Math.abs(g-a)*l,this._setSymbolSize(f,a<g?a+c:a-c);if(c=this.colorRange){var g=c[0],q=c[1],k=Math.round,a=new b,d=g.r,n=q.r,c=Math.abs(n-d)*l;a.r=k(d<n?d+c:d-c);d=g.g;n=q.g;c=Math.abs(n-d)*l;a.g=k(d<n?d+c:d-c);d=g.b;n=q.b;c=Math.abs(n-d)*l;a.b=k(d<n?d+c:d-c);g=g.a;q=q.a;c=Math.abs(q-g)*l;a.a=g<q?g+c:g-c;f.setColor(a)}a=f.color;(c=this.alphaRange)&&
a&&(g=c[0],q=c[1],c=Math.abs(q-g)*l,a.a=g<q?g+c:g-c);return f},toJson:function(){var b={};this.sizeRange&&(b.sizeRange=this.sizeRange);this.colorRange&&(b.colorRange=[r.toJsonColor(this.colorRange[0]),r.toJsonColor(this.colorRange[1])]);this.alphaRange&&(b.alphaRange=[Math.round(255*this.alphaRange[0]),Math.round(255*this.alphaRange[1])]);return b}})})},"esri/renderers/TemporalRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Renderer"],function(p,f,b,m,
l){return p(l,{declaredClass:"esri.renderer.TemporalRenderer",constructor:function(b,f,l,g){this.observationRenderer=b;this.latestObservationRenderer=f;this.trackRenderer=l;this.observationAger=g},getSymbol:function(b){var f=b.getLayer(),h=this.getObservationRenderer(b),g=h&&h.getSymbol(b),e=this.observationAger;f.timeInfo&&f._map.timeExtent&&h===this.observationRenderer&&e&&g&&(g=e.getAgedSymbol(g,b));return g},getObservationRenderer:function(b){return 0===b.getLayer()._getKind(b)?this.observationRenderer:
this.latestObservationRenderer||this.observationRenderer},toJson:function(){var b={type:"temporal"};b.observationRenderer=this.observationRenderer.toJson();this.latestObservationRenderer&&(b.latestObservationRenderer=this.latestObservationRenderer.toJson());this.trackRenderer&&(b.trackRenderer=this.trackRenderer.toJson());this.observationAger&&(b.observationAger=this.observationAger.toJson());return b}})})},"esri/renderers/HeatmapRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct ../sniff ../kernel ../lang ../symbols/PictureMarkerSymbol ../Color ./Renderer".split(" "),
function(p,f,b,m,l,h,r,n,g,e){return p([e],{declaredClass:"esri.renderer.HeatmapRenderer",colors:null,blurRadius:10,maxPixelIntensity:100,minPixelIntensity:0,field:null,fieldOffset:null,colorStops:null,constructor:function(b){(this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1)?("string"==typeof b&&(b=JSON.parse(b)),f.mixin(this,b),this._canvas=null,this.colors||this.colorStops||(this.colorStops=[{ratio:0,color:"rgba(255, 140, 0, 0)"},{ratio:.75,color:"rgba(255, 140, 0, 1)"},{ratio:.9,color:"rgba(255, 0,   0, 1)"}]),
this.gradient=this._generateGradient(this.colorStops||this.colors)):console.log("The HeatmapRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(b){if(!this._supportsCanvas)return!1;var a=b.attributes.imageData;b=b.attributes.size;if(!b)return null;var c=this._getContext(b[0],b[1]),e=c.getImageData(0,0,b[0],b[1]);window.ArrayBuffer&&a instanceof ArrayBuffer?a=window.Uint8ClampedArray?new Uint8ClampedArray(a):new Uint8Array(a):a.BYTES_PER_ELEMENT&&
1!==a.BYTES_PER_ELEMENT&&(a=window.Uint8ClampedArray?new Uint8ClampedArray(a.buffer):new Uint8Array(a.buffer));if(window.CanvasPixelArray&&e.data instanceof window.CanvasPixelArray)for(var f=e.data,g=f.length;g--;)f[g]=a[g];else e.data.set(a);c.putImageData(e,0,0);return new n(c.canvas.toDataURL(),b[0],b[1])},setColors:function(b){b&&(b instanceof Array||b.colors)&&(this.gradient=this._generateGradient(b.colors||b),this.colors=b);return this},setColorStops:function(b){b&&(b instanceof Array||b.colorStops)&&
(this.gradient=this._generateGradient(b.colorStops||b),this.colorStops=b);return this},setMaxPixelIntensity:function(b){this.maxPixelIntensity=b;return this},setMinPixelIntensity:function(b){this.minPixelIntensity=b;return this},setField:function(b){this.field=b;return this},setFieldOffset:function(b){this.fieldOffset=b;return this},setBlurRadius:function(b){this.blurRadius=b;return this},getStats:function(){},getHistogramData:function(){},toJson:function(){var c=f.mixin(this.inherited(arguments),
{type:"heatmap",blurRadius:this.blurRadius,colorStops:this._colorsToStops(this.colorStops||this.colors),maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity,field:this.field});null!=this.fieldOffset&&(c.fieldOffset=this.fieldOffset);b.forEach(c.colorStops,function(a){a.color=g.toJsonColor(a.color)});return r.fixJson(c)},_getContext:function(b,a){this._canvas?(this._canvas.width=b,this._canvas.height=a):this._canvas=this._initCanvas(b,a);return this._canvas.getContext("2d")},
_initCanvas:function(b,a){var c=m.create("canvas",{id:"hm_canvas-"+Math.floor(1E3*Math.random()),style:"position: absolute; left: 0px; top: -10000px;"},null);c.width=b;c.height=a;document.body.appendChild(c);return c},_generateGradient:function(b,a){a||(a=512);for(var c=this._colorsToStops(b),e=this._getContext(1,a||512),f=e.createLinearGradient(0,0,0,a),g=0,d;g<c.length;g++)d=c[g],f.addColorStop(d.ratio,d.color.toCss(!0));e.fillStyle=f;e.fillRect(0,0,1,a);return e.getImageData(0,0,1,a).data},_colorsToStops:function(c){var a=
[];if(!c[0])return a;if(null!=c[0].ratio)a=b.map(c,function(a){return{ratio:a.ratio,color:this._toColor(a.color)}},this);else if(null!=c[0].value){var e=Infinity,a=-Infinity,f=0,g;for(g=0;g<c.length;g++){var k=c[g].value;k<e&&(e=k);k>a&&(a=k)}f=a-e;this.maxPixelIntensity=a;this.minPixelIntensity=e;a=b.map(c,function(a){var b=a.value;a=this._toColor(a.color);return{value:b,ratio:(b-e)/f,color:a}},this)}else var d=c.length-1,a=b.map(c,function(a,b){return{color:this._toColor(a),ratio:b/d}},this);return a},
_toColor:function(b){b.toRgba||b.declaredClass||(b=new g(b));return b}})})},"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(p,f,b,m,l,h,r,n){return p([h,r],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(b,e){f.mixin(this,e);this.initialize(b,e)},getTitle:function(b){var e;this.info&&(e=this.titleHasRelatedFields?
"":this._getPopupValues(b,!0).title);return e||""},getContent:function(b){return this.info?(new n({template:this,graphic:b,chartTheme:this.chartTheme},m.create("div"))).domNode:""}})})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition dojo/i18n!dojo/cldr/nls/number".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d){return p(null,{declaredClass:"esri.PopupInfo",initialize:function(a,c){if(a){f.mixin(this,c);this.info=a;this.title=this.getTitle;this.content=this.getContent;var d=this._fieldLabels={},e=this._fieldsMap={};a.fieldInfos&&b.forEach(a.fieldInfos,function(a){var b=a.fieldName.toLowerCase();d[b]=a.label;e[b]=a});this._relatedFieldPrefix="relationships/";this.titleHasRelatedFields=!(!a.title||-1===a.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return m.fromJson(m.toJson(this.info))},
getTitle:function(){},getContent:function(){},getFieldInfo:function(a){var c;b.some(this.info&&this.info.fieldInfos,function(b){b.fieldName===a&&(c=b);return!!c});return c},getComponents:function(a){var c=this.info,d=new r,e,g;c.fieldInfos&&(g=b.filter(c.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this));g&&0<g.length&&(e=this._getRelatedRecords({graphic:a,fieldsInfo:g}));e?e.always(f.hitch(this,function(){d.resolve(this._getPopupValues(a))})):d.resolve(this._getPopupValues(a));
return d.promise},getAttachments:function(a){var b=a.getLayer();a=a.attributes;if(this.info.showAttachments&&b&&b.hasAttachments&&b.objectIdField&&(a=a&&a[b.objectIdField]))return b.queryAttachmentInfos(a)},_getPopupValues:function(a,c){var d=this.info,g=a.getLayer(),k=f.clone(a.attributes)||{},t=f.clone(k),h=d.fieldInfos,q="",l="",u,v,n,m,w,r=g&&g._getDateOpts&&g._getDateOpts().properties,r=r&&r.slice(0),p={dateFormat:{properties:r,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};
if(this._relatedInfo)for(m in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(m)){var K=this._relatedInfo[m],V=this._relatedLayersInfo[m];K&&(b.forEach(K.relatedFeatures,function(a){for(w in a.attributes)if(a.attributes.hasOwnProperty(w)&&"esriRelCardinalityOneToOne"===V.relation.cardinality){var b=this._toRelatedFieldName([V.relation.id,w]);k[b]=t[b]=a.attributes[w]}},this),b.forEach(K.relatedStatsFeatures,function(a){for(w in a.attributes)if(a.attributes.hasOwnProperty(w)){var b=this._toRelatedFieldName([V.relation.id,
w]);k[b]=t[b]=a.attributes[w]}},this))}h&&b.forEach(h,function(a){v=a.fieldName;var c=this._getLayerFieldInfo(g,v);c&&(v=a.fieldName=c.name);t[v]=this._formatValue(t[v],v,p);r&&a.format&&a.format.dateFormat&&(a=b.indexOf(r,v),-1<a&&r.splice(a,1))},this);if(g){m=g.types;var S=(K=g.typeIdField)&&k[K];for(v in k)if(k.hasOwnProperty(v)&&-1===v.indexOf(this._relatedFieldPrefix)&&(n=k[v],e.isDefined(n))){var ba=this._getDomainName(g,a,m,S,v,n);e.isDefined(ba)?t[v]=ba:v===K&&(ba=this._getTypeName(g,a,n),
e.isDefined(ba)&&(t[v]=ba))}}d.title&&(q=this._processFieldsInLinks(this._fixTokens(d.title,g),k),q=f.trim(e.substitute(t,q,p)||""));if(c)return{title:q};d.description&&(l=this._processFieldsInLinks(this._fixTokens(d.description,g),k),l=f.trim(e.substitute(t,l,p)||""));h&&(u=[],b.forEach(h,function(a){(v=a.fieldName)&&a.visible&&u.push([a.label||v,e.substitute(t,"${"+v+"}",p)||""])}));var N,M;d.mediaInfos&&(N=[],b.forEach(d.mediaInfos,function(a){M=0;n=a.value;switch(a.type){case "image":var c=n.sourceURL,
c=c&&f.trim(e.substitute(k,this._fixTokens(c,g)));M=!!c;break;case "piechart":case "linechart":case "columnchart":case "barchart":var d,c=n.normalizeField;n.fields=b.map(n.fields,function(a){return(d=this._getLayerFieldInfo(g,a))?d.name:a},this);c&&(d=this._getLayerFieldInfo(g,c),n.normalizeField=d?d.name:c);M=b.some(n.fields,function(a){return e.isDefined(k[a])||-1!==a.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(M){a=f.clone(a);n=a.value;var c=a.title?this._processFieldsInLinks(this._fixTokens(a.title,
g),k):"",h=a.caption?this._processFieldsInLinks(this._fixTokens(a.caption,g),k):"";a.title=c?f.trim(e.substitute(t,c,p)||""):"";a.caption=h?f.trim(e.substitute(t,h,p)||""):"";if("image"===a.type)n.sourceURL=e.substitute(k,this._fixTokens(n.sourceURL,g)),n.linkURL&&(n.linkURL=f.trim(e.substitute(k,this._fixTokens(n.linkURL,g))||""));else{var q,l;b.forEach(n.fields,function(a,b){if(-1!==a.indexOf(this._relatedFieldPrefix))l=this._getRelatedChartInfos(a,n,k,p),l instanceof Array?n.fields=l:n.fields[b]=
l;else{var c=k[a],c=void 0===c?null:c;q=k[n.normalizeField]||0;c&&q&&(c/=q);n.fields[b]={y:c,tooltip:(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(c,a,p,!!q)}}},this)}N.push(a)}},this));return{title:q,description:l,hasDescription:!!d.description,fields:u&&u.length?u:null,mediaInfos:N&&N.length?N:null,formatted:t,editSummary:g&&g.getEditSummary?g.getEditSummary(a):""}},_getRelatedChartInfos:function(a,c,d,f){var g,k,t,h,q,l;g=[];l=this._fromRelatedFieldName(a);q=l[0];k=this._relatedInfo[q];
q=this._relatedLayersInfo[q];k&&b.forEach(k.relatedFeatures,function(b){b=b.attributes;var k,q;for(q in b)if(b.hasOwnProperty(q)&&q===l[1]){k={};h=b[q];c.normalizeField&&(t=-1!==c.normalizeField.indexOf(this._relatedFieldPrefix)?b[this._fromRelatedFieldName(c.normalizeField)[1]]:d[c.normalizeField]);h&&t&&(h/=t);if(c.tooltipField)if(-1!==c.tooltipField.indexOf(this._relatedFieldPrefix)){var u=this._fromRelatedFieldName(c.tooltipField)[1],v=e.isDefined(b[u])?b[u]:u;k.tooltip=v+":\x3cbr/\x3e"+this._formatValue(h,
u,f,!!t)}else k.tooltip=(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(h,c.tooltipField,f,!!t);else k.tooltip=h;k.y=h;g.push(k)}},this);return"esriRelCardinalityOneToMany"===q.relation.cardinality||"esriRelCardinalityManyToMany"===q.relation.cardinality?g:g[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",
longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",
shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,
_fixTokens:function(a,b){var c=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,d,e){a=c._getLayerFieldInfo(b,e);return"$"+(a?"{"+a.name+"}":d)})},_encodeAttributes:function(a){a=f.clone(a)||{};var b,c;for(b in a)(c=a[b])&&"string"===typeof c&&(c=encodeURIComponent(c).replace(/\'/g,"\x26apos;"),a[b]=c);return a},_processFieldsInLinks:function(a,b){var c=this._encodeAttributes(b),d=this;a&&(a=a.replace(this._reHref,function(a,e){return d._addValuesToHref(a,e,b,c)}).replace(this._reHrefApos,function(a,
e){return d._addValuesToHref(a,e,b,c)}));return a},_addValuesToHref:function(a,b,c,d){b=b&&f.trim(b);return e.substitute(b&&0===b.indexOf("${")?c:d,a)},_getLayerFieldInfo:function(a,b){return a&&a.getField?a.getField(b):null},_formatValue:function(a,c,g,k){var t=this._fieldsMap[c.toLowerCase()],h=t&&t.format;c=-1!==b.indexOf(g.dateFormat.properties,c);var q="number"===typeof a&&!c&&(!h||!h.dateFormat);if(!e.isDefined(a)||!t||!e.isDefined(h))return q?this._forceLTR(a):a;var l="",t=[],u=h.hasOwnProperty("places")||
h.hasOwnProperty("digitSeparator"),v=h.hasOwnProperty("digitSeparator")?h.digitSeparator:!0;if(u&&!c)l="NumberFormat",t.push("places: "+(e.isDefined(h.places)&&(!k||0<h.places)?Number(h.places):"Infinity")),t.length&&(l+="("+t.join(",")+")");else if(h.dateFormat)l="DateFormat"+this._insertOffset(this._dateFormats[h.dateFormat]||this._dateFormats.shortDateShortTime);else return q?this._forceLTR(a):a;var n=this._applyFormatting(a,l,g);u&&-1<a.constructor.toString().indexOf("Array")&&(n="",b.forEach(a,
f.hitch(this,function(a,b){b&&(n+=" ");n+=this._applyFormatting(a,l,g)})));u&&!v&&d.group&&(n=n.replace(new RegExp("\\"+d.group,"g"),""));c&&(n='\x3cspan class\x3d"esriDateValue"\x3e'+n+"\x3c/span\x3e");return q?this._forceLTR(n):n},_applyFormatting:function(a,b,c){return e.substitute({myKey:a},"${myKey:"+b+"}",c)||""},_forceLTR:function(a){var b=n("ie");return b&&10>=b?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_insertOffset:function(a){a&&(a=e.isDefined(this.utcOffset)?a.replace(/\)\s*$/,
", utcOffset:"+this.utcOffset+")"):a);return a},_getDomainName:function(a,b,c,d,e,f){return(a=a.getDomain&&a.getDomain(e,{feature:b}))&&a.codedValues?a.getName(f):null},_getTypeName:function(a,b,c){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b=a.graphic,c=new r,d;this._relatedLayersInfo?this._queryRelatedLayers(b).then(f.hitch(this,function(a){this._setRelatedRecords(b,a);c.resolve(a)}),f.hitch(this,this._handlerErrorResponse,c)):this._getRelatedLayersInfo(a).then(f.hitch(this,
function(a){for(d in a)a.hasOwnProperty(d)&&a[d]&&(this._relatedLayersInfo[d].relatedLayerInfo=a[d]);this._queryRelatedLayers(b).then(f.hitch(this,function(a){this._setRelatedRecords(b,a);c.resolve(a)}),f.hitch(this,this._handlerErrorResponse,c))}),f.hitch(this,this._handlerErrorResponse,c));return c.promise},_getRelatedLayersInfo:function(c){var d=c.fieldsInfo,e,f,h={};e=c.graphic.getLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});b.forEach(d,function(a){var c,d,f,g;c=this._fromRelatedFieldName(a.fieldName);
d=c[0];c=c[1];d&&(this._relatedLayersInfo[d]||(b.some(e.relationships,function(a){if(a.id==d)return g=a,!0}),g&&(this._relatedLayersInfo[d]={relation:g,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[d]&&(this._relatedLayersInfo[d].relatedFields.push(c),a.statisticType&&(f=new k,f.statisticType=a.statisticType,f.onStatisticField=c,f.outStatisticFieldName=c,this._relatedLayersInfo[d].outStatistics.push(f))))},this);for(f in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(f)&&
this._relatedLayersInfo[f]&&(c=this._relatedLayersInfo[f].relation,c=e.url.replace(/[0-9]+$/,c.relatedTableId),this._relatedLayersInfo[f].relatedLayerUrl=c,h[f]=a({url:c,content:{f:"json"},callbackParamName:"callback"}));return g(h)},_queryRelatedLayers:function(a){var b={},c;for(c in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(c)&&(b[c]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[c]}));return g(b)},_queryRelatedLayer:function(a){var c,d,e,k,h,q,l,n,m,
w,p,L,P;c=a.graphic;d=c.getLayer();e=d.url.match(/[0-9]+$/g)[0];p=a.relatedInfo;w=p.relatedLayerInfo;L=p.relatedLayerUrl;a=p.relation;b.some(w.relationships,function(a){if(a.relatedTableId===parseInt(e,10))return k=a,!0},this);k&&(h=new u,b.some(w.fields,function(a){if(a.name===k.keyField)return n=-1!==b.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],a.type)?"number":"string",!0}),k.relationshipTableId&&k.keyFieldInRelationshipTable?(P=new r,
this._queryRelatedRecords(c,k).then(f.hitch(this,function(a){var e;e=a[c.attributes[d.objectIdField]];a=b.map(e.features,function(a){return a.attributes[w.objectIdField]},this);p.outStatistics&&0<p.outStatistics.length&&w.supportsStatistics&&(m=new u,m.objectIds=a,m.outFields=h.outFields,m.outStatistics=p.outStatistics);m&&(q=new v(L),q.execute(m).then(f.hitch(this,function(a){var b=[];b.push(e);b.push(a);P.resolve(b)})))}))):(l="string"===n?k.keyField+"\x3d'"+c.attributes[a.keyField]+"'":k.keyField+
"\x3d"+c.attributes[a.keyField],h.where=l,h.outFields=p.relatedFields,p.outStatistics&&0<p.outStatistics.length&&w.supportsStatistics&&(m=new u,m.where=h.where,m.outFields=h.outFields,m.outStatistics=p.outStatistics),q=new v(L),l=[],l.push(q.execute(h)),m&&l.push(q.execute(m))));return l?g(l):P?P.promise:void 0},_setRelatedRecords:function(a,b){this._relatedInfo=[];for(var c in b)if(b.hasOwnProperty(c)&&b[c]){var d=b[c];this._relatedInfo[c]={};this._relatedInfo[c].relatedFeatures=d[0].features;e.isDefined(d[1])&&
(this._relatedInfo[c].relatedStatsFeatures=d[1].features)}},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b=[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),b=a.slice(1));return b},_toRelatedFieldName:function(a){var b="";a&&0<a.length&&(b=this._relatedFieldPrefix+a[0]+"/"+a[1]);return b},_queryRelatedRecords:function(a,b){var c=a.getLayer(),d=new q;d.outFields=["*"];d.relationshipId=b.id;d.objectIds=[a.attributes[c.objectIdField]];return c.queryRelatedFeatures(d)}})})},
"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u){p=p(a,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},
constructor:function(a,b){this._handler=f.hitch(this,this._handler);this._relationshipQueryHandler=f.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=f.hitch(this,this._executeForIdsHandler);this._countHandler=f.hitch(this,this._countHandler);this._extentHandler=f.hitch(this,this._extentHandler);this.source=b&&b.source;this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],
e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},onExecuteForExtentComplete:function(){},execute:function(a,b,c,d,e){var g=e.assembly;a=this._encode(f.mixin({},this._url.query,{f:"json"},a.toJson(g&&g[0])));var k=this._handler,h=this._errorHandler;this.source&&(g={source:this.source.toJson()},
a.layer=l.toJson(g));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return n({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,d){k(a,d,b,c,e.dfd)},error:function(a){h(a,c,e.dfd)},callbackSuffix:d},this.requestOptions)},executeRelationshipQuery:function(a,b,c){a=this._encode(f.mixin({},this._url.query,{f:"json"},a.toJson()));var d=this._relationshipQueryHandler,e=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var k=new m(g._dfdCanceller);k._pendingDfd=
n({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",load:function(a,e){d(a,e,b,c,k)},error:function(a){e(a,c,k)}},this.requestOptions);return k},executeForIds:function(a,b,c,d){var e=d.assembly;a=this._encode(f.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},a.toJson(e&&e[0])));var g=this._executeForIdsHandler,k=this._errorHandler;this.source&&(e={source:this.source.toJson()},a.layer=l.toJson(e));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return n({url:this._url.path+
"/query",content:a,callbackParamName:"callback",load:function(a,e){g(a,e,b,c,d.dfd)},error:function(a){k(a,c,d.dfd)}},this.requestOptions)},executeForCount:function(a,b,c,d){var e=d.assembly;a=this._encode(f.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(e&&e[0])));var g=this._countHandler,k=this._errorHandler;this.source&&(e={source:this.source.toJson()},a.layer=l.toJson(e));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return n({url:this._url.path+"/query",content:a,
callbackParamName:"callback",load:function(a,e){g(a,e,b,c,d.dfd)},error:function(a){k(a,c,d.dfd)}},this.requestOptions)},executeForExtent:function(a,b,c,d){var e=d.assembly;a=this._encode(f.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(e&&e[0])));var g=this._extentHandler,k=this._errorHandler;this.source&&(e={source:this.source.toJson()},a.layer=l.toJson(e));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return n({url:this._url.path+"/query",content:a,callbackParamName:"callback",
load:function(a,e){g(a,e,b,c,d.dfd)},error:function(a){k(a,c,d.dfd)}},this.requestOptions)},_handler:function(a,b,c,d,e){try{var f=new u(a);this._successHandler([f],"onComplete",c,e)}catch(x){this._errorHandler(x,d,e)}},_relationshipQueryHandler:function(a,c,e,d,f){try{var g=a.geometryType,k=a.spatialReference,h={};b.forEach(a.relatedRecordGroups,function(a){var b={};b.geometryType=g;b.spatialReference=k;b.features=a.relatedRecords;b=new u(b);if(null!=a.objectId)h[a.objectId]=b;else for(var c in a)a.hasOwnProperty(c)&&
"relatedRecords"!==c&&(h[a[c]]=b)});this._successHandler([h],"onExecuteRelationshipQueryComplete",e,f)}catch(y){this._errorHandler(y,d,f)}},_executeForIdsHandler:function(a,b,c,d,e){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",c,e)}catch(t){this._errorHandler(t,d,e)}},_countHandler:function(a,b,c,d,e){try{var f,g=a.features,k=a.objectIds;if(k)f=k.length;else{if(g)throw Error("Unable to perform query. Please check your parameters.");f=a.count}this._successHandler([f],"onExecuteForCountComplete",
c,e)}catch(y){this._errorHandler(y,d,e)}},_extentHandler:function(a,b,c,d,f){try{a.extent&&(a.extent=new e(a.extent)),this._successHandler([a],"onExecuteForExtentComplete",c,f)}catch(t){this._errorHandler(t,d,f)}}});c._createWrappers(p);return p})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),function(p,f,b,m,l,h,r,n){return p(n,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],
complete:["result"]},constructor:function(b,e){b&&f.isString(b)&&(this._url=r.urlToObject(this.url=b));e&&e.requestOptions&&(this.requestOptions=e.requestOptions);this.normalization=!0;this._errorHandler=f.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var b=this._url,e=/^http:/i;this.url&&(this.url=this.url.replace(e,"https:"));b&&b.path&&(b.path=b.path.replace(e,"https:"))},_encode:function(g,e,c){var a,h,l={},q,k;for(q in g)if("declaredClass"!==q&&(a=g[q],h=typeof a,
null!==a&&void 0!==a&&"function"!==h))if(f.isArray(a))for(l[q]=[],k=a.length,h=0;h<k;h++)l[q][h]=this._encode(a[h]);else"object"===h?a.toJson&&(h=a.toJson(c&&c[q]),"esri.tasks.FeatureSet"===a.declaredClass&&h.spatialReference&&(h.sr=h.spatialReference,delete h.spatialReference),l[q]=e?h:b.toJson(h)):l[q]=a;return l},_successHandler:function(b,e,c,a){e&&this[e].apply(this,b);c&&c.apply(null,b);a&&h._resDfd(a,b)},_errorHandler:function(b,e,c){this.onError(b);e&&e(b);c&&c.errback(b)},setNormalization:function(b){this.normalization=
b},onError:function(){}})})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){return p(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(a){if(a){f.mixin(this,a);var g=this.features,h=a.spatialReference,q=e.getGeometryType(a.geometryType),h=this.spatialReference=new n(h);this.geometryType=
a.geometryType;a.fields&&(this.fields=a.fields);b.forEach(g,function(a,b){var d=a.geometry&&a.geometry.spatialReference;g[b]=new r(q&&a.geometry?new q(a.geometry):null,a.symbol&&c.fromJson(a.symbol),a.attributes);g[b].geometry&&!d&&g[b].geometry.setSpatialReference(h)});this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(a){var b={};this.displayFieldName&&(b.displayFieldName=this.displayFieldName);this.fields&&(b.fields=
this.fields);this.spatialReference?b.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(b.geometryType=e.getJsonType(this.features[0].geometry)),b.features=g._encodeGraphics(this.features,a));b.exceededTransferLimit=this.exceededTransferLimit;b.transform=this.transform;return h.fixJson(b)},_hydrate:function(){var a=this.transform,b=this.geometryType;
if(a&&b)for(var c=this.features,e=a.translate[0],f=a.translate[1],d=a.scale[0],g=a.scale[1],t=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=c(a.y)};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){a=a.rings||a.paths;var d,e,f,g,k,t,h,q;d=0;for(e=a.length;d<e;d++)for(k=a[d],f=0,g=k.length;f<g;f++)t=k[f],0<f?(h+=t[0],q+=t[1]):(h=t[0],q=t[1]),t[0]=b(h),t[1]=c(q)};if("esriGeometryEnvelope"===a)return function(a){a.xmin=b(a.xmin);a.ymin=c(a.ymin);
a.xmax=b(a.xmax);a.ymax=c(a.ymax)};if("esriGeometryMultipoint"===a)return function(a){a=a.points;var d,e,f,g,k;d=0;for(e=a.length;d<e;d++)f=a[d],0<d?(g+=f[0],k+=f[1]):(g=f[0],k=f[1]),f[0]=b(g),f[1]=c(k)}}(b,function(a){return a*d+e},function(a){return f-a*g}),a=0,b=c.length;a<b;a++)c[a].geometry&&t(c[a].geometry);this.transform=null},quantize:function(a){if(!this.geometryType)return this.transform=null,this;var b=a.translate[0],c=a.translate[1],e=a.scale[0],f=a.scale[1],d=this.features,g=function(a,
b,c){var d,e,f,g,k,t,h=[];d=0;for(e=a.length;d<e;d++)if(f=a[d],0<d){if(t=b(f[0]),f=c(f[1]),t!==g||f!==k)h.push([t-g,f-k]),g=t,k=f}else g=b(f[0]),k=c(f[1]),h.push([g,k]);return 0<h.length?h:null},t=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=c(a.y);return a};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){var d,e,f,k,t;f=a.rings||a.paths;t=[];d=0;for(e=f.length;d<e;d++)k=f[d],(k=g(k,b,c))&&t.push(k);return 0<t.length?(a.rings?a.rings=t:a.paths=
t,a):null};if("esriGeometryMultipoint"===a)return function(a){var d;d=g(a.points,b,c);return 0<d.length?(a.points=d,a):null};if("esriGeometryEnvelope"===a)return function(a){return a}}(this.geometryType,function(a){return Math.round((a-b)/e)},function(a){return Math.round((c-a)/f)}),h,l;h=0;for(l=d.length;h<l;h++)d[h].geometry&&(t(d[h].geometry)||d[h].setGeometry(null));this.transform=a;return this}})})},"esri/graphicsUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","./kernel",
"./geometry/Extent"],function(p,f,b,m,l){return{graphicsExtent:function(b){if(!b||!b.length)return null;var f=b[0].geometry,h=f.getExtent(),g,e,c=b.length;null===h&&(h=new l(f.x,f.y,f.x,f.y,f.spatialReference));for(e=1;e<c;e++)g=(f=b[e].geometry).getExtent(),null===g&&(g=new l(f.x,f.y,f.x,f.y,f.spatialReference)),h=h.union(g);return 0>h.getWidth()&&0>h.getHeight()?null:h},getGeometries:function(b){return f.map(b,function(b){return b.geometry})},_encodeGraphics:function(b,l){var h=[],g,e,c;f.forEach(b,
function(a,b){g=a.toJson();e={};g.geometry&&(c=l&&l[b],e.geometry=c&&c.toJson()||g.geometry);g.attributes&&(e.attributes=g.attributes);h[b]=e});return h}}})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],function(p,f,b,m,l){return p(null,{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,toJson:function(){var f=
{definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},l=this.objectIds,n=this.outFields,g=this.outSpatialReference;l&&(f.objectIds=l.join(","));n&&(f.outFields=n.join(","));g&&(f.outSR=g.wkid||b.toJson(g.toJson()));f._ts=this._ts;return f}})})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],
function(p,f,b,m){return p(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}})})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x){var A=0;return f([t,q,k],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=m.mixin({},x.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(m.hitch(this,this._handleComponentsSuccess),m.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var a=this._mediaInfos,b=a.length,d=this.domNode,f=this._prevMedia,g=this._nextMedia;if(1<b){var k=0,t=0;l.forEach(a,function(a){"image"===a.type?k++:-1!==a.type.indexOf("chart")&&t++});k&&(e.set(this._imageCount,"innerHTML",k),h.query(".summary .image",d).removeClass("hidden"));t&&(e.set(this._chartCount,"innerHTML",t),h.query(".summary .chart",d).removeClass("hidden"))}else h.query(".summary",
d).addClass("hidden"),c.add(f,"hidden"),c.add(g,"hidden");a=this._mediaPtr;0===a?c.add(f,"hidden"):c.remove(f,"hidden");a===b-1?c.add(g,"hidden"):c.remove(g,"hidden");this._destroyFrame()},_displayMedia:function(){var a=this._mediaInfos[this._mediaPtr],b=a.title,d=a.caption,f=h.query(".mediaSection .hzLine",this.domNode)[0];e.set(this._mediaTitle,"innerHTML",b);c[b?"remove":"add"](this._mediaTitle,"hidden");e.set(this._mediaCaption,"innerHTML",d);c[d?"remove":"add"](this._mediaCaption,"hidden");c[b&&
d?"remove":"add"](f,"hidden");this._rid=null;if("image"===a.type)this._showImage(a.value);else{var g=this,b=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],d=a.value.theme||this.chartTheme;m.isString(d)&&(d=d.replace(/\./gi,"/"),-1===d.indexOf("/")&&(d="dojox/charting/themes/"+d));d||(d="./Rainbow");b.push(d);try{var k=this._rid=A++;p(b,function(b,c,d){k===g._rid&&(g._rid=null,g._showChart(a.type,a.value,b,c,d))})}catch(I){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=
a&&m.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(d){c.add(this._mediaFrame,"image");var e=u.get(this._gallery,"height"),f;d.linkURL&&(f=a.create("a",{href:d.linkURL,target:this._preventNewTab(d.linkURL)?"":"_blank"},this._mediaFrame));a.create("img",{className:"esriPopupMediaImage",src:d.sourceURL},f||this._mediaFrame);var g=h.query(".esriPopupMediaImage",this._mediaFrame)[0],k=this,t;t=b.connect(g,"onload",function(){b.disconnect(t);t=null;k._imageLoaded(g,
e)})},_showChart:function(b,d,e,f,g){c.remove(this._mediaFrame,"image");e=this._chart=new e(a.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});g&&e.setTheme(g);switch(b){case "piechart":e.addPlot("default",{type:"Pie",labels:!1});e.addSeries("Series A",d.fields);break;case "linechart":e.addPlot("default",{type:"Markers"});e.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});e.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});l.forEach(d.fields,
function(a,b){a.x=b+1});e.addSeries("Series A",d.fields);break;case "columnchart":e.addPlot("default",{type:"Columns",gap:3});e.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});e.addSeries("Series A",d.fields);break;case "barchart":e.addPlot("default",{type:"Bars",gap:3}),e.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),e.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),e.addSeries("Series A",d.fields)}this._action=new f(e);e.render()},
_destroyFrame:function(){this._rid=null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);e.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var c=a.height;c<b&&u.set(a,"marginTop",Math.round((b-c)/2)+"px")},_attListHandler:function(a,b){if(a===this._dfd){this._dfd=null;var c="";b instanceof Error||!b||!b.length||l.forEach(b,function(a){c+="\x3cli\x3e";c+="\x3ca href\x3d'"+w.addProxy(a.url)+"' target\x3d'_blank'\x3e"+(a.name||
"[No name]")+"\x3c/a\x3e";c+="\x3c/li\x3e"});e.set(this._attachmentsList,"innerHTML",c||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(a){if(a){var b=this.showTitle?a.title:"",d=a.description,f=a.fields,k=a.mediaInfos,t=this.domNode,q=this._nls,u=this,n=this.template,w=this.graphic;this._prevMedia.title=q.NLS_prevMedia;this._nextMedia.title=q.NLS_nextMedia;e.set(this._title,"innerHTML",b);b||c.add(this._title,"hidden");!a.hasDescription&&f&&(d="",l.forEach(f,
function(a){d+="\x3ctr valign\x3d'top'\x3e";d+="\x3ctd class\x3d'attrName'\x3e"+v.encode(a[0])+"\x3c/td\x3e";d+="\x3ctd class\x3d'attrValue'\x3e"+a[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+q.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";d+="\x3c/tr\x3e"}),d&&(d="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+d+"\x3c/table\x3e"));e.set(this._description,"innerHTML",d);d||c.add(this._description,"hidden");h.query("a",
this._description).forEach(function(a){u._preventNewTab(a.href)?"_blank"===a.target&&e.remove(a,"target"):e.set(a,"target","_blank")});b&&d?h.query(".mainSection .hzLine",t).removeClass("hidden"):b||d?h.query(".mainSection .hzLine",t).addClass("hidden"):h.query(".mainSection",t).addClass("hidden");if(b=this._dfd=n.getAttachments(w))b.addBoth(m.hitch(this,this._attListHandler,b)),e.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+q.NLS_searching+"...\x3c/li\x3e"),h.query(".attachmentsSection",t).removeClass("hidden");
k&&k.length&&(h.query(".mediaSection",t).removeClass("hidden"),g.setSelectable(this._mediaFrame,!1),this._mediaInfos=k,this._mediaPtr=0,this._updateUI(),this._displayMedia());a.editSummary&&(e.set(this._editSummary,"innerHTML",a.editSummary),k&&k.length&&c.remove(this._mediaBreak,"hidden"),c.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(a){console.log("PopupRenderer: error loading template",a)}})})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(p){var f=
p.getObject("dojox.html.entities",!0),b=function(b,f){var h,l;if(f._encCache&&f._encCache.regexp&&f._encCache.mapper&&f.length==f._encCache.length)h=f._encCache.mapper,l=f._encCache.regexp;else{h={};l=["["];var g;for(g=0;g<f.length;g++)h[f[g][0]]="\x26"+f[g][1]+";",l.push(f[g][0]);l.push("]");l=new RegExp(l.join(""),"g");f._encCache={mapper:h,regexp:l,length:f.length}}return b=b.replace(l,function(b){return h[b]})},m=function(b,f){var h,l;if(f._decCache&&f._decCache.regexp&&f._decCache.mapper&&f.length==
f._decCache.length)h=f._decCache.mapper,l=f._decCache.regexp;else{h={};l=["("];var g;for(g=0;g<f.length;g++){var e="\x26"+f[g][1]+";";g&&l.push("|");h[e]=f[g][0];l.push(e)}l.push(")");l=new RegExp(l.join(""),"g");f._decCache={mapper:h,regexp:l,length:f.length}}return b=b.replace(l,function(b){return h[b]})};f.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];f.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5",
"yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],
["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],
["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5",
"otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0",
"Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4",
"tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1",
"uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248",
"asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],
["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];f.encode=function(l,h){l&&(h?l=b(l,h):(l=b(l,f.html),
l=b(l,f.latin)));return l};f.decode=function(b,h){b&&(h?b=m(b,h):(b=m(b,f.html),b=m(b,f.latin)));return b};return f})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u){function v(){}function q(a){return function(c,e,f,g){return c&&"string"==typeof e&&c[e]==
v?c.on(e.substring(2).toLowerCase(),r.hitch(f,g)):a.apply(b,arguments)}}p.around(b,"connect",q);h.connect&&p.around(h,"connect",q);p=m("dijit._Widget",[c,a,u],{onClick:v,onDblClick:v,onKeyDown:v,onKeyPress:v,onKeyUp:v,onMouseDown:v,onMouseMove:v,onMouseOut:v,onMouseOver:v,onMouseLeave:v,onMouseEnter:v,onMouseUp:v,constructor:function(a){this._toConnect={};for(var b in a)this[b]===v&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);
for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(a,c){return this[this._onMap(a)]===v?b.connect(this.domNode,a.toLowerCase(),this,c):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,b){h.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(a,b)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,
arguments):this.get(a)},getDescendants:function(){h.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?n("[widgetId]",this.containerNode).map(e.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});l("dijit-legacy-requires")&&g(0,function(){require(["dijit/_base"])});return p})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z){function C(a){return function(b){n[b?"set":"remove"](this.domNode,a,b);this._set(a,b)}}u.add("dijit-legacy-requires",!v.isAsync);u.add("dojo-bidi",!1);u("dijit-legacy-requires")&&d(0,function(){p(["dijit/_base/manager"])});var B={};m=h("dijit._WidgetBase",[w,A],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:C("lang"),dir:"",_setDirAttr:C("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:m.blankGif||p.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,c=a._setterAttrs=[],a=a._onMap={},d;for(d in b.attributeMap)c.push(d);for(d in b)/^on/.test(d)&&(a[d.substring(2).toLowerCase()]=d),/^_set[A-Z](.*)Attr$/.test(d)&&(d=d.charAt(4).toLowerCase()+
d.substr(5,d.length-9),b.attributeMap&&d in b.attributeMap||c.push(d))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();this.srcNodeRef=r.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,q.mixin(this,a));this.postMixInProperties();this.id||(this.id=z.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=
this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=x.body(this.ownerDocument);z.add(this);this.buildRendering();var c;if(this.domNode){this._applyAttributes();var d=this.srcNodeRef;d&&d.parentNode&&this.domNode!==d&&(d.parentNode.replaceChild(this.domNode,d),c=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},b;for(b in this.params||{})a[b]=this._get(b);
f.forEach(this.constructor._setterAttrs,function(b){if(!(b in a)){var c=this._get(b);c&&this.set(b,c)}},this);for(b in a)this.set(b,a[b])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(f.map(a,function(a){return a+"Rtl"})));g.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=
!0,f.forEach(this.getChildren(),function(a){a._started||a._destroyed||!q.isFunction(a.startup)||(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function b(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();f.forEach(this._connects,q.hitch(this,"disconnect"));f.forEach(this._supportingWidgets,b);this.domNode&&f.forEach(z.findWidgets(this.domNode,
this.containerNode),b);this.destroyRendering(a);z.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?n.remove(this.domNode,"widgetId"):e.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||e.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){f.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(b){var c=
this.domNode;q.isObject(b)?a.set(c,b):c.style.cssText=c.style.cssText?c.style.cssText+("; "+b):b;this._set("style",b)},_attrToDom:function(a,b,c){c=3<=arguments.length?c:this.attributeMap[a];f.forEach(q.isArray(c)?c:[c],function(c){var d=this[c.node||c||"domNode"];switch(c.type||"attribute"){case "attribute":q.isFunction(b)&&(b=q.hitch(this,b));c=c.attribute?c.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;d.tagName?n.set(d,c,b):d.set(c,b);break;case "innerText":d.innerHTML="";d.appendChild(this.ownerDocument.createTextNode(b));
break;case "innerHTML":d.innerHTML=b;break;case "class":g.replace(d,b,this[a]);break;case "toggleClass":g.toggle(d,c.className||a,b)}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var c in a)this.set(c,a[c]);return this}c=this._getAttrNames(a);var d=this[c.s];if(q.isFunction(d))var e=d.apply(this,Array.prototype.slice.call(arguments,1));else{var d=this.focusNode&&!q.isFunction(this.focusNode)?"focusNode":
"domNode",f=this[d]&&this[d].tagName,g;if((g=f)&&!(g=B[f])){g=this[d];var k={},t;for(t in g)k[t.toLowerCase()]=!0;g=B[f]=k}t=g;c=a in this.attributeMap?this.attributeMap[a]:c.s in this?this[c.s]:t&&c.l in t&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?d:null;null!=c&&this._attrToDom(a,b,c);this._set(a,b)}return e||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var c=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});
return b[a]={n:a+"Node",s:"_set"+c+"Attr",g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(a,b){var c=this[a];this[a]=b;!this._created||c===b||c!==c&&b!==b||(this._watchCallbacks&&this._watchCallbacks(a,c,b),this.emit("attrmodified-"+a,{detail:{prevValue:c,newValue:b}}))},_get:function(a){return this[a]},emit:function(a,b,c){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var d,e=this["on"+a];e&&(d=e.apply(this,c?
c:[b]));this._started&&!this._beingDestroyed&&k.emit(this.domNode,a.toLowerCase(),b);return d},on:function(a,c){var d=this._onMap(a);return d?b.after(this,d,c,!0):this.own(k(this.domNode,a,c))[0]},_onMap:function(a){var b=this.constructor,c=b._onMap;if(!c){var c=b._onMap={},d;for(d in b.prototype)/^on/.test(d)&&(c[d.replace(/^on/,"").toLowerCase()]=d)}return c["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
z.findWidgets(this.containerNode):[]},getParent:function(){return z.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,b,c){return this.own(l.connect(a,b,this,c))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(t.subscribe(a,q.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():c.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=a.get(this.domNode,"display")},
placeAt:function(a,b){var c=!a.tagName&&z.byId(a);!c||!c.addChild||b&&"number"!==typeof b?(c=c&&"domNode"in c?c.containerNode&&!/after|before|replace/.test(b||"")?c.containerNode:c.domNode:r.byId(a,this.ownerDocument),e.place(this.domNode,c,b),!this._started&&(this.getParent()||{})._started&&this.startup()):c.addChild(this,b);return this},defer:function(a,b){var c=setTimeout(q.hitch(this,function(){c&&(c=null,this._destroyed||q.hitch(this,a)())}),b||0);return{remove:function(){c&&(clearTimeout(c),
c=null);return null}}}});u("dojo-bidi")&&m.extend(y);return m})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(p,f,b){return b("dijit.Destroyable",null,{destroy:function(b){this._destroyed=!0},own:function(){var b=["destroyRecursive","destroy","remove"];p.forEach(arguments,function(l){function h(){n.remove();p.forEach(g,function(b){b.remove()})}var m,n=f.before(this,"destroy",function(b){l[m](b)}),g=[];l.then?(m="cancel",l.then(h,h)):p.forEach(b,
function(b){"function"===typeof l[b]&&(m||(m=b),g.push(f.after(l,b,h,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(p,f,b,m,l,h){p=m("dijit._OnDijitClickMixin",null,{connect:function(b,f,g){return this.inherited(arguments,[b,"ondijitclick"==f?h:f,g])}});p.a11yclick=h;return p})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],
function(p,f,b,m){m.extend(f,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return b("dijit._FocusMixin",null,{_focusManager:p})})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(p,f,b,m){b(function(){f("highcontrast")&&p.add(m.body(),"dijit_a11y")});return f})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(p,f,b,m,l,h,r){l.add("highcontrast",function(){var b=r.doc.createElement("div");try{b.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(f.blankGif||p.toUrl("./resources/blank.gif"))+'");';r.body().appendChild(b);var g=m.getComputedStyle(b),e=g.backgroundImage;return g.borderTopColor==g.borderRightColor||e&&("none"==e||"url(invalid-url:)"==e)}catch(c){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
c.toString()),!1}finally{8>=l("ie")?b.outerHTML="":r.body().removeChild(b)}});h(function(){l("highcontrast")&&b.add(r.body(),"dj_a11y")});return l})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(p,f,b,m,l,h,r){h.extend(p,{waiRole:"",waiState:""});return l("dijit._Templated",[f,b],{constructor:function(){r.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(b,f){var e=this.inherited(arguments),c=f(b,"waiRole");c&&b.setAttribute("role",c);(c=f(b,"waiState"))&&m.forEach(c.split(/\s*,\s*/),function(a){-1!=a.indexOf("-")&&(a=a.split("-"),b.setAttribute("aria-"+a[0],a[1]))});return e}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(p,f,b,m,l,h,r,n){var g=f("dijit._TemplatedMixin",n,{templateString:null,
templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(b){var c=this.declaredClass,a=this;return r.substitute(b,this,function(b,e){"!"==e.charAt(0)&&(b=m.getObject(e.substr(1),!1,a));if("undefined"==typeof b)throw Error(c+" template:"+e);return null==b?"":"!"==e.charAt(0)?b:this._escapeValue(""+b)},this)},_escapeValue:function(b){return b.replace(/["'<>&]/g,function(b){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[b]})},buildRendering:function(){if(!this._rendered){this.templateString||
(this.templateString=p(this.templatePath,{sanitize:!0}));var e=g.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),c;if(m.isString(e)){if(c=b.toDom(this._stringRepl(e),this.ownerDocument),1!=c.nodeType)throw Error("Invalid template: "+e);}else c=e.cloneNode(!0);this.domNode=c}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(b){var c=this.containerNode;if(b&&c)for(;b.hasChildNodes();)c.appendChild(b.firstChild)}});
g._templateCache={};g.getCachedTemplate=function(e,c,a){var f=g._templateCache,h=e,q=f[h];if(q){try{if(!q.ownerDocument||q.ownerDocument==(a||document))return q}catch(k){}b.destroy(q)}e=r.trim(e);if(c||e.match(/\$\{([^\}]+)\}/g))return f[h]=e;c=b.toDom(e,a);if(1!=c.nodeType)throw Error("Invalid template: "+e);return f[h]=c};h("ie")&&l(window,"unload",function(){var e=g._templateCache,c;for(c in e){var a=e[c];"object"==typeof a&&b.destroy(a);delete e[c]}});return g})},"dojo/cache":function(){define(["./_base/kernel",
"./text"],function(p){return p.cache})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(p,f,b,m){var l;l=function(b,c,a){m(b,{sync:!!c,headers:{"X-Requested-With":null}}).then(a)};var h={},r=function(b){if(b){b=b.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var c=b.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);c&&(b=c[1])}else b="";return b},n={},g={};p.cache=function(b,c,a){var e;"string"==typeof b?/\//.test(b)?(e=b,a=c):e=f.toUrl(b.replace(/\./g,
"/")+(c?"/"+c:"")):(e=b+"",a=c);b=void 0!=a&&"string"!=typeof a?a.value:a;a=a&&a.sanitize;if("string"==typeof b)return h[e]=b,a?r(b):b;if(null===b)return delete h[e],null;e in h||l(e,!0,function(a){h[e]=a});return a?r(h[e]):h[e]};return{dynamic:!0,normalize:function(b,c){var a=b.split("!"),e=a[0];return(/^\./.test(e)?c(e):e)+(a[1]?"!"+a[1]:"")},load:function(b,c,a){b=b.split("!");var e=1<b.length,f=b[0],q=c.toUrl(b[0]);b="url:"+q;var k=n,d=function(b){a(e?r(b):b)};f in h?k=h[f]:c.cache&&b in c.cache?
k=c.cache[b]:q in h&&(k=h[q]);if(k===n)if(g[q])g[q].push(d);else{var m=g[q]=[d];l(q,!c.async,function(a){h[f]=h[q]=a;for(var b=0;b<m.length;)m[b++](a);delete g[q]})}else d(k)}}})},"dojo/request":function(){define(["./request/default!"],function(p){return p})},"dojo/request/default":function(){define(["exports","require","../has"],function(p,f,b){var m=b("config-requestProvider");m||(m="./xhr");p.getPlatformDefaultId=function(){return"./xhr"};p.load=function(b,h,r,n){f(["platform"==b?"./xhr":m],function(b){r(b)})}})},
"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(p,f,b,m,l,h,r,n,g){var e=l.delegate(n,{mouseenter:h.enter,mouseleave:h.leave,keypress:b._keypress}),c;b=m("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},
_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=b.nextSibling}},_processTemplateNode:function(a,b,c){var e=!0,f=this.attachScope||this,d=b(a,"dojoAttachPoint")||b(a,"data-dojo-attach-point");if(d)for(var g=d.split(/\s*,\s*/);d=g.shift();)l.isArray(f[d])?
f[d].push(a):f[d]=a,e="containerNode"!=d,this._attachPoints.push(d);if(b=b(a,"dojoAttachEvent")||b(a,"data-dojo-attach-event"))for(d=b.split(/\s*,\s*/),g=l.trim;b=d.shift();)if(b){var t=null;-1!=b.indexOf(":")?(t=b.split(":"),b=g(t[0]),t=g(t[1])):b=g(b);t||(t=b);this._attachEvents.push(c(a,b,l.hitch(f,t)))}return e},_attach:function(a,b,f){b=b.replace(/^on/,"").toLowerCase();b="dijitclick"==b?c||(c=p("./a11yclick")):e[b]||b;return r(a,b,f)},_detachTemplateNodes:function(){var a=this.attachScope||
this;f.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];f.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});l.extend(g,{dojoAttachEvent:"",dojoAttachPoint:""});return b})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(p,f,b,m,l){return b("dijit._WidgetsInTemplateMixin",
null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var b=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);l.parse(b,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(m.hitch(this,function(b){this._startupWidgets=b;for(var f=0;f<b.length;f++)this._processTemplateNode(b[f],
function(b,e){return b[e]},function(b,e,c){return e in b?b.connect(b,e,c):b.on(e,c,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(b,f,l){return f(b,"dojoType")||f(b,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){p.forEach(this._startupWidgets,function(b){b&&!b._started&&b.startup&&b.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k){function d(a){return eval("("+a+")")}function w(a){var b=
a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<x){var b=a._nameCaseMap={},d;for(d in c)"_"!==d.charAt(0)&&(b[d.toLowerCase()]=d);b._extendCnt=x}return b}function t(a,c){c||(c=p);var d=c._dojoParserCtorMap||(c._dojoParserCtorMap={}),e=a.join();if(!d[e]){for(var f=[],g=0,k=a.length;g<k;g++){var t=a[g];f[f.length]=d[t]=d[t]||b.getObject(t)||~t.indexOf("/")&&c(t)}g=f.shift();d[e]=f.length?g.createSubclass?g.createSubclass(f):g.extend.apply(g,f):g}return d[e]}new Date("X");var x=0;g.after(b,"extend",
function(){x++},!0);var A={_clearCache:function(){x++;_ctorMap={}},_functionFromScript:function(a,b){var c="",d="",e=a.getAttribute(b+"args")||a.getAttribute("args"),f=a.getAttribute("with"),e=(e||"").split(/\s*,\s*/);f&&f.length&&m.forEach(f.split(/\s*,\s*/),function(a){c+="with("+a+"){";d+="}"});return new Function(e,c+a.innerHTML+d)},instantiate:function(a,b,c){b=b||{};c=c||{};var d=(c.scope||f._scopeName)+"Type",e="data-"+(c.scope||f._scopeName)+"-",g=e+"type",k=e+"mixins",t=[];m.forEach(a,function(a){var c=
d in b?b[d]:a.getAttribute(g)||a.getAttribute(d);if(c){var e=a.getAttribute(k),c=e?[c].concat(e.split(/\s*,\s*/)):[c];t.push({node:a,types:c})}});return this._instantiate(t,b,c)},_instantiate:function(a,b,c,d){function f(a){b._started||c.noStart||m.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=m.map(a,function(a){var d=a.ctor||t(a.types,c.contextRequire);if(!d)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(d,
a.node,b,c,a.scripts,a.inherited)},this);return d?e(a).then(f):f(a)},construct:function(a,e,k,t,h,l){function x(a){G&&b.setObject(G,a);for(C=0;C<W.length;C++)g[W[C].advice||"after"](a,W[C].method,b.hitch(a,W[C].func),!0);for(C=0;C<ga.length;C++)ga[C].call(a);for(C=0;C<D.length;C++)a.watch(D[C].prop,D[C].func);for(C=0;C<ja.length;C++)q(a,ja[C].event,ja[C].func);return a}var r=a&&a.prototype;t=t||{};var A={};t.defaults&&b.mixin(A,t.defaults);l&&b.mixin(A,l);var y;u("dom-attributes-explicit")?y=e.attributes:
u("dom-attributes-specified-flag")?y=m.filter(e.attributes,function(a){return a.specified}):(l=(/^input$|^img$/i.test(e.nodeName)?e:e.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),y=m.map(l.split(/\s+/),function(a){var b=a.toLowerCase();return{name:a,value:"LI"==e.nodeName&&"value"==a||"enctype"==b?e.getAttribute(b):e.getAttributeNode(b).value}}));var p=t.scope||f._scopeName;l="data-"+p+"-";var z={};"dojo"!==p&&(z[l+"props"]=
"data-dojo-props",z[l+"type"]="data-dojo-type",z[l+"mixins"]="data-dojo-mixins",z[p+"type"]="dojotype",z[l+"id"]="data-dojo-id");for(var C=0,B,p=[],G,E;B=y[C++];){var N=B.name,M=N.toLowerCase();B=B.value;switch(z[M]||M){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":E=B;break;case "data-dojo-id":case "jsid":G=B;break;case "data-dojo-attach-point":case "dojoattachpoint":A.dojoAttachPoint=B;break;case "data-dojo-attach-event":case "dojoattachevent":A.dojoAttachEvent=
B;break;case "class":A["class"]=e.className;break;case "style":A.style=e.style&&e.style.cssText;break;default:if(N in r||(N=w(a)[M]||N),N in r)switch(typeof r[N]){case "string":A[N]=B;break;case "number":A[N]=B.length?Number(B):NaN;break;case "boolean":A[N]="false"!=B.toLowerCase();break;case "function":""===B||-1!=B.search(/[^\w\.]+/i)?A[N]=new Function(B):A[N]=b.getObject(B,!1)||new Function(B);p.push(N);break;default:M=r[N],A[N]=M&&"length"in M?B?B.split(/\s*,\s*/):[]:M instanceof Date?""==B?new Date(""):
"now"==B?new Date:c.fromISOString(B):M instanceof n?f.baseUrl+B:d(B)}else A[N]=B}}for(y=0;y<p.length;y++)z=p[y].toLowerCase(),e.removeAttribute(z),e[z]=null;if(E)try{E=d.call(t.propsThis,"{"+E+"}"),b.mixin(A,E)}catch(na){throw Error(na.toString()+" in data-dojo-props\x3d'"+E+"'");}b.mixin(A,k);h||(h=a&&(a._noScript||r._noScript)?[]:v("\x3e script[type^\x3d'dojo/']",e));var W=[],ga=[],D=[],ja=[];if(h)for(C=0;C<h.length;C++)z=h[C],e.removeChild(z),k=z.getAttribute(l+"event")||z.getAttribute("event"),
t=z.getAttribute(l+"prop"),E=z.getAttribute(l+"method"),p=z.getAttribute(l+"advice"),y=z.getAttribute("type"),z=this._functionFromScript(z,l),k?"dojo/connect"==y?W.push({method:k,func:z}):"dojo/on"==y?ja.push({event:k,func:z}):A[k]=z:"dojo/aspect"==y?W.push({method:E,advice:p,func:z}):"dojo/watch"==y?D.push({prop:t,func:z}):ga.push(z);a=(h=a.markupFactory||r.markupFactory)?h(A,e,a):new a(A,e);return a.then?a.then(x):x(a)},scan:function(b,c){function d(a){if(!a.inherited){a.inherited={};var b=a.node,
c=d(a.parent),b={dir:b.getAttribute("dir")||c.dir,lang:b.getAttribute("lang")||c.lang,textDir:b.getAttribute(u)||c.textDir},e;for(e in b)b[e]&&(a.inherited[e]=b[e])}return a.inherited}var e=[],g=[],k={},h=(c.scope||f._scopeName)+"Type",q="data-"+(c.scope||f._scopeName)+"-",l=q+"type",u=q+"textdir",q=q+"mixins",n=b.firstChild,v=c.inherited;if(!v){var w=function(a,b){return a.getAttribute&&a.getAttribute(b)||a.parentNode&&w(a.parentNode,b)},v={dir:w(b,"dir"),lang:w(b,"lang"),textDir:w(b,u)},x;for(x in v)v[x]||
delete v[x]}for(var v={inherited:v},r,A;;)if(n)if(1!=n.nodeType)n=n.nextSibling;else if(r&&"script"==n.nodeName.toLowerCase())(y=n.getAttribute("type"))&&/^dojo\/\w/i.test(y)&&r.push(n),n=n.nextSibling;else if(A)n=n.nextSibling;else{var y=n.getAttribute(l)||n.getAttribute(h);x=n.firstChild;if(y||x&&(3!=x.nodeType||x.nextSibling)){A=null;if(y){var z=n.getAttribute(q);r=z?[y].concat(z.split(/\s*,\s*/)):[y];try{A=t(r,c.contextRequire)}catch(ga){}A||m.forEach(r,function(a){~a.indexOf("/")&&!k[a]&&(k[a]=
!0,g[g.length]=a)});z=A&&!A.prototype._noScript?[]:null;v={types:r,ctor:A,parent:v,node:n,scripts:z};v.inherited=d(v);e.push(v)}else v={node:n,scripts:r,parent:v};r=z;A=n.stopParser||A&&A.prototype.stopParser&&!c.template;n=x}else n=n.nextSibling}else{if(!v||!v.node)break;n=v.node.nextSibling;A=!1;v=v.parent;r=v.scripts}var W=new a;g.length?(c.contextRequire||p)(g,function(){W.resolve(m.filter(e,function(a){if(!a.ctor)try{a.ctor=t(a.types,c.contextRequire)}catch(na){}for(var b=a.parent;b&&!b.types;)b=
b.parent;var d=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(d&&d.stopParser&&!c.template);a.instantiate=!b||b.instantiate&&b.instantiateChildren;return a.instantiate}))}):W.resolve(e);return W.promise},_require:function(c,e){var f=d("{"+c.innerHTML+"}"),g=[],k=[],t=new a,h=e&&e.contextRequire||p,q;for(q in f)g.push(q),k.push(f[q]);h(k,function(){for(var a=0;a<g.length;a++)b.setObject(g[a],arguments[a]);t.resolve(arguments)});return t.promise},_scanAmd:function(b,c){var d=new a,e=d.promise;d.resolve(!0);
var f=this;v("script[type\x3d'dojo/require']",b).forEach(function(a){e=e.then(function(){return f._require(a,c)});a.parentNode.removeChild(a)});return e},parse:function(a,c){!a||"string"==typeof a||"nodeType"in a||(c=a,a=c.rootNode);var d=a?h.byId(a):r.body();c=c||{};var e=c.template?{template:!0}:{},f=[],g=this,k=this._scanAmd(d,c).then(function(){return g.scan(d,c)}).then(function(a){return g._instantiate(a,e,c,!0)}).then(function(a){return f=f.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",
a);throw a;});b.mixin(f,k);return f}};f.parser=A;l.parseOnLoad&&k(100,A,"parse");return A})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(p,f){var b={};p.setObject("dojo.date.stamp",b);b.fromISOString=function(m,l){b._isoRegExp||(b._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var h=b._isoRegExp.exec(m),r=null;if(h){h.shift();h[1]&&h[1]--;h[6]&&(h[6]*=1E3);l&&(l=new Date(l),f.forEach(f.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),
function(b){return l["get"+b]()}),function(b,c){h[c]=h[c]||b}));r=new Date(h[0]||1970,h[1]||0,h[2]||1,h[3]||0,h[4]||0,h[5]||0,h[6]||0);100>h[0]&&r.setFullYear(h[0]||1970);var n=0,g=h[7]&&h[7].charAt(0);"Z"!=g&&(n=60*(h[8]||0)+(Number(h[9])||0),"-"!=g&&(n*=-1));g&&(n-=r.getTimezoneOffset());n&&r.setTime(r.getTime()+6E4*n)}return r};b.toISOString=function(b,f){var h=function(b){return 10>b?"0"+b:b};f=f||{};var l=[],n=f.zulu?"getUTC":"get",g="";"time"!=f.selector&&(g=b[n+"FullYear"](),g=["0000".substr((g+
"").length)+g,h(b[n+"Month"]()+1),h(b[n+"Date"]())].join("-"));l.push(g);if("date"!=f.selector){g=[h(b[n+"Hours"]()),h(b[n+"Minutes"]()),h(b[n+"Seconds"]())].join(":");n=b[n+"Milliseconds"]();f.milliseconds&&(g+="."+(100>n?"0":"")+h(n));if(f.zulu)g+="Z";else if("time"!=f.selector)var n=b.getTimezoneOffset(),e=Math.abs(n),g=g+((0<n?"-":"+")+h(Math.floor(e/60))+":"+h(e%60));l.push(g)}return l.join("T")};return b})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),
function(p,f,b,m,l,h){return p([h,l],{_onMap:function(b){var f=this.constructor._onMap,g;f&&f.FINAL||(delete this.constructor._onMap,f=this.registerConnectEvents(),f.FINAL=!0);b=b.toLowerCase();f[b]?g=this[f[b].method]:(b=this._onCamelCase(b),this[b]&&(g=b));return g},on:function(b,f){var g=this._onMap(b),e=b.replace(/\-/g,""),c="on"+e in this.domNode;return g||!c?this.inherited(arguments):this.own(m(this.domNode,e,f))[0]},emit:function(b,h,g){var e,c,a,l=b.toLowerCase(),n=this.constructor._onMap||
this.registerConnectEvents();c=this[this._onMap(l)];h=h||{};h.target||(h.target=this);c&&n&&n[l]&&(this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},n[l].argKeys)(h),a=f.mixin({},arguments),a[2]=e,a[0]=n[l].name.replace(/^on/,""));return this.inherited(a||arguments)}})})},"esri/tasks/GeometryService":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){p=p(e,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],"buffer-complete":["geometries"],"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],
"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],"trim-extend-complete":["geometries"],"union-complete":["geometry"]},constructor:function(a){a=f.hitch;this._projectHandler=a(this,this._projectHandler);this._simplifyHandler=a(this,this._simplifyHandler);this._bufferHandler=a(this,this._bufferHandler);this._areasAndLengthsHandler=a(this,this._areasAndLengthsHandler);this._lengthsHandler=
a(this,this._lengthsHandler);this._labelPointsHandler=a(this,this._labelPointsHandler);this._relationHandler=a(this,this._relationHandler);this._convexHullHandler=a(this,this._convexHullHandler);this._unionHandler=a(this,this._unionHandler);this._autoCompleteHandler=a(this,this._autoCompleteHandler);this._reshapeHandler=a(this,this._reshapeHandler);this._cutHandler=a(this,this._cutHandler);this._intersectHandler=a(this,this._intersectHandler);this._differenceHandler=a(this,this._differenceHandler);
this._trimExtendHandler=a(this,this._trimExtendHandler);this._densifyHandler=a(this,this._densifyHandler);this._generalizeHandler=a(this,this._densifyHandler);this._offsetHandler=a(this,this._offsetHandler);this._distanceHandler=a(this,this._distanceHandler);this._toGeoCoordinateHandler=a(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=a(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(a){var b=[],c,e=a.length;for(c=0;c<e;c++)b.push(a[c].toJson());
return{geometryType:q.getJsonType(a[0]),geometries:b}},_decodeGeometries:function(a,c,e){var d=q.getGeometryType(c);a=a.geometries;var g=[],k={spatialReference:e.toJson()},h=f.mixin;b.forEach(a,function(a,b){g[b]=new d(h(a,k))});return g},_toProjectGeometry:function(b){var d=b.spatialReference.toJson();return b instanceof c?new u({rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]],spatialReference:d}):new a({paths:[[].concat(b.points)],spatialReference:d})},
_fromProjectedGeometry:function(a,b,e){return"esriGeometryEnvelope"===b?(a=a.rings[0],new c(a[0][0],a[0][1],a[2][0],a[2][1],e)):new v({points:a.paths[0],spatialReference:e.toJson()})},project:function(a,b,c,e){var d=f.mixin({},this._url.query,{f:"json"}),k;a.geometries?(e=c,c=b,b=a.outSR,k=a.geometries[0],d=f.mixin(d,a.toJson())):(k=a[0],d=f.mixin(d,{outSR:b.wkid||m.toJson(b.toJson()),inSR:k.spatialReference.wkid||m.toJson(k.spatialReference.toJson()),geometries:m.toJson(this._encodeGeometries(a))}));
var t=q.getJsonType(k),h=this._projectHandler,u=this._errorHandler,v=new l(g._dfdCanceller);v._pendingDfd=n({url:this._url.path+"/project",content:d,callbackParamName:"callback",load:function(a,d){h(a,d,t,b,c,e,v)},error:function(a){u(a,e,v)}});return v},_projectHandler:function(a,b,c,e,f,g,h){try{var d=this._decodeGeometries(a,c,e);this._successHandler([d],"onProjectComplete",f,h)}catch(C){this._errorHandler(C,g,h)}},onProjectComplete:function(){},simplify:function(a,b,c){var d=a[0].spatialReference,
e=f.mixin({},this._url.query,{f:"json",sr:d.wkid?d.wkid:m.toJson(d.toJson()),geometries:m.toJson(this._encodeGeometries(a))}),k=q.getJsonType(a[0]),h=this._simplifyHandler,u=this._errorHandler,v=new l(g._dfdCanceller);v._pendingDfd=n({url:this._url.path+"/simplify",content:e,callbackParamName:"callback",load:function(a,e){h(a,e,k,d,b,c,v)},error:function(a){u(a,c,v)}});return v},_simplifyHandler:function(a,b,c,e,f,g,h){try{var d=this._decodeGeometries(a,c,e);this._successHandler([d],"onSimplifyComplete",
f,h)}catch(C){this._errorHandler(C,g,h)}},onSimplifyComplete:function(){},convexHull:function(a,b,c){var d=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:m.toJson(d.toJson()),geometries:m.toJson(this._encodeGeometries(a))});var e=this._convexHullHandler,k=this._errorHandler,h=new l(g._dfdCanceller);h._pendingDfd=n({url:this._url.path+"/convexHull",content:a,callbackParamName:"callback",load:function(a,f){e(a,f,d,b,c,h)},error:function(a){k(a,c,h)}});return h},_convexHullHandler:function(a,
b,c,e,f,g){try{var d=q.fromJson(a.geometry).setSpatialReference(c);this._successHandler([d],"onConvexHullComplete",e,g)}catch(z){this._errorHandler(z,f,g)}},onConvexHullComplete:function(){},union:function(a,b,c){var d=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:m.toJson(d.toJson()),geometries:m.toJson(this._encodeGeometries(a))});var e=this._unionHandler,k=this._errorHandler,h=new l(g._dfdCanceller);h._pendingDfd=n({url:this._url.path+"/union",content:a,callbackParamName:"callback",
load:function(a,f){e(a,f,d,b,c,h)},error:function(a){k(a,c,h)}});return h},_unionHandler:function(a,b,c,e,f,g){try{var d=q.fromJson(a.geometry).setSpatialReference(c);this._successHandler([d],"onUnionComplete",e,g)}catch(z){this._errorHandler(z,f,g)}},onUnionComplete:function(){},autoComplete:function(a,b,c,e){var d=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:m.toJson(d.toJson()),polygons:m.toJson(this._encodeGeometries(a).geometries),polylines:m.toJson(this._encodeGeometries(b).geometries)});
var k=this._autoCompleteHandler,t=this._errorHandler,h=new l(g._dfdCanceller);h._pendingDfd=n({url:this._url.path+"/autoComplete",content:a,callbackParamName:"callback",load:function(a,b){k(a,b,d,c,e,h)},error:function(a){t(a,e,h)}});return h},_autoCompleteHandler:function(a,b,c,e,f,g){try{var d=a.geometries;a=[];var k,t=d.length;for(k=0;k<t;k++)a[k]=new u({spatialReference:c,rings:d[k].rings});this._successHandler([a],"onAutoCompleteComplete",e,g)}catch(B){this._errorHandler(B,f,g)}},onAutoCompleteComplete:function(){},
reshape:function(a,b,c,e){var d=a.spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:m.toJson(d.toJson()),target:m.toJson({geometryType:q.getJsonType(a),geometry:a.toJson()}),reshaper:m.toJson(b.toJson())});var k=this._reshapeHandler,t=this._errorHandler,h=new l(g._dfdCanceller);h._pendingDfd=n({url:this._url.path+"/reshape",content:a,callbackParamName:"callback",load:function(a,b){k(a,b,d,c,e,h)},error:function(a){t(a,e,h)}});return h},_reshapeHandler:function(a,b,c,e,f,g){try{var d=q.fromJson(a.geometry).setSpatialReference(c);
this._successHandler([d],"onReshapeComplete",e,g)}catch(z){this._errorHandler(z,f,g)}},onReshapeComplete:function(){},cut:function(a,c,e,t){var d=a[0].spatialReference,k=b.map(a,function(a){return a.toJson()});a=f.mixin({},this._url.query,{f:"json",sr:m.toJson(d.toJson()),target:m.toJson({geometryType:q.getJsonType(a[0]),geometries:k}),cutter:m.toJson(c.toJson())});var h=this._cutHandler,u=this._errorHandler,v=new l(g._dfdCanceller);v._pendingDfd=n({url:this._url.path+"/cut",content:a,callbackParamName:"callback",
load:function(a,b){h(a,b,d,e,t,v)},error:function(a){u(a,t,v)}});return v},_cutHandler:function(a,c,e,f,g,h){try{var d=a.geometries,k={};k.cutIndexes=a.cutIndexes;k.geometries=[];b.forEach(d,function(a){k.geometries.push(q.fromJson(a).setSpatialReference(e))});this._successHandler([k],"onCutComplete",f,h)}catch(C){this._errorHandler(C,g,h)}},onCutComplete:function(){},intersect:function(a,b,c,e){var d=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:m.toJson(d.toJson()),geometries:m.toJson(this._encodeGeometries(a)),
geometry:m.toJson({geometryType:q.getJsonType(b),geometry:b.toJson()})});var k=this._intersectHandler,t=this._errorHandler,h=new l(g._dfdCanceller);h._pendingDfd=n({url:this._url.path+"/intersect",content:a,callbackParamName:"callback",load:function(a,b){k(a,b,d,c,e,h)},error:function(a){t(a,e,h)}});return h},_intersectHandler:function(a,c,e,f,g,h){try{var d=[];b.forEach(a.geometries,function(a){d.push(q.fromJson(a).setSpatialReference(e))});this._successHandler([d],"onIntersectComplete",f,h)}catch(z){this._errorHandler(z,
g,h)}},onIntersectComplete:function(){},difference:function(a,b,c,e){var d=a[0].spatialReference;a=f.mixin({},this._url.query,{f:"json",sr:m.toJson(d.toJson()),geometries:m.toJson(this._encodeGeometries(a)),geometry:m.toJson({geometryType:q.getJsonType(b),geometry:b.toJson()})});var k=this._differenceHandler,t=this._errorHandler,h=new l(g._dfdCanceller);h._pendingDfd=n({url:this._url.path+"/difference",content:a,callbackParamName:"callback",load:function(a,b){k(a,b,d,c,e,h)},error:function(a){t(a,
e,h)}});return h},_differenceHandler:function(a,c,e,f,g,h){try{var d=[];b.forEach(a.geometries,function(a){d.push(q.fromJson(a).setSpatialReference(e))});this._successHandler([d],"onDifferenceComplete",f,h)}catch(z){this._errorHandler(z,g,h)}},onDifferenceComplete:function(){},buffer:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.outSpatialReference||a.geometries[0].spatialReference,k=this._bufferHandler,h=this._errorHandler,q=new l(g._dfdCanceller);q._pendingDfd=n({url:this._url.path+
"/buffer",content:d,callbackParamName:"callback",load:function(a,d){k(a,d,e,b,c,q)},error:function(a){h(a,c,q)}});return q},_bufferHandler:function(a,b,c,e,f,g){try{var d=a.geometries;a=[];var k,t=d.length;for(k=0;k<t;k++)a[k]=new u({spatialReference:c,rings:d[k].rings});this._successHandler([a],"onBufferComplete",e,g)}catch(B){this._errorHandler(B,f,g)}},onBufferComplete:function(){},areasAndLengths:function(a,b,c){a=f.mixin({},this._url.query,{f:"json"},a.toJson());var d=this._areasAndLengthsHandler,
e=this._errorHandler,k=new l(g._dfdCanceller);k._pendingDfd=n({url:this._url.path+"/areasAndLengths",content:a,callbackParamName:"callback",load:function(a,e){d(a,e,b,c,k)},error:function(a){e(a,c,k)}});return k},_areasAndLengthsHandler:function(a,b,c,e,f){try{this._successHandler([a],"onAreasAndLengthsComplete",c,f)}catch(A){this._errorHandler(A,e,f)}},onAreasAndLengthsComplete:function(){},lengths:function(a,b,c){a=f.mixin({},this._url.query,{f:"json"},a.toJson());var d=this._lengthsHandler,e=this._errorHandler,
k=new l(g._dfdCanceller);k._pendingDfd=n({url:this._url.path+"/lengths",content:a,callbackParamName:"callback",load:function(a,e){d(a,e,b,c,k)},error:function(a){e(a,c,k)}});return k},_lengthsHandler:function(a,b,c,e,f){try{this._successHandler([a],"onLengthsComplete",c,f)}catch(A){this._errorHandler(A,e,f)}},onLengthsComplete:function(){},labelPoints:function(a,c,e){var d=b.map(a,function(a){return a.toJson()}),k=a[0].spatialReference,d=f.mixin({},this._url.query,{f:"json",sr:k.wkid?k.wkid:m.toJson(k.toJson()),
polygons:m.toJson(d)}),h=this._labelPointsHandler,q=this._errorHandler,u=new l(g._dfdCanceller);u._pendingDfd=n({url:this._url.path+"/labelPoints",content:d,callbackParamName:"callback",load:function(b,d){h(b,d,a,k,c,e,u)},error:function(a){q(a,e,u)}});return u},_labelPointsHandler:function(a,c,e,f,g,h,l){try{var d=[];b.forEach(a.labelPoints,function(a){d.push(q.fromJson(a).setSpatialReference(f))});this._successHandler([d],"onLabelPointsComplete",g,l)}catch(C){this._errorHandler(C,h,l)}},onLabelPointsComplete:function(){},
relation:function(a,b,c){a=f.mixin({},this._url.query,{f:"json"},a.toJson());var d=this._relationHandler,e=this._errorHandler,k=new l(g._dfdCanceller);k._pendingDfd=n({url:this._url.path+"/relation",content:a,callbackParamName:"callback",load:function(a,e){d(a,e,b,c,k)},error:function(a){e(a,c,k)}});return k},_relationHandler:function(a,b,c,e,f){try{this._successHandler([a.relations],"onRelationComplete",c,f)}catch(A){this._errorHandler(A,e,f)}},onRelationComplete:function(){},trimExtend:function(a,
b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.sr,k=this._trimExtendHandler,h=this._errorHandler,q=new l(g._dfdCanceller);q._pendingDfd=n({url:this._url.path+"/trimExtend",content:d,callbackParamName:"callback",load:function(a,d){k(a,d,e,b,c,q)},error:function(a){h(a,c,q)}});return q},_trimExtendHandler:function(b,c,e,f,g,h){try{var d=b.geometries;b=[];var k,t=d.length;for(k=0;k<t;k++)b[k]=new a({spatialReference:e,paths:d[k].paths});this._successHandler([b],"onTrimExtendComplete",
f,h)}catch(B){this._errorHandler(B,g,h)}},onTrimExtendComplete:function(){},densify:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.geometries[0].spatialReference,k=this._densifyHandler,h=this._errorHandler,q=new l(g._dfdCanceller);q._pendingDfd=n({url:this._url.path+"/densify",content:d,callbackParamName:"callback",load:function(a,d){k(a,d,e,b,c,q)},error:function(a){h(a,c,q)}});return q},_densifyHandler:function(a,c,e,f,g,h){try{var d=[];b.forEach(a.geometries,function(a){d.push(q.fromJson(a).setSpatialReference(e))});
this._successHandler([d],"onDensifyComplete",f,h)}catch(z){this._errorHandler(z,g,h)}},onDensifyComplete:function(){},generalize:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.geometries[0].spatialReference,k=this._generalizeHandler,h=this._errorHandler,q=new l(g._dfdCanceller);q._pendingDfd=n({url:this._url.path+"/generalize",content:d,callbackParamName:"callback",load:function(a,d){k(a,d,e,b,c,q)},error:function(a){h(a,c,q)}});return q},_generalizeHandler:function(a,
c,e,f,g,h){try{var d=[];b.forEach(a.geometries,function(a){d.push(q.fromJson(a).setSpatialReference(e))});this._successHandler([d],"onGeneralizeComplete",f,h)}catch(z){this._errorHandler(z,g,h)}},onGeneralizeComplete:function(){},offset:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.geometries[0].spatialReference,k=this._offsetHandler,h=this._errorHandler,q=new l(g._dfdCanceller);q._pendingDfd=n({url:this._url.path+"/offset",content:d,callbackParamName:"callback",load:function(a,
d){k(a,d,e,b,c,q)},error:function(a){h(a,c,q)}});return q},_offsetHandler:function(a,c,e,f,g,h){try{var d=[];b.forEach(a.geometries,function(a){d.push(q.fromJson(a).setSpatialReference(e))});this._successHandler([d],"onOffsetComplete",f,h)}catch(z){this._errorHandler(z,g,h)}},onOffsetComplete:function(){},distance:function(a,b,c){var d=f.mixin({},this._url.query,{f:"json"},a.toJson()),e=a.geometry1.spatialReference,k=this._distanceHandler,h=this._errorHandler,q=new l(g._dfdCanceller);q._pendingDfd=
n({url:this._url.path+"/distance",content:d,callbackParamName:"callback",load:function(a,d){k(a,d,e,b,c,q)},error:function(a){h(a,c,q)}});return q},_distanceHandler:function(a,b,c,e,f,g){try{a=a&&a.distance,this._successHandler([a],"onDistanceComplete",e,g)}catch(y){this._errorHandler(y,f,g)}},onDistanceComplete:function(){},toGeoCoordinateString:function(a,b,c){var d={};f.isObject(a.sr)?d.sr=a.sr.wkid||m.toJson(a.sr.toJson()):d.sr=a.sr;d.coordinates=m.toJson(a.coordinates);d.conversionType=a.conversionType||
"MGRS";d.conversionMode=a.conversionMode;d.numOfDigits=a.numOfDigits;d.rounding=a.rounding;d.addSpaces=a.addSpaces;a=f.mixin({},this._url.query,{f:"json"},d);var e=this._toGeoCoordinateHandler,k=this._errorHandler,h=new l(g._dfdCanceller);h._pendingDfd=n({url:this._url.path+"/toGeoCoordinateString",content:a,callbackParamName:"callback",load:function(a,d){e(a,d,b,c,h)},error:function(a){k(a,c,h)}});return h},_toGeoCoordinateHandler:function(a,b,c,e,f){try{this._successHandler([a.strings],"onToGeoCoordinateStringComplete",
c,f)}catch(A){this._errorHandler(A,e,f)}},onToGeoCoordinateStringComplete:function(){},fromGeoCoordinateString:function(a,b,c){var d={};f.isObject(a.sr)?d.sr=a.sr.wkid||m.toJson(a.sr.toJson()):d.sr=a.sr;d.strings=m.toJson(a.strings);d.conversionType=a.conversionType||"MGRS";d.conversionMode=a.conversionMode;a=f.mixin({},this._url.query,{f:"json"},d);var e=this._fromGeoCoordinateHandler,k=this._errorHandler,h=new l(g._dfdCanceller);h._pendingDfd=n({url:this._url.path+"/fromGeoCoordinateString",content:a,
callbackParamName:"callback",load:function(a,d){e(a,d,b,c,h)},error:function(a){k(a,c,h)}});return h},_fromGeoCoordinateHandler:function(a,b,c,e,f){try{this._successHandler([a.coordinates],"onToGeoCoordinateStringComplete",c,f)}catch(A){this._errorHandler(A,e,f)}},onFromGeoCoordinateStringComplete:function(){}});f.mixin(p,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,
UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,
UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,
UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",
UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return p})},"esri/layers/FeatureLayer":function(){define("require module dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/date/locale dojo/sniff dojo/io-query dojo/dom-construct dojo/i18n dojo/when dojo/promise/all ../kernel ../lang ../request ../config ../deferredUtils ../SpatialReference ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/jsonUtils ../renderers/arcadeUtils ../tasks/QueryTask ../tasks/query ../tasks/FeatureSet ../tasks/StatisticDefinition ../geometry/Extent ../geometry/jsonUtils ../geometry/normalizeUtils ../geometry/scaleUtils ./GraphicsLayer ./Field ./TimeInfo ./FeatureType ./FeatureTemplate ./FeatureEditResult ./LabelClass ./SnapshotMode ./OnDemandMode ./SelectionMode ./StreamMode ./TrackManager ./HeatmapManager dojo/i18n!../nls/jsapi require".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J,L,P,Q,H,K,V,S,ba,N,M,W,ga,D,ja,na,ca,ea,ua,ha,oa,la,va){var Ea=t.defaults,ia=b(N,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",reHostedFS:/(https?:)?\/\/services.*\.arcgis\.com/i,maxPointCountForAuto:4E3,maxRecordCountForAuto:2E3,maxVertexCountForAuto:25E4,generalizeForScale:4E3,_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],
"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(a,b){this._preventInit||this._initFeatureLayer(a,b)},_initFeatureLayer:function(a,b){this.i18n=va;b=b||{};this.showLabels=
null!=b.showLabels?b.showLabels:!0;this._outFields=b.outFields;this._defnExpr=b.definitionExpression;this._loadCallback=b.loadCallback;var c=b._usePatch;this._usePatch=null===c||void 0===c?!0:c;this._trackIdField=b.trackIdField;this.objectIdField=b.objectIdField;this._maxOffset=null!=b.maxAllowableOffset?b.maxAllowableOffset:this.maxAllowableOffset;this.quantize=null!=b.quantize?b.quantize:!0;this._optEditable=b.editable;this._optAutoGen=b.autoGeneralize;this.editSummaryCallback=b.editSummaryCallback;
this.userId=b.userId;this.userIsAdmin=b.userIsAdmin;this.useMapTime=b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0;this.source=b.source;this.gdbVersion=b.gdbVersion;this.orderByFields=b.orderByFields;this.maxPointCountForAuto=null!=b.maxPointCountForAuto?b.maxPointCountForAuto:this.maxPointCountForAuto;this.maxRecordCountForAuto=null!=b.maxRecordCountForAuto?b.maxRecordCountForAuto:this.maxRecordCountForAuto;this.maxVertexCountForAuto=null!=b.maxVertexCountForAuto?b.maxVertexCountForAuto:this.maxVertexCountForAuto;
this.generalizeForScale=null!=b.generalizeForScale?b.generalizeForScale:this.generalizeForScale;this.queryPagination=null!=b.queryPagination?b.queryPagination:this.url?this.reHostedFS.test(this.url):!1;this.multipatchOption=b.multipatchOption;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var e=ia,c=this.mode=d.isDefined(b.mode)?b.mode:e.MODE_ONDEMAND;this._isStream&&(this.mode=c=e.MODE_STREAM);switch(c){case e.MODE_SNAPSHOT:this.currentMode=
e.MODE_SNAPSHOT;this._mode=new ca(this);this._isSnapshot=!0;break;case e.MODE_ONDEMAND:case e.MODE_AUTO:this.currentMode=e.MODE_ONDEMAND;this._tileWidth=b.tileWidth||512;this._tileHeight=b.tileHeight||512;this._mode=new ea(this);this.latticeTiling=b.latticeTiling;break;case e.MODE_SELECTION:this.currentMode=e.MODE_SELECTION;this._mode=new ua(this);this._isSelOnly=!0;break;case e.MODE_STREAM:this.currentMode=e.MODE_STREAM,this._mode=new ha(this),this._isStream=!0}this._initLayer=l.hitch(this,this._initLayer);
this._selectHandler=l.hitch(this,this._selectHandler);this._editable=!1;if(l.isObject(a)&&a.layerDefinition)return this._collection=!0,this.mode=this._isStream?e.MODE_STREAM:e.MODE_SNAPSHOT,this._isStream||this._outFields||(this._outFields=["*"]),this._initLayer(a),this;this._task=new L(this.url,{source:this.source,gdbVersion:this.gdbVersion});c=this._url.path;this._fserver=!1;-1!==c.search(/\/FeatureServer\//i)&&(this._fserver=!0);this.mode===e.MODE_AUTO&&this.reHostedFS.test(this.url)&&this._queryLimit();
(e=b.resourceInfo)?this._initLayer(e):(this.source&&(e={source:this.source.toJson()},this._url.query=l.mixin(this._url.query,{layer:r.toJson(e)})),this.gdbVersion&&(this._url.query=l.mixin(this._url.query,{gdbVersion:this.gdbVersion})),w({url:c,content:l.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler}));this.registerConnectEvents()},_initLayer:function(a,b){if(a||b){this._json=a;this._findCredential();if(this.credential&&this.credential.ssl||
a&&a._ssl)this._useSSL(),this._task._useSSL();this.version=a.currentVersion;this.version||(this.version="capabilities"in a||"drawingInfo"in a||"hasAttachments"in a||"htmlPopupType"in a||"relationships"in a||"timeInfo"in a||"typeIdField"in a||"types"in a?10:9.3);this._collection&&(this._isStream||(this.currentMode=ia.MODE_SNAPSHOT,this._mode=new ca(this)),this._isSnapshot=!0,this._featureSet=a.featureSet,this._nextId=a.nextObjectId,a=a.layerDefinition);this.geometryType=a.geometryType;"string"!==typeof this.multipatchOption&&
"esriGeometryMultiPatch"===this.geometryType&&(this.multipatchOption="xyFootprint");if(a.hasOwnProperty("capabilities")){var c=this.capabilities=a.capabilities;c&&-1!==c.toLowerCase().indexOf("editing")?this._editable=!0:this._editable=!1}else this._collection||(this._editable=this._fserver);d.isDefined(this._optEditable)?(this._editable=this._optEditable,delete this._optEditable):"esriGeometryMultiPatch"===this.geometryType&&(this._editable=!1);this._json=r.toJson(this._json);this.isEditable()?this._setMaxOffset(null):
this.mode===ia.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==this.geometryType&&!this.hasXYFootprint()||(this._autoGeneralize=d.isDefined(this._optAutoGen)?this._optAutoGen:this.mode===ia.MODE_ONDEMAND||this.mode===ia.MODE_AUTO,delete this._optAutoGen);var c=a.effectiveMinScale||a.minScale,f=a.effectiveMaxScale||a.maxScale;!this._hasMin&&c&&this.setMinScale(c);!this._hasMax&&f&&this.setMaxScale(f);this.layerId=a.id;this.name=a.name;this.description=a.description;
this.copyright=a.copyrightText;this.type=a.type;this.displayField=a.displayField;this.defaultDefinitionExpression=a.definitionExpression||(a.isView?a.viewDefinitionQuery:a.definitionQuery);this.fullExtent=new K(a.extent);this.initialExtent=new K(this.fullExtent.toJson());this.fullExtent.spatialReference&&(this.spatialReference=new A(this.fullExtent.spatialReference.toJson()));this.defaultVisibility=a.defaultVisibility;if("esriGeometryPoint"===this.geometryType||"esriGeometryMultipoint"===this.geometryType)this.latticeTiling=
!1;this.hasM=a.hasM||!1;this.hasZ=a.hasZ||!1;this.indexedFields=a.indexedFields;this.maxRecordCount=a.maxRecordCount;this.canModifyLayer=a.canModifyLayer;this.supportsStatistics=a.supportsStatistics;this.supportsAdvancedQueries=this._collection?!1:a.supportsAdvancedQueries;this.supportsCalculate=a.supportsCalculate;this.supportsAttachmentsByUploadId=a.supportsAttachmentsByUploadId;this.supportsCoordinatesQuantization=a.supportsCoordinatesQuantization;this.quantize=this.quantize&&this.supportsCoordinatesQuantization;
this.hasLabels=a.hasLabels;this.canScaleSymbols=a.canScaleSymbols;this.supportsRollbackOnFailureParameter=this.supportsRollbackOnFailure=a.supportsRollbackOnFailure;this.syncCanReturnChanges=a.syncCanReturnChanges;this.isDataVersioned=a.isDataVersioned;this.editFieldsInfo=a.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=a.ownershipBasedAccessControlForFeatures;this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures&&(this.creatorField=this.editFieldsInfo.creatorField);this.relationships=
a.relationships;this.allowGeometryUpdates=d.isDefined(a.allowGeometryUpdates)?a.allowGeometryUpdates:!0;this.allowUpdateWithoutMValues=!!a.allowUpdateWithoutMValues;this.advancedQueryCapabilities=a.advancedQueryCapabilities||{supportsStatistics:this.supportsStatistics,supportsOrderBy:this.supportsAdvancedQueries,supportsDistinct:this.supportsAdvancedQueries};this.useStandardizedQueries=a.useStandardizedQueries;this.tileMaxRecordCount=a.tileMaxRecordCount;this.standardMaxRecordCount=a.standardMaxRecordCount;
this._setMaxOffset(this._maxOffset,!0);this._isTable="Table"===this.type;for(var g=this.fields=[],f=a.fields,c=0;c<f.length;c++)g.push(new M(f[c]));if(!this.objectIdField){this.objectIdField=a.objectIdField;if(!this.objectIdField)for(f=a.fields,c=0;c<f.length;c++)if(g=f[c],"esriFieldTypeOID"===g.type){this.objectIdField=g.name;break}this.objectIdField||this._isStream||console.debug("esri.layers.FeatureLayer: "+d.substitute({url:this.url},"objectIdField is not set [url: ${url}]"))}if(!d.isDefined(this._nextId)){f=
this.objectIdField;g=-1;if(this._collection&&f)for(var k=(c=this._featureSet)&&c.features,t=k?k.length:0,q,c=0;c<t;c++)q=(q=k[c].attributes)&&q[f],q>g&&(g=q);this._nextId=g+1}this.globalIdField=a.globalIdField;if(c=this.typeIdField=a.typeIdField)if(c=!this._getField(c)&&this._getField(c,!0))this.typeIdField=c.name;this.visibilityField=a.visibilityField;if(f=a.defaultSymbol)this.defaultSymbol=B.fromJson(f);var u=this.types=[],n=a.types,v,m,g=(c=this.editFieldsInfo)&&c.creatorField,k=c&&c.editorField;
q=g||k;t=[];if(n)for(c=0;c<n.length;c++)v=new ga(n[c]),m=v.templates,q&&m&&m.length&&(t=t.concat(m)),u.push(v);n=a.templates;v=this.templates=[];if(n)for(c=0;c<n.length;c++)u=new D(n[c]),q&&t.push(u),v.push(u);for(c=0;c<t.length;c++)if(q=l.getObject("prototype.attributes",!1,t[c]))g&&delete q[g],k&&delete q[k];if(c=a.timeInfo)this.timeInfo=new W(c),this._startTimeField=c.startTimeField,this._endTimeField=c.endTimeField,this._startTimeField&&this._endTimeField&&(this._twoTimeFields=!0),this._trackIdField?
c.trackIdField=this._trackIdField:this._trackIdField=c.trackIdField;this.hasAttachments=!this._collection&&a.hasAttachments?!0:!1;this.htmlPopupType=a.htmlPopupType;var c=a.drawingInfo,w;(g=c&&c.labelingInfo)&&!this.labelingInfo&&(this.labelingInfo=h.map(g,function(a){return new na(a)}),this._fixLabelExpr());if(!this.renderer)if(c&&c.renderer){if(w=c.renderer,this.setRenderer(I.fromJson(w)),"classBreaks"===w.type&&this.renderer.setMaxInclusive(!0),!this._collection){var x=w.type,f=[];w=this.renderer;
switch(x){case "simple":f.push(w.symbol);break;case "uniqueValue":case "classBreaks":f.push(w.defaultSymbol),f=f.concat(h.map(w.infos,function(a){return a.symbol}))}var f=h.filter(f,d.isDefined),p=this._url.path+"/images/",P=this._getToken();h.forEach(f,function(a){var b=a.url;b&&(-1===b.search(/https?\:/)&&-1===b.indexOf("data:")&&(a.url=p+b),P&&-1!==a.url.search(/https?\:/)&&(a.url+="?token\x3d"+P))})}}else if(f)n=this.types,0<n.length?(w=new G(this.defaultSymbol,this.typeIdField),h.forEach(n,function(a){w.addValue(a.id,
a.symbol)})):w=new E(this.defaultSymbol),this.setRenderer(w);else if(!this._isTable){switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":x=new y;break;case "esriGeometryPolyline":x=new z;break;case "esriGeometryPolygon":x=new C;break;default:this.hasXYFootprint()&&(x=new C)}this.setRenderer(x?new E(x):null)}x=c&&c.transparency||0;!this.hasOwnProperty("opacity")&&0<x&&(this.opacity=1-x/100);(e("ie")||7<=e("trident")||e("safari"))&&this.isEditable()&&10.02>this.version&&
(this._ts=!0);this.statistics=a.statistics;this._fixRendererFields();this._updateRequiredFieldsFromLabelingInfo();this._checkFields();this._updateCaps();var L=function(){this.currentMode!==ia.MODE_SNAPSHOT&&(this.queryPagination=!1);null==this._maxOffset||this._isFractionalOffsetAllowed()||this._setMaxOffset(this._maxOffset);this.loaded=!0;this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,a(this))};this._collection?(x=this._featureSet,this._featureSet=null,this._mode._drawFeatures(new Q(x)),
this._fcAdded=!0,L.call(this)):this._forceIdentity(this._limitPromise?function(){var a=this;this._limitPromise.then(function(b){a._checkMode(b)});this._limitPromise.always(function(){a._limitPromise=null;L.call(a)})}:L)}},setShowLabels:function(a){this.showLabels=a;this.onShowLabelsChange()},onShowLabelsChange:function(){},onRendererChange:function(a){this.inherited(arguments);var b=this._map;this._ager=!!(a&&a.observationAger&&a.observationRenderer);a&&"colors"in a&&"blurRadius"in a&&"maxPixelIntensity"in
a?"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&b&&(this._heatmapManager=new la(this),this._heatmapManager.initialize(b)):this.renderer&&this.renderer.getRendererInfo?h.some(this.renderer.rendererInfos,function(a){return a.renderer&&"colors"in a.renderer&&"blurRadius"in a.renderer})||(this._heatmapManager=null):this._heatmapManager=null;this.timeInfo&&b&&(a&&(a.latestObservationRenderer||a.trackRenderer)?this._trackManager||(this._trackManager=new oa(this),this._trackManager.initialize(b),
this._childLayer=this._trackManager.container,this._mode._applyTimeFilter()):this._trackManager&&!this._isStream&&(this._trackManager.destroy(),this._trackManager=null));if(a){var c=[],b=h.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],d.isDefined),e=function(a){return null!=a&&"function"!=typeof a&&a};h.forEach(b,function(a){var b=e(a.attributeField),d=e(a.attributeField2);a=e(a.attributeField3);!1!==b&&c.push(b);!1!==d&&c.push(d);!1!==a&&c.push(a)});this._requiredFields=
c}else this._requiredFields=[];this.loaded&&(this._fixRendererFields(),this._checkFields(this._requiredFields),this._collection&&(this._typesDirty=!0))},redraw:function(){this.inherited(arguments);this._trackManager&&this._trackManager.container&&this._trackManager.container.redraw()},_evalSDRenderer:function(){this.inherited(arguments);var a=this._getRenderer();this._ager=!!(a&&a.observationAger&&a.observationRenderer);this._trackManager&&this._trackManager.container&&this._trackManager.container.setRenderer(a&&
a.trackRenderer)},_setMap:function(a){var b=this.inherited(arguments),c=this._mode,d=this;c&&c.initialize(a);this.geometryType&&this.attr("data-geometry-type",this.geometryType.replace(/esriGeometry/i,"").toLowerCase());this._addHandle=this.on("graphic-node-add",function(a){a=a.graphic.attributes;(a=d._selectedFeatures[a&&a[d.objectIdField]])&&a.attr("data-selected","")});return b},_unsetMap:function(a){var b=this._mode;b&&b.suspend();this._trackManager&&(this._trackManager.destroy(),this._trackManager=
null);m.disconnect(this._zoomConnect);m.disconnect(this._addHandle);this._zoomConnect=this._addHandle=null;this._toggleTime(!1);this.inherited("_unsetMap",arguments)},refresh:function(){this._needsRefresh=!1;var a=this._mode;a&&a.refresh()},hasXYFootprint:function(){return"esriGeometryMultiPatch"===this.geometryType&&"xyFootprint"===this.multipatchOption},getOutFields:function(){return h.filter(this._getOutFields(),function(a){return"*"===a||!!this._getField(a)},this)},getField:function(a){return this._getField(a,
!0)},getFieldLabel:function(a){var b=this.infoTemplate,b=b&&b.getFieldInfo&&b.getFieldInfo(a);a=l.isFunction(a)?null:this.getField(a);var c=b||a,d="";c&&(d=b&&b.label||a&&a.alias||c.name||c.fieldName);return d},getDomain:function(a,b){var c,d,e=b&&b.feature,f=e&&this.typeIdField&&e.attributes&&e.attributes[this.typeIdField];null!=f&&h.some(this.types,function(b){return b.id==f?((c=b.domains&&b.domains[a])&&"inherited"===c.type&&(c=this._getLayerDomain(a),d=!0),!0):!1},this);d||c||(c=this._getLayerDomain(a));
return c},_getLayerDomain:function(a){var b;h.some(this.fields,function(c){c.name===a&&(b=c.domain);return!!b});return b},getType:function(a){var b,c=a&&this.typeIdField&&a.attributes&&a.attributes[this.typeIdField];h.some(this.types,function(a){a.id==c&&(b=a);return!!b});return b},setEditable:function(a){if(!this._collection)return console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service"),this;if(!this.loaded)return this._optEditable=a,this;
var b=this._editable;this._editable=a;this._updateCaps();if(b!==a)this.onCapabilitiesChange();return this},getEditCapabilities:function(a){var b={canCreate:!1,canUpdate:!1,canDelete:!1};if(!this.loaded||!this.isEditable())return b;var c=a&&a.feature;a=a&&a.userId||this.getUserId();var d=h.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],l.trim),e=(b=-1<h.indexOf(d,"editing"))&&-1<h.indexOf(d,"create"),f=b&&-1<h.indexOf(d,"update"),d=b&&-1<h.indexOf(d,"delete"),g=this.ownershipBasedAccessControlForFeatures,
k=this.editFieldsInfo,t=k&&k.creatorField,k=k&&k.realm,c=(c=c&&c.attributes)&&t?c[t]:void 0,q=!!this.userIsAdmin,t=!g||q||!(!g.allowOthersToUpdate&&!g.allowUpdateToOthers),u=!g||q||!(!g.allowOthersToDelete&&!g.allowDeleteToOthers),n=!g||q||!g.hasOwnProperty("allowAnonymousToUpdate")||g.allowAnonymousToUpdate,g=!g||q||!g.hasOwnProperty("allowAnonymousToDelete")||g.allowAnonymousToDelete;a&&k&&(a=a+"@"+k);if(q||b&&!(e||f||d))e=f=d=!0;b={canCreate:e,canUpdate:f,canDelete:d};a||(b.canUpdate=b.canUpdate&&
n,b.canDelete=b.canDelete&&g);null===c?(b.canUpdate=b.canUpdate&&t,b.canDelete=b.canDelete&&u):""!==c&&c&&a.toLowerCase()!==c.toLowerCase()&&(b.canUpdate=b.canUpdate&&t,b.canDelete=b.canDelete&&u);return b},getUserId:function(){var a;this.loaded&&(a=this.credential&&this.credential.userId||this.userId||"");return a},setUserIsAdmin:function(a){this.userIsAdmin=a},setEditSummaryCallback:function(a){this.editSummaryCallback=a},getEditSummary:function(a,b,c){c=d.isDefined(c)?c:(new Date).getTime();var e=
"";c=this.getEditInfo(a,b,c);(b=b&&b.callback||this.editSummaryCallback)&&(c=b(a,c)||"");if(l.isString(c))e=c;else{if(c){a=c.action;b=c.userId;var f=c.timeValue,g=0;a&&g++;b&&g++;d.isDefined(f)&&g++;1<g&&(e=("edit"===a?"edit":"create")+(b?"User":"")+(d.isDefined(f)?c.displayPattern:""))}e=e&&d.substitute(c,this.i18n.layers.FeatureLayer[e])}return e},getEditInfo:function(a,b,c){if(this.loaded){c=d.isDefined(c)?c:(new Date).getTime();b=b&&b.action||"last";var e=this.editFieldsInfo,f=e&&e.creatorField,
g=e&&e.creationDateField,k=e&&e.editorField,e=e&&e.editDateField,k=(a=a&&a.attributes)&&k?a[k]:void 0,e=a&&e?a[e]:null,f=this._getEditData(a&&f?a[f]:void 0,a&&g?a[g]:null,c);c=this._getEditData(k,e,c);var h;switch(b){case "creation":h=f;break;case "edit":h=c;break;case "last":h=c||f}h&&(h.action=h===c?"edit":"creation");return h}},_getEditData:function(a,b,c){var e,f,k;d.isDefined(b)&&(f=c-b,k=0>f?"Full":6E4>f?"Seconds":12E4>f?"Minute":36E5>f?"Minutes":72E5>f?"Hour":864E5>f?"Hours":6048E5>f?"WeekDay":
"Full");if(void 0!==a||k)e=e||{},e.userId=a,k&&(a=g.format,c=new Date(b),e.minutes=Math.floor(f/6E4),e.hours=Math.floor(f/36E5),e.weekDay=a(c,{datePattern:"EEEE",selector:"date"}),e.formattedDate=a(c,{selector:"date"}),e.formattedTime=a(c,{selector:"time"}),e.displayPattern=k,e.timeValue=b);return e},isEditable:function(){return!(!this._editable&&!this.userIsAdmin)},isQueryable:function(){var a=h.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],l.trim);return this._isStream||this.userIsAdmin||
this._collection||-1!==h.indexOf(a,"query")||-1!==h.indexOf(a,"catalog")},setMaxAllowableOffset:function(a){this.isEditable()||this._setMaxOffset(a,!0);return this},getMaxAllowableOffset:function(){var a=this._quantizationParameters?this._quantizationParameters.tolerance:void 0;return null!=this._maxOffset?this._maxOffset:a},_setMaxOffset:function(a,b){if(null==a)return delete this._maxOffset,delete this._quantizationParameters,this;this.quantize&&this.supportsCoordinatesQuantization?("esriGeometryPolyline"===
this.geometryType?this._maxOffset=a:delete this._maxOffset,this._quantizationParameters={mode:"view",originPosition:"upperLeft",tolerance:a,extent:this.fullExtent}):(this._isFractionalOffsetAllowed()&&b||(a=Math.floor(a)),isNaN(a)||0===a?delete this._maxOffset:this._maxOffset=a,delete this._quantizationParameters);return this},_isFractionalOffsetAllowed:function(){return null==this.version||10.1<=this.version||navigator.languages&&this._isLangWithDot(navigator.languages[0])},_isLangWithDot:function(a){a=
(a=a&&a.split("-"))&&a[0]&&a[0].toLowerCase();return-1!==h.indexOf(this._langsWithDot,a)},_langsWithDot:"ar en et fr he ja ko th vi zh".split(" "),setAutoGeneralize:function(a){this.loaded?this.isEditable()||this.mode===ia.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==this.geometryType&&!this.hasXYFootprint()||((this._autoGeneralize=a)?(this._autoSnapshot&&(this._prevScale=null),this._updateMaxOffset()):this._setMaxOffset(null)):this._optAutoGen=a;return this},
setGDBVersion:function(a){this._collection||a===this.gdbVersion||!a&&!this.gdbVersion||(this.gdbVersion=a,this._task.gdbVersion=a,this._url.query=l.mixin(this._url.query,{gdbVersion:a}),this.loaded&&(this.clearSelection(),this._map&&this.refresh()),this.onGDBVersionChange());return this},hasAllFeatures:function(){return this._mode?this._mode.hasAllFeatures():!0},setDefinitionExpression:function(a){this._defnExpr=a;(a=this._mode)&&a.propertyChangeHandler(1);return this},getDefinitionExpression:function(){return this._defnExpr},
setTimeDefinition:function(a){this._isSnapshot?(this._timeDefn=a,(a=this._mode)&&a.propertyChangeHandler(2)):console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id \x3d "+this.id+", Layer URL \x3d "+this.url);return this},getTimeDefinition:function(){return this._timeDefn},setTimeOffset:function(a,b){this._timeOffset=a;this._timeOffsetUnits=b;var c=this._mode;c&&c.propertyChangeHandler(0);return this},setUseMapTime:function(a){this.useMapTime=
a;this._toggleTime(!this.suspended);(a=this._mode)&&a.propertyChangeHandler(0)},selectFeatures:function(a,b,c,d){b=b||ia.SELECTION_NEW;this._hasPartialSelectedFeatures=!1;a=this._getShallowClone(a);var e=this._map,f,g=this,k=x._fixDfd(new n(x._dfdCanceller));a.outFields=this.getOutFields();a.returnGeometry=!0;a.multipatchOption=this.multipatchOption;e&&(a.outSpatialReference=new A(e.spatialReference.toJson()));if(!this._applyQueryFilters(a,!0))return f={features:[]},this._selectHandler(f,b,c,d,k),
k;if(e=this._canDoClientSideQuery(a))k._pendingDfd=v(this._doQuery(a,e)),k._pendingDfd.then(function(a){f={features:a};g._selectHandler(f,b,c,d,k)});else{if(this._collection)return this._resolve([Error("FeatureLayer::selectFeatures - "+this.invalidParams)],null,d,k,!0),k;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],null,d,k,!0),k;var h=this;this._ts&&(a._ts=(new Date).getTime());(k._pendingDfd=this._task.execute(a)).addCallbacks(function(a){h._selectHandler(a,
b,c,d,k)},function(a){h._hasPartialSelectedFeatures=!0;h._resolve([a],null,d,k,!0)})}return k},getSelectedFeatures:function(){var a=this._selectedFeatures,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},clearSelection:function(a){var b=this._selectedFeatures,c=this._mode,d;for(d in b)b.hasOwnProperty(d)&&(this._unSelectFeatureIIf(d,c),c._removeFeatureIIf(d));this._selectedFeatures={};this._isSelOnly&&c._applyTimeFilter(!0);if(!a)this.onSelectionClear();return this},setSelectionSymbol:function(a){if(this._selectionSymbol=
a){var b=this._selectedFeatures,c;for(c in b)b.hasOwnProperty(c)&&b[c].setSymbol(a)}return this},getSelectionSymbol:function(){return this._selectionSymbol},setLabelingInfo:function(a){a?(this.labelingInfo=a,this._fixLabelExpr()):delete this.labelingInfo;this._collection&&(this._typesDirty=!0);this.onLabelingInfoChange()},_fixLabelExpr:function(){var a=/\[([^\[\]]+)\]/ig,b,c=this,d=function(a,b){var d=c._getField(b,!0);return"["+(d&&d.name||b)+"]"};h.forEach(this.labelingInfo,function(c){if(b=c.labelExpression)c.labelExpression=
b.replace(a,d)})},_updateRequiredFieldsFromLabelingInfo:function(){var a=[];h.forEach(this.labelingInfo,function(b){var c=b.labelExpressionInfo;if(b.labelExpression){var d=/[\[\]]/ig;b=b.labelExpression.match(/\[[^\[\]]+\]/ig);(b=h.map(b,function(a){return a.replace(d,"")}))&&(a=a.concat(b))}if(c){if(c.value){var e=/[\{\}]/ig;b=c.value.match(/\{[^\{\}]+\}/ig);(b=h.map(b,function(a){return a.replace(e,"")}))&&(a=a.concat(b))}c.expression&&(a=a.concat(J.extractFieldNames(c.expression)))}});a=h.map(a,
function(a){var b=this.getField(a);return b?b.name:a},this);this._requiredFields&&(this._requiredFields=this._requiredFields.concat(a))},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(a,b,c,d,e,f){var g=f.assembly,k=f.dfd;this._applyNormalized(a,g&&g[0]);this._applyNormalized(b,g&&g[1]);this.onBeforeApplyEdits(a,b,c);var t={},q=this.objectIdField,g={f:"json"},u=!1;if(this._collection)f={},f.addResults=a?h.map(a,function(){u=!0;return{objectId:this._nextId++,success:!0}},
this):null,f.updateResults=b?h.map(b,function(a){u=!0;var b=a.attributes[q];t[b]=a;return{objectId:b,success:!0}},this):null,f.deleteResults=c?h.map(c,function(a){u=!0;return{objectId:a.attributes[q],success:!0}},this):null,u?this._editHandler(f,a,t,d,e,k):this._resolve([f.addResults,f.updateResults,f.deleteResults],null,d,k);else{a&&0<a.length&&(g.adds=this._convertFeaturesToJson(a,0,1),u=!0);if(b&&0<b.length){for(f=0;f<b.length;f++){var n=b[f];t[n.attributes[q]]=n}g.updates=this._convertFeaturesToJson(b,
0,0,1);u=!0}if(c&&0<c.length){b=[];for(f=0;f<c.length;f++)b.push(c[f].attributes[q]);g.deletes=b.join(",");u=!0}if(u){var v=this;return w({url:this._url.path+"/applyEdits",content:l.mixin(g,this._url.query),callbackParamName:"callback",load:function(b){v._editHandler(b,a,t,d,e,k)},error:function(a){v._resolve([a],null,e,k,!0)}},{usePost:!0})}this._resolve([],null,d,k)}},queryFeatures:function(a,b,c){return this._query("execute","onQueryFeaturesComplete",a,b,c)},queryRelatedFeatures:function(a,b,c){return this._query("executeRelationshipQuery",
"onQueryRelatedFeaturesComplete",a,b,c)},queryIds:function(a,b,c){return this._query("executeForIds","onQueryIdsComplete",a,b,c)},queryCount:function(a,b,c){return this._query("executeForCount","onQueryCountComplete",a,b,c)},queryExtent:function(a,b,c){return this._query("executeForExtent","onQueryExtentComplete",a,b,c)},queryAttachmentInfos:function(a,b,d){var e=this._url.path+"/"+a+"/attachments",f=new n(x._dfdCanceller),g=this;f._pendingDfd=w({url:e,content:l.mixin({f:"json"},this._url.query),
callbackParamName:"callback",load:function(d){d=d.attachmentInfos;var k;h.forEach(d,function(b){k=c.objectToQuery({gdbVersion:g._url.query&&g._url.query.gdbVersion,layer:g._url.query&&g._url.query.layer,token:g._getToken()});b.url=e+"/"+b.id+(k?"?"+k:"");b.objectId=a});g._resolve([d],"onQueryAttachmentInfosComplete",b,f)},error:function(a){g._resolve([a],null,d,f,!0)}});return f},addAttachment:function(a,b,c,d){return this._sendAttachment("add",a,b,c,d)},updateAttachment:function(b,c,d,e,f){d.appendChild(a.create("input",
{type:"hidden",name:"attachmentId",value:c}));return this._sendAttachment("update",b,d,e,f)},deleteAttachments:function(a,b,c,d){var e=this._url.path+"/"+a+"/deleteAttachments",f=new n(x._dfdCanceller),g=this;b={f:"json",attachmentIds:b.join(",")};f._pendingDfd=w({url:e,content:l.mixin(b,this._url.query),callbackParamName:"callback",load:l.hitch(this,function(b){b=b.deleteAttachmentResults;b=h.map(b,function(b){b=new ja(b);b.attachmentId=b.objectId;b.objectId=a;return b});g._resolve([b],"onDeleteAttachmentsComplete",
c,f)}),error:function(a){g._resolve([a],null,d,f,!0)}},{usePost:!0});return f},addType:function(a){var b=this.types;if(b){if(h.some(b,function(b){return b.id==a.id?!0:!1}))return!1;b.push(a)}else this.types=[a];return this._typesDirty=!0},deleteType:function(a){if(this._collection){var b=this.types;if(b){var c=-1;h.some(b,function(b,d){return b.id==a?(c=d,!0):!1});if(-1<c)return this._typesDirty=!0,b.splice(c,1)[0]}}},toJson:function(){var a=this._json;if(a=l.isString(a)?r.fromJson(a):l.clone(a)){var a=
a.layerDefinition?a:{layerDefinition:a},b=a.layerDefinition,c=this._collection;if(c&&this._typesDirty){b.types=h.map(this.types||[],function(a){return a.toJson()});var d=this.renderer,e=this.labelingInfo,f=b.drawingInfo;!d&&!e||f||(f=b.drawingInfo={});f&&d&&-1===d.declaredClass.indexOf("TemporalRenderer")&&(f.renderer=d.toJson());e&&(f.labelingInfo=h.map(e,function(a){return a.toJson()}))}d=null;if(!c||this._fcAdded)d={geometryType:b.geometryType,features:this._convertFeaturesToJson(this.graphics,
!0)};a.featureSet=l.mixin({},a.featureSet||{},d);a.featureSet.transform&&(e=a.featureSet.transform,delete a.featureSet.transform,d=new Q(a.featureSet),d.quantize(e),a.featureSet=d.toJson());c&&(a.nextObjectId=this._nextId,b.capabilities=this.capabilities);return a}},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},
onQueryCountComplete:function(){},onQueryExtentComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},onLabelingInfoChange:function(){},_forceIdentity:function(a){var b=this,c,d=this._url&&this._url.path;c=d&&d.toLowerCase().indexOf("/rest/services");var e=this.editFieldsInfo,
e=e&&(e.creatorField||e.editorField);(this.userIsAdmin||e)&&!this._getToken()&&-1<c&&k.id?(c=d.substring(0,c)+"/rest/info",w({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.owningSystemUrl)return k.id.checkSignInStatus(a.owningSystemUrl+"/sharing")}).then(function(a){if(a)return k.id.getCredential(d)}).then(function(a){a&&b._findCredential()}).always(function(){a.call(b)})):a.call(this)},_checkMode:function(a){var b=this.geometryType,c=this.maxRecordCount;
a=(a=a&&a.features&&a.features[0])&&a.attributes&&a.attributes.exceedslimit;this.mode===ia.MODE_AUTO&&!this.isEditable()&&0===a&&(this.queryPagination||("esriGeometryPolyline"===b||"esriGeometryPolygon"===b||"esriGeometryMultipoint"===b||this.hasXYFootprint())&&c>=this.maxRecordCountForAuto||"esriGeometryPoint"===b&&c>=this.maxPointCountForAuto)&&(this.currentMode=ia.MODE_SNAPSHOT,this._mode=new ca(this),this._isSnapshot=this._autoSnapshot=!0)},_queryLimit:function(){var a=this,b=new n;this._limitPromise=
b.promise;setTimeout(function(){var c=new P,d=new H;d.statisticType="exceedslimit";d.maxPointCount=a.maxPointCountForAuto;d.maxRecordCount=a.maxRecordCountForAuto;d.maxVertexCount=a.maxVertexCountForAuto;d.outStatisticFieldName="exceedslimit";c.outStatistics=[d];a.queryFeatures(c).promise.then(function(a){b.resolve(a)},function(a){b.reject(a)})},0)},_updateCaps:function(){var a=this._editable,b=l.trim(this.capabilities||""),c=h.map(b?b.split(","):[],l.trim),d=h.map(b?b.toLowerCase().split(","):[],
l.trim),b=h.indexOf(d,"editing"),e,d={Create:h.indexOf(d,"create"),Update:h.indexOf(d,"update"),Delete:h.indexOf(d,"delete")};if(a&&-1===b)c.push("Editing");else if(!a&&-1<b){a=[b];for(e in d)-1<d[e]&&a.push(d[e]);a.sort();for(e=a.length-1;0<=e;e--)c.splice(a[e],1)}this.capabilities=c.join(",")},_counter:{value:0},_getUniqueId:function(){return this._counter.value++},onSuspend:function(){this.inherited(arguments);this._toggleTime(!1);var a=this._mode;a&&a.suspend()},onResume:function(a){this.inherited(arguments);
this._toggleTime(!0);var b=this._mode,c=this._map,d=this._getRenderer();a.firstOccurrence?(this._fixRendererFields(),this._updateRequiredFieldsFromLabelingInfo(),this._checkFields(),this.clearSelection(),this.timeInfo&&!this._trackManager&&(this._trackIdField||d&&(d.latestObservationRenderer||d.trackRenderer))&&(this._trackManager=new oa(this),this._trackManager.initialize(c),this._childLayer=this._trackManager.container),d&&"colors"in d&&"blurRadius"in d&&"maxPixelIntensity"in d&&"esriGeometryPoint"==
this.geometryType&&!this._heatmapManager&&(this._heatmapManager=new la(this),this._heatmapManager.initialize(c)),this._autoSnapshot&&this._autoGeneralize&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||this.hasXYFootprint())&&!this.isEditable()&&null==this.getMaxAllowableOffset()&&(d=this.generalizeForScale,this._calculatedScale=d=this.maxScale?this.maxScale:this.minScale?Math.min(d,this.minScale):Math.min(d,ba.getScale(c,this.initialExtent)),this._calcMaxOffset=
c.extent.getWidth()/c.width/c.getScale()*d),this._zoomConnect=m.connect(c,"onZoomEnd",this,this._zoomEndHandler),this._updateMaxOffset(),this._needsRefresh=!1,b&&b.startup()):(this._zoomEndHandler(),b&&b.resume())},_zoomEndHandler:function(){var a=this._map;this._updateMaxOffset();this._prevScale=a.getScale();!this.suspended&&this._needsRefresh&&this.refresh()},_updateMaxOffset:function(){var a=this._map;a&&a.loaded&&this._autoGeneralize&&(this._autoSnapshot?(a=this.getMaxAllowableOffset(),this._setMaxOffset(this._getMaxOffsetForScale(),
!0),this._needsRefresh||(this._needsRefresh=a!=this.getMaxAllowableOffset())):this._setMaxOffset(a.extent.getWidth()/a.width,!a.extent.spatialReference.isWebMercator()))},_getMaxOffsetForScale:function(){if(this._map){var a=this._map.getScale(),b=this._calculatedScale,c=this._calcMaxOffset,d=this._prevScale;return a>=b&&(null==d||d<b)?c:a<b&&(null==d||d>=b)?null:this.getMaxAllowableOffset()}},_toggleTime:function(a){var b=this._map;a&&this.timeInfo&&this.useMapTime&&b?(this._mapTimeExtent=b.timeExtent,
this._timeConnect||(this._timeConnect=m.connect(b,"onTimeExtentChange",this,this._timeChangeHandler))):(this._mapTimeExtent=null,m.disconnect(this._timeConnect),this._timeConnect=null)},_timeChangeHandler:function(a){this._mapTimeExtent=a;(a=this._mode)&&a.propertyChangeHandler(0)},_getOffsettedTE:function(a){var b=this._timeOffset,c=this._timeOffsetUnits;return a&&b&&c?a.offset(-1*b,c):a},_getTimeOverlap:function(a,b){return a&&b?a.intersection(b):a||b},_getTimeFilter:function(a){var b=this.getTimeDefinition(),
c;if(b&&(c=this._getTimeOverlap(b,null),!c))return[!1];if(a){if(a=c?this._getTimeOverlap(a,c):a,!a)return[!1]}else a=c;return[!0,a]},_getAttributeFilter:function(a){var b=this.getDefinitionExpression();return a?b?"("+b+") AND ("+a+")":a:b},_applyQueryFilters:function(a,b){a.where=this._getAttributeFilter(a.where);a.maxAllowableOffset||(a.maxAllowableOffset=this._maxOffset);a.quantizationParameters=this._quantizationParameters;b&&this.supportsAdvancedQueries&&(a.orderByFields=a.orderByFields||this.getOrderByFields());
if(this.timeInfo){var c=this._getTimeFilter(a.timeExtent);if(c[0])a.timeExtent=c[1];else return!1}return!0},_add:function(a){var b=this._selectionSymbol,c=a.attributes,d=this.visibilityField;b&&this._isSelOnly&&a.setSymbol(b);if(d&&c&&c.hasOwnProperty(d))a[c[d]?"show":"hide"]();return this.add.apply(this,arguments)},_remove:function(){return this.remove.apply(this,arguments)},_canDoClientSideQuery:function(a){var b=[],c=this._map,d;if((this._collection||!this._isTable&&c)&&!(a.text||a.where&&a.where!==
this.getDefinitionExpression()||a.orderByFields&&a.orderByFields.length&&(d=this.getOrderByFields()||[])&&a.orderByFields.join()!==d.join()||a.outStatistics||a.returnDistinctValues)){d=this._isSnapshot;var e=this._isSelOnly,f=a.geometry;if(f){if(e||a.spatialRelationship!==P.SPATIAL_REL_INTERSECTS||"extent"!==f.type||!d&&!c.extent.contains(f))return;b.push(1)}if(c=a.objectIds)if(d)b.push(2);else{var f=c.length,g=this._mode,k=0,t;for(t=0;t<f;t++)g._getFeature(c[t])&&k++;if(k===f)b.push(2);else return}if(this.timeInfo)if(a=
a.timeExtent,c=this._mapTimeExtent,d)a&&b.push(3);else if(e){if(a)return}else if(c)if(-1!==h.indexOf(b,2))a&&b.push(3);else if(-1!==h.indexOf(b,1))a==c&&b.push(3);else return;else if(0<b.length)a&&b.push(3);else if(a)return;return 0<b.length?b:null}},_getAbsMid:function(a){return p.toAbsMid?p.toAbsMid(a):f.id.replace(/\/[^\/]*$/ig,"/")+a},_doQuery:function(a,b,c){var d=[],e=this.objectIdField,f=this,g=new n,k=new n,t=this.graphics;if(-1!==h.indexOf(b,1)){var q=this.spatialIndex||this._map&&this._map.spatialIndex,
u,v=a.geometry._normalize(null,!0);null==q&&Ea.autoSpatialIndexing?u=(this._map||this).addPlugin(this._getAbsMid("../plugins/spatialIndex")).then(l.hitch(this,l.partial(this._getFromIndex,v,q)),function(a){k.resolve(l.hitch(this,l.partial(this._filterByExtent,t,v)))}):q&&(u=this._getFromIndex(v,q));u?u.then(function(a){for(var b=0;b<a.length;b++)a[b].results&&(d=d.concat(a[b].results));k.resolve(d)}).otherwise(function(a){k.reject(a)}):k.resolve(this._filterByExtent(t,v))}else k.resolve(t);k.then(function(k){d=
k;if(-1!==h.indexOf(b,2)){var t=a.objectIds;d=h.filter(d,function(a){return-1<h.indexOf(t,a.attributes[e])})}-1!==h.indexOf(b,3)&&f.timeInfo&&(k=a.timeExtent,d=f._filterByTime(d,k.startTime,k.endTime).match);c&&(d=h.map(d,function(a){return a.attributes[e]},this));g.resolve(d)});return g},_getFromIndex:function(a,b){b=b||this.spatialIndex||this._map.spatialIndex;a instanceof Array||(a=[a]);var c=this.id;return q(h.map(a,function(a){return b.intersects(a,c)}))},_filterByExtent:function(a,b){for(var c=
[],d=0,e=a.length;d<e;d++){var f=a[d],g=f.geometry;g&&(this.normalization&&b.length?(b[0].intersects(g)||b[1].intersects(g))&&c.push(f):b.intersects(g)&&c.push(f))}return c},_filterByTime:function(a,b,c){var e=this._startTimeField,f=this._endTimeField,g;this._twoTimeFields||(g=e||f);var k=d.isDefined,h=[],t=[],q,l=a.length,u,n;b=b?b.getTime():-Infinity;c=c?c.getTime():Infinity;if(g)for(q=0;q<l;q++)u=a[q],n=u.attributes,e=n[g],e>=b&&e<=c?h.push(u):t.push(u);else for(q=0;q<l;q++)u=a[q],n=u.attributes,
g=n[e],n=n[f],g=k(g)?g:-Infinity,n=k(n)?n:Infinity,g>=b&&g<=c||n>=b&&n<=c||b>=g&&c<=n?h.push(u):t.push(u);return{match:h,noMatch:t}},_getSizeVariables:function(a){return a&&h.filter(a.getVisualVariablesForType("sizeInfo",!1),function(a){return!(!a.field&&!a.valueExpression)})},_needClientSideSorting:function(a){return this._collection?!(!a||!a.length):h.some(a,function(a){return!!a.valueExpression})},_sortFeatures:function(a){var b=this.renderer,c=this._getSizeVariables(b);if(a&&1<a.length&&this._needClientSideSorting(c)){var d=
c[0],e=this;a.sort(function(a,c){a._layer||(a._layer=e);c._layer||(c._layer=e);var f=b._getDataValue(a,d,"sizeInfo",null,e),g=b._getDataValue(c,d,"sizeInfo",null,e);return null==f?-1:null==g?1:g-f})}return a},_resolve:function(a,b,c,d,e){b&&this[b].apply(this,a);c&&c.apply(null,a);d&&x._resDfd(d,a,e)},_getShallowClone:function(a){var b=new P,c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},_query:function(a,b,c,d,e){var f=this,g=this._map,k=new n(x._dfdCanceller),t=c,q,l;if("executeRelationshipQuery"!==
a){var t=this._getShallowClone(c),u=this.getOutFields();t.outFields||(t.outFields=u);t.outFields&&t.outFields.length&&(l=-1<h.indexOf(u,"*")?!1:!h.every(t.outFields,function(a){return-1<h.indexOf(u,a)}));t.returnGeometry=c.hasOwnProperty("returnGeometry")?c.returnGeometry:!c.outStatistics;t.returnGeometry&&(t.multipatchOption=this.multipatchOption);var m;g&&(c=g&&g.spatialReference,(g=t.outSpatialReference)?q=!g.equals(c):t.outSpatialReference=new A(c.toJson()));if(!this._applyQueryFilters(t,"execute"===
a&&!t.outStatistics)){switch(a){case "execute":m=new Q({features:[]});break;case "executeForIds":m=[];break;case "executeForCount":m=0;break;case "executeForExtent":m={}}this._resolve([m],b,d,k);return k}if(c="executeForExtent"!==a&&!q&&!l&&this._canDoClientSideQuery(t))return k._pendingDfd=v(this._doQuery(t,c,"executeForIds"===a||"executeForCount"===a)),k._pendingDfd.then(function(c){switch(a){case "execute":m=new Q;m.features=c;break;case "executeForIds":m=c;break;case "executeForCount":m=c.length}f._resolve([m],
b,d,k)}),k}if(this._collection)return this._resolve([Error("FeatureLayer::_query - "+this.invalidParams)],null,e,k,!0),k;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],null,e,k,!0),k;this._ts&&(t._ts=(new Date).getTime());(k._pendingDfd=this._task[a](t)).addCallbacks(function(c){var e=!!t.outStatistics||q||l;if("execute"===a||"executeRelationshipQuery"===a){var g,h;if("execute"===a)for(g=c.features,h=g.length,--h;0<=h;h--){if(g[h]._layer=
f,!e&&!f._isTable){var u=f._mode._getFeature(g[h].attributes[f.objectIdField]);u&&g.splice(h,1,u)}}else for(u in c)if(c.hasOwnProperty(u))for(g=c[u].features,h=g.length,--h;0<=h;h--)g[h]._layer=f}f._resolve([c],b,d,k)},function(a){f._resolve([a],null,e,k,!0)});return k},_convertFeaturesToJson:function(a,b,c,d){var e=[],f=this._selectionSymbol,g=this.visibilityField,k,t=this.objectIdField;this.loaded&&(c||d)&&(k=h.filter(this.fields,function(a){return!1===a.editable&&(!d||a.name!==t)}));for(c=0;c<
a.length;c++){var q=a[c],u={},n=q.geometry,v=q.attributes,m=q.symbol;!n||d&&this.loaded&&!this.allowGeometryUpdates||(u.geometry=n.toJson());g?(u.attributes=v=l.mixin({},v),v[g]=q.visible?1:0):v&&(u.attributes=l.mixin({},v));u.attributes&&k&&k.length&&h.forEach(k,function(a){delete u.attributes[a.name]});m&&m!==f&&(u.symbol=m.toJson());e.push(u)}return b?e:r.toJson(e)},_selectHandler:function(a,b,c,d,e){var f;d=ia;switch(b){case d.SELECTION_NEW:this.clearSelection(!0);f=!0;break;case d.SELECTION_ADD:f=
!0;break;case d.SELECTION_SUBTRACT:f=!1}d=a.features;var g=this._mode,k=[],h=this.objectIdField,t,q;if(f)for(f=0;f<d.length;f++)t=d[f],q=t.attributes[h],t=g._addFeatureIIf(q,t),k.push(t),this._selectFeatureIIf(q,t,g);else for(f=0;f<d.length;f++)t=d[f],q=t.attributes[h],this._unSelectFeatureIIf(q,g),q=g._removeFeatureIIf(q),k.push(q||t);this._isSelOnly&&g._applyTimeFilter(!0);this._hasPartialSelectedFeatures=!!a.exceededTransferLimit;this._resolve([k,b,a.exceededTransferLimit?{queryLimitExceeded:!0}:
null],"onSelectionComplete",c,e);if(a.exceededTransferLimit)this.onQueryLimitExceeded()},_selectFeatureIIf:function(a,b,c){var d=this._selectedFeatures,e=d[a];e||(c._incRefCount(a),d[a]=b,this._isTable||(this._setSelectSymbol(b),b.attr("data-selected","")));return e||b},_unSelectFeatureIIf:function(a,b){var c=this._selectedFeatures[a];c&&(b._decRefCount(a),delete this._selectedFeatures[a],this._isTable||(this._setUnSelectSymbol(c),c.attr("data-selected")));return c},_isSelected:function(a){},_setSelectSymbol:function(a){var b=
this._selectionSymbol;b&&!this._isSelOnly&&a.setSymbol(b)},_setUnSelectSymbol:function(a){var b=this._selectionSymbol;b&&!this._isSelOnly&&b===a.symbol&&a.setSymbol(null,!0)},_getOutFields:function(){var a=[this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._requiredFields).concat(this.dataAttributes),a=h.filter(a,function(a,b,c){return!!a&&h.indexOf(c,a)===b}),b=l.clone(this._outFields);if(b){if(-1!==h.indexOf(b,"*"))return b;
h.forEach(a,function(a){-1===h.indexOf(b,a)&&b.push(a)});return b}return a},_checkFields:function(a){var b=a||this._getOutFields();h.forEach(b,function(a){"*"!==a&&(this._getField(a)||console.debug("esri.layers.FeatureLayer: "+d.substitute({url:this.url,field:a},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]")))},this);a||this._isTable||this._fserver||this._collection||this._isStream||h.some(this.fields,function(a){return a&&"esriFieldTypeGeometry"===a.type?!0:!1})||
console.debug("esri.layers.FeatureLayer: "+d.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"))},_fixFieldCase:function(a,b,c){var d=a&&a[b],e;if(d&&!l.isFunction(d)){if(e=!this._getField(d)&&this._getField(d,!0))d=a[b]=e.name;c&&c.push(d)}return d},_fixRendererFields:function(){var a=this.renderer;this._orderBy=null;this._requiredFields=[];if(a&&
0<this.fields.length){var b=[],c,a=h.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],d.isDefined),e=[].concat(a);h.forEach(a,function(a){h.forEach(a.rendererInfos,function(a){a.renderer&&e.push(a.renderer)})});h.forEach(e,function(a){this._fixFieldCase(a,"attributeField",b);this._fixFieldCase(a,"attributeField2",b);this._fixFieldCase(a,"attributeField3",b);this._fixFieldCase(a.rotationInfo,"field",b);(c=this._fixFieldCase(a.sizeInfo,"field",b))&&!this._orderBy&&(this._orderBy=
[c+" DESC"]);this._fixFieldCase(a.sizeInfo,"normalizationField",b);this._fixFieldCase(a.colorInfo,"field",b);this._fixFieldCase(a.colorInfo,"normalizationField",b);this._fixFieldCase(a.field,"field",b);this._fixFieldCase(a.opacityInfo,"field",b);this._fixFieldCase(a.opacityInfo,"normalizationField",b);h.forEach(a.visualVariables,function(a){c=this._fixFieldCase(a,"field",b);"sizeInfo"===a.type&&c&&!this._orderBy&&(this._orderBy=[c+" DESC"]);this._fixFieldCase(a,"normalizationField",b)},this);var d=
h.map(a.getFieldsUsedInExpressions(),function(a){var b=this.getField(a);return b?b.name:a},this);b=b.concat(d);this._orderBy||!a.addBreak||l.isFunction(a.attributeField)||!a.backgroundFillSymbol&&!this._hasSizeDiff(a)||(this._orderBy=[a.attributeField+" DESC"])},this);this._requiredFields=h.filter(b,d.isDefined)}},_hasSizeDiff:function(a){var b=Number.MAX_VALUE,c=-Number.MAX_VALUE,d,e;h.forEach(a.infos,function(a){if(e=a.symbol){d=0;switch(e.type){case "simplemarkersymbol":d=e.size;break;case "picturemarkersymbol":d=
(e.width+e.height)/2;break;case "simplelinesymbol":case "cartographiclinesymbol":d=e.width;break;case "simplefillsymbol":case "picturefillsymbol":d=e.outline&&e.outline.width}d&&(b=Math.min(b,d),c=Math.max(c,d))}});return b!==Number.MAX_VALUE&&c!==-Number.MAX_VALUE&&1<Math.abs(c-b)},getOrderByFields:function(){var a=this.orderByFields||this._orderBy;return this.supportsAdvancedQueries&&a?h.filter(a,function(a){a=a.split(" ")[0];return!!this._getField(a,!0)},this):null},_getField:function(a,b){var c=
this.fields;if(!c||0===c.length)return null;var d;b&&(a=a.toLowerCase());h.some(c,function(c){var e=!1;(e=b?c&&c.name.toLowerCase()===a?!0:!1:c&&c.name===a?!0:!1)&&(d=c);return e});return d},_getDateOpts:function(){this._dtOpts||(this._dtOpts={properties:h.map(h.filter(this.fields,function(a){return!(!a||"esriFieldTypeDate"!==a.type)}),function(a){return a.name})});return this._dtOpts},_applyNormalized:function(a,b){a&&b&&h.forEach(a,function(a,c){a&&b[c]&&a.setGeometry(b[c])})},_editHandler:function(a,
b,c,d,e,f){e=a.addResults;var g=a.updateResults;a=a.deleteResults;var k,t,q,u,n,v=this.objectIdField,m=this._mode,w=this._isTable;k=this.editFieldsInfo;u=this.getOutFields()||[];var x=k&&k.creatorField,r=k&&k.creationDateField,p=k&&k.editorField,A=k&&k.editDateField;k=k&&k.realm;-1===h.indexOf(u,"*")&&(x&&-1===h.indexOf(u,x)&&(x=null),r&&-1===h.indexOf(u,r)&&(r=null),p&&-1===h.indexOf(u,p)&&(p=null),A&&-1===h.indexOf(u,A)&&(A=null));var y=r||A?(new Date).getTime():null,z=x||p?this.getUserId():void 0;
z&&k&&(z=z+"@"+k);if(e){var C=this.globalIdField;for(k=0;k<e.length;k++)e[k]=new ja(e[k]),w||(t=e[k],t.success&&(q=t.objectId,u=b[k],(n=u._graphicsLayer)&&n!==this&&n.remove(u),n=u.attributes||{},n[v]=q,q=t.globalId,C&&q&&(n[C]=q),x&&(n[x]=z),p&&(n[p]=z),r&&(n[r]=y),A&&(n[A]=y),u.setAttributes(n),m._init&&m.drawFeature(u)))}if(g)for(k=0;k<g.length;k++)if(g[k]=new ja(g[k]),!w&&(t=g[k],t.success)){q=t.objectId;u=c[q];if(b=m._getFeature(q))b.geometry!==u.geometry&&u.geometry&&b.setGeometry(V.fromJson(u.geometry.toJson())),
b.attributes!==u.attributes&&u.attributes&&b.setAttributes(l.mixin(b.attributes,u.attributes)),this._repaint(b,q);u=b||u;n=u.attributes||{};p&&(n[p]=z);A&&(n[A]=y);u.setAttributes(n)}if(a){c=[];for(k=0;k<a.length;k++)if(a[k]=new ja(a[k]),!w&&(t=a[k],t.success&&(q=t.objectId,u=m._getFeature(q))))this._unSelectFeatureIIf(q,m)&&c.push(u),u._count=0,m._removeFeatureIIf(q);if(0<c.length)this.onSelectionComplete(c,ia.SELECTION_SUBTRACT)}this._resolve([e,g,a],"onEditsComplete",d,f)},_sendAttachment:function(a,
b,c,d,e){var f=this;return w({url:this._url.path+"/"+b+"/"+("add"===a?"addAttachment":"updateAttachment"),form:c,content:l.mixin(this._url.query,{f:"json",token:this._getToken()||void 0}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(c){var e="add"===a?"onAddAttachmentComplete":"onUpdateAttachmentComplete";c=new ja(c["add"===a?"addAttachmentResult":"updateAttachmentResult"]);c.attachmentId=c.objectId;c.objectId=b;f._resolve([c],e,d);return c}).addErrback(function(a){f._resolve([a],
null,e,null,!0)})},_repaint:function(a,b,c){b=d.isDefined(b)?b:a.attributes[this.objectIdField];b in this._selectedFeatures&&this._selectionSymbol||a.setSymbol(a.symbol,c)},_getKind:function(a){var b=this._trackManager;return b?b.isLatestObservation(a)?1:0:0}});l.mixin(ia,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,MODE_AUTO:6,MODE_STREAM:7,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});
S._createWrappers(ia);return ia})},"esri/layers/Field":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./RangeDomain ./CodedValueDomain".split(" "),function(p,f,b,m,l,h){return p(null,{declaredClass:"esri.layers.Field",constructor:function(b){if(b&&f.isObject(b)&&(this.name=b.name,this.type=b.type,this.alias=b.alias,this.length=b.length,this.editable=b.editable,this.nullable=b.nullable,(b=b.domain)&&f.isObject(b)))switch(b.type){case "range":this.domain=new l(b);break;case "codedValue":this.domain=
new h(b)}}})})},"esri/layers/RangeDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Domain".split(" "),function(p,f,b,m,l,h){return p([h],{declaredClass:"esri.layers.RangeDomain",constructor:function(b){b&&f.isObject(b)&&(this.minValue=b.range[0],this.maxValue=b.range[1])},toJson:function(){var b=this.inherited(arguments);b.range=[this.minValue,this.maxValue];return l.fixJson(b)}})})},"esri/layers/Domain":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel","../lang"],function(p,f,b,m,l){return p(null,{declaredClass:"esri.layers.Domain",constructor:function(b){b&&f.isObject(b)&&(this.name=b.name,this.type=b.type)},toJson:function(){return l.fixJson({name:this.name,type:this.type})}})})},"esri/layers/CodedValueDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./Domain".split(" "),function(p,f,b,m,l,h,r){return p([r],{declaredClass:"esri.layers.CodedValueDomain",constructor:function(b){b&&
f.isObject(b)&&(this.codedValues=b.codedValues)},getName:function(f){var g;b.some(this.codedValues,function(b){b.code==f&&(g=b.name);return!!g});return g},toJson:function(){var b=this.inherited(arguments);b.codedValues=f.clone(this.codedValues);return h.fixJson(b)}})})},"esri/layers/FeatureType":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../symbols/jsonUtils ./RangeDomain ./CodedValueDomain ./InheritedDomain ./FeatureTemplate".split(" "),function(p,
f,b,m,l,h,r,n,g,e,c){return p(null,{declaredClass:"esri.layers.FeatureType",constructor:function(a){if(a&&f.isObject(a)){this.id=a.id;this.name=a.name;var b=a.symbol;b&&(this.symbol=r.fromJson(b));var b=a.domains,h,q=this.domains={};for(h in b)if(b.hasOwnProperty(h)){var k=b[h];switch(k.type){case "range":q[h]=new n(k);break;case "codedValue":q[h]=new g(k);break;case "inherited":q[h]=new e(k)}}if(h=a.templates)for(b=this.templates=[],a=0;a<h.length;a++)b.push(new c(h[a]))}},toJson:function(){var a=
{id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()},c,e=this.domains,f=this.templates,g=h.fixJson;if(e){var d=a.domains={};for(c in e)e.hasOwnProperty(c)&&(d[c]=e[c]&&e[c].toJson());g(d)}f&&(a.templates=b.map(f,function(a){return a.toJson()}));return g(a)}})})},"esri/layers/InheritedDomain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Domain"],function(p,f,b,m,l){return p([l],{declaredClass:"esri.layers.InheritedDomain"})})},"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),
function(p,f,b,m,l,h){p=p(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(b){b&&f.isObject(b)&&(this.name=b.name,this.description=b.description,this.drawingTool=b.drawingTool,this.thumbnail=b.thumbnail,b=b.prototype,this.prototype=new h(b.geometry,null,b.attributes))},toJson:function(){return l.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,thumbnail:l.fixJson(f.clone(this.thumbnail)),prototype:this.prototype&&this.prototype.toJson()})}});
f.mixin(p,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",
TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});return p})},"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,f,b,m){return p(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(b){b&&f.isObject(b)&&(this.objectId=b.objectId,this.globalId=b.globalId,this.success=b.success,b.success||(b=b.error,this.error=Error(),
this.error.code=b.code,this.error.message=b.description))}})})},"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),function(p,f,b,m,l,h,r,n){var g=RegExp("__begin__","ig"),e=RegExp("__end__","ig"),c=/^__begin__/i,a=/__end__$/i;return p(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,format:null,fieldInfos:null,useCodedValues:null,
symbol:null,maxScale:0,minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter","above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter","below-left":"esriServerPointLabelPlacementBelowLeft","below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft",
"center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter","above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd","below-after":"esriServerLinePlacementBelowAfter","below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart",
"below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong","center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd","always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},constructor:function(a){a&&(f.mixin(this,a),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=h.valueOf(this._labelPlacementLookup,
a.labelPlacement)),a.format&&(this.format=a.format),a.fieldInfos&&(this.fieldInfos=a.fieldInfos),a.symbol&&(this.symbol="esriSHD"===a.symbol.type?new n(a.symbol):new r(a.symbol)),a=this.sizeInfo)&&(a.minSize&&(a.minSize=m.pt2px(a.minSize)),a.maxSize&&(a.maxSize=m.pt2px(a.maxSize)))},getSymbol:function(){return this.symbol},toJson:function(){var a=this.sizeInfo;a&&(a=f.mixin({},a),a.minSize&&(a.minSize=m.px2pt(a.minSize)),a.maxSize&&(a.maxSize=m.px2pt(a.maxSize)));var b=h.fixJson(this.labelExpressionInfo&&
f.clone(this.labelExpressionInfo));this._processLabelExpressionInfo(b);a={name:this.name,labelExpression:this.labelExpression,labelExpressionInfo:b,format:this.format||void 0,fieldInfos:this.fieldInfos||void 0,useCodedValues:this.useCodedValues,maxScale:this.maxScale,minScale:this.minScale,where:this.where,sizeInfo:a||void 0,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};
return h.fixJson(a)},_processLabelExpressionInfo:function(a){a&&a.value&&(a.expression=this._convertTemplatedStringToArcade(a.value))},_convertTemplatedStringToArcade:function(b){var h;b&&(h=f.replace(b,function(a,b){return'__begin__$feature["'+b+'"]__end__'}),h=c.test(h)?h.replace(c,""):'"'+h,h=a.test(h)?h.replace(a,""):h+'"',h=h.replace(g,'" + ').replace(e,' + "'));return h}})})},"esri/symbols/ShieldLabelSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol ./Font".split(" "),
function(p,f,b,m,l,h,r,n,g){var e={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};p=p(n,{declaredClass:"esri.symbol.ShieldLabelSymbol",type:"shieldlabelsymbol",color:[255,255,255,1],width:32,height:32,font:m.defaultFont,constructor:function(c,a,g,h,q){c?f.isString(c)?(this.url=c,a&&(this.color=a),g&&(this.width=g),h&&(this.height=h),void 0!==q&&(this.font=q)):(this.width=m.pt2px(c.width),this.height=m.pt2px(c.height),a=c.imageData,9>b("ie")||!a||(g=this.url,this.url="data:"+(c.contentType||
"image")+";base64,"+a,this.imageData=g)):f.mixin(this,e)},getStroke:function(){return null},getFill:function(){return this.color},setWidth:function(b){this.width=b;return this},setHeight:function(b){this.height=b;return this},setUrl:function(b){b!==this.url&&(delete this.imageData,delete this.contentType);this.url=b;return this},setFont:function(b){this.font=b;return this},setText:function(b){this.text=b;return this},getWidth:function(){return this.width},getHeight:function(){return this.height},
getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var b=this.url,a=this.imageData;if(0===b.indexOf("data:"))var e=b,b=a,a=e.indexOf(";base64,")+8,a=e.substr(a);var b=r.getAbsoluteUrl(b),e=m.px2pt(this.width),e=isNaN(e)?void 0:e,l=m.px2pt(this.height),l=isNaN(l)?void 0:l,b=h.fixJson(f.mixin(this.inherited("toJson",arguments),{type:"esriSHD",
url:b,imageData:a,contentType:this.contentType,width:e,height:l}));this.font?(a=new g(this.font),b.font=a.toJson()):b.font=null;delete b.size;b.imageData||delete b.imageData;return b}});p.defaultProps=e;return p})},"esri/layers/SnapshotMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ../tasks/query ./RenderMode".split(" "),function(p,f,b,m,l,h,r){return p([r],{declaredClass:"esri.layers._SnapshotMode",constructor:function(b){this.featureLayer=b;this.pagination=
b.queryPagination;this._featureMap={};this._hasPartialFeatures=!1;this._drawFeatures=f.hitch(this,this._drawFeatures);this._queryErrorHandler=f.hitch(this,this._queryErrorHandler)},startup:function(){this.pagination=this.pagination&&null!=this.featureLayer.maxRecordCount;this.featureLayer._collection?this._applyTimeFilter():this._fetchAll()},propertyChangeHandler:function(b){this._init&&(b?this.featureLayer._collection?console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id \x3d "+
this.featureLayer.id):this._fetchAll():this._applyTimeFilter())},drawFeature:function(b){var f=b.attributes[this.featureLayer.objectIdField];this._addFeatureIIf(f,b);this._incRefCount(f)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var b=this.featureLayer;b._collection?(b._fireUpdateStart(),b._refresh(!0),b._fireUpdateEnd()):this._fetchAll()},hasAllFeatures:function(){return!this._hasPartialFeatures},_getRequestId:function(b){return("_"+b.name+b.layerId+b._ulid).replace(/[^a-zA-Z0-9\_]+/g,
"_")},_fetchAll:function(){var b=this.featureLayer;b._collection||b.suspended||!b.isQueryable()||(b._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=!1,this._sendRequest())},_sendRequest:function(b){var f=this.map,e=this.featureLayer,c=e.getDefinitionExpression(),a=new h;a.outFields=e.getOutFields();a.where=c||"1\x3d1";a.returnGeometry=!0;a.outSpatialReference=new l(f.spatialReference.toJson());a.timeExtent=e.getTimeDefinition();a.maxAllowableOffset=e._maxOffset;a.quantizationParameters=
e._quantizationParameters;e._ts&&(a._ts=(new Date).getTime());a.orderByFields=e.supportsAdvancedQueries?e.getOrderByFields():null;a.multipatchOption=e.multipatchOption;this.pagination&&(this._start=a.start=null==b?0:b,a.num=e.maxRecordCount);var u;e._usePatch&&(u=this._getRequestId(e),this._cancelPendingRequest(null,u));e._task.execute(a,this._drawFeatures,this._queryErrorHandler,u)},_drawFeatures:function(b){this._purgeRequests();var f=b.features,e=this.featureLayer,c=e.objectIdField,a,h=f.length,
l=b.exceededTransferLimit&&!e._collection,q=e._selectedFeatures,k=e.mode===e.constructor.MODE_AUTO,d,n,t;e._fireUpdateStart();e._sortFeatures(f);for(a=0;a<h;a++)n=f[a],t=n.attributes[c],d=this._addFeatureIIf(t,n),this._incRefCount(t),k&&d!==n&&q[t]&&(d.setGeometry(n.geometry),d.setAttributes(n.attributes));this._applyTimeFilter(!0);this.pagination&&l||(this._hasPartialFeatures=!!b.exceededTransferLimit,e._fireUpdateEnd(null,b.exceededTransferLimit?{queryLimitExceeded:!0}:null));l&&(this.pagination&&
this._sendRequest(this._start+e.maxRecordCount),e.onQueryLimitExceeded())},_queryErrorHandler:function(b){this._purgeRequests();this._hasPartialFeatures=!0;var f=this.featureLayer;f._errorHandler(b);f._fireUpdateEnd(b)}})})},"esri/layers/RenderMode":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/io/script ../kernel".split(" "),function(p,f,b,m,l,h,r){return f(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+
(p._scopeName||"dojo")+"IoScript"},initialize:function(b){this.map=b;this._init=!0},startup:function(){},propertyChangeHandler:function(b){},destroy:function(){this._init=!1},drawFeature:function(b){},suspend:function(){},resume:function(){},refresh:function(){},hasAllFeatures:function(){return!0},_incRefCount:function(b){(b=this._featureMap[b])&&b._count++},_decRefCount:function(b){(b=this._featureMap[b])&&b._count--},_getFeature:function(b){return this._featureMap[b]},_addFeatureIIf:function(b,
f){var e=this._featureMap,c=e[b],a=this.featureLayer;c||(e[b]=f,a._add(f),f._count=0);return c||f},_removeFeatureIIf:function(b){var f=this._featureMap[b],e=this.featureLayer;if(f){if(f._count)return;delete this._featureMap[b];e._remove(f)}return f},_clearIIf:function(){var b;b=this.featureLayer;var f=b.graphics,e=b._selectedFeatures,c=b.getSelectedFeatures().length,a=b.objectIdField;if(c)for(b=f.length-1;0<=b;b--){var c=f[b],h=c.attributes[a];h in e?c._count=1:(c._count=0,this._removeFeatureIIf(h))}else b.clear(),
this._featureMap={}},_isPending:function(b){return h[this._prefix+b]?!0:!1},_cancelPendingRequest:function(b,f){if(b=b||h[this._prefix+f])try{b.cancel(),h._validCheck(b)}catch(e){}},_purgeRequests:function(){h._validCheck(null)},_toggleVisibility:function(b){var f=this.featureLayer,e=f.graphics,c=b?"show":"hide",a,h=e.length;b=b&&f._ager;for(a=0;a<h;a++){var l=e[a];l[c]();b&&f._repaint(l)}},_applyTimeFilter:function(b){var f=this.featureLayer;if(f.timeInfo&&!f.suspended){b||f._fireUpdateStart();var e=
f._trackManager;e&&e.clearTracks();var c=f.getTimeDefinition(),a=f._getOffsettedTE(f._mapTimeExtent);a?(a=f._getTimeOverlap(c,a))?(c=f._filterByTime(f.graphics,a.startTime,a.endTime),e&&e.addFeatures(c.match),m.forEach(c.match,function(a){var b=a._shape;a.visible||(a.show(),(b=a._shape)&&b._moveToFront());f._ager&&b&&f._repaint(a)}),m.forEach(c.noMatch,function(a){a.visible&&a.hide()})):this._toggleVisibility(!1):(e&&e.addFeatures(f.graphics),this._toggleVisibility(!0));e&&(e.moveLatestToFront(),
e.drawTracks());b||f._fireUpdateEnd()}}})})},"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),function(p,f,b,m,l,h,r,n,g,e){return p([g],{declaredClass:"esri.layers._OnDemandMode",constructor:function(c){this.featureLayer=c;this._featureMap={};this._hasPartialFeatures=!1;this._queryErrorHandler=b.hitch(this,this._queryErrorHandler)},initialize:function(b){this.inherited(arguments);
var a=this.featureLayer,c=a._srInfo;this._gridLayer=new e(new r(c?c.valid[0]:b.extent.xmin,c?c.valid[1]:b.extent.ymax,b.spatialReference),{width:a._tileWidth,height:a._tileHeight},{width:b.width,height:b.height},c);this._cellMap={};this._gridLayer.setResolution(b.extent)},startup:function(){this._ioQueue=[];this.featureLayer.suspended||(this._zoomHandler(),this._enableConnectors())},propertyChangeHandler:function(b){this._init&&(2>b?this._zoomHandler():console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id \x3d "+
this.featureLayer.id+", Layer URL \x3d "+this.featureLayer.url))},destroy:function(){this._disableConnectors();this.inherited(arguments)},drawFeature:function(b){var a=b.geometry,c=[];if(a){var c=this._gridLayer.getCellsInExtent("point"===a.type?{xmin:a.x,ymin:a.y,xmax:a.x,ymax:a.y}:a.getExtent(),!1).cells,a=this._cellMap,e,f,g=b.attributes[this.featureLayer.objectIdField],d,h,t;for(e=0;e<c.length;e++)f=c[e],d=f.latticeID,h=f.row,t=f.col,d?f=a[d]=a[d]||f:(a[h]=a[h]||{},f=a[h][t]=a[h][t]||f),f.features=
f.features||[],f.features.push(b),this._addFeatureIIf(g,b),this._incRefCount(g)}},suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},refresh:function(){this._zoomHandler()},hasAllFeatures:function(){if(this._hasPartialFeatures)return!0;var b=!1,a=this._getCurrentCells(),e;for(e=0;e<a.length;e++)if(a[e].hasPartialFeatures){b=!0;break}return!b},_enableConnectors:function(){var b=this.map;this._zoomConnect=f.connect(b,
"onZoomEnd",this,this._zoomHandler);this._panConnect=f.connect(b,"onPanEnd",this,this._panHandler);this._resizeConnect=f.connect(b,"onResize",this,this._panHandler)},_disableConnectors:function(){f.disconnect(this._zoomConnect);f.disconnect(this._panConnect);f.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);var b=this.featureLayer,a=this.map;!b.suspended&&b.isQueryable()&&(b._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=!1,(b=b._trackManager)&&b.clearTracks(),
this._cellMap={},this._gridLayer.setResolution(a.extent),this._sendRequest())},_panHandler:function(b){if(this.featureLayer.isQueryable()){this.featureLayer._fireUpdateStart();var a=this.featureLayer._resized;b=a?b:null;a&&this._gridLayer.setMapState(b,this.map.width,this.map.height);this._sendRequest(b)}},_getRequestId:function(b,a){return("_"+b.name+b.layerId+b._ulid+"_"+a.resolution+"_"+(a.latticeID||a.row+"_"+a.col)).replace(/[^a-zA-Z0-9\_]+/g,"_")},_sendRequest:function(b){this._exceeds=!1;var a=
this.featureLayer,c=this.map;b=b||c.extent;c=this._gridLayer.getCellsInExtent(b,a.latticeTiling).cells;if(!a.isEditable())var e=this._cellMap,c=m.filter(c,function(a){if(a.lattice){if(e[a.latticeID])return!1}else if(e[a.row]&&e[a.row][a.col])return!1;return!0});var f=a.getOutFields(),g=a.getDefinitionExpression(),d=a._getOffsettedTE(a._mapTimeExtent),h=a.supportsAdvancedQueries?a.getOrderByFields():null,t=a._usePatch,l=this._ioQueue,r,p=this,z=this._drawFeatures,C,B,E;this._pending=this._pending||
0;for(r=0;r<c.length;r++){C=c[r];B=new n;B.geometry=C.extent||C.lattice;B.outFields=f;B.where=g;a.latticeTiling&&C.extent&&(B.spatialRelationship=n.SPATIAL_REL_CONTAINS);B.returnGeometry=!0;B.timeExtent=d;a._ts&&(B._ts=(new Date).getTime());B.orderByFields=h;B.multipatchOption=a.multipatchOption;B.maxAllowableOffset=a._maxOffset;B.quantizationParameters=a._quantizationParameters;(E=a.advancedQueryCapabilities)&&E.supportsQueryWithResultType&&(B.resultType="tile");E=null;if(t&&(E=this._getRequestId(a,
C),this._isPending(E)))continue;this._pending++;l.push(a._task.execute(B,function(){var a=C;return function(b){z.apply(p,[b,a])}}.call(this),this._queryErrorHandler,E))}this._removeOldCells(b);this._endCheck()},_drawFeatures:function(b,a){a.hasPartialFeatures=!!b.exceededTransferLimit;this._exceeds=this._exceeds||b.exceededTransferLimit;this._finalizeIO();var c=this.featureLayer,e=this.map.extent,f=a.extent,g=a.row,d=a.col,h=c.objectIdField,t=b.features,l=this._gridLayer,n=this._cellMap,m=a.latticeID,
r=m?n[m]:n[g]&&n[g][d];if(a.resolution==l._resolution&&(m?m===l.getLatticeID(e):l.intersects(f,e)))if(r)c._sortFeatures(t),this._updateCell(r,t);else for(c._sortFeatures(t),a.features=t,m?n[m]=a:(n[g]=n[g]||{},n[g][d]=a),e=t.length,c=0;c<e;c++)f=t[c],g=f.attributes[h],this._addFeatureIIf(g,f),this._incRefCount(g);else r&&this._removeCell(g,d,m);this._endCheck()},_queryErrorHandler:function(b){this._finalizeIO();this._hasPartialFeatures=!0;this.featureLayer._errorHandler(b);this._endCheck(!0)},_finalizeIO:function(){this._purgeRequests();
this._pending--},_endCheck:function(b){if(0===this._pending){this._processIOQueue();var a=this.featureLayer,c=a._trackManager;c&&(c.clearTracks(),c.addFeatures(a.graphics),a._ager&&m.forEach(a.graphics,function(b){b._shape&&a._repaint(b)}),c.moveLatestToFront(),c.drawTracks());this.featureLayer._fireUpdateEnd(b&&Error("FeatureLayer: an error occurred while updating the layer"),this._exceeds?{queryLimitExceeded:!0}:null);if(this._exceeds)a.onQueryLimitExceeded()}},_processIOQueue:function(b){this._ioQueue=
m.filter(this._ioQueue,function(a){return-1<a.fired?!1:!0});b&&m.forEach(this._ioQueue,this._cancelPendingRequest)},_getCurrentCells:function(b){var a=[];b=b||this._cellMap;for(var c in b)if(b.hasOwnProperty(c)){var e=b[c];e&&(e.hasOwnProperty("row")||e.hasOwnProperty("latticeID")?a.push(e):"object"===typeof e&&a.push.apply(a,this._getCurrentCells(e)))}return a},_removeOldCells:function(b){var a=this._cellMap,c=this._gridLayer,e,f;for(e in a)if(a[e]){var g=a[e],d=g.latticeID,h=0,t=0;if(d)h++,d!==
c.getLatticeID(b)&&(this._removeCell(null,null,d),t++);else for(f in g)g[f]&&(h++,c.intersects(g[f].extent,b)||(this._removeCell(e,f),t++));t===h&&delete a[e]}},_updateCell:function(b,a){var c=this.featureLayer,e=c.objectIdField,c=c._selectedFeatures,f,g=a.length;b.features=b.features||[];for(f=0;f<g;f++){var d=a[f],h=d.attributes[e],t=this._addFeatureIIf(h,d);t===d?(this._incRefCount(h),b.features.push(t)):h in c||(t.setGeometry(d.geometry),t.setAttributes(d.attributes))}},_removeCell:function(b,
a,e){var c=this._cellMap,f=this.featureLayer,g=f.objectIdField,d=e?c[e]:c[b]&&c[b][a];if(d)for(e?delete c[e]:delete c[b][a],b=d.features,a=0;a<b.length;a++)e=b[a].attributes[g],this._decRefCount(e),e in f._selectedFeatures||this._removeFeatureIIf(e)}})})},"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/Polyline".split(" "),function(p,f,b,m,l,h,r,n){return p(null,{declaredClass:"esri.layers._GridLayout",
constructor:function(b,e,c,a){this.origin=b;this.cellWidth=e.width;this.cellHeight=e.height;this.mapWidth=c.width;this.mapHeight=c.height;this.srInfo=a},setResolution:function(b){this._resolution=(b.xmax-b.xmin)/this.mapWidth;this.srInfo&&(b=Math.round(Math.round(2*this.srInfo.valid[1]/this._resolution)/this.cellWidth),this._frameStats=[b,0,b-1])},setMapState:function(b,e,c){this.mapWidth=e;this.mapHeight=c;this.setResolution(b)},getCellCoordinates:function(b){var e=this._resolution,c=this.origin;
return{row:Math.floor((c.y-b.y)/(this.cellHeight*e)),col:Math.floor((b.x-c.x)/(this.cellWidth*e))}},normalize:function(b){var e=this._frameStats;if(e){var c=e[0],a=e[1],e=e[2];b<a?(b%=c,b=b<a?b+c:b):b>e&&(b%=c)}return b},intersects:function(f,e){var c=this.srInfo;return c?b.some(e._getParts(c),function(a){return f.intersects(a.extent)}):f.intersects(e)},getCellExtent:function(b,e){var c=this._resolution,a=this.origin,f=this.cellWidth,g=this.cellHeight;return new r(e*f*c+a.x,a.y-(b+1)*g*c,(e+1)*f*
c+a.x,a.y-b*g*c,new h(a.spatialReference.toJson()))},getLatticeID:function(b){var e=this.getCellCoordinates({x:b.xmin,y:b.ymax}),c=this.getCellCoordinates({x:b.xmax,y:b.ymin});b=e.row;var a=c.row,e=this.normalize(e.col),c=this.normalize(c.col);return b+"_"+a+"_"+e+"_"+c},sorter:function(b,e){return b<e?-1:1},getCellsInExtent:function(f,e){var c=this.getCellCoordinates({x:f.xmin,y:f.ymax}),a=this.getCellCoordinates({x:f.xmax,y:f.ymin}),g=c.row,h=a.row,c=c.col,a=a.col,q=[],k,d,l,t=[],m=[],r,p,z,C,B=
[];for(k=g;k<=h;k++)for(d=c;d<=a;d++)l=this.normalize(d),f=this.getCellExtent(k,l),b.some(q,function(a){return a.row===k&&a.col===l})||q.push({row:k,col:l,extent:f,resolution:this._resolution}),e&&(t.push(f.xmin,f.xmax),m.push(f.ymin,f.ymax));c=this.normalize(c);a=this.normalize(a);t.sort(this.sorter);m.sort(this.sorter);d=t.length;for(k=d-1;0<=k;k--)k<d-1&&t[k]===t[k+1]&&t.splice(k,1);d=m.length;for(k=d-1;0<=k;k--)k<d-1&&m[k]===m[k+1]&&m.splice(k,1);if(t.length&&m.length){r=t[0];p=t[t.length-1];
z=m[0];C=m[m.length-1];d=t.length;for(k=0;k<d;k++)B.push([[t[k],C],[t[k],z]]);d=m.length;for(k=0;k<d;k++)B.push([[r,m[k]],[p,m[k]]]);t=new n({paths:B,spatialReference:this.origin.spatialReference.toJson()});q.push({latticeID:g+"_"+h+"_"+c+"_"+a,lattice:t,resolution:this._resolution})}return{minRow:g,maxRow:h,minCol:c,maxCol:a,cells:q}}})})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./RenderMode"],function(p,f,b,m,l){return p([l],
{declaredClass:"esri.layers._SelectionMode",constructor:function(b){this.featureLayer=b;this._featureMap={}},propertyChangeHandler:function(b){this._init&&0===b&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)},hasAllFeatures:function(){return!this.featureLayer._hasPartialSelectedFeatures}})})},"esri/layers/StreamMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../tasks/query ../tasks/QueryTask ../geometry/jsonUtils ./RenderMode".split(" "),
function(p,f,b,m,l,h,r,n,g,e){return p([e],{declaredClass:"esri.layers._StreamMode",constructor:function(b,a){this.featureLayer=b;this._featureMap={};this._setRefreshRate();this._drawBuffer={adds:[],updates:[]};this._timeoutId=null;this._flushDrawBuffer=f.hitch(this,this._flushDrawBuffer);this._featuresByTime={};this._lastEndTimeCheck=null;this._maxFeatureAge=0;b.purgeOptions&&b.purgeOptions.age&&"number"===typeof b.purgeOptions.age&&(this._maxFeatureAge=1E3*Math.ceil(60*b.purgeOptions.age));this._drawFeatures=
f.hitch(this,this._drawFeatures);this._queryErrorHandler=f.hitch(this,this._queryErrorHandler)},startup:function(){},propertyChangeHandler:function(b){this._init&&(0===b?this._applyTimeFilter():3===b?this._redrawAllTracks():console.debug("StreamLayer: Stream Layer only supports changing map time or maximumTrackPoints. Layer id \x3d "+this.featureLayer.id))},destroy:function(){this.inherited(arguments);clearTimeout(this._timeoutId);this._featuresByTime=this._drawBuffer=this._featureMap=null},drawFeature:function(b){var a=
this.featureLayer,c=a.objectIdField;this._timeoutId||(this._timeoutId=setTimeout(this._flushDrawBuffer,this._refreshRate));a._joinField&&this._getFeature(b.attributes[c])?this._drawBuffer.updates.push({oid:b.attributes[c],updates:b}):this._drawBuffer.adds.push(b)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var b=this.featureLayer;b&&(b._relatedUrl||b._keepLatestUrl?(b._fireUpdateStart(),b._refreshing=!0,b.disconnect(),b.clear(),b._relatedQueried=!1,b._keepLatestQueried=!1,
b.connect()):(b._fireUpdateStart(),b.clear(),b._fireUpdateEnd()))},_drawFeatures:function(b,a){this._purgeRequests();var c=this.featureLayer;c._create(b.features||[]);c._fireUpdateEnd(null,a)},_applyTimeFilter:function(b){this.inherited(arguments);this._redrawAllTracks()},_removeFeatures:function(c){var a=this.featureLayer,e=a.objectIdField;c&&b.forEach(c,function(b){b=b.attributes[e];a._unSelectFeatureIIf(b,this);this._decRefCount(b);this._removeFeatureIIf(b)},this)},_addFeatures:function(c){var a=
this.featureLayer,e=a._endTimeField,f=a._startTimeField,g,k,d,h=[],t=[],l=[];g=a._trackManager;k=a.objectIdField;if(g)for(d in c=g.addFeatures(c),c)c.hasOwnProperty(d)&&(h.push(d),c[d].adds&&(t=t.concat(c[d].adds)),c[d].deletes&&(l=l.concat(c[d].deletes)));else t=c;b.forEach(t,function(a){var b=a.attributes[k],c;c=e&&a.attributes[e];!c&&this._maxFeatureAge&&(c=f&&a.attributes[f]?a.attributes[f]+this._maxFeatureAge:Date.now()+this._maxFeatureAge);c&&(c=1E3*Math.ceil(c/1E3),this._featuresByTime[c]?
this._featuresByTime[c].push(b):this._featuresByTime[c]=[b]);this._addFeatureIIf(b,a);this._incRefCount(b)},this);l.length&&this._removeFeatures(l);g&&g.refreshTracks(h)},_updateFeatures:function(c){var a=this.featureLayer,e,f,g=[];e=a._trackManager;f=a._trackIdField;b.forEach(c,function(b){var c=b.updates;b=this._getFeature(b.oid);var k;if(b){c.geometry&&b.setGeometry(c.geometry);c=c.attributes||{};for(k in c)c.hasOwnProperty(k)&&(b.attributes[k]=c[k]);b.setAttributes(b.attributes);b.visible=this._checkFeatureTimeIntersects(b);
e&&b.attributes[f]?g.push(b.attributes[f]):a._repaint(b,null,!0)}},this);g.length&&e.refreshTracks(g)},_redrawAllTracks:function(){var b=this.featureLayer._trackManager,a;b&&(a=b.trimTracks())&&0<a.length&&(this._removeFeatures(a),b.refreshTracks())},_flushDrawBuffer:function(){clearTimeout(this._timeoutId);var b=this._drawBuffer,a=b.adds.splice(0,b.adds.length),e=b.updates.splice(0,b.updates.length),b=this.featureLayer;if(!b)return!1;b.updating||b._fireUpdateStart();this._addFeatures(a);this._updateFeatures(e);
(a=this._getExpiredFeatures())&&a.length&&(this._removeFeatures(a),b._trackManager&&b._trackManager.removeFeatures(a));b._purge();b._fireUpdateEnd();this._timeoutId=null},_clearDrawBuffer:function(){var b=this._timeoutId,a=this._drawBuffer,e=a.adds,a=a.updates;b&&clearTimeout(b);e.splice(0,e.length);a.splice(0,a.length);this._timeoutId=null},_clearTimeBin:function(){this._featuresByTime={};this._lastEndTimeCheck=1E3*Math.ceil(Date.now()/1E3)},_clearFeatureMap:function(){this._featureMap={}},_setRefreshRate:function(b){b=
b||0===b?b:200;0>b&&(b=200);this._refreshRate=b},_checkFeatureTimeIntersects:function(b){var a=this.featureLayer,c=a.getMap();return(c=c?c.timeExtent:null)&&a.timeInfo&&(a.timeInfo.startTimeField||a.timeInfo.endTimeField)?0<a._filterByTime([b],c.startTime,c.endTime).match.length:!0},_getRequestId:function(b){return("_"+b.name+b.layerId+b._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchArchive:function(b){function a(a){m++;f.execute(k).then(function(b){a(null,b)},function(b){a(b)})}function c(b,d){if(b)m>=
p||!e._relatedUrl?y._queryErrorHandler(Error("Could not get features from related feature service")):(z={relatedFeatureWarning:"Querying related feature service using the current filter failed. All related features are displayed, and the filter is applied to the stream service only"},k.where="1\x3d1",a(c));else{var f=y._fixFieldNameCasing(e,d);d.features=f;y._drawFeatures(d,z)}}var e=this.featureLayer,f,k,d,l,t;e._fireUpdateStart();if(b&&this.map){f=new n(b);k=new r;b=this.map;d=e.getFilter()||{};
l=d.where||"1\x3d1";t=d.geometry?g.fromJson(d.geometry):null;d=d.outFields?d.outFields.split(","):["*"];k.geometry=t;k.where=l;k.outFields=d;k.returnGeometry=!0;k.outSpatialReference=new h(b.spatialReference.toJson());e._usePatch&&(b=this._getRequestId(e),this._cancelPendingRequest(null,b));var m=0,p=2,y=this,z=null;a(c)}else return this._fireUpdateEnd({error:"Archive data cannot be fetched if no feature service url is provided or if the layer is not added to a map"}),!1},_queryErrorHandler:function(b){this._purgeRequests();
var a=this.featureLayer;a._errorHandler(b);a._fireUpdateEnd(b)},_fixFieldNameCasing:function(b,a){var c=a.features||[],e=a.fields;if(!e||!c.length)return c;for(var e=this._mapFieldNameDifferences(b.fields,e),f=[],g,d,h=0,t=a.features.length;h<t;h++)g=c[h],d=this._swizzleResponseAttributes(g.attributes,e),f.push({geometry:g.geometry,attributes:d});return f},_mapFieldNameDifferences:function(b,a){var c=[],e={},f,g;f=0;for(g=a.length;f<g;f++)c.push(a[f].name);f=0;for(g=b.length;f<g;f++){var d=b[f].name,
h=this._checkForStreamFieldName(d,c);h&&(e[h]=d)}return e},_checkForStreamFieldName:function(b,a){for(var c=b.toLowerCase(),e,f=0,g=a.length;f<g;f++)if(a[f].toLowerCase()===c){e=a[f];break}return e},_swizzleResponseAttributes:function(b,a){var c={},e;for(e in b)if(b.hasOwnProperty(e)){var f=b[e];a.hasOwnProperty(e)?c[a[e]]=f:c[e]=f}return c},_getExpiredFeatures:function(){var c,a,e,f=[],g=[];if(!this.featureLayer._endTimeField&&!this._maxFeatureAge)return g;c=1E3*Math.floor(this._lastEndTimeCheck/
1E3);this._lastEndTimeCheck=a=1E3*Math.ceil(Date.now()/1E3);if(c&&c!==a)for(e=this._featuresByTime;c<=a;c+=1E3)e[c]&&(f=f.concat(e[c]),delete e[c]);b.forEach(f,function(a){(a=this._getFeature(a))&&g.push(a)},this);return g}})})},"esri/layers/TrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/dom-construct dojox/gfx ../kernel ../graphic ../geometry/Polyline ./GraphicsLayer".split(" "),function(p,f,b,m,l,h,r,n,g,e){var c=-1!==h.renderer.toLowerCase().indexOf("canvas");
return p(null,{declaredClass:"esri.layers._TrackManager",constructor:function(a){this.layer=a;this.trackMap={};this.trackLineMap={}},initialize:function(a){this.map=a;var b=this.layer,g=b._getRenderer(),g=g&&g.trackRenderer;if("esriGeometryPoint"===b.geometryType){var h=this.container=new e._GraphicsLayer({id:b.id+"_tracks",_child:!0,visible:b.visible,minScale:b.minScale,maxScale:b.maxScale});h.loaded=!0;h.onLoad(h);h._setMap(a,b._div);if(!c){a=h._div.getNode();var k=b._div.getNode();a&&k&&l.place(a,
k,"first")}h.setRenderer(g);b.on("visibility-change",f.hitch(this,function(a){this.container.setVisibility(a.visible);this.container.evaluateSuspension()}));b.on("scale-range-change",f.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)}))}},addFeatures:function(a){var c=this.trackMap,e=this.layer,f=e._trackIdField,g=[];b.forEach(a,function(a){var d=a.attributes[f];(c[d]=c[d]||[]).push(a);-1===b.indexOf(g,d)&&g.push(d)});var d=e._startTimeField,h=e.objectIdField,
t=function(a,b){var c=a.attributes[d],e=b.attributes[d];return c===e?a.attributes[h]<b.attributes[h]?-1:1:c<e?-1:1};b.forEach(g,function(a){c[a].sort(t)})},trimTracks:function(a){function c(a){for(a=e[a]||[];a.length>f;)g.push(a.shift())}var e=this.trackMap,f=this.layer.maximumTrackPoints||0,g=[],d;if(!f)return g;if(a)b.forEach(a,function(a){c(a)});else for(d in e)e.hasOwnProperty(d)&&c(d);return g},drawTracks:function(a){function c(a){var b=k[a],c,t,q;t=e.trackLineMap[a];f.remove(t);delete e.trackLineMap[a];
t=null;if(!b||2>b.length)return!1;t=[];for(c=b.length-1;0<=c;c--)(q=b[c].geometry)&&t.push([q.x,q.y]);b={};b[h]=a;1<t.length&&(t=new n(new g({paths:[t],spatialReference:d}),null,b),f.add(t),e.trackLineMap[a]=t)}var e=this,f=this.container,k,d,h,t;if(f)if(k=this.trackMap,d=this.map.spatialReference,h=this.layer._trackIdField,a)b.forEach(a,function(a){c(a)});else for(t in k)k.hasOwnProperty(t)&&c(t)},refreshTracks:function(a){function c(a){var b,c;e.drawTracks([a]);if(d&&d.latestObservationRenderer)for(a=
f[a]||[],b=a.length,c=0;c<b;c++)g._repaint(a[c],null,!0)}var e=this,f=this.trackMap,g=this.layer,d=g._getRenderer(),h;if(a)b.forEach(a,function(a){c(a)});else for(h in f)f.hasOwnProperty(h)&&c(h);this.moveLatestToFront()},moveLatestToFront:function(a){b.forEach(this.getLatestObservations(a),function(a){var b=a._shape;b&&b._moveToFront();this._repaint(a,null,!0)},this.layer)},getLatestObservations:function(a){function c(a){a=g[a];return a[a.length-1]}var e=[],f=this.layer._getRenderer(),g=this.trackMap,
d;if(!f.latestObservationRenderer)return e;if(a)b.forEach(a,function(a){e.push(c(a))});else for(d in g)g.hasOwnProperty(d)&&e.push(c(d));return e},clearTracks:function(a){var c=this.getLatestObservations(a),e=this.container,f;a?b.forEach(a,function(a){delete this.trackMap[a];e&&(f=this.trackLineMap[a],e.remove(f),delete this.trackLineMap[a])},this):(this.trackMap={},this.trackLineMap={},e&&e.clear());b.forEach(c,function(a){this._repaint(a,null,!0)},this.layer)},isLatestObservation:function(a){var b=
this.trackMap[a.attributes[this.layer._trackIdField]];return b?b[b.length-1]===a:!1},destroy:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this.map,this.layer._div));this.map=this.layer=this.trackMap=this.container=null}})})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){function v(){}function q(a){var b=a.layer;return{geometry:a.geometry,attributes:a.attributes,getLayer:function(){return b}}}return p(null,{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(a){this.sourceLayer=a;this._hndls=[]},initialize:function(a){this.map=a;var b=this.sourceLayer,e=b.renderer;b.setDrawMode(!1);this.imageLayer=a._getMapImageLyr();var g=this;this.heatmapRenderer=
e instanceof c?e:(e.getRendererInfoByZoom(a.getZoom())||e.getRendererInfoByScale(a.getScale())).renderer;this._setupDraw=this._setupDraw.bind(this);this.recalculateHeatmap=this.recalculateHeatmap.bind(this);this._removeRenderer=this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);this._reprojectFeature=
this._reprojectFeature.bind(this);l(["../workers/heatmapCalculator"],function(a){g._calculator=new a(f.mixin({width:g.map.width,height:g.map.height},g._getOptions()));g._setupRenderer();g.heatmapRenderer.getStats=a.calculateStats;g.heatmapRenderer.getHistogramData=a.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=this._hndls=null},
_handleRendererChange:function(a){var b=a.renderer,e=b instanceof c;this.heatmapRenderer?e?this.heatmapRenderer=b:this._removeRenderer(a):e&&(this.heatmapRenderer=b,this.sourceLayer&&this.map&&this._setupRenderer())},_handleOpacityChange:function(a){a=a.opacity;var b=this._getImageBySourceId(this.sourceLayer.id);b&&b.setOpacity(a)},_setupRenderer:function(){var a=this._hndls,c=this.sourceLayer,e=this.map,f=this;c._originalDraw=c._draw;c._draw=v;c._div.clear();clearTimeout(this._resetTimer);this._resetTimer=
setTimeout(this._resetGraphics.bind(this),250);a.push(c.on("update-end",this._setupDraw));a.push(c.on("suspend",function(a){(a=f._getImageBySourceId(f.sourceLayer.id))&&a.hide()}));a.push(c.on("resume",function(a){(a=f._getImageBySourceId(f.sourceLayer.id))&&a.show()}));a.push(b.after(c,"redraw",this._setupDraw));a.push(e.on("layer-remove",function(a){a.layer==c&&((a=f._getImageBySourceId(f.sourceLayer.id))&&f.imageLayer.removeImage(a),f._removeRenderer({target:c}))}));c._collection&&a.push(c.on("graphic-add",
function(a){f._reprojectFeature(a.graphic);f._setupDraw()}));1!==c.mode&&(a.push(e.on("resize, pan-end",this._setupDraw)),a.push(e.on("zoom-end",this._setupDraw)));a.push(c.on("opacity-change",this._handleOpacityChange));this.imageLayer.suspended&&this.imageLayer.resume();c.graphics&&c.graphics.length&&(c.graphics[0].geometry&&!e.spatialReference.equals(c.graphics[0].geometry.spatialReference)&&m.forEach(c.graphics,function(a){this._reprojectFeature(a)}.bind(this)),this._setupDraw())},_setupDraw:function(){if(!this._drawTimer){var a=
this;this._drawTimer=setTimeout(function(){clearTimeout(a._drawTimer);a._drawTimer=null;a.sourceLayer._getRenderer().isInstanceOf(c)&&a.recalculateHeatmap()},16)}},_removeRenderer:function(a){var b=a.target;b._draw=b._originalDraw;delete b._originalDraw;b.setDrawMode(!0);this._removeHandlers();this._hndls=[];var c=this._getImageBySourceId(this.sourceLayer.id);c&&this.imageLayer.removeImage(c);clearTimeout(this._drawTimer);clearTimeout(this._resetTimer);this._drawTimer=this._resetTimer=null;b.renderer!=
a.renderer&&b.renderer.getRendererInfo?this.heatmapRenderer=null:(b.redraw(),this.destroy())},recalculateHeatmap:function(){this._calculator?this._doMainCalculation():this._calculatorClient&&this._doWorkerCalculation()},_reprojectFeature:function(a){if(a&&a.geometry){var b=a.geometry,c=this.map.spatialReference;c.equals(b.spatialReference)||(b=g.project(b,c),null==b?console.log("Unable to reproject features to map's spatial reference. Please convert feature geometry before adding to layer"):a.geometry=
b)}},_doWorkerCalculation:function(){},_doMainCalculation:function(){var b=this.sourceLayer,c=this.map,g=this.heatmapRenderer,h=this.map.extent,l=this.map.width,n=this.map.height,m=this._calculator,u=this,v=function(a){a=u._getScreenPoints(a.features,c,b);a=m.calculateImageData(f.mixin({screenPoints:a,mapinfo:{extent:[h.xmin,h.ymin,h.xmax,h.ymax],resolution:c.getResolution()},width:l,height:n},u._getOptions()));a=g.getSymbol(q({geometry:c.extent,attributes:{size:[l,n],imageData:a},layer:b}));a=new e({extent:c.extent,
href:a.url,opacity:0,sourceId:b.id});u._swapMapImages(a,u._getImageBySourceId(b.id));b.suspended&&a.hide()},r={geometry:c.extent,timeExtent:b.useMapTime?c.timeExtent:void 0,spatialRelationship:a.SPATIAL_REL_INTERSECTS};null!=b._canDoClientSideQuery(r)?b.queryFeatures(r,v):v({features:b.graphics})},_getScreenPoints:function(a,b,c){var d=[],e=a.length,f=0,g=0,k,h=new n(b.extent.xmin,b.extent.ymax,b.spatialReference),q=b.toScreen(h),l=q.x,q=q.y,u=b.getResolution(),v;for((g=b.extent.getCacheValue("_parts"))&&
(v=m.map(g,function(a){return c._intersects(b,a.extent)[0]}));e--;)g=a[e],g.geometry&&(k={x:Math.ceil((g.geometry.x-h.x)/u+l),y:Math.floor((h.y-g.geometry.y)/u-q),attributes:g.attributes},v&&(g=1<v.length&&k.x<-v[0]?v[1]:v[0],k.x+=g),d[f++]=k);return d},_getImageBySourceId:function(a){var b=this.imageLayer.getImages(),b=m.filter(b,function(b){return b.sourceId==a});if(b.length)return b[b.length-1]},_swapMapImages:function(a,b){function c(){d.removeImage(b)}var d=this.imageLayer,e=this.sourceLayer.opacity;
d.addImage(a);u.anim(a._node,{opacity:e},null,null,function(){a.opacity=e});null!=b&&u.anim(b._node,{opacity:0},null,null,c)},_removeHandlers:function(){if(null!=this._hndls)for(var a=this._hndls.length;a--;)this._hndls[a].remove()},_getOptions:function(){var a=this.heatmapRenderer;return{blurRadius:a.blurRadius,gradient:a.gradient,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity,field:a.field,fieldOffset:a.fieldOffset}},_resetGraphics:function(){clearTimeout(this._resetTimer);
this._resetTimer=null;for(var a=this.sourceLayer.graphics,b=a.length,c;b--;)c=a[b],c._shape=c._offsets=void 0}})})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),function(p,f,b,m,l,h,r){return p(null,{declaredClass:"esri.layers.MapImage",constructor:function(b){f.mixin(this,b);this.extent=new r(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},getNode:function(){return this._node},
show:function(){if(!this.visible){this.visible=!0;var b=this._node,f=this._layer,e;if(b){if(e=f&&f._div)f.suspended||f._setPos(b,e._left,e._top),(f._active||e).appendChild(b);h.show(b)}}},hide:function(){if(this.visible){this.visible=!1;var b=this._node;b&&(h.hide(b),b.parentNode&&b.parentNode.removeChild(b))}},setOpacity:function(f){var g=this._node;this.opacity=f;g&&b.set(g,"opacity",f)}})})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),
function(p,f,b,m,l,h,r,n){return p(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var f=b.map(this.geometries,function(b){return b.toJson()}),e={};e.outSR=this.outSR.wkid||m.toJson(this.outSR.toJson());e.inSR=this.geometries[0].spatialReference.wkid||m.toJson(this.geometries[0].spatialReference.toJson());e.geometries=m.toJson({geometryType:n.getJsonType(this.geometries[0]),geometries:f});this.transformation&&
(e.transformation=this.transformation.wkid||m.toJson(this.transformation));r.isDefined(this.transformForward)&&(e.transformForward=this.transformForward);return e}})})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang","jimu/shared/basePortalUrlUtils"],function(p,f){var b=p.clone(f);b.declaredClass="jimu.portalUrlUtils";b.getPortalUrlFromLocation=function(){return b.getPortalServerFromLocation()+b.getDeployContextFromLocation()};b.getPortalSignInUrlFromLocation=function(){var f=b.getPortalUrlFromLocation();
return b.setHttpsProtocol(f+"home/signin.html")};b.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};b.getDeployContextFromLocation=function(){var b=window.location.href.split("?")[0],f=b.indexOf("/home");0>f&&(f=b.indexOf("/apps"));b=b.substring(b.indexOf(window.location.host)+window.location.host.length+1,f);"/"!==b&&(b="/"+b+"/");return b};b.getRestBaseUrlFromLocation=function(){return window.location.protocol+"//"+window.location.host+b.getDeployContextFromLocation()+
"sharing/rest/"};return b})},"jimu/shared/basePortalUrlUtils":function(){define(function(){var p={declaredClass:"jimu.shared.basePortalUrlUtils"};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s*/gi,"").replace(/\s*$/gi,"")});"function"!==typeof String.prototype.startWith&&(String.prototype.startWith=function(f){return this.substr(0,f.length)===f});"function"!==typeof String.prototype.endWith&&(String.prototype.endWith=function(f){return this.substr(this.length-
f.length,f.length)===f});p.getServerByUrl=function(f){f=(f||"").trim();f=f.replace(/^(http(s?):?)\/\//gi,"");0===f.indexOf("//")&&(f=f.slice(2));return f.split("/")[0]};p.getServerWithProtocol=function(f){var b="";if(f=(f||"").trim()){var m=p.getServerByUrl(f);if(!m)return b;var l=p.getProtocol(f);l?b=l+"://"+m:0===f.indexOf("//")&&(b="//"+m)}return b};p.isSameServer=function(f,b){f=p.getServerByUrl(f)||"";b=p.getServerByUrl(b)||"";return f.toLowerCase()===b.toLowerCase()};p.getDomain=function(f){var b=
"";if(f=p.getServerByUrl(f))f=f.replace(/:\d+$/,""),f=f.match(/[^.]\w+\.\w+$/),null!==f&&(b=f[0],/^\d+\.\d+$/.test(b)&&(b=""));return b};p.isSameDomain=function(f,b){var m=p.getDomain(f),l=p.getDomain(b);return""!==m&&m===l};p.isOrgOnline=function(f){return 0<=p.getServerByUrl(f).toLowerCase().indexOf(".maps.arcgis.com")};p.isOnline=function(f){return 0<=p.getServerByUrl(f).toLowerCase().indexOf(".arcgis.com")};p.isArcGIScom=function(f){f=p.getServerByUrl(f).toLowerCase();return"www.arcgis.com"===
f||"arcgis.com"===f};p.getStandardPortalUrl=function(f){var b=p.getServerByUrl(f);if(""===b)return"";p.isOnline(b)?(p.isArcGIScom(b)&&(b="www.arcgis.com"),f=p.addProtocol(f),f=p.getProtocol(f)+"://"+b):(f=(f||"").trim().replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),f=p.addProtocol(f),f.replace(new RegExp("http(s?)://"+b,"g"),"")||(f+="/arcgis"));return f};p.isSamePortalUrl=function(f,b){var m=/^http(s?):\/\//gi,l=/^\/\//gi;f=p.getStandardPortalUrl(f).toLowerCase().replace(m,"").replace(l,"");b=
p.getStandardPortalUrl(b).toLowerCase().replace(m,"").replace(l,"");return f===b};p.addProtocol=function(f){if(-1>=f.toLowerCase().indexOf("http://")&&-1>=f.toLowerCase().indexOf("https://")){var b="";"undefined"!==typeof window&&window.location?(b=window.location.protocol,f=f.startWith("//")?b+f:f.startWith("/")?b+"//"+window.location.host+f:b+"//"+f):(b="http:",f=f.startWith("//")?b+f:b+"//"+f)}return f};p.getProtocol=function(f){var b="";f=f.toLowerCase();0===f.indexOf("https://")?b="https":0===
f.indexOf("http://")&&(b="http");return b};p.updateUrlProtocolByOtherUrl=function(f,b){b=b.toLowerCase();0===b.indexOf("https://")?f=p.setHttpsProtocol(f):0===b.indexOf("http://")&&(f=p.setHttpProtocol(f));return f};p.removeProtocol=function(f){return f.replace(/^http(s?):\/\//i,"//")};p.setHttpProtocol=function(f){f=p.addProtocol(f);return f.replace(/^https:\/\//,"http://")};p.setHttpsProtocol=function(f){f=p.addProtocol(f);return f.replace(/^http:\/\//,"https://")};p.setProtocol=function(f,b){return 0<=
b.indexOf("https")?p.setHttpsProtocol(f):0<=b.indexOf("http")?p.setHttpProtocol(f):f};p.getSharingUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/sharing/rest");return b};p.getOAuth2Url=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/sharing/rest/oauth2");return b};p.getAppIdUrl=function(f,b){var m="",l=p.getStandardPortalUrl(f);l&&(m=l+"/sharing/rest/oauth2/apps/"+b);return m};p.getSignInUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/home/signin.html");return b};
p.getBaseSearchUrl=function(f){var b="";f=p.getStandardPortalUrl(f);(f=f.replace(/\/*$/g,""))&&(b=f+"/sharing/rest/search");return b};p.getBaseItemUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/sharing/rest/content/items");return b};p.getItemUrl=function(f,b){var m="",l=p.getBaseItemUrl(f);l&&b&&(m=l+"/"+b);return m};p.getItemDataUrl=function(f,b){var m="",l=p.getItemUrl(f,b);l&&(m=l+"/data");return m};p.getItemGroupsUrl=function(f,b){var m="",l=p.getItemUrl(f,b);l&&(m=l+"/groups");
return m};p.getGenerateTokenUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/sharing/generateToken");return b};p.getItemDetailsPageUrl=function(f,b){var m="";f&&b&&(f=p.getStandardPortalUrl(f),m=f+"/home/item.html?id\x3d"+b);return m};p.getUserProfilePageUrl=function(f,b){var m="";f&&b&&(f=p.getStandardPortalUrl(f),m=f+"/home/user.html?user\x3d"+b);return m};p.getBaseGroupUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/sharing/rest/community/groups");return b};p.getPortalSelfInfoUrl=
function(f){var b="";(f=p.getStandardPortalUrl(f||""))&&(b=f+"/sharing/rest/portals/self");return b};p.getCommunitySelfUrl=function(f){var b="";(f=p.getStandardPortalUrl(f||""))&&(b=f+"/sharing/rest/community/self");return b};p.getBaseUserUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/sharing/rest/community/users");return b};p.getUserUrl=function(f,b){var m="",l=p.getBaseUserUrl(f);f&&b&&(m=l+"/"+b);return m};p.getUserTagsUrl=function(f,b){var m="",l=p.getUserUrl(f,b);f&&b&&(m=l+"/tags");
return m};p.getUserThumbnailUrl=function(f,b,m){var l="";(f=p.getUserUrl(f,b))&&m&&(l=f+"/info/"+m);return l};p.getContentUrl=function(f){var b="";f&&(f=p.getStandardPortalUrl(f),b=f+"/sharing/rest/content");return b};p.getUserContentUrl=function(f,b,m){var l="",l="";f&&b&&(l=p.getContentUrl(f),l=m?l+"/users/"+b+"/"+m:l+"/users/"+b);return l};p.getAddItemUrl=function(f,b,m){var l="",l="";f&&b&&(l=p.getUserContentUrl(f,b,m),l+="/addItem");return l};p.getDeleteItemUrl=function(f,b,m){var l="";(f=p.getUserItemsUrl(f,
b))&&(l=f+"/"+m+"/delete");return l};p.getUserItemsUrl=function(f,b,m){var l="",l="";f&&b&&(l=p.getUserContentUrl(f,b,m),l+="/items");return l};p.getUpdateItemUrl=function(f,b,m,l){var h="",h="";f&&b&&(h=p.getUserItemsUrl(f,b,l),h=h+"/"+m+"/update");return h};p.shareItemUrl=function(f,b,m,l){var h="",h="";f&&b&&(h=p.getUserItemsUrl(f,b,l),h=h+"/"+m+"/share");return h};p.getHomeIndexUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/home/index.html");return b};p.getHomeMapViewerUrl=function(f,
b){var m="",l=p.getStandardPortalUrl(f);l&&(m=l+"/home/webmap/viewer.html",m=b?m+("?webmap\x3d"+b):m+"?useExisting\x3d1");return m};p.getHomeSceneViewerUrl=function(f,b){var m="",l=p.getStandardPortalUrl(f);l&&(m=l+"/home/webscene/viewer.html",b&&(m+="?webscene\x3d"+b));return m};p.getHomeGalleryUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/home/gallery.html");return b};p.getHomeGroupsUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/home/groups.html");return b};p.getHomeMyContentUrl=
function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/home/content.html");return b};p.getHomeMyOrganizationUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/home/organization.html");return b};p.getHomeUserUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/home/user.html");return b};p.getPortalHelpUrl=function(f,b){var m="",l=p.getStandardPortalUrl(f);l&&(m=l+"/portalhelp/"+(b||"en")+"/website/help/");return m};p.getPortalAdminHelpUrl=function(f,b){var m="",l=p.getStandardPortalUrl(f);
l&&(m=l+"/portalhelp/"+(b||"en")+"/admin/help/");return m};p.getPortalProxyUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/sharing/proxy");return b};p.getOAuth2SignOutUrl=function(f){var b="";(f=p.getStandardPortalUrl(f))&&(b=f+"/sharing/rest/oauth2/signout");return b};p.getNewPrintUrl=function(f){var b="";if(f=p.getStandardPortalUrl(f))f=p.setHttpProtocol(f),b=f+"/sharing/tools/newPrint";return b};p.getSwitchAccoutnsUrl=function(f,b,m){var l="";if(f=p.getStandardPortalUrl(f))l=f+"/home/pages/Account/manage_accounts.html#client_id\x3d"+
b,m&&(l+="\x26redirect_uri\x3d"+m);l&&(l=p.setHttpsProtocol(l));return l};return p})},"jimu/shared/utils":function(){define(["./basePortalUrlUtils"],function(p){function f(b,f){function h(f,g){var e,c,a,h,l="widgetOnScreen"===f;if(b[f]){if(b[f].groups)for(e=0;e<b[f].groups.length;e++)if(a=b[f].groups[e],g(a,{index:e,isWidget:!1,groupId:a.id,isThemeWidget:!1,isOnScreen:l}),b[f].groups[e].widgets)for(c=0;c<b[f].groups[e].widgets.length;c++)h=b[f].groups[e].widgets[c],g(h,{index:c,isWidget:!0,groupId:a.id,
isThemeWidget:h.uri&&-1<h.uri.indexOf("themes/"+b.theme.name),isOnScreen:l});if(b[f].widgets)for(e=0;e<b[f].widgets.length;e++)h=b[f].widgets[e],g(b[f].widgets[e],{index:e,isWidget:!0,groupId:f,isThemeWidget:h.uri&&-1<h.uri.indexOf("themes/"+b.theme.name),isOnScreen:l})}}h("widgetOnScreen",f);h("widgetPool",f)}var b={},m="inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwitched isController hasVersionManager isThemeWidget supportMultiInstance".split(" ");
b.visitElement=f;b.getConfigElementById=function(b,h){var l;if("map"===h)return b.map;f(b,function(b){if(b.id===h)return l=b,!0});return l};b.getConfigElementByLabel=function(b,h){var l;if("map"===h)return b.map;f(b,function(b){if(b.label||b.name===h)return l=b,!0});return l};b.getConfigElementsByName=function(b,h){var l=[];if("map"===h)return[b.map];f(b,function(b){b.name===h&&l.push(b)});return l};b.getWidgetNameFromUri=function(b){b=b.split("/");b.pop();return b.pop()};b.getAmdFolderFromUri=function(b){b=
b.split("/");b.pop();return b.join("/")+"/"};b.widgetProperties=m;b.processWidgetProperties=function(b){"undefined"===typeof b.properties.isController&&(b.properties.isController=!1);"undefined"===typeof b.properties.isThemeWidget&&(b.properties.isThemeWidget=!1);"undefined"===typeof b.properties.hasVersionManager&&(b.properties.hasVersionManager=!1);m.forEach(function(f){"undefined"===typeof b.properties[f]&&(b.properties[f]=!0)})};b.getControllerWidgets=function(b){var f=[];b.visitElement(function(b){b.isController&&
f.push(b)});return f};b.addI18NLabelToManifest=function(b,f,m){function h(c,a){a[g]&&(b.i18nLabels[c]=a[g]);"theme"===b.category&&(b.layouts&&b.layouts.forEach(function(e){b["i18nLabels_layout_"+e.name]||(b["i18nLabels_layout_"+e.name]={});b["i18nLabels_layout_"+e.name][c]=a["_layout_"+e.name]}),b.styles&&b.styles.forEach(function(e){b["i18nLabels_style_"+e.name]||(b["i18nLabels_style_"+e.name]={});b["i18nLabels_style_"+e.name][c]=a["_style_"+e.name]}));"widget"===b.category&&b.featureActions&&b.featureActions.forEach(function(e){b["i18nLabels_featureAction_"+
e.name]||(b["i18nLabels_featureAction_"+e.name]={});b["i18nLabels_featureAction_"+e.name][c]=a["_featureAction_"+e.name]})}b.i18nLabels={};var g="widget"===b.category?"_widgetLabel":"_themeLabel";f&&f.root&&f.root[g]&&(b.i18nLabels.defaultLabel=f.root[g],"theme"===b.category&&(b.layouts&&b.layouts.forEach(function(c){b["i18nLabels_layout_"+c.name]={};b["i18nLabels_layout_"+c.name].defaultLabel=f.root["_layout_"+c.name]}),b.styles&&b.styles.forEach(function(c){b["i18nLabels_style_"+c.name]={};b["i18nLabels_style_"+
c.name].defaultLabel=f.root["_style_"+c.name]})),"widget"===b.category&&b.featureActions&&b.featureActions.forEach(function(c){b["i18nLabels_featureAction_"+c.name]={};b["i18nLabels_featureAction_"+c.name].defaultLabel=f.root["_featureAction_"+c.name]}));for(var e in m)h(e,m[e])};b.isHostedService=function(b){var f=p.getServerByUrl(b);return(new RegExp(f+"/[^/]+/[^/]+/rest/services","gi")).test(b)};return b})},"jimu/portalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic dojo/json esri/request ./Role ./utils ./portalUrlUtils ./tokenUtils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){var u=p([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,constructor:function(a){this.portalUrl=c.getStandardPortalUrl(a);this.selfUrl=c.getPortalSelfInfoUrl(a)},loadSelfInfo:function(){var a=new l,b={url:this.selfUrl,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0};this.isValidCredential()&&(b.content.token=this.credential.token);n(b).then(f.hitch(this,function(b){var c=b.user;delete b.user;
f.mixin(this,b);b.user=c;a.resolve(b)}),f.hitch(this,function(b){console.error(b);a.reject(b)}));return a},_checkCredential:function(){var b=a.isValidCredential(this.credential);b||this.clearCredentialAndUser();return b},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=a.getPortalCredential(this.portalUrl))},signIn:function(){var b=new l;this.updateCredential();this.isValidCredential()?setTimeout(f.hitch(this,
function(){b.resolve(this.credential)}),0):b=a.signInPortal(this.portalUrl);return b},haveSignIn:function(){return a.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var b=new l;this.user&&"jimu.PortalUser"===this.user.declaredClass?setTimeout(f.hitch(this,function(){this.user.updateCredential();b.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(f.hitch(this,
function(a){this.user=a;b.resolve(this.user)}),f.hitch(this,function(a){console.error(a);b.reject(a)})):a.getUserIdByToken(this.credential.token,this.portalUrl).then(f.hitch(this,function(a){this.credential.userId=a;this._getUser(this.credential.userId).then(f.hitch(this,function(a){this.user=a;b.resolve(this.user)}),f.hitch(this,function(a){console.error(a);b.reject(a)}))}),f.hitch(this,function(a){console.error(a);b.reject(a)})):setTimeout(f.hitch(this,function(){b.reject("credential is null.")}),
0);return b},queryItems:function(a){this.updateCredential();var d=new l,e=c.getBaseSearchUrl(this.portalUrl),g={f:"json"};a&&(g=f.mixin(g,a));this.isValidCredential()&&(g.token=this.credential.token);g.sortField||g.sortOrder||(g.sortField="title",g.sortOrder="asc");n({url:e,handleAs:"json",content:g,callbackParamName:"callback"}).then(f.hitch(this,function(a){a.results=b.map(a.results,f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new k(a)}));
d.resolve(a)}),f.hitch(this,function(a){console.error(a);d.reject(a)}));return d},getItemData:function(a){this.updateCredential();a={url:c.getItemDataUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};return n(a)},_getItemById:function(a,b){var d={url:c.getItemUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};b&&(d.content.token=b);return n(d).then(f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;
a.portal=this;return new k(a)}))},getItemById:function(a,b){this.updateCredential();return this._getItemById(a).then(f.hitch(this,function(c){return b&&c.owner&&this.isValidCredential()&&this.credential&&this.credential.userId===c.owner?this._getItemById(a,this.credential.token):c}))},getAppById:function(a){var b=new l;this.updateCredential();this.isValidCredential()?(a=c.getAppIdUrl(this.portalUrl,a),b=n({url:a,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(f.hitch(this,
function(){b.reject("token is null.")}),0);return b},queryGroups:function(a){this.updateCredential();var d=new l,e=c.getBaseGroupUrl(this.portalUrl),g={f:"json"};a&&(g=f.mixin(g,a));this.isValidCredential()&&(g.token=this.credential.token);n({url:e,handleAs:"json",content:g,callbackParamName:"callback"}).then(f.hitch(this,function(a){a.results=b.map(a.results,f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new q(a)}));d.resolve(a)}),f.hitch(this,
function(a){console.error(a);d.reject(a)}));return d},registerApp:function(a,b,d){var e=new l;this.updateCredential();if(this.isValidCredential())var g=this.credential&&this.credential.token,k=c.getOAuth2Url(this.portalUrl),e=n({url:k+"/registerApp",content:{itemId:a,appType:b,redirect_uris:r.stringify(d),token:g,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(f.hitch(this,function(){e.reject("token is null.")}),0);return e},createAndRegisterApp:function(a){var b=new l;this.updateCredential();
this.isValidCredential()?this.getUser().then(f.hitch(this,function(c){c.addItem({title:"Web AppBuilder for ArcGIS",type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(f.hitch(this,function(c){c.success?this.registerApp(c.id,"browser",a).then(f.hitch(this,function(a){b.resolve(a)}),f.hitch(this,function(a){console.error(a);b.reject(a)})):b.reject("create app failed")}),f.hitch(this,function(a){console.error(a);b.reject(a)}))}),f.hitch(this,function(a){console.error(a);
b.reject(a)})):setTimeout(f.hitch(this,function(){b.reject("token is null.")}),0);return b},_getUser:function(a){this.updateCredential();var b=new l;a={url:c.getUserUrl(this.portalUrl,a),content:{f:"json"},handleAs:"json",callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential&&this.credential.token);n(a).then(f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;this.user=new v(a);b.resolve(this.user)}),f.hitch(this,function(a){console.error(a);
b.reject(a)}));return b}}),v=p([],{declaredClass:"jimu.PortalUser",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&f.mixin(this,a)},_checkCredential:function(){var b=a.isValidCredential(this.credential);b||(this.credential=null);return b},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},canCreateItem:function(){var a=
new g({id:this.roleId?this.roleId:this.role,role:this.role});this.privileges&&a.setPrivileges(this.privileges);return a.canCreateItem()},getGroups:function(){var a=[];this.groups&&(a=b.map(this.groups,f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this.portal;return new q(a)})));return a},getItemsByKeywords:function(a,b){return this.portal.queryItems({start:b||1,num:100,q:"owner:"+this.username+' AND typekeywords:"'+a+'"'})},getContent:function(){this.updateCredential();
var a={url:c.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential&&(a.content.token=this.credential.token);return n(a)},getTags:function(){this.updateCredential();var a={url:c.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return n(a)},addItem:function(a,b){this.updateCredential();var d=new l;
if(this.isValidCredential()){var e={f:"json",token:this.credential.token};a&&(e=f.mixin(e,a));n({url:c.getAddItemUrl(this.portalUrl,this.username,b),handleAs:"json",callbackParamName:"callback",content:e},{usePost:!0}).then(f.hitch(this,function(a){d.resolve(a)}),f.hitch(this,function(a){console.error(a);d.reject(a)}))}else setTimeout(f.hitch(this,function(){d.reject("token is null.")}),0);return d},deleteItem:function(a){this.updateCredential();var b=new l;this.isValidCredential()?(a=c.getDeleteItemUrl(this.portalUrl,
this.username,a),b=n({url:a,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(f.hitch(this,function(){b.reject("token is null.")}),0);return b},getItemById:function(a,b){this.updateCredential();var d=new l,e={url:c.getUserItemsUrl(this.portalUrl,this.username,b)+"/"+a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};n(e).then(f.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new k(a);d.resolve(a)}),
f.hitch(this,function(a){console.error(a);d.reject(a)}));return d},shareItem:function(a,b,d){this.updateCredential();var e=new l;this.isValidCredential()?(b={url:c.shareItemUrl(this.portalUrl,this.username,b,d),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},a&&(b.content=f.mixin(b.content,a)),n(b,{usePost:!0}).then(f.hitch(this,function(a){e.resolve(a)}),f.hitch(this,function(a){console.error(a);e.reject(a)}))):setTimeout(f.hitch(this,function(){e.reject("token is null.")}),
0);return e},updateItem:function(a,b){this.updateCredential();var d=new l;this.isValidCredential()?this.portal.getItemById(a).then(f.hitch(this,function(e){var g={f:"json",token:this.credential.token};b&&(g=f.mixin(g,b));n({url:c.getUpdateItemUrl(this.portalUrl,e.owner,a,e.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:g},{usePost:!0}).then(f.hitch(this,function(a){d.resolve(a)}),f.hitch(this,function(a){console.error(a);d.reject(a)}))}),f.hitch(this,function(a){console.error(a);
d.reject(a)})):setTimeout(f.hitch(this,function(){d.reject("token is null.")}),0);return d},isAdminRole:function(){return"org_admin"===this.role||"account_admin"===this.role},isPublisherRole:function(){return"org_publisher"===this.role||"account_publisher"===this.role},isUserRole:function(){return"org_user"===this.role||"account_user"===this.role}}),q=p([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&f.mixin(this,a)},_checkCredential:function(){var b=
a.isValidCredential(this.credential);b||(this.credential=null);return b},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),k=p([],{declaredClass:"jimu.PortalItem",itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,portal:null,
token:null,constructor:function(a){a&&f.mixin(this,a);this.itemUrl=c.getItemUrl(this.portalUrl,this.id);!this.thumbnailUrl&&this.thumbnail&&this.itemUrl&&(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=c.getItemDetailsPageUrl(this.portalUrl,this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=c.getUserProfilePageUrl(this.portalUrl,
this.owner))},_checkCredential:function(){var b=a.isValidCredential(this.credential);b||(this.credential=null);return b},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)},getItemGroups:function(){this.updateCredential();var a={url:c.getItemGroupsUrl(this.portalUrl,this.id),handleAs:"json",
content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return n(a)}}),d={portals:[],webMapQueryStr:" "+e.getItemQueryStringByTypes(["Web Map"])+" ",webSceneQueryStr:" "+e.getItemQueryStringByTypes(["Web Scene"])+" ",_findPortal:function(a){for(var b=0;b<this.portals.length;b++){var d=this.portals[b];if(c.isSamePortalUrl(a,d.portalUrl))return d.updateCredential(),d}return null},getPortal:function(b){if(!b||"string"!==typeof b||!f.trim(b))return null;
b=c.getStandardPortalUrl(b);var d=this._findPortal(b);d||(d=new u(b),d.credential=a.getPortalCredential(d.portalUrl),d.updateCredential(),this.portals.push(d));return d},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},getUnits:function(a){var b="english",c="",d=new l;this.getPortal(a).getUser().then(f.hitch(this,
function(a){a&&a.units?b=a.units:(c=m.locale,b=c.startWith("en")?"english":"metric");d.resolve(b)}),f.hitch(this,function(e){console.warn(e);this.getPortalSelfInfo(a).then(f.hitch(this,function(a){var b=null;a&&a.units?b=a.units:(c=a&&a.culture||m.locale,b=c.startWith("en")?"english":"metric");d.resolve(b)}),f.hitch(this,function(a){console.warn(a);c=m.locale;b=c.startWith("en")?"english":"metric";d.resolve(b)}))}));return d.promise},_getPortalSelfGroup:function(a,b){var c=new l,d=this.getPortal(a);
d||setTimeout(f.hitch(this,function(){c.reject()}),0);this.getPortalSelfInfo(a).then(f.hitch(this,function(a){d.queryGroups({f:"json",q:a[b]}).then(f.hitch(this,function(a){0<a.results.length?(a=a.results[0],a.portalUrl=d.portalUrl,a.credential=d.credential,a.portal=d,a=new q(a),c.resolve(a)):c.reject("Can't find portal self group.")}),f.hitch(this,function(a){console.error(a);c.reject(a)}))}),f.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getWebMapsFromBasemapGalleryGroup:function(a){var b=
new l;this.getBasemapGalleryGroup(a).then(f.hitch(this,function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(f.hitch(this,function(a){b.resolve(a)}),f.hitch(this,function(a){console.error(a);b.reject(a)})):b.reject()}),f.hitch(this,function(a){console.error(a);b.reject(a)}));return b},getDefaultWebScene:function(a){var d=c.getStandardPortalUrl(a);return this._searchWABDefaultWebScene(d).then(f.hitch(this,function(a){return a?a:this._createWABDefaultWebScene(d).then(f.hitch(this,
function(a){return this.getPortal(d).getUser().then(f.hitch(this,function(c){var d=!1;c&&c.privileges&&0<c.privileges.length&&(d=b.some(c.privileges,function(a){return 0<=a.indexOf("shareToPublic")}));return d?c.shareItem({everyone:!0},a).then(f.hitch(this,function(){return a}),f.hitch(this,function(){return a})):a}),f.hitch(this,function(b){console.error(b);return a}))}))}))},_searchWABDefaultWebScene:function(a){var b=new l;a=c.getStandardPortalUrl(a);this.getPortal(a).queryItems({q:'typekeywords:"WABDefaultWebScene" access:public '+
this.webSceneQueryStr}).then(f.hitch(this,function(a){a&&a.results&&0<a.results.length?b.resolve(a.results[0].id):b.resolve(null)}),f.hitch(this,function(a){console.error("_searchWABDefaultWebScene error:",a);b.reject(a)}));return b},_createWABDefaultWebScene:function(a){var b=new l;a=c.getStandardPortalUrl(a);this.getPortal(a).getUser().then(f.hitch(this,function(a){var c={title:"Default Web Scene",type:"Web Scene",typeKeywords:"WABDefaultWebScene",tags:"default",text:r.stringify({operationalLayers:[],
baseMap:{id:"151b431fe65-basemap-0",title:"Topographic",baseMapLayers:[{id:"defaultBasemap",url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer"}],elevationLayers:[{id:"globalElevation",url:"http://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}]},version:"1.3",authoringApp:"WebSceneViewer",authoringAppVersion:"3.10.0.0",spatialReference:{wkid:102100,
latestWkid:3857},viewingMode:"global",initialState:{viewpoint:{scale:4.5188197847224146E7,rotation:0,targetGeometry:{x:144770.99872895706,y:3232837.215000455,spatialReference:{wkid:102100,latestWkid:3857},z:-127.7412482528016},camera:{position:{x:144770.99767624016,y:3182557.105058348,spatialReference:{wkid:102100,latestWkid:3857},z:2.551254800000001E7},heading:0,tilt:.0999986601088944}},environment:{lighting:{datetime:1426420488E3,displayUTCOffset:0}}},presentation:{slides:[]}}),snippet:""};a.addItem(c,
"").then(f.hitch(this,function(a){a.success?b.resolve(a.id):(console.error("Can't create default web scene:",a),b.reject())}))}),f.hitch(this,function(a){console.error("Can't create default web scene");b.reject(a)}));return b},getDefaultWebMap:function(a){var b=new l;this.getPortalSelfInfo(a).then(f.hitch(this,function(c){var d=c.defaultBasemap&&c.defaultBasemap.id;d?b.resolve(d):this._getDefaultWebMapByBasemapGallery(a,c).then(f.hitch(this,function(c){c?b.resolve(c):this._getMostNumViewsWebMap(a).then(f.hitch(this,
function(a){a?b.resolve(a):b.reject()}),f.hitch(this,function(a){console.error(a);b.reject(a)}))}),f.hitch(this,function(a){console.error(a);b.reject(a)}))}),f.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_getDefaultWebMapByBasemapGallery:function(a,c){var d=new l,e=this.getPortal(a),g=c.defaultBasemap&&c.defaultBasemap.title;e.queryGroups({f:"json",q:c.basemapGalleryGroupQuery}).then(f.hitch(this,function(a){a=a.results;0<a.length?e.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+
" AND group:"+a[0].id+" AND title:"+g}).then(f.hitch(this,function(a){a=a.results;a=b.filter(a,f.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?d.resolve(a[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),e.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+g}).then(f.hitch(this,function(a){a=a.results;a=b.filter(a,f.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));if(0<a.length){var c=a[0];
e.getItemData(c.id).then(f.hitch(this,function(a){a&&(a.operationalLayers||a.baseMap||a.version)?d.resolve(c.id):d.resolve(null)}),f.hitch(this,function(){d.resolve(null)}))}else console.log("Can't find web map by defaultBasemap.title."),d.resolve(null)}),f.hitch(this,function(a){console.error(a);d.reject(a)})))}),f.hitch(this,function(a){console.error(a);d.reject(a)})):(console.log("Can't find group by basemapGalleryGroupQuery."),d.resolve(null))}),f.hitch(this,function(a){console.error(a);d.reject(a)}));
return d},_getMostNumViewsWebMap:function(a){var c=new l;this.getPortal(a).queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND access:public AND owner:esri_en",sortField:"numViews",sortOrder:"desc"}).then(f.hitch(this,function(a){a=a.results;a=b.filter(a,f.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?c.resolve(a[0].id):c.reject("Can't find most-num-views web map.")}),f.hitch(this,function(a){console.error(a);c.reject(a)}));return c},comparePortalVersion:function(a,
b){var c=a.split("."),d=parseInt(c[0],10),c=1<c.length?parseInt(c[1],10):0,e=b.split("."),f=parseInt(e[0],10),e=1<e.length?parseInt(e[1],10):0;return d>f?1:d<f?-1:c>e?1:c<e?-1:0}};h.subscribe("userSignOut",function(a){(a=d._findPortal(a))&&a.clearCredentialAndUser()});return d})},"jimu/Role":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/json","esri/lang"],function(p,f,b,m,l){return p(null,{id:null,baseRole:null,name:null,description:null,privileges:[],privilegeObj:null,
constructor:function(b){b=b||{};this.id=b.id;this.baseRole=b.role;this.name=b.name;this.description=b.description},_initPrivilegesObject:function(){this.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,assignToGroups:!1,manageEnterpriseGroups:!1,viewItems:!1,updateItems:!1,deleteItems:!1,reassignItems:!1,manageLicenses:!1},publisher:{publishFeatures:!1,publishTiles:!1,
publishScenes:!1},user:{createGroup:!1,joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,shareToOrg:!1,shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,demographics:!1,elevation:!1}},marketplace:{admin:{manage:!1,purchase:!1,startTrial:!1}}}},_readPrivileges:function(h){l.isDefined(h)&&h instanceof Array&&
b.forEach(h,f.hitch(this,function(b){this._readPrivilege(b)}))},_readPrivilege:function(b){this._applyEffectToAction(!0,b)},_applyEffectToAction:function(b,f){switch(f){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=b;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=b;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=b;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=b;break;case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=
b;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=b;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=b;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=b;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=b;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=b;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=
b;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=b;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=b;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=b;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=b;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=b;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=
b;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=b;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=b;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=b;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=b;break;case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=b;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=
b;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=b;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=b;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=b;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=b;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=b;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=
b;break;case "features:user:edit":this.privilegeObj.features.user.edit=b;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=b;break;case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=b;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=b;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=b;break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=b;break;
case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=b;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=b;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=b;break;case "premium:user:elevation":this.privilegeObj.premium.user.elevation=b;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=b;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=
b;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=b}},_applyToAll:function(b){this.privilegeObj.portal.admin.inviteUsers=b;this.privilegeObj.portal.admin.disableUsers=b;this.privilegeObj.portal.admin.viewUsers=b;this.privilegeObj.portal.admin.updateUsers=b;this.privilegeObj.portal.admin.deleteUsers=b;this.privilegeObj.portal.admin.changeUserRoles=b;this.privilegeObj.portal.admin.viewGroups=b;this.privilegeObj.portal.admin.updateGroups=b;this.privilegeObj.portal.admin.deleteGroups=
b;this.privilegeObj.portal.admin.reassignGroups=b;this.privilegeObj.portal.admin.assignToGroups=b;this.privilegeObj.portal.admin.manageEnterpriseGroups=b;this.privilegeObj.portal.admin.viewItems=b;this.privilegeObj.portal.admin.updateItems=b;this.privilegeObj.portal.admin.deleteItems=b;this.privilegeObj.portal.admin.reassignItems=b;this.privilegeObj.portal.admin.manageLicenses=b;this.privilegeObj.portal.publisher.publishFeatures=b;this.privilegeObj.portal.publisher.publishTiles=b;this.privilegeObj.portal.publisher.publishScenes=
b;this.privilegeObj.portal.user.createGroup=b;this.privilegeObj.portal.user.joinGroup=b;this.privilegeObj.portal.user.joinNonOrgGroup=b;this.privilegeObj.portal.user.createItem=b;this.privilegeObj.portal.user.shareToGroup=b;this.privilegeObj.portal.user.shareToOrg=b;this.privilegeObj.portal.user.shareToPublic=b;this.privilegeObj.portal.user.shareGroupToOrg=b;this.privilegeObj.portal.user.shareGroupToPublic=b;this.privilegeObj.features.user.edit=b;this.privilegeObj.opendata.user.openDataAdmin=b;this.privilegeObj.opendata.user.designateGroup=
b;this.privilegeObj.premium.user.geocode=b;this.privilegeObj.premium.user.networkanalysis=b;this.privilegeObj.premium.user.spatialanalysis=b;this.privilegeObj.premium.user.geoenrichment=b;this.privilegeObj.premium.user.demographics=b;this.privilegeObj.premium.user.elevation=b;this.privilegeObj.marketplace.admin.purchase=b;this.privilegeObj.marketplace.admin.manage=b;this.privilegeObj.marketplace.admin.startTrial=b},_buildPrivilegesArray:function(){var b=[];!0===this.privilegeObj.portal.admin.inviteUsers&&
b.push("portal:admin:inviteUsers");!0===this.privilegeObj.portal.admin.disableUsers&&b.push("portal:admin:disableUsers");!0===this.privilegeObj.portal.admin.viewUsers&&b.push("portal:admin:viewUsers");!0===this.privilegeObj.portal.admin.updateUsers&&b.push("portal:admin:updateUsers");!0===this.privilegeObj.portal.admin.deleteUsers&&b.push("portal:admin:deleteUsers");!0===this.privilegeObj.portal.admin.changeUserRoles&&b.push("portal:admin:changeUserRoles");!0===this.privilegeObj.portal.admin.viewGroups&&
b.push("portal:admin:viewGroups");!0===this.privilegeObj.portal.admin.updateGroups&&b.push("portal:admin:updateGroups");!0===this.privilegeObj.portal.admin.deleteGroups&&b.push("portal:admin:deleteGroups");!0===this.privilegeObj.portal.admin.reassignGroups&&b.push("portal:admin:reassignGroups");!0===this.privilegeObj.portal.admin.assignToGroups&&b.push("portal:admin:assignToGroups");!0===this.privilegeObj.portal.admin.manageEnterpriseGroups&&b.push("portal:admin:manageEnterpriseGroups");!0===this.privilegeObj.portal.admin.viewItems&&
b.push("portal:admin:viewItems");!0===this.privilegeObj.portal.admin.updateItems&&b.push("portal:admin:updateItems");!0===this.privilegeObj.portal.admin.deleteItems&&b.push("portal:admin:deleteItems");!0===this.privilegeObj.portal.admin.reassignItems&&b.push("portal:admin:reassignItems");!0===this.privilegeObj.portal.admin.manageLicenses&&b.push("portal:admin:manageLicenses");!0===this.privilegeObj.portal.publisher.publishFeatures&&b.push("portal:publisher:publishFeatures");!0===this.privilegeObj.portal.publisher.publishTiles&&
b.push("portal:publisher:publishTiles");!0===this.privilegeObj.portal.publisher.publishScenes&&b.push("portal:publisher:publishScenes");!0===this.privilegeObj.portal.user.createGroup&&b.push("portal:user:createGroup");!0===this.privilegeObj.portal.user.joinGroup&&b.push("portal:user:joinGroup");!0===this.privilegeObj.portal.user.joinNonOrgGroup&&b.push("portal:user:joinNonOrgGroup");!0===this.privilegeObj.portal.user.createItem&&b.push("portal:user:createItem");!0===this.privilegeObj.portal.user.shareToGroup&&
b.push("portal:user:shareToGroup");!0===this.privilegeObj.portal.user.shareToOrg&&b.push("portal:user:shareToOrg");!0===this.privilegeObj.portal.user.shareToPublic&&b.push("portal:user:shareToPublic");!0===this.privilegeObj.portal.user.shareGroupToOrg&&b.push("portal:user:shareGroupToOrg");!0===this.privilegeObj.portal.user.shareGroupToPublic&&b.push("portal:user:shareGroupToPublic");!0===this.privilegeObj.features.user.edit&&b.push("features:user:edit");!0===this.privilegeObj.features.user.fullEdit&&
b.push("features:user:fullEdit");!0===this.privilegeObj.opendata.user.openDataAdmin&&b.push("opendata:user:openDataAdmin");!0===this.privilegeObj.opendata.user.designateGroup&&b.push("opendata:user:designateGroup");!0===this.privilegeObj.premium.user.geocode&&b.push("premium:user:geocode");!0===this.privilegeObj.premium.user.networkanalysis&&b.push("premium:user:networkanalysis");!0===this.privilegeObj.premium.user.spatialanalysis&&b.push("premium:user:spatialanalysis");!0===this.privilegeObj.premium.user.geoenrichment&&
b.push("premium:user:geoenrichment");!0===this.privilegeObj.premium.user.demographics&&b.push("premium:user:demographics");!0===this.privilegeObj.premium.user.elevation&&b.push("premium:user:elevation");!0===this.privilegeObj.marketplace.admin.purchase&&b.push("marketplace:admin:purchase");!0===this.privilegeObj.marketplace.admin.manage&&b.push("marketplace:admin:manage");!0===this.privilegeObj.marketplace.admin.startTrial&&b.push("marketplace:admin:startTrial");return b},isUser:function(){return l.isDefined(this.id)&&
("org_user"===this.id||"account_user"===this.id)},isPublisher:function(){return l.isDefined(this.id)&&("org_publisher"===this.id||"account_publisher"===this.id)},isAdmin:function(){return l.isDefined(this.id)&&("org_admin"===this.id||"account_admin"===this.id)},isBasedOnUser:function(){return this.isUser()||l.isDefined(this.baseRole)&&("org_user"===this.baseRole||"account_user"===this.baseRole)},isBasedOnPublisher:function(){return this.isPublisher()||l.isDefined(this.baseRole)&&("org_publisher"===
this.baseRole||"account_publisher"===this.baseRole)},isBasedOnAdmin:function(){return this.isAdmin()||l.isDefined(this.baseRole)&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)},isCustom:function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&l.isDefined(this.id)&&0<this.id.length},canInviteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.inviteUsers},canDisableUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers},
canViewUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers},canUpdateUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateUsers},canDeleteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers},canChangeUserRoles:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles},canViewOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups},canUpdateOrgGroups:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.updateGroups},canDeleteOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups},canReassignOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups},canAssignUsersToOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups},canManageEnterpriseGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups},canViewOrgItems:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.viewItems},canUpdateOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems},canDeleteOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems},canReassignOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems},canManageLicenses:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses},canCreateGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup},
canJoinOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup},canJoinNonOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup},canPublishFeatures:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishFeatures},canPublishTiles:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles},canPublishScenes:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes},
canCreateItem:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem},canShareItemToGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup},canShareItemToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg},canShareItemToPublic:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToPublic},canShareGroupToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg},canShareGroupToPublic:function(){return this.privilegeObj&&
this.privilegeObj.portal.user.shareGroupToPublic},canEditFeatures:function(){return this.privilegeObj&&this.privilegeObj.features.user.edit},canEditFeaturesFullControl:function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit},canManageOpenData:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.openDataAdmin},canDesignateOpenDataGroups:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup},canUseGeocode:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.geocode},canUseNetworkAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis},canUseSpatialAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis},canUseGeoenrichment:function(){return this.privilegeObj&&this.privilegeObj.premium.user.geoenrichment},canUseDemographics:function(){return this.privilegeObj&&this.privilegeObj.premium.user.demographics},canUseElevation:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.elevation},canPurchaseMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase},canManageMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage},canTrialMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.startTrial},setPrivileges:function(b){this.privileges=b;this._initPrivilegesObject();l.isDefined(b)&&this._readPrivileges(b)},stringify:function(){return m.stringify({id:this.id,
name:this.name,description:this.description,privileges:this._buildPrivilegesArray()})},stringifyRole:function(){return m.stringify({id:this.id,name:this.name,description:this.description})},stringifyPrivileges:function(){return m.stringify({privileges:this._buildPrivilegesArray()})},stringifyPretty:function(){return m.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()},null,"  ")}})})},"jimu/tokenUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/kernel esri/config esri/request esri/urlUtils esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k){"function"!==typeof l.getAll&&(l.getAll=function(a){var b=[];(a=l(a))&&b.push(a);return b});u={portalUrl:null,cookiePath:"/",_started:!1,webTierPortalUrls:[],isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){return k.isInConfigOrPreviewWindow()},isStringStartWith:function(a,b){return a.substr(0,b.length)===b},getCookiePath:function(){return this.cookiePath},setPortalUrl:function(a){(a=q.getStandardPortalUrl(a))&&(a+=
"/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(b){var c=new m,d=q.getStandardPortalUrl(b);b=d+"/sharing";var f=q.setHttpsProtocol(d+"/sharing/generateToken?f\x3djson"),k=q.setHttpsProtocol(b);n.get(f,{jsonp:"callback"}).then(p.hitch(this,function(b){b.token?(this.webTierPortalUrls.push(d),this.removeWabAuthCookie(),g.id.getCredential(k).then(p.hitch(this,function(f){f.token||(f.token=b.token);f=a.canUseXhr(f.server,!0);-1<f&&e.defaults.io.corsEnabledServers.splice(f,
1);this._pushCorsEnabledServerInfo({host:q.getServerByUrl(d),withCredentials:!0});c.resolve(!0)}),p.hitch(this,function(){c.resolve(!0)}))):c.resolve(!1)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},addAuthorizedCrossOriginDomains:function(a){if(a&&0<a.length)for(var b=0;b<a.length;b++)this.addWithCredentialDomain(a[b])},addWithCredentialDomain:function(b){if(b&&"string"===typeof b){var c=e.defaults.io.corsEnabledServers,d=q.getServerByUrl(b);(b=q.getServerWithProtocol(b))||
(b="http://"+d);b=a.canUseXhr(b,!0);-1<b&&c.splice(b,1);this._pushCorsEnabledServerInfo({host:d,withCredentials:!0})}},_pushCorsEnabledServerInfo:function(a){if(a){var b=e.defaults.io.corsEnabledServers,c="charAt charCodeAt concat endsWith indexOf lastIndexOf localeCompare match replace search slice split startsWith substr substring toLocaleLowerCase toLocaleUpperCase toLowerCase toString toUpperCase trim trimLeft trimRight valueOf".split(" ");if("object"===typeof a&&"string"===typeof a.host){for(var d in a.host)a[d]=
"function"===typeof a.host[d]?function(){return a.host[d].apply(a.host,arguments)}:a.host[d];a.length=a.host.length;f.forEach(c,function(b){"function"===typeof a.host[b]&&(a[b]=function(){return a.host[b].apply(a.host,arguments)})})}b.push(a)}},tryRegisterCredential:function(a){return this.isValidCredential(a)?f.some(g.id.credentials,p.hitch(this,function(b){return a.token===b.token}))?!1:(g.id.credentials.push(a),!0):!1},registerToken:function(a){var b=q.getSharingUrl(this.portalUrl);g.id.findCredential(b)&&
f.some(g.id.credentials,p.hitch(this,function(a,b){if(this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a))return g.id.credentials.splice(b,1),!0}));return this._getTokenInfo(a).then(function(a){a&&g.id.registerToken(a)})},_getTokenInfo:function(a){var b=q.getPortalSelfInfoUrl(this.portalUrl);return n.get(b+("?f\x3djson\x26token\x3d"+a),{jsonp:"callback"}).then(p.hitch(this,function(b){return b.user?{server:q.getSharingUrl(this.portalUrl),ssl:b.allSSL,token:a,userId:b.user.username}:null}),function(a){console.error(a);
throw Error(window.jimuNls.urlParams.validateTokenError);})},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&p.trim(a)},signInPortal:function(a){var b=new m;if(this._isInvalidPortalUrl(a)){a=q.getStandardPortalUrl(a);var c=q.getSharingUrl(a),d=this.getPortalCredential(a);d?setTimeout(p.hitch(this,function(){b.resolve(d)}),0):b=g.id.getCredential(c)}else setTimeout(p.hitch(this,function(){b.reject("Invalid portalurl.")}),0);return b},_loadPortalSelfInfo:function(a){a=q.getPortalSelfInfoUrl(a);
return c({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(a,b){if(!a||"string"!==typeof a||!b||"string"!==typeof b)return null;var c=g.id.findOAuthInfo(a);c||(c=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",c=new v({appId:b,expiration:20159,portalUrl:a,authNamespace:"/",popup:!0,popupCallbackUrl:c}),g.id.registerOAuthInfos([c]));c.appId=b;return c},signOutAll:function(){var a=q.getStandardPortalUrl(this.portalUrl),
b=!!g.id.findCredential(a+"/sharing/rest");window.appInfo.isRunInPortal?this.removeEsriAuthCookieStorage():this.removeWabAuthCookie();g.id.destroyCredentials();g.id._oAuthHash=null;b&&this._publishCurrentPortalUserSignOut(a)},userHaveSignInPortal:function(a){return!!this.getPortalCredential(p.trim(a||""))},isValidCredential:function(a){var b=!1;if(a){var b=a.token,c=a.server,d=a.scope,b=b&&"string"===typeof b&&p.trim(b),c=c&&"string"===typeof c&&p.trim(c),d="portal"===d||"server"===d,e=!0;a.expires&&
(a=parseInt(a.expires,10),e=(new Date).getTime(),e=a>e);b=b&&c&&d&&e}return b},isValidPortalCredentialOfPortalUrl:function(a,b){var c=!1;if(this.isValidCredential(b))var c="portal"===b.scope,d=q.isSameServer(a,b.server),c=c&&d;return c},getPortalCredential:function(a){var b=null;a=p.trim(a||"");if(!a)return null;a=q.getStandardPortalUrl(a);(b=this._filterPortalCredential(a,g.id.credentials))||this._tryConvertArcGIScomCrendentialToOrgCredential();return b},_tryConvertArcGIScomCrendentialToOrgCredential:function(){var a=
this.portalUrl;if(a&&(a=q.getStandardPortalUrl(a),q.isOrgOnline(a)&&!this._filterPortalCredential(a,g.id.credentials))){var b=this._filterPortalCredential("http://www.arcgis.com",g.id.credentials);b&&g.id.registerToken({token:b.token,scope:"portal",userId:b.userId,server:a+"/sharing/rest",expires:b.expires})}},saveAndRegisterCookieToCredential:function(a){a=p.clone(a);a.referer=window.location.host;a.scope="portal";a.isAdmin=!!a.isAdmin;this.saveWabCookie(a);var b=a.server+"/sharing/rest";a.server=
b;g.id.registerToken(a);return g.id.findCredential(b,a.userId)},registerAuth2Hash:function(a){a=p.clone(a);var b=1E3*parseInt(a.expires_in,10),b=(new Date).getTime()+b,c=q.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:c,token:a.access_token,expires:b,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},saveWabCookie:function(a){this.removeCookie("wab_auth");l("wab_auth",h.stringify(a),{expires:new Date(a.expires),path:"/"})},
removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,b){var c=null;a=q.getStandardPortalUrl(a);if(b&&0<b.length){var d=f.filter(b,p.hitch(this,function(b){return this.isValidPortalCredentialOfPortalUrl(a,b)}));0<d.length&&(c=d[d.length-1])}return c},
_removePortalCredential:function(a){var b=p.trim(a||"");if(b){b=q.getStandardPortalUrl(b);for(a=f.filter(g.id.credentials,p.hitch(this,function(a){return this.isValidPortalCredentialOfPortalUrl(b,a)}));0<a.length;)a[0].destroy(),a.splice(0,1);g.id.credentials=f.filter(g.id.credentials,p.hitch(this,function(a){return!this.isValidPortalCredentialOfPortalUrl(b,a)}))}},getUserIdByToken:function(a,b){var d=new m;if(a&&"string"===typeof a&&b&&"string"===typeof b){var e=q.getStandardPortalUrl(b),k=f.filter(g.id.credentials,
p.hitch(this,function(b){var c=b.token===a&&b.userId;b=q.isSameServer(e,b.server);return c&&b}));if(0<k.length){var h=k[0];setTimeout(p.hitch(this,function(){d.resolve(h.userId)}),0);return d}k=q.getCommunitySelfUrl(e);c({url:k,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(a){d.resolve(a&&a.username||"")}),p.hitch(this,function(a){console.error(a);d.reject("fail to get userId by token")}))}else setTimeout(p.hitch(this,function(){d.reject("invalid parameters")}),
0);return d},xtGetCredentialFromCookie:function(a){var b=l("wab_auth"),c=null;if(b)try{c=h.parse(b)}catch(x){console.error(x)}if(!c||"object"!==typeof c||!q.isSameServer(a,c.server)||window.location.host!==c.referer)return null;c.expires=parseInt(c.expires,10);b=(new Date).getTime();if(!(c.expires>b))return this.removeCookie("wab_auth"),null;a+="/sharing/rest";c.server=a;(b=g.id.findCredential(a))||g.id.registerToken(c);return b=g.id.findCredential(a)},removeCookie:function(a){var b=this.getCookiePath();
k.removeCookie(a,b)},_getDomainsByServerName:function(a){var b=a.split("."),c=b.length;return f.map(b,p.hitch(this,function(a,d){var e=b.slice(d,c),g="",k=e.length-1;f.forEach(e,p.hitch(this,function(a,b){g+=a;b!==k&&(g+=".")}));return g}))},_publishCurrentPortalUserSignIn:function(a){if(this.isValidCredential(a))try{r.publish("userSignIn",a)}catch(w){console.error(w)}},_publishAnyUserSignIn:function(a){if(this.isValidCredential(a))try{r.publish("anyUserSignIn",a)}catch(w){console.error(w)}},_publishCurrentPortalUserSignOut:function(a){try{r.publish("userSignOut",
a)}catch(w){console.error(w)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a)}catch(w){console.error(w)}},_bindEvents:function(){b.after(g.id,"signIn",p.hitch(this,function(a,c){console.log(c[1]);b.after(a,"callback",p.hitch(this,function(a,b){this._signInSuccess(b[0],!1)}));return a}))},isStart:function(){return this._started},startup:function(){if(!this._started){if(this.isInConfigOrPreviewWindow()){var a=
window.parent;if(a){var b=a.esri&&a.esri.id;b&&(g.id=b,b=window.esriConfig.defaults.io,a=a.esriConfig.defaults.io,b.corsEnabledServers=a.corsEnabledServers,b.webTierAuthServers=a.webTierAuthServers,b._processedCorsServers=a._processedCorsServers,b.corsStatus=a.corsStatus)}}this._bindEvents();this._started=!0}}};u.startup();return u})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(p,f,b,m){p=new p;f.id=m.safeMixin(p,
b);return f.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k){return f([q],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},
constructor:function(a){l.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(a,c,e){this._nls||(this._nls=k.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var d=this._loginDialog,f=e&&e.error,g=e&&e.token,h=new m(function(){d.onCancel()});if(d.open)return a=Error("BUSY"),a.code="IdentityManager.1",a.log=b.isDebug,h.errback(a),h;u.hide(d.errMsg_);f&&403==f.code&&g&&(r.set(d.errMsg_,"innerHTML",this._nls.forbidden),u.show(d.errMsg_));d.dfd_=h;
d.serverInfo_=c;d.resUrl_=a;d.admin_=e&&e.isAdmin;r.set(d.resLink_,{title:a,innerHTML:"("+(this.getResourceName(a)||this._nls.lblItem)+")"});r.set(d.serverLink_,{title:c.server,innerHTML:(-1!==c.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":c.server)+" "});d.txtPwd_.set("value","");d.show();return h},_createLoginDialog:function(){var d=this._nls,f=a.substitute(d,this._dialogContent),f=a.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},f),k=new e({title:d.title,content:f,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===n.ENTER&&this.execute_()},execute_:function(){var b=this.txtUser_.get("value"),f=this.txtPwd_.get("value"),g=this.dfd_,k=this;if(this.form_.validate()&&b&&f){this.btnSubmit_.set("label",d.lblSigning);var h=c.id.findCredential(k.resUrl_,b),q=function(c){k.btnSubmit_.set("label",
d.lblOk);k.btnSubmit_.set("disabled",!1);u.hide(k.errMsg_);k.hide();e._DialogLevelManager.hide(k);var f=k.serverInfo_;k.dfd_=k.serverInfo_=k.generateDfd_=k.resUrl_=null;var q,t,l=h,m;c&&(q=c.token,t=a.isDefined(c.expires)?Number(c.expires):null,m=!!c.ssl,l?(l.userId=b,l.token=q,l.expires=t,l.validity=c.validity,l.ssl=m,l.creationTime=(new Date).getTime()):l=new v({userId:b,server:f.server,token:q,expires:t,ssl:m,isAdmin:k.admin_,validity:c.validity}));g.callback(l)};h&&!h._enqueued?q():(k.btnSubmit_.set("disabled",
!0),k.generateDfd_=c.id.generateToken(this.serverInfo_,{username:b,password:f},{isAdmin:this.admin_}).addCallback(q).addErrback(function(a){k.btnSubmit_.set("disabled",!1);k.generateDfd_=null;k.btnSubmit_.set("label",d.lblOk);r.set(k.errMsg_,"innerHTML",a&&a.code?d.invalidUser:d.noAuthService);u.show(k.errMsg_)}))}},cancel_:function(){k.generateDfd_&&k.generateDfd_.cancel();var a=k.dfd_,c=k.resUrl_,d=k.serverInfo_;k.btnSubmit_.set("disabled",!1);k.dfd_=k.serverInfo_=k.generateDfd_=k.resUrl_=null;
u.hide(k.errMsg_);e._DialogLevelManager.hide(k);k.esriIdMgr_.onDialogCancel({resourceUrl:c,serverInfo:d});c=Error("ABORTED");c.code="IdentityManager.2";c.log=b.isDebug;a.errback(c)}}),f=k.domNode;k.form_=g.byNode(p.query(".esriIdForm",f)[0]);k.txtUser_=g.byNode(p.query(".esriIdUser",f)[0]);k.txtPwd_=g.byNode(p.query(".esriIdPwd",f)[0]);k.btnSubmit_=g.byNode(p.query(".esriIdSubmit",f)[0]);k.btnCancel_=g.byNode(p.query(".esriIdCancel",f)[0]);k.resLink_=p.query(".resLink",f)[0];k.serverLink_=p.query(".serverLink",
f)[0];k.errMsg_=p.query(".esriErrorMsg",f)[0];k.connect(k.txtUser_,"onKeyPress",k.keypressed_);k.connect(k.txtPwd_,"onKeyPress",k.keypressed_);k.connect(k.btnSubmit_,"onClick",k.execute_);k.connect(k.btnCancel_,"onClick",k.onCancel);k.connect(k,"onCancel",k.cancel_);return k}})})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J,L){function P(){}var Q=new l;Q.resolve(!0);A=m("dijit._DialogBase"+(k("dojo-bidi")?"_NoBidi":""),[z,B,E,C],{templateString:L,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:A.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=c.getLocalization("dijit","common");u.mixin(this,a);this.inherited(arguments)},postCreate:function(){g.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);b.after(this,"onExecute",u.hitch(this,"hide"),!0);b.after(this,"onCancel",u.hitch(this,"hide"),!0);this._modalconnects=
[]},onLoad:function(){this.resize();this._position();this.autofocus&&K.isTop(this)&&(this._getFocusItems(),x.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();x.focus(this._firstFocusItem)},_endDrag:function(){var a=n.position(this.domNode),b=d.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var a=this.domNode;this.titleBar&&this.draggable?
(this._moveable=new (6==k("ie")?t:w)(a,{handle:this.titleBar}),b.after(this._moveable,"onMoveStop",u.hitch(this,"_endDrag"),!0)):r.add(a,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":f.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:u.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!r.contains(this.ownerDocumentBody,"dojoMove")){var a=this.domNode,b=d.getBox(this.ownerDocument),
c=this._relativePosition,e=n.position(a);g.set(a,{left:Math.floor(b.l+(c?Math.min(c.x,b.w-e.w):(b.w-e.w)/2))+"px",top:Math.floor(b.t+(c?Math.min(c.y,b.h-e.h):(b.h-e.h)/2))+"px"})}},_onKey:function(b){if(b.keyCode==a.TAB){this._getFocusItems();var c=b.target;this._firstFocusItem==this._lastFocusItem?(b.stopPropagation(),b.preventDefault()):c==this._firstFocusItem&&b.shiftKey?(x.focus(this._lastFocusItem),b.stopPropagation(),b.preventDefault()):c!=this._lastFocusItem||b.shiftKey||(x.focus(this._firstFocusItem),
b.stopPropagation(),b.preventDefault())}else this.closable&&b.keyCode==a.ESCAPE&&(this.onCancel(),b.stopPropagation(),b.preventDefault())},show:function(){if(this.open)return Q.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),K.hide(this));var a=d.get(this.ownerDocument);this._modalconnects.push(v(a,"scroll",u.hitch(this,"resize",null)));this._modalconnects.push(v(this.domNode,"keydown",
u.hitch(this,"_onKey")));g.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var b;this._fadeInDeferred=new l(u.hitch(this,function(){b.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,P);a=this._fadeInDeferred.promise;b=e.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:u.hitch(this,function(){K.show(this,this.underlayAttrs)}),onEnd:u.hitch(this,function(){this.autofocus&&K.isTop(this)&&(this._getFocusItems(),
x.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return Q.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new l(u.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,P);this._fadeOutDeferred.then(u.hitch(this,"onHide"));var b=this._fadeOutDeferred.promise;a=e.fadeOut({node:this.domNode,duration:this.duration,
onEnd:u.hitch(this,function(){this.domNode.style.display="none";K.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var c;c=this._modalconnects.pop();)c.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return b},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),f.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(a){a&&g.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var b=d.getBox(this.ownerDocument);b.w*=this.maxRatio;b.h*=this.maxRatio;var c=n.position(this.domNode);c.w>=b.w||c.h>=b.h?(a={w:Math.min(c.w,b.w),h:Math.min(c.h,b.h)},this._shrunk=!0):this._shrunk=!1}if(a){n.setMarginBox(this.domNode,
a);b=[];this.titleBar&&b.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&b.push({domNode:this.actionBarNode,region:"bottom"});c={domNode:this.containerNode,region:"center"};b.push(c);var e=J.marginBox2contentBox(this.domNode,a);J.layoutChildren(this.domNode,e,b);this._singleChild?(b=J.marginBox2contentBox(this.containerNode,c),this._singleChild.resize({w:b.w,h:b.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();k("touch")||a||this._position()}},
_layoutChildren:function(){f.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();K.hide(this);this.inherited(arguments)}});k("dojo-bidi")&&(A=m("dijit._DialogBase",A,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},
_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var H=m("dijit.Dialog",[I,A],{});H._DialogBase=A;var K=H._DialogLevelManager={_beginZIndex:950,show:function(a,b){V[V.length-1].focus=x.curNode;var c=V[V.length-1].dialog?V[V.length-1].zIndex+2:H._DialogLevelManager._beginZIndex;g.set(a.domNode,"zIndex",c);G.show(b,c-1);V.push({dialog:a,underlayAttrs:b,zIndex:c})},hide:function(a){if(V[V.length-1].dialog==a){V.pop();var b=V[V.length-
1];1==V.length?G.hide():G.show(b.underlayAttrs,b.zIndex-1);if(a.refocus&&(a=b.focus,!b.dialog||a&&h.isDescendant(a,b.dialog.domNode)||(b.dialog._getFocusItems(),a=b.dialog._firstFocusItem),a))try{a.focus()}catch(N){}}else b=f.indexOf(f.map(V,function(a){return a.dialog}),a),-1!=b&&V.splice(b,1)},isTop:function(a){return V[V.length-1].dialog==a}},V=H._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];x.watch("curNode",function(a,b,c){a=V[V.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&c.ownerDocument==
a.ownerDocument){do if(c==a.domNode||r.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});k("dijit-legacy-requires")&&q(0,function(){p(["dijit/TooltipDialog"])});return H})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../has ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u){function v(a,b){"touchAction"in document.body.style?q="touchAction":"msTouchAction"in
document.body.style&&(q="msTouchAction");k=function(a,b){a.style[q]=b};k(a,b)}var q,k=function(){};r("touch-action")&&(k=v);return f("dojo.dnd.Moveable",[h],{handle:"",delay:0,skip:!1,constructor:function(c,f){this.node=m.byId(c);k(this.node,"none");f||(f={});this.handle=f.handle?m.byId(f.handle):null;this.handle||(this.handle=this.node);this.delay=0<f.delay?f.delay:0;this.skip=f.skip;this.mover=f.mover?f.mover:a;this.events=[n(this.handle,e.press,b.hitch(this,"onMouseDown")),n(this.handle,"dragstart",
b.hitch(this,"onSelectStart")),n(this.handle,"selectstart",b.hitch(this,"onSelectStart"))]},markupFactory:function(a,b,c){return new c(b,a)},destroy:function(){p.forEach(this.events,function(a){a.remove()});k(this.node,"");this.events=this.node=this.handle=null},onMouseDown:function(a){if(!this.skip||!c.isFormElement(a)){if(this.delay)this.events.push(n(this.handle,e.move,b.hitch(this,"onMouseMove")),n(this.handle.ownerDocument,e.release,b.hitch(this,"onMouseUp"))),this._lastX=a.pageX,this._lastY=
a.pageY;else this.onDragDetected(a);a.stopPropagation();a.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();a.preventDefault()},onMouseUp:function(a){for(var b=0;2>b;++b)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(a){this.skip&&c.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onDragDetected:function(a){new this.mover(this.node,
a,this)},onMoveStart:function(a){g.publish("/dnd/move/start",a);l.add(u.body(),"dojoMove");l.add(this.node,"dojoMoveItem")},onMoveStop:function(a){g.publish("/dnd/move/stop",a);l.remove(u.body(),"dojoMove");l.remove(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,b){this.onMoving(a,b);var c=a.node.style;c.left=b.l+"px";c.top=b.t+"px";this.onMoved(a,b)},onMoving:function(){},onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang",
"../dom"],function(p,f,b,m){var l=b.getObject("dojo.dnd",!0);l.getCopyKeyState=function(b){return b[p("mac")?"metaKey":"ctrlKey"]};l._uniqueId=0;l.getUniqueId=function(){var b;do b=f._scopeName+"Unique"+ ++l._uniqueId;while(m.byId(b));return b};l._empty={};l.isFormElement=function(b){b=b.target;3==b.nodeType&&(b=b.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+b.tagName.toLowerCase()+" ")};return l})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){return f("dojo.dnd.Mover",[g],{constructor:function(a,f,g){function d(a){a.preventDefault();a.stopPropagation()}this.node=h.byId(a);this.marginBox={l:f.pageX,t:f.pageY};this.mouseButton=f.button;f=this.host=g;a=a.ownerDocument;this.events=[e(a,c.move,b.hitch(this,"onFirstMove")),e(a,c.move,b.hitch(this,"onMouseMove")),e(a,c.release,b.hitch(this,"onMouseUp")),e(a,"dragstart",d),e(a.body,"selectstart",d)];u.autoScrollStart(a);if(f&&f.onMoveStart)f.onMoveStart(this)},
onMouseMove:function(a){u.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){(m("webkit")&&m("mac")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,c,d=this.host;switch(b.position){case "relative":case "absolute":c=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;
default:b.position="absolute";b=r.getMarginBox(this.node);c=l.doc.body;var e=n.getComputedStyle(c),f=r.getMarginBox(c,e),e=r.getContentBox(c,e);c=b.l-(e.l-f.l);b=b.t-(e.t-f.t)}this.marginBox.l=c-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(d&&d.onFirstMove)d.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){p.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),
function(p,f,b,m,l,h){var r={};p.setObject("dojo.dnd.autoscroll",r);r.getViewport=h.getBox;r.V_TRIGGER_AUTOSCROLL=32;r.H_TRIGGER_AUTOSCROLL=32;r.V_AUTOSCROLL_VALUE=16;r.H_AUTOSCROLL_VALUE=16;var n,g=b.doc,e=Infinity,c=Infinity;r.autoScrollStart=function(a){g=a;n=h.getBox(g);a=b.body(g).parentNode;e=Math.max(a.scrollHeight-n.h,0);c=Math.max(a.scrollWidth-n.w,0)};r.autoScroll=function(a){var f=n||h.getBox(g),l=b.body(g).parentNode,q=0,k=0;a.clientX<r.H_TRIGGER_AUTOSCROLL?q=-r.H_AUTOSCROLL_VALUE:a.clientX>
f.w-r.H_TRIGGER_AUTOSCROLL&&(q=Math.min(r.H_AUTOSCROLL_VALUE,c-l.scrollLeft));a.clientY<r.V_TRIGGER_AUTOSCROLL?k=-r.V_AUTOSCROLL_VALUE:a.clientY>f.h-r.V_TRIGGER_AUTOSCROLL&&(k=Math.min(r.V_AUTOSCROLL_VALUE,e-l.scrollTop));window.scrollBy(q,k)};r._validNodes={div:1,p:1,td:1};r._validOverflow={auto:1,scroll:1};r.autoScrollNodes=function(a){for(var c,e,g,k,d,h=0,t=0,n=a.target;n;){if(1==n.nodeType&&n.tagName.toLowerCase()in r._validNodes){g=l.getComputedStyle(n);d=g.overflowX.toLowerCase()in r._validOverflow;
k=g.overflowY.toLowerCase()in r._validOverflow;if(d||k)c=m.getContentBox(n,g),e=m.position(n,!0);if(d){g=Math.min(r.H_TRIGGER_AUTOSCROLL,c.w/2);d=a.pageX-e.x;if(f("webkit")||f("opera"))d+=b.body().scrollLeft;h=0;0<d&&d<c.w&&(d<g?h=-g:d>c.w-g&&(h=g),n.scrollLeft+=h)}if(k){k=Math.min(r.V_TRIGGER_AUTOSCROLL,c.h/2);g=a.pageY-e.y;if(f("webkit")||f("opera"))g+=b.body().scrollTop;t=0;0<g&&g<c.h&&(g<k?t=-k:g>c.h-k&&(t=k),n.scrollTop+=t)}if(h||t)return}try{n=n.parentNode}catch(A){n=null}}r.autoScroll(a)};
return r})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(p,f){var b=f.prototype.onMove;return p("dojo.dnd.TimedMoveable",f,{timeout:40,constructor:function(b,f){f||(f={});f.timeout&&"number"==typeof f.timeout&&0<=f.timeout&&(this.timeout=f.timeout)},onMoveStop:function(m){m._timer&&(clearTimeout(m._timer),b.call(this,m,m._leftTop));f.prototype.onMoveStop.apply(this,arguments)},onMove:function(f,l){f._leftTop=l;if(!f._timer){var h=this;f._timer=setTimeout(function(){f._timer=
null;b.call(h,f,f._leftTop)},this.timeout)}}})})},"dijit/_base/manager":function(){define(["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(p,f,b,m,l){var h={};p.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),function(b){h[b]=m[b]});b.mixin(h,{defaultDuration:f.defaultDuration||200});b.mixin(l,h);return l})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){f=f("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);p.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,h.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(a){b=b.concat(p.map(b,function(b){return b+a}),"dijit"+a)}var b=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var c="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(c);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var c=this.stateNode||this.domNode,e={};p.forEach(c.className.split(" "),function(a){e[a]=!0});"_stateClasses"in this&&p.forEach(this._stateClasses,function(a){delete e[a]});p.forEach(b,
function(a){e[a]=!0});var d=[],f;for(f in e)d.push(f);c.className=d.join(" ");this._stateClasses=b},_subnodeCssMouseEvent:function(a,b,c){function e(c){m.toggle(a,b+"Active",c)}if(!this.disabled&&!this.readOnly)switch(c.type){case "mouseover":case "MSPointerOver":case "pointerover":m.toggle(a,b+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":m.toggle(a,b+"Hover",!1);e(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":e(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":e(!1);break;case "focus":case "focusin":m.toggle(a,b+"Focused",!0);break;case "blur":case "focusout":m.toggle(a,b+"Focused",!1)}},_trackMouseState:function(a,b){a._cssState=b}});n(function(){function f(c,d,e){if(!e||!b.isDescendant(e,d))for(;d&&d!=e;d=d.parentNode)if(d._cssState){var f=a.getEnclosingWidget(d);f&&(d==f.domNode?f._cssMouseEvent(c):f._subnodeCssMouseEvent(d,d._cssState,c))}}var h=e.body(),q;r(h,
g.over,function(a){f(a,a.target,a.relatedTarget)});r(h,g.out,function(a){f(a,a.target,a.relatedTarget)});r(h,c.press,function(a){q=a.target;f(a,q)});r(h,c.release,function(a){f(a,q);q=null});r(h,"focusin, focusout",function(b){var c=b.target;if(c._cssState&&!c.getAttribute("widgetId")){var e=a.getEnclosingWidget(c);e&&e._subnodeCssMouseEvent(c,c._cssState,b)}})});return f})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(p,f,b,m,l,h){return f("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(b){var f=[];p.forEach(b||this.getChildren(),function(b){"value"in b?f.push(b):f=f.concat(this._getDescendantFormWidgets(b.getChildren()))},this);return f},reset:function(){p.forEach(this._getDescendantFormWidgets(),function(b){b.reset&&b.reset()})},validate:function(){var b=!1;return p.every(p.map(this._getDescendantFormWidgets(),function(f){f._hasBeenBlurred=!0;var g=f.disabled||!f.validate||
f.validate();g||b||(h.scrollIntoView(f.containerNode||f.domNode),f.focus(),b=!0);return g}),function(b){return b})},setValues:function(f){b.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",f)},_setValueAttr:function(b){var f={};p.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(f[a.name]||(f[a.name]=[])).push(a)});for(var g in f)if(f.hasOwnProperty(g)){var e=f[g],c=m.getObject(g,!1,b);void 0!==c&&(c=[].concat(c),
"boolean"==typeof e[0].checked?p.forEach(e,function(a){a.set("value",-1!=p.indexOf(c,a._get("value")))}):e[0].multiple?e[0].set("value",c):p.forEach(e,function(a,b){a.set("value",c[b])}))}},getValues:function(){b.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var b={};p.forEach(this._getDescendantFormWidgets(),function(f){var g=f.name;if(g&&!f.disabled){var e=f.get("value");"boolean"==typeof f.checked?
/Radio/.test(f.declaredClass)?!1!==e?m.setObject(g,e,b):(e=m.getObject(g,!1,b),void 0===e&&m.setObject(g,null,b)):(f=m.getObject(g,!1,b),f||(f=[],m.setObject(g,f,b)),!1!==e&&f.push(e)):(f=m.getObject(g,!1,b),"undefined"!=typeof f?m.isArray(f)?f.push(e):m.setObject(g,[f,e],b):m.setObject(g,e,b))}});return b},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var b=p.map(this._descendants,function(b){return b.get("state")||""});return 0<=p.indexOf(b,"Error")?
"Error":0<=p.indexOf(b,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(b){this._descendants=this._getDescendantFormWidgets();p.forEach(this._descendants,function(b){b._started||b.startup()});b||this._onChildChange()},_onChildChange:function(b){b&&"state"!=b&&"disabled"!=b||this._set("state",this._getState());b&&"value"!=b&&"disabled"!=b&&"checked"!=b||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var b=this;this.own(l(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(f){f.target!=b.domNode&&b._onChildChange(f.type.replace("attrmodified-",""))}));this.watch("state",function(b,f,e){this.onValidStateChange(""==e)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(p,f){return p("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var b=f._getTabNavigable(this.domNode);this._firstFocusItem=b.lowest||b.first||this.closeButtonNode||this.domNode;this._lastFocusItem=b.last||b.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){var u=p("dijit.DialogUnderlay",[n,g],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){m.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(h(this.domNode,"keydown",f.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var c=r.getBox(this.ownerDocument);b.top=c.t+"px";b.left=c.l+"px";a.width=c.w+"px";a.height=c.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new e(this.domNode);var a=r.get(this.ownerDocument);this._modalConnects=[c.on("resize",f.hitch(this,"layout")),h(a,"scroll",
f.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});u.show=function(b,c){var e=u._singleton;!e||e._destroyed?e=a._underlay=u._singleton=new u(b):b&&e.set(b);l.set(e.domNode,"zIndex",c);e.open||e.show()};u.hide=function(){var a=
u._singleton;a&&!a._destroyed&&a.hide()};return u})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(p,f,b,m,l,h,r,n){n.add("config-bgIframe",(n("ie")||n("trident"))&&!/IEMobile\/10\.0/.test(navigator.userAgent));var g=new function(){var e=[];this.pop=function(){var c;e.length?(c=e.pop(),c.style.display=""):(9>n("ie")?(c=b.dojoBlankHtmlUrl||p.toUrl("dojo/resources/blank.html")||'javascript:""',
c=document.createElement("\x3ciframe src\x3d'"+c+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e")):(c=m.create("iframe"),c.src='javascript:""',c.className="dijitBackgroundIframe",c.setAttribute("role","presentation"),l.set(c,"opacity",.1)),c.tabIndex=-1);return c};this.push=function(b){b.style.display="none";e.push(b)}};f.BackgroundIframe=function(b){if(!b.id)throw Error("no id");if(n("config-bgIframe")){var c=this.iframe=
g.pop();b.appendChild(c);7>n("ie")||n("quirks")?(this.resize(b),this._conn=r(b,"resize",h.hitch(this,"resize",b))):l.set(c,{width:"100%",height:"100%"})}};h.extend(f.BackgroundIframe,{resize:function(b){this.iframe&&l.set(this.iframe,{width:b.offsetWidth+"px",height:b.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),g.push(this.iframe),delete this.iframe)}});return f.BackgroundIframe})},"dijit/Viewport":function(){define(["dojo/Evented",
"dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(p,f,b,m,l){var h=new p,r;b(function(){var b=l.getBox();h._rlh=f(window,"resize",function(){var e=l.getBox();if(b.h!=e.h||b.w!=e.w)b=e,h.emit("resize")});if(8==m("ie")){var g=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=g&&(g=screen.deviceXDPI,h.emit("resize"))},500)}m("ios")&&(f(document,"focusin",function(b){r=b.target}),f(document,"focusout",function(b){r=null}))});h.getEffectiveBox=function(b){b=l.getBox(b);var f=r&&
r.tagName&&r.tagName.toLowerCase();m("ios")&&r&&!r.readOnly&&("textarea"==f||"input"==f&&/^(color|email|number|password|search|tel|text|url)$/.test(r.type))&&(b.h*=0==orientation||180==orientation?.66:.4,f=r.getBoundingClientRect(),b.h=Math.max(b.h,f.top+f.height));return b};return h})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k){return g("dijit.layout.ContentPane",[b,m,l],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:p._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,b,c){var d=new c(a,b);return!d.href&&d._contentSetter&&d._contentSetter.parseDeferred&&!d._contentSetter.parseDeferred.isFulfilled()?d._contentSetter.parseDeferred.then(function(){return d}):d},create:function(a,b){if(!(a&&a.template||!b||"href"in a||"content"in a)){b=c.byId(b);for(var d=b.ownerDocument.createDocumentFragment();b.firstChild;)d.appendChild(b.firstChild);
a=f.delegate(a,{content:d})}this.inherited(arguments,[a,b])},postMixInProperties:function(){this.inherited(arguments);var a=q.getLocalization("dijit","loading",this.lang);this.loadingMessage=h.substitute(this.loadingMessage,a);this.errorMessage=h.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&n.forEach(this._contentSetter.parseResults,
function(a){a._started||a._destroyed||!f.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},_startChildren:function(){n.forEach(this.getChildren(),function(a){a._started||a._destroyed||!f.isFunction(a.startup)||(a.startup(),a._started=!0)});this._contentSetter&&n.forEach(this._contentSetter.parseResults,function(a){a._started||a._destroyed||!f.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},setHref:function(a){p.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new e(f.hitch(this,"cancel"));this.onLoadDeferred.then(f.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){p.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new e(f.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(f.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new e(f.hitch(this,"cancel"));this.onLoadDeferred.then(f.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,b={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
f.isObject(this.ioArgs)&&f.mixin(b,this.ioArgs);var c=this._xhrDfd=(this.ioMethod||v.get)(b),e;c.then(function(b){e=b;try{return a._isDownloaded=!0,a._setContent(b,!1)}catch(y){a._onError("Content",y)}},function(b){c.canceled||a._onError("Download",b);delete a._xhrDfd;return b}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return e});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(w){console.error("Error "+this.widgetId+
" running custom onLoad code: "+w.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(d){console.error("Error "+this.widgetId+" running custom onUnload code: "+d.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var b=this._contentSetter;n.forEach(this.getChildren(),function(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a);b._destroyed=!0});b&&(n.forEach(b.parseResults,function(b){b._destroyed||(b.destroyRecursive?
b.destroyRecursive(a):b.destroy&&b.destroy(a),b._destroyed=!0)}),delete b.parseResults);a||u.empty(this.containerNode);delete this._singleChild},_setContent:function(a,b){a=this.preprocessContent(a);this.destroyDescendants();var c=this._contentSetter;c&&c instanceof r._ContentSetter||(c=this._contentSetter=new r._ContentSetter({node:this.containerNode,_onError:f.hitch(this,this._onError),onContentError:f.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(z){console.error("Fatal "+
this.id+" could not change content due to "+z.message,z)}})}));var d=f.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),d=c.set(f.isObject(a)&&a.domNode?a.domNode:a,d),e=this;return k(d&&d.then?d:c.parseDeferred,function(){delete e._contentSetterParams;b||(e._started&&(e._startChildren(),e._scheduleLayout()),e._onLoadHandler(a))})},
preprocessContent:function(a){return a},_onError:function(a,b,c){this.onLoadDeferred.reject(b);a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],
function(p,f,b,m){return f("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(f,h){var l=this.containerNode;if(0<h){for(l=l.firstChild;0<h;)1==l.nodeType&&h--,l=l.nextSibling;l?h="before":(l=this.containerNode,h="last")}b.place(f.domNode,l,h);this._started&&!f._started&&f.startup()},removeChild:function(b){"number"==typeof b&&(b=this.getChildren()[b]);b&&(b=b.domNode)&&b.parentNode&&b.parentNode.removeChild(b)},
hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(b,f){var h=this.getChildren(),l=p.indexOf(h,b);return h[l+f]},getIndexOfChild:function(b){return p.indexOf(this.getChildren(),b)}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),function(p,f,b,m,l,h,r,n,g,e){return f("dijit.layout._ContentPaneResizeMixin",
null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var b=this.getParent();this._childOfLayoutWidget=b&&b.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(g.on("resize",h.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var c=[],a=!1;r("\x3e *",this.containerNode).some(function(b){var e=n.byNode(b);e&&e.resize?c.push(e):!/script|link|style/i.test(b.nodeName)&&
b.offsetHeight&&(a=!0)});this._singleChild=1!=c.length||a?null:c[0];b.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(b,a){this._resizeCalled=!0;this._scheduleLayout(b,a)},_scheduleLayout:function(b,a){this._isShown()?this._layout(b,a):(this._needLayout=!0,this._changeSize=b,this._resultSize=a)},_layout:function(b,a){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();b&&m.setMarginBox(this.domNode,b);var c=this.containerNode;if(c===
this.domNode){var f=a||{};h.mixin(f,b||{});"h"in f&&"w"in f||(f=h.mixin(m.getMarginBox(c),f));this._contentBox=e.marginBox2contentBox(c,f)}else this._contentBox=m.getContentBox(c);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var b=this._contentBox||m.getContentBox(this.containerNode);this._singleChild.resize({w:b.w,h:b.h})}else for(var b=this.getChildren(),a,e=0;a=b[e++];)a.resize&&a.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&
"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var c=this.domNode,a=this.domNode.parentNode;return"none"!=c.style.display&&"hidden"!=c.style.visibility&&!b.contains(c,"dijitHidden")&&a&&a.style&&"none"!=a.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],
function(p,f,b,m,l){function h(b){return b.substring(0,1).toUpperCase()+b.substring(1)}function r(f,e){var c=f.resize?f.resize(e):b.setMarginBox(f.domNode,e);c?l.mixin(f,c):(l.mixin(f,b.getMarginBox(f.domNode)),l.mixin(f,e))}var n={marginBox2contentBox:function(f,e){var c=m.getComputedStyle(f),a=b.getMarginExtents(f,c),g=b.getPadBorderExtents(f,c);return{l:m.toPixelValue(f,c.paddingLeft),t:m.toPixelValue(f,c.paddingTop),w:e.w-(a.w+g.w),h:e.h-(a.h+g.h)}},layoutChildren:function(b,e,c,a,m){e=l.mixin({},
e);f.add(b,"dijitLayoutContainer");c=p.filter(c,function(a){return"center"!=a.region&&"client"!=a.layoutAlign}).concat(p.filter(c,function(a){return"center"==a.region||"client"==a.layoutAlign}));p.forEach(c,function(b){var c=b.domNode,g=b.region||b.layoutAlign;if(!g)throw Error("No region setting for "+b.id);var d=c.style;d.left=e.l+"px";d.top=e.t+"px";d.position="absolute";f.add(c,"dijitAlign"+h(g));c={};a&&a==b.id&&(c["top"==b.region||"bottom"==b.region?"h":"w"]=m);"leading"==g&&(g=b.isLeftToRight()?
"left":"right");"trailing"==g&&(g=b.isLeftToRight()?"right":"left");"top"==g||"bottom"==g?(c.w=e.w,r(b,c),e.h-=b.h,"top"==g?e.t+=b.h:d.top=e.t+e.h+"px"):"left"==g||"right"==g?(c.h=e.h,r(b,c),e.w-=b.w,"left"==g?e.l+=b.w:d.left=e.l+e.w+"px"):"client"!=g&&"center"!=g||r(b,e)})}};l.setObject("dijit.layout.utils",n);return n})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),function(p,f,b,m,l,h,r){var n=0,g={_secureForInnerHtml:function(b){return b.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,
"")},_emptyNode:h.empty,_setNodeContent:function(b,c){h.empty(b);if(c)if("number"==typeof c&&(c=c.toString()),"string"==typeof c&&(c=h.toDom(c,b.ownerDocument)),!c.nodeType&&f.isArrayLike(c))for(var a=c.length,e=0;e<c.length;e=a==c.length?e+1:0)h.place(c[e],b,"last");else h.place(c,b,"last");return b},_ContentSetter:m("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:p._scopeName,startup:!0,constructor:function(b,c){f.mixin(this,
b||{});c=this.node=l.byId(this.node||c);this.id||(this.id=["Setter",c?c.id||c.tagName:"",n++].join("_"))},set:function(b,c){void 0!==b&&(this.content=b);"number"==typeof b&&(b=b.toString());c&&this._mixin(c);this.onBegin();this.setContent();var a=this.onEnd();return a&&a.then?a:this.node},setContent:function(){var b=this.node;if(!b)throw Error(this.declaredClass+": setContent given no node");try{b=g._setNodeContent(b,this.content)}catch(a){var c=this.onContentError(a);try{b.innerHTML=c}catch(u){console.error("Fatal "+
this.declaredClass+".setContent could not change content due to "+u.message,u)}}this.node=b},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(b.forEach(this.parseResults,function(b){b.destroy&&b.destroy()}),delete this.parseResults);h.empty(this.node)},onBegin:function(){var b=this.content;if(f.isString(b)&&(this.cleanContent&&(b=g._secureForInnerHtml(b)),this.extractContent)){var c=
b.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);c&&(b=c[1])}this.empty();this.content=b;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(b){return"Error occurred setting content: "+b},onExecError:function(b){return"Error occurred executing scripts: "+b},_mixin:function(b){var c={},a;for(a in b)a in c||(this[a]=b[a])},_parse:function(){var e=
this.node;try{var c={};b.forEach(["dir","lang","textDir"],function(a){this[a]&&(c[a]=this[a])},this);var a=this;this.parseDeferred=r.parse({rootNode:e,noStart:!this.startup,inherited:c,scope:this.parserScope}).then(function(b){return a.parseResults=b},function(b){a._onError("Content",b,"Error parsing in _ContentSetter#"+this.id)})}catch(u){this._onError("Content",u,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(b,c,a){b=this["on"+b+"Error"].call(this,c);a?console.error(a,c):b&&g._setNodeContent(this.node,
b,!0)}}),set:function(b,c,a){void 0==c&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),c="");"number"==typeof c&&(c=c.toString());return a?(new g._ContentSetter(f.mixin(a,{content:c,node:b}))).set():g._setNodeContent(b,c,!0)}};f.setObject("dojo.html",g);return g})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(p,f,b,m){return p(m.Credential,{})})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A){var y={},z=function(a){var b=(new r(a.owningSystemUrl)).host;a=(new r(a.server)).host;var c=/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},C=function(a,b){return!!(z(a)&&b&&m.some(b,function(b){return b.test(a.server)}))},B,E=p(t,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=b.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash()},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},
{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(a){var b=this.serverInfos;b?(a=m.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=b.concat(a)):
this.serverInfos=a;m.forEach(a,function(a){a.owningSystemUrl&&this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);var b=u.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);k.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,""));k.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var b=this.oAuthInfos;b?(a=m.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=b.concat(a)):
this.oAuthInfos=a},registerToken:function(a){var c=this._sanitizeUrl(a.server),d=this.findServerInfo(c),e=!0,f;d||(d=new q,d.server=this._getServerInstanceRoot(c),d.tokenServiceUrl=this._getTokenSvcUrl(c),d.hasPortal=!0,this.registerServers([d]));(f=this.findCredential(c,a.userId))?(b.mixin(f,a),e=!1):(f=new B({userId:a.userId,server:d.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:this._isServerRsrc(c)?"server":"portal"}),f.resources=[c],this.credentials.push(f));f.onTokenChange(!1);e||f.refreshServerTokens()},
toJson:function(){return v.fixJson({serverInfos:m.map(this.serverInfos,function(a){return a.toJson()}),oAuthInfos:m.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:m.map(this.credentials,function(a){return a.toJson()})})},initialize:function(a){if(a){b.isString(a)&&(a=h.fromJson(a));var c=a.serverInfos,d=a.oAuthInfos;a=a.credentials;if(c){var e=[];m.forEach(c,function(a){a.server&&a.tokenServiceUrl&&e.push(a.declaredClass?a:new q(a))});e.length&&this.registerServers(e)}if(d){var f=
[];m.forEach(d,function(a){a.appId&&f.push(a.declaredClass?a:new A(a))});f.length&&this.registerOAuthInfos(f)}a&&m.forEach(a,function(a){a.userId&&a.server&&a.token&&a.expires&&a.expires>(new Date).getTime()&&(a=a.declaredClass?a:new B(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var b;a=this._sanitizeUrl(a);m.some(this.serverInfos,function(c){this._hasSameServerInstance(c.server,a)&&(b=c);return!!b},this);return b},findOAuthInfo:function(a){var b;a=this._sanitizeUrl(a);
m.some(this.oAuthInfos,function(c){this._hasSameServerInstance(c.portalUrl,a)&&(b=c);return!!b},this);return b},findCredential:function(a,b){var c,d;a=this._sanitizeUrl(a);d=this._isServerRsrc(a)?"server":"portal";b?m.some(this.credentials,function(e){this._hasSameServerInstance(e.server,a)&&b===e.userId&&e.scope===d&&(c=e);return!!c},this):m.some(this.credentials,function(b){this._hasSameServerInstance(b.server,a)&&-1!==this._getIdenticalSvcIdx(a,b)&&b.scope===d&&(c=b);return!!c},this);return c},
getCredential:function(a,c){var e,g,k=!0;v.isDefined(c)&&(b.isObject(c)?(e=!!c.token,g=c.error,k=!1!==c.prompt):e=c);a=this._sanitizeUrl(a);var h=new l(d._dfdCanceller),t=this._isAdminResource(a),m=e&&this._doPortalSignIn(a)?this._getEsriAuthCookie():null;e=e?this.findCredential(a):null;if(m||e)return k=Error("You are currently signed in as: '"+(m&&m.email||e&&e.userId)+"'. You do not have access to this resource: "+a),k.code="IdentityManagerBase.1",k.httpCode=g&&g.httpCode,k.messageCode=g?g.messageCode:
null,k.subcode=g?g.subcode:null,k.details=g?g.details:null,k.log=f.isDebug,h.errback(k),h;if(g=this._findCredential(a,c))return h.callback(g),h;g=this.findServerInfo(a);if(g)!g.hasServer&&this._isServerRsrc(a)&&(g._restInfoDfd=this._getTokenSvcUrl(a,!0),g.hasServer=!0);else{m=this._getTokenSvcUrl(a);if(!m)return k=Error("Unknown resource - could not find token service endpoint."),k.code="IdentityManagerBase.2",k.log=f.isDebug,h.errback(k),h;g=new q;g.server=this._getServerInstanceRoot(a);b.isString(m)?
(g.tokenServiceUrl=m,g.hasPortal=!0):(g._restInfoDfd=m,g.hasServer=!0);this.registerServers([g])}k&&g.hasPortal&&void 0===g._selfReq&&!this._findOAuthInfo(a)&&(g._selfReq={owningTenant:c&&c.owningTenant,selfDfd:this._getPortalSelf(g.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),a)});return this._enqueue(a,g,c,h,t)},getResourceName:function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,
"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(c,d,e){var g,h,q,t,l,m,n=this._rePortalTokenSvc.test(c.tokenServiceUrl),u=new r(window.location.href.toLowerCase()),v=this._getEsriAuthCookie(),x,p=!d;t=c.shortLivedTokenValidity;var A;d&&(A=a.id.tokenValidity||t||a.id.defaultTokenValidity,A>t&&(A=t));e&&(g=e.isAdmin,h=e.serverUrl,q=e.token,m=e.ssl,c.customParameters=e.customParameters);g?t=c.adminTokenServiceUrl:
(t=c.tokenServiceUrl,l=new r(t.toLowerCase()),v&&(x=(x=v.auth_tier)&&x.toLowerCase()),("web"===x||c.webTierAuth)&&e&&e.serverUrl&&!m&&"http"===u.scheme&&(k.hasSameOrigin(u.uri,t,!0)||"https"===l.scheme&&u.host===l.host&&"7080"===u.port&&"7443"===l.port)&&(t=t.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),p&&n&&(t=t.replace(/\/rest/i,"")));g=b.mixin({url:t,content:b.mixin({request:"getToken",username:d&&d.username,password:d&&d.password,serverUrl:h,token:q,expiration:A,referer:g||n?window.location.host:
null,client:g?"referer":null,f:"json"},c.customParameters),handleAs:"json",callbackParamName:p?"callback":void 0},e&&e.ioArgs);e={usePost:!p,disableIdentityLookup:!0,useProxy:this._useProxy(c,e)};n||(g.withCredentials=!1);n=w(g,e);n.addCallback(function(a){if(!a||!a.token)return a=Error("Unable to generate token"),a.code="IdentityManagerBase.3",a.log=f.isDebug,a;var b=c.server;y[b]||(y[b]={});d&&(y[b][d.username]=d.password);a.validity=A;return a});n.addErrback(function(a){});return n},isBusy:function(){return!!this._busy},
checkSignInStatus:function(a){return this.getCredential(a,{prompt:!1})},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();m.forEach(a,function(a){a.destroy()})}this.onCredentialsDestroy()},_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===
a.charAt(0)&&(a=a.substring(1));var a=e.queryToObject(a),b=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=h.fromJson(a.state),this._oAuthHash=a,b=!0):a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0));b&&(!n("ie")||8<n("ie"))&&(window.location.hash="")}},_findCredential:function(a,b){var c=-1,d,e,f,g,k=b&&b.token;d=b&&b.resource;var h=this._isServerRsrc(a)?"server":"portal",
q=m.filter(this.credentials,function(b){return this._hasSameServerInstance(b.server,a)&&b.scope===h},this);a=d||a;if(q.length)if(1===q.length)if(d=q[0],f=(e=(g=this.findServerInfo(d.server))&&g.owningSystemUrl)&&this.findCredential(e,d.userId),c=this._getIdenticalSvcIdx(a,d),k)-1!==c&&(d.resources.splice(c,1),this._removeResource(a,f));else return-1===c&&d.resources.push(a),this._addResource(a,f),d;else{var t,l;m.some(q,function(b){l=this._getIdenticalSvcIdx(a,b);return-1!==l?(t=b,f=(e=(g=this.findServerInfo(t.server))&&
g.owningSystemUrl)&&this.findCredential(e,t.userId),c=l,!0):!1},this);if(k)t&&(t.resources.splice(c,1),this._removeResource(a,f));else if(t)return this._addResource(a,f),t}},_findOAuthInfo:function(a){var b=this.findOAuthInfo(a);b||m.some(this.oAuthInfos,function(c){this._isIdProvider(c.portalUrl,a)&&(b=c);return!!b},this);return b},_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,b){var c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&
b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!k.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!k.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new r(a);return a.scheme+"://"+a.host+(v.isDefined(a.port)?":"+a.port:"")},_getServerInstanceRoot:function(a){var b=a.toLowerCase(),c=b.indexOf(this._agsRest);-1===c&&this._isAdminResource(a)&&(c=b.indexOf("/admin"));-1===
c&&(c=b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a},_hasSameServerInstance:function(a,b){a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b},_sanitizeUrl:function(a){a=k.fixUrl(b.trim(a));var c=(u.defaults.io.proxyUrl||"").toLowerCase(),d=c?a.toLowerCase().indexOf(c+"?"):-1;-1!==d&&(a=a.substring(d+c.length+1));return k.urlToObject(a).path},_isRESTService:function(a){return-1<
a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,b){var c;if(this._isRESTService(a)&&this._isRESTService(b)){var d=this._getSuffix(a).toLowerCase(),e=this._getSuffix(b).toLowerCase();c=d===e;c||(c=/(.*)\/(MapServer|FeatureServer).*/ig,c=d.replace(c,"$1")===e.replace(c,"$1"))}else this._isAdminResource(a)&&this._isAdminResource(b)?
c=!0:this._isServerRsrc(a)||this._isServerRsrc(b)||!this._isPortalDomain(a)||(c=!0);return c},_isPortalDomain:function(a){a=a.toLowerCase();var c=(new r(a)).authority,d=this._portalConfig,e=-1!==c.indexOf(this._agolSuffix);!e&&d&&(e=this._hasSameServerInstance(this._getServerInstanceRoot(d.restBaseUrl),a));e||(!this._arcgisUrl&&(d=b.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new r(d)).authority),this._arcgisUrl&&(e=this._arcgisUrl.toLowerCase()===c));e||(e=m.some(this._portals,function(b){return this._hasSameServerInstance(b,
a)},this));return e=e||this._agsPortal.test(a)},_isIdProvider:function(a,b){var c=-1,d=-1;m.forEach(this._gwDomains,function(e,f){-1===c&&e.regex.test(a)&&(c=f);-1===d&&e.regex.test(b)&&(d=f)});var e=!1;if(-1<c&&-1<d)if(0===c||4===c){if(0===d||4===d)e=!0}else if(1===c){if(1===d||2===d)e=!0}else 2===c?2===d&&(e=!0):3===c&&3===d&&(e=!0);if(!e){var f=this.findServerInfo(b),g=f&&f.owningSystemUrl;g&&z(f)&&this._isPortalDomain(g)&&this._isIdProvider(a,g)&&(e=!0)}return e},_isPublic:function(a){a=this._sanitizeUrl(a);
return m.some(this._publicUrls,function(b){return b.test(a)})},_getIdenticalSvcIdx:function(a,b){var c=-1;m.some(b.resources,function(b,d){return this._isIdenticalService(a,b)?(c=d,!0):!1},this);return c},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var b,c;if((b=this._isRESTService(a))||this._isAdminResource(a))return c=a.toLowerCase().indexOf(b?this._agsRest:"/admin/"),b=a.substring(0,c)+"/admin/generateToken",a=
a.substring(0,c)+"/rest/info",c=w({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),c.adminUrl_=b,c;if(this._isPortalDomain(a)){var d="";m.some(this._gwDomains,function(b){b.regex.test(a)&&(d=b.tokenServiceUrl);return!!d});d||m.some(this._portals,function(b){this._hasSameServerInstance(b,a)&&(d=b+this._gwTokenUrl);return!!d},this);d||(c=a.toLowerCase().indexOf("/sharing"),-1!==c&&(d=a.substring(0,c)+this._gwTokenUrl));d||(d=this._getOrigin(a)+this._gwTokenUrl);d&&(b=(new r(a)).port,
/^http:\/\//i.test(a)&&"7080"===b&&(d=d.replace(/:7080/i,":7443")),d=d.replace(/http:/i,"https:"));return d}if(-1!==a.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_getPortalSelf:function(a,b){"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return w({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},
{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},_getEsriAuthCookie:function(){var a;if(g.isSupported()){var b=this._getAllCookies("esri_auth"),c;for(c=0;c<b.length;c++){var d=h.fromJson(b[c]);if(d.portalApp){a=d;break}}}return a},_getAllCookies:function(a){var b=[],d=document.cookie.match(new RegExp("(?:^|; )"+c.escapeString(a)+"\x3d([^;]*)","g"));if(d)for(a=0;a<d.length;a++){var e=d[a],f=e.indexOf("\x3d");-1<f&&(e=e.substring(f+1),b.push(decodeURIComponent(e)))}return b},
_doPortalSignIn:function(a){if(g.isSupported()){var b=this._getEsriAuthCookie(),c=this._portalConfig,d=window.location.href,e=this.findServerInfo(a);if(this.useSignInPage&&(c||this._isPortalDomain(d)||b)&&(e?e.hasPortal||e.owningSystemUrl&&this._isPortalDomain(e.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(d,a)||c&&(this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a)||this._isIdProvider(c.restBaseUrl,a))||k.hasSameOrigin(d,a,!0)))return!0}return!1},_checkProtocol:function(a,
c,d,e){var g=!0;e=e?c.adminTokenServiceUrl:c.tokenServiceUrl;0!==b.trim(e).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||u.defaults.io.useCors&&(k.canUseXhr(e)||k.canUseXhr(k.getProxyUrl(!0).path))||(g=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:c}):!1,g||(a=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),a.code="IdentityManagerBase.4",a.log=f.isDebug,console.log(a.message),d(a)));return g},
_enqueue:function(a,b,c,e,f,g){e||(e=new l(d._dfdCanceller));e.resUrl_=a;e.sinfo_=b;e.options_=c;e.admin_=f;e.refresh_=g;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(e)):this._xoReqs.push(e):this._doSignIn(e);return e},_doSignIn:function(a){this._busy=a;var c=this,d=function(b){var d=a.options_&&a.options_.resource,e=a.resUrl_,f=a.refresh_,g=!1;-1===m.indexOf(c.credentials,
b)&&(f&&-1!==m.indexOf(c.credentials,f)?(f.userId=b.userId,f.token=b.token,f.expires=b.expires,f.validity=b.validity,f.ssl=b.ssl,f.creationTime=b.creationTime,g=!0,b=f):c.credentials.push(b));b.resources||(b.resources=[]);b.resources.push(d||e);b.scope=c._isServerRsrc(e)?"server":"portal";b.onTokenChange();var d=c._soReqs,k={};c._soReqs=[];m.forEach(d,function(a){if(!this._isIdenticalService(e,a.resUrl_)){var c=this._getSuffix(a.resUrl_);k[c]||(k[c]=!0,b.resources.push(a.resUrl_))}},c);a.callback(b);
m.forEach(d,function(a){a.callback(b)});c._busy=a.resUrl_=a.sinfo_=a.refresh_=null;if(!g)c.onCredentialCreate({credential:b});c._soReqs.length&&c._doSignIn(c._soReqs.shift());c._xoReqs.length&&c._doSignIn(c._xoReqs.shift())},e=function(b){a.errback(b);c._busy=a.resUrl_=a.sinfo_=a.refresh_=null;c._soReqs.length&&c._doSignIn(c._soReqs.shift());c._xoReqs.length&&c._doSignIn(c._xoReqs.shift())},g=function(b,g,k,h){var q=a.sinfo_,t=!a.options_||!1!==a.options_.prompt,l=q.hasPortal&&c._findOAuthInfo(a.resUrl_);
c._doPortalSignIn(a.resUrl_)?(b=c._getEsriAuthCookie(),l=c._portalConfig,b?d(new B({userId:b.email,server:q.server,token:b.token,expires:null})):t?(t="",b=window.location.href,t=c.signInPage?c.signInPage:l?l.baseUrl+l.signin:c._isIdProvider(b,a.resUrl_)?c._getOrigin(b)+"/home/signin.html":q.tokenServiceUrl.replace(c._rePortalTokenSvc,"")+"/home/signin.html",t=t.replace(/http:/i,"https:"),l&&!1===l.useSSL&&(t=t.replace(/https:/i,"http:")),0===b.toLowerCase().replace("https","http").indexOf(t.toLowerCase().replace("https",
"http"))?(q=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+a.resUrl_),q.code="IdentityManagerBase.5",q.log=f.isDebug,e(q)):c._redirectFunc?c._redirectFunc({signInPage:t,returnUrlParamName:"returnUrl",returnUrl:b,resourceUrl:a.resUrl_,serverInfo:q}):window.location=t+"?returnUrl\x3d"+window.escape(b)):(q=Error("User is not signed in."),q.code="IdentityManagerBase.6",q.log=f.isDebug,e(q))):b?d(new B({userId:b,server:q.server,token:k,
expires:v.isDefined(h)?Number(h):null,ssl:!!g})):l?(b=l._oAuthCred,b||(g=new x(l,window.localStorage),k=new x(l,window.sessionStorage),g.isValid()&&k.isValid()?g.expires>k.expires?(b=g,k.destroy()):(b=k,g.destroy()):b=g.isValid()?g:k,l._oAuthCred=b),b.isValid()?d(new B({userId:b.userId,server:q.server,token:b.token,expires:b.expires,ssl:b.ssl,_oAuthCred:b})):c._oAuthHash&&c._oAuthHash.state.portalUrl===l.portalUrl?(t=c._oAuthHash,q=new B({userId:t.username,server:q.server,token:t.access_token,expires:(new Date).getTime()+
1E3*Number(t.expires_in),ssl:"true"===t.ssl,oAuthState:t.state,_oAuthCred:b}),b.storage=t.persist?window.localStorage:window.sessionStorage,b.token=q.token,b.expires=q.expires,b.userId=q.userId,b.ssl=q.ssl,b.save(),c._oAuthHash=null,d(q)):t?a._pendingDfd=c.oAuthSignIn(a.resUrl_,q,l,a.options_).addCallbacks(d,e):(q=Error("User is not signed in."),q.code="IdentityManagerBase.6",q.log=f.isDebug,e(q))):t?c._checkProtocol(a.resUrl_,q,e,a.admin_)&&(t=a.options_,a.admin_&&(t=t||{},t.isAdmin=!0),a._pendingDfd=
c.signIn(a.resUrl_,q,t).addCallbacks(d,e)):(q=Error("User is not signed in."),q.code="IdentityManagerBase.6",q.log=f.isDebug,e(q))},k=function(){var b=a.sinfo_,f=b.owningSystemUrl,g=a.options_,k,h,q,t;g&&(k=g.token,h=g.error,q=g.prompt);t=c._findCredential(f,{token:k,resource:a.resUrl_});!t&&z(b)&&m.some(c.credentials,function(a){this._isIdProvider(f,a.server)&&(t=a);return!!t},c);t?(g=c.findCredential(a.resUrl_,t.userId))?d(g):C(b,c._legacyFed)?(g=t.toJson(),g.server=b.server,g.resources=null,d(new B(g))):
(a._pendingDfd=c.generateToken(c.findServerInfo(t.server),null,{serverUrl:a.resUrl_,token:t.token,ssl:t.ssl})).addCallbacks(function(c){d(new B({userId:t.userId,server:b.server,token:c.token,expires:v.isDefined(c.expires)?Number(c.expires):null,ssl:!!c.ssl,isAdmin:a.admin_,validity:c.validity}))},e):(c._busy=null,k&&(a.options_.token=null),(a._pendingDfd=c.getCredential(f.replace(/\/?$/,"/sharing"),{resource:a.resUrl_,owningTenant:b.owningTenant,token:k,error:h,prompt:q})).addCallbacks(function(b){c._enqueue(a.resUrl_,
a.sinfo_,a.options_,a,a.admin_)},function(a){e(a)}))},h=a.sinfo_.owningSystemUrl,q=this._isServerRsrc(a.resUrl_),t=a.sinfo_._restInfoDfd;t?t.addCallbacks(function(d){var e=a.sinfo_;e.adminTokenServiceUrl=e._restInfoDfd.adminUrl_;e._restInfoDfd=null;e.tokenServiceUrl=b.getObject("authInfo.tokenServicesUrl",!1,d)||b.getObject("authInfo.tokenServiceUrl",!1,d)||b.getObject("tokenServiceUrl",!1,d);e.shortLivedTokenValidity=b.getObject("authInfo.shortLivedTokenValidity",!1,d);e.currentVersion=d.currentVersion;
e.owningTenant=d.owningTenant;(d=e.owningSystemUrl=d.owningSystemUrl)&&c._portals.push(d);q&&d?k():g()},function(){a.sinfo_._restInfoDfd=null;var b=Error("Unknown resource - could not find token service endpoint.");b.code="IdentityManagerBase.2";b.log=f.isDebug;e(b)}):q&&h?k():a.sinfo_._selfReq?a.sinfo_._selfReq.selfDfd.then(function(b){var d={},e,f,g,k;b&&(e=b.user&&b.user.username,d.username=e,d.allSSL=b.allSSL,f=b.supportsOAuth,g=b.currentVersion,"multitenant"===b.portalMode&&(k=b.customBaseUrl));
a.sinfo_.webTierAuth=!!e;return e&&c.normalizeWebTierAuth?c.generateToken(a.sinfo_,null,{ssl:d.allSSL}).always(function(a){d.portalToken=a&&a.token;d.tokenExpiration=a&&a.expires;return d}):!e&&f&&4.4<=parseFloat(g)&&!c._doPortalSignIn(a.resUrl_)?c._generateOAuthInfo({portalUrl:a.sinfo_.server,customBaseUrl:k,owningTenant:a.sinfo_._selfReq.owningTenant}).always(function(){return d}):d}).always(function(b){a.sinfo_._selfReq=null;b?g(b.username,b.allSSL,b.portalToken,b.tokenExpiration):g()}):g()},_generateOAuthInfo:function(a){var b=
this,c,d=a.portalUrl,e=a.customBaseUrl,f=a.owningTenant;if(a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){c=window.location.href;var g=c.indexOf("?");-1<g&&(c=c.slice(0,g));g=c.search(/\/(apps|home)\//);c=-1<g?c.slice(0,g):null}a&&c?(this._hasTestedIfAppIsOnPortal=!0,a=w({url:c+"/sharing/rest",content:{f:"json"},handleAs:"json"}).then(function(){b.defaultOAuthInfo=new A({appId:"arcgisonline",popup:!0,popupCallbackUrl:c+"/home/oauth-callback.html"})})):(a=
new l,a.resolve(),a=a.promise);return a.then(function(){if(b.defaultOAuthInfo)return d=d.replace(/^http:/i,"https:"),w({url:d+"/sharing/rest/oauth2/validateRedirectUri",content:{accountId:f,client_id:b.defaultOAuthInfo.appId,redirect_uri:k.getAbsoluteUrl(b.defaultOAuthInfo.popupCallbackUrl),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.valid){var c=b.defaultOAuthInfo.clone();c.portalUrl=a.urlKey&&e?"https://"+a.urlKey+"."+e:d;b.oAuthInfos.push(c)}})})}});B=p(t,{declaredClass:"esri.Credential",
tokenRefreshBuffer:2,constructor:function(a){b.mixin(this,a);this.resources=this.resources||[];v.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var b=this,c=this.resources&&this.resources[0],d=a.id.findServerInfo(this.server),e=d&&d.owningSystemUrl,f=!!e&&"server"===this.scope,g=f&&C(d,a.id._legacyFed),k=f&&a.id.findServerInfo(e),h,q=(h=d.webTierAuth)&&a.id.normalizeWebTierAuth,t=y[this.server],t=t&&t[this.userId],l={username:this.userId,
password:t},n;if(!h||q)if(f&&!k&&m.some(a.id.serverInfos,function(b){a.id._isIdProvider(e,b.server)&&(k=b);return!!k}),h=k&&a.id.findCredential(k.server,this.userId),!f||h)if(g)h.refreshToken();else{if(f)n={serverUrl:c,token:h&&h.token,ssl:h&&h.ssl};else if(q)l=null,n={ssl:this.ssl};else if(t)this.isAdmin&&(n={isAdmin:!0});else{var u;c&&(c=a.id._sanitizeUrl(c),this._enqueued=1,u=a.id._enqueue(c,d,null,null,this.isAdmin,this),u.addCallback(function(){b._enqueued=0;b.refreshServerTokens()}).addErrback(function(){b._enqueued=
0}));return u}return a.id.generateToken(f?k:d,f?null:l,n).addCallback(function(a){b.token=a.token;b.expires=v.isDefined(a.expires)?Number(a.expires):null;b.creationTime=(new Date).getTime();b.validity=a.validity;b.onTokenChange();b.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&m.forEach(a.id.credentials,function(b){var c=a.id.findServerInfo(b.server),d=c&&c.owningSystemUrl;b!==this&&b.userId===this.userId&&d&&"server"===b.scope&&(a.id._hasSameServerInstance(this.server,
d)||a.id._isIdProvider(d,this.server))&&(C(c,a.id._legacyFed)?(b.token=this.token,b.expires=this.expires,b.creationTime=this.creationTime,b.validity=this.validity,b.onTokenChange()):b.refreshToken())},this)},onTokenChange:function(b){clearTimeout(this._refreshTimer);var c=this.server&&a.id.findServerInfo(this.server),d=(c=c&&c.owningSystemUrl)&&a.id.findServerInfo(c);!1!==b&&(!c||"portal"===this.scope||d&&d.webTierAuth&&!a.id.normalizeWebTierAuth)&&(v.isDefined(this.expires)||v.isDefined(this.validity))&&
this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var b=m.indexOf(a.id.credentials,this);-1<b&&a.id.credentials.splice(b,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=v.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,
validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b);return a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var a=6E4*this.tokenRefreshBuffer,c=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>c&&(c=0);this._refreshTimer=setTimeout(b.hitch(this,this.refreshToken),c>a?c-a:c)}});E.Credential=B;return E})},"esri/ServerInfo":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","./kernel","./lang"],function(p,f,b,m,l){return p(null,{declaredClass:"esri.ServerInfo",constructor:function(b){f.mixin(this,b)},toJson:function(){return l.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,
webTierAuth:this.webTierAuth})}})})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has","dojo/json"],function(p,f,b,m){return f(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(b,f){this.oAuthInfo=b;this.storage=f;this._init()},isValid:function(){var b=!1;if(this.oAuthInfo&&this.token&&this.userId){var f=(new Date).getTime();this.expires>f&&(this.expires-f)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&
(b=!0)}return b},save:function(){if(this.storage){var b=this._load(),f=this.oAuthInfo;if(f&&f.authNamespace&&f.portalUrl){var r=b[f.authNamespace];r||(r=b[f.authNamespace]={});r[f.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",m.stringify(b))}catch(n){console.log(n)}}}},destroy:function(){var b=this._load(),f=this.oAuthInfo;if(f&&f.authNamespace&&f.portalUrl&&this.storage){var r=b[f.authNamespace];if(r){delete r[f.portalUrl];
try{this.storage.setItem("esriJSAPIOAuth",m.stringify(b))}catch(n){console.log(n)}}}f&&(this.oAuthInfo=f._oAuthCred=null)},_init:function(){var b=this._load(),f=this.oAuthInfo;f&&f.authNamespace&&f.portalUrl&&(b=b[f.authNamespace])&&(b=b[f.portalUrl])&&(this.expires=b.expires,this.ssl=b.ssl,this.token=b.token,this.userId=b.userId)},_load:function(){var b={};if(this.storage){var f=this.storage.getItem("esriJSAPIOAuth");if(f)try{b=m.parse(f)}catch(r){console.log(r)}}return b}})})},"esri/arcgis/OAuthInfo":function(){define(["../kernel",
"../lang","dojo/_base/declare","dojo/_base/lang","dojo/has"],function(p,f,b,m,l){var h=b(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(b){m.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,showSocialLogins:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},b)},_oAuthCred:null,toJson:function(){return f.fixJson({appId:this.appId,
expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,showSocialLogins:this.showSocialLogins,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})},clone:function(){return new h(this.toJson())}});return h})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),
function(p,f,b,m,l,h,r,n,g,e){m("dijit-legacy-requires")&&r(0,function(){p(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});r=f("dijit.form.Button"+(m("dojo-bidi")?"_NoBidi":""),[n,g],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:e,_setValueAttr:"valueNode",_setNameAttr:function(b){this.valueNode&&this.valueNode.setAttribute("name",b)},postCreate:function(){this.inherited(arguments);
this._setLabelFromContainer()},_setLabelFromContainer:function(){this.containerNode&&!this.label&&(this.label=h.trim(this.containerNode.innerHTML),this.onLabelSet())},_setShowLabelAttr:function(c){this.containerNode&&b.toggle(this.containerNode,"dijitDisplayNone",!c);this._set("showLabel",c)},setLabel:function(b){l.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",b)},onLabelSet:function(){this.inherited(arguments);this.showLabel||
"title"in this.params||(this.titleNode.title=h.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});m("dojo-bidi")&&(r=f("dijit.form.Button",r,{onLabelSet:function(){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(b){this._created&&this.textDir!=b&&(this._set("textDir",b),this._setLabelAttr(this.label))}}));return r})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),
function(p,f,b,m,l,h,r,n){f("dijit-legacy-requires")&&m(0,function(){require(["dijit/form/_FormValueWidget"])});return p("dijit.form._FormWidget",[l,r,h,n],{setDisabled:function(f){b.deprecated("setDisabled("+f+") is deprecated. Use set('disabled',"+f+") instead.","","2.0");this.set("disabled",f)},setValue:function(f){b.deprecated("dijit.form._FormWidget:setValue("+f+") is deprecated.  Use set('value',"+f+") instead.","","2.0");this.set("value",f)},getValue:function(){b.deprecated(this.declaredClass+
"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!f("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(p,f,b,m,l,h,r,n,g,e){return f("dijit.form._FormWidgetMixin",
null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(c){this._set("disabled",c);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?b.set(this.focusNode,"disabled",c):this.focusNode.setAttribute("aria-disabled",c?"true":"false");this.valueNode&&b.set(this.valueNode,"disabled",c);c?(this._set("hovering",!1),
this._set("active",!1),c="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",p.forEach(l.isArray(c)?c:[c],function(a){a=this[a];n("webkit")||e.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(b){if("mouse"==b&&this.isFocusable())var a=this.own(r(this.focusNode,"focus",function(){e.remove();a.remove()}))[0],c=n("pointer-events")?
"pointerup":n("MSPointer")?"MSPointerUp":n("touch-events")?"touchend, mouseup":"mouseup",e=this.own(r(this.ownerDocumentBody,c,l.hitch(this,function(b){e.remove();a.remove();this.focused&&("touchend"==b.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){g.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=m.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(c){}},
compare:function(b,a){return"number"==typeof b&&"number"==typeof a?isNaN(b)&&isNaN(a)?0:b-a:b>a?1:b<a?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(b,a){void 0!=this._lastValueReported||null!==a&&this._onChangeActive||(this._resetValue=this._lastValueReported=b);this._pendingOnChange=this._pendingOnChange||typeof b!=typeof this._lastValueReported||0!=this.compare(b,this._lastValueReported);(this.intermediateChanges||a||void 0===a)&&this._pendingOnChange&&(this._lastValueReported=
b,this._pendingOnChange=!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(b)})))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],
function(p,f,b,m){var l=p("dijit.form._ButtonMixin"+(b("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(b){b.stopPropagation();b.preventDefault();this.disabled||this.valueNode.click(b);return!1},_onClick:function(b){if(this.disabled)return b.stopPropagation(),b.preventDefault(),!1;!1===this.onClick(b)&&b.preventDefault();var f=b.defaultPrevented;if(!f&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var h=this.domNode;h.parentNode;h=h.parentNode){var g=m.byNode(h);
if(g&&"function"==typeof g._onSubmit){g._onSubmit(b);b.preventDefault();f=!0;break}}return!f},postCreate:function(){this.inherited(arguments);f.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(b){this._set("label",b);(this.containerNode||this.focusNode).innerHTML=b;this.onLabelSet()},onLabelSet:function(){}});b("dojo-bidi")&&(l=p("dijit.form._ButtonMixin",l,{onLabelSet:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));
return l})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(p,f,b,m,l,h,r,n){return p("dijit.form.Form",[l,h,r,n],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",
postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(b){f.set(this.domNode,"encType",b);m("ie")&&(this.domNode.encoding=b);this._set("encType",b)},reset:function(b){var e={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:b?b.target:this.domNode,target:b?b.target:this.domNode};!1!==this.onReset(e)&&e.returnValue&&
this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(b){this.reset(b);b.stopPropagation();b.preventDefault();return!1},_onSubmit:function(f){var e=this.constructor.prototype;if(this.execute!=e.execute||this.onExecute!=e.onExecute)b.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(f)&&(f.stopPropagation(),f.preventDefault())},onSubmit:function(){return this.isValid()},
submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),function(p,f,b,m,l,h,r){var n=p("dijit.form.ValidationTextBox",l,{templateString:r,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",
regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(b,e){e!=n.prototype[b]&&(f.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+b+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",e))},_setRegExpGenAttr:function(b){this._deprecateRegExp("regExpGen",b);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(b){this._deprecateRegExp("regExp",b)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},
validator:function(b,e){return(new RegExp("^(?:"+this._computeRegexp(e)+")"+(this.required?"":"?")+"$")).test(b)&&(!this.required||!this._isEmpty(b))&&(this._isEmpty(b)||void 0!==this.parse(b,e))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,this.get("constraints"))},_isEmpty:function(b){return(this.trim?/^\s*$/:/^$/).test(b)},getErrorMessage:function(){var b="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:
this.invalidMessage?this.invalidMessage:this.promptMessage,e="$_unset_$"==this.missingMessage?this.messages.missingMessage:this.missingMessage?this.missingMessage:b;return this.required&&this._isEmpty(this.textbox.value)?e:b},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(b){var e="",c=this.disabled||this.isValid(b);c&&(this._maskValidSubsetError=!0);var a=this._isEmpty(this.textbox.value),f=!c&&b&&this._isValidSubset();this._set("state",c?"":((!this._hasBeenBlurred||
b)&&a||f)&&(this._maskValidSubsetError||f&&!this._hasBeenBlurred&&b)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=b&&f,e=this.getErrorMessage(b)):"Incomplete"==this.state?(e=this.getPromptMessage(b),this._maskValidSubsetError=!this._hasBeenBlurred||b):a&&(e=this.getPromptMessage(b));this.set("message",e);return c},displayMessage:function(b){b&&this.focused?h.show(b,this.domNode,this.tooltipPosition,
!this.isLeftToRight()):h.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(f){this.constraints=b.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(b){!b.locale&&this.lang&&(b.locale=this.lang);this._set("constraints",b);this._refreshState()},_setPatternAttr:function(b){this._set("pattern",b);this._refreshState()},
_computeRegexp:function(b){var e=this.pattern;"function"==typeof e&&(e=e.call(this,b));if(e!=this._lastRegExp){var c="";this._lastRegExp=e;".*"!=e&&e.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":c+=a;break;case ")":c+="|$)";break;default:c+="(?:"+a+"|$)"}});try{"".search(c)}catch(a){c=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+
c+")$"}return e},postMixInProperties:function(){this.inherited(arguments);this.messages=m.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(b){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(b){this._set("required",b);this.focusNode.setAttribute("aria-required",b);this._refreshState()},_setMessageAttr:function(b){this._set("message",b);this.displayMessage(b)},reset:function(){this._maskValidSubsetError=
!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){h.hide(this.domNode);this.inherited(arguments)}});return n})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){n=p("dijit.form.TextBox"+(r("dojo-bidi")?"_NoBidi":""),
[n,g],{templateString:e,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:r("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=
this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>r("ie")&&this.defer(function(){try{var a=b.getComputedStyle(this.domNode);if(a){var c=a.fontFamily;if(c){var e=this.domNode.getElementsByTagName("INPUT");if(e)for(a=0;a<e.length;a++)e[a].style.fontFamily=c}}}catch(q){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||(this._attachPoints.push("_phspan"),this._phspan=f.create("span",{className:"dijitPlaceHolder dijitInputField"},
this.textbox,"after"),this.own(h(this._phspan,"mousedown",function(a){a.preventDefault()}),h(this._phspan,"touchend, pointerup, MSPointerUp",l.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},
_setValueAttr:function(a,b,c){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){m.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){m.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),
this._updatePlaceHolder(),r("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){this.disabled||this.readOnly||(this.inherited(arguments),this._updatePlaceHolder())}});9>r("ie")&&(n.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},c._setSelectionRange=g._setSelectionRange=function(a,b,c){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),
a.moveStart("character",-99999),a.moveStart("character",b),a.moveEnd("character",c-b),a.select())});r("dojo-bidi")&&(n=p("dijit.form.TextBox",n,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return n})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(p,f,b,m){return p("dijit.form._FormValueWidget",[b,m],{_layoutHackIE7:function(){if(7==f("ie"))for(var b=this.domNode,h=b.parentNode,
m=b.firstChild||b,n=m.style.filter,g=this;h&&0==h.clientHeight;)(function(){var b=g.connect(h,"onscroll",function(){g.disconnect(b);m.style.filter=(new Date).getMilliseconds();g.defer(function(){m.style.filter=n})})})(),h=h.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(p,f,b,m,l,h){return p("dijit.form._FormValueMixin",h,{readOnly:!1,_setReadOnlyAttr:function(b){f.set(this.focusNode,
"readOnly",b);this._set("readOnly",b)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(b,f){this._handleOnChange(b,f)},_handleOnChange:function(b,f){this._set("value",b);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),
function(p,f,b,m,l,h,r,n){var g=f("dijit.form._TextBoxMixin"+(m("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(b,c,a){var e;void 0!==b&&(e=this.filter(b),"string"!=typeof a&&(a=null===e||"number"==typeof e&&isNaN(e)?"":this.filter(this.format(e,this.constraints)),0!=this.compare(e,this.filter(this.parse(a,this.constraints)))&&
(a=null)));null==a||"number"==typeof a&&isNaN(a)||this.textbox.value==a||(this.textbox.value=a,this._set("displayedValue",this.get("displayedValue")));this.inherited(arguments,[e,c])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(b){null==b?b="":"string"!=typeof b&&(b=String(b));this.textbox.value=b;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(b){return null==
b?"":b.toString?b.toString():b},parse:function(b){return b},_refreshState:function(){},onInput:function(){},_onInput:function(b){this._lastInputEventValue=this.textbox.value;this._processInput(this._lastInputProducingEvent||b);delete this._lastInputProducingEvent;this.intermediateChanges&&this._handleOnChange(this.get("value"),!1)},_processInput:function(){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);
this.inherited(arguments);this.own(r(this.textbox,"keydown, keypress, paste, cut, compositionend",h.hitch(this,function(b){var c;if("keydown"==b.type&&229!=b.keyCode){c=b.keyCode;switch(c){case l.SHIFT:case l.ALT:case l.CTRL:case l.META:case l.CAPS_LOCK:case l.NUM_LOCK:case l.SCROLL_LOCK:return}if(!b.ctrlKey&&!b.metaKey&&!b.altKey){switch(c){case l.NUMPAD_0:case l.NUMPAD_1:case l.NUMPAD_2:case l.NUMPAD_3:case l.NUMPAD_4:case l.NUMPAD_5:case l.NUMPAD_6:case l.NUMPAD_7:case l.NUMPAD_8:case l.NUMPAD_9:case l.NUMPAD_MULTIPLY:case l.NUMPAD_PLUS:case l.NUMPAD_ENTER:case l.NUMPAD_MINUS:case l.NUMPAD_PERIOD:case l.NUMPAD_DIVIDE:return}if(65<=
c&&90>=c||48<=c&&57>=c||c==l.SPACE)return;c=!1;for(var a in l)if(l[a]===b.keyCode){c=!0;break}if(!c)return}}(c=32<=b.charCode?String.fromCharCode(b.charCode):b.charCode)||(c=65<=b.keyCode&&90>=b.keyCode||48<=b.keyCode&&57>=b.keyCode||b.keyCode==l.SPACE?String.fromCharCode(b.keyCode):b.keyCode);c||(c=229);if("keypress"==b.type){if("string"!=typeof c)return;if("a"<=c&&"z">=c||"A"<=c&&"Z">=c||"0"<=c&&"9">=c||" "===c)if(b.ctrlKey||b.metaKey||b.altKey)return}var e={faux:!0},f;for(f in b)/^(layer[XY]|returnValue|keyLocation)$/.test(f)||
(a=b[f],"function"!=typeof a&&"undefined"!=typeof a&&(e[f]=a));h.mixin(e,{charOrCode:c,_wasConsumed:!1,preventDefault:function(){e._wasConsumed=!0;b.preventDefault()},stopPropagation:function(){b.stopPropagation()}});this._lastInputProducingEvent=e;!1===this.onInput(e)&&(e.preventDefault(),e.stopPropagation());if(!e._wasConsumed&&9>=m("ie"))switch(b.keyCode){case l.TAB:case l.ESCAPE:case l.DOWN_ARROW:case l.UP_ARROW:case l.LEFT_ARROW:case l.RIGHT_ARROW:break;default:b.keyCode==l.ENTER&&"textarea"!=
this.textbox.tagName.toLowerCase()||this.defer(function(){this.textbox.value!==this._lastInputEventValue&&r.emit(this.textbox,"input",{bubbles:!0})})}})),r(this.textbox,"input",h.hitch(this,"_onInput")),r(this.domNode,"keypress",function(b){b.stopPropagation()}))},_blankValue:"",filter:function(b){if(null===b)return this._blankValue;if("string"!=typeof b)return b;this.trim&&(b=h.trim(b));this.uppercase&&(b=b.toUpperCase());this.lowercase&&(b=b.toLowerCase());this.propercase&&(b=b.replace(/[^\s]+/g,
function(b){return b.substring(0,1).toUpperCase()+b.substring(1)}));return b},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(b){this.disabled||(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(b){this.disabled||this.readOnly||(this.selectOnClick&&"mouse"==b&&(this._selectOnClickHandle=r.once(this.domNode,"mouseup, touchend",h.hitch(this,function(b){this._isTextSelected()||
g.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});m("dojo-bidi")&&(g=f("dijit.form._TextBoxMixin",g,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);
this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));g._setSelectionRange=n._setSelectionRange=function(b,c,a){b.setSelectionRange&&b.setSelectionRange(c,a)};g.selectInputText=n.selectInputText=function(e,c,a){e=b.byId(e);isNaN(c)&&(c=0);isNaN(a)&&(a=e.value?e.value.length:0);try{e.focus(),g._setSelectionRange(e,c,a)}catch(u){}};return g})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w){function t(){}var x=f("dijit._MasterTooltip",[v,q],{duration:a.defaultDuration,templateString:d,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new k(this.domNode);this.fadeIn=b.fadeIn({node:this.domNode,duration:this.duration,onEnd:n.hitch(this,"_onShow")});this.fadeOut=b.fadeOut({node:this.domNode,duration:this.duration,onEnd:n.hitch(this,"_onHide")})},show:function(a,b,c,d,e,f,g){if(!this.aroundNode||this.aroundNode!==
b||this.containerNode.innerHTML!=a)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{this.containerNode.innerHTML=a;e&&this.set("textDir",e);this.containerNode.align=d?"right":"left";var k=u.around(this.domNode,b,c&&c.length?c:A.defaultPosition,!d,n.hitch(this,"orient")),h=k.aroundNodePos;"M"==k.corner.charAt(0)&&"M"==k.aroundCorner.charAt(0)?(this.connectorNode.style.top=h.y+(h.h-this.connectorNode.offsetHeight>>1)-k.y+"px",this.connectorNode.style.left=""):"M"==k.corner.charAt(1)&&
"M"==k.aroundCorner.charAt(1)?this.connectorNode.style.left=h.x+(h.w-this.connectorNode.offsetWidth>>1)-k.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");r.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=f||t;this.onMouseLeave=g||t}},orient:function(a,b,d,e,f){this.connectorNode.style.top="";var g=e.h;e=e.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove",
"BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[b+"-"+d];this.domNode.style.width="auto";var k=h.position(this.domNode);if(c("ie")||c("trident"))k.w+=2;h.setMarginBox(this.domNode,{w:Math.min(Math.max(e,1),k.w)});"B"==d.charAt(0)&&"B"==b.charAt(0)?(a=h.position(a),b=this.connectorNode.offsetHeight,
a.h>g?(this.connectorNode.style.top=g-(f.h+b>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(f.h/2-b/2,0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,k.w-e)},_onShow:function(){c("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=!1,this.aroundNode=
null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=t},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});c("dojo-bidi")&&x.extend({_setAutoTextDir:function(a){this.applyTextDir(a);p.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=this.textDir}});w.showTooltip=
function(a,b,c,d,e,f,g){c&&(c=p.map(c,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));A._masterTT||(w._masterTT=A._masterTT=new x);return A._masterTT.show(a,b,c,d,e,f,g)};w.hideTooltip=function(a){return A._masterTT&&A._masterTT.hide(a)};var A=f("dijit.Tooltip",v,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(a){p.forEach(this._connections||[],function(a){p.forEach(a,function(a){a.remove()})},this);this._connectIds=
p.filter(n.isArrayLike(a)?a:a?[a]:[],function(a){return m.byId(a,this.ownerDocument)},this);this._connections=p.map(this._connectIds,function(a){a=m.byId(a,this.ownerDocument);var b=this.selector,c=b?function(a){return e.selector(b,a)}:function(a){return a},d=this;return[e(a,c(g.enter),function(){d._onHover(this)}),e(a,c("focusin"),function(){d._onHover(this)}),e(a,c(g.leave),n.hitch(d,"_onUnHover")),e(a,c("focusout"),n.hitch(d,"set","state","DORMANT"))]},this);this._set("connectId",a)},addTarget:function(a){a=
a.id||a;-1==p.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=p.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);l.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;p.forEach(n.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||this.domNode.innerHTML},
state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(A.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state","SHOWING")},
this.showDelay));break;case "SHOWING":var b=this.getContent(this._connectNode);if(!b){this.set("state","DORMANT");return}A.show(b,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,n.hitch(this,"set","state","SHOWING"),n.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&a!=this._connectNode&&
this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state","HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");p.forEach(this._connections||[],function(a){p.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});A._MasterTooltip=x;A.show=
w.showTooltip;A.hide=w.hideTooltip;A.defaultPosition=["after-centered","before-centered"];return A})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(p,f,b,m,l,h,r){function n(e,c,a,g){var m=h.getEffectiveBox(e.ownerDocument);e.parentNode&&"body"==String(e.parentNode.tagName).toLowerCase()||l.body(e.ownerDocument).appendChild(e);var q=null;p.some(c,function(b){var c=b.corner,d=b.pos,k=0,h=
{w:{L:m.l+m.w-d.x,R:d.x-m.l,M:m.w}[c.charAt(1)],h:{T:m.t+m.h-d.y,B:d.y-m.t,M:m.h}[c.charAt(0)]},l=e.style;l.left=l.right="auto";a&&(k=a(e,b.aroundCorner,c,h,g),k="undefined"==typeof k?0:k);var n=e.style,u=n.display,v=n.visibility;"none"==n.display&&(n.visibility="hidden",n.display="");l=f.position(e);n.display=u;n.visibility=v;u={L:d.x,R:d.x-l.w,M:Math.max(m.l,Math.min(m.l+m.w,d.x+(l.w>>1))-l.w)}[c.charAt(1)];v={T:d.y,B:d.y-l.h,M:Math.max(m.t,Math.min(m.t+m.h,d.y+(l.h>>1))-l.h)}[c.charAt(0)];d=Math.max(m.l,
u);n=Math.max(m.t,v);u=Math.min(m.l+m.w,u+l.w)-d;v=Math.min(m.t+m.h,v+l.h)-n;k+=l.w-u+(l.h-v);if(null==q||k<q.overflow)q={corner:c,aroundCorner:b.aroundCorner,x:d,y:n,w:u,h:v,overflow:k,spaceAvailable:h};return!k});q.overflow&&a&&a(e,q.aroundCorner,q.corner,q.spaceAvailable,g);c=q.y;var k=q.x,d=l.body(e.ownerDocument);/relative|absolute/.test(b.get(d,"position"))&&(c-=b.get(d,"marginTop"),k-=b.get(d,"marginLeft"));d=e.style;d.top=c+"px";d.left=k+"px";d.right="auto";return q}var g={TL:"BR",TR:"BL",
BL:"TR",BR:"TL"};return r.place={at:function(b,c,a,f,h){a=p.map(a,function(a){var b={corner:a,aroundCorner:g[a],pos:{x:c.x,y:c.y}};f&&(b.pos.x+="L"==a.charAt(1)?f.x:-f.x,b.pos.y+="T"==a.charAt(0)?f.y:-f.y);return b});return n(b,a,h)},around:function(e,c,a,g,h){function q(a,b){E.push({aroundCorner:a,corner:b,pos:{x:{L:r,R:r+C,M:r+(C>>1)}[a.charAt(1)],y:{T:z,B:z+B,M:z+(B>>1)}[a.charAt(0)]}})}var k;if("string"==typeof c||"offsetWidth"in c||"ownerSVGElement"in c){if(k=f.position(c,!0),/^(above|below)/.test(a[0])){var d=
f.getBorderExtents(c),l=c.firstChild?f.getBorderExtents(c.firstChild):{t:0,l:0,b:0,r:0},t=f.getBorderExtents(e),u=e.firstChild?f.getBorderExtents(e.firstChild):{t:0,l:0,b:0,r:0};k.y+=Math.min(d.t+l.t,t.t+u.t);k.h-=Math.min(d.t+l.t,t.t+u.t)+Math.min(d.b+l.b,t.b+u.b)}}else k=c;if(c.parentNode)for(d="absolute"==b.getComputedStyle(c).position,c=c.parentNode;c&&1==c.nodeType&&"BODY"!=c.nodeName;){l=f.position(c,!0);t=b.getComputedStyle(c);/relative|absolute/.test(t.position)&&(d=!1);if(!d&&/hidden|auto|scroll/.test(t.overflow)){var u=
Math.min(k.y+k.h,l.y+l.h),v=Math.min(k.x+k.w,l.x+l.w);k.x=Math.max(k.x,l.x);k.y=Math.max(k.y,l.y);k.h=u-k.y;k.w=v-k.x}"absolute"==t.position&&(d=!0);c=c.parentNode}var r=k.x,z=k.y,C="w"in k?k.w:k.w=k.width,B="h"in k?k.h:(m.deprecated("place.around: dijit/place.__Rectangle: { x:"+r+", y:"+z+", height:"+k.height+", width:"+C+" } has been deprecated.  Please use { x:"+r+", y:"+z+", h:"+k.height+", w:"+C+" }","","2.0"),k.h=k.height),E=[];p.forEach(a,function(a){var b=g;switch(a){case "above-centered":q("TM",
"BM");break;case "below-centered":q("BM","TM");break;case "after-centered":b=!b;case "before-centered":q(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":q(b?"TL":"TR",b?"TR":"TL");q(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":q(b?"BL":"BR",b?"TL":"TR");q(b?"BR":"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":q(b?"TL":"TR",b?"BL":"BR");q(b?"TR":"TL",b?"BR":"BL");break;default:q(a.aroundCorner,a.corner)}});e=n(e,E,h,{w:C,h:B});e.aroundNodePos=k;return e}}})},
"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,b,d,g){var k=this._oAuthDfd=new n;k.resUrl_=a;k.sinfo_=b;k.oinfo_=d;var h=!g||!1!==g.oAuthPopupConfirmation;if(!d.popup||!h)return this._doOAuthSignIn(a,b,d),k;this._nls||(this._nls=c.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;b=g&&g.error;g=g&&g.token;f.hide(a.errMsg_);b&&403==b.code&&g&&(e.set(a.errMsg_,"innerHTML",this._nls.forbidden),f.show(a.errMsg_));a.show();
return k},setOAuthResponseHash:function(b){var c=this._oAuthDfd;this._oAuthDfd=null;if(c&&b)if(clearInterval(this._oAuthIntervalId),"#"===b.charAt(0)&&(b=b.substring(1)),b=a.queryToObject(b),b.error)b=Error("access_denied"===b.error?"ABORTED":"OAuth: "+b.error+" - "+b.error_description),b.code="IdentityManagerBase.2",b.log=r.isDebug,c.errback(b);else{var d=c.oinfo_._oAuthCred,e=new p({userId:b.username,server:c.sinfo_.server,token:b.access_token,expires:(new Date).getTime()+1E3*Number(b.expires_in),
ssl:"true"===b.ssl,_oAuthCred:d});d.storage=b.persist?window.localStorage:window.sessionStorage;d.token=e.token;d.expires=e.expires;d.userId=e.userId;d.ssl=e.ssl;d.save();c.callback(e)}},_createOAuthDialog:function(){var a=this._nls,c=b.substitute(a,this._oAuthDialogContent),d=new l({title:a.title,content:c,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=d.esriIdMgr_._oAuthDfd;d.hide_();d.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=
d.esriIdMgr_._oAuthDfd;d.esriIdMgr_._oAuthDfd=null;d.hide_();var b=Error("ABORTED");b.code="IdentityManager.2";b.log=r.isDebug;a.errback(b)},hide_:function(){f.hide(d.errMsg_);d.hide();l._DialogLevelManager.hide(d)}}),a=d.domNode;d.btnSubmit_=h.byNode(g.query(".esriIdSubmit",a)[0]);d.btnCancel_=h.byNode(g.query(".esriIdCancel",a)[0]);d.errMsg_=g.query(".esriErrorMsg",a)[0];d.connect(d.btnSubmit_,"onClick",d.execute_);d.connect(d.btnCancel_,"onClick",d.onCancel);d.connect(d,"onCancel",d.cancel_);return d},
_doOAuthSignIn:function(b,c,d){var e=this,f={client_id:d.appId,response_type:"token",state:v.stringify({portalUrl:d.portalUrl}),expiration:d.expiration,locale:d.locale,redirect_uri:d.popup?m.getAbsoluteUrl(d.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};d.forceLogin&&(f.force_login=!0);d.showSocialLogins&&(f.showSocialLogins=!0);var g=d.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",k=g+"?"+a.objectToQuery(f);if(d.popup){var h;7===u("ie")?(h=window.open(d.popupCallbackUrl,
"esriJSAPIOAuth",d.popupWindowFeatures),h.location=k):h=window.open(k,"esriJSAPIOAuth",d.popupWindowFeatures);h?(h.focus(),this._oAuthDfd.oAuthWin_=h,this._oAuthIntervalId=setInterval(function(){if(h.closed){clearInterval(e._oAuthIntervalId);var a=e._oAuthDfd;if(a){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=r.isDebug;a.errback(b)}}},500)):(b=Error("ABORTED"),b.code="IdentityManager.2",b.log=r.isDebug,this._oAuthDfd.errback(b))}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:f,
authorizeUrl:g,resourceUrl:b,serverInfo:c,oAuthInfo:d}):window.location=k}}})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/keys dojo/on jimu/dijit/Popup".split(" "),function(p,f,b,m,l,h){return p(h,{baseClass:"jimu-popup jimu-message",declaredClass:"jimu.dijit.Message",type:"message",message:"",autoHeight:!0,maxWidth:350,maxHeight:180,postMixInProperties:function(){this.content=this.message},_createTitleNode:function(){this.titleLabel&&(this.titleNode=
b.create("div",{"class":"title"},this.domNode),this.titleLabeNode=b.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),this.closeBtnNode=b.create("div",{"class":"close-btn jimu-float-trailing"},this.titleNode),this.own(l(this.closeBtnNode,"click",f.hitch(this,this.close))))},_preProcessing:function(){0===this.buttons.length&&this.buttons.push({label:window.jimuNls.common.ok,key:m.ENTER,onClick:f.hitch(this,this.close)})},_increaseZIndex:function(){b.setStyle(this.domNode,
"zIndex",501);b.setStyle(this.overlayNode,"zIndex",500)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/sniff dojo/touch dojo/query dojo/dnd/move dijit/_WidgetBase jimu/utils".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a){var u=0;return p(c,{declaredClass:"jimu.dijit.Popup",baseClass:"jimu-popup",titleLabel:"",content:null,container:null,buttons:[],enabledButtons:[],disabledButtons:[],onClose:null,_fixedHeight:!1,
autoHeight:!1,maxHeight:800,maxWidth:1024,constructor:function(){this.buttons=[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},postCreate:function(){this._preProcessing();this.inherited(arguments);this._initDomNode();this._positioning();m.place(this.domNode,this.container);setTimeout(f.hitch(this,function(){this._moveToMiddle()}),50);this.own(h(window,"resize",f.hitch(this,function(){this._fixedHeight||this.autoHeight?(this._calculatePosition(),
this._moveToMiddle()):this._positioning()})));this.overlayNode=m.create("div",{"class":"jimu-overlay"},this.container);this._increaseZIndex();l.animateProperty({node:this.domNode,properties:{opacity:1},duration:200}).play();this.domNode.focus()},_preProcessing:function(){"number"===typeof this.height&&(this._fixedHeight=!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=m.create("div",{"class":"title"},this.domNode);this.titleLabeNode=m.create("span",
{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=m.create("div",{"class":"close-btn jimu-icon jimu-icon-close jimu-float-trailing"},this.titleNode);var a=null,a="ontouchstart"in document?n.press:"click";this.own(h(this.closeBtnNode,a,f.hitch(this,this.close)))},_initDomNode:function(){this._createTitleNode();this.contentContainerNode=m.create("div",{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?this.contentContainerNode.innerHTML=
this.content:this.content.domNode?(this.content.placeAt(this.contentContainerNode),this.content.popup=this):1===this.content.nodeType&&m.place(this.content,this.contentContainerNode));this.buttonContainer=m.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&m.setStyle(this.buttonContainer,"display","none");for(var a=this.buttons.length-1;-1<a;a--)this._createButton(this.buttons[a]),this.buttons[a].disable&&this.disableButton(a)},_limitButtonsMaxWidth:function(){var a=
this.enabledButtons.length;if(0!==a){var c=m.getContentBox(this.buttonContainer),e=m.getMarginExtents(this.enabledButtons[0]),d=m.getPadBorderExtents(this.enabledButtons[0]),g=0,d=8===r("ie")?d.l+d.r:0,g=(c.w-(e.l+e.r+d)*a)/a;0<g&&(b.forEach(this.enabledButtons,f.hitch(this,function(a){m.setStyle(a,"maxWidth",g+"px")})),b.forEach(this.disabledButtons,f.hitch(this,function(a){m.setStyle(a,"maxWidth",g+"px")})))}},_moveableNode:function(a,b){this.moveable&&(this.moveable.destroy(),this.moveable=null);
var c=m.getMarginBox(this.container);c.l=c.l-a+b;c.w+=2*(a-b);this.moveable=new e.boxConstrainedMoveable(this.domNode,{box:c,handle:this.titleNode||this.contentContainerNode,within:!0});this.own(h(this.moveable,"Moving",f.hitch(this,this.onMoving)));this.own(h(this.moveable,"MoveStop",f.hitch(this,this.onMoveStop)))},_getHeaderBox:function(){return 0===g("#header").length?{t:0,l:0,w:0,h:0}:m.getMarginBox("header")},_getFooterBox:function(){return 0===g(".footer",this.container).length?{t:0,l:0,w:0,
h:0}:m.getMarginBox(g(".footer",this.container)[0])},_calculatePosition:function(){var a=m.getContentBox(this.container),b=this._getHeaderBox(),c=this._getFooterBox(),c=a.h-b.h-c.h-40,d=0;d=this._fixedHeight?this.height:this.autoHeight?c-200:this.height=c>this.maxHeight?this.maxHeight:c;c=(c-d)/2+b.h+20;c=c<b.h?b.h:c;this.width=this.width||this.maxWidth;m.setStyle(this.domNode,{left:(a.w-this.width)/2+"px",top:c+"px",width:this.width+"px"})},_calculateHeight:function(){this.autoHeight?(m.setStyle(this.domNode,
"height","auto"),m.addClass(this.contentContainerNode,"content-static"),0===this.buttons.length&&m.setStyle(this.contentContainerNode,{marginBottom:"15px"})):(m.setStyle(this.domNode,"height",this.height+"px"),m.addClass(this.contentContainerNode,"content-absolute"),m.addClass(this.buttonContainer,"button-container-absolute"),0===this.buttons.length&&m.setStyle(this.contentContainerNode,{bottom:"15px"}));this._moveableNode(this.width,100)},_moveToMiddle:function(){if(this.autoHeight){var a=m.getMarginBox(this.domNode),
b=m.getContentBox(this.container),c=this._getHeaderBox(),d=this._getFooterBox(),d=b.h-c.h-d.h-40,e=0,e=a.h||d-200,a=(d-e)/2+c.h+20,a=a<c.h?c.h:a;m.setStyle(this.domNode,{left:(b.w-this.width)/2+"px",top:a+"px",width:this.width+"px"})}},_positioning:function(){this._calculatePosition();this._calculateHeight()},_increaseZIndex:function(){m.setStyle(this.domNode,"zIndex",u+200+1);m.setStyle(this.overlayNode,"zIndex",u+200);u++},setTitleLabel:function(b){this.titleNode.innerHTML=a.stripHTML(b)},onMoving:function(a){m.setStyle(a.node,
"opacity",.9)},onMoveStop:function(a){m.setStyle(a.node,"opacity",1)},close:function(){if(!this.onClose||!1!==this.onClose()){var a=this.domNode.parentNode,b=f.clone(this.domNode);m.setStyle(this.domNode,"display","none");m.destroy(this.overlayNode);this.destroy();this.moveable.destroy();m.place(b,a);l.animateProperty({node:b,properties:{opacity:0},duration:200,onEnd:function(){m.destroy(b)}}).play()}},addButton:function(a){this._createButton(a)},_createButton:function(a){var b=" ";a.classNames&&
0<a.classNames.length&&"function"===typeof a.classNames.join&&(b+=a.classNames.join(" "));var c=m.create("div",{"class":"jimu-btn jimu-popup-action-btn jimu-float-trailing jimu-trailing-margin1 "+b,innerHTML:a.label,title:a.title||a.label},this.buttonContainer);this.enabledButtons.unshift(c);b=m.create("div",{"class":"jimu-btn jimu-state-disabled jimu-float-trailing jimu-trailing-margin1 "+b,title:a.title||a.label,innerHTML:a.label,style:{display:"none"}},this.buttonContainer);this.disabledButtons.unshift(b);
this.own(h(c,"click",f.hitch(this,function(b){if(a.onClick)a.onClick(b);else this.close()})))},setButtonProps:function(a,b){"number"===typeof a&&isFinite(a)||(b=a,a=0);if(b&&0!==this.enabledButtons.length)for(var c in b)"title"===c?(m.setAttr(this.enabledButtons[a],"title",b[c]),m.setAttr(this.disabledButtons[a],"title",b[c])):"label"===c&&(m.setProp(this.enabledButtons[a],"innerHTML",b[c]),m.setProp(this.disabledButtons[a],"innerHTML",b[c]))},enableButton:function(a){"number"===typeof a&&isFinite(a)&&
a<this.enabledButtons.length?(m.setStyle(this.enabledButtons[a],"display","inline-block"),m.setStyle(this.disabledButtons[a],"display","none")):(b.forEach(this.enabledButtons[a],f.hitch(this,function(a){m.setStyle(a,"display","inline-block")})),b.forEach(this.disabledButtons[a],f.hitch(this,function(a){m.setStyle(a,"display","none")})))},disableButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.disabledButtons.length?(m.setStyle(this.disabledButtons[a],"display","inline-block"),m.setStyle(this.enabledButtons[a],
"display","none")):(b.forEach(this.disabledButtons,f.hitch(this,function(a){m.setStyle(a,"display","inline-block")})),b.forEach(this.enabledButtons,f.hitch(this,function(a){m.setStyle(a,"display","none")})))},showButton:function(a){this.enableButton(a)},hideButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.disabledButtons.length?(m.setStyle(this.disabledButtons[a],"display","none"),m.setStyle(this.enabledButtons[a],"display","none")):(b.forEach(this.disabledButtons,f.hitch(this,function(a){m.setStyle(a,
"display","none")})),b.forEach(this.enabledButtons,f.hitch(this,function(a){m.setStyle(a,"display","none")})))}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(p,f,b,m,l,h){m=p("dojo.dnd.move.constrainedMoveable",h,{constraints:function(){},within:!1,constructor:function(b,f){f||(f={});this.constraints=f.constraints;this.within=f.within},onFirstMove:function(b){var h=this.constraintBox=this.constraints.call(this,
b);h.r=h.l+h.w;h.b=h.t+h.h;this.within&&(b=f.getMarginSize(b.node),h.r-=b.w,h.b-=b.h)},onMove:function(b,f){var g=this.constraintBox,e=b.node.style;this.onMoving(b,f);f.l=f.l<g.l?g.l:g.r<f.l?g.r:f.l;f.t=f.t<g.t?g.t:g.b<f.t?g.b:f.t;e.left=f.l+"px";e.top=f.t+"px";this.onMoved(b,f)}});l=p("dojo.dnd.move.boxConstrainedMoveable",m,{box:{},constructor:function(b,f){var g=f&&f.box;this.constraints=function(){return g}}});p=p("dojo.dnd.move.parentConstrainedMoveable",m,{area:"content",constructor:function(h,
l){var g=l&&l.area;this.constraints=function(){var e=this.node.parentNode,c=b.getComputedStyle(e),a=f.getMarginBox(e,c);if("margin"==g)return a;var h=f.getMarginExtents(e,c);a.l+=h.l;a.t+=h.t;a.w-=h.w;a.h-=h.h;if("border"==g)return a;h=f.getBorderExtents(e,c);a.l+=h.l;a.t+=h.t;a.w-=h.w;a.h-=h.h;if("padding"==g)return a;h=f.getPadExtents(e,c);a.l+=h.l;a.t+=h.t;a.w-=h.w;a.h-=h.h;return a}}});return{constrainedMoveable:m,boxConstrainedMoveable:l,parentConstrainedMoveable:p}})},"builder/tokenUtils":function(){define(["jimu/tokenUtils"],
function(p){return p})},"builder/utils":function(){define(["dojo/request/xhr","dojo/cookie","jimu/portalUrlUtils","jimu/utils"],function(p,f,b,m){return{appendParamsToAppPath:function(b,f){var h=b,l;for(l in f)f.hasOwnProperty(l)&&(h=0>h.indexOf("?")?h+"?"+l+"\x3d"+f[l]:h+"\x26"+l+"\x3d"+f[l]);return h},removeActionFromUrl:function(b){return m.url.removeQueryParamFromUrl(b,"action")},checkProtocolAndUpdateSigninInfo:function(l,h){var m=h.portalUrl,n=m,g="https"===b.getProtocol(m),e=!!l.allSSL;g!==
e&&e&&(n=b.setHttpsProtocol(m));h.portalUrl=n;return p("/webappbuilder/rest/signininfo/setsignininfo",{handleAs:"json",data:h,method:"POST"}).then(function(b){b.success&&(f("wab_portalurl",n,{path:"/webappbuilder"}),f("wab_portalurl",n,{path:"/webappviewer"}),f("wab_portalurl_persistent",n,{path:"/",expires:365}));return b})}}})},"builder/PluginManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/Evented dojo/aspect dojo/promise/all jimu/utils".split(" "),
function(p,f,b,m,l,h,r,n,g){var e=null,c=p(h,{constructor:function(a){this.loaded=[];a&&(this.pluginsMeta=a)},loadPlugin:function(a){var b=new l,c;a=f.clone(a);if(c=this.getPluginByName(a.name))b.resolve(c);else{if(!1===a.properties.hasClass)return c={name:a.name},this.loaded.push(c),b.resolve(c),b;this.loadPluginClass(a).then(f.hitch(this,function(c){this.loadPluginResources(a).then(f.hitch(this,function(e){try{var d=this.createPlugin(a,c,e)}catch(w){console.log("create ["+a.uri+"] error:"+w.stack),
b.reject(w)}setTimeout(f.hitch(this,function(){b.resolve(d);this.emit("pluginCreated",d)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)})}return b},getExtensions:function(a){var b=[],c;for(c in this.pluginsMeta)for(var e=this.pluginsMeta[c],f=0;f<e.extensions.length;f++){var d=e.extensions[f];d.point===a&&b.push(d)}return b},getStemappInfo:function(a){for(var b=this.getExtensions("startup.stemapps"),c={},e=0;e<b.length;e++){var f=b[e];if(f.parameters.appType===a){var d=this.pluginsMeta[f.pluginName];
c.appPath=f.parameters.appPath?d.folderUrl+f.parameters.appPath:d.folderUrl;c.appVersionManager=f.parameters.appVersionManager;c.appType=a;c.thumbnail=c.appPath+"images/thumbnail.png"}}return c},loadPluginClass:function(a){var b=new l;require([a.uri],f.hitch(this,function(a){b.resolve(a)}));return b},loadPluginResources:function(a){var b=new l,c,e,g=[];c=this.loadPluginI18n(a);e=this.loadPluginStyle(a);a=this.loadPluginTemplate(a);g.push(c);g.push(a);g.push(e);n(g).then(f.hitch(this,function(a){var c=
{};c.i18n=a[0];c.template=a[1];c.style=a[2];b.resolve(c)}),function(a){b.reject(a)});return b},createPlugin:function(a,b,c){if(this.getPluginByName(a.name))return this.getPluginByName(a.name);a.nls=c.i18n||{};c.template&&(a.templateString=c.template);a["class"]="builder-plugin";a.pluginsMeta=this.pluginsMeta;a.pluginManager=this;a=new b(a);r.before(a,"destroy",f.hitch(this,this._onDestroyPlugin,a));this.loaded.push(a);return a},getAllPlugins:function(){return this.loaded},destroyAllPlugins:function(){var a=
b.map(this.loaded,function(a){return a.id});b.forEach(a,function(a){this.destroyPlugin(a)},this);this.loaded=[]},getPluginByName:function(a){var c;b.some(this.loaded,function(b){if(b.name===a)return c=b,!0},this);return c},loadPluginStyle:function(a){var b="plugin/style/"+a.uri,c=new l;if(!1===a.properties.hasStyle)return c.resolve(null),c;b=this._replaceId(b);return m.byId(b)?(c.resolve("load"),c):g.loadStyleLink(b,a.amdFolder+"css/style.css")},loadPluginI18n:function(a){var b=new l;if(!1===a.properties.hasLocale)return b.resolve(null),
b;require(["dojo/i18n!"+a.amdFolder+"nls/strings"],function(a){b.resolve(a)});return b},loadPluginTemplate:function(a){var b=new l;if(!1===a.properties.hasUIFile)return b.resolve(null),b;require(["dojo/text!"+a.amdFolder+"Plugin.html"],function(a){b.resolve(a)});return b},removePluginStyle:function(a){m.destroy(this._replaceId("plugin/style/"+a.uri))},_remove:function(a){return b.some(this.loaded,function(b,c){if(b.id===a)return this.loaded.splice(c,1),!0},this)},_replaceId:function(a){return a.replace(/\//g,
"_").replace(/\./g,"_")},_onDestroyPlugin:function(a){"closed"!==a.state&&this.closePlugin(a);this._removePlugin(a)},_removePlugin:function(a){if("string"===typeof a&&(a=this.getPluginByName(a),!a))return;this.removePluginStyle(a);this._remove(a.id)}});c.getInstance=function(a){null===e?e=new c(a):a&&(e.pluginsMeta=a);return e};return c})},"builder/plugins/_build-generate_plugins_module":function(){define("builder/plugins/app-actions/launch-app/_build-generate_module builder/plugins/app-actions/preview-app/_build-generate_module builder/plugins/app-actions/save-app/_build-generate_module builder/plugins/app-actions/to-template-config/_build-generate_module builder/plugins/app-config/_build-generate_module builder/plugins/app-config-configpart/_build-generate_module builder/plugins/app-config-morepreview-selectionpart/_build-generate_module builder/plugins/app-config-template-configpart/_build-generate_module builder/plugins/app-config-templateconfig/_build-generate_module builder/plugins/app-list/_build-generate_module builder/plugins/attribute-config/_build-generate_module builder/plugins/creation-entry/_build-generate_module builder/plugins/header/_build-generate_module builder/plugins/map-config/_build-generate_module builder/plugins/popup-actions/configmode-switch/_build-generate_module builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module builder/plugins/popup-actions/popup-saveas/_build-generate_module builder/plugins/popup-actions/popup-share/_build-generate_module builder/plugins/startup/_build-generate_module builder/plugins/stemapps/web2d/_build-generate_module builder/plugins/stemapps/web3d/_build-generate_module builder/plugins/theme-config/_build-generate_module builder/plugins/widget-config/_build-generate_module".split(" "),
function(){})},"builder/plugins/app-actions/launch-app/_build-generate_module":function(){define(["builder/plugins/app-actions/launch-app/Plugin","dojo/text!builder/plugins/app-actions/launch-app/css/style.css","dojo/i18n!builder/plugins/app-actions/launch-app/nls/strings"],function(){})},"builder/plugins/app-actions/launch-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/topic builder/BasePlugin dojo/_base/html jimu/portalUrlUtils jimu/utils builder/utils".split(" "),
function(p,f,b,m,l,h,r,n,g){return p([l],{baseClass:"plugin-app-actions-launch-app",postCreate:function(){this.inherited(arguments);var b;if(window.isXT)b=window.appInfo.appPath;else{var c=n.urlToObject(window.location.href).query||{};b="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer";var a=window.appInfo.id;"HTML"===a?a="stemapp":"HTML3D"===a&&(a="stemapp3d");b=c.appid?window.portalUrl+"apps/"+b+"/index.html?appid\x3d"+a:window.portalUrl+"apps/"+b+"/index.html?id\x3d"+a;delete c.id;
delete c.appid;delete c.apiurl;delete c.apiurl3d;delete c.edit;delete c.folderid;b=g.appendParamsToAppPath(b,c)}c=h.create("a",{href:b,target:"_blank"},this.domNode);h.create("div",{"class":"footer-button",title:this.nls.label,innerHTML:this.nls.label},c);this._bindEvent()},_bindEvent:function(){this.own(m.subscribe("app/appConfigLoaded",f.hitch(this,this._setAppConfig)));this.own(m.subscribe("app/appConfigChanged",f.hitch(this,this._setAppConfig)))},_setAppConfig:function(b){this.appConfig=b;this.visible=
!b.templateConfig||b.isTemplateApp||b._appData?!0:!1}})})},"builder/BasePlugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(p,f,b,m,l,h){return p([l,h],{id:void 0,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",baseClass:null,templateString:"\x3cdiv\x3e\x3c/div\x3e",constructor:function(){this.extensions={};this.own(m.subscribe("publishData",f.hitch(this,this._onReceiveData)));
this.own(m.subscribe("dataFetched",f.hitch(this,this._onReceiveData)));this.own(m.subscribe("noData",f.hitch(this,this._onNoData)))},getPluginsMetaByExtensionPoint:function(f){var h=[];b.forEach(this.extensionPoints[f].extensions,function(b){h.push(this.pluginsMeta[b.pluginName])},this);return h},filterExtensionsByAppType:function(f,h){if(!this.extensionPoints[f].parameters||!this.extensionPoints[f].parameters.supportAppTypes)return this.extensionPoints[f].extensions;var g=[];b.forEach(this.extensionPoints[f].extensions,
function(b){("all"===b.parameters.supportAppTypes||-1<b.parameters.supportAppTypes.indexOf(h))&&g.push(b)},this);return g},onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},onMaximize:function(){},onSignIn:function(b){},onSignOut:function(){},setState:function(b){this.state=b},setWindowState:function(b){this.windowState=b},resize:function(){},publishData:function(b,f){"undefined"===typeof f&&(f=!1);m.publish("publishData",this.name,this.id,b,f)},fetchData:function(f){f?
m.publish("fetchData",f):0!==this.listenWidgetIds.length?b.forEach(this.listenWidgetIds,function(b){m.publish("fetchData",b)},this):m.publish("fetchData")},fetchDataByName:function(f){f=this.widgetManager.getWidgetsByName(f);b.forEach(f,function(b){this.fetchData(b.id)},this)},_onReceiveData:function(b,f,g,e){if(f!==this.id&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(f)))this.onReceiveData(b,f,g,e)},onReceiveData:function(b,f,g,e){},_onNoData:function(b,f){if(!(0!==this.listenWidgetIds.length&&
0>this.listenWidgetIds.indexOf(f)))this.onNoData(b,f)},onNoData:function(b,f){}})})},"builder/plugins/app-actions/preview-app/_build-generate_module":function(){define(["builder/plugins/app-actions/preview-app/Plugin","dojo/text!builder/plugins/app-actions/preview-app/Plugin.html","dojo/text!builder/plugins/app-actions/preview-app/css/style.css","dojo/i18n!builder/plugins/app-actions/preview-app/nls/strings"],function(){})},"builder/plugins/app-actions/preview-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang builder/BasePlugin dojo/_base/html dojo/on dojo/topic".split(" "),
function(p,f,b,m,l,h){return p([b],{baseClass:"plugin-app-actions-preview-app",postCreate:function(){this.inherited(arguments);this.own(l(this.domNode,"click",f.hitch(this,this._onClick)));this._bindEvent();this.mode="config"},_onClick:function(){var b=this.pluginManager.getPluginByName("app-config"),f=this.pluginManager.getPluginByName("popup-actions.configmode-switch");"none"===m.getStyle(this.btnConfig,"display")?(b.switchToPreviewMore(),f.visible=!1,m.setStyle(this.btnPreview,"display","none"),
m.setStyle(this.btnConfig,"display","inline-block"),this.mode="preview"):(f.visible=this.appConfig.templateConfig&&this.appConfig.isTemplateApp||this.appConfig.templateConfig&&this.appConfig._appData?!0:!1,f.isAdvance?b.switchToPreviewConfig():b.switchToTemplateConfigPart(),m.setStyle(this.btnPreview,"display","inline-block"),m.setStyle(this.btnConfig,"display","none"),this.mode="config")},_bindEvent:function(){this.own(h.subscribe("app/appConfigLoaded",f.hitch(this,this._setAppConfig)));this.own(h.subscribe("app/appConfigChanged",
f.hitch(this,this._setAppConfig)))},_setAppConfig:function(b){this.appConfig=b}})})},"builder/plugins/app-actions/save-app/_build-generate_module":function(){define(["builder/plugins/app-actions/save-app/Plugin","dojo/text!builder/plugins/app-actions/save-app/Plugin.html","dojo/text!builder/plugins/app-actions/save-app/css/style.css","dojo/i18n!builder/plugins/app-actions/save-app/nls/strings"],function(){})},"builder/plugins/app-actions/save-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/Deferred dojo/on dojo/promise/all jimu/utils jimu/dijit/Message jimu/dijit/Popup builder/BasePlugin builder/serviceUtils jimu/portalUrlUtils builder/portalUtils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v){return p([c],{baseClass:"plugin-app-actions-save-app",lastAppConfig:null,disabled:null,boxNodeOfMainAppActionPlugin:null,boxNodeOfSaveAppPluginInConfigTemplatePage:null,_user:null,_itemGroups:null,postMixInProperties:function(){this.inherited(arguments);this.nls=f.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);var b=u.getStandardPortalUrl(window.portalUrl),c=v.getPortal(b);"HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id?this._blockSaveButton():
(b=c.getUser(),window.isXT?(c=new l,c.resolve()):c=c.getItemById(window.appInfo.id).then(f.hitch(this,function(a){return a.getItemGroups()})),r({user:b,itemGroups:c}).then(f.hitch(this,function(b){this._user=b.user;this._itemGroups=b.itemGroups;a.canSaveApp(this._user,window.appInfo.appOwner,this._itemGroups)||this._blockSaveButton()}),f.hitch(this,function(a){this._blockSaveButton();console.log(a)})));this.own(m.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)));this.own(m.subscribe("app/appConfigLoaded",
f.hitch(this,this._onAppConfigLoaded)));this.own(m.subscribe("closeAppConfigPage",f.hitch(this,this._onLeavePage)));this.own(h(this.domNode,"click",f.hitch(this,this._onClick)));this.label=this.nls.label},_onClick:function(){this.saveApp()},_enableSaveButton:function(){b.addClass(this.actionNode,"save-enable");b.removeClass(this.actionNode,"save-disabled");b.setStyle(this.domNode,"cursor","pointer");b.setAttr(this.actionNode,"innerHTML",this.nls.save);b.setAttr(this.actionNode,"title",this.nls.save);
this.disabled=!1},_disableSaveButton:function(){b.removeClass(this.actionNode,"save-enable");b.addClass(this.actionNode,"save-disabled");b.setStyle(this.domNode,"cursor","default");b.setAttr(this.actionNode,"innerHTML",this.nls.saved);b.setAttr(this.actionNode,"title",this.nls.saved);this.disabled=!0},_blockSaveButton:function(){b.addClass(this.actionNode,"save-block");b.setStyle(this.domNode,"cursor","default")},_onAppConfigLoaded:function(a){this.lastAppConfig=f.clone(a);this._setAppConfig(a)},
_onAppConfigChanged:function(a){this.lastAppConfig||(this.lastAppConfig=f.clone(a));this._setAppConfig(a)},_setAppConfig:function(a){this.appConfig=f.clone(a);this._appHasChanged()?(this._enableSaveButton(),this._enableUnloadDlg()):(this._disableSaveButton(),this._disableUnloadDlg())},_appHasChanged:function(){if(!a.canSaveApp(this._user,window.appInfo.appOwner,this._itemGroups)||!this.appConfig)return!1;var b=f.clone(this.appConfig.getCleanConfig()),c=f.clone(this.lastAppConfig.getCleanConfig());
b.theme&&b.theme.styles&&c.theme&&c.theme.styles&&(b.theme.styles.splice(1,b.theme.styles.length),c.theme.styles.splice(1,c.theme.styles.length));return!n.isEqual(b,c)},saveApp:function(){var a=new l;this._appHasChanged()?(b.setAttr(this.actionNode,"innerHTML",this.nls.saving),b.setAttr(this.actionNode,"title",this.nls.saving),this._saveApp().then(f.hitch(this,function(b){b.success?(this._disableSaveButton(),this._disableUnloadDlg(),a.resolve()):a.reject()}),f.hitch(this,function(b){this._enableSaveButton();
a.reject(b)}))):a.resolve();return a},_saveApp:function(){var b=new l,c=this.appConfig;a.saveApp(window.appInfo.id,c.getCleanConfig()).then(f.hitch(this,function(a){a.success?(this.lastAppConfig=f.clone(c),b.resolve(a),(a=this.pluginManager.getPluginByName("app-list"))&&window.isXT&&a.refreshAppPage()):(new g({message:this.nls.saveFailedMeg+": "+a.message}),b.reject())}),f.hitch(this,function(a){new g({message:this.nls.saveFailedMeg});console.error(a);b.reject()}));return b},_enableUnloadDlg:function(){window.onbeforeunload=
f.hitch(this,function(){return this.nls.theApp+' "'+this.options.name+'" '+this.nls.unloadMessage})},_disableUnloadDlg:function(){window.onbeforeunload=null},_onLeavePage:function(a){var b=this.pluginManager.getPluginByName("header");if(this._appHasChanged())var c=new e({content:"\x3cdiv style\x3d'font-size: 14px'\x3e\x3cimg class\x3d'alert-image jimu-float-leading'  src\x3d'"+this.folderUrl+"css/images/alert.png'  style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+
this.nls.unSaveMegBegin+this.options.name+this.nls.unSaveMegEnd+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.toHomeTitle,width:525,height:180,buttons:[{label:this.nls.save,onClick:f.hitch(this,function(){this._saveApp().then(f.hitch(this,function(d){c.close();d.success&&(window.onbeforeunload=null,b.setAppName(""),a())}),f.hitch(this,function(a){console.error(this.nls.saveFailedMeg,a)}))})},{label:this.nls.doNotSave,onClick:f.hitch(this,function(){c.close();window.onbeforeunload=null;b.setAppName("");
a()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,function(){c.close()})}]});else window.onbeforeunload=null,a()}})})},"builder/serviceUtils":function(){define("dojo/_base/lang dojo/request/xhr dojo/Deferred dojo/json dojo/_base/array jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/Role builder/portalUtils dojo/promise/all builder/tokenUtils".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a){function u(a){return f("/webappbuilder/rest/signininfo/getsignininfo",{query:{portalUrl:a},
handleAs:"json"})}function v(a){var b=[];a&&0<a.length&&l.forEach(a,function(a){a&&"string"===typeof a&&(a=r.getServerByUrl(a),b.push(a))});return b}function q(a,b,c,d,e,f){b.title=a.name;b.isWebTier=f;b.authorizedCrossOriginDomains=v(e.authorizedCrossOriginDomains);b.portalUrl=c;b.map.itemId=d;b.geometryService=e.helperServices.geometry.url;b.map.mapOptions||(b.map.mapOptions={});"HTML"!==a.appType||a.webmap||(b.map.mapOptions.extent=e.defaultExtent);a="/proxy.js";window.isXT||(a=r.getPortalProxyUrl(b.portalUrl),
a=r.removeProtocol(a));b.httpProxy={useProxy:!0,url:a}}function k(a,c,d){var f=new b,g=new b,k={title:a.name,type:"Web Mapping Application",typeKeywords:"Web AppBuilder, Ready To Use, JavaScript, "+("HTML"===a.appType?"WAB2D":"WAB3D"),text:m.stringify(c),snippet:a.description,tags:a.tags},h=r.getStandardPortalUrl(window.portalUrl),t=e.getPortal(h);t.getUser().then(function(b){a.folderId===b.username&&(a.folderId="");var c={q:"owner:"+b.username+" title:"+k.title+' type:"Web Mapping Application"'};
d?g.resolve(b):t.queryItems(c).then(function(a){0<a.total?(g.reject(),f.resolve({success:!1,unsuccessCode:"01-01"})):g.resolve(b)},function(a){g.reject();f.reject(a)})},function(a){g.reject();f.reject(a)});g.then(function(b){b.addItem(k,a.folderId).then(function(d){if(d.success){if(d.user=b,f.resolve(d),!(c.appConfig&&c.appConfig.templateConfig&&c.appConfig._appData)){var e=r.getStandardPortalUrl(window.portalUrl),e=r.getItemUrl(e,d.id),e=r.removeProtocol(e);b.addItem({title:a.name,type:"Code Attachment",
typeKeywords:"Code, Web Mapping Application, Javascript",relationshipType:"WMA2Code",originItemId:d.id,url:e+"/package"},a.folderId).then(function(a){a.success||console.error(builderNls.createCodeAttachmentError)},function(a){console.error(builderNls.createCodeAttachmentError,a.message)})}}else f.resolve(d)},function(a){f.reject(a)})});return f}function d(a){var c=new b;f(window.stemappInfo.name+"/"+a+"/list.json",{handleAs:"json"}).then(function(b){return w(b,a).then(function(a){c.resolve({success:!0,
manifests:a})})},function(a){c.reject({success:!1,message:a.message})});return c}function w(a,d){var e=[],g=new b;a._buildInfo&&a._buildInfo.manifestsMerged?f(window.stemappInfo.name+"/"+d+"/"+d+"-manifest-builder.json",{handleAs:"json"}).then(function(b){var k=[];l.forEach(a[d],function(a){var c;(c="themes"===d?b["themes/"+a+"/main"]:b["widgets/"+a+"/Widget"])?k.push(c):e.push(f(window.stemappInfo.name+"/"+d+"/"+a+"/manifest.json",{handleAs:"json"}))});c(e).then(function(a){k=k.concat(a);t(k,d).then(function(){g.resolve(k)})})}):
(l.forEach(a[d],function(a){e.push(f(window.stemappInfo.name+"/"+d+"/"+a+"/manifest.json",{handleAs:"json"}))}),c(e).then(function(a){t(a,d).then(function(){g.resolve(a)})}));return g}function t(a,d){var e=[],f=new b;l.forEach(a,function(a){a.isRemote||(a.category="widgets"===d?"widget":"theme",p.mixin(a,h.getUriInfo(a.category+"s/"+a.name+"/Widget.js")));e.push(x(a))});c(e).then(function(){f.resolve()},function(a){f.reject(a)});return f}function x(a){return h.manifest.addI18NLabel(a).then(function(){h.manifest.addManifestProperies(a);
h.manifest.processManifestLabel(a,window.dojoConfig.locale);return a})}var A={},y=["HTML","HTML3D"];A.checkAppVersion=function(a,c){var d=new b;f("/webappbuilder/rest/apps/checkVersion",{method:"POST",data:{appConfig:m.stringify(a),appType:c.appType},handleAs:"json"}).then(p.hitch(this,function(a){a.success?d.resolve(a):d.reject(a)}),p.hitch(this,function(a){d.reject(a)}));return d.promise};A.importPortalApp=function(a,c){var d=new b;delete a.agolTemplateInfo;f("/webappbuilder/rest/apps/importportalapp",
{method:"POST",handleAs:"json",data:{appConfig:m.stringify(a),appInfo:m.stringify(c)}}).then(p.hitch(this,function(a){a.success?d.resolve(a):d.reject(a)}),p.hitch(this,function(a){d.reject(a)}));return d.promise};A.getTemplateList=function(a){var c=new b,d=r.getStandardPortalUrl(window.portalUrl),g;isXT?(g=e.getPortal(d),g.getUser().then(function(b){f((a?"/webappbuilder/rest/apps/templatelist?portalUrl\x3d"+d:"/webappbuilder/rest/apps/templatelist?username\x3d"+b.username+"\x26portalUrl\x3d"+d)+"\x26locale\x3d"+
dojoConfig.locale,{handleAs:"json"}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)})):c.resolve([]);return c};A.getAppList=function(){var a=new b,c=r.getStandardPortalUrl(window.portalUrl),d;isXT?(d=e.getPortal(c),d.getUser().then(function(b){f("/webappbuilder/rest/apps/list?username\x3d"+b.username+"\x26portalUrl\x3d"+c,{handleAs:"json"}).then(function(b){a.resolve(b)},function(b){a.reject(b)})},function(b){a.reject(b)})):(d=e.getPortal(c))?d.getUser().then(function(b){b.getItemsByKeywords("Web AppBuilder").then(function(b){var c=
[];(b=b&&b.results)&&0<b.length&&(c=l.map(b,function(a){return{name:a.title,description:a.description,id:a.id}}));a.resolve(c)},function(b){console.error(b);a.reject({success:!1,message:""})})},function(b){console.error(b);a.reject({success:!1,message:""})}):a.reject({success:!1,message:""});return a};A.getAppInfo=function(a){var c=new b;if(isXT)return-1<y.indexOf(a)?(c.resolve({id:a,appType:a,name:"stem app"}),c):f("/webappbuilder/rest/apps/"+a,{handleAs:"json"});var d=r.getStandardPortalUrl(window.portalUrl);
if(-1<y.indexOf(a))return c.resolve({id:a,appType:a,name:"stem app"}),c;e.getPortal(d).getItemById(a).then(function(a){var b;b=0<=a.typeKeywords.indexOf("Web AppBuilder")?0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML":a.url&&0<=a.url.indexOf("webappviewer3d")?"HTML3D":"HTML";c.resolve({name:a.title,description:a.description,id:a.id,owner:a.owner,appType:b})});return c};A.updateApp=function(a){var c=new b,d=r.getStandardPortalUrl(window.portalUrl);isXT?e.getPortal(d).getUser().then(function(b){f("/webappbuilder/rest/apps/updateapp",
{handleAs:"json",method:"POST",data:{id:a.id,name:a.name,description:a.description,modified:b.username||"",creator:a.creator,thumbnail:a.thumbnail,icon:a.icon,portalUrl:d}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)}):c.resolve({success:!0});return c};A.createApp=function(d){var g=new b,h,t=r.getStandardPortalUrl(window.portalUrl),l=e.getPortal(t);h=l.loadSelfInfo();var m=l.getUser(),l=null;d.webmap?(l=new b,l.resolve(d.webmap)):d.webscene?(l=new b,l.resolve(d.webscene)):
l="HTML3D"===d.appType?e.getDefaultWebScene(t):e.getDefaultWebMap(t);if(isXT){var n=u(t);h=[h,m,l,n];c(h).then(function(a){var b=a[0],c=a[1],e=a[2];a=a[3];var k={map:{}};q(d,k,r.getStandardPortalUrl(a.info.portalUrl),e,b,a.info.isWebTier?!0:!1);f("/webappbuilder/rest/apps/createapp",{handleAs:"json",method:"POST",data:{name:d.name,description:d.description,creator:c.username||"",modified:c.username||"",extraPropertyOfAppConfig:JSON.stringify(k),portalUrl:t,fromAppId:d.fromAppId,icon:d.icon,thumbnail:d.thumbnail}}).then(function(a){g.resolve(a)},
function(a){g.reject(a)})},function(a){console.error(a);g.reject({success:!1,message:builderNls.createError})})}else m=A.getPredefinedAppConfig(),n=a.isWebTierPortal(t),h=[h,m,l,n],c(h).then(function(a){var b=a[1];q(d,b,t,a[2],a[0],a[3]);k(d,b,!0).then(function(a){var b=r.getStandardPortalUrl(window.portalUrl);if(a.success)g.resolve({success:!0,newAppId:a.id}),setTimeout(p.hitch(this,function(){a.user.updateItem(a.id,{url:"HTML3D"===d.appType?b+"/apps/webappviewer3d/index.html?id\x3d"+a.id:b+"/apps/webappviewer/index.html?id\x3d"+
a.id}).then(function(a){a.success||console.error(builderNls.createUrlError)},function(a){console.error(builderNls.createUrlError,a.message||"")})}),2E3);else{var c=builderNls.titleExist.replace("${TITLE}",d.name),e;e=d.webmap?b+"/home/webmap/viewer.html?webmap\x3d"+d.webmap:d.webscene?b+"/home/webscene/viewer.html?webmap\x3d"+d.webscene:b+"/home/content.html";switch(a.unsuccessCode){case "01-01":g.resolve({success:!1,message:c,href:e});console.error(builderNls.createError,c);break;default:g.resolve({success:!1,
message:builderNls.createError,href:e}),console.error(builderNls.createError,builderNls.addItemUnsuccess)}}},function(a){g.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")})},function(a){g.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")});return g};A.duplicateApp=function(a){var c=new b,d=r.getStandardPortalUrl(window.portalUrl);isXT?e.getPortal(d).getUser().then(function(b){f("/webappbuilder/rest/apps/duplicateapp",
{handleAs:"json",method:"POST",data:{fromAppId:a.fromAppId,creator:b.username||"",modified:b.username||"",portalUrl:d}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){console.error(builderNls.createError,a);c.reject({message:builderNls.createError})}):c.resolve();return c};A.saveAs=function(a,d){var g=new b,h=r.getStandardPortalUrl(window.portalUrl),t=e.getPortal(h);if(isXT)e.getPortal(h).getUser().then(function(b){f("/webappbuilder/rest/apps/"+a.fromAppId+"/saveas",{handleAs:"json",
method:"POST",data:{name:a.name,description:a.description,fromAppId:a.fromAppId,creator:b.username||"",modified:b.username||"",portalUrl:h,appConfig:m.stringify(d),saveAsTemplate:a.saveAsTemplate,thumbnail:a.thumbnail}}).then(function(a){g.resolve(a)},function(a){g.reject(a)})},function(a){console.error(builderNls.createError,a);g.reject({message:builderNls.createError})});else{var l=p.clone(d).getCleanConfig();delete l.agolTemplateInfo;var q=new b,n=r.getStandardPortalUrl(window.portalUrl),u;d.templateConfig&&
d._appData?t.getItemData(a.fromAppId).then(function(b){u="HTML3D"===a.appType?n+"/apps/webappviewer3d/index.html?appid\x3d":n+"/apps/webappviewer/index.html?appid\x3d";b.appConfig=l;b.values.app_title=l.title;b.values.app_subtitle=l.subtitle;b.values.webmap=l.map.itemId;q.resolve(b)},function(a){q.reject({success:!1,message:a.message})}):(u="HTML3D"===a.appType?n+"/apps/webappviewer3d/index.html?id\x3d":n+"/apps/webappviewer/index.html?id\x3d",q.resolve(l));t=t.getItemById(a.fromAppId);c({itemData:q,
item:t}).then(function(b){var c=b.item;k(a,b.itemData).then(function(b){if(b.success)g.resolve({success:!0,newAppId:b.id}),setTimeout(p.hitch(this,function(){b.user.updateItem(b.id,{url:u+b.id,typeKeywords:c.typeKeywords.join(",")}).then(function(a){},function(a){console.error(builderNls.duplicateUrlError,a.message||"")})}),2E3);else{var d=builderNls.titleExist.replace("${TITLE}",a.name);switch(b.unsuccessCode){case "01-01":g.resolve({success:!1,message:d});console.error(builderNls.saveAsError,d);
break;default:g.resolve({success:!1,message:builderNls.saveAsError}),console.error(builderNls.saveAsError,builderNls.addItemUnsuccess)}}},function(a){g.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")})},function(a){g.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")})}return g};A.removeApp=function(a){if(isXT)return f("/webappbuilder/rest/apps/removeapp",{handleAs:"json",method:"POST",data:{id:a}})};
A.saveApp=function(a,d){var g=new b,k=r.getStandardPortalUrl(window.portalUrl),h=e.getPortal(k),t=h.getUser(),l;d.authorizedCrossOriginDomains=v(h.authorizedCrossOriginDomains);isXT?(l=u(k),c({user:t,signininfo:l}).then(function(b){d.portalUrl=r.getStandardPortalUrl(b.signininfo.info.portalUrl);f("/webappbuilder/rest/apps/"+a+"/saveconfig",{data:{appConfig:m.stringify(d),modified:b.user.username},method:"POST",handleAs:"json"}).then(function(a){g.resolve(a)},function(a){g.reject(a)})},function(a){g.reject(a)})):
t.then(function(b){h.getItemData(a).then(function(c){var e;d.templateConfig&&d._appData?(e=c.appConfig,c.appConfig=d,c.values.app_title=d.title,c.values.app_subtitle=d.subtitle,c.values.webmap=d.map.itemId):(e=c,c=d);d.agolTemplateInfo=e?e.agolTemplateInfo:null;d.portalUrl=k;b.updateItem(a,{text:m.stringify(c)}).then(function(a){g.resolve({success:!0,newAppId:a.id})},function(a){g.reject({success:!1,message:a.message})})},function(a){console.error(a.message||a);g.reject({success:!1,message:a.message})});
h.getItemById(a).then(p.hitch(this,function(c){c.url&&""!==c.url||(c=r.getStandardPortalUrl(window.portalUrl),c="HTML3D"===window.appInfo.appType?c+"/apps/webappviewer3d/index.html?id\x3d"+a:c+"/apps/webappviewer/index.html?id\x3d"+a,b.updateItem(a,{url:c}).then(function(a){}))}))},function(a){g.reject({success:!1,message:a.message})});return g};A.getPredefinedAppConfig=function(){return f(window.stemappInfo.name+"/predefined-apps/default/config.json",{handleAs:"json"})};A.copyThemeToApp=function(a,
c,d){if(isXT)return-1<y.indexOf(a)?(a=new b,a.resolve({success:!0}),a):f("/webappbuilder/rest/apps/"+a+"/copytheme",{handleAs:"json",method:"POST",data:{themeName:c,layoutConfig:JSON.stringify(d)}});a=new b;a.resolve({success:!0});return a};A.copyWidgetToApp=function(a,c){var d;if(isXT)return-1<y.indexOf(a)?(d=new b,d.resolve({success:!0}),d):f.post("/webappbuilder/rest/apps/"+a+"/copywidget",{data:{widgetName:c},handleAs:"json"});d=new b;d.resolve({success:!0});return d};A.getAllThemes=function(){if(isXT)return f("/webappbuilder/rest/themes/search?q\x3d"+
JSON.stringify({platform:window.stemappInfo.appType}),{handleAs:"json"}).then(function(a){l.forEach(a.themes,function(a){h.manifest.processManifestLabel(a,window.dojoConfig.locale)},this);return a});var a=new b;d("themes").then(function(b){l.forEach(b.manifests,function(a){h.manifest.processManifestLabel(a,window.dojoConfig.locale)},this);a.resolve({success:!0,themes:b.manifests})},function(b){a.reject(b)});return a};A.searchWidgets=function(a){if(isXT)return f("/webappbuilder/rest/widgets/search?q\x3d"+
JSON.stringify(a),{handleAs:"json"}).then(function(a){a.widgets&&a.widgets.forEach(function(a){p.mixin(a,h.getUriInfo("widgets/"+a.name+"/Widget"));h.manifest.processManifestLabel(a,window.dojoConfig.locale)});if(!r.isOnline(window.portalUrl)){var b=!0;window.portalVersion&&0<=n.comparePortalVersion(window.portalVersion,"3.10")&&(b=!1);var c=l.filter(a.widgets,function(a){return"Analysis"===a.name&&b?!1:!0});a.widgets=c}return a});var c=new b;d("widgets").then(function(b){var d=[];l.forEach(b.manifests,
function(b){if("undefined"===typeof a["properties.inPanel"]||a["properties.inPanel"]===b.properties.inPanel)a.support2D!==b.support2D&&a.support3D!==b.support3D||d.push(b)});c.resolve({success:!0,widgets:d})},function(a){c.reject(a)});return c};A.getManifestFromItem=function(a){return f(window.portalUrl+"/sharing/rest/content/items/"+a+"/info/manifest.json",{handleAs:"json"}).then(function(b){b.isRemote=!0;b.category="widget";b.itemId=a;p.mixin(b,h.getUriInfo(window.portalUrl+"/sharing/rest/content/items/"+
a+"/info/Widget.js"));return x(b)})};A.saveAgolTemplate=function(a,c){var d=new b,g=r.getStandardPortalUrl(window.portalUrl);if(isXT)f("/webappbuilder/rest/apps/updateagoltemplateinapp",{handleAs:"json",method:"POST",data:{id:a.id,agolTemplateInfo:m.stringify(c)}}).then(p.hitch(this,function(a){!0===a.success?d.resolve():(console.error("The response of save agol template is 'unsuccess'!"),d.reject("The response of save agol template is 'unsuccess'!"))}),function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed!")});
else{var k=e.getPortal(g);k.getUser().then(function(b){k.getItemData(a.id).then(function(e){delete e.agolTemplateJson;e.agolTemplateInfo=c;b.updateItem(a.id,{text:m.stringify(e)}).then(function(){d.resolve()},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when updateItem!")})},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when get app's itemData!")})},function(a){console.error(a.message||a);d.reject("Save AGOLTemplate failed when get current user!")})}return d};
A.canSaveApp=function(a,b,c){var d=!1;if(a){var e=new g({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&e.setPrivileges(a.privileges);if(window.isXT)e.isAdmin()?d=!0:a.username===b&&(d=!0);else if(e.isAdmin())d=!0;else if(a.username===b&&e.canCreateItem())d=!0;else if(e.canCreateItem()){var f;f=c?[].concat(c.admin,c.member,c.other):[];l.some(a.groups,function(a){return-1<a.capabilities.indexOf("updateitemcontrol")?l.some(f,function(b){return a.id===b.id?d=!0:!1}):!1})}}return d};return A})},
"builder/portalUtils":function(){define(["jimu/portalUtils"],function(p){return p})},"builder/plugins/app-actions/to-template-config/_build-generate_module":function(){define(["builder/plugins/app-actions/to-template-config/Plugin","dojo/text!builder/plugins/app-actions/to-template-config/css/style.css","dojo/i18n!builder/plugins/app-actions/to-template-config/nls/strings"],function(){})},"builder/plugins/app-actions/to-template-config/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/topic","dojo/on","builder/BasePlugin"],function(p,f,b,m,l){return p([l],{baseClass:"plugin-app-actions-to-template-config",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"footer-button" title\x3d"${nls.label}" data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\x3c/div\x3e',postCreate:function(){this.inherited(arguments);this.visible=!1;this.own(m(this.domNode,"click",f.hitch(this,this._onClick)));this._bindEvent()},_bindEvent:function(){this.own(b.subscribe("app/appConfigLoaded",
f.hitch(this,this._setAppConfig)));this.own(b.subscribe("app/appConfigChanged",f.hitch(this,this._setAppConfig)))},_onClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigTemplate()},_setAppConfig:function(b){this.appConfig=b;this.visible=!b.templateConfig||b.isTemplateApp||b._appData?!1:!0}})})},"builder/plugins/app-config/_build-generate_module":function(){define(["builder/plugins/app-config/Plugin","dojo/text!builder/plugins/app-config/Plugin.html","dojo/text!builder/plugins/app-config/css/style.css"],
function(){})},"builder/plugins/app-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/topic dojo/promise/all dojo/query builder/utils jimu/utils jimu/WidgetManager jimu/dijit/ViewStack jimu/dijit/LoadingShelter jimu/ConfigLoader jimu/LayerInfos/LayerInfos esri/tasks/GeometryService esri/config builder/BasePlugin".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w){return p([w],{baseClass:"plugin-config-app",_PreviewMoreIframeSrc:"",
_isPortrait:!0,_deviceInfo:null,appId:null,postCreate:function(){this.inherited(arguments);this.atLoading=new u;this.atLoading.placeAt(this.domNode);this.atLoading.show();this.optsLoading=new u({loadingText:"",hidden:!0,showLoading:!1});this.optsLoading.placeAt(this.leftPaneNode);this.republishEvents=[];this.pluginsLoadDefs=[];this._createAppTemplateViewStack();this._createOptsViewStack();this._createPreviewViewStack();this._bindEvent();this.saveTemplatePluginBox=this.saveAppPluginBox=null},startup:function(){this.pluginsLoadDefs.push(this._loadConfigOptsPlugin());
this.pluginsLoadDefs.push(this._loadMorePreviewOptsPlugin());this.pluginsLoadDefs.push(this._loadTemplateConfigOptsPlugin());this.pluginsLoadDefs.push(this._loadConfigTemplatePlugin());this.pluginsLoadDefs.push(this._createMainAppActions());this.pluginsLoadDefs.push(this._createPopupAppActions());this.widgetManager=c.getInstance();this._defineSetConfigViewerTopicFunction();this._defineSetPreviewViewerTopicFunction();this._updateAppId()},addRepublishEvent:function(a){a=a.replace(/\s/g,"");this.own(h.subscribe(a,
f.hitch(this,function(b){this.configViewerTopic.publish("builder/"+a,b)})))},showLoadingCover:function(){this.optsLoading.show()},hideLoadingCover:function(){this.optsLoading.hide()},switchToPreviewConfig:function(){this.optsViewStack.switchView(this.configOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);this.pluginManager.getPluginByName("app-config-template-configpart").visible=!1},switchToTemplateConfigPart:function(){this.optsViewStack.switchView(this.templateOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);
var a=this.pluginManager.getPluginByName("app-config-template-configpart");a.visible=!0;a.refresh()},switchToPreviewMore:function(){this.optsViewStack.switchView(this.morePreviewOptsPaneNode);this.previewViewStack.switchView(this.previewMore);this._showPreviewMore()},switchToConfigApp:function(a){m.setStyle(this.configAppNode,"visibility","visible");a=a||this.appConfig;this.atViewStack.switchView(this.configAppNode);a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData?this.switchToTemplateConfigPart():
(a=this.pluginManager.getPluginByName("app-actions.preview-app"))&&"config"!==a.mode?this.switchToPreviewMore():this.switchToPreviewConfig();(a=this.pluginManager.getPluginByName("app-actions.save-app"))&&this.saveAppPluginBox&&m.place(a.domNode,this.saveAppPluginBox);this.pluginManager.getPluginByName("app-config-templateconfig").visible=!1},switchToConfigTemplate:function(){m.setStyle(this.configAppNode,"visibility","hidden");this.atViewStack.switchView(this.configTemplateNode);this.switchToPreviewConfig();
var a=this.pluginManager.getPluginByName("app-actions.save-app");a&&this.saveTemplatePluginBox&&m.place(a.domNode,this.saveTemplatePluginBox);a=this.pluginManager.getPluginByName("app-config-templateconfig");a.visible=!0;a.refresh()},_bindEvent:function(){this.own(h.subscribe("app/preloadWidgetsLoaded",f.hitch(this,this._onPreloadWidgetsLoaded)));this.own(h.subscribe("app/mapCreatedFailed",f.hitch(this,this._onMapCreatedFailed)));this.own(l(this.btnPortrait,"click",f.hitch(this,function(){this._resizePreviewMore(!0)})));
this.own(l(this.btnLandscape,"click",f.hitch(this,function(){this._resizePreviewMore(!1)})));this.own(l(document.body,"click",f.hitch(this,function(){m.setStyle(this.popupActionsMenu,"display","none")})));this.own(h.subscribe("iframeClick",f.hitch(this,function(){m.setStyle(this.popupActionsMenu,"display","none")})));this._bindFrameEvent()},_bindFrameEvent:function(){this.own(l(this.previewConfigFrameNode,"load",f.hitch(this,function(){window.configWindow=this.previewConfigFrameNode.contentWindow;
this.own(l(this.previewConfigFrameNode.contentWindow.document.body,"click",f.hitch(this,function(a){h.publish("iframeClick",a)})))})));this.own(l(this.previewMoreFrameNode,"load",f.hitch(this,function(){window.previewWindow=this.previewMoreFrameNode.contentWindow;this.own(l(this.previewMoreFrameNode.contentWindow.document.body,"click",f.hitch(this,function(a){h.publish("iframeClick",a)})))})))},_createAppTemplateViewStack:function(){this.atViewStack=new a({viewType:"dom",views:[this.configAppNode,
this.configTemplateNode]},this.atViewStackNode)},_createOptsViewStack:function(){this.optsViewStack=new a({viewType:"dom",views:[this.configOptsPaneNode,this.morePreviewOptsPaneNode,this.templateOptsPaneNode]},this.optsViewStackNode)},_createPreviewViewStack:function(){this.previewViewStack=new a({viewType:"dom",views:[this.previewConfig,this.previewMore]},this.rightPreviewSection)},_defineSetConfigViewerTopicFunction:function(){window.setConfigViewerTopic=f.hitch(this,function(a){this.configViewerTopic=
a;this.own(this.configViewerTopic.subscribe("appConfigLoaded",f.hitch(this,this.onAppConfigLoaded)));this.own(this.configViewerTopic.subscribe("appConfigChanged",f.hitch(this,this.onAppConfigChanged)));this.own(this.configViewerTopic.subscribe("mapLoaded",f.hitch(this,this.onMapLoaded)));this.own(this.configViewerTopic.subscribe("mapChanged",f.hitch(this,this.onMapChanged)));this.own(this.configViewerTopic.subscribe("sceneViewLoaded",f.hitch(this.onSceneViewLoaded)));this.own(this.configViewerTopic.subscribe("sceneViewChanged",
f.hitch(this.onSceneViewChanged)));this.own(this.configViewerTopic.subscribe("preloadWidgetsLoaded",f.hitch(this,this.onPreloadWidgetsLoaded)));this.own(this.configViewerTopic.subscribe("mapCreatedFailed",f.hitch(this,this.onMapCreatedFailed)));this._onConfigViewerLoaded()})},_defineSetPreviewViewerTopicFunction:function(){window.setPreviewViewerTopic=f.hitch(this,function(a){this.previewViewerTopic=a;a=f.clone(this.appConfig);a.mode="preview";this.previewViewerTopic.publish("builder/setAppConfig",
a);this.own(this.previewViewerTopic.subscribe("mapLoaded",f.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()})));this.own(this.previewViewerTopic.subscribe("sceneViewLoaded",f.hitch(this,function(){this._syncPreviewViewpointWithConfigViewpoint()})));this._onPreviewViewerLoaded()})},_loadConfigOptsPlugin:function(){var a=this.filterExtensionsByAppType("config-part",this.options.appInfo.appType),a=this.pluginsMeta[a[0].pluginName];a.options=this.options;return this.pluginManager.loadPlugin(a).then(f.hitch(this,
function(a){m.place(a.domNode,this.configOptsPaneNode);a.startup();return a}))},_loadMorePreviewOptsPlugin:function(){var a=this.filterExtensionsByAppType("morepreview-selction-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(f.hitch(this,function(a){m.place(a.domNode,this.morePreviewOptsPaneNode);a.startup();return a}))},_updateAppId:function(){window.jimuConfig.widgetsPackage={name:"widgets",location:window.appInfo.appPath+
"widgets"};window.jimuConfig.themesPackage={name:"themes",location:window.appInfo.appPath+"themes"};window.jimuConfig.configsPackage={name:"configs",location:window.appInfo.appPath+"configs"};var a=e.urlToObject(window.location.href).query||{},b=window.appInfo.appPath+"index.html";delete a.id;window.isXT||a.appid||(b=b+"?id\x3d"+window.appInfo.id);a.mode="preview";this._PreviewMoreIframeSrc=g.appendParamsToAppPath(b,a);a.mode="config";m.attr(this.previewConfigFrameNode,"src",g.appendParamsToAppPath(b,
a))},_onConfigViewerLoaded:function(){r(this.pluginsLoadDefs).then(f.hitch(this,function(){window.stemappInfo.appVersionManager?require([window.appInfo.appPath+window.stemappInfo.appVersionManager],f.hitch(this,function(a){this._loadAppConfig(a)})):this._loadAppConfig()}))},_loadAppConfig:function(a){var b=e.urlToObject(window.location.href).query||{};window.isXT?(delete b.id,b.config=window.appInfo.appPath+"config.json"):(b.appid&&(b.config=window.path+"stemapp/config.json"),"stemapp"===b.id&&(b.config=
window.path+"stemapp/config.json",delete b.id));b.mode="config";v.getInstance(b,{versionManager:a?new a:null}).loadConfig().then(f.hitch(this,function(a){this.atLoading.hide();this.showLoadingCover();a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData||!a.templateConfig?(this.switchToConfigApp(a),a.templateConfig?r(this._loadWidgetConfigsInTemplateConfig(a)).then(f.hitch(this,function(){this.configViewerTopic.publish("builder/setAppConfig",a)})):this.configViewerTopic.publish("builder/setAppConfig",
a)):(this.switchToConfigTemplate(),this.configViewerTopic.publish("builder/setAppConfig",a))}))},_loadWidgetConfigsInTemplateConfig:function(a){var c=e.template.getConfigedWidgetsByTemplateConfig(a.templateConfig),d=[];b.forEach(c,function(b){b=a.getConfigElementById(b);d.push(this.widgetManager.tryLoadWidgetConfig(b))},this);return d},_onPreviewViewerLoaded:function(){},_republishBuilderEvents:function(){b.forEach(this.republishEvents,function(a){this.own(h.subscribe(a,f.hitch(this,function(b){this.configViewerTopic.publish(a,
b)})))},this)},previewOnDevice:function(a,b){this._deviceInfo=a;m.setStyle(this.previewMoreDes,"display","block");this.previewMoreDes.innerHTML=b?a.width+" x "+a.height:a.title+" "+a.width+" x "+a.height;this._resizePreviewMore(this._isPortrait)},_createMainAppActions:function(){var a=this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),c=360/a.length;a.sort(function(a,b){return a.parameters.index-b.parameters.index});b.forEach(a,function(a,b){this._createMainAppActionNode(a,
b,c)},this);return r([])},_createMainAppActionNode:function(a,b,c){0<b&&m.create("div",{"class":"seprate jimu-float-leading"},this.mainActionBoxNode);var d=m.create("div",{"class":"footer-button-box jimu-float-leading",pname:a.pluginName},this.mainActionBoxNode);m.setStyle(d,"width",c+"px");b=this.pluginsMeta[a.pluginName];b.options=this.options.appInfo;return this.pluginManager.loadPlugin(b).then(f.hitch(this,function(b){"app-actions.save-app"===a.pluginName&&(this.saveAppPluginBox=d);m.place(b.domNode,
d);b.startup();return b}))},_refreshAppActions:function(){var a=this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),c=0;b.forEach(a,function(a){var b=this.pluginManager.getPluginByName(a.pluginName);a=n('div[pname\x3d"'+a.pluginName+'"]',this.mainActionBoxNode)[0];!1===b.visible?m.setStyle(a,"display","none"):(m.setStyle(a,"display",""),c++)},this);var d=360/c,a=n(".footer-button-box",this.mainActionBoxNode);b.forEach(a,function(a){m.setStyle(a,"width",d+"px")})},_createPopupAppActions:function(){var a=
this.filterExtensionsByAppType("popup-app-actions",window.appInfo.appType);a.sort(function(a,b){return a.parameters.index-b.parameters.index});if(0===a.length)m.setStyle(this.btnArrow,"display","none");else{m.setStyle(this.popupActionsMenu,"top",-30*a.length+"px");var c=[];b.forEach(a,function(a){c.push(this._createPopupAppActionNode(a))},this);return r(c)}},_createPopupAppActionNode:function(a){var b=a.parameters,c=m.create("div",{id:a.pluginName},this.popupActionsMenu);return this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]).then(f.hitch(this,
function(a){c.innerHTML=a.label;this.own(l(c,"click",f.hitch(a,a[b.onClickAction])));return a}))},_onBtnArrowClick:function(a){if("none"===m.getStyle(this.popupActionsMenu,"display")){m.setStyle(this.popupActionsMenu,"display","block");var c=this.filterExtensionsByAppType("popup-app-actions",window.appInfo.appType),d=0;b.forEach(c,function(a){var b=this.pluginManager.getPluginByName(a.pluginName);a=n('div[id\x3d"'+a.pluginName+'"]',this.popupActionsMenu)[0];a.innerHTML=b.label;!1===b.visible?m.setStyle(a,
"display","none"):(m.setStyle(a,"display",""),d++);b.disabled?m.addClass(a,"disable"):a&&m.removeClass(a,"disable")},this);m.setStyle(this.popupActionsMenu,"top",-30*d+"px")}else m.setStyle(this.popupActionsMenu,"display","none");a.stopPropagation()},_getGeomtryServiceByAppConfig:function(a){return new k(a.geometryService)},onAppConfigLoaded:function(a){a=this._processAppConfig(a);h.publish("app/appConfigLoaded",a);this._refreshAppActions()},onMapLoaded:function(a){q.getInstance(a,a.itemInfo).then(f.hitch(this,
function(){h.publish("app/mapLoaded",a)}))},onMapChanged:function(a){q.getInstance(a,a.itemInfo).then(f.hitch(this,function(){h.publish("app/mapChanged",a)}))},onSceneViewLoaded:function(a){h.publish("app/sceneViewLoaded",a)},onSceneViewChanged:function(a){h.publish("app/sceneViewChanged",a)},onAppConfigChanged:function(a,b,c){a=this._processAppConfig(a);h.publish("app/appConfigChanged",a,b,c);this._refreshAppActions()},onPreloadWidgetsLoaded:function(){h.publish("app/preloadWidgetsLoaded")},onMapCreatedFailed:function(){h.publish("app/mapCreatedFailed")},
_processAppConfig:function(a){a=e.reCreateObject(a);d.defaults.geometryService=this._getGeomtryServiceByAppConfig(a);this.appConfig=a;return window.appConfig=a},_showPreviewMore:function(){this.previewViewStack.switchView(this.previewMore);if(!this.previewMoreFrameNode.src&&this._PreviewMoreIframeSrc)this._initPreviewMoreViewerPosition(),m.attr(this.previewMoreFrameNode,"src",this._PreviewMoreIframeSrc);else{var a=f.clone(this.appConfig);a.mode="preview";this._syncPreviewMapExtentWithConfigMapExtent();
this.previewViewerTopic.publish("builder/setAppConfig",a)}},_syncPreviewMapExtentWithConfigMapExtent:function(){var a=window.configWindow&&window.configWindow._viewerMap,b=window.previewWindow&&window.previewWindow._viewerMap;a&&b&&this.previewViewerTopic&&this.previewViewerTopic.publish("builder/syncExtent",a)},_syncPreviewViewpointWithConfigViewpoint:function(){var a=window.configWindow&&window.configWindow._sceneView,b=window.previewWindow&&window.previewWindow._sceneView;a&&b&&this.previewViewerTopic&&
this.previewViewerTopic.publish("builder/syncViewpoint",a.viewpoint)},_initPreviewMoreViewerPosition:function(){var a=m.getMarginBox(this.previewMore);m.setStyle(this.previewMoreContainer,{width:a.w-220+"px",height:a.h-130+"px"});m.setStyle(this.previewMoreIframeSection,"marginTop","50px")},_setPreviewMoreViewerPosition:function(){var a=m.getMarginBox(this.previewMore).h,b=m.getMarginBox(this.previewMoreContainer),c=m.getStyle(this.previewMoreContainer,"paddingTop"),d=m.getStyle(this.previewMoreContainer,
"paddingBottom"),a=(a-(b.h+c+d))/2;0>a&&(a=0);m.setStyle(this.previewMoreIframeSection,"marginTop",a+"px")},_resizePreviewMore:function(a){a?this._showPortrait():this._showLandscape();setTimeout(f.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()}),500)},_showPortrait:function(){this._deviceInfo&&(this._isPortrait=!0,m.setStyle(this.previewMoreContainer,{width:this._deviceInfo.width+44+"px",height:this._deviceInfo.height+44+"px"}),m.addClass(this.btnPortrait,"selected"),m.removeClass(this.btnLandscape,
"selected"),this._setPreviewMoreViewerPosition())},_showLandscape:function(){this._deviceInfo&&(this._isPortrait=!1,m.setStyle(this.previewMoreContainer,{width:this._deviceInfo.height+44+"px",height:this._deviceInfo.width+44+"px"}),m.removeClass(this.btnPortrait,"selected"),m.addClass(this.btnLandscape,"selected"),this._setPreviewMoreViewerPosition())},_onPreloadWidgetsLoaded:function(){this.hideLoadingCover()},_onMapCreatedFailed:function(){this.hideLoadingCover()},_loadTemplateConfigOptsPlugin:function(){var a=
this.filterExtensionsByAppType("template-config-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(f.hitch(this,function(a){m.place(a.domNode,this.templateOptsPaneNode);a.startup();return a}))},_loadConfigTemplatePlugin:function(){var a=this.filterExtensionsByAppType("config-template",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(f.hitch(this,function(a){m.place(a.domNode,
this.configTemplateNode);a.startup();this.saveTemplatePluginBox=a.savePluginNode;return a}))}})})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/Evented dojo/on dojo/aspect dojo/json dojo/query dojo/request/xhr dojo/promise/all ./utils jimu/tokenUtils ./dijit/Message".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k){var d=null,w=p(r,{constructor:function(){this.loaded=[];this.missedActions=[];this.activeWidget=
null;window.isBuilder?(h.subscribe("app/mapLoaded",f.hitch(this,this._onMapLoaded)),h.subscribe("app/mapChanged",f.hitch(this,this._onMapChanged))):(h.subscribe("mapLoaded",f.hitch(this,this._onMapLoaded)),h.subscribe("mapChanged",f.hitch(this,this._onMapChanged)));window.isBuilder?(h.subscribe("app/sceneViewLoaded",f.hitch(this,this._onSceneViewLoaded)),h.subscribe("app/sceneViewChanged",f.hitch(this,this._onSceneViewChanged))):(h.subscribe("sceneViewLoaded",f.hitch(this,this._onSceneViewLoaded)),
h.subscribe("sceneViewChanged",f.hitch(this,this._onSceneViewChanged)));window.isBuilder?(h.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)),h.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged))):(h.subscribe("appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)),h.subscribe("appConfigChanged",f.hitch(this,this._onAppConfigChanged)));h.subscribe("userSignIn",f.hitch(this,this._onUserSignIn));h.subscribe("userSignOut",f.hitch(this,this._onUserSignOut));
h.subscribe("builder/actionTriggered",f.hitch(this,this._onActionTriggered));h.subscribe("/dnd/move/start",f.hitch(this,this._onMoveStart))},loadWidget:function(a){var b=new l,c;a=f.clone(a);(c=this.getWidgetById(a.id))?b.resolve(c):u([this.loadWidgetClass(a),this.loadWidgetManifest(a)]).then(f.hitch(this,function(a){var c=a[0],d=a[1];this.loadWidgetResources(d).then(f.hitch(this,function(a){try{var e=this.createWidget(d,c,a);m.setAttr(e.domNode,"data-widget-name",d.name);console.log("widget ["+d.uri+
"] created.")}catch(G){console.log("create ["+d.uri+"] error:"+G.stack),new k({message:window.jimuNls.widgetManager.createWidgetError+": "+d.uri}),b.reject(G)}setTimeout(f.hitch(this,function(){b.resolve(e);this.emit("widget-created",e);h.publish("widgetCreated",e)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)});return b},loadWidgetClass:function(a){var b=new l,c;c=a.isRemote?a.uri+".js":a.uri;require(v.getRequireConfig(),[c],f.hitch(this,function(a){b.resolve(a)}));v.checkError(a.uri,
b);return b},loadWidgetResources:function(a){var b=new l,c,d,e,g=[];e=f.clone(a);a=this.tryLoadWidgetConfig(e);c=this._tryLoadResource(e,"i18n");d=this._tryLoadResource(e,"style");e=this._tryLoadResource(e,"template");g.push(a);g.push(c);g.push(e);g.push(d);u(g).then(f.hitch(this,function(a){var c={};c.config=a[0];c.i18n=a[1];c.template=a[2];c.style=a[3];b.resolve(c)}),function(a){b.reject(a)});return b},loadWidgetManifest:function(b){var c=new l,d=v.getUriInfo(b.uri),d=d.isRemote?d.folderUrl+"manifest.json?f\x3djson":
d.folderUrl+"manifest.json";if(b.manifest)return c.resolve(b),c;a(d,{handleAs:"json",headers:{"X-Requested-With":null}}).then(f.hitch(this,function(a){if(a.error&&a.error.code)return c.reject(a.error);a.category="widget";f.mixin(a,v.getUriInfo(b.uri));v.manifest.addI18NLabel(a).then(f.hitch(this,function(){this._processManifest(a);v.widgetJson.addManifest2WidgetJson(b,a);c.resolve(b)}))}),function(a){c.reject(a)});return c},getWidgetMarginBox:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),
!a))return{};if(a._marginBox)return a._marginBox;a.setPosition({left:-9999,top:-9999,relativeTo:a.position.relativeTo});this.openWidget(a);a._marginBox=a.getMarginBox();this.closeWidget(a);return a._marginBox},_processManifest:function(a){v.manifest.addManifestProperies(a);v.manifest.processManifestLabel(a,window.dojoConfig.locale)},createWidget:function(a,b,c){if(this.getWidgetById(a.id))return this.getWidgetById(a.id);c.config&&c.i18n&&(c.config=v.replacePlaceHolder(c.config,c.i18n));a.rawConfig=
a.config;a.config=c.config||{};this.appConfig._appData&&this._mergeAgolConfig(a);a.nls=c.i18n||{};c.template&&(a.templateString=c.template);a["class"]="jimu-widget";a.label||(a.label=a.name);this.map&&(a.map=this.map);a.appConfig=this.appConfig;c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);c.widgetManager=this;a=new b(c);a.clazz=b;g.after(a,"startup",f.hitch(this,this._postWidgetStartup,a));g.before(a,"destroy",f.hitch(this,this._onDestroyWidget,a));n(a.domNode,"click",f.hitch(this,this._onClickWidget,
a));this.loaded.push(a);return a},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var a=b.map(this.loaded,function(a){return a.id});b.forEach(a,function(a){this.destroyWidget(a)},this);this.loaded=[]},loadWidgetSettingPage:function(a){var b=new l;a=f.clone(a);a.id+="_setting";u([this.loadWidgetSettingClass(a)]).then(f.hitch(this,function(c){var d=c[0];this.loadWidgetSettingPageResources(a).then(f.hitch(this,function(c){var e;c={nls:c.i18n,templateString:c.template,appConfig:this.appConfig,
"class":"jimu-widget-setting"};"HTML3D"===window.appInfo.appType?c.sceneView=this.sceneView:c.map=this.map;for(var h in a)a.hasOwnProperty(h)&&(c[h]=a[h]);try{e=new d(c),m.setAttr(e.domNode,"data-widget-name-setting",c.name),g.before(e,"destroy",f.hitch(this,this._onDestroyWidgetSetting,e)),b.resolve(e)}catch(E){new k({message:window.jimuNls.widgetManager.createWidgetSettingPageError+":"+a.uri}),b.reject(E)}}),function(a){console.log(a)})}),function(a){b.reject(a)});return b},loadWidgetSettingClass:function(a){var b=
new l,c;c=a.isRemote?a.folderUrl+"setting/Setting.js":a.amdFolder+"setting/Setting";require(v.getRequireConfig(),[c],f.hitch(this,function(a){b.resolve(a)}));v.checkError(a.folderUrl+"setting/Setting.js",b);return b},loadWidgetSettingPageResources:function(a){var b=new l,c,d,e=[];a=f.clone(a);c=this._tryLoadResource(a,"settingI18n");d=this._tryLoadResource(a,"settingTemplate");a=this._tryLoadResource(a,"settingStyle");e.push(c);e.push(d);e.push(a);u(e).then(f.hitch(this,function(a){var c={};c.i18n=
a[0]||{};c.template=a[1];c.style=a[2];b.resolve(c)}),function(a){console.log(a)});return b},getWidgetById:function(a){var c;b.some(this.loaded,function(b){if(b.id===a)return c=b,!0},this);return c},getWidgetByLabel:function(a){var c;b.some(this.loaded,function(b){if(b.label===a)return c=b,!0},this);return c},getWidgetsByName:function(a){var c=[];b.some(this.loaded,function(b){b.name===a&&c.push(b)},this);return c},changeWindowStateTo:function(a,b){"normal"===b?this.normalizeWidget(a):"minimized"===
b?this.minimizeWidget(a):"maximized"===b?this.maximizeWidget(a):console.log("error state: "+b)},closeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if("closed"!==a.state){this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget.onDeActive(),this.activeWidget=null);m.setStyle(a.domNode,"display","none");a.setState("closed");try{a.onClose()}catch(x){console.log(console.error("fail to close widget "+a.name+". "+x.stack))}}},openWidget:function(a){if("string"===
typeof a&&(a=this.getWidgetById(a),!a))return;if(!a.started)try{a.started=!0,a.startup()}catch(x){console.error("fail to startup widget "+a.name+". "+x.stack)}if("closed"===a.state){m.setStyle(a.domNode,"display","");a.setState("opened");try{a.onOpen()}catch(x){console.error("fail to open widget "+a.name+". "+x.stack)}}},activateWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"opened"===a.state&&this._activeWidget(a)},maximizeWidget:function(a){if("string"===typeof a&&
(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("maximized");try{a.onMaximize()}catch(x){console.log(console.error("fail to maximize widget "+a.name+". "+x.stack))}},minimizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("minimized");try{a.onMinimize()}catch(x){console.log(console.error("fail to minimize widget "+a.name+". "+x.stack))}},normalizeWidget:function(a){if("string"===
typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("normal");try{a.onNormalize()}catch(x){console.log(console.error("fail to normalize widget "+a.name+". "+x.stack))}},destroyWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this._removeWidget(a);try{a.destroy()}catch(x){console.log(console.error("fail to destroy widget "+a.name+". "+x.stack))}},tryLoadWidgetConfig:function(a){return this._tryLoadWidgetConfig(a).then(f.hitch(this,
function(b){return this._upgradeWidgetConfig(a,b).then(function(b){return a.config=b})}))},triggerWidgetOpen:function(a){function b(a){var b=g.after(a,"onOpen",function(){b.remove();c.resolve(a)})}var c=new l,d=this.getWidgetById(a);if(d){if("closed"!==d.state)return c.resolve(d),c;b(d)}else var e=h.subscribe("widgetCreated",f.hitch(this,function(b){b.id===a&&(e.remove(),c.resolve(b))}));h.publish("openWidget",a);return c},_tryLoadWidgetConfig:function(b){var c=new l;if(b.config&&f.isObject(b.config))return c.resolve(b.config),
c;if(b.config){if(require.cache["url:"+b.config])return c.resolve(e.parse(require.cache["url:"+b.config])),c;c=v.processUrlInAppConfig(b.config);c=c.split("/");c[c.length-1]=encodeURIComponent(c[c.length-1]);c=c.join("/");return a(c,{handleAs:"json",headers:{"X-Requested-With":null}})}return this._tryLoadResource(b,"config").then(function(a){b.isDefaultConfig=!0;return a})},_upgradeWidgetConfig:function(a,b){var c=new l,d=a.manifest.version,e=a.version,g;if(d===e)return c.resolve(b),c;if(!1===a.hasVersionManager)return a.version=
d,c.resolve(b),c;require(v.getRequireConfig(),[a.amdFolder+"VersionManager"],f.hitch(this,function(f){f=new f;var k=f.getVersionIndex(e),h=f.getVersionIndex(d);if(k>h)c.reject("Bad widget version number, "+a.name+","+e);else try{g=f.upgrade(b,e,d),a.version=d,c.resolve(g)}catch(I){console.log("Read widget ["+a.name+"] old config error,"+I.stack),c.resolve(b)}}));return c},loadWidgetStyle:function(a){var b="widget/style/"+a.uri,c=new l,b=this._replaceId(b);return m.byId(b)?(c.resolve("load"),c):v.loadStyleLink(b,
a.styleFile,"theme_"+this.appConfig.theme.name+"_style_common")},loadWidgetSettingStyle:function(a){var b="widget/style/"+a.uri+"/setting",c=new l,b=this._replaceId(b);return m.byId(b)?(c.resolve("load"),c):v.loadStyleLink(b,a.settingStyleFile)},loadWidgetConfig:function(b){b=require(v.getRequireConfig()).toUrl(b.configFile);if(require.cache["url:"+b]){var c=new l;c.resolve(e.parse(require.cache["url:"+b]));return c}return a(b,{handleAs:"json",headers:{"X-Requested-With":null}})},loadWidgetI18n:function(a){var b=
new l;require(v.getRequireConfig(),["dojo/i18n!"+a.i18nFile],function(a){b.resolve(a)});return b},loadWidgetSettingI18n:function(a){var b=new l;require(v.getRequireConfig(),["dojo/i18n!"+a.settingI18nFile],function(a){b.resolve(a)});return b},loadWidgetTemplate:function(a){var b=new l;require(v.getRequireConfig(),["dojo/text!"+a.templateFile],function(a){b.resolve(a)});v.checkError(a.templateFile,b);return b},loadWidgetSettingTemplate:function(a){var b=new l;require(v.getRequireConfig(),["dojo/text!"+
a.settingTemplateFile],function(a){b.resolve(a)});v.checkError(a.settingTemplateFile,b);return b},removeWidgetStyle:function(a){m.destroy(this._replaceId("widget/style/"+a.uri))},removeWidgetSettingStyle:function(a){m.destroy(this._replaceId("widget/style/"+a.uri+"/setting"))},getControllerWidgets:function(){return b.filter(this.loaded,function(a){return a.isController})},getOffPanelWidgets:function(){return b.filter(this.loaded,function(a){return!a.inPanel})},getOnScreenOffPanelWidgets:function(){return b.filter(this.loaded,
function(a){return a.isOnScreen&&!a.inPanel})},closeOtherWidgetsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===a.gid&&this.loaded[b].id!==a.id&&this.closeWidget(this.loaded[b])},closeAllWidgetsInGroup:function(a){for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===a&&this.closeWidget(this.loaded[b])},_mergeAgolConfig:function(a){var b=this.appConfig._appData.values,c="widgets["+a.id+"]",d;for(d in b){var e=
d.replace(/\//g,"_").indexOf(c+"_config");0<=e&&v.template.setConfigValue(a,d.replace(/\//g,"_").substr(e,d.length).replace(c,"widget"),b[d])}},_onUserSignIn:function(a){b.forEach(this.loaded,function(b){b.onSignIn(a)},this)},_onUserSignOut:function(){b.forEach(this.loaded,function(a){a.onSignOut()},this)},_activeWidget:function(a){if(this.activeWidget){if(this.activeWidget.id===a.id){!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&m.setStyle(this.activeWidget.domNode,"zIndex",
101);return}"active"===this.activeWidget.state&&(this.activeWidget.setState("opened"),!1===this.activeWidget.inPanel&&m.setStyle(a.domNode,"zIndex","zIndex"in a.position?a.position.zIndex:"auto"),this.activeWidget.onDeActive())}this.activeWidget=a;"opened"===this.activeWidget.state&&(this.activeWidget.setState("active"),!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&m.setStyle(this.activeWidget.domNode,"zIndex",101),this.activeWidget.onActive(),h.publish("widgetActived",a))},_onClickWidget:function(a,
b){var d=c(".jimu-widget",a.domNode);if(0<d.length)for(var e=0;e<d.length;e++)if(b.target===d[e]||m.isDescendant(b.target,d[e]))return;this._activeWidget(a)},_onMoveStart:function(a){b.forEach(this.loaded,function(b){b.domNode===a.node&&this._activeWidget(b)},this)},_onAppConfigLoaded:function(a){this.appConfig=a=f.clone(a);q.setPortalUrl(a.portalUrl)},_onMapLoaded:function(a){this.map=a},_onMapChanged:function(a){this.map=a},_onSceneViewLoaded:function(a){this.sceneView=a},_onSceneViewChanged:function(a){this.sceneView=
a},_onAppConfigChanged:function(a,c,d,e){var g=f.clone(a);this.appConfig=g;b.forEach(this.loaded,function(a){a&&(a.onAppConfigChanged(g,c,d,e),"widgetChange"===c&&this._onConfigChanged(d.id,d.config,e))},this)},_onConfigChanged:function(a,b){var c=this.getWidgetById(a);c&&(c.onConfigChanged(b),f.mixin(c.config,b))},_onActionTriggered:function(a){if("map"!==a.elementId&&"app"!==a.elementId){var c=this.getWidgetById(a.elementId);if(c)c.onAction(a.action,a.data);else this.missedActions.push({id:a.elementId,
action:{name:a.action,data:a.data}});b.forEach(this.getControllerWidgets(),function(b){if(b.widgetIsControlled(a.elementId))b.onAction(a.action,{widgetId:a.elementId,data:a.data})},this)}},_postWidgetStartup:function(a){a.started=!0;v.setVerticalCenter(a.domNode);g.after(a,"resize",f.hitch(this,v.setVerticalCenter,a.domNode));this.openWidget(a);var b=q.getPortalCredential(this.appConfig.portalUrl);if(b)a.onSignIn(b);else a.onSignOut();this._triggerMissedAction(a)},_triggerMissedAction:function(a){this.missedActions.forEach(function(b){if(b.id===
a.id)a.onAction(b.action.name,b.action.data)})},_remove:function(a){return b.some(this.loaded,function(b,c){if(b.id===a)return this.loaded.splice(c,1),!0},this)},_tryLoadResource:function(a,b){var c,d=new l;if("config"===b)c=a.amdFolder+"config.json",a.configFile=c,c="hasConfig";else if("style"===b)c=a.amdFolder+"css/style.css",a.styleFile=c,c="hasStyle";else if("i18n"===b)c=a.amdFolder+"nls/strings.js",a.i18nFile=a.isRemote?c:a.amdFolder+"nls/strings",c="hasLocale";else if("template"===b)c=a.amdFolder+
"Widget.html",a.templateFile=c,c="hasUIFile";else if("settingTemplate"===b)c=a.amdFolder+"setting/Setting.html",a.settingTemplateFile=c,c="hasSettingUIFile";else if("settingI18n"===b)c=a.amdFolder+"setting/nls/strings.js",a.settingI18nFile=a.isRemote?c:a.amdFolder+"setting/nls/strings",c="hasSettingLocale";else if("settingStyle"===b)c=a.amdFolder+"setting/css/style.css",a.settingStyleFile=c,c="hasSettingStyle";else return d;a[c]?function(){var c;if("config"===b)c=this.loadWidgetConfig(a);else if("style"===
b)c=this.loadWidgetStyle(a);else if("i18n"===b)c=this.loadWidgetI18n(a);else if("template"===b)c=this.loadWidgetTemplate(a);else if("settingTemplate"===b)c=this.loadWidgetSettingTemplate(a);else if("settingStyle"===b)c=this.loadWidgetSettingStyle(a);else if("settingI18n"===b)c=this.loadWidgetSettingI18n(a);else return d;c.then(function(a){d.resolve(a)},function(b){new k({message:window.jimuNls.widgetManager.loadWidgetResourceError+": "+a.uri});d.reject(b)})}.apply(this):d.resolve(null);return d},
_replaceId:function(a){return a.replace(/\//g,"_").replace(/\./g,"_")},_onDestroyWidget:function(a){"closed"!==a.state&&this.closeWidget(a);this._removeWidget(a);this.emit("widget-destroyed",a.id);h.publish("widgetDestroyed",a.id);console.log("destroy widget ["+a.uri+"].")},_onDestroyWidgetSetting:function(a){this.removeWidgetSettingStyle(a)},_removeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget=null);
this._remove(a.id);0===this.getWidgetsByName(a.name).length&&this.removeWidgetStyle(a)}});w.getInstance=function(a){null===d&&(d=new w(a),window._widgetManager=d);return d};return w})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(p,f,b,m,l){return p(l,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=
[]);m.forEach(this.views,f.hitch(this,function(f){1===f.nodeType?(b.place(f,this.domNode),b.addClass(f,"view"),b.setStyle(f,"display","none")):f.domNode&&(b.place(f.domNode,this.domNode),b.addClass(f.domNode,"view"),b.setStyle(f.domNode,"display","none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var b="",f=this.getSelectedView();f&&(b=f.label);return b},getViewByLabel:function(b){for(var f=
0;f<this.views.length;f++)if(b===this.views[f].label)return this.views[f];return null},addView:function(f){this.views.push(f);1===f.nodeType?(b.place(f,this.domNode),b.addClass(f,"view")):f.domNode&&(b.place(f.domNode,this.domNode),b.addClass(f.domNode,"view"))},removeView:function(f){var h=this.views.length;this.views=m.filter(this.views,function(b){return f!==b});h!==this.views.length&&(1===f.nodeType?b.destroy(f):f.domNode&&f.destroyRecursive())},switchView:function(h){var l,m;l="number"===typeof h?
this.views[h]:"string"===typeof h?this.getViewByLabel(h):h;this.views.forEach(f.hitch(this,function(f){f&&(1===f.nodeType?m=f:f.domNode&&(m=f.domNode),f===l?(b.setStyle(m,"display","block"),f.domNode&&!f._started&&(f.startup(),f._started=!0)):b.setStyle(m,"display","none"))}));this._currentView=l;this.onViewSwitch(l)},onViewSwitch:function(){}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html",
"dojo/_base/html"],function(p,f,b,m,l){return p([f,b],{baseClass:"jimu-loading-shelter",declaredClass:"jimu.dijit.LoadingShelter",templateString:m,loadingText:null,hidden:!1,showLoading:!0,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&l.setStyle(this.domNode,"display","none");l.setStyle(this.domNode,{width:"100%",height:"100%"});this.loadingImg.src=require.toUrl("jimu")+"/images/loading2.gif";this.showLoading||l.setStyle(this.imgDiv,
"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(b){this.domNode&&this.hidden&&("string"===typeof b&&(this.textNode.innerHTML=b),l.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(l.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"jimu/ConfigLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/config dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr ./utils ./WidgetManager ./shared/utils ./tokenUtils ./portalUtils ./portalUrlUtils ./AppStateManager esri/IdentityManager esri/config esri/urlUtils esri/arcgis/utils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x){var A=null,y;y=p(null,{urlParams:null,appConfig:null,rawAppConfig:null,configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(a,b){this._removeHash(a);this.urlParams=a||{};this.widgetManager=c.getInstance();f.mixin(this,b)},loadConfig:function(){console.time("Load Config");return this._tryLoadConfig().then(f.hitch(this,function(a){var b=this.checkConfig(a);if(b)throw Error(b);this.rawAppConfig=f.clone(a);k.getInstance().setRawAppConfig(this.rawAppConfig);
a=this._upgradeAppConfig(a);this._processAfterTryLoad(a);this.appConfig=a;if(this.urlParams.id)return this.loadWidgetsManifest(a).then(f.hitch(this,function(){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(f.hitch(this,function(){this._configLoaded=!0;this._setDocumentTitle(a);return this.getAppConfig()}));u.setPortalUrl(a.portalUrl);x.arcgisUrl=q.getBaseItemUrl(a.portalUrl);return this._proesssWebTierAndSignin(a).then(f.hitch(this,function(){return this.urlParams.appid?window.appInfo.isRunInPortal?
this._getAppConfigFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(f.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)})):this._processNotInPortalAppProtocol(a).then(f.hitch(this,function(a){return this._getAppDataAddTemplateDataFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(f.hitch(this,function(b){b.appData.appConfig&&(a=b.appData.appConfig);a._appData=b.appData;a.templateConfig=b.templateData;a.isTemplateApp=!0;return a}))})):
this._processNotInPortalAppProtocol(a)})).then(f.hitch(this,function(a){this._processAfterTryLoad(a);this.appConfig=a;return a.map.itemId?a:(a.map["3D"]?v.getDefaultWebScene(a.portalUrl):v.getDefaultWebMap(a.portalUrl)).then(function(b){a.map.itemId=b;return a})})).then(f.hitch(this,function(a){return this.loadWidgetsManifest(a)})).then(f.hitch(this,function(a){return a._appData?a._appData.values&&a._appData.values.webmap?v.getPortal(a.portalUrl).getItemById(a._appData.values.webmap).then(f.hitch(this,
function(b){return e.template.mergeTemplateAppConfigToAppConfig(a,a._appData,b)})):e.template.mergeTemplateAppConfigToAppConfig(a,a._appData):a})).then(f.hitch(this,function(a){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(f.hitch(this,function(a){this._configLoaded=!0;this._setDocumentTitle(a);return this.getAppConfig()}))}),f.hitch(this,function(a){this.showError(a);var b=new r;b.reject(a);return b}))},_setDocumentTitle:function(a){!window.isBuilder&&a&&a.title&&(document.title=e.stripHTML(a.title))},
getAppConfig:function(){var a=f.clone(this.appConfig);a.getConfigElementById=function(a){return e.getConfigElementById(this,a)};a.getConfigElementsByName=function(a){return e.getConfigElementsByName(this,a)};a.visitElement=function(a){e.visitElement(this,a)};this._addAuthorizedCrossOriginDomains(this.portalSelf,a);return a},_addAuthorizedCrossOriginDomains:function(a,b){a&&a.authorizedCrossOriginDomains&&u.addAuthorizedCrossOriginDomains(a.authorizedCrossOriginDomains);b&&b.authorizedCrossOriginDomains&&
u.addAuthorizedCrossOriginDomains(b.authorizedCrossOriginDomains)},checkConfig:function(a){return(a=this._getRepeatedId(a))?"repeated id:"+a:null},processProxy:function(a){w.defaults.io.alwaysUseProxy=a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.alwaysUseProxy;w.defaults.io.proxyUrl="";w.defaults.io.proxyRules=[];a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.url&&(w.defaults.io.proxyUrl=a.httpProxy.url);a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.rules&&b.forEach(a.httpProxy.rules,function(a){t.addProxyRule(a)})},
addNeedValues:function(a){this._processNoUriWidgets(a);this._addElementId(a)},showError:function(a){a&&a.message&&m.create("div",{"class":"app-error",innerHTML:a.message},document.body)},_tryLoadConfig:function(){"stemapp"===this.urlParams.id&&(this.urlParams.config=window.appInfo.appPath+"config.json",delete this.urlParams.id);if(this.urlParams.config)return this.configFile=this.urlParams.config,g(this.configFile,{handleAs:"json",headers:{"X-Requested-With":null}}).then(f.hitch(this,function(a){u.setPortalUrl(a.portalUrl);
a.portalUrl&&(window.portalUrl=a.portalUrl);return this.urlParams.token?u.registerToken(this.urlParams.token).then(function(){return a}):a}));if(this.urlParams.id){window.appInfo.isRunInPortal=!0;var a=q.getPortalUrlFromLocation(),b=new r;u.setPortalUrl(a);window.portalUrl=a;x.arcgisUrl=q.getBaseItemUrl(a);var c;this.urlParams.token?c=u.registerToken(this.urlParams.token):(c=new r,c.resolve());c.then(f.hitch(this,function(){v.getPortal(a).loadSelfInfo().then(f.hitch(this,function(c){this.portalSelf=
c;c.allSSL&&"http:"===window.location.protocol?(console.log("redirect from http to https"),window.location.href=q.setHttpsProtocol(window.location.href),b.reject()):this._processSignIn(a).then(f.hitch(this,function(){this._getAppConfigFromAppId(a,this.urlParams.id).then(f.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)})).then(function(a){b.resolve(a)},function(a){b.reject(a)})}))}))}),f.hitch(this,function(a){this.showError(a)}));return b}this.configFile=
"config.json";return g(this.configFile,{handleAs:"json"}).then(f.hitch(this,function(a){u.setPortalUrl(a.portalUrl);a.portalUrl&&(window.portalUrl=a.portalUrl);return this.urlParams.token?u.registerToken(this.urlParams.token).then(function(){return a}):a}))},_upgradeAppConfig:function(a){var b=window.wabVersion,c=a.wabVersion;a.configWabVersion=a.wabVersion;if(b===c)return a;var d=this.versionManager.getVersionIndex(c),e=this.versionManager.getVersionIndex(b);if(d>e)throw Error("Bad version number, "+
c);a=this.versionManager.upgrade(a,c,b);a.wabVersion=b;return a},loadAndUpgradeAllWidgetsConfig:function(b){var c=new r,d=[];a.visitElement(b,f.hitch(this,function(a){a.uri&&(a=this.widgetManager.tryLoadWidgetConfig(a),d.push(a))}));n(d).then(f.hitch(this,function(){c.resolve(b)}),function(a){c.reject(a)});return c},_processAfterTryLoad:function(a){this._setPortalUrl(a);this._tryUpdateAppConfigByLocationUrl(a);this._processUrlParams(a);this.addNeedValues(a);this.processProxy(a);d.tokenValidity=10080;
return a},_tryUpdateAppConfigByLocationUrl:function(a){if(!(this.urlParams.config&&-1<this.urlParams.config.indexOf("arcgis.com/sharing/rest/content/items/"))){var b=q.getPortalUrlFromLocation(),b=q.getStandardPortalUrl(b);q.isOnline(b)&&(b=q.updateUrlProtocolByOtherUrl(b,a.portalUrl),a.map.portalUrl&&q.isSamePortalUrl(a.portalUrl,a.map.portalUrl)&&(a.map.portalUrl=b),a.portalUrl=b,a.httpProxy&&a.httpProxy.url&&(a.httpProxy.url=q.getPortalProxyUrl(b)))}},_processWidgetJsons:function(b){a.visitElement(b,
function(a,b){b.isWidget&&a.uri&&e.widgetJson.processWidgetJson(a)})},_processNoUriWidgets:function(b){var c=0;a.visitElement(b,function(a,b){b.isWidget&&!a.uri&&(c++,a.placeholderIndex=c)})},_addElementId:function(b){var c=0,d;a.visitElement(b,function(a){if(a.id){a.id=a.id.replace(/\//g,"_");var b=a.id.lastIndexOf("_");-1<b&&(d=a.id.substr(b+1),c=Math.max(c,d))}});a.visitElement(b,function(a){a.id||(c++,a.id=a.uri?a.uri.replace(/\//g,"_")+"_"+c:"_"+c)})},_setPortalUrl:function(a){if(a.portalUrl){var b=
q.getPortalUrlFromLocation(),c=q.isOnline(b);q.isSamePortalUrl(a.portalUrl,b)||c||(window.appInfo.isRunInPortal=!1)}else window.isXT&&h("wab_portalurl")?a.portalUrl=h("wab_portalurl"):(window.appInfo.isRunInPortal=!0,a.portalUrl=q.getPortalUrlFromLocation())},_changePortalUrlProtocol:function(a,c){a.portalUrl=q.setProtocol(a.portalUrl,c);a.map.portalUrl&&(a.map.portalUrl=q.setProtocol(a.map.portalUrl,c));a.httpProxy&&(a.httpProxy.url=q.setProtocol(a.httpProxy.url,c),a.httpProxy&&a.httpProxy.rules&&
b.forEach(a.httpProxy.rules,f.hitch(this,function(a){a.proxyUrl=q.setProtocol(a.proxyUrl,c)})))},_processInPortalAppProtocol:function(a){var b=new r,c=v.getPortal(a.portalUrl),d=f.hitch(this,function(c){if("https:"===window.location.protocol)this._changePortalUrlProtocol(a,"https");else{if(c){console.log("redirect from http to https");window.location.href=q.setHttpsProtocol(window.location.href);b.reject();return}this._changePortalUrlProtocol(a,"http")}this._checkLocale();b.resolve(a)});c.loadSelfInfo().then(f.hitch(this,
function(b){"private"===b.access?(b=0===a.portalUrl.toLowerCase().indexOf("https://"),d(b)):d(b.allSSL)}),f.hitch(this,function(a){b.reject(a)}));return b},_processNotInPortalAppProtocol:function(a){var b=new r;a.portalUrl?v.getPortal(a.portalUrl).loadSelfInfo().then(f.hitch(this,function(c){var d="https:"===window.location.protocol;(c.allSSL||d)&&this._changePortalUrlProtocol(a,"https");0!==a.portalUrl.toLowerCase().indexOf("https://")||d||u.isInConfigOrPreviewWindow()?b.resolve(a):(console.log("redirect from http to https"),
window.location.href=q.setHttpsProtocol(window.location.href),b.reject())}),f.hitch(this,function(a){b.reject(a)})):b.resolve(a);return b},_proesssWebTierAndSignin:function(a){var b=new r,c=!1,d=a.portalUrl;this._processWebTier(a).then(f.hitch(this,function(a){c=a;return v.getPortal(d).loadSelfInfo()})).then(f.hitch(this,function(a){this.portalSelf=a;return this._processSignIn(d,c)})).then(f.hitch(this,function(){b.resolve()}),function(a){b.reject(a)});return b},_processWebTier:function(a){var b=
new r,c=a.portalUrl;a.isWebTier?(u.addAuthorizedCrossOriginDomains([c]),u.isWebTierPortal(c).then(f.hitch(this,function(){var d=u.getPortalCredential(c);d&&d.ssl&&"http:"===window.location.protocol&&!u.isInConfigOrPreviewWindow()?(console.log("redirect from http to https"),window.location.href=q.setHttpsProtocol(window.location.href)):b.resolve(a.isWebTier)}),f.hitch(this,function(a){b.reject(a)}))):b.resolve(!1);return b},_processSignIn:function(a,b){var c=new r,e=v.getPortal(a),g=q.getSharingUrl(a);
window.appInfo.isRunInPortal?(g=d.checkSignInStatus(g),g.promise.always(f.hitch(this,function(){c.resolve()}))):(!u.isInBuilderWindow()&&!u.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&this.rawAppConfig&&this.rawAppConfig.appId&&!b&&u.registerOAuthInfo(a,this.rawAppConfig.appId),g=d.checkSignInStatus(g),g.promise.always(f.hitch(this,function(){u.xtGetCredentialFromCookie(a);e.loadSelfInfo().then(f.hitch(this,function(a){this.portalSelf=a;this._checkLocale();c.resolve()}))})));return c},
_checkLocale:function(){if(!u.isInConfigOrPreviewWindow()){var a=this.portalSelf.user&&this.portalSelf.user.culture||l.locale,a=a.toLowerCase();!this.urlParams.locale&&e.isLocaleChanged(l.locale,a)&&(h("wab_app_locale",a),window.location.reload())}},_getAppConfigFromTemplateAppId:function(a,b){var c=v.getPortal(a);return this._getWabAppIdAndDataFromTemplateAppId(a,b).then(f.hitch(this,function(b){var d=b.appData;return n([this._getAppConfigFromAppId(a,b.appId),c.getItemData(d.source)]).then(f.hitch(this,
function(a){var b;d.appConfig?(b=d.appConfig,delete d.appConfig):b=a[0];b=this._upgradeAppConfig(b);a=a[1];b._appData=d;b.templateConfig=a;b.isTemplateApp=!0;return b}))}))},_getAppDataAddTemplateDataFromTemplateAppId:function(a,b){var c=v.getPortal(a);return c.getItemData(b).then(function(a){return c.getItemData(a.source).then(function(b){return{appData:a,templateData:b}})})},_getWabAppIdAndDataFromTemplateAppId:function(a,b){var c=new r,d=v.getPortal(a);d.getItemData(b).then(f.hitch(this,function(a){d.getItemById(a.source).then(f.hitch(this,
function(b){b=t.urlToObject(b.url);c.resolve({appId:b.query.id,appData:a})}))}),function(a){c.reject(a)});return c},_getAppConfigFromAppId:function(a,b){return v.getPortal(a).getItemData(b)},_removeHash:function(a){for(var b in a)a[b]&&(a[b]=a[b].replace("#",""))},loadWidgetsManifest:function(b){function c(a,c){return a.loadWidgetManifest(c).then(function(a){return a},function(a){console.log("Widget failed to load, it is removed.",c.name);a.stack?console.error(a.stack):console.log(a);d(b,c)})}function d(a,
b){function c(c){a[c]&&a[c].widgets&&(a[c].widgets=a[c].widgets.filter(function(a){if(b)return a.id!==b.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}));a[c]&&a[c].groups&&a[c].groups.forEach(function(a){a.widgets&&(a.widgets=a.widgets.filter(function(a){if(b)return a.id!==b.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}))})}c("widgetOnScreen");c("widgetPool")}
var g=[],k=new r;b._buildInfo&&b._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(f.hitch(this,function(c){a.visitElement(b,f.hitch(this,function(a){!a.widgets&&a.uri&&(c[a.uri]?(this._addNeedValuesForManifest(c[a.uri],a.uri),e.widgetJson.addManifest2WidgetJson(a,c[a.uri])):g.push(this.widgetManager.loadWidgetManifest(a)))}));n(g).then(function(){k.resolve(b)})})):(a.visitElement(b,f.hitch(this,function(a){!a.widgets&&a.uri&&g.push(c(this.widgetManager,a))})),n(g).then(function(){k.resolve(b)}));
setTimeout(function(){k.isResolved()||(d(b),k.resolve(b))},6E4);return k},_addNeedValuesForManifest:function(a,b){f.mixin(a,e.getUriInfo(b));e.manifest.addManifestProperies(a);e.manifest.processManifestLabel(a,l.locale)},_loadMergedWidgetManifests:function(){return g(window.appInfo.appPath+"widgets/widgets-manifest.json",{handleAs:"json"})},_getRepeatedId:function(b){var c=[],d;a.visitElement(b,function(a){if(0<=c.indexOf(a.id))return d=a.id,!0;c.push(a.id)});return d},_processUrlParams:function(a){var b=
this.urlParams.itemid||this.urlParams.webmap;b&&a.map.itemId!==b&&(a.map.mapOptions&&e.deleteMapOptions(a.map.mapOptions),a.map.itemId=b);this.urlParams.mode&&(a.mode=this.urlParams.mode);a.map.mapOptions||(a.map.mapOptions={});this.urlParams.scale&&(a.map.mapOptions.scale=this.urlParams.scale);if(this.urlParams.level||this.urlParams.zoom)a.map.mapOptions.zoom=this.urlParams.level||this.urlParams.zoom}});y.getInstance=function(a,b){null===A?A=new y(a,b):(A.urlParams=a,A.options=b);return A};return y})},
"jimu/AppStateManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/json esri/geometry/Extent esri/SpatialReference libs/storejs/store libs/md5/md5 jimu/tokenUtils".split(" "),function(p,f,b,m,l,h,r,n,g){var e=null,c=p(null,{rawAppConfig:null,mapMd5:null,appStateKey:null,setRawAppConfig:function(a){this.rawAppConfig=a},_getAppStateMd5:function(){if("string"!==typeof this.mapMd5){var a=m.stringify(this.rawAppConfig.map);this.mapMd5=n(a)}return this.mapMd5},_getAppStateKey:function(){return this.appStateKey?
this.appStateKey:this.appStateKey="wab_appstate_"+this.urlParams.id||this.urlParams.appid||window.path},getWabAppState:function(){var a=new b,c={};if(g.isInConfigOrPreviewWindow()||!this.rawAppConfig||!this.rawAppConfig.map)return a.resolve(c),a;var e=this._getAppStateKey(),f=r.get(e);f&&f.appStateMd5===this._getAppStateMd5()?(e=f.map&&f.map.extent,f=f.map&&f.map.layers,e&&(c.extent=new l(e.xmin,e.ymin,e.xmax,e.ymax,new h(e.spatialReference))),f&&(c.layers=f)):r.remove(e);a.resolve(c);return a},saveWabAppState:function(a,
b){if(a&&!g.isInConfigOrPreviewWindow()){var c=this._getAppStateKey(),e={extent:{xmin:a.extent.xmin,xmax:a.extent.xmax,ymin:a.extent.ymin,ymax:a.extent.ymax,spatialReference:{wkid:a.extent.spatialReference.wkid,wkt:a.extent.spatialReference.wkt}},layers:{}};b&&b.traversal&&b.traversal(f.hitch(this,function(a){e.layers[a.id]={visible:a.isVisible()}}));r.set(c,{map:e,appStateMd5:this._getAppStateMd5()})}}});c.getInstance=function(a){null===e&&(e=new c);e.urlParams=a;return e};return c})},"libs/storejs/store":function(){(function(p){var f=
{},b=p.document,m;f.disabled=!1;f.set=function(b,c){};f.get=function(b){};f.remove=function(b){};f.clear=function(){};f.transact=function(b,c,a){var e=f.get(b);null==a&&(a=c,c=null);"undefined"==typeof e&&(e=c||{});a(e);f.set(b,e)};f.getAll=function(){};f.forEach=function(){};f.serialize=function(b){return JSON.stringify(b)};f.deserialize=function(b){if("string"==typeof b)try{return JSON.parse(b)}catch(c){return b||void 0}};var l;try{l="localStorage"in p&&p.localStorage}catch(e){l=!1}if(l)m=p.localStorage,
f.set=function(b,c){if(void 0===c)return f.remove(b);m.setItem(b,f.serialize(c));return c},f.get=function(b){return f.deserialize(m.getItem(b))},f.remove=function(b){m.removeItem(b)},f.clear=function(){m.clear()},f.getAll=function(){var b={};f.forEach(function(c,a){b[c]=a});return b},f.forEach=function(b){for(var c=0;c<m.length;c++){var a=m.key(c);b(a,f.get(a))}};else if(b.documentElement.addBehavior){var h=function(b){return b.replace(/^d/,"___$\x26").replace(g,"___")};l=function(b){return function(){var c=
Array.prototype.slice.call(arguments,0);c.unshift(m);r.appendChild(m);m.addBehavior("#default#userData");m.load("localStorage");c=b.apply(f,c);r.removeChild(m);return c}};var r,n;try{n=new ActiveXObject("htmlfile"),n.open(),n.write('\x3cscript\x3edocument.w\x3dwindow\x3c/script\x3e\x3ciframe src\x3d"/favicon.ico"\x3e\x3c/iframe\x3e'),n.close(),r=n.w.frames[0].document,m=r.createElement("div")}catch(e){m=b.createElement("div"),r=b.body}var g=RegExp("[!\"#$%\x26'()*+,/\\\\:;\x3c\x3d\x3e?@[\\]^`{|}~]",
"g");f.set=l(function(b,c,a){c=h(c);if(void 0===a)return f.remove(c);b.setAttribute(c,f.serialize(a));b.save("localStorage");return a});f.get=l(function(b,c){c=h(c);return f.deserialize(b.getAttribute(c))});f.remove=l(function(b,c){c=h(c);b.removeAttribute(c);b.save("localStorage")});f.clear=l(function(b){var c=b.XMLDocument.documentElement.attributes;b.load("localStorage");for(var a=0,e;e=c[a];a++)b.removeAttribute(e.name);b.save("localStorage")});f.getAll=function(b){var c={};f.forEach(function(a,
b){c[a]=b});return c};f.forEach=l(function(b,c){for(var a=b.XMLDocument.documentElement.attributes,e=0,g;g=a[e];++e)c(g.name,f.deserialize(b.getAttribute(g.name)))})}try{f.set("__storejs__","__storejs__"),"__storejs__"!=f.get("__storejs__")&&(f.disabled=!0),f.remove("__storejs__")}catch(e){f.disabled=!0}f.enabled=!f.disabled;"undefined"!=typeof module&&module.exports&&this.module!==module?module.exports=f:"function"===typeof define&&define.amd?define(f):p.store=f})(Function("return this")())},"libs/md5/md5":function(){(function(p){function f(a,
b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function b(a,b,c,d,e,g){a=f(f(b,a),f(d,g));return f(a<<e|a>>>32-e,c)}function m(a,c,e,d,f,g,h){return b(c&e|~c&d,a,c,f,g,h)}function l(a,c,e,d,f,g,h){return b(c&d|e&~d,a,c,f,g,h)}function h(a,c,e,d,f,g,h){return b(e^(c|~d),a,c,f,g,h)}function r(a,c){a[c>>5]|=128<<c%32;a[(c+64>>>9<<4)+14]=c;var e,d,g,q,n,u=1732584193,v=-271733879,r=-1732584194,p=271733878;for(e=0;e<a.length;e+=16)d=u,g=v,q=r,n=p,u=m(u,v,r,p,a[e],7,-680876936),p=
m(p,u,v,r,a[e+1],12,-389564586),r=m(r,p,u,v,a[e+2],17,606105819),v=m(v,r,p,u,a[e+3],22,-1044525330),u=m(u,v,r,p,a[e+4],7,-176418897),p=m(p,u,v,r,a[e+5],12,1200080426),r=m(r,p,u,v,a[e+6],17,-1473231341),v=m(v,r,p,u,a[e+7],22,-45705983),u=m(u,v,r,p,a[e+8],7,1770035416),p=m(p,u,v,r,a[e+9],12,-1958414417),r=m(r,p,u,v,a[e+10],17,-42063),v=m(v,r,p,u,a[e+11],22,-1990404162),u=m(u,v,r,p,a[e+12],7,1804603682),p=m(p,u,v,r,a[e+13],12,-40341101),r=m(r,p,u,v,a[e+14],17,-1502002290),v=m(v,r,p,u,a[e+15],22,1236535329),
u=l(u,v,r,p,a[e+1],5,-165796510),p=l(p,u,v,r,a[e+6],9,-1069501632),r=l(r,p,u,v,a[e+11],14,643717713),v=l(v,r,p,u,a[e],20,-373897302),u=l(u,v,r,p,a[e+5],5,-701558691),p=l(p,u,v,r,a[e+10],9,38016083),r=l(r,p,u,v,a[e+15],14,-660478335),v=l(v,r,p,u,a[e+4],20,-405537848),u=l(u,v,r,p,a[e+9],5,568446438),p=l(p,u,v,r,a[e+14],9,-1019803690),r=l(r,p,u,v,a[e+3],14,-187363961),v=l(v,r,p,u,a[e+8],20,1163531501),u=l(u,v,r,p,a[e+13],5,-1444681467),p=l(p,u,v,r,a[e+2],9,-51403784),r=l(r,p,u,v,a[e+7],14,1735328473),
v=l(v,r,p,u,a[e+12],20,-1926607734),u=b(v^r^p,u,v,a[e+5],4,-378558),p=b(u^v^r,p,u,a[e+8],11,-2022574463),r=b(p^u^v,r,p,a[e+11],16,1839030562),v=b(r^p^u,v,r,a[e+14],23,-35309556),u=b(v^r^p,u,v,a[e+1],4,-1530992060),p=b(u^v^r,p,u,a[e+4],11,1272893353),r=b(p^u^v,r,p,a[e+7],16,-155497632),v=b(r^p^u,v,r,a[e+10],23,-1094730640),u=b(v^r^p,u,v,a[e+13],4,681279174),p=b(u^v^r,p,u,a[e],11,-358537222),r=b(p^u^v,r,p,a[e+3],16,-722521979),v=b(r^p^u,v,r,a[e+6],23,76029189),u=b(v^r^p,u,v,a[e+9],4,-640364487),p=b(u^
v^r,p,u,a[e+12],11,-421815835),r=b(p^u^v,r,p,a[e+15],16,530742520),v=b(r^p^u,v,r,a[e+2],23,-995338651),u=h(u,v,r,p,a[e],6,-198630844),p=h(p,u,v,r,a[e+7],10,1126891415),r=h(r,p,u,v,a[e+14],15,-1416354905),v=h(v,r,p,u,a[e+5],21,-57434055),u=h(u,v,r,p,a[e+12],6,1700485571),p=h(p,u,v,r,a[e+3],10,-1894986606),r=h(r,p,u,v,a[e+10],15,-1051523),v=h(v,r,p,u,a[e+1],21,-2054922799),u=h(u,v,r,p,a[e+8],6,1873313359),p=h(p,u,v,r,a[e+15],10,-30611744),r=h(r,p,u,v,a[e+6],15,-1560198380),v=h(v,r,p,u,a[e+13],21,1309151649),
u=h(u,v,r,p,a[e+4],6,-145523070),p=h(p,u,v,r,a[e+11],10,-1120210379),r=h(r,p,u,v,a[e+2],15,718787259),v=h(v,r,p,u,a[e+9],21,-343485551),u=f(u,d),v=f(v,g),r=f(r,q),p=f(p,n);return[u,v,r,p]}function n(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function g(a){var b,c=[];c[(a.length>>2)-1]=void 0;for(b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(a.charCodeAt(b/8)&255)<<b%32;return c}function e(a){return n(r(g(a),8*a.length))}function c(a,
b){var c,d=g(a),e=[],f=[];e[15]=f[15]=void 0;16<d.length&&(d=r(d,8*a.length));for(c=0;16>c;c+=1)e[c]=d[c]^909522486,f[c]=d[c]^1549556828;c=r(e.concat(g(b)),512+8*b.length);return n(r(f.concat(c),640))}function a(a){var b="",c,d;for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b+="0123456789abcdef".charAt(c>>>4&15)+"0123456789abcdef".charAt(c&15);return b}function u(b,f,g){f?g?b=c(unescape(encodeURIComponent(f)),unescape(encodeURIComponent(b))):(b=c(unescape(encodeURIComponent(f)),unescape(encodeURIComponent(b))),
b=a(b)):b=g?e(unescape(encodeURIComponent(b))):a(e(unescape(encodeURIComponent(b))));return b}"function"===typeof define&&define.amd?define(function(){return u}):p.md5=u})(this)},"jimu/LayerInfos/LayerInfos":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/on dojo/topic dojo/Evented dojo/promise/all ./LayerInfoFactory".split(" "),function(p,f,b,m,l,h,r,n,g){var e=p([r],{map:null,_operLayers:null,_layerInfos:null,_finalLayerInfos:null,_tableInfos:null,_finalTableInfos:null,
_basemapLayers:null,_unreachableLayersTitleOfWebmap:null,constructor:function(a,b){this._unreachableLayersTitleOfWebmap=[];this._basemapLayers=b.baseMap.baseMapLayers;this._operLayers=b.operationalLayers;this._tables=b.tables;this.map=a;this._initLayerInfos();this._initTablesInfos();this.update();this._bindEvents()},update:function(){this._extraSetLayerInfos();this._clearAddedFlag(this._layerInfos);this._initFinalTableInfos();this._initFinalLayerInfos(this._layerInfos);this._markFirstOrLastNode()},
getLayerInfoArrayOfWebmap:function(){var a=[];f.forEach(this.getLayerInfoArray(),function(b){for(var c=0;c<this._operLayers.length;c++)if(b.id===this._operLayers[c].id){a.push(b);break}c===this._operLayers.length&&0<=this._removedLayerInfoIdsFromFeatureCollection.indexOf(b.id)&&a.push(b)},this);return a},getLayerInfoArray:function(){return f.filter(this._finalLayerInfos,function(a){return!a._isTemporaryLayerInfo})},getTableInfoArray:function(){return this._finalTableInfos},addFeatureCollection:function(a,
b){var c=this._getUniqueTopLayerInfoId(b),e={layers:[]};f.forEach(a,function(a,b){a.id=c+"_"+b;e.layers.push({id:a.id,layerObject:a})},this);this.map.addLayers(a);var k;try{k=g.getInstance().create({featureCollection:e,title:b||c,id:c},this.map),k.init()}catch(x){console.warn(x.message),k=null}k&&(k._extraOfWebmapLayerInfo=!0,this._layerInfos.push(k),this.update(),this._onUpdated())},addTable:function(a){var b=[];a=this._addTable(a,this._finalTableInfos);this._tableInfos.push(a);b.push(a);this._onTableChange(b,
"added");return a},removeTable:function(a){var b=-1,c=!1;f.forEach(this._tableInfos,function(c,d){a.id===c.id&&(b=d)});0<=b&&(this._tableInfos.splice(b,1),c=!0);b=-1;f.forEach(this._finalTableInfos,function(c,d){a.id===c.id&&(b=d)});0<=b&&(this._finalTableInfos.splice(b,1),c=!0);c&&this._onTableChange([a],"removed")},_addTable:function(a,b){var c;try{a.layerObject={url:a.url,featureCollectionData:a.featureCollectionData,empty:!0},a.id=this._getUniqueTableId(a.id),a.selfType="table",c=g.getInstance().create(a),
c.init()}catch(w){console.warn(w.message),c=null}c&&b&&b.push(c);return c},_getUniqueTableId:function(a){var b=this._tableInfos.concat(this._finalTableInfos||[]);return this._getUniqueLayerOrTableId(a,b)},_getUniqueTopLayerInfoId:function(a){return this._getUniqueLayerOrTableId(a,this._finalLayerInfos)},_getUniqueLayerOrTableId:function(a,b){var c=1,e;a||(a="table");for(e=a;;){for(var f=0;f<b.length&&b[f].id!==e;f++);if(f===b.length)return e;e=a+"_"+c.toString();c++}},_traversal:function(a,b){for(var c=
0;c<b.length;c++)if(b[c].traversal(a))return!0;return!1},traversal:function(a){var b=this.getLayerInfoArray();return this._traversal(a,b)},traversalLayerInfosOfWebmap:function(a){var b=this.getLayerInfoArrayOfWebmap();return this._traversal(a,b)},traversalAll:function(a){var b=this.getLayerInfoArray(),c=this.getTableInfoArray();return this._traversal(a,b.concat(c))},getLayerInfoById:function(a){return this._findLayerInfoById(a)},getTableInfoById:function(a){var b=null;f.some(this.getTableInfoArray(),
function(c){if(c.id===a)return b=c,!0});return b},getLayerOrTableInfoById:function(a){var b=null;this.traversalAll(function(c){if(c.id===a)return b=c,!0});return b},getLayerInfoByTopLayerId:function(a){return this._findTopLayerInfoById(a)},moveUpLayer:function(a,b){var c=null;b=b?b:1;var e=this._getTopLayerInfoIndexById(a.id);0<=e-b&&(c=this._finalLayerInfos[e-b].obtainLayerIndexesInMap().length,this._finalLayerInfos[e].moveLayerByIndex(this._finalLayerInfos[e-b].obtainLayerIndexesInMap()[c-1].index),
c=this._finalLayerInfos[e-b],h.publish("layerInfos/layerReorder",e,b,"moveup"));return c},_reorderLayerInfosArray:function(a,b,c){"moveup"===c?(c=this._finalLayerInfos[a],this._finalLayerInfos.splice(a,1),this._finalLayerInfos.splice(a-b,0,c)):(c=this._finalLayerInfos[a],this._finalLayerInfos.splice(a+b+1,0,c),this._finalLayerInfos.splice(a,1));this._markFirstOrLastNode()},moveDownLayer:function(a,b){var c=null;b=b?b:1;var e=this._getTopLayerInfoIndexById(a.id);e+b<=this._finalLayerInfos.length-1&&
(this._finalLayerInfos[e].moveLayerByIndex(this._finalLayerInfos[e+b].obtainLayerIndexesInMap()[0].index),c=this._finalLayerInfos[e+b],h.publish("layerInfos/layerReorder",e,b,"movedown"));return c},getBasemapLayers:function(){var a=[];f.forEach(this.map.layerIds,function(b){b=this.map.getLayer(b);"basemap"!==b._basemapGalleryLayerType&&"reference"!==b._basemapGalleryLayerType||a.push(b)},this);0===a.length&&(a=this._basemapLayers);return a},getMapNotesLayerInfoArray:function(){return f.filter(this.getLayerInfoArray(),
function(a){return a.isMapNotesLayerInfo()},this)},restoreState:function(a){var b=a&&a.layerOptions?a.layerOptions:null;f.forEach(this._finalLayerInfos,function(a){a.resetLayerObjectVisibility(b)},this)},getUnreachableLayersTitle:function(){return this._unreachableLayersTitleOfWebmap},_initLayerInfos:function(){var a;this._layerInfos=[];f.forEach(this._operLayers,function(b){try{a=g.getInstance().create(b),a.init()}catch(d){console.warn(d.message),a=null,this._unreachableLayersTitleOfWebmap.push(b.title)}a&&
this._layerInfos.push(a)},this)},_extraSetLayerInfos:function(){this._removedLayerInfoIdsFromFeatureCollection=[];f.forEach(this._layerInfos,function(a,b){var c;if("esri.layers.GeoRSSLayer"===a.layerObject.declaredClass||"esri.layers.KMLLayer"===a.layerObject.declaredClass){try{c=g.getInstance().create(a.originOperLayer),c.init()}catch(t){console.warn(t.message),c=null}c&&(a.destroyLayerInfo(),this._layerInfos[b]=c)}else if(a.originOperLayer.featureCollection){var e=[];f.forEach(a.getSubLayers(),
function(a){e.push(a.id)});f.forEach(e,function(b){this.map.getLayer(b)||a.removeSubLayerById(b)},this);1===a.getSubLayers().length&&(c=a.getSubLayers()[0],this.map.getLayer(c.id).title=a.title,a.removeSubLayerById(c.id),this._removedLayerInfoIdsFromFeatureCollection.push(c.id))}},this)},_initFinalLayerInfos:function(a){var b,c;this._finalLayerInfos=[];for(b=this.map.graphicsLayerIds.length-1;0<=b;b--)c=this.map.graphicsLayerIds[b],this._isBasemap(c)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(c,
a),c,!0);for(b=this.map.layerIds.length-1;0<=b;b--)c=this.map.layerIds[b],this._isBasemap(c)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(c,a),c,!1)},_isBasemap:function(a){for(var b=!1,c=this.getBasemapLayers(),e=0;e<c.length;e++)c[e].id===a&&(b=!0);return b},_addToFinalLayerInfos:function(a,c,d){var e;if(a)a._addedFlag||a.isGraphicLayer()!==d||(this._finalLayerInfos.push(a),a._addedFlag=!0);else{a=this.map.getLayer(c);if("esri.layers.GraphicsLayer"!==a.declaredClass&&"esri.layers.LabelLayer"!==
a.declaredClass){try{var k={layerObject:a,title:this._getLayerTitle(a),id:a.id||" "};b.mixin(k,b.getObject("_wabProperties.originOperLayer",!1,a));e=g.getInstance().create(k,this.map);e.init()}catch(x){console.warn(x.message),e=null}e&&(b.getObject("_wabProperties.isTemporaryLayer",!1,a)&&(e._isTemporaryLayerInfo=!0),this._finalLayerInfos.push(e))}("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass)&&e&&e._getLayerDefinition().then(b.hitch(this,
function(a){var b=[];f.forEach(a.tables,function(a){a.url=e.getUrl()+"/"+a.id;a.id=e.id+"_"+a.id;a.title=this._getLayerTitle(a);(a=this._addTable(a,this._finalTableInfos))&&b.push(a)},this);this._onTableChange(b,"added")}))}},_getLayerTitle:function(a){if(a.title)return a.title;if(b.getObject("_wabProperties.originalLayerName",!1,a))return a.name||a.id;var c=a.label||a.name||"";if(a.url){var d;d=a.url.indexOf("/FeatureServer");-1===d&&(d=a.url.indexOf("/MapServer"));-1===d&&(d=a.url.indexOf("/service"));
-1<d&&(d=a.url.substring(0,d),d=d.substring(d.lastIndexOf("/")+1,d.length),c=c?d+" - "+c:d)}return c||a.id},_findLayerInfoByIdAndReturnTopLayer:function(a,b){var c,e=null;b||(b=this._finalLayerInfos);for(c=0;c<b.length;c++)if(e=b[c].findLayerInfoById(a)){e=b[c];break}return e},_findLayerInfoById:function(a,b){var c,e=null;b||(b=this._finalLayerInfos);for(c=0;c<b.length&&!(e=b[c].findLayerInfoById(a));c++);return e},_findTopLayerInfoById:function(a){var b,c=null,e=this._finalLayerInfos.concat(this._finalTableInfos);
for(b=0;b<e.length;b++)if(e[b].id===a){c=e[b];break}return c},_getTopLayerInfoIndexById:function(a){var b,c=-1;for(b=0;b<this._finalLayerInfos.length;b++)if(this._finalLayerInfos[b].id===a){c=b;break}return c},_clearAddedFlag:function(a){f.forEach(a,function(a){a._addedFlag=!1})},_markFirstOrLastNode:function(){var a;if(this._finalLayerInfos.length){for(a=0;a<this._finalLayerInfos.length;a++)this._finalLayerInfos[a].isFirst=!1,this._finalLayerInfos[a].isLast=!1;this._finalLayerInfos[0].isFirst=!0;
this._finalLayerInfos[this._finalLayerInfos.length-1].isLast=!0;for(a=0;a<this._finalLayerInfos.length;a++)if(!this._finalLayerInfos[a].isGraphicLayer()){a&&(this._finalLayerInfos[a-1].isLast=!0);this._finalLayerInfos[a].isFirst=!0;break}}},_onReceiveBasemapGalleryeData:function(a,c,d){"BasemapGallery"===a&&(this._basemapLayers.length=0,f.forEach(d,b.hitch(this,function(a){this._basemapLayers.push({layerObject:a,id:a.id})}),this),this.update(),this.emit("layerInfosChanged"))},_onBasemapChange:function(a){var b;
for(b=this._basemapLayers.length=0;b<a.layers.length;b++)this._basemapLayers.push({layerObject:a.layer[b],id:a.layers[b].id})},_destroyLayerInfos:function(){f.forEach(this._finalLayerInfos,b.hitch(this,function(a){a.destroyLayerInfo()}))},_bindEvents:function(){var a,c,d,e,f,g,m,n,u;a=l(this.map,"layer-add-result",b.hitch(this,this._onLayersChange,"added"));c=l(this.map,"layer-remove",b.hitch(this,this._onLayersChange,"removed"));m=h.subscribe("layerInfos/layerReorder",b.hitch(this,this._onLayerReorder));
e=h.subscribe("layerInfos/layerInfo/isShowInMapChanged",b.hitch(this,this._onShowInMapChanged));f=h.subscribe("layerInfos/layerInfo/visibleChanged",b.hitch(this,this._onVisibleChanged));g=h.subscribe("layerInfos/layerInfo/filterChanged",b.hitch(this,this._onFilterChanged));n=h.subscribe("layerInfos/layerInfo/rendererChanged",b.hitch(this,this._onRendererChanged));u=h.subscribe("layerInfos/layerInfo/opacityChanged",b.hitch(this,this._onOpacityChanged));d=l(this.map,"before-unload",b.hitch(this,function(){a.remove();
c.remove();m.remove();e.remove();f.remove();g.remove();n.remove();d.remove();u.remove();this._destroyLayerInfos()}))},_onLayersChange:function(a,b){var c=null,e;b.error||"esri.layers.GraphicsLayer"===b.layer.declaredClass||"esri.layers.LabelLayer"===b.layer.declaredClass||b.layer._basemapGalleryLayerType||("added"===a?(this.update(),c=this._findTopLayerInfoById(b.layer.id),e=this._findLayerInfoById(b.layer.id)):(c=this._findTopLayerInfoById(b.layer.id),e=this._findLayerInfoById(b.layer.id),e.destroyLayerInfo(),
this.update()),this.emit("layerInfosChanged",c,a,e))},_onShowInMapChanged:function(a){this.emit("layerInfosIsShowInMapChanged",a)},_onVisibleChanged:function(a){this.emit("layerInfosIsVisibleChanged",a)},_onFilterChanged:function(a){this.emit("layerInfosFilterChanged",a)},_onLayerReorder:function(a,b,c){this._reorderLayerInfosArray(a,b,c);this.emit("layerInfosReorder")},_onRendererChanged:function(a){this.emit("layerInfosRendererChanged",a)},_onOpacityChanged:function(a){this.emit("layerInfosOpacityChanged",
a)},_initTablesInfos:function(){this._tableInfos=[];f.forEach(this._tables&&this._tables.reverse(),function(a){this._addTable(a,this._tableInfos)},this)},_initFinalTableInfos:function(){this._finalTableInfos=[];f.forEach(this._tableInfos,function(a){this._finalTableInfos.push(a)},this)},_onTableChange:function(a,b){this.emit("tableInfosChanged",a,b)},_onUpdated:function(){this.emit("updated")}});e.getLayerInfoArrayByType=function(a,b){var c=new m,g=[],k=[];e.getInstance(a,a.iteminfo).then(function(a){a.traversal(function(a){var b=
a.getLayerType();b.layerInfo=a;g.push(b)});n(g).then(function(a){f.forEach(a,function(a,c){b===a&&k.push(g[c].layerInfo)});c.resolve(k)})});return c};var c=!0,a=null,u=null,v=new m;e.getInstance=function(f,k){a&&a!==f&&(c=!0,u=a=null,v=new m);u?v.resolve(u):c&&(c=!1,g.getInstance(f).init().then(b.hitch(this,function(){var b=new e(f,k.itemData);a=f;u=b;v.resolve(b)})));return v};e.getInstanceSync=function(){return u};return e})},"jimu/LayerInfos/LayerInfoFactory":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/Deferred"],function(p,f,b){var m=null,l=p(null,{constructor:function(){},init:function(){var h=new b;require("jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForGroup jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS jimu/LayerInfos/LayerInfoForDefaultTable jimu/LayerInfos/LayerInfoForDefaultImage jimu/LayerInfos/LayerInfoForDefaultStream".split(" "),
f.hitch(this,function(b,f,g,e,c,a,l,m,q,k,d,p,t){this.LayerInfoForCollection=b;this.LayerInfoForMapService=f;this.LayerInfoForKML=g;this.LayerInfoForGeoRSS=e;this.LayerInfoForDefault=c;this.LayerInfoForWMS=a;this.LayerInfoForGroup=l;this.LayerInfoForDefaultDynamic=m;this.LayerInfoForDefaultTile=q;this.LayerInfoForDefaultWMS=k;this.LayerInfoForDefaultTable=d;this.LayerInfoForDefaultImage=p;this.LayerInfoForDefaultStream=t;h.resolve()}));return h},create:function(b){if(b.featureCollection)return new this.LayerInfoForCollection(b,
this.map);if("esri.layers.KMLLayer"===b.layerObject.declaredClass)return new this.LayerInfoForKML(b,this.map);if("esri.layers.GeoRSSLayer"===b.layerObject.declaredClass)return new this.LayerInfoForGeoRSS(b,this.map);if("esri.layers.WMSLayer"!==b.layerObject.declaredClass||b.selfType){if("esri.layers.ArcGISDynamicMapServiceLayer"===b.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===b.layerObject.declaredClass)return new this.LayerInfoForMapService(b,this.map);if("esri.layers.ArcGISImageServiceLayer"===
b.layerObject.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===b.layerObject.declaredClass)return new this.LayerInfoForDefaultImage(b,this.map);if("esri.layers.StreamLayer"===b.layerObject.declaredClass)return new this.LayerInfoForDefaultStream(b,this.map);"Table"===b.layerObject.type&&(b.selfType="table");switch(b.selfType){case "mapservice_dynamic_group":return new this.LayerInfoForGroup(b,this.map);case "mapservice_tiled_group":return new this.LayerInfoForGroup(b,this.map,!0);case "mapservice_dynamic":return new this.LayerInfoForDefaultDynamic(b,
this.map);case "mapservice_tiled":return new this.LayerInfoForDefaultTile(b,this.map);case "wms":return new this.LayerInfoForDefaultWMS(b,this.map);case "table":return new this.LayerInfoForDefaultTable(b,this.map);default:return new this.LayerInfoForDefault(b,this.map)}}else return new this.LayerInfoForWMS(b,this.map)}});l.getInstance=function(b){null===m&&(m=new l);b&&(m.map=b);return m};return l})},"builder/plugins/app-config-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-configpart/Plugin",
"dojo/text!builder/plugins/app-config-configpart/Plugin.html","dojo/text!builder/plugins/app-config-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-configpart/nls/strings"],function(){})},"builder/plugins/app-config-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all ./TabContainer2 builder/BasePlugin".split(" "),function(p,f,b,m,l,h){return p([h],{baseClass:"plugin-appconfig-configpart",postCreate:function(){this.inherited(arguments);
this.plugins=[];this.republishEvents=[]},startup:function(){this._createConfigTab();this._addRepublishEvents()},_addRepublishEvents:function(){var f=this.pluginManager.getPluginByName("app-config");b.forEach(this.republishEvents,function(b){f.addRepublishEvent(b)},this)},_createConfigTab:function(){var h=this.filterExtensionsByAppType("config-sections",window.appInfo.appType);b.some(h,f.hitch(this,function(b){return"map-config"===b.pluginName?(b.parameters.label="HTML3D"===window.appInfo.appType?
window.jimuNls.common.scene:window.jimuNls.common.map,!0):!1}));var n=[];b.forEach(h,function(b){n.push(this.pluginManager.loadPlugin(this.pluginsMeta[b.pluginName]));b=b.parameters.republishEvents.split(",");this.republishEvents=this.republishEvents.concat(b)},this);m(n).then(f.hitch(this,function(f){var e=[];b.forEach(f,function(b,a){var c=h[a];this.plugins.push(b);e.push({title:c.parameters.label,icon:c.parameters.icon,selectedIcon:c.parameters.selectedIcon,content:b,index:c.parameters.index})},
this);e.sort(function(b,a){return b.index-a.index});this.tab=new l({tabs:e,selected:e[0].title},this.tabsNode);this.tab.startup()}),f.hitch(this,function(b){console.error(b)}))},_onMapChanged:function(b){this.map=b}})})},"builder/plugins/app-config-configpart/TabContainer2":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./TabContainer2.html jimu/dijit/ViewStack".split(" "),function(p,
f,b,m,l,h,r,n,g,e,c){return p([n,g,h],{templateString:e,_controlNodes:null,selected:"",tabs:null,"class":"jimu-tab2",postCreate:function(){this.inherited(arguments);this._controlNodes=[];this.viewStack=new c(null,this.containerNode);b.forEach(this.tabs,function(a){this._createTab(a)},this)},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},_createTab:function(a){var b=m.toDom('\x3ctd\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3cdiv class\x3d"tab-item-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"tab-item-title"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e');
m.place(b,this.tabTr);var c=r(".tab-item-div",b)[0],e=r(".tab-item-icon",b)[0];r(".tab-item-title",b)[0].innerHTML=a.title||"";m.setAttr(c,"title",a.title||"");m.setStyle(e,"backgroundImage","url("+a.icon+")");this.viewStack.viewType=a.content.domNode?"dijit":"dom";c.tabConfig=a;c.iconNode=e;a.content.label=a.title;this.viewStack.addView(a.content);this.own(l(c,"click",f.hitch(this,this.onSelect,a.title)));this._controlNodes.push(c)},onSelect:function(a){this.selectTab(a)},selectTab:function(a){b.forEach(this._controlNodes,
f.hitch(this,function(b){var c="";b.tabConfig.title===a?(m.addClass(b,"selected-tab-item-div"),c=b.tabConfig.selectedIcon):(m.removeClass(b,"selected-tab-item-div"),c=b.tabConfig.icon);m.setStyle(b.iconNode,"backgroundImage","url("+c+")")}));this.viewStack.switchView(a);this.emit("tabChanged",a)}})})},"builder/plugins/app-config-morepreview-selectionpart/_build-generate_module":function(){define(["builder/plugins/app-config-morepreview-selectionpart/Plugin","dojo/text!builder/plugins/app-config-morepreview-selectionpart/Plugin.html",
"dojo/text!builder/plugins/app-config-morepreview-selectionpart/css/style.css","dojo/i18n!builder/plugins/app-config-morepreview-selectionpart/nls/strings"],function(){})},"builder/plugins/app-config-morepreview-selectionpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/query builder/BasePlugin jimu/portalUrlUtils jimu/dijit/QRCode".split(" "),function(p,f,b,m,l,h,r,n){return p([h],{baseClass:"plugin-appconfig-morepreview-selectionpart",postCreate:function(){this.inherited(arguments);
this._bindEvents();this._appConfigPlugin=this.pluginManager.getPluginByName("app-config")},startup:function(){this.inherited(arguments);this._initPreviewItems();this._initQRCode()},_bindEvents:function(){this.own(m(this.customWidth,"blur",f.hitch(this,this._onCustomSizeChanged)));this.own(m(this.customHeight,"blur",f.hitch(this,this._onCustomSizeChanged)))},_initPreviewItems:function(){b.empty(this.previewTbody);var f=[];f.push({"class":"iPhone6-plus",title:"iPhone 7 Plus / 6s Plus / 6 Plus",width:414,
height:736});f.push({"class":"iPhone6",title:"iPhone 7 / 6s / 6",width:375,height:667});f.push({"class":"iPhone5",title:"iPhone SE / 5 / 5C / 5S",width:320,height:568});f.push({"class":"iPhone4",title:"iPhone 4s / 4",width:320,height:480});f.push({"class":"xiaomi-3",title:"LG G5 / G4 / G3",width:360,height:640});f.push({"class":"xiaomi-3",title:"Huawei Mate 9",width:360,height:640});f.push({"class":"xiaomi-3",title:"Lenovo Z2 Pro",width:360,height:640});f.push({"class":"xiaomi-3",title:"Xiaomi Mi 5",
width:360,height:640});f.push({"class":"htc-one",title:"HTC 10",width:360,height:640});f.push({"class":"Samsung-Galaxy-S4",title:"Samsung Galaxy S7, S7 edge",width:360,height:640});f.push({"class":"Samsung-Note-3",title:"Samsung Galaxy Note 4",width:360,height:640});f.push({"class":"new-iPad",title:"Google Nexus 10",width:800,height:1280});f.push({"class":"new-iPad",title:"Google Nexus 7",width:600,height:960});f.push({"class":"Nexus-5",title:"Google Nexus 6",width:412,height:732});f.push({"class":"Nexus-4",
title:"Google Nexus 5",width:360,height:640});f.push({"class":"iPad-Air",title:"iPad Pro",width:1024,height:1366});f.push({"class":"iPad-Air",title:"iPad 3 / 4 / Air / Air2",width:768,height:1024});f.push({"class":"iPad-mini",title:"iPad mini 2 / 3",width:768,height:1024});f.push({"class":"new-iPad",title:"Surface Pro 3",width:1024,height:1440});f.push({"class":"new-iPad",title:"Surface Pro / Pro 2",width:720,height:1280});var e=Math.ceil(f.length/4),c;for(c=0;c<e;c++){var a=b.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");
b.place(a,this.previewTbody)}e=l("td",this.previewTbody);for(c=0;c<f.length;c++){var a=e[c],h=this._createPreviewItem(f[c]);b.place(h,a)}},_createPreviewItem:function(g){var e=b.toDom('\x3cdiv class\x3d"preview-item"\x3e\x3cdiv class\x3d"preview-item-bg"\x3e\x3cdiv class\x3d"preview-item-thumbnail"\x3e\x3c/div\x3e\x3cdiv class\x3d"preview-selected-icon"\x3e\x3c/div\x3e\x3c/div\x3e\x3cspan class\x3d"preview-item-title"\x3e\x3c/span\x3e\x3c/div\x3e');e.args=g;var c=l(".preview-item-bg",e)[0],a=l(".preview-item-thumbnail",
e)[0],h=l(".preview-item-title",e)[0];this.own(m(c,"click",f.hitch(this,this._onPreviewItemBgClick)));g["class"]&&b.addClass(a,g["class"]);h.innerHTML=g.title||"";return e},_onPreviewItemBgClick:function(f){f=f.target||f.srcElement;b.hasClass(f,"preview-item-thumbnail")&&(f=f.parentNode,l(".preview-item-bg",this.previewTbody).removeClass("selected"),b.addClass(f,"selected"),f=f.parentNode.args,this.customWidth.value=f.width,this.customHeight.value=f.height,this._appConfigPlugin.previewOnDevice(f,
!1))},_onCustomSizeChanged:function(){var b=function(a){var b=!1;isNaN(a)||isNaN(parseFloat(a))||0<parseInt(a,10)&&(b=!0);return b},e=this.customWidth.value,c=this.customHeight.value;b(e)&&b(c)&&(l(".preview-item-bg",this.previewTbody).removeClass("selected"),e=parseInt(e,10),c=parseInt(c,10),this._appConfigPlugin.previewOnDevice({width:e,height:c},!0))},_initQRCode:function(){var f="";window.isXT?f=window.location.protocol+"//"+window.location.host+path+"apps/"+window.appInfo.id:(f=r.getStandardPortalUrl(window.portalUrl),
f=r.setProtocol(f,window.location.protocol),f=window.queryObject.appid?f+"/apps/webappviewer/index.html?appid\x3d"+window.appInfo.id:f+"/apps/webappviewer/index.html?id\x3d"+window.appInfo.id);new n({text:f,width:75,height:75},this.qrcodeImage);b.setAttr(this.qrcodeDescription,"innerHTML",this.nls.qrcodeDesc);setTimeout(function(){l(".qrcode-image table").style("margin","0px")},100)}})})},"jimu/dijit/QRCode":function(){define(["dojo/_base/declare","dijit/_WidgetBase","libs/qrcode"],function(p,f){return p([f],
{baseClass:"jimu-qrcode",declaredClass:"jimu.dijit.QRCode",postCreate:function(){new QRCode(this.domNode,{text:this.text,width:this.width||128,height:this.height||128,colorDark:this.colorDark||" #000000",colorLight:this.colorLight||"#ffffff",correctLevel:this.correctLevel||QRCode.CorrectLevel.L})}})})},"libs/qrcode":function(){define(["dojo","dijit","dojox"],function(p,f,b){var m;(function(){function b(a){this.mode=c.MODE_8BIT_BYTE;this.data=a;this.parsedData=[];a=0;for(var b=this.data.length;a<b;a++){var d=
[],e=this.data.charCodeAt(a);65536<e?(d[0]=240|(e&1835008)>>>18,d[1]=128|(e&258048)>>>12,d[2]=128|(e&4032)>>>6,d[3]=128|e&63):2048<e?(d[0]=224|(e&61440)>>>12,d[1]=128|(e&4032)>>>6,d[2]=128|e&63):128<e?(d[0]=192|(e&1984)>>>6,d[1]=128|e&63):d[0]=e;this.parsedData.push(d)}this.parsedData=Array.prototype.concat.apply([],this.parsedData);this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function f(a,b){this.typeNumber=a;this.errorCorrectLevel=
b;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}function r(a,b){if(void 0==a.length)throw Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function n(a,b){this.totalCount=a;this.dataCount=b}function g(){this.buffer=[];this.length=0}function e(){var a=!1,b=navigator.userAgent;/android/i.test(b)&&(a=!0,(aMat=b.toString().match(/android ([0-9]\.[0-9])/i))&&aMat[1]&&(a=parseFloat(aMat[1])));
return a}b.prototype={getLength:function(a){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;b<c;b++)a.put(this.parsedData[b],8)}};f.prototype={addData:function(a){a=new b(a);this.dataList.push(a);this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,
b){this.moduleCount=4*this.typeNumber+17;this.modules=Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[c][d]=null}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(a,b);7<=this.typeNumber&&this.setupTypeNumber(a);null==this.dataCache&&
(this.dataCache=f.createData(this.typeNumber,this.errorCorrectLevel,this.dataList));this.mapData(this.dataCache,b)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(this.modules[a+c][b+d]=0<=c&&6>=c&&(0==d||6==d)||0<=d&&6>=d&&(0==c||6==c)||2<=c&&4>=c&&2<=d&&4>=d?!0:!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=u.getLostPoint(this);if(0==c||a>d)a=d,b=
c}return b},createMovieClip:function(a,b,c){a=a.createEmptyMovieClip(b,c);this.make();for(b=0;b<this.modules.length;b++){c=1*b;for(var d=0;d<this.modules[b].length;d++){var e=1*d;this.modules[b][d]&&(a.beginFill(0,100),a.moveTo(e,c),a.lineTo(e+1,c),a.lineTo(e+1,c+1),a.lineTo(e,c+1),a.endFill())}}return a},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(a=8;a<this.moduleCount-8;a++)null==this.modules[6][a]&&(this.modules[6][a]=
0==a%2)},setupPositionAdjustPattern:function(){for(var a=u.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var f=-2;2>=f;f++)for(var g=-2;2>=g;g++)this.modules[d+f][e+g]=-2==f||2==f||-2==g||2==g||0==f&&0==g?!0:!1}},setupTypeNumber:function(a){for(var b=u.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(c=0;18>c;c++)d=!a&&1==(b>>c&1),
this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d},setupTypeInfo:function(a,b){for(var c=u.getBCHTypeInfo(this.errorCorrectLevel<<3|b),d=0;15>d;d++){var e=!a&&1==(c>>d&1);6>d?this.modules[d][8]=e:8>d?this.modules[d+1][8]=e:this.modules[this.moduleCount-15+d][8]=e}for(d=0;15>d;d++)e=!a&&1==(c>>d&1),8>d?this.modules[8][this.moduleCount-d-1]=e:9>d?this.modules[8][15-d-1+1]=e:this.modules[8][15-d-1]=e;this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-
1,e=7,f=0,g=this.moduleCount-1;0<g;g-=2)for(6==g&&g--;;){for(var k=0;2>k;k++)if(null==this.modules[d][g-k]){var h=!1;f<a.length&&(h=1==(a[f]>>>e&1));u.getMask(b,d,g-k)&&(h=!h);this.modules[d][g-k]=h;e--; -1==e&&(f++,e=7)}d+=c;if(0>d||this.moduleCount<=d){d-=c;c=-c;break}}}};f.PAD0=236;f.PAD1=17;f.createData=function(a,b,c){b=n.getRSBlocks(a,b);for(var d=new g,e=0;e<c.length;e++){var k=c[e];d.put(k.mode,4);d.put(k.getLength(),u.getLengthInBits(k.mode,a));k.write(d)}for(e=a=0;e<b.length;e++)a+=b[e].dataCount;
if(d.getLengthInBits()>8*a)throw Error("code length overflow. ("+d.getLengthInBits()+"\x3e"+8*a+")");for(d.getLengthInBits()+4<=8*a&&d.put(0,4);0!=d.getLengthInBits()%8;)d.putBit(!1);for(;!(d.getLengthInBits()>=8*a);){d.put(f.PAD0,8);if(d.getLengthInBits()>=8*a)break;d.put(f.PAD1,8)}return f.createBytes(d,b)};f.createBytes=function(a,b){for(var c=0,d=0,e=0,f=Array(b.length),g=Array(b.length),k=0;k<b.length;k++){var h=b[k].dataCount,l=b[k].totalCount-h,d=Math.max(d,h),e=Math.max(e,l);f[k]=Array(h);
for(var q=0;q<f[k].length;q++)f[k][q]=255&a.buffer[q+c];c+=h;q=u.getErrorCorrectPolynomial(l);h=(new r(f[k],q.getLength()-1)).mod(q);g[k]=Array(q.getLength()-1);for(q=0;q<g[k].length;q++)l=q+h.getLength()-g[k].length,g[k][q]=0<=l?h.get(l):0}for(q=k=0;q<b.length;q++)k+=b[q].totalCount;c=Array(k);for(q=h=0;q<d;q++)for(k=0;k<b.length;k++)q<f[k].length&&(c[h++]=f[k][q]);for(q=0;q<e;q++)for(k=0;k<b.length;k++)q<g[k].length&&(c[h++]=g[k][q]);return c};for(var c={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,
MODE_KANJI:8},a={L:1,M:0,Q:3,H:2},u={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],
[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;0<=u.getBCHDigit(b)-u.getBCHDigit(u.G15);)b^=u.G15<<u.getBCHDigit(b)-u.getBCHDigit(u.G15);return(a<<10|b)^u.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;0<=u.getBCHDigit(b)-u.getBCHDigit(u.G18);)b^=u.G18<<u.getBCHDigit(b)-u.getBCHDigit(u.G18);
return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return u.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case 0:return 0==(b+c)%2;case 1:return 0==b%2;case 2:return 0==c%3;case 3:return 0==(b+c)%3;case 4:return 0==(Math.floor(b/2)+Math.floor(c/3))%2;case 5:return 0==b*c%2+b*c%3;case 6:return 0==(b*c%2+b*c%3)%2;case 7:return 0==(b*c%3+(b+c)%2)%2;default:throw Error("bad maskPattern:"+a);}},getErrorCorrectPolynomial:function(a){for(var b=
new r([1],0),c=0;c<a;c++)b=b.multiply(new r([1,v.gexp(c)],0));return b},getLengthInBits:function(a,b){if(1<=b&&10>b)switch(a){case c.MODE_NUMBER:return 10;case c.MODE_ALPHA_NUM:return 9;case c.MODE_8BIT_BYTE:return 8;case c.MODE_KANJI:return 8;default:throw Error("mode:"+a);}else if(27>b)switch(a){case c.MODE_NUMBER:return 12;case c.MODE_ALPHA_NUM:return 11;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 10;default:throw Error("mode:"+a);}else if(41>b)switch(a){case c.MODE_NUMBER:return 14;
case c.MODE_ALPHA_NUM:return 13;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 12;default:throw Error("mode:"+a);}else throw Error("type:"+b);},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;d<b;d++)for(var e=0;e<b;e++){for(var f=0,g=a.isDark(d,e),k=-1;1>=k;k++)if(!(0>d+k||b<=d+k))for(var h=-1;1>=h;h++)0>e+h||b<=e+h||0==k&&0==h||g!=a.isDark(d+k,e+h)||f++;5<f&&(c+=3+f-5)}for(d=0;d<b-1;d++)for(e=0;e<b-1;e++)if(f=0,a.isDark(d,e)&&f++,a.isDark(d+1,e)&&f++,a.isDark(d,e+1)&&f++,
a.isDark(d+1,e+1)&&f++,0==f||4==f)c+=3;for(d=0;d<b;d++)for(e=0;e<b-6;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(e=0;e<b;e++)for(d=0;d<b-6;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);for(e=f=0;e<b;e++)for(d=0;d<b;d++)a.isDark(d,e)&&f++;return c+Math.abs(100*f/b/b-50)/5*10}},v={glog:function(a){if(1>a)throw Error("glog("+a+
")");return v.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;256<=a;)a-=255;return v.EXP_TABLE[a]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},q=0;8>q;q++)v.EXP_TABLE[q]=1<<q;for(q=8;256>q;q++)v.EXP_TABLE[q]=v.EXP_TABLE[q-4]^v.EXP_TABLE[q-5]^v.EXP_TABLE[q-6]^v.EXP_TABLE[q-8];for(q=0;255>q;q++)v.LOG_TABLE[v.EXP_TABLE[q]]=q;r.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=Array(this.getLength()+a.getLength()-1),c=0;c<this.getLength();c++)for(var d=
0;d<a.getLength();d++)b[c+d]^=v.gexp(v.glog(this.get(c))+v.glog(a.get(d)));return new r(b,0)},mod:function(a){if(0>this.getLength()-a.getLength())return this;for(var b=v.glog(this.get(0))-v.glog(a.get(0)),c=Array(this.getLength()),d=0;d<this.getLength();d++)c[d]=this.get(d);for(d=0;d<a.getLength();d++)c[d]^=v.gexp(v.glog(a.get(d))+b);return(new r(c,0)).mod(a)}};n.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],
[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,
46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,
70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,
46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],
[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,
46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];n.getRSBlocks=function(a,b){var c=n.getRsBlockTable(a,b);if(void 0==c)throw Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var d=c.length/3,e=[],f=0;f<d;f++)for(var g=c[3*f+0],k=c[3*f+1],h=c[3*f+2],l=0;l<g;l++)e.push(new n(k,h));return e};n.getRsBlockTable=function(b,
c){switch(c){case a.L:return n.RS_BLOCK_TABLE[4*(b-1)+0];case a.M:return n.RS_BLOCK_TABLE[4*(b-1)+1];case a.Q:return n.RS_BLOCK_TABLE[4*(b-1)+2];case a.H:return n.RS_BLOCK_TABLE[4*(b-1)+3]}};g.prototype={get:function(a){return 1==(this.buffer[Math.floor(a/8)]>>>7-a%8&1)},put:function(a,b){for(var c=0;c<b;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0);a&&(this.buffer[b]|=
128>>>this.length%8);this.length++}};var k=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,
805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],q=function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){function b(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a),d;for(d in b)b.hasOwnProperty(d)&&c.setAttribute(d,
b[d]);return c}var c=this._htOption,d=this._el,e=a.getModuleCount();this.clear();var f=b("svg",{viewBox:"0 0 "+String(e)+" "+String(e),width:"100%",height:"100%",fill:c.colorLight});f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");d.appendChild(f);f.appendChild(b("rect",{fill:c.colorDark,width:"1",height:"1",id:"template"}));for(c=0;c<e;c++)for(d=0;d<e;d++)if(a.isDark(c,d)){var g=b("use",{x:String(c),y:String(d)});g.setAttributeNS("http://www.w3.org/1999/xlink",
"href","#template");f.appendChild(g)}};a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)};return a}(),d="svg"===document.documentElement.tagName.toLowerCase()?q:"undefined"==typeof CanvasRenderingContext2D?function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,d=a.getModuleCount(),e=Math.floor(b.width/d),f=Math.floor(b.height/d),g=['\x3ctable style\x3d"border:0;border-collapse:collapse;"\x3e'],
k=0;k<d;k++){g.push("\x3ctr\x3e");for(var h=0;h<d;h++)g.push('\x3ctd style\x3d"border:0;border-collapse:collapse;padding:0;margin:0;width:'+e+"px;height:"+f+"px;background-color:"+(a.isDark(k,h)?b.colorDark:b.colorLight)+';"\x3e\x3c/td\x3e');g.push("\x3c/tr\x3e")}g.push("\x3c/table\x3e");c.innerHTML=g.join("");a=c.childNodes[0];c=(b.width-a.offsetWidth)/2;b=(b.height-a.offsetHeight)/2;0<c&&0<b&&(a.style.margin=b+"px "+c+"px")};a.prototype.clear=function(){this._el.innerHTML=""};return a}():function(){function a(){this._elImage.src=
this._elCanvas.toDataURL("image/png");this._elImage.style.display="block";this._elCanvas.style.display="none"}function b(a,b){var c=this;c._fFail=b;c._fSuccess=a;if(null===c._bSupportDataURI){var d=document.createElement("img"),e=function(){c._bSupportDataURI=!1;c._fFail&&_fFail.call(c)};d.onabort=e;d.onerror=e;d.onload=function(){c._bSupportDataURI=!0;c._fSuccess&&c._fSuccess.call(c)};d.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg\x3d\x3d"}else!0===
c._bSupportDataURI&&c._fSuccess?c._fSuccess.call(c):!1===c._bSupportDataURI&&c._fFail&&c._fFail.call(c)}if(this._android&&2.1>=this._android){var c=1/window.devicePixelRatio,d=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,e,f,g,k,h,l,q){if("nodeName"in a&&/img/i.test(a.nodeName))for(var m=arguments.length-1;1<=m;m--)arguments[m]*=c;else"undefined"==typeof l&&(arguments[1]*=c,arguments[2]*=c,arguments[3]*=c,arguments[4]*=c);d.apply(this,arguments)}}var f=
function(a,b){this._bIsPainted=!1;this._android=e();this._htOption=b;this._elCanvas=document.createElement("canvas");this._elCanvas.width=b.width;this._elCanvas.height=b.height;a.appendChild(this._elCanvas);this._el=a;this._oContext=this._elCanvas.getContext("2d");this._bIsPainted=!1;this._elImage=document.createElement("img");this._elImage.alt="Scan me!";this._elImage.style.display="none";this._el.appendChild(this._elImage);this._bSupportDataURI=null};f.prototype.draw=function(a){var b=this._elImage,
c=this._oContext,d=this._htOption,e=a.getModuleCount(),f=d.width/e,g=d.height/e,k=Math.round(f),h=Math.round(g);b.style.display="none";this.clear();for(b=0;b<e;b++)for(var l=0;l<e;l++){var q=a.isDark(b,l),m=l*f,n=b*g;c.strokeStyle=q?d.colorDark:d.colorLight;c.lineWidth=1;c.fillStyle=q?d.colorDark:d.colorLight;c.fillRect(m,n,f,g);c.strokeRect(Math.floor(m)+.5,Math.floor(n)+.5,k,h);c.strokeRect(Math.ceil(m)-.5,Math.ceil(n)-.5,k,h)}this._bIsPainted=!0};f.prototype.makeImage=function(){this._bIsPainted&&
b.call(this,a)};f.prototype.isPainted=function(){return this._bIsPainted};f.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height);this._bIsPainted=!1};f.prototype.round=function(a){return a?Math.floor(1E3*a)/1E3:a};return f}();m=function(b,c){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:a.H};"string"===typeof c&&(c={text:c});if(c)for(var f in c)this._htOption[f]=c[f];"string"==typeof b&&(b=document.getElementById(b));
this._android=e();this._el=b;this._oQRCode=null;this._oDrawing=new d(this._el,this._htOption);this._htOption.text&&this.makeCode(this._htOption.text)};m.prototype.makeCode=function(b){var c=this._htOption.correctLevel,d=1,e;e=encodeURI(b).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");e=e.length+(e.length!=b?3:0);for(var g=0,h=k.length;g<=h;g++){var l=0;switch(c){case a.L:l=k[g][0];break;case a.M:l=k[g][1];break;case a.Q:l=k[g][2];break;case a.H:l=k[g][3]}if(e<=l)break;else d++}if(d>k.length)throw Error("Too long data");
this._oQRCode=new f(d,this._htOption.correctLevel);this._oQRCode.addData(b);this._oQRCode.make();this._el.title=b;this._oDrawing.draw(this._oQRCode);this.makeImage()};m.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()};m.prototype.clear=function(){this._oDrawing.clear()};m.CorrectLevel=a;window.QRCode=m})()})},"dojox/main":function(){define(["dojo/_base/kernel"],function(p){return p.dojox})},"builder/plugins/app-config-template-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-template-configpart/Plugin",
"dojo/text!builder/plugins/app-config-template-configpart/Plugin.html","dojo/text!builder/plugins/app-config-template-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-template-configpart/nls/strings"],function(){})},"builder/plugins/app-config-template-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/html dojo/promise/all dojo/_base/array dojo/topic builder/BasePlugin jimu/utils builder/dijit/TemplateAttributes".split(" "),function(p,
f,b,m,l,h,r,n,g,e){return p([n],{baseClass:"plugin-appconfig-template-configpart",_appConfig:null,_appConfigLoadDef:null,postCreate:function(){this.inherited(arguments);this._appConfigLoadDef=new b;this._updateDom();this._bindEvent()},startup:function(){this.inherited(arguments);this.isAdvance=!1;l({appConfig:this._appConfigLoadDef}).then(f.hitch(this,function(){this._init()}))},_updateDom:function(){"HTML3D"===window.appInfo.appType&&(m.setAttr(this.mapTitle,"innerHTML",this.nls.scene),m.setAttr(this.selectMapBtn,
"innerHTML",this.nls.chooseWebScene))},_init:function(){if(this.visible&&this._appConfig){var b=this._getCleanTemplateConfigByAppConfig(this._appConfig.templateConfig);this.agoltempAttrs&&this.agoltempAttrs.destroy();this.agoltempAttrs=(new e({templateConfig:b})).placeAt(this.configPart);this.agoltempAttrs.on("fieldChanged",f.hitch(this,this._onAGOLTemplateAttributeChanged))}},_getCleanTemplateConfigByAppConfig:function(b){var a={configurationSettings:[],values:{}};if(b)return h.forEach(b.configurationSettings,
function(b){var c={category:b.category,fields:[]};h.forEach(b.fields,function(b){if(b.fieldName){var e=g.template.getConfigValueWithId(this._appConfig,b.fieldName);void 0!==e&&(c.fields.push(b),a.values[b.fieldName]=e)}},this);0<c.fields.length&&a.configurationSettings.push(c)},this),a},_getTemplateAppConfigByTemplateConfig:function(b,a){var c=this._getDefaultTemplateAppConfig();if(a)return h.forEach(a.configurationSettings,function(a){h.forEach(a.fields,function(a){if(a.fieldName){var e=g.template.getConfigValueWithId(b,
a.fieldName);void 0!==e&&(c.values[a.fieldName]=e)}},this)},this),c},_getChangedTemplateAppConfigFromTemplateAttirbuts:function(b){var a=this._getDefaultTemplateAppConfig(),c=this.agoltempAttrs.getElementDijits(),e;for(e in c)if(c.hasOwnProperty(e)&&"function"!==typeof c[e]){var f=g.template.getConfigValueWithId(b,e);void 0!==f&&f!==c[e].getDijitValue()&&(a.values[e]=f)}return a},_getDefaultTemplateConfig:function(){return{configurationSettings:[{category:"",fields:[]}],values:{}}},_getDefaultTemplateAppConfig:function(){return{source:null,
folderId:null,values:{}}},_onAGOLTemplateAttributeChanged:function(b){g.template.setConfigValueWithId(this._appConfig,b.fieldName,b.value);"Attribute"===b.categoryName?r.publish("appAttributeChanged",{title:this._appConfig.title,subtitle:this._appConfig.subtitle,links:this._appConfig.links,logo:this._appConfig.logo}):(b=g.template.getKeyInfo(b.fieldName),"widget"===b.type?(b=this._appConfig.getConfigElementById(b.id),r.publish("widgetChanged",b)):"group"===b.type?(b=this._appConfig.getConfigElementById(b.id),
r.publish("groupChanged",b)):console.errror("errror"))},_bindEvent:function(){this.own(r.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)));this.own(r.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)));this.own(r.subscribe("new-webmap-item-selected",f.hitch(this,this._onWebmapItemSelected)));this.own(r.subscribe("app/mapLoaded",f.hitch(this,this._onMapLoaded)))},_onAppConfigLoaded:function(b){this._appConfig=f.clone(b);this._appConfigLoadDef.resolve(this._appConfig)},
_onAppConfigChanged:function(b){this._appConfig=f.clone(b)},_onSelectMapClick:function(){var b=this.pluginManager.getPluginByName("map-config");b&&b.showMapSelector()},_onWebmapItemSelected:function(b){m.setAttr(this.mapName,"innerHTML",b.title);m.setAttr(this.mapName,"title",b.title)},_onMapLoaded:function(b){m.setAttr(this.mapName,"innerHTML",b.itemInfo.item.title);m.setAttr(this.mapName,"title",b.itemInfo.item.title)},refresh:function(){this._init()}})})},"builder/dijit/TemplateAttributes":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/html dojo/on dojo/promise/all dojo/Evented jimu/utils dijit/_WidgetBase dijit/_TemplatedMixin dijit/form/_FormMixin dijit/Tooltip dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/Select dijit/form/ValidationTextBox dijit/form/SimpleTextarea dijit/Editor esri/dijit/ColorPicker dijit/_editor/plugins/TextColor dijit/_editor/plugins/LinkDialog".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x){var A=p([e,c,a,n],{templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"agoltemplate-attributes",item:null,itemTitle:null,defaultMaxSelectHeight:"150px",defaultTextAreaSize:5,_appConfig:null,_templateConfig:null,_templateAppConfig:null,_elementDijits:null,constructor:function(a){this.nls=f.mixin(this.nls,builderNls);this._init(a.templateConfig,a.templateAppConfig)},destroy:function(){b.forEach(this.tooltips,function(a){a.destroy()});
this.inherited(arguments)},startup:function(){this.buildConfigurationPanel();this.inherited(arguments)},update:function(a){for(var b in a.values)a.values.hasOwnProperty(b)&&"function"!==typeof a.values[b]&&this._elementDijits[b].setDijitValue(a.values[b])},getElementDijits:function(){return this._elementDijits},getTemplateAppConfig:function(){var a=this._getValuesObjOfElementDijits();f.mixin(this._templateAppConfig.values,a);return this._templateAppConfig},onFieldChange:function(a,b,c){this.emit("fieldChanged",
{categoryName:a,fieldName:b,value:c})},_init:function(a,b){this._templateConfig=a||{configurationSettings:{},values:{}};this._templateAppConfig=b||{source:null,folderId:null,values:{webmap:null}};f.mixin(this._templateConfig.values,this._templateAppConfig.values);this._elementDijits={};this._templateConfig.configurationSettings&&this._templateAppConfig.values||console.error("AGOLTemplate config page: please provide correct parameters in the constructor");this.tooltips=[];this.originalItem={id:this._templateConfig.values.webmap||
this._templateConfig.values.group,type:this._templateConfig.values.webmap?"webmap":"group"}},_getWebmapOrGroupItem:function(a,b){var c=new m;try{"webmap"===b?this.portal.queryItems({q:"id:"+a}).then(f.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()})):this.portal.queryGroups({q:"id:"+a}).then(f.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()}))}catch(B){c.resolve()}return c.promise},buildConfigurationPanel:function(){var a=
[];b.forEach(this._templateConfig.configurationSettings,f.hitch(this,function(c){var d=c.category,e=c.fields,g=l.create("fieldset",{},this.containerNode);l.create("legend",f.mixin(c.params||{},{innerHTML:d}),g);b.forEach(e,f.hitch(this,function(c){a.push(this._createField(c,d).then(f.hitch(this,function(a){b.forEach(a.nodes,function(a){l.place(a.domNode||a,g)});l.create("br",{},g);"paragraph"!==a.type&&null!==a.fieldDijit&&c.tooltip&&c.tooltip.length&&this.tooltips.push(new u({connectId:[a.fieldDijit.id],
label:c.tooltip}))})))}))}));r(a).then(f.hitch(this,function(){}))},_createField:function(a,b){var c=new m,d=null,e=a.type&&a.type.toLowerCase()||"string",f=[],k=l.create("layerandfieldselector"===e?"p":"label",{innerHTML:g.stripHTML(a.label)||"",id:e+"_"+a.fieldName,"class":e},null);f.push(k);"boolean"===e?(f.splice(0,0,d=this._createBooleanField(a,b)),l.addClass(k,"checkout-box-label")):"number"===e?f.push(d=this._createNumberField(a,b)):"paragraph"===e?f.splice(0,1,d=this._createParagraph(a)):
a.options?f.push(d=this._createOptionsField(a,b)):"color"===e?f.push(d=this._createColor(a,b)):f.push(d=this._createStringField(a,b));l.setAttr(k,"for",d.id);c.resolve({nodes:f,fieldDijit:d,type:e});return c.promise},_createBooleanField:function(a,b){var c=f.mixin({value:!0,name:a.fieldName},a),d=this._templateConfig.values;c.checked=d&&void 0!==d[a.fieldName]?d[a.fieldName]:!0;c=new v(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createNumberField:function(a,b){var c=f.mixin({name:a.fieldName,
"class":"field-input"},a),d=this._templateConfig.values;c.value=d&&void 0!==d[a.fieldName]?d[a.fieldName]:a.min||NaN;c=new q(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createParagraph:function(a){var b=f.mixin({name:a.fieldName||""},a);b.innerHTML=a.value||"";return l.create("p",b)},_createOptionsField:function(a,c){var d={maxHeight:this.defaultMaxSelectHeight,name:a.fieldName,"class":"field-input"},d=f.mixin(d,a),e=-1,g=b.some(d.options,f.hitch(this,function(b,c){e=c;return b.value===
this._templateConfig.values[a.fieldName]?c:!1}));d.options[g?e:0].selected=!0;d=new k(d);this._afterCreateNormalField(d,c,a.fieldName);return d},_createStringField:function(a,b){var c=null,c={regExp:".*",constraints:{},trim:!0,name:a.fieldName,value:(this._templateConfig.values[a.fieldName]||"").toString(),"class":" "},c=f.mixin(c,a);a.stringFieldOption&&a.stringFieldOption===A.STRING_FIELD_OPTION_TEXTAREA?(c["class"]+=" field-input text-area-field",c.rows=a.rows||this.defaultTextAreaSize,c.columns=
a.columns||this.defaultTextAreaSize,c=new w(c)):a.stringFieldOption&&a.stringFieldOption===A.STRING_FIELD_OPTION_RICHTEXT?(c["class"]+=" rich-text-field",c.plugins="bold italic underline foreColor hiliteColor removeFormat | justifyLeft indent outdent | insertOrderedList insertUnorderedList |".split(" "),c.extraPlugins=["createLink","unlink","insertImage"],c=new t(c)):(c["class"]+=" field-input",c=new d(c));this._afterCreateNormalField(c,b,a.fieldName);return c},_createColor:function(a,b){var c=new x({name:a.fieldName,
required:!0,showTransparencySlider:!1,showRecentColors:!1,"class":"color-picker-field"});this._templateConfig.values[a.fieldName]&&c.set("color",this._templateConfig.values[a.fieldName]);c.setDijitValue=f.hitch(c,function(a){this.set("color",a,!1)});c.getDijitValue=f.hitch(c,function(){this.get("color")});this._elementDijits[a.fieldName]=c;c.on("color-change",f.hitch(this,function(c){if(c&&c.color)this.onFieldChange(b,a.fieldName,c.color.toHex())}));return c},_afterCreateNormalField:function(a,b,
c){a.setDijitValue=f.hitch(a,function(a){this.set("value",a,!1)});a.getDijitValue=f.hitch(a,function(){return this.get("value")});this._elementDijits[c]=a;this.own(h(a,"change",f.hitch(this,this.onFieldChange,b,c)))},_getValuesObjOfElementDijits:function(){var a={},b=this.getElementDijits(),c;for(c in b)b.hasOwnProperty(c)&&"function"!==typeof b[c]&&(a[c]=b[c].getDijitValue());return a}});f.mixin(A,{STRING_FIELD_OPTION_TEXTBOX:"textbox",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_RICHTEXT:"richtext"});
return A})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),function(p,f,b,m,l,h,r,n,g){m("dijit-legacy-requires")&&h(0,function(){p(["dijit/form/RadioButton"])});return f("dijit.form.CheckBox",[r,n],{templateString:g,baseClass:"dijitCheckBox",_setValueAttr:function(b,c){"string"==typeof b&&(this.inherited(arguments),b=!0);
this._created&&this.set("checked",b,c)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},_fillContent:function(){},_onFocus:function(){this.id&&l("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&l("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},
"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(p,f,b,m){return p("dijit.form.ToggleButton",[b,m],{baseClass:"dijitToggleButton",setChecked:function(b){f.deprecated("setChecked("+b+") is deprecated. Use set('checked',"+b+") instead.","","2.0");this.set("checked",b)}})})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(p,f){return p("dijit.form._ToggleButtonMixin",null,
{checked:!1,_aria_attr:"aria-pressed",_onClick:function(b){var f=this.checked;this._set("checked",!f);var l=this.inherited(arguments);this.set("checked",l?this.checked:f);return l},_setCheckedAttr:function(b,m){this._set("checked",b);var l=this.focusNode||this.domNode;this._created&&f.get(l,"checked")!=!!b&&f.set(l,"checked",!!b);l.setAttribute(this._aria_attr,String(b));this._handleOnChange(b,m)},postCreate:function(){this.inherited(arguments);var b=this.focusNode||this.domNode;this.checked&&b.setAttribute("checked",
"checked");void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.checked)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(p,f){return p("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(b){this._set("readOnly",b);f.set(this.focusNode,"readOnly",b)},_setLabelAttr:void 0,
_getSubmitValue:function(b){return null==b||""===b?"on":b},_setValueAttr:function(b){b=this._getSubmitValue(b);this._set("value",b);f.set(this.focusNode,"value",b)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));f.set(this.focusNode,"value",this.value)},_onClick:function(b){return this.readOnly?(b.stopPropagation(),b.preventDefault(),!1):this.inherited(arguments)}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),
function(p,f,b,m,l,h){var r=function(f){f=f||{};var e=b.getLocalization("dojo.cldr","number",b.normalizeLocale(f.locale)),c=f.pattern?f.pattern:e[(f.type||"decimal")+"Format"];f="number"==typeof f.places?f.places:"string"===typeof f.places&&0<f.places.length?f.places.replace(/.*,/,""):-1!=c.indexOf(".")?c.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:e.decimal,places:f}},n=p("dijit.form.NumberTextBoxMixin",null,{pattern:function(b){return"("+(this.focused&&this.editOptions?this._regExpGenerator(f.delegate(b,
this.editOptions))+"|":"")+this._regExpGenerator(b)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:l.format,_regExpGenerator:l.regexp,_decimalInfo:r(),postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},_setConstraintsAttr:function(b){var e="number"==typeof b.places?b.places:0;e&&e++;"number"!=typeof b.max&&(b.max=9*Math.pow(10,15-e));"number"!=typeof b.min&&(b.min=-9*Math.pow(10,15-e));this.inherited(arguments,[b]);this.focusNode&&this.focusNode.value&&
!isNaN(this.value)&&this.set("value",this.value);this._decimalInfo=r(b)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var b=this.get("value");"number"!=typeof b||isNaN(b)||(b=this.format(b,this.constraints),void 0!==b&&(this.textbox.value=b));this.inherited(arguments)}},format:function(b,e){var c=String(b);if("number"!=typeof b)return c;if(isNaN(b))return"";if(!("rangeCheck"in this&&this.rangeCheck(b,e))&&!1!==e.exponent&&/\de[-+]?\d/i.test(c))return c;this.editOptions&&this.focused&&(e=
f.mixin({},e,this.editOptions));return this._formatter(b,e)},_parser:l.parse,parse:function(b,e){var c=f.mixin({},e,this.editOptions&&this.focused?this.editOptions:{});if(this.focused&&null!=c.places){var a=c.places,a="number"===typeof a?a:Number(a.split(",").pop());c.places="0,"+a}c=this._parser(b,c);this.editOptions&&this.focused&&isNaN(c)&&(c=this._parser(b,e));return c},_getDisplayedValueAttr:function(){var b=this.inherited(arguments);return isNaN(b)?this.textbox.value:b},filter:function(b){if(null==
b||"string"==typeof b&&""==b)return NaN;"number"!=typeof b||isNaN(b)||0==b||(b=l.round(b,this._decimalInfo.places));return this.inherited(arguments,[b])},serialize:function(b,e){return"number"!=typeof b||isNaN(b)?"":this.inherited(arguments)},_setBlurValue:function(){var b=f.hitch(f.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(b,!0)},_setValueAttr:function(b,e,c){if(void 0!==b&&void 0===c)if(c=String(b),"number"==typeof b)if(isNaN(b))c="";else{if("rangeCheck"in this&&this.rangeCheck(b,
this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(c))c=void 0}else b?b=void 0:(c="",b=NaN);this.inherited(arguments,[b,e,c])},_getValueAttr:function(){var b=this.inherited(arguments);if(isNaN(b)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+l._realNumberRegexp(f.delegate(this.constraints))+"$")).test(this.textbox.value))return b=Number(this.textbox.value),isNaN(b)?void 0:b}else return b},isValid:function(b){if(!this.focused||
this._isEmpty(this.textbox.value))return this.inherited(arguments);var e=this.get("value");return!isNaN(e)&&this.rangeCheck(e,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var b="number"==typeof this.constraints.min,e="number"==typeof this.constraints.max,c=this.get("value");if(isNaN(c)||!b&&!e)return this.inherited(arguments);var a=c|0,f=0>c,h=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),
l=(this.maxLength||20)-this.textbox.value.length,k=h?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",a=h?a+"."+k:a+"",l=m.rep("9",l),h=c;f?h=Number(a+l):c=Number(a+l);return!(b&&c<this.constraints.min||e&&h>this.constraints.max)}});p=p("dijit.form.NumberTextBox",[h,n],{baseClass:"dijitTextBox dijitNumberTextBox"});p.Mixin=n;return p})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare","dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(p,
f,b){return p("dijit.form.RangeBoundTextBox",b,{rangeMessage:"",rangeCheck:function(b,f){return("min"in f?0<=this.compare(b,f.min):!0)&&("max"in f?0>=this.compare(b,f.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var b=this.get("value");if(null==b)return!1;var f=!1;"min"in this.constraints&&(f=this.constraints.min,f=0>this.compare(b,"number"==typeof f&&0<=f&&0!=b?0:f));!f&&"max"in this.constraints&&(f=this.constraints.max,
f=0<this.compare(b,"number"!=typeof f||0<f?f:0));return f},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(b){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(b))},getErrorMessage:function(b){var f=this.get("value");return null==f||""===f||"number"==typeof f&&isNaN(f)||this.isInRange(b)?this.inherited(arguments):this.rangeMessage},postMixInProperties:function(){this.inherited(arguments);
this.rangeMessage||(this.messages=f.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(p,f,b,m){return p("dijit.form.MappedTextBox",m,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(b){return b.toString?b.toString():""},toString:function(){var b=
this.filter(this.get("value"));return null!=b?"string"==typeof b?b:this.serialize(b,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=b.place("\x3cinput type\x3d'hidden'"+(this.name&&!f("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t){function x(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(n.hitch(this,a,b))}}var A=f("dijit.form._SelectMenu",u,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(g(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;
n.isArray(b)&&(b=b[b.length-1]);b&&p.forEach(this.parentWidget._getChildren(),function(c){c.option&&b===c.option.value&&(a=!0,this.focusChild(c,!1))},this);a||this.inherited(arguments)}});l=f("dijit.form.Select"+(e("dojo-bidi")?"_NoBidi":""),[c,a,d],{baseClass:"dijitSelect dijitValidationTextBox",templateString:t,_buttonInputDisabled:e("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new A({id:this.id+"_menu",parentWidget:this});m.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(a.value||a.label){var b=n.hitch(this,"_setValueAttr",a);a=new v({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,
onClick:b,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a}return new q({ownerDocument:this.ownerDocument})},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return this.dropDown?this.dropDown.getChildren():[]},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(y){}},focusChild:function(a){a&&this.set("value",
a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=w.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,c,d){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{p.forEach(this._getChildren(),function(a){a.destroyRecursive()});
var b=new v({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(a){this.inherited(arguments);b.set(this.valueNode,"value",this.get("value"));this._refreshState()},_setNameAttr:"valueNode",
_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" aria-selected\x3d"true" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?k.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):k.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);k.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=h.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(g(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[r.LEFT_ARROW];delete a[r.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
m.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);k.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){k.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
e("dojo-bidi")&&(l=f("dijit.form.Select",l,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));l._Menu=A;l.prototype._onContainerKeydown=x("_onContainerKeydown");l.prototype._onContainerKeypress=x("_onContainerKeypress");return l})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){return l("dijit.form._FormSelectWidget",u,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var b=this.options||[];if(null==a)return b;if(g.isArrayLike(a))return p.map(a,"return this.getOptions(item);",this);g.isString(a)&&(a={value:a});g.isObject(a)&&(p.some(b,function(b,c){for(var d in a)if(!(d in b)||b[d]!=a[d])return!1;a=c;return!0})||(a=-1));return 0<=a&&a<b.length?b[a]:null},addOption:function(a){p.forEach(g.isArrayLike(a)?a:[a],function(a){a&&g.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(g.isArrayLike(a)?
a:[a]);p.forEach(a,function(a){a&&(this.options=p.filter(this.options,function(b){return b.value!==a.value||b.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){p.forEach(g.isArrayLike(a)?a:[a],function(a){var b=this.getOptions({value:a.value}),c;if(b)for(c in a)b[c]=a[c]},this);this._loadChildren()},setStore:function(a,b,c){n.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,b,c)},_deprecatedSetStore:function(e,h,k){var d=this.store;k=k||{};if(d!==e){for(var l;l=this._notifyConnections.pop();)l.remove();e.get||(g.mixin(e,{_oldAPI:!0,get:function(a){var b=new f;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(b,c){var d=new f(function(){e.abort&&e.abort()});d.total=new f;var e=this.fetch(g.mixin({query:b,onBegin:function(a){d.total.resolve(a)},
onComplete:function(a){d.resolve(a)},onError:function(a){d.reject(a)}},c));return new a(d)}}),e.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[b.after(e,"onNew",g.hitch(this,"_onNewItem"),!0),b.after(e,"onDelete",g.hitch(this,"_onDeleteItem"),!0),b.after(e,"onSet",g.hitch(this,"_onSetItem"),!0)]));this._set("store",e)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);k.query&&this._set("query",k.query);k.queryOptions&&this._set("queryOptions",k.queryOptions);e&&e.query&&(this._loadingStore=!0,this.onLoadDeferred=new f,this._queryRes=e.query(this.query,this.queryOptions),c(this._queryRes,g.hitch(this,function(a){if(this.sortByLabel&&!k.sort&&a.length)if(e.getValue)a.sort(m.createSortFunction([{attribute:e.getLabelAttributes(a[0])[0]}],e));else{var b=this.labelAttr;a.sort(function(a,c){return a[b]>c[b]?1:c[b]>
a[b]?-1:0})}k.onFetch&&(a=k.onFetch.call(this,a,k));p.forEach(a,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(g.hitch(this,function(a,b,c){b==c?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=c&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:h);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(a):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),g.hitch(this,function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)})));return d},_setValueAttr:function(a,b){this._onChangeActive||(b=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=g.isArrayLike(a)?p.map(a,function(a){return g.isObject(a)?a:{value:a}}):g.isObject(a)?[a]:[{value:a}];a=p.filter(this.getOptions(a),function(a){return a&&a.value});var c=this.getOptions()||[];this.multiple||a[0]&&a[0].value||!c.length||(a[0]=
c[0]);p.forEach(c,function(b){b.selected=p.some(a,function(a){return a.value===b.value})});c=p.map(a,function(a){return a.value});if("undefined"!=typeof c&&"undefined"!=typeof c[0]){var d=p.map(a,function(a){return a.label});this._setDisplay(this.multiple?d:d[0]);this.inherited(arguments,[this.multiple?c:c[0],b]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=p.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?
a:a[0]},_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(p.forEach(this._getChildren(),function(a){a.destroyRecursive()}),p.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var b=this;p.forEach(this._getChildren(),function(c){var d=p.some(a,function(a){return c.option&&
a===c.option.value});d&&!b.multiple&&(b.focusedChild=c);r.toggle(c.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),d);c.domNode.setAttribute("aria-selected",d?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var b=p.filter(a,function(a){return a.selected})[0];if(b&&b.value)return b.value;a[0].selected=!0;return a[0].value}return this.multiple?p.map(p.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,b){b&&b.parent||this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var b=this.store,c=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:b.getLabel(a);return{value:c?b.getIdentity(a):null,label:c,item:a}},_addOptionForItem:function(a){var b=this.store;b.isItemLoaded&&!b.isItemLoaded(a)?b.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);h.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?e("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+n._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);b.after(this,"onChange",g.hitch(this,"_updateSelection"));var a=this.store;a&&(a.getIdentity||a.getFeatures()["dojo.data.api.Identity"])&&(this.store=null,this._deprecatedSetStore(a,this._oValue,
{query:this.query,queryOptions:this.queryOptions}));this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(p){var f={};p.setObject("dojo.data.util.sorter",f);f.basicComparator=function(b,f){var l=-1;null===b&&(b=void 0);null===f&&(f=void 0);if(b==f)l=0;else if(b>f||null==b)l=1;return l};f.createSortFunction=function(b,m){function l(a,b,c,e){return function(d,f){var g=e.getValue(d,a),k=e.getValue(f,
a);return b*c(g,k)}}for(var h=[],r,n=m.comparatorMap,g=f.basicComparator,e=0;e<b.length;e++){r=b[e];var c=r.attribute;if(c){r=r.descending?-1:1;var a=g;n&&("string"!==typeof c&&"toString"in c&&(c=c.toString()),a=n[c]||g);h.push(l(c,r,a,m))}}return function(a,b){for(var c=0;c<h.length;){var e=h[c++](a,b);if(0!==e)return e}return 0}};return f})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(p,f,b){var m=function(l){function h(f){l[f]=
function(){var g=arguments,e=b(l,function(b){Array.prototype.unshift.call(g,b);return m(p[f].apply(p,g))});if("forEach"!==f||r)return e}}if(!l)return l;var r=!!l.then;r&&(l=f.delegate(l));h("forEach");h("filter");h("map");null==l.total&&(l.total=b(l,function(b){return b.length}));return l};f.setObject("dojo.store.util.QueryResults",m);return m})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k){return p("dijit._HasDropDown",k,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(b){this.disabled||this.readOnly||("MSPointerDown"!=b.type&&"pointerdown"!=b.type&&b.preventDefault(),this.own(c.once(this.ownerDocument,a.release,e.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},_onDropDownMouseUp:function(a){var b=
this.dropDown,c=!1;if(a&&this._opened){var d=h.position(this._buttonNode,!0);if(!(a.pageX>=d.x&&a.pageX<=d.x+d.w&&a.pageY>=d.y&&a.pageY<=d.y+d.h)){for(d=a.target;d&&!c;)l.contains(d,"dijitPopup")?c=!0:d=d.parentNode;if(c){d=a.target;if(b.onItemClick){for(var e;d&&!(e=u.byNode(d));)d=d.parentNode;if(e&&e.onClick&&e.getParent)e.getParent().onItemClick(e,a)}return}}}this._opened?b.focus&&(!1!==b.autoFocus||"mouseup"==a.type&&!this.hovering)&&(this._focusDropDownTimer=this.defer(function(){b.focus();
delete this._focusDropDownTimer})):this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",left:"Left",right:"Right"}[this.dropDownPosition[0]]||
this.dropDownPosition[0]||"Down";l.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},postCreate:function(){this.inherited(arguments);var b=this.focusNode||this.domNode;this.own(c(this._buttonNode,a.press,e.hitch(this,"_onDropDownMouseDown")),c(this._buttonNode,"click",e.hitch(this,"_onDropDownClick")),c(b,"keydown",e.hitch(this,"_onKey")),c(b,"keyup",e.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),
delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&!this.readOnly){var b=this.dropDown,c=a.target;b&&this._opened&&b.handleKey&&!1===b.handleKey(a)?(a.stopPropagation(),a.preventDefault()):b&&this._opened&&a.keyCode==g.ESCAPE?(this.closeDropDown(),a.stopPropagation(),a.preventDefault()):!this._opened&&(a.keyCode==g.DOWN_ARROW||(a.keyCode==g.ENTER||a.keyCode==g.SPACE&&(!this._searchTimer||a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(c.tagName||"").toLowerCase()||
c.type&&"text"!==c.type.toLowerCase()))&&(this._toggleOnKeyUp=!0,a.stopPropagation(),a.preventDefault())}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(e.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=new f,b=e.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});
this.isLoaded()?b():this.loadDropDown(b);return a},toggleDropDown:function(){this.disabled||this.readOnly||(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,b=a.domNode,c=this._aroundNode||this.domNode,f=this,g=q.open({parent:this,popup:a,around:c,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){f.closeDropDown(!0)},onCancel:function(){f.closeDropDown(!0)},onClose:function(){m.set(f._popupStateNode,"popupActive",
!1);l.remove(f._popupStateNode,"dijitHasDropDownOpen");f._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&c.offsetWidth>a._popupWrapper.offsetWidth){var c=c.offsetWidth-a._popupWrapper.offsetWidth,k={w:a.domNode.offsetWidth+c};this._origStyle=b.style.cssText;e.isFunction(a.resize)?a.resize(k):h.setMarginBox(b,k);"R"==g.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-c+"px")}m.set(this._popupStateNode,"popupActive","true");l.add(this._popupStateNode,"dijitHasDropDownOpen");
this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"===b.getAttribute("role")||b.getAttribute("aria-labelledby")||b.setAttribute("aria-labelledby",this.id);return g},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),q.close(this.dropDown),
this._opened=!1);this._origStyle&&(this.dropDown.domNode.style.cssText=this._origStyle,delete this._origStyle)}})})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main dojo/touch".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k){function d(){this._popupWrapper&&(h.destroy(this._popupWrapper),delete this._popupWrapper)}
b=b(null,{_stack:[],_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var a=this._firstAroundPosition,b=r.position(this._firstAroundNode,!0),d=b.x-a.x,a=b.y-a.y;if(d||a)for(this._firstAroundPosition=b,b=0;b<this._stack.length;b++){var e=this._stack[b].wrapper.style;e.top=parseFloat(e.top)+a+"px";"auto"==e.right?e.left=parseFloat(e.left)+d+"px":e.right=parseFloat(e.right)-d+"px"}this._aroundMoveListener=setTimeout(c.hitch(this,"_repositionAll"),d||a?10:50)}},_createWrapper:function(b){var c=
b._popupWrapper,e=b.domNode;c||(c=h.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":b["aria-label"]||b.label||b.name||b.id},b.ownerDocumentBody),c.appendChild(e),e=e.style,e.display="",e.visibility="",e.position="",e.top="0px",b._popupWrapper=c,f.after(b,"destroy",d,!0),"ontouchend"in document&&a(c,"touchend",function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}),c.dojoClick=!0);return c},moveOffScreen:function(a){var b=this._createWrapper(a);
a=r.isBodyLtr(a.ownerDocument);var c={visibility:"hidden",top:"-9999px",display:""};c[a?"left":"right"]="-9999px";c[a?"right":"left"]="auto";n.set(b,c);return b},hide:function(a){var b=this._createWrapper(a);n.set(b,{display:"none",height:"auto",overflowY:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},getTopPopup:function(){for(var a=this._stack,b=a.length-1;0<b&&a[b].parent===a[b-1].widget;b--);return a[b]},open:function(b){for(var d=this._stack,f=b.popup,
k=f.domNode,h=b.orient||["below","below-alt","above","above-alt"],p=b.parent?b.parent.isLeftToRight():r.isBodyLtr(f.ownerDocument),w=b.around,B=b.around&&b.around.id?b.around.id+"_dropdown":"popup_"+this._idGen++;d.length&&(!b.parent||!m.isDescendant(b.parent.domNode,d[d.length-1].widget.domNode));)this.close(d[d.length-1].widget);var E=this.moveOffScreen(f);f.startup&&!f._started&&f.startup();var G,I=r.position(k);if("maxHeight"in b&&-1!=b.maxHeight)G=b.maxHeight||Infinity;else{G=q.getEffectiveBox(this.ownerDocument);
var J=w?r.position(w,!1):{y:b.y-(b.padding||0),h:2*(b.padding||0)};G=Math.floor(Math.max(J.y,G.h-(J.y+J.h)))}I.h>G&&(I=n.getComputedStyle(k),n.set(E,{overflowY:"scroll",height:G+"px",border:I.borderLeftWidth+" "+I.borderLeftStyle+" "+I.borderLeftColor}),k._originalStyle=k.style.cssText,k.style.border="none");l.set(E,{id:B,style:{zIndex:this._beginZIndex+d.length},"class":"dijitPopup "+(f.baseClass||f["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:b.parent?b.parent.id:""});0==d.length&&w&&(this._firstAroundNode=
w,this._firstAroundPosition=r.position(w,!0),this._aroundMoveListener=setTimeout(c.hitch(this,"_repositionAll"),50));g("config-bgIframe")&&!f.bgIframe&&(f.bgIframe=new v(E));B=f.orient?c.hitch(f,"orient"):null;h=w?u.around(E,w,h,p,B):u.at(E,b,"R"==h?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],b.padding,B);E.style.visibility="visible";k.style.visibility="visible";k=[];k.push(a(E,"keydown",c.hitch(this,function(a){if(a.keyCode==e.ESCAPE&&b.onCancel)a.stopPropagation(),a.preventDefault(),b.onCancel();
else if(a.keyCode==e.TAB&&(a.stopPropagation(),a.preventDefault(),(a=this.getTopPopup())&&a.onCancel))a.onCancel()})));f.onCancel&&b.onCancel&&k.push(f.on("cancel",b.onCancel));k.push(f.on(f.onExecute?"execute":"change",c.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));d.push({widget:f,wrapper:E,parent:b.parent,onExecute:b.onExecute,onCancel:b.onCancel,onClose:b.onClose,handlers:k});if(f.onOpen)f.onOpen(h);return h},close:function(a){for(var b=this._stack;a&&p.some(b,
function(b){return b.widget==a})||!a&&b.length;){var c=b.pop(),d=c.widget,e=c.onClose;d.bgIframe&&(d.bgIframe.destroy(),delete d.bgIframe);if(d.onClose)d.onClose();for(var f;f=c.handlers.pop();)f.remove();d&&d.domNode&&this.hide(d);e&&e()}0==b.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return k.popup=new b})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html",
"./_MenuBase"],function(p,f,b,m){return p("dijit.DropDownMenu",m,{templateString:b,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(b){this._moveToPopup(b);b.stopPropagation();b.preventDefault()},_onLeftArrow:function(b){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else b.stopPropagation(),b.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){return f("dijit._MenuBase",[a,q,v,u],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){l.toggle(this.domNode,"dijitMenuActive",a);l.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,
childSelector:function(a){var b=c.byNode(a);return a.parentNode==this.containerNode&&b&&b.focus},postCreate:function(){var a=this,b="string"==typeof this.childSelector?this.childSelector:h.hitch(this,"childSelector");this.own(n(this.containerNode,n.selector(b,r.enter),function(){a.onItemHover(c.byNode(this))}),n(this.containerNode,n.selector(b,r.leave),function(){a.onItemUnhover(c.byNode(this))}),n(this.containerNode,n.selector(b,e),function(b){a.onItemClick(c.byNode(this),b);b.stopPropagation()}),
n(this.containerNode,n.selector(b,"focusin"),function(){a._onItemFocus(c.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,b,c,e){this.inherited(arguments);if(a&&(-1==e||a.popup&&1==e))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,
a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),!a.popup||a.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,
{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",
!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var c=/^key/.test(b._origType||
b.type)||0==b.clientX&&0==b.clientY;this._openItemPopup(a,c)}else this.onExecute(),a._onClick?a._onClick(b):a.onClick(b)},_openItemPopup:function(a,b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var c=a.popup;c.parentMenu=this;this.own(this._mouseoverHandle=n.once(c.domNode,"mouseover",h.hitch(this,"_onPopupHover")));var d=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&
d.focusChild(a);d._cleanUp()},onExecute:h.hitch(this,"_cleanUp",!0),onClose:function(){d._mouseoverHandle&&(d._mouseoverHandle.remove(),delete d._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(m.set(this.selected.focusNode,"tabIndex",this.tabIndex),
this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(p,f,b,m,l,h,r,n,g,e){return f("dijit._KeyNavContainer",[g,e,n],{connectKeyNavHandlers:function(b,a){var c=this._keyNavCodes={},e=h.hitch(this,"focusPrev"),f=h.hitch(this,"focusNext");p.forEach(b,function(a){c[a]=e});p.forEach(a,function(a){c[a]=f});c[l.HOME]=h.hitch(this,"focusFirstChild");c[l.END]=h.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){m.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);p.forEach(this.getChildren(),
h.hitch(this,"_startupChild"))},addChild:function(b,a){this.inherited(arguments);this._startupChild(b)},_startupChild:function(b){b.set("tabIndex","-1")},_getFirst:function(){var b=this.getChildren();return b.length?b[0]:null},_getLast:function(){var b=this.getChildren();return b.length?b[b.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(b){return(b=
r.byNode(b))&&b.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(p,f,b,m,l,h,r,n){return f("dijit._KeyNavMixin",n,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);b.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var f=this._keyNavCodes={};f[m.HOME]=l.hitch(this,"focusFirstChild");f[m.END]=l.hitch(this,
"focusLastChild");f[this.isLeftToRight()?m.LEFT_ARROW:m.RIGHT_ARROW]=l.hitch(this,"_onLeftArrow");f[this.isLeftToRight()?m.RIGHT_ARROW:m.LEFT_ARROW]=l.hitch(this,"_onRightArrow");f[m.UP_ARROW]=l.hitch(this,"_onUpArrow");f[m.DOWN_ARROW]=l.hitch(this,"_onDownArrow")}var e=this,f="string"==typeof this.childSelector?this.childSelector:l.hitch(this,"childSelector");this.own(h(this.domNode,"keypress",l.hitch(this,"_onContainerKeypress")),h(this.domNode,"keydown",l.hitch(this,"_onContainerKeydown")),h(this.domNode,
"focus",l.hitch(this,"_onContainerFocus")),h(this.containerNode,h.selector(f,"focusin"),function(b){e._onChildFocus(r.getEnclosingWidget(this),b)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(b,e){b&&(this.focusedChild&&b!==this.focusedChild&&this._onChildBlur(this.focusedChild),b.set("tabIndex",this.tabIndex),b.focus(e?"end":"start"))},_onContainerFocus:function(b){b.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){b.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(f){b.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(b){b&&b!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),b.set("tabIndex",this.tabIndex),this.lastFocused=b,this._set("focusedChild",b))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(b,e,c,a){b&&this.focusChild(b)},_keyboardSearchCompare:function(b,e){var c=b.domNode,c=(b.label||(c.focusNode?
c.focusNode.label:"")||c.innerText||c.textContent||"").replace(/^\s+/,"").substr(0,e.length).toLowerCase();return e.length&&c==e?-1:0},_isFormElement:function(b){return"INPUT"===b.tagName||"TEXTAREA"===b.tagName||"SELECT"===b.tagName||"BUTTON"===b.tagName},_onContainerKeydown:function(b){if(!this._isFormElement(document.activeElement)){var e=this._keyNavCodes[b.keyCode];e?(e(b,this.focusedChild),b.stopPropagation(),b.preventDefault(),this._searchString=""):b.keyCode!=m.SPACE||!this._searchTimer||
b.ctrlKey||b.altKey||b.metaKey||(b.stopImmediatePropagation(),b.preventDefault(),this._keyboardSearch(b," "))}},_onContainerKeypress:function(b){this._isFormElement(document.activeElement)||b.charCode<=m.SPACE||b.ctrlKey||b.altKey||b.metaKey||(b.preventDefault(),b.stopPropagation(),this._keyboardSearch(b,String.fromCharCode(b.charCode).toLowerCase()))},_keyboardSearch:function(b,e){var c=null,a,f=0;l.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=e;var b=/^(.)\1*$/.test(this._searchString)?
1:this._searchString.length;a=this._searchString.substr(0,b);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var g=this.focusedChild||null;if(1==b||!g)if(g=this._getNextFocusableChild(g,1),!g)return;b=g;do{var k=this._keyboardSearchCompare(g,a);k&&0==f++&&(c=g);if(-1==k){f=-1;break}g=this._getNextFocusableChild(g,1)}while(g&&g!=b)})();this.onKeyboardSearch(c,b,a,f)},_onChildBlur:function(){},_getNextFocusableChild:function(b,e){var c=
b;do{if(b)b=this._getNext(b,e);else if(b=this[0<e?"_getFirst":"_getLast"](),!b)break;if(null!=b&&b!=c&&b.isFocusable())return b}while(b!=c);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(b,e){if(b)for(b=b.domNode;b;)if((b=b[0>e?"previousSibling":"nextSibling"])&&"getAttribute"in b){var c=r.byNode(b);if(c)return c}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){r=p("dijit.MenuItem"+(h("dojo-bidi")?"_NoBidi":""),[n,g,e,c],{templateString:a,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var b="",c;c=a.search(/{\S}/);if(0<=c){var b=a.charAt(c+1),e=a.substr(0,c);a=a.substr(c+3);c=e+b+a;a=e+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+b+"\x3c/span\x3e"+a}else c=a;this.domNode.setAttribute("aria-label",c+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",b)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){!a||"label"in this.params||this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);b.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&b.set(this.accelKeyNode,"id",this.id+"_accel");f.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==h("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(u){}},_setSelected:function(a){m.toggle(this.domNode,
"dijitMenuItemSelected",a)},setLabel:function(a){l.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){l.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(a){this.accelKeyNode&&(this.accelKeyNode.style.display=
a?"":"none",this.accelKeyNode.innerHTML=a,b.set(this.containerNode,"colSpan",a?"1":"2"));this._set("accelKey",a)}});h("dojo-bidi")&&(r=p("dijit.MenuItem",r,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return r})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(p,f){return p("dijit._Contained",null,{_getSibling:function(b){var f=this.getParent();return f&&f._getSiblingOfChild&&f._getSiblingOfChild(this,
"previous"==b?-1:1)||null},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var b=this.getParent();return b&&b.getIndexOfChild?b.getIndexOfChild(this):-1}})})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(p,f,b,m,l,h){return p("dijit.MenuSeparator",[b,m,l],{templateString:h,
buildRendering:function(){this.inherited(arguments);f.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(p,f,b,m){return p("dijit.form.SimpleTextarea",m,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",
postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);b("ie")&&this.cols&&f.add(this.textbox,"dijitTextAreaCols")},filter:function(b){b&&(b=b.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(f){if(this.maxLength){var h=parseInt(this.maxLength),l=this.textbox.value.replace(/\r/g,""),h=l.length-h;if(0<h){var m=this.textbox;if(m.selectionStart){var g=m.selectionStart,
e=0;b("opera")&&(e=(this.textbox.value.substring(0,g).match(/\r/g)||[]).length);this.textbox.value=l.substring(0,g-h-e)+l.substring(g-e);m.setSelectionRange(g-h,g-h)}else this.ownerDocument.selection&&(m.focus(),l=this.ownerDocument.selection.createRange(),l.moveStart("character",-h),l.text="",l.select())}}this.inherited(arguments)}})})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B){function E(a){return new x({command:a.name})}function G(a){return new x({buttonClass:t,command:a.name})}b=b("dijit.Editor",C,{plugins:null,extraPlugins:null,constructor:function(){c.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",A]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(a("ie")||a("trident")||a("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new m;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);c.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=l.getLocalization("dijit._editor",
"commands",this.lang);a("webkit")&&g.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new k({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));f.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);r.add(this.iframe.parentNode,"dijitEditorIFrameContainer");r.add(this.iframe,"dijitEditorIFrame");h.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){f.forEach(this._plugins,function(a){a&&a.destroy&&a.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(a,b){var d=c.isString(a)?{name:a}:c.isFunction(a)?{ctor:a}:a;if(!d.setEditor){var e={args:d,plugin:null,editor:this};d.name&&(x.registry[d.name]?e.plugin=x.registry[d.name](d):v.publish(B._scopeName+".Editor.getPlugin",e));if(!e.plugin)try{var f=
d.ctor||c.getObject(d.name)||p(d.name);f&&(e.plugin=new f(d))}catch(H){throw Error(this.id+": cannot find plugin ["+d.name+"]");}if(!e.plugin)throw Error(this.id+": cannot find plugin ["+d.name+"]");a=e.plugin}1<arguments.length?this._plugins[b]=a:this._plugins.push(a);a.setEditor(this);c.isFunction(a.setToolbar)&&a.setToolbar(this.toolbar)},resize:function(a){a&&w.prototype.resize.apply(this,arguments)},layout:function(){var a=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+n.getPadBorderExtents(this.iframe.parentNode).h+
n.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=a+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(a){var b,c=this.document.body,d=c.clientWidth,e=c.clientHeight,f=c.clientLeft,g=c.offsetWidth,k=c.offsetHeight,h=c.offsetLeft;/^rtl$/i.test(c.dir||"")?d<g&&a.x>d&&a.x<g&&(b=!0):a.x<f&&a.x>h&&(b=!0);b||e<k&&a.y>e&&a.y<k&&(b=!0);b||(delete this._cursorToStart,delete this._savedSelection,"BODY"==a.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(a){this.customUndo&&this.endEditing(!0);"BODY"!=a.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(a){this._inEditing||(this._inEditing=!0,this._beginEditing(a));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(a){if(!this.customUndo||
"undo"!=a&&"redo"!=a){this.customUndo&&(this.endEditing(),this._beginEditing());var b=this.inherited(arguments);this.customUndo&&this._endEditing();return b}return this[a]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(b){var c;try{if(c=this.document.execCommand(b,!1,null),a("webkit")&&!c)throw{};}catch(L){c=u.substitute,alert(c(this.commands.systemShortcut,
[this.commands[b],c(this.commands[a("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[b]])])),c=!1}return c},queryCommandEnabled:function(a){return!this.customUndo||"undo"!=a&&"redo"!=a?this.inherited(arguments):"undo"==a?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(b){var d=b.mark,e=b.mark;b=b.isCollapsed;var g,k,h;e&&(9>a("ie")||9===a("ie")&&a("quirks")?c.isArray(e)?(d=[],f.forEach(e,function(a){d.push(z.getNode(a,this.editNode))},this),this.selection.moveToBookmark({mark:d,
isCollapsed:b})):e.startContainer&&e.endContainer&&(h=z.getSelection(this.window))&&h.removeAllRanges&&(h.removeAllRanges(),b=z.create(this.window),g=z.getNode(e.startContainer,this.editNode),k=z.getNode(e.endContainer,this.editNode),g&&k&&(b.setStart(g,e.startOffset),b.setEnd(k,e.endOffset),h.addRange(b))):(h=z.getSelection(this.window))&&h.removeAllRanges&&(h.removeAllRanges(),b=z.create(this.window),g=z.getNode(e.startContainer,this.editNode),k=z.getNode(e.endContainer,this.editNode),g&&k&&(b.setStart(g,
e.startOffset),b.setEnd(k,e.endOffset),h.addRange(b))))},_changeToStep:function(a,b){this.setValue(b.text);var c=b.bookmark;c&&this._moveToBookmark(c)},undo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._steps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(b,this._steps[this._steps.length-1]),this._undoedSteps.push(b),this.onDisplayChanged(),delete this._undoRedoActive,a=!0);delete this._undoRedoActive}return a},redo:function(){var a=
!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._undoedSteps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],b),this._steps.push(b),this.onDisplayChanged(),a=!0);delete this._undoRedoActive}return a},endEditing:function(a){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(a),this._inEditing=!1)},_getBookmark:function(){var b=this.selection.getBookmark(),d=[];if(b&&b.mark){var e=
b.mark;if(9>a("ie")||9===a("ie")&&a("quirks")){var g=z.getSelection(this.window);if(c.isArray(e))f.forEach(b.mark,function(a){d.push(z.getIndex(a,this.editNode).o)},this),b.mark=d;else if(g){var k;g.rangeCount&&(k=g.getRangeAt(0));b.mark=k?k.cloneRange():this.selection.getBookmark()}}try{b.mark&&b.mark.startContainer&&(d=z.getIndex(b.mark.startContainer,this.editNode).o,b.mark={startContainer:d,startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?d:z.getIndex(b.mark.endContainer,
this.editNode).o,endOffset:b.mark.endOffset})}catch(H){b.mark=null}}return b},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:y.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var a=y.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:a,bookmark:this._getBookmark()})},onKeyDown:function(b){a("ie")||this.iframe||b.keyCode!=e.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var c=b.keyCode;if(b.ctrlKey&&
!b.shiftKey&&!b.altKey){if(90==c||122==c){b.stopPropagation();b.preventDefault();this.undo();return}if(89==c||121==c){b.stopPropagation();b.preventDefault();this.redo();return}}this.inherited(arguments);switch(c){case e.ENTER:case e.BACKSPACE:case e.DELETE:this.beginEditing();break;case 88:case 86:if(b.ctrlKey&&!b.altKey&&!b.metaKey){this.endEditing();88==b.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!b.ctrlKey&&!b.altKey&&!b.metaKey&&(b.keyCode<
e.F1||b.keyCode>e.F15)){this.beginEditing();break}case e.ALT:this.endEditing();break;case e.UP_ARROW:case e.DOWN_ARROW:case e.LEFT_ARROW:case e.RIGHT_ARROW:case e.HOME:case e.END:case e.PAGE_UP:case e.PAGE_DOWN:this.endEditing(!0);case e.CTRL:case e.SHIFT:case e.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(I){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(a){this.customUndo?this.isClosed?this.setValue(a):(this.beginEditing(),a||(a="\x26#160;"),this.setValue(a),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(a){this.setValueDeferred.then(c.hitch(this,function(){!this.disabled&&a||!this._buttonEnabledPlugins&&a?
f.forEach(this._plugins,function(a){a.set("disabled",!0)}):this.disabled&&!a&&f.forEach(this._plugins,function(a){a.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&g.set(this.document.body,"color",g.get(this.iframe,"color"))}catch(I){}}});c.mixin(x.registry,{undo:E,redo:E,cut:E,copy:E,paste:E,insertOrderedList:E,insertUnorderedList:E,indent:E,outdent:E,justifyCenter:E,justifyFull:E,justifyLeft:E,justifyRight:E,
"delete":E,selectAll:E,removeFormat:E,unlink:E,insertHorizontalRule:E,bold:G,italic:G,underline:G,strikethrough:G,subscript:G,superscript:G,"|":function(){return new x({setEditor:function(a){this.editor=a;this.button=new d({ownerDocument:a.ownerDocument})}})}});return b})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(p,f,b,m,l,h,r,n){b("dijit-legacy-requires")&&l(0,function(){p(["dijit/ToolbarSeparator"])});
return f("dijit.Toolbar",[h,n,r],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(p,f,b,m){return p("dijit.ToolbarSeparator",[b,m],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',
buildRendering:function(){this.inherited(arguments);f.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(p,f,b,m,l,h,r,n,g){return h("dijit.layout._LayoutWidget",[f,b,m],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);
r.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var b=this.getParent&&this.getParent();b&&b.isLayoutContainer||(this.resize(),this.own(l.on("resize",p.hitch(this,"resize"))))}},resize:function(b,c){var a=this.domNode;b&&n.setMarginBox(a,b);var e=c||{};p.mixin(e,b||{});"h"in e&&"w"in e||(e=p.mixin(n.getMarginBox(a),e));var f=g.getComputedStyle(a),h=n.getMarginExtents(a,f),k=n.getBorderExtents(a,f),e=this._borderBox={w:e.w-(h.w+k.w),h:e.h-(h.h+k.h)},
h=n.getPadExtents(a,f);this._contentBox={l:g.toPixelValue(a,f.paddingLeft),t:g.toPixelValue(a,f.paddingTop),w:e.w-h.w,h:e.h-h.h};this.layout()},layout:function(){},_setupChild:function(b){r.add(b.domNode,this.baseClass+"-child "+(b.baseClass?this.baseClass+"-"+b.baseClass:""))},addChild:function(b,c){this.inherited(arguments);this._started&&this._setupChild(b)},removeChild:function(b){r.remove(b.domNode,this.baseClass+"-child"+(b.baseClass?" "+this.baseClass+"-"+b.baseClass:""));this.inherited(arguments)}})})},
"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(p,f,b,m,l){f=f("dijit._editor._Plugin",m,{constructor:function(f){this.params=f||{};b.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:l,disabled:!1,getLabel:function(b){return this.editor.commands[b]},_initButton:function(){if(this.command.length){var f=
this.getLabel(this.command),l=this.editor,m=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(f=b.mixin({label:f,ownerDocument:l.ownerDocument,dir:l.dir,lang:l.lang,showLabel:!1,iconClass:m,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete f.name,this.button=new this.buttonClass(f))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();
this.inherited(arguments)},connect:function(b,f,l){this.own(p.connect(b,f,this,l))},updateState:function(){var b=this.editor,f=this.command,l,g;if(b&&b.isLoaded&&f.length){var e=this.get("disabled");if(this.button)try{g=!e&&b.queryCommandEnabled(f),this.enabled!==g&&(this.enabled=g,this.button.set("disabled",!g)),g&&"boolean"==typeof this.button.checked&&(l=b.queryCommandState(f),this.checked!==l&&(this.checked=l,this.button.set("checked",b.queryCommandState(f))))}catch(c){console.log(c)}}},setEditor:function(f){this.editor=
f;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",b.hitch(this.editor,"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",b.hitch(this,"updateState")))},setToolbar:function(b){this.button&&b.addChild(this.button)},set:function(b,f){if("object"===typeof b){for(var h in b)this.set(h,b[h]);return this}h=this._getAttrNames(b);if(this[h.s])var g=
this[h.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(b,f);return g||this},get:function(b){var f=this._getAttrNames(b);return this[f.g]?this[f.g]():this[b]},_setDisabledAttr:function(b){this._set("disabled",b);this.updateState()},_getAttrNames:function(b){var f=this._attrPairNames;if(f[b])return f[b];var h=b.charAt(0).toUpperCase()+b.substr(1);return f[b]={s:"_set"+h+"Attr",g:"_get"+h+"Attr"}},_set:function(b,f){this[b]=f}});f.registry={};return f})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c){return p("dijit._editor.plugins.EnterKeyHandling",g,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=a.blockNodeForEnter.toUpperCase()),m.mixin(this,a))},setEditor:function(a){if(this.editor!==a)if(this.editor=a,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,a.onLoadDeferred.then(m.hitch(this,function(c){this.own(l(a.document,"keydown",m.hitch(this,function(a){if(a.keyCode==b.ENTER){var c=m.mixin({},a);c.shiftKey=
!0;this.handleEnterKey(c)||(a.stopPropagation(),a.preventDefault())}})));9<=h("ie")&&10>=h("ie")&&this.own(l(a.document,"paste",m.hitch(this,function(a){setTimeout(m.hitch(this,function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return c}));else if(this.blockNodeForEnter){var c=m.hitch(this,"handleEnterKey");a.addKeyHandler(13,0,0,c);a.addKeyHandler(13,0,1,c);this.own(this.editor.on("KeyPressed",m.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var a=this.editor.selection.getAncestorElement("LI");if(a){h("mozilla")&&"LI"==a.parentNode.parentNode.nodeName&&(a=a.parentNode.parentNode);var b=a.firstChild;!b||1!=b.nodeType||"UL"!=b.nodeName&&"OL"!=b.nodeName||(a.insertBefore(b.ownerDocument.createTextNode("\u00a0"),b),b=c.create(this.editor.window),b.setStart(a.firstChild,0),a=c.getSelection(this.editor.window,!0),a.removeAllRanges(),a.addRange(b))}else e.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(a=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(a.innerHTML=this.bogusHtmlContent,9>=h("ie")&&(a=this.editor.document.selection.createRange(),a.move("character",-1),a.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(a){var b,g,l,k,d=this.editor.document,m,t,r;if(a.shiftKey){a=this.editor.selection.getParentElement();if(k=c.getAncestor(a,this.blockNodes)){if("LI"==k.tagName)return!0;a=c.getSelection(this.editor.window);b=a.getRangeAt(0);b.collapsed||(b.deleteContents(),a=c.getSelection(this.editor.window),b=a.getRangeAt(0));if(c.atBeginningOfContainer(k,b.startContainer,b.startOffset))m=d.createElement("br"),b=c.create(this.editor.window),k.insertBefore(m,
k.firstChild),b.setStartAfter(m),a.removeAllRanges(),a.addRange(b);else if(c.atEndOfContainer(k,b.startContainer,b.startOffset))b=c.create(this.editor.window),m=d.createElement("br"),k.appendChild(m),k.appendChild(d.createTextNode("\u00a0")),b.setStart(k.lastChild,0),a.removeAllRanges(),a.addRange(b);else return(t=b.startContainer)&&3==t.nodeType?(r=t.nodeValue,g=d.createTextNode(r.substring(0,b.startOffset)),l=d.createTextNode(r.substring(b.startOffset)),k=d.createElement("br"),""==l.nodeValue&&
h("webkit")&&(l=d.createTextNode("\u00a0")),f.place(g,t,"after"),f.place(k,g,"after"),f.place(l,k,"after"),f.destroy(t),b=c.create(this.editor.window),b.setStart(l,0),a.removeAllRanges(),a.addRange(b),!1):!0}else a=c.getSelection(this.editor.window),a.rangeCount?(b=a.getRangeAt(0))&&b.startContainer&&(b.collapsed||(b.deleteContents(),a=c.getSelection(this.editor.window),b=a.getRangeAt(0)),(t=b.startContainer)&&3==t.nodeType?(k=b.startOffset,t.length<k&&(l=this._adjustNodeAndOffset(t,k),t=l.node,k=
l.offset),r=t.nodeValue,g=d.createTextNode(r.substring(0,k)),l=d.createTextNode(r.substring(k)),k=d.createElement("br"),l.length||(l=d.createTextNode("\u00a0")),g.length?f.place(g,t,"after"):g=t,f.place(k,g,"after"),f.place(l,k,"after"),f.destroy(t)):(0<=b.startOffset&&(m=t.childNodes[b.startOffset]),k=d.createElement("br"),l=d.createTextNode("\u00a0"),m?(f.place(k,m,"before"),f.place(l,k,"after")):(t.appendChild(k),t.appendChild(l))),b=c.create(this.editor.window),b.setStart(l,0),b.setEnd(l,l.length),
a.removeAllRanges(),a.addRange(b),this.editor.selection.collapse(!0)):e.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var p=!0;a=c.getSelection(this.editor.window);b=a.getRangeAt(0);b.collapsed||(b.deleteContents(),a=c.getSelection(this.editor.window),b=a.getRangeAt(0));m=c.getBlockAncestor(b.endContainer,null,this.editor.editNode);var y=m.blockNode;if(this._checkListLater=y&&("LI"==y.nodeName||"LI"==y.parentNode.nodeName))return h("mozilla")&&(this._pressedEnterInBlock=
y),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(y.innerHTML)&&(y.innerHTML="",h("webkit")&&(b=c.create(this.editor.window),b.setStart(y,0),a.removeAllRanges(),a.addRange(b)),this._checkListLater=!1),!0;if(!m.blockNode||m.blockNode===this.editor.editNode){try{e.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(z){}m={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(m.blockNode){if(m.blockNode!=this.editor.editNode&&!(m.blockNode.textContent||m.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(m.blockNode),!1}else m.blockNode=this.editor.editNode;a=c.getSelection(this.editor.window);b=a.getRangeAt(0)}y=d.createElement(this.blockNodeForEnter);y.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(m.blockNode);l=b.endOffset;p=b.endContainer;p.length<l&&(l=this._adjustNodeAndOffset(p,l),p=
l.node,l=l.offset);if(c.atEndOfContainer(m.blockNode,p,l))m.blockNode===m.blockContainer?m.blockNode.appendChild(y):f.place(y,m.blockNode,"after"),p=!1,b=c.create(this.editor.window),b.setStart(y,0),a.removeAllRanges(),a.addRange(b),this.editor.height&&n.scrollIntoView(y);else if(c.atBeginningOfContainer(m.blockNode,b.startContainer,b.startOffset))f.place(y,m.blockNode,m.blockNode===m.blockContainer?"first":"before"),y.nextSibling&&this.editor.height&&(b=c.create(this.editor.window),b.setStart(y.nextSibling,
0),a.removeAllRanges(),a.addRange(b),n.scrollIntoView(y.nextSibling)),p=!1;else{m.blockNode===m.blockContainer?m.blockNode.appendChild(y):f.place(y,m.blockNode,"after");p=!1;m.blockNode.style&&y.style&&m.blockNode.style.cssText&&(y.style.cssText=m.blockNode.style.cssText);if((t=b.startContainer)&&3==t.nodeType){l=b.endOffset;t.length<l&&(l=this._adjustNodeAndOffset(t,l),t=l.node,l=l.offset);r=t.nodeValue;g=d.createTextNode(r.substring(0,l));l=d.createTextNode(r.substring(l,r.length));f.place(g,t,
"before");f.place(l,t,"after");f.destroy(t);for(b=g.parentNode;b!==m.blockNode;){r=d.createElement(b.tagName);b.style&&r.style&&b.style.cssText&&(r.style.cssText=b.style.cssText);"FONT"===b.tagName&&(b.color&&(r.color=b.color),b.face&&(r.face=b.face),b.size&&(r.size=b.size));for(;l;)t=l.nextSibling,r.appendChild(l),l=t;f.place(r,b,"after");g=b;l=r;b=b.parentNode}if(1==l.nodeType||3==l.nodeType&&l.nodeValue)y.innerHTML="";for(g=l;l;)t=l.nextSibling,y.appendChild(l),l=t}b=c.create(this.editor.window);
d=g;if("BR"!==this.blockNodeForEnter){for(;d;)k=d,d=t=d.firstChild;k&&k.parentNode?(y=k.parentNode,b.setStart(y,0),a.removeAllRanges(),a.addRange(b),this.editor.height&&n.scrollIntoView(y),h("mozilla")&&(this._pressedEnterInBlock=m.blockNode)):p=!0}else b.setStart(y,0),a.removeAllRanges(),a.addRange(b),this.editor.height&&n.scrollIntoView(y),h("mozilla")&&(this._pressedEnterInBlock=m.blockNode)}return p},_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3==a.nextSibling.nodeType;)b-=
a.length,a=a.nextSibling;return{node:a,offset:b}},removeTrailingBr:function(a){if(a=/P|DIV|LI/i.test(a.tagName)?a:this.editor.selection.getParentOfType(a,["P","DIV","LI"]))a.lastChild&&(1<a.childNodes.length&&3==a.lastChild.nodeType&&/^[\s\xAD]*$/.test(a.lastChild.nodeValue)||"BR"==a.lastChild.tagName)&&f.destroy(a.lastChild),a.childNodes.length||(a.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J){var L=b("dijit._editor.RichText",[z,C],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&u.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new m},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[u.trim,u.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);d("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));d("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(d("ie")||d("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[u.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[u.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);t.publish(J._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=u.hitch(this,function(a,b){return function(){return!this.execCommand(a,b)}}),b={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};d("ie")||(b.Z=a("redo"));for(var c in b)this.addKeyHandler(c,!0,!1,b[c])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(L._editorCommandsLocalized)this._local2NativeFormatNames=L._local2NativeFormatNames,this._native2LocalFormatNames=L._native2LocalFormatNames;else{L._editorCommandsLocalized=!0;L._local2NativeFormatNames={};
L._native2LocalFormatNames={};this._local2NativeFormatNames=L._local2NativeFormatNames;this._native2LocalFormatNames=L._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),b="",c,d=0;c=a[d++];)b="l"!==c.charAt(1)?b+("\x3c"+c+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+c+"\x3e\x3cbr/\x3e"):b+("\x3c"+c+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+c+"\x3e\x3cbr/\x3e");var e=n.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:b});this.ownerDocumentBody.appendChild(e);
a=u.hitch(this,function(){for(var a=e.firstChild;a;)try{this.selection.selectElement(a.firstChild);var b=a.tagName.toLowerCase();this._local2NativeFormatNames[b]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[b]]=b;a=a.nextSibling.nextSibling}catch(N){}n.destroy(e)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new m;this.isClosed||this.close();t.publish(J._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var b=this.domNode,c;if(u.isString(this.value))c=this.value,b.innerHTML="";else if(b.nodeName&&"textarea"==b.nodeName.toLowerCase()){var g=this.textarea=b;this.name=g.name;c=g.value;b=this.domNode=this.ownerDocument.createElement("div");b.setAttribute("widgetId",this.id);g.removeAttribute("widgetId");b.cssText=g.cssText;b.className+=" "+g.className;n.place(b,g,"before");var k=u.hitch(this,function(){e.set(g,{display:"block",position:"absolute",
top:"-1000px"});if(d("ie")){var a=g.style;this.__overflow=a.overflow;a.overflow="hidden"}});d("ie")?this.defer(k,10):k();if(g.form){var q=g.value;this.reset=function(){this.getValue()!==q&&this.replaceValue(q)};v(g.form,"submit",u.hitch(this,function(){h.set(g,"disabled",this.disabled);g.value=this.getValue()}))}}else c=G.getChildrenHtml(b),b.innerHTML="";this.value=c;b.nodeName&&"LI"===b.nodeName&&(b.innerHTML=" \x3cbr\x3e");this.header=b.ownerDocument.createElement("div");b.appendChild(this.header);
this.editingArea=b.ownerDocument.createElement("div");b.appendChild(this.editingArea);this.footer=b.ownerDocument.createElement("div");b.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!f.useXDomain||f.allowXdRichTextSave)){if((c=l.byId(J._scopeName+"._editor.RichText.value"))&&""!==c.value)for(var k=c.value.split(this._SEPARATOR),p=0,w;w=k[p++];)if(w=w.split(this._NAME_CONTENT_SEP),w[0]===this.name){this.value=w[1];k=k.splice(p,1);c.value=k.join(this._SEPARATOR);
break}L._globalSaveHandler||(L._globalSaveHandler={},x.addOnUnload(function(){for(var a in L._globalSaveHandler){var b=L._globalSaveHandler[a];u.isFunction(b)&&b()}}));L._globalSaveHandler[this.id]=u.hitch(this,"_saveContent")}this.isClosed=!1;c=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");c.id=this.id+"_iframe";c.style.border="none";c.style.width="100%";this._layoutMode?c.style.height="100%":7<=d("ie")?(this.height&&(c.style.height=this.height),this.minHeight&&(c.style.minHeight=
this.minHeight)):c.style.height=this.height?this.height:this.minHeight;c.frameBorder=0;c._loadFunc=u.hitch(this,function(a){this.window=a;this.document=a.document;this.selection=new B.SelectionManager(a);d("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});k=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");k=11>d("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+k+"');document.close()":"javascript: '"+
k+"'";this.editingArea.appendChild(c);c.src=k;"LI"===b.nodeName&&(b.lastChild.style.marginTop="-1.2em");r.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=e.getComputedStyle(this.domNode),b;if(this["aria-label"])b=this["aria-label"];else{var f=q('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||l.byId(this["aria-labelledby"],this.ownerDocument);f&&(b=f.textContent||f.innerHTML||"")}var f="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(b?" aria-label\x3d'"+w.escape(b)+"'":"")+"\x3e\x3c/div\x3e",g=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),k=a.lineHeight,k=0<=k.indexOf("px")?parseFloat(k)/parseFloat(a.fontSize):0<=k.indexOf("em")?parseFloat(k):"normal",h="",m=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(a){a=a.replace(/^;/ig,"")+";";var b=a.split(":")[0];if(b){var b=u.trim(b),b=b.toLowerCase(),c,d="";for(c=0;c<b.length;c++){var f=b.charAt(c);switch(f){case "-":c++,f=b.charAt(c).toUpperCase();default:d+=
f}}e.set(m.domNode,d,"")}h+=a+";"});this.iframe.setAttribute("title",b);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||c.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",b?"\x3ctitle\x3e"+w.escape(b)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",g,";\n",this.height||d("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",k,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",d("ie")||d("trident")||d("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",b?" aria-label\x3d'"+w.escape(b)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+h+"'\x3e",f,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var b="",c=0,d,e=y.get(this.ownerDocument);d=a[c++];)d=(new A(e.location,d)).toString(),this.editingAreaStyleSheets.push(d),b+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+d+'"/\x3e';return b},addStyleSheet:function(a){var b=a.toString(),c=y.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new A(c.location,b)).toString();-1<p.indexOf(this.editingAreaStyleSheets,b)||(this.editingAreaStyleSheets.push(b),
this.onLoadDeferred.then(u.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(b);else{var a=this.document.getElementsByTagName("head")[0],c=this.document.createElement("link");c.rel="stylesheet";c.type="text/css";c.href=b;a.appendChild(c)}})))},removeStyleSheet:function(a){var b=a.toString(),c=y.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new A(c.location,b)).toString();a=p.indexOf(this.editingAreaStyleSheets,b);-1!==a&&(delete this.editingAreaStyleSheets[a],
q('link[href\x3d"'+b+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var b=d("ie")&&(this.isLoaded||!this.focusOnLoad);b&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;b&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(d("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var c in a)if(a.hasOwnProperty(c))try{this.document.execCommand(c,
!1,a[c])}catch(K){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=I.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var b=this;this.beforeIframeNode=n.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=n.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){b.editNode.focus()};this.focusNode=
this.editNode;var c=this.events.concat(this.captureEvents),e=this.iframe?this.document:this.editNode;this.own.apply(this,p.map(c,function(a){var b=a.toLowerCase().replace(/^on/,"");return v(e,b,u.hitch(this,a))},this));this.own(v(e,"mouseup",u.hitch(this,"onClick")));d("ie")&&(this.own(v(this.document,"mousedown",u.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);d("webkit")&&(this._webkitListener=this.own(v(this.document,"mouseup",u.hitch(this,"onDisplayChanged")))[0],this.own(v(this.document,
"mousedown",u.hitch(this,function(a){a=a.target;!a||a!==this.document.body&&a!==this.document||this.defer("placeCursorAtEnd")}))));if(d("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(V){}this.isLoaded=!0;this.set("disabled",this.disabled);c=u.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&k(u.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(c):c()},onKeyDown:function(b){if(b.keyCode===a.SHIFT||b.keyCode===a.ALT||b.keyCode===a.META||b.keyCode===a.CTRL)return!0;b.keyCode===a.TAB&&this.isTabIndent&&(b.stopPropagation(),b.preventDefault(),this.queryCommandEnabled(b.shiftKey?"outdent":"indent")&&this.execCommand(b.shiftKey?"outdent":"indent"));if(b.keyCode==a.TAB&&!this.isTabIndent&&!b.ctrlKey&&!b.altKey)return b.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>d("ie")&&b.keyCode===a.BACKSPACE&&"Control"===this.document.selection.type&&(b.stopPropagation(),b.preventDefault(),this.execCommand("delete"));d("ff")&&(b.keyCode===a.PAGE_UP||b.keyCode===a.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&b.preventDefault();var c=this._keyHandlers[b.keyCode],e=arguments;c&&!b.altKey&&p.some(c,function(a){if(!(a.shift^b.shiftKey||a.ctrl^(b.ctrlKey||b.metaKey)))return a.handler.apply(this,e)||b.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){c.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?h.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(u.hitch(this,function(){h.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,b,c,d){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));u.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:c||!1,ctrl:b||!1,handler:d})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(d("ie")||d("trident"))&&this.defer(function(){I.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var b=this.getValue(!0);if(b!==this.value)this.onChange(b);
this._set("value",b)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!d("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>d("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,b){var c=a.toLowerCase();"formatblock"===c?d("safari")&&void 0===b&&(c="heading"):"hilitecolor"!==c||d("mozilla")||(c="backcolor");return c},_qcaCache:{},queryCommandAvailable:function(a){var b=this._qcaCache[a];return void 0!==
b?b:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return d("ie")||d("trident")||d("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!d("webkit");default:return!1}},execCommand:function(a,b){var c;this.focused&&this.focus();a=this._normalizeCommand(a,b);if(void 0!==b){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(d("ie")||d("trident"))&&(b="\x3c"+b+"\x3e")}var e="_"+a+"Impl";if(this[e])c=this[e](b);else if((b=1<arguments.length?b:null)||"createlink"!==a)c=this.document.execCommand(a,!1,b);this.onDisplayChanged();return c},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var b="_"+a+"EnabledImpl";return this[b]?this[b](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(Q){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(d("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(d("mozilla")&&"hilitecolor"===a){var b;try{b=this.document.queryCommandValue("styleWithCSS")}catch(H){b=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,b)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,b){return this.selection[a].apply(this.selection,b)},placeCursorAtStart:function(){this.focus();var a=!1;if(d("mozilla"))for(var b=this.editNode.firstChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){var a=!0,c=b.tagName?b.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(c)?this.selection.selectElement(b):
this.selection.selectElementChildren(b);break}b=b.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(d("mozilla"))for(var b=this.editNode.lastChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){a=!0;this.selection.selectElement(b.lastChild||b);break}b=b.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var b=this.isClosed?this.domNode:this.editNode;b.innerHTML=a;this._preDomFilterContent(b)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(u.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!d("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var b=
a;p.forEach(this.contentPreFilters,function(a){a&&(b=a(b))});return b},_preDomFilterContent:function(a){a=a||this.editNode;p.forEach(this.contentDomPreFilters,function(b){b&&u.isFunction(b)&&b(a)},this)},_postFilterContent:function(a,b){var c;u.isString(a)?c=a:(a=a||this.editNode,this.contentDomPostFilters.length&&(b&&(a=u.clone(a)),p.forEach(this.contentDomPostFilters,function(b){a=b(a)})),c=G.getChildrenHtml(a));u.trim(c.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(c="");p.forEach(this.contentPostFilters,
function(a){c=a(c)});return c},_saveContent:function(){var a=l.byId(J._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){c.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return G.getNodeHtml(a)},getNodeChildrenHtml:function(a){c.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return G.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);d("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var b=this.textarea.style;b.position="";b.left=b.top="";d("ie")&&(b.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;n.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;r.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);L._globalSaveHandler&&delete L._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
if(d("ie")||d("trident")||d("edge"))return this.focused&&!this.disabled;var b=9>d("ie")?this.document.selection.createRange():this.document;try{return b.queryCommandEnabled(a)}catch(H){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=d("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=d("mozilla")||d("webkit")||d("ie")||d("trident")||d("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=!0;return a=d("mozilla")||d("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;d("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;d("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");
return a},_pasteEnabledImpl:function(){var a=!0;return d("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(a){return d("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(d("mozilla")||d("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,a)},_hilitecolorImpl:function(a){var b;this._handleTextColorOrProperties("hilitecolor",a)||(d("mozilla")?(this.document.execCommand("styleWithCSS",!1,!0),console.log("Executing color command."),b=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):b=this.document.execCommand("hilitecolor",!1,a));return b},_backcolorImpl:function(a){d("ie")&&(a=a?a:null);var b=this._handleTextColorOrProperties("backcolor",a);b||(b=this.document.execCommand("backcolor",
!1,a));return b},_forecolorImpl:function(a){d("ie")&&(a=a?a:null);var b=!1;(b=this._handleTextColorOrProperties("forecolor",a))||(b=this.document.execCommand("forecolor",!1,a));return b},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var b=!0;if(9>d("ie")){var c=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var e=c.item(0);c.length;)c.remove(c.item(0));e.outerHTML=a}else c.pasteHTML(a);c.select()}else if(8>d("trident")){var f=E.getSelection(this.window);
if(f&&f.rangeCount&&f.getRangeAt){c=f.getRangeAt(0);c.deleteContents();var g=n.create("div");g.innerHTML=a;for(var k,e=this.document.createDocumentFragment();a=g.firstChild;)k=e.appendChild(a);c.insertNode(e);k&&(c=c.cloneRange(),c.setStartAfter(k),c.collapse(!1),f.removeAllRanges(),f.addRange(c))}}else d("mozilla")&&!a.length?this.selection.remove():b=this.document.execCommand("inserthtml",!1,a);return b},_boldImpl:function(a){var b=!1;if(d("ie")||d("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("bold");
b||(b=this.document.execCommand("bold",!1,a));return b},_italicImpl:function(a){var b=!1;if(d("ie")||d("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("italic");b||(b=this.document.execCommand("italic",!1,a));return b},_underlineImpl:function(a){var b=!1;if(d("ie")||d("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("underline");b||(b=this.document.execCommand("underline",!1,a));return b},_strikethroughImpl:function(a){var b=!1;if(d("ie")||d("trident"))this._adaptIESelection(),
b=this._adaptIEFormatAreaAndExec("strikethrough");b||(b=this.document.execCommand("strikethrough",!1,a));return b},_superscriptImpl:function(a){var b=!1;if(d("ie")||d("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("superscript");b||(b=this.document.execCommand("superscript",!1,a));return b},_subscriptImpl:function(a){var b=!1;if(d("ie")||d("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("subscript");b||(b=this.document.execCommand("subscript",!1,a));return b},
_fontnameImpl:function(a){var b;if(d("ie")||d("trident"))b=this._handleTextColorOrProperties("fontname",a);b||(b=this.document.execCommand("fontname",!1,a));return b},_fontsizeImpl:function(a){var b;if(d("ie")||d("trident"))b=this._handleTextColorOrProperties("fontsize",a);b||(b=this.document.execCommand("fontsize",!1,a));return b},_insertorderedlistImpl:function(a){var b=!1;if(d("ie")||d("trident")||d("edge"))b=this._adaptIEList("insertorderedlist",a);b||(b=this.document.execCommand("insertorderedlist",
!1,a));return b},_insertunorderedlistImpl:function(a){var b=!1;if(d("ie")||d("trident")||d("edge"))b=this._adaptIEList("insertunorderedlist",a);b||(b=this.document.execCommand("insertunorderedlist",!1,a));return b},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var b=0;if(a&&a.childNodes){var c;for(c=0;c<a.childNodes.length;c++)var d=g.position(a.childNodes[c]),
b=b+d.h}return b},_isNodeEmpty:function(a,b){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],b):!0:3===a.nodeType?""===a.nodeValue.substring(b):!1},_removeStartingRangeFromRange:function(a,b){if(a.nextSibling)b.setStart(a.nextSibling,0);else{for(var c=a.parentNode;c&&null==c.nextSibling;)c=c.parentNode;c&&b.setStart(c.nextSibling,0)}return b},_adaptIESelection:function(){var a=E.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var b=a.getRangeAt(0),c=
b.startContainer,d=b.startOffset;3===c.nodeType&&d>=c.length&&c.nextSibling;)d-=c.length,c=c.nextSibling;for(var e=null;this._isNodeEmpty(c,d)&&c!==e;)e=c,b=this._removeStartingRangeFromRange(c,b),c=b.startContainer,d=0;a.removeAllRanges();a.addRange(b)}},_adaptIEFormatAreaAndExec:function(a){var b=E.getSelection(this.window),c=this.document,d,e,f,g,k,h,l;if(a&&b&&b.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);f=b.getRangeAt(0);g=f.startContainer;3===g.nodeType&&(e=f.endOffset,
g.length<e&&(e=this._adjustNodeAndOffset(d,e),g=e.node,e=e.offset));for(;g&&g!==this.editNode;){d=g.tagName?g.tagName.toLowerCase():"";if(-1<p.indexOf(a,d)){l=g;break}g=g.parentNode}if(l&&(d=f.startContainer,a=c.createElement(l.tagName),n.place(a,l,"after"),d&&3===d.nodeType)){e=f.endOffset;d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset);g=d.nodeValue;f=c.createTextNode(g.substring(0,e));var m=g.substring(e,g.length);m&&(k=c.createTextNode(m));n.place(f,d,"before");k&&(h=c.createElement("span"),
h.className="ieFormatBreakerSpan",n.place(h,d,"after"),n.place(k,h,"after"),k=h);n.destroy(d);e=f.parentNode;for(d=[];e!==l;){g=e.tagName;f={tagName:g};d.push(f);g=c.createElement(g);e.style&&g.style&&e.style.cssText&&(g.style.cssText=e.style.cssText,f.cssText=e.style.cssText);"FONT"===e.tagName&&(e.color&&(g.color=e.color,f.color=e.color),e.face&&(g.face=e.face,f.face=e.face),e.size&&(g.size=e.size,f.size=e.size));e.className&&(g.className=e.className,f.className=e.className);if(k)for(;k;)f=k.nextSibling,
g.appendChild(k),k=f;g.tagName==e.tagName?(h=c.createElement("span"),h.className="ieFormatBreakerSpan",n.place(h,e,"after"),n.place(g,h,"after")):n.place(g,e,"after");f=e;k=g;e=e.parentNode}if(k){if(1===k.nodeType||3===k.nodeType&&k.nodeValue)a.innerHTML="";for(;k;)f=k.nextSibling,a.appendChild(k),k=f}if(d.length){f=d.pop();k=c.createElement(f.tagName);f.cssText&&k.style&&(k.style.cssText=f.cssText);f.className&&(k.className=f.className);"FONT"===f.tagName&&(f.color&&(k.color=f.color),f.face&&(k.face=
f.face),f.size&&(k.size=f.size));for(n.place(k,a,"before");d.length;)f=d.pop(),l=c.createElement(f.tagName),f.cssText&&l.style&&(l.style.cssText=f.cssText),f.className&&(l.className=f.className),"FONT"===f.tagName&&(f.color&&(l.color=f.color),f.face&&(l.face=f.face),f.size&&(l.size=f.size)),k.appendChild(l),k=l;l=c.createTextNode(".");h.appendChild(l);k.appendChild(l)}else h=c.createElement("span"),h.className="ieFormatBreakerSpan",l=c.createTextNode("."),h.appendChild(l),n.place(h,a,"before");k=
E.create(this.window);k.setStart(l,0);k.setEnd(l,l.length);b.removeAllRanges();b.addRange(k);this.selection.collapse(!1);l.parentNode.innerHTML="";a.firstChild||n.destroy(a);return!0}return!1}f=b.getRangeAt(0);if((d=f.startContainer)&&3===d.nodeType)return e=f.startOffset,d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset),g=d.nodeValue,f=c.createTextNode(g.substring(0,e)),m=g.substring(e),""!==m&&(k=c.createTextNode(g.substring(e))),h=c.createElement("span"),l=c.createTextNode("."),
h.appendChild(l),f.length?n.place(f,d,"after"):f=d,n.place(h,f,"after"),k&&n.place(k,h,"after"),n.destroy(d),k=E.create(this.window),k.setStart(l,0),k.setEnd(l,l.length),b.removeAllRanges(),b.addRange(k),c.execCommand(a),n.place(h.firstChild,h,"before"),n.destroy(h),k.setStart(l,0),k.setEnd(l,l.length),b.removeAllRanges(),b.addRange(k),this.selection.collapse(!1),l.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var b=E.getSelection(this.window);if(b.isCollapsed&&b.rangeCount&&
!this.queryCommandValue(a)){var c=b.getRangeAt(0),d=c.startContainer;if(d&&3==d.nodeType&&!c.startOffset)return c="ul","insertorderedlist"===a&&(c="ol"),a=this.document.createElement(c),c=n.create("li",null,a),n.place(a,d,"before"),c.appendChild(d),n.create("br",null,a,"after"),a=E.create(this.window),a.setStart(d,0),a.setEnd(d,d.length),b.removeAllRanges(),b.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,b){var c=E.getSelection(this.window),f=this.document,
g,k,h,l,m;b=b||null;if(a&&c&&c.isCollapsed&&c.rangeCount&&(k=c.getRangeAt(0),(g=k.startContainer)&&3===g.nodeType)){m=k.startOffset;g.length<m&&(k=this._adjustNodeAndOffset(g,m),g=k.node,m=k.offset);h=g.nodeValue;k=f.createTextNode(h.substring(0,m));""!==h.substring(m)&&(l=f.createTextNode(h.substring(m)));h=f.createElement("span");m=f.createTextNode(".");h.appendChild(m);f=f.createElement("span");h.appendChild(f);k.length?n.place(k,g,"after"):k=g;n.place(h,k,"after");l&&n.place(l,h,"after");n.destroy(g);
g=E.create(this.window);g.setStart(m,0);g.setEnd(m,m.length);c.removeAllRanges();c.addRange(g);if(d("webkit")){c="color";if("hilitecolor"===a||"backcolor"===a)c="backgroundColor";e.set(h,c,b);this.selection.remove();n.destroy(f);h.innerHTML="\x26#160;";this.selection.selectElement(h);this.focus()}else this.execCommand(a,b),n.place(h.firstChild,h,"before"),n.destroy(h),g.setStart(m,0),g.setEnd(m,m.length),c.removeAllRanges(),c.addRange(g),this.selection.collapse(!1),m.parentNode.removeChild(m);return!0}return!1},
_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3===a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return q(".ieFormatBreakerSpan",a).forEach(function(a){for(;a.firstChild;)n.place(a.firstChild,a,"before");
n.destroy(a)}),a},_stripTrailingEmptyNodes:function(a){function b(a){return/^(p|div|br)$/i.test(a.nodeName)&&0==a.children.length&&/^[\s\xA0]*$/.test(a.textContent||a.innerText||"")||3===a.nodeType&&/^[\s\xA0]*$/.test(a.nodeValue)}for(;a.lastChild&&b(a.lastChild);)n.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(u.hitch(this,function(){this.editNode.dir=a}))}});return L})},"dijit/selection":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/sniff dojo/_base/window dijit/focus".split(" "),
function(p,f,b,m,l,h){var r=function(g){var e=g.document;this.getType=function(){if(e.getSelection){var b="text",a;try{a=g.getSelection()}catch(u){}a&&1==a.rangeCount&&(a=a.getRangeAt(0),a.startContainer==a.endContainer&&1==a.endOffset-a.startOffset&&3!=a.startContainer.nodeType&&(b="control"));return b}return e.selection.type.toLowerCase()};this.getSelectedText=function(){if(e.getSelection){var b=g.getSelection();return b?b.toString():""}return"control"==this.getType()?null:e.selection.createRange().text};
this.getSelectedHtml=function(){if(e.getSelection){var b=g.getSelection();if(b&&b.rangeCount){var a,f="";for(a=0;a<b.rangeCount;a++){var h=b.getRangeAt(a).cloneContents(),l=e.createElement("div");l.appendChild(h);f+=l.innerHTML}return f}return null}return"control"==this.getType()?null:e.selection.createRange().htmlText};this.getSelectedElement=function(){if("control"==this.getType()){if(e.getSelection){var b=g.getSelection();return b.anchorNode.childNodes[b.anchorOffset]}if((b=e.selection.createRange())&&
b.item)return e.selection.createRange().item(0)}return null};this.getParentElement=function(){if("control"==this.getType()){var b=this.getSelectedElement();if(b)return b.parentNode}else if(e.getSelection){if(b=e.getSelection()){for(b=b.anchorNode;b&&1!=b.nodeType;)b=b.parentNode;return b}}else return b=e.selection.createRange(),b.collapse(!0),b.parentElement();return null};this.hasAncestorElement=function(b){return null!=this.getAncestorElement.apply(this,arguments)};this.getAncestorElement=function(b){var a=
this.getSelectedElement()||this.getParentElement();return this.getParentOfType(a,arguments)};this.isTag=function(b,a){if(b&&b.tagName)for(var c=b.tagName.toLowerCase(),e=0;e<a.length;e++){var f=String(a[e]).toLowerCase();if(c==f)return f}return""};this.getParentOfType=function(b,a){for(;b;){if(this.isTag(b,a).length)return b;b=b.parentNode}return null};this.collapse=function(b){if(e.getSelection){var a=g.getSelection();a.removeAllRanges?b?a.collapseToStart():a.collapseToEnd():a.collapse(b)}else a=
e.selection.createRange(),a.collapse(b),a.select()};this.remove=function(){var b=e.selection;e.getSelection?(b=g.getSelection(),b.deleteFromDocument()):"none"!=b.type.toLowerCase()&&b.clear();return b};this.selectElementChildren=function(b,a){var c;b=f.byId(b);if(e.getSelection){var h=g.getSelection();m("opera")?(c=h.rangeCount?h.getRangeAt(0):e.createRange(),c.setStart(b,0),c.setEnd(b,3==b.nodeType?b.length:b.childNodes.length),h.addRange(c)):h.selectAllChildren(b)}else if(c=b.ownerDocument.body.createTextRange(),
c.moveToElementText(b),!a)try{c.select()}catch(q){}};this.selectElement=function(b,a){var c;b=f.byId(b);if(e.getSelection){var g=e.getSelection();c=e.createRange();g.removeAllRanges&&(m("opera")&&g.getRangeAt(0)&&(c=g.getRangeAt(0)),c.selectNode(b),g.removeAllRanges(),g.addRange(c))}else try{g=b.tagName?b.tagName.toLowerCase():"",c="img"===g||"table"===g?l.body(e).createControlRange():l.body(e).createRange(),c.addElement(b),a||c.select()}catch(q){this.selectElementChildren(b,a)}};this.inSelection=
function(b){if(b){var a,c;if(e.getSelection){var f=g.getSelection();f&&0<f.rangeCount&&(c=f.getRangeAt(0));if(c&&c.compareBoundaryPoints&&e.createRange)try{if(a=e.createRange(),a.setStart(b,0),1===c.compareBoundaryPoints(c.START_TO_END,a))return!0}catch(q){}}else{c=e.selection.createRange();try{a=b.ownerDocument.body.createTextRange(),a.moveToElementText(b)}catch(q){}if(c&&a&&1===c.compareEndPoints("EndToStart",a))return!0}}return!1};this.getBookmark=function(){var b,a,f=e.selection,l=h.curNode;if(e.getSelection){if(f=
g.getSelection())if(f.isCollapsed){if(b=l?l.tagName:"")if(b=b.toLowerCase(),"textarea"==b||"input"==b&&(!l.type||"text"==l.type.toLowerCase()))return f={start:l.selectionStart,end:l.selectionEnd,node:l,pRange:!0},{isCollapsed:f.end<=f.start,mark:f};b={isCollapsed:!0};f.rangeCount&&(b.mark=f.getRangeAt(0).cloneRange())}else a=f.getRangeAt(0),b={isCollapsed:!1,mark:a.cloneRange()}}else if(f){b=l?l.tagName:"";b=b.toLowerCase();if(l&&b&&("button"==b||"textarea"==b||"input"==b)){if(f.type&&"none"==f.type.toLowerCase())return{isCollapsed:!0,
mark:null};a=f.createRange();return{isCollapsed:a.text&&a.text.length?!1:!0,mark:{range:a,pRange:!0}}}b={};try{a=f.createRange(),b.isCollapsed=!("Text"==f.type?a.htmlText.length:a.length)}catch(q){return b.isCollapsed=!0,b}if("CONTROL"==f.type.toUpperCase())if(a.length)for(b.mark=[],f=0,l=a.length;f<l;)b.mark.push(a.item(f++));else b.isCollapsed=!0,b.mark=null;else b.mark=a.getBookmark()}else console.warn("No idea how to store the current selection for this browser!");return b};this.moveToBookmark=
function(c){if(c=c.mark)if(e.getSelection){var a=g.getSelection();a&&a.removeAllRanges?c.pRange?(a=c.node,a.selectionStart=c.start,a.selectionEnd=c.end):(a.removeAllRanges(),a.addRange(c)):console.warn("No idea how to restore selection for this browser!")}else if(e.selection&&c){var f;c.pRange?f=c.range:b.isArray(c)?(f=e.body.createControlRange(),p.forEach(c,function(a){f.addElement(a)})):(f=e.body.createTextRange(),f.moveToBookmark(c));f.select()}};this.isCollapsed=function(){return this.getBookmark().isCollapsed}},
n=new r(window);n.SelectionManager=r;return n})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(p,f,b){var m={getIndex:function(b,f){for(var g=[],e=[],c=b,a,h;b!=f;){var l=0;for(a=b.parentNode;h=a.childNodes[l++];)if(h===b){--l;break}g.unshift(l);e.unshift(l-a.childNodes.length);b=a}if(0<g.length&&3==c.nodeType){for(h=c.previousSibling;h&&3==h.nodeType;)g[g.length-1]--,h=h.previousSibling;for(h=c.nextSibling;h&&3==h.nodeType;)e[e.length-
1]++,h=h.nextSibling}return{o:g,r:e}},getNode:function(f,h){if(!b.isArray(f)||0==f.length)return h;var g=h;p.every(f,function(b){if(0<=b&&b<g.childNodes.length)g=g.childNodes[b];else return g=null,!1;return!0});return g},getCommonAncestor:function(b,f,g){g=g||b.ownerDocument.body;var e=function(a){for(var b=[];a;)if(b.unshift(a),a!==g)a=a.parentNode;else break;return b};b=e(b);f=e(f);for(var e=Math.min(b.length,f.length),c=b[0],a=1;a<e;a++)if(b[a]===f[a])c=b[a];else break;return c},getAncestor:function(b,
f,g){for(g=g||b.ownerDocument.body;b&&b!==g;){var e=b.nodeName.toUpperCase();if(f.test(e))return b;b=b.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(b,f,g){g=g||b.ownerDocument.body;f=f||m.BlockTagNames;for(var e=null,c;b&&b!==g;){var a=b.nodeName.toUpperCase();!e&&f.test(a)&&(e=b);!c&&/^(?:BODY|TD|TH|CAPTION)$/.test(a)&&(c=b);b=b.parentNode}return{blockNode:e,blockContainer:c||b.ownerDocument.body}},atBeginningOfContainer:function(b,
f,g){var e=!1,c=0==g;c||3!=f.nodeType||/^[\s\xA0]+$/.test(f.nodeValue.substr(0,g))&&(c=!0);if(c)for(e=!0;f&&f!==b;){if(f.previousSibling){e=!1;break}f=f.parentNode}return e},atEndOfContainer:function(b,f,g){var e=!1,c=g==(f.length||f.childNodes.length);c||3!=f.nodeType||/^[\s\xA0]+$/.test(f.nodeValue.substr(g))&&(c=!0);if(c)for(e=!0;f&&f!==b;){if(f.nextSibling){e=!1;break}f=f.parentNode}return e},adjacentNoneTextNode:function(b,f){for(var g=b,e=0-b.length||0,c=f?"nextSibling":"previousSibling";g&&
3==g.nodeType;)e+=g.length,g=g[c];return[g,e]},create:function(b){b=b||window;return b.getSelection?b.document.createRange():new h},getSelection:function(b,f){if(b.getSelection)return b.getSelection();var g=new l.selection(b);f||g._getCurrentSelection();return g}};if(!window.getSelection)var l=m.ie={cachedSelection:{},selection:function(b){this._ranges=[];this.addRange=function(b,f){this._ranges.push(b);f||b._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=
[];this.rangeCount=0};this.getRangeAt=function(b){return this._ranges[b]};this._getCurrentSelection=function(){this.removeAllRanges();var f;f=b.document.selection.createRange();f="CONTROL"==b.document.selection.type.toUpperCase()?new h(l.decomposeControlRange(f)):new h(l.decomposeTextRange(f));this.addRange(f,!0),this.isCollapsed=f.collapsed}},decomposeControlRange:function(b){var f=b.item(0),g=b.item(b.length-1);b=f.parentNode;var e=g.parentNode,f=m.getIndex(f,b).o[0],g=m.getIndex(g,e).o[0]+1;return[b,
f,e,g]},getEndPoint:function(b,f){var g=b.duplicate();g.collapse(!f);var e="EndTo"+(f?"End":"Start"),c=g.parentElement(),a,h,l;0<c.childNodes.length?p.every(c.childNodes,function(f,d){var k;if(3!=f.nodeType)if(g.moveToElementText(f),0<g.compareEndPoints(e,b))if(l&&3==l.nodeType)a=l,k=!0;else return a=c,h=d,!1;else{if(d==c.childNodes.length-1)return a=c,h=c.childNodes.length,!1}else d==c.childNodes.length-1&&(a=f,k=!0);if(k&&a){a=(k=m.adjacentNoneTextNode(a)[0])?k.nextSibling:c.firstChild;var q=m.adjacentNoneTextNode(a);
k=q[0];q=q[1];k?(g.moveToElementText(k),g.collapse(!1)):g.moveToElementText(c);g.setEndPoint(e,b);h=g.text.length-q;return!1}l=f;return!0}):(a=c,h=0);if(!f&&1==a.nodeType&&h==a.childNodes.length){var q=a.nextSibling;q&&3==q.nodeType&&(a=q,h=0)}return[a,h]},setEndPoint:function(b,f,g){b=b.duplicate();var e;if(3!=f.nodeType)if(0<g){if(e=f.childNodes[g-1])if(3==e.nodeType)f=e,g=e.length;else if(e.nextSibling&&3==e.nextSibling.nodeType)f=e.nextSibling,g=0;else{b.moveToElementText(e.nextSibling?e:f);var c=
e.parentNode;e=c.insertBefore(e.ownerDocument.createTextNode(" "),e.nextSibling);b.collapse(!1);c.removeChild(e)}}else b.moveToElementText(f),b.collapse(!0);3==f.nodeType&&(e=m.adjacentNoneTextNode(f),c=e[0],e=e[1],c?(b.moveToElementText(c),b.collapse(!1),"inherit"!=c.contentEditable&&e++):(b.moveToElementText(f.parentNode),b.collapse(!0),b.move("character",1),b.move("character",-1)),g+=e,0<g&&b.move("character",g)!=g&&console.error("Error when moving!"));return b},decomposeTextRange:function(b){var f=
l.getEndPoint(b),g=f[0],e=f[1],c=f[0],f=f[1];b.htmlText.length&&(b.htmlText==b.text?f=e+b.text.length:(f=l.getEndPoint(b,!0),c=f[0],f=f[1]));return[g,e,c,f]},setRange:function(b,f,g,e,c,a){f=l.setEndPoint(b,f,g);b.setEndPoint("StartToStart",f);if(!a)var h=l.setEndPoint(b,e,c);b.setEndPoint("EndToEnd",h||f);return b}},h=m.W3CRange=f(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=
null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?m.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(b,f){f=parseInt(f);if(this.startContainer!==b||this.startOffset!=f)delete this._cachedBookmark,this.startContainer=b,this.startOffset=
f,this.endContainer?this._updateInternal():this.setEnd(b,f)},setEnd:function(b,f){f=parseInt(f);if(this.endContainer!==b||this.endOffset!=f)delete this._cachedBookmark,this.endContainer=b,this.endOffset=f,this.startContainer?this._updateInternal():this.setStart(b,f)},setStartAfter:function(b,f){this._setPoint("setStart",b,f,1)},setStartBefore:function(b,f){this._setPoint("setStart",b,f,0)},setEndAfter:function(b,f){this._setPoint("setEnd",b,f,1)},setEndBefore:function(b,f){this._setPoint("setEnd",
b,f,0)},_setPoint:function(b,f,g,e){g=m.getIndex(f,f.parentNode).o;this[b](f.parentNode,g.pop()+e)},_getIERange:function(){var b=(this._body||this.endContainer.ownerDocument.body).createTextRange();l.setRange(b,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return b},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var b=this.startContainer,f=this._getIERange();3!==
b.nodeType||this.startOffset||this.setStartBefore(b);f.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var b=new h([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);b._body=this._body;return b},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});b.setObject("dijit.range",m);return m})},"dijit/_editor/html":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/sniff"],function(p,f,b){var m={};f.setObject("dijit._editor.html",m);var l=m.escapeXml=function(b,f){b=b.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");f||(b=b.replace(/'/gm,"\x26#39;"));return b};m.getNodeHtml=function(b){var f=[];m.getNodeHtmlHelper(b,f);return f.join("")};m.getNodeHtmlHelper=function(f,r){switch(f.nodeType){case 1:var h=f.nodeName.toLowerCase();if(!h||"/"==h.charAt(0))return"";r.push("\x3c",h);var g=
[],e={},c;if(b("dom-attributes-explicit")||b("dom-attributes-specified-flag"))for(var a=0;c=f.attributes[a++];){var u=c.name;"_dj"===u.substr(0,3)||b("dom-attributes-specified-flag")&&!c.specified||u in e||(c=c.value,("src"==u||"href"==u)&&f.getAttribute("_djrealurl")&&(c=f.getAttribute("_djrealurl")),8===b("ie")&&"style"===u&&(c=c.replace("HEIGHT:","height:").replace("WIDTH:","width:")),g.push([u,c]),e[u]=c)}else{var v=(/^input$|^img$/i.test(f.nodeName)?f:f.cloneNode(!1)).outerHTML,e=v.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),
v=v.substr(0,v.indexOf("\x3e"));p.forEach(e,function(a){if(a){var b=a.indexOf("\x3d");if(0<b&&(a=a.substring(0,b),"_dj"!=a.substr(0,3)))if("src"!=a&&"href"!=a||!f.getAttribute("_djrealurl")){var c;switch(a){case "style":c=f.style.cssText.toLowerCase();break;case "class":c=f.className;break;case "width":if("img"===h){(b=/width=(\S+)/i.exec(v))&&(c=b[1]);break}case "height":if("img"===h){(b=/height=(\S+)/i.exec(v))&&(c=b[1]);break}default:c=f.getAttribute(a)}null!=c&&g.push([a,c.toString()])}else g.push([a,
f.getAttribute("_djrealurl")])}},this)}g.sort(function(a,b){return a[0]<b[0]?-1:a[0]==b[0]?0:1});for(e=0;c=g[e++];)r.push(" ",c[0],'\x3d"',"string"===typeof c[1]?l(c[1],!0):c[1],'"');switch(h){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":r.push(" /\x3e");break;case "script":r.push("\x3e",f.innerHTML,"\x3c/",h,"\x3e");break;default:r.push("\x3e"),f.hasChildNodes()&&m.getChildrenHtmlHelper(f,r),r.push("\x3c/",h,"\x3e")}break;case 4:case 3:r.push(l(f.nodeValue,
!0));break;case 8:r.push("\x3c!--",l(f.nodeValue,!0),"--\x3e");break;default:r.push("\x3c!-- Element not recognized - Type: ",f.nodeType," Name: ",f.nodeName,"--\x3e")}};m.getChildrenHtml=function(b){var f=[];m.getChildrenHtmlHelper(b,f);return f.join("")};m.getChildrenHtmlHelper=function(f,l){if(f)for(var h=f.childNodes||f,g=!b("ie")||h!==f,e,c=0;e=h[c++];)g&&e.parentNode!=f||m.getNodeHtmlHelper(e,l)};return m})},"esri/dijit/ColorPicker":function(){define("../Color ../kernel ./_EventedWidget ./_Tooltip ./ColorPicker/colorUtil ./ColorPicker/HexPalette dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/query dojo/sniff dojo/dom-style dojo/i18n!../nls/jsapi dojo/text!./ColorPicker/templates/ColorPicker.html ./HorizontalSlider dijit/form/RadioButton dijit/form/TextBox dijit/form/ToggleButton dojo/NodeList-dom".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t){f=e("esri.dijit.ColorPicker",[b,r,n,m],{_DEFAULT_COLORS_PER_ROW:13,templateString:t,labels:w.widgets.colorPicker,baseClass:"esriColorPicker",css:{container:"esriContainer",header:"esriHeader",footer:"esriFooter",middle:"esriMiddle",swatch:"esriSwatch",swatchRow:"esriSwatchRow",swatchEmpty:"esriSwatchEmpty",swatchPreview:"esriSwatchPreview",swatchTransparencyBackground:"esriSwatchTransparencyBackground",palette:"esriPalette",paletteOptions:"esriPaletteOptions",
paletteToggle:"esriPaletteToggle",label:"esriLabel",hexInput:"esriHexInput",recent:"esriRecent",suggested:"esriSuggested",selected:"esriSelected",disabled:"esriDisabled",section:"esriSection",displayNone:"esriDisplayNone",transparencySlider:"esriTransparencySlider",alt:"esriAlt"},color:null,trackColors:!0,_required:!1,_activePalette:null,recentColors:[],_showRecentColors:!0,_showTransparencySlider:!0,colorsPerRow:void 0,_brightsPalette:null,_pastelsPalette:null,_swatches:null,_colorInstance:null,
_swatchCreator:null,_noColorSwatchNode:null,constructor:function(a,b){a=a||{};this._colorInstance=new p;this._brightsPalette=new h({colors:a.palette});this._pastelsPalette=new h({colors:this._toPastels(this._brightsPalette.get("colors"))});this._activePalette=this._brightsPalette;this._swatchCreator=a.swatchCreator||this._createSwatch;a.hasOwnProperty("required")&&(this._required=a.required);a.hasOwnProperty("showRecentColors")&&(this._showRecentColors=a.showRecentColors);a.hasOwnProperty("showSuggestedColors")&&
(this._showSuggestedColors=a.showSuggestedColors);a.hasOwnProperty("showTransparencySlider")&&(this._showTransparencySlider=a.showTransparencySlider);a.color&&(a.color=l.normalizeColor(a.color));this.colorsPerRow=0<a.colorsPerRow?a.colorsPerRow:this._DEFAULT_COLORS_PER_ROW;this._swatches={}},_toPastels:function(a){var b=this._colorInstance,c=new p([238,238,238]);return g.map(a,function(a){return p.blendColors(b.setColor(a),c,.2)},this)},_createSwatch:function(a){return u.create("span",{className:a.className,
style:{background:a.hexColor||"transparent"}},a.paletteNode)},_createSwatches:function(a,b){var c=this.css.swatch,d=this.css.swatchRow,e=this.colorsPerRow,f=b.get("colors"),k,h;g.forEach(f,function(b,f){0===f%e&&(k=u.create("div",{className:d},a));h=this._swatchCreator({className:c,hexColor:b,paletteNode:k});this._swatches[b]=h},this)},_selectColor:function(){var a=this.color||this._activePalette.get("colors")[0];this.set("color",a)},_setColorWithCurrentAlpha:function(a){"no-color"!==a&&"no-color"!==
this.color&&(a=l.normalizeColor(a),a.a=this.color.a);this.set("color",a)},_updatePreviewSwatch:function(b){var c=this.css.swatchEmpty,e=this.dap_previewSwatch,f,g;"no-color"===b?(a.add(e,c),d.set(e,{backgroundColor:"",borderColor:""})):(f=l.getContrastingColor(b),g=8!==k("ie"),a.remove(e,c),c=b.toCss(g),f=f.toCss(g),f={backgroundColor:c,borderColor:f},g||(f.opacity=b.a),d.set(e,f))},_showBrights:function(){a.remove(this.dap_paletteContainer,this.css.alt);this._activePalette=this._brightsPalette},
_showPastels:function(){a.add(this.dap_paletteContainer,this.css.alt);this._activePalette=this._pastelsPalette},_setColorFromSwatch:function(a){a=d.get(a,"backgroundColor");this._setColorWithCurrentAlpha(a)},_checkSelection:function(){var a=this.get("color");this._activePalette.contains(a)?this._highlightColor(a):this._clearSelection()},_addListeners:function(){var a="."+this.css.swatch;this.own(v(this.dap_paletteContainer,v.selector(a,"click"),c.hitch(this,function(a){this._setColorFromSwatch(a.target)})));
this.own(v(this.dap_recentColorPalette,v.selector(a,"click"),c.hitch(this,function(a){this._setColorFromSwatch(a.target)})));this.own(v(this.dap_suggestedColorPalette,v.selector(a,"click"),c.hitch(this,function(a){this._setColorFromSwatch(a.target)})));this._required||this.own(v(this._noColorSwatchNode,"click",c.hitch(this,function(a){this.set("color","no-color")})));var b=this.dap_hexInput;b.on("blur",c.hitch(this,function(){var a=l.normalizeHex(b.get("value"));l.isShorthandHex(a)?this._setColorWithCurrentAlpha(a):
this._silentlyUpdateHexInput(this.color)}));b.on("change",c.hitch(this,function(){var a=l.normalizeHex(b.get("value"));l.isLonghandHex(a)&&("no-color"!==this.color&&this.color.toHex()===a||this._setColorWithCurrentAlpha(a))}));this.dap_transparencySlider.on("change",c.hitch(this,function(a){var b=this.get("color");"no-color"!==b&&(b=l.normalizeColor(this._colorInstance.setColor(b)),b.a=1-a,this._updatePreviewSwatch(b),this._silentlyUpdateHexInput(b),this.set("color",b))}));this.dap_paletteToggle.on("change",
c.hitch(this,this._togglePalette))},_togglePalette:function(a){this.dap_paletteToggle.set("checked",a,!1);a?this._showPastels():this._showBrights();this._checkSelection()},postCreate:function(){this.inherited(arguments);this._addListeners();this._selectColor();this.dap_hexInput.intermediateChanges=!0;this.dap_transparencySlider.intermediateChanges=!0;this.createTooltips([{node:this.dap_paletteContainer,label:this.labels.paletteTooltip},{node:this.dap_hexInput,label:this.labels.hexInputTooltip},{node:this._noColorSwatchNode,
label:this.labels.noColorTooltip},{node:this.dap_paletteToggle,label:this.labels.moreColorsTooltip}])},buildRendering:function(){this.inherited(arguments);this._createPalettes();var b=this.css.swatch,c=this.css.swatchEmpty;this._required||(this._noColorSwatchNode=u.create("div",{className:b+" "+c},this.dap_hexInput.domNode,"after"));b=this.css.displayNone;this._showTransparencySlider||a.add(this.dap_transparencySection,b);this._showRecentColors||a.add(this.dap_recentColorSection,b);this._showSuggestedColors||
a.add(this.dap_suggestedColorSection,b)},_createPalettes:function(){this._swatches={};u.empty(this.dap_primaryPalette);u.empty(this.dap_secondaryPalette);this._createSwatches(this.dap_primaryPalette,this._brightsPalette);this._createSwatches(this.dap_secondaryPalette,this._pastelsPalette)},_silentlyUpdateHexInput:function(a){a="no-color"===a?"":a.toHex();this._silentlyUpdateIntermediateChangingValueWidget(this.dap_hexInput,a)},_silentlyUpdateIntermediateChangingValueWidget:function(a,b){a.intermediateChanges=
!1;a.set("value",b,!1);a.intermediateChanges=!0},addRecentColor:function(a){a&&"no-color"!==a&&this._addRecentColor(l.normalizeColor(a).toHex())},_addRecentColor:function(a){if(a){var b=this.recentColors,c=g.indexOf(b,a);-1<c&&b.splice(c,1);b.unshift(a);b.length>this.colorsPerRow&&b.pop();this._renderRecentSwatches()}},_renderRecentSwatches:function(){if(this.recentColors){var a=this.css.recent,b=this.css.swatch,c=q("."+a+"."+b,this.dap_recentColorPalette);g.forEach(this.recentColors,function(e,f){if(f<
this.colorsPerRow){if(f+1>c.length){var g=this._swatchCreator({hexColor:e,className:b+" "+a,paletteNode:this.dap_recentColorPalette});c.push(g)}d.set(c[f],"backgroundColor",e)}},this)}},_renderSuggestedSwatches:function(){if(this.suggestedColors){var a=this.css.suggested,b=this.css.swatch,c=q("."+a+"."+b,this.dap_recentColorPalette);g.forEach(this.suggestedColors,function(e,f){if(f<this.colorsPerRow){if(f+1>c.length){var g=this._swatchCreator({hexColor:e,className:b+" "+a,paletteNode:this.dap_suggestedColorPalette});
c.push(g)}d.set(c[f],"backgroundColor",e)}},this)}},_clearRecentSwatches:function(){u.empty(this.dap_recentColorPalette)},_clearSuggestedSwatches:function(){u.empty(this.dap_suggestedColorPalette)},_clearSelection:function(){var a=this.css.selected;q("."+a,this.dap_paletteContainer).removeClass(a)},_highlightColor:function(b){var c=this.css.selected,e=this._findColorSwatch(b);e&&(b=l.normalizeColor(b),b=l.getContrastingColor(b),a.add(e,c),d.set(e,"borderColor",b.toHex()))},_findColorSwatch:function(a){var b=
this._activePalette.get("colors");a=this._colorInstance.setColor(a).toHex();var c;-1<g.indexOf(b,a)&&(c=this._swatches[a]);return c},_getColorAttr:function(){return"no-color"===this.color?"no-color":new p(this.color)},_previousColor:null,_enableTransparencySlider:function(){a.remove(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",!1)},_disableTransparencySlider:function(){a.add(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",
!0)},_setColorAttr:function(b,c){b=b||"no-color";c=c||void 0===c;if(!this._required){if("no-color"===b){this._set("color","no-color");this._previousColor="no-color";this._disableTransparencySlider();this._clearSelection();this._silentlyUpdateHexInput("no-color");this._updatePreviewSwatch(b);a.add(this._noColorSwatchNode,this.css.selected);c&&this.emit("color-change",{color:"no-color"});return}this._enableTransparencySlider();a.remove(this._noColorSwatchNode,this.css.selected)}var e=l.normalizeColor(b),
f=this._previousColor,g=this._colorInstance,k=this.css.selected;if(f){if(l.equal(f,e))return;if(f=this._findColorSwatch(f))a.remove(f,k),d.set(f,"borderColor","")}g.setColor(e);k=g.toHex();this._set("color",new p(g));this._previousColor=e;this._silentlyUpdateIntermediateChangingValueWidget(this.dap_transparencySlider,1-g.a);this._updatePreviewSwatch(g);this._checkSelection();this._silentlyUpdateHexInput(g);this.trackColors&&this._addRecentColor(k);c&&this.emit("color-change",{color:new p(g)})},_getRecentColorsAttr:function(){return g.map(this.recentColors,
function(a){return l.normalizeColor(a)})},_setRecentColorsAttr:function(a){this.recentColors=a||[];this._showRecentColors&&(this.recentColors=g.map(this.recentColors,function(a){return l.normalizeColor(a).toHex()}));0===this.recentColors.length?this._clearRecentSwatches():this._renderRecentSwatches()},suggestedColors:null,_getSuggestedColorsAttr:function(){return g.map(this.suggestedColors,function(a){return l.normalizeColor(a)})},_setSuggestedColorsAttr:function(a){this._showSuggestedColors&&(this._clearSuggestedSwatches(),
this.suggestedColors=a||[],this.suggestedColors=g.map(this.suggestedColors,function(a){return l.normalizeColor(a).toHex()}),0<this.suggestedColors.length&&this._renderSuggestedSwatches())},_setPaletteAttr:function(a){var b=this._activePalette===this._brightsPalette;this._brightsPalette.set("colors",a);this._pastelsPalette.set("colors",this._toPastels(this._brightsPalette.get("colors")));this._activePalette=b?this._brightsPalette:this._pastelsPalette;this._createPalettes();this._togglePalette(!b)},
saveRecentColors:function(a){localStorage.setItem(a,JSON.stringify(this.get("recentColors")))},loadRecentColors:function(a){this.set("recentColors",JSON.parse(localStorage.getItem(a)))}});f.NO_COLOR="no-color";return f})},"esri/dijit/_Tooltip":function(){define(["dijit/Tooltip","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom"],function(p,f,b,m,l){return b(null,{declaredClass:"esri.dijit._Tooltip",_tooltips:null,constructor:function(){this._tooltips=[]},startup:function(){this.inherited(arguments);
this._started||f.forEach(this._tooltips,function(b){b.startup()})},destroy:function(){this.inherited(arguments);f.forEach(this._tooltips,function(b){b.destroy()});this._tooltips=null},createTooltips:function(b){f.forEach(b,function(b){this.createTooltip(b.node,b.label)},this)},createTooltip:function(b,f){var h=this._getConnectId(b);h&&(h="object"===typeof f?m.mixin({},f,{connectId:h}):{connectId:h,label:f},h=new p(h),this._started&&h.startup(),this._tooltips.push(h))},_getConnectId:function(b){var h,
l;if(b){if(m.isArray(b)){if(h=[],f.forEach(b,function(b){(l=this._getNode(b))&&h.push(l)}),0===h.length)return}else if(h=this._getNode(b),!h)return;return h}},_getNode:function(b){return l.byId(b.domNode||b)},findTooltip:function(b){var h=this._getNode(b),l,g,e;if(b){b=this._tooltips;l=b.length;for(var c=0;c<l;c++)if(g=b[c],e=m.isArray(g.connectId)?-1<f.indexOf(g.connectId,h):g.connectId===h)return g}}})})},"esri/dijit/ColorPicker/colorUtil":function(){define(["dojo/_base/lang","../../Color"],function(p,
f){var b={equal:function(b,f){return b&&f&&b.r===f.r&&b.g===f.g&&b.b===f.b&&b.a===f.a},normalizeHex:function(b){return"#"+p.trim(b).replace(/#/g,"").substr(0,6)},normalizeColor:function(b){return new f(b)},isValidHex:function(f){return b.isShorthandHex(f)||b.isLonghandHex(f)},_shortHandHex:/^#[0-9A-F]{3}$/i,isShorthandHex:function(f){return f&&4===f.length&&b._shortHandHex.test(f)},_longhandHex:/^#[0-9A-F]{6}$/i,isLonghandHex:function(f){return f&&7===f.length&&b._longhandHex.test(f)},getContrastingColor:function(f){return b.isBright(f)?
this.darker(f):this.brighter(f,3)},isBright:function(b){return 127<=.299*b.r+.587*b.g+.114*b.b},darker:function(b,l){var h=Math.pow(.7,l?l:1);return new f([Math.round(b.r*h),Math.round(b.g*h),Math.round(b.b*h),b.a])},brighter:function(b,l){var h=Math.pow(.7,l?l:1),m=b.r,n=b.g,g=b.b;30>m&&(m=30);30>n&&(n=30);30>g&&(g=30);return new f([Math.min(255,Math.round(m/h)),Math.min(255,Math.round(n/h)),Math.min(255,Math.round(g/h)),b.a])}};return b})},"esri/dijit/ColorPicker/HexPalette":function(){define(["dojo/_base/array",
"dojo/_base/Color","dojo/_base/declare","dojo/Stateful"],function(p,f,b,m){var l="#ffffff #858585 #ffbebe #ffebbe #ffebaf #ffffbe #e9ffbe #d3ffbe #beffe8 #bee8ff #bed2ff #e8beff #ffbee8 #ebebeb #707070 #ff7f7f #ffa77f #ffd37f #ffff73 #d1ff73 #a3ff73 #73ffdf #73dfff #73b2ff #df73ff #ff73df #d6d6d6 #5c5c5c #ff0000 #ff5500 #ffaa00 #ffff00 #aaff00 #55ff00 #00ffc5 #00c5ff #0070ff #c500ff #ff00c5 #c2c2c2 #474747 #e60000 #e64c00 #e69800 #e6e600 #98e600 #4ce600 #00e6a9 #00a9e6 #005ce6 #a900e6 #e600a9 #adadad #242424 #a80000 #a83800 #a87000 #a8a800 #70a800 #38a800 #00a884 #0084a8 #004da8 #8400a8 #a80084 #999999 #1a1a1a #730000 #732600 #734c00 #737300 #4c7300 #267300 #00734c #004c73 #002673 #4c0073 #73004c".split(" ");
f=b([m],{constructor:function(b){b=b||{};this.set("colors",b.colors)},_colorInstance:new f,_colors:null,_colorsGetter:function(){return this._colors},_colorsSetter:function(b){b=b?b:l;this._colors=this._normalizeColors(b)},_normalizeColors:function(b){var f=this._colorInstance;return p.map(b,function(b){return f.setColor(b).toHex()},this)},contains:function(b){var f=this._colorInstance;f.setColor(b);return-1<p.indexOf(this._colors,f.toHex())}});f.DEFAULT_COLORS=l;return f})},"esri/dijit/HorizontalSlider":function(){define("dijit/form/HorizontalRuleLabels dijit/form/HorizontalSlider dojo/_base/declare dojo/_base/lang dojo/has ../kernel".split(" "),
function(p,f,b,m,l,h){return b("esri.dijit.HorizontalSlider",f,{baseClass:"esriHorizontalSlider",showButtons:!1,labels:null,constructor:function(b){b=b||{};b.labels&&(this.labels=b.labels)},buildRendering:function(){this.inherited(arguments);this.labels&&(new p({labels:this.labels})).placeAt(this.bottomDecoration)}})})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),function(p,f,b,m,l,h){p=p("dijit.form.HorizontalRuleLabels",
h,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",_calcPosition:function(b){return b},_genHTML:function(b,f){var g=
this.labels[f];return this._positionPrefix+this._calcPosition(b)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(g)+this._labelPrefix+g+this._suffix},_genDirectionHTML:function(b){return""},getLabels:function(){var f=this.labels;!f.length&&this.srcNodeRef&&(f=m("\x3e li",this.srcNodeRef).map(function(b){return String(b.innerHTML)}));if(!f.length&&1<this.count)for(var f=[],h=this.minimum,g=(this.maximum-h)/(this.count-1),e=0;e<this.count;e++)f.push(e<this.numericMargin||e>=this.count-this.numericMargin?
"":b.format(h,this.constraints)),h+=g;return f},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length}});f("dojo-bidi")&&p.extend({_setTextDirAttr:function(b){this.textDir!=b&&(this._set("textDir",b),m(".dijitRuleLabelContainer",this.domNode).forEach(l.hitch(this,function(b){b.style.direction=this.getTextDir(b.innerText||b.textContent||"")})))},_genDirectionHTML:function(b){return this.textDir?"direction:"+this.getTextDir(b)+";":""}});
return p})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(p,f,b){return p("dijit.form.HorizontalRule",[f,b],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(b){return this._positionPrefix+b+this._positionSuffix+
this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var b;if(1==this.count)b=this._genHTML(50,0);else{var f,h=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){b=this._genHTML(0,0);for(f=1;f<this.count-1;f++)b+=this._genHTML(h*f,f);b+=this._genHTML(100,this.count-1)}else{b=this._genHTML(100,0);for(f=1;f<this.count-1;f++)b+=this._genHTML(100-h*f,f);b+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=b}})})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A){var y=f("dijit.form._SliderMover",c,{onMouseMove:function(a){var b=this.widget,c=b._abspos;c||(c=b._abspos=l.position(b.sliderBarContainer,!0),b._setPixelValue_=n.hitch(b,"_setPixelValue"),b._isReversed_=b._isReversed());a=a[b._mousePixelCoord]-c[b._startingPixelCoord];b._setPixelValue_(b._isReversed_?c[b._pixelCount]-a:a,c[b._pixelCount],!1)},destroy:function(a){c.prototype.destroy.apply(this,arguments);var b=this.widget;b._abspos=null;b._setValueAttr(b.value,
!0)}});b=f("dijit.form.HorizontalSlider",[t,x],{templateString:A,value:0,showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:q.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",
_onKeyUp:function(a){this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey||this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey)){switch(a.keyCode){case r.HOME:this._setValueAttr(this.minimum,!1);break;case r.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?r.RIGHT_ARROW:r.LEFT_ARROW:case !1===this._descending?r.DOWN_ARROW:r.UP_ARROW:case !1===this._descending?r.PAGE_DOWN:r.PAGE_UP:this.increment(a);
break;case this._descending||this.isLeftToRight()?r.LEFT_ARROW:r.RIGHT_ARROW:case !1===this._descending?r.UP_ARROW:r.DOWN_ARROW:case !1===this._descending?r.PAGE_UP:r.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){this.disabled||this.readOnly||(g("ie")||k.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&
this.clickSelect){k.focus(this.sliderHandle);a.stopPropagation();a.preventDefault();var b=l.position(this.sliderBarContainer,!0),c=a[this._mousePixelCoord]-b[this._startingPixelCoord];this._setPixelValue(this._isReversed()?b[this._pixelCount]-c:c,b[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,b,c){if(!this.disabled&&!this.readOnly){var d=this.discreteValues;if(1>=d||Infinity==d)d=b;d--;this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*Math.round(a/
(b/d))/d+this.minimum,this.maximum),this.minimum),c)}},_setValueAttr:function(a,b){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var c=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,d=!1===this._descending?this.remainingBar:this.progressBar,e=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(b&&0<this.slideDuration&&
d.style[this._progressPixelSize]){var f=this,g={},k=parseFloat(d.style[this._progressPixelSize]),h=this.slideDuration*(c-k/100);0!=h&&(0>h&&(h=0-h),g[this._progressPixelSize]={start:k,end:100*c,units:"%"},this._inProgressAnim=m.animateProperty({node:d,duration:h,onAnimate:function(a){e.style[f._progressPixelSize]=100-parseFloat(a[f._progressPixelSize])+"%"},onEnd:function(){delete f._inProgressAnim},properties:g}),this._inProgressAnim.play())}else d.style[this._progressPixelSize]=100*c+"%",e.style[this._progressPixelSize]=
100*(1-c)+"%"},_bumpValue:function(a,b){if(!(this.disabled||this.readOnly||this.maximum<=this.minimum)){var c=h.getComputedStyle(this.sliderBarContainer),d=l.getContentBox(this.sliderBarContainer,c),c=this.discreteValues;if(1>=c||Infinity==c)c=d[this._pixelCount];c--;d=Math.round((this.value-this.minimum)*c/(this.maximum-this.minimum))+a;0>d&&(d=0);d>c&&(d=c);d=d*(this.maximum-this.minimum)/c+this.minimum;this._setValueAttr(d,b)}},_onClkBumper:function(a){this.disabled||this.readOnly||!this.clickSelect||
this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==r.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==r.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){this.focused&&(a.stopPropagation(),a.preventDefault(),this._bumpValue(0>a.wheelDelta?-1:1,!0))},
startup:function(){this._started||(p.forEach(this.getChildren(),function(a){this[a.container]!=this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,b,c){if(-1==a)this._setValueAttr(this.value,!0);else this[b==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](c)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display=
"");var b=a('label[for\x3d"'+this.id+'"]');b.length&&(b[0].id||(b[0].id=this.id+"_label"),this.focusNode.setAttribute("aria-labelledby",b[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(d.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),d.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(v(this.domNode,
u.wheel,n.hitch(this,"_mouseWheeled")));var a=f(y,{widget:this});this._movable=new e(this.sliderHandle,{mover:a});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});b._Mover=y;return b})},"dijit/typematic":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/on dojo/sniff ./main".split(" "),function(p,f,b,m,l,h){var r=h.typematic={_fireEventAndReload:function(){this._timer=
null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(0>this._currentTimeout?this._initialDelay:1<this._subsequentDelay?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay),this._minDelay);this._timer=setTimeout(b.hitch(this,"_fireEventAndReload"),this._currentTimeout)},trigger:function(f,g,e,c,a,h,l,m){if(a!=this._obj){this.stop();this._initialDelay=l||500;this._subsequentDelay=h||.9;this._minDelay=m||10;this._obj=a;this._node=e;this._count=
this._currentTimeout=-1;this._callback=b.hitch(g,c);this._evt={faux:!0};for(var k in f)"layerX"!=k&&"layerY"!=k&&(g=f[k],"function"!=typeof g&&"undefined"!=typeof g&&(this._evt[k]=g));this._fireEventAndReload()}},stop:function(){this._timer&&(clearTimeout(this._timer),this._timer=null);this._obj&&(this._callback(-1,this._node,this._evt),this._obj=null)},addKeyListener:function(h,g,e,c,a,l,v){var q="keyCode"in g?"keyCode":"charCode"in g?"charCode":"charOrCode",k=[m(h,"keyCode"in g?"keydown":"charCode"in
g?"keypress":f._keypress,b.hitch(this,function(b){b[q]!=g[q]||void 0!==g.ctrlKey&&g.ctrlKey!=b.ctrlKey||void 0!==g.altKey&&g.altKey!=b.altKey||void 0!==g.metaKey&&g.metaKey!=(b.metaKey||!1)||void 0!==g.shiftKey&&g.shiftKey!=b.shiftKey?r._obj==g&&r.stop():(b.stopPropagation(),b.preventDefault(),r.trigger(b,e,h,c,g,a,l,v))})),m(h,"keyup",b.hitch(this,function(){r._obj==g&&r.stop()}))];return{remove:function(){p.forEach(k,function(a){a.remove()})}}},addMouseListener:function(f,g,e,c,a,h){var n=[m(f,
"mousedown",b.hitch(this,function(b){b.preventDefault();r.trigger(b,g,f,e,f,c,a,h)})),m(f,"mouseup",b.hitch(this,function(a){this._obj&&a.preventDefault();r.stop()})),m(f,"mouseout",b.hitch(this,function(a){this._obj&&a.preventDefault();r.stop()})),m(f,"dblclick",b.hitch(this,function(m){m.preventDefault();9>l("ie")&&(r.trigger(m,g,f,e,f,c,a,h),setTimeout(b.hitch(this,r.stop),50))}))];return{remove:function(){p.forEach(n,function(a){a.remove()})}}},addListener:function(b,f,e,c,a,h,l,m){var g=[this.addKeyListener(f,
e,c,a,h,l,m),this.addMouseListener(b,c,a,h,l,m)];return{remove:function(){p.forEach(g,function(a){a.remove()})}}}};return r})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(p,f,b){return p("dijit.form.RadioButton",[f,b],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),function(p,f,b,m,l,h){return f("dijit.form._RadioButtonMixin",
null,{type:"radio",_getRelatedWidgets:function(){var b=[];l("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(m.hitch(this,function(f){f.name==this.name&&f.form==this.focusNode.form&&(f=h.getEnclosingWidget(f))&&b.push(f)}));return b},_setCheckedAttr:function(b){this.inherited(arguments);this._created&&b&&p.forEach(this._getRelatedWidgets(),m.hitch(this,function(b){b!=this&&b.checked&&b.set("checked",!1)}))},_getSubmitValue:function(b){return null==b?"on":b},_onClick:function(f){if(this.checked||
this.disabled)return f.stopPropagation(),f.preventDefault(),!1;if(this.readOnly)return f.stopPropagation(),f.preventDefault(),p.forEach(this._getRelatedWidgets(),m.hitch(this,function(e){b.set(this.focusNode||this.domNode,"checked",e.checked)})),!1;var h=!1,g;p.some(this._getRelatedWidgets(),function(b){return b.checked?(g=b,!0):!1});this.checked=!0;g&&(g.checked=!1);if(!1===this.onClick(f)||f.defaultPrevented)h=!0;this.checked=!1;g&&(g.checked=!0);h?f.preventDefault():this.set("checked",!0);return!h}})})},
"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(p,f,b,m,l,h){var r=b("dijit._editor.plugins.TextColor",l,{buttonClass:h,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var b=this;this.button.loadDropDown=function(f){function e(c){b.button.dropDown=new c({dir:b.editor.dir,ownerDocument:b.editor.ownerDocument,
value:b.value,onChange:function(a){b.editor.execCommand(b.command,a)},onExecute:function(){b.editor.execCommand(b.command,this.get("value"))}});f()}"string"==typeof b.colorPicker?p([b.colorPicker],e):e(b.colorPicker)}},updateState:function(){var b=this.editor,g=this.command;if(b&&b.isLoaded&&g.length){if(this.button){var e=this.get("disabled");this.button.set("disabled",e);if(e)return;var c;try{c=b.queryCommandValue(g)||""}catch(a){c=""}}""==c&&(c="#000000");"transparent"==c&&(c="#ffffff");"string"==
typeof c?-1<c.indexOf("rgb")&&(c=f.fromRgb(c).toHex()):(c=((c&255)<<16|c&65280|(c&16711680)>>>16).toString(16),c="#000000".slice(0,7-c.length)+c);this.value=c;(b=this.button.dropDown)&&b.get&&c!==b.get("value")&&b.set("value",c,!1)}}});l.registry.foreColor=function(b){return new r(b)};l.registry.hiliteColor=function(b){return new r(b)};return r})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(p,f,b,m){var l={};f.setObject("dojo.colors",
l);var h=function(b,f,e){0>e&&++e;1<e&&--e;var c=6*e;return 1>c?b+(f-b)*c:1>2*e?f:2>3*e?b+(f-b)*(2/3-e)*6:b};p.colorFromRgb=b.fromRgb=function(f,g){var e=f.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(e){var c=e[2].split(/\s*,\s*/),a=c.length,e=e[1];if("rgb"==e&&3==a||"rgba"==e&&4==a)return e=c[0],"%"==e.charAt(e.length-1)?(e=m.map(c,function(a){return 2.56*parseFloat(a)}),4==a&&(e[3]=c[3]),b.fromArray(e,g)):b.fromArray(c,g);if("hsl"==e&&3==a||"hsla"==e&&4==a){var e=(parseFloat(c[0])%
360+360)%360/360,l=parseFloat(c[1])/100,n=parseFloat(c[2])/100,l=.5>=n?n*(l+1):n+l-n*l,n=2*n-l,e=[256*h(n,l,e+1/3),256*h(n,l,e),256*h(n,l,e-1/3),1];4==a&&(e[3]=c[3]);return b.fromArray(e,g)}}return null};var r=function(b,f,e){b=Number(b);return isNaN(b)?e:b<f?f:b>e?e:b};b.prototype.sanitize=function(){this.r=Math.round(r(this.r,0,255));this.g=Math.round(r(this.g,0,255));this.b=Math.round(r(this.b,0,255));this.a=r(this.a,0,1);return this};l.makeGrey=b.makeGrey=function(f,g){return b.fromArray([f,f,
f,g])};f.mixin(b.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,
169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,
34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,
250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,
104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,
192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,
222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return b})},"dijit/form/DropDownButton":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/query ../registry ../popup ./Button ../_Container ../_HasDropDown dojo/text!./templates/DropDownButton.html ../a11yclick".split(" "),function(p,f,b,m,l,h,r,n,g,e){return p("dijit.form.DropDownButton",[r,n,g],{baseClass:"dijitDropDownButton",templateString:e,_fillContent:function(){var b=this.srcNodeRef,a=this.containerNode;
if(b&&a)for(;b.hasChildNodes();){var e=b.firstChild;e.hasAttribute&&(e.hasAttribute("data-dojo-type")||e.hasAttribute("dojoType")||e.hasAttribute("data-"+f._scopeName+"-type")||e.hasAttribute(f._scopeName+"Type"))?(this.dropDownContainer=this.ownerDocument.createElement("div"),this.dropDownContainer.appendChild(e)):a.appendChild(e)}},startup:function(){this._started||(!this.dropDown&&this.dropDownContainer&&(this.dropDown=l.byNode(this.dropDownContainer.firstChild),delete this.dropDownContainer),
this.dropDown&&h.hide(this.dropDown),this.inherited(arguments))},isLoaded:function(){var b=this.dropDown;return!!b&&(!b.href||b.isLoaded)},loadDropDown:function(c){var a=this.dropDown,e=a.on("load",b.hitch(this,function(){e.remove();c()}));a.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){var u=f("dijit._editor.plugins.LinkDialog",e,{buttonClass:c,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=l.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){p("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),l.hitch(this,function(b,c,e){var d=this;this.tag="insertImage"==this.command?"img":"a";b=l.delegate(b.getLocalization("dijit","common",this.lang),b.getLocalization("dijit._editor",
"LinkDialog",this.lang));var f=this.dropDown=this.button.dropDown=new c({title:b[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:l.hitch(this,"setValue"),onOpen:function(){d._onOpenDialog();c.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(l.hitch(d,"_onCloseDialog"),0)}});b.urlRegExp=this.urlRegExp;b.id=e.getUniqueId(this.editor.id);this._uniqueId=b.id;this._setContent(f.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
g.substitute(this.linkDialogTemplate,b));f.startup();this._urlInput=e.byId(this._uniqueId+"_urlInput");this._textInput=e.byId(this._uniqueId+"_textInput");this._setButton=e.byId(this._uniqueId+"_setButton");this.own(e.byId(this._uniqueId+"_cancelButton").on("click",l.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",l.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",l.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=l.hitch(this,function(){var a=this._urlInput.get("value");return this._urlRegExp.test(a)||this._emailRegExp.test(a)});this.own(h(f.domNode,"keydown",l.hitch(this,l.hitch(this,function(a){!a||a.keyCode!=m.ENTER||a.shiftKey||a.metaKey||a.ctrlKey||a.altKey||this._setButton.get("disabled")||(f.onExecute(),f.execute(f.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,b=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var c=b,e=!1,f=!1;c&&1<c.length&&(c=l.trim(c),0!==c.indexOf("mailto:")&&(0<c.indexOf("/")?-1===c.indexOf("://")&&"/"!==c.charAt(0)&&c.indexOf("./")&&0!==c.indexOf("../")&&a._hostRxp.test(c)&&(e=!0):a._userAtRxp.test(c)&&(f=!0)));e&&a._urlInput.set("value","http://"+c);f&&a._urlInput.set("value","mailto:"+c);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(l.hitch(this,
function(){this.own(h(this.editor.editNode,"dblclick",l.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},setValue:function(c){this._onCloseDialog();if(9>r("ie")){var e=a.getSelection(this.editor.window).getRangeAt(0).endContainer;3===e.nodeType&&(e=e.parentNode);
e&&e.nodeName&&e.nodeName.toLowerCase()!==this.tag&&(e=this.editor.selection.getSelectedElement(this.tag));e&&e.nodeName&&e.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(e),this.editor.execCommand("unlink"))}c=this._checkValues(c);this.editor.execCommand("inserthtml",g.substitute(this.htmlTemplate,c));n("a",this.editor.document).forEach(function(a){a.innerHTML||b.has(a,"name")||a.parentNode.removeChild(a)},this)},_onCloseDialog:function(){this.editor.focused&&
this.editor.focus()},_getCurrentValues:function(a){var b,c,e;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("href"),e=a.getAttribute("target")||"_self",c=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||"",targetSelect:e||""}},_onOpenDialog:function(){var b,c;if(r("ie")){if(c=a.getSelection(this.editor.window),c.rangeCount){var d=c.getRangeAt(0);b=d.endContainer;
3===b.nodeType&&(b=b.parentNode);b&&b.nodeName&&b.nodeName.toLowerCase()!==this.tag&&(b=this.editor.selection.getSelectedElement(this.tag));if(!b||b.nodeName&&b.nodeName.toLowerCase()!==this.tag)(c=this.editor.selection.getAncestorElement(this.tag))&&c.nodeName&&c.nodeName.toLowerCase()==this.tag?(b=c,this.editor.selection.selectElement(b)):d.startContainer===d.endContainer&&(c=d.startContainer.firstChild)&&c.nodeName&&c.nodeName.toLowerCase()==this.tag&&(b=c,this.editor.selection.selectElement(b))}}else b=
this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(b))},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&b.get(a,"href"))){var c=this.editor;this.editor.selection.selectElement(a);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var d=this.button;setTimeout(function(){d.set("disabled",
!1);d.loadAndOpenDropDown().then(function(){d.dropDown.focus&&d.dropDown.focus()})},10)}}}),v=f("dijit._editor.plugins.ImgLinkDialog",[u],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var b,c;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("src"),c=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(l.hitch(this,
function(){this.own(h(this.editor.editNode,"mousedown",l.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&b.get(a,
"src"))){var c=this.editor;this.editor.selection.selectElement(a);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var d=this.button;setTimeout(function(){d.set("disabled",!1);d.loadAndOpenDropDown().then(function(){d.dropDown.focus&&d.dropDown.focus()})},10)}}});e.registry.createLink=function(){return new u({command:"createLink"})};e.registry.insertImage=function(){return new v({command:"insertImage"})};u.ImgLinkDialog=v;return u})},
"builder/plugins/app-config-templateconfig/_build-generate_module":function(){define(["builder/plugins/app-config-templateconfig/Plugin","dojo/text!builder/plugins/app-config-templateconfig/Plugin.html","dojo/text!builder/plugins/app-config-templateconfig/css/style.css","dojo/i18n!builder/plugins/app-config-templateconfig/nls/strings"],function(){})},"builder/plugins/app-config-templateconfig/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(p,f,b,m,l,h,r,n){return p([l],{baseClass:"plugin-config-template",postCreate:function(){this.inherited(arguments);this.own(m.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)));this.own(m.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)));this.pluginManager.getPluginByName("app-config").addRepublishEvent("templateConfigChanged")},_init:function(){this.visible&&this.appConfig&&r.loadAllWidgetConfigs(f.clone(this.appConfig)).then(f.hitch(this,function(b){this._initConfigPanel(b);
this._initPriviewPanel(this.configTemplate.getTemplateConfig())}))},_initConfigPanel:function(g){this.configTemplate&&this.configTemplate.destroy();this.configTemplate=new h({appConfig:g,appInfo:window.appInfo,templateConfig:g.templateConfig});this.configTemplate.on("hasChanged",f.hitch(this,this._onConfigTempalteChanged));b.place(this.configTemplate.domNode,this.configPanel);this.configTemplate.startup()},_initPriviewPanel:function(f){this.previewTemplate&&this.previewTemplate.destroy();this.previewTemplate=
new n({templateConfig:f});b.place(this.previewTemplate.domNode,this.previewPanel);this.previewTemplate.startup()},_onAppConfigLoaded:function(b){this.appConfig=b;this._init()},_onAppConfigChanged:function(b){this.appConfig=b},_onToAppClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigApp()},_onConfigTempalteChanged:function(){this._initPriviewPanel(this.configTemplate.getTemplateConfig());m.publish("templateConfigChanged",this.configTemplate.getFullTemplateConfig())},
refresh:function(){this._init()}})})},"builder/dijit/template-config/Template":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Template.html dojo/on dojo/dom dojo/_base/lang dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/json dojo/query dojo/Deferred dojo/Evented dijit/form/Select ./ConfigNode ./CategoryManager ./Export builder/serviceUtils jimu/utils jimu/WidgetManager jimu/dijit/Message jimu/portalUrlUtils builder/portalUtils jimu/dijit/LoadingShelter ./ExportMessage".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J){return p([m,l,d],{templateString:h,baseClass:"agol-template",configTree:null,nls:null,lastTemplateJson:null,constructor:function(){this.loading=new I({hidden:!0})},postMixInProperties:function(){this.nls=window.builderNls;this.imageFolder="builder/css/images/agoltemplate/";this.arrowImgSrc=isRTL?this.imageFolder+"v_left.png":this.imageFolder+"v_right.png"},postCreate:function(){this.inherited(arguments)},startup:function(){this._beforeInitWork();
n.setSelectable(this.contentPart,!1);this.configTree=new t(this.cleanAppConfig,null,"app","",0);this.categoryManager=new x(this.configTree,this.cleanAppConfig,this.templateConfig);this.drawTree(this.configTree,this.treePart);this.drawCategoryPart();this._afterInitWork()},_beforeInitWork:function(){this.cleanAppConfig=this.appConfig.getCleanConfig(!0);delete this.cleanAppConfig.visitElement;delete this.cleanAppConfig._buildInfo;delete this.cleanAppConfig.agolTemplateJson},_afterInitWork:function(){this.lastTemplateJson=
this.categoryManager.getTemplateJson()},drawTree:function(a,b){var c,d;c=this.drawDomNode(a,b);if(0!==a.childs.length)for(d=0;d<a.childs.length;d++)this.drawTree(a.childs[d],c)},drawDomNode:function(a,d){var f,k,h,l,m;m=this.categoryManager.getCategoryByField(a.absolutePath);f=e.create("div",{"class":"tree-node-div",idAttr:a.id},d);a.traversal(g.hitch(this,function(a){if(this.categoryManager.getCategoryByField(a.absolutePath))return!0}))||c.set(f,"display","none");"leaf"!==a.nodeType||m||c.set(f,
"color","#cccccc");k=e.create("div",{"class":"line-label-div "},f);var q=a.label?a.label:a.keyString;q.indexOf("]")===q.length-1&&(q+="\x26lrm;");q=e.create("div",{"class":"line-label-text ",innerHTML:q,title:q},k);"leaf"!==a.nodeType&&b.addClass(q,"leaf-node");m&&"leaf"===a.nodeType&&(h=e.create("div",{"class":"to-right-div "},f),e.create("img",{"class":"to-right-img",src:this.imageFolder+"add_field.png",alt:"img"},h),this.own(r(h,"click",g.hitch(this,function(b){c.set(h,"display","none");this._onToRightDiv(a,
"add",f);b.stopPropagation();this._checkTemplateStatus()}))),-1!==m.findFieldFromDisplay(a.absolutePath)&&c.set(h,"display","none"));l=12*a.level;"leaf"===a.nodeType?isRTL?c.set(k,"paddingRight",l+17+"px"):c.set(k,"paddingLeft",l+17+"px"):isRTL?c.set(k,"paddingRight",l+"px"):c.set(k,"paddingLeft",l+"px");k=e.create("div",{"class":"tree-node-subdiv"},d);c.set(k,"display","none");"leaf"!==a.nodeType?(c.set(f,"cursor","pointer"),this.own(r(f,"click",g.hitch(this,function(a,d,e){"none"===c.get(d,"display")?
(c.set(d,"display","block"),b.addClass(e,"unfold")):(c.set(d,"display","none"),b.removeClass(e,"unfold"));-1===a.absolutePath.search(/widgets\[[0-9]+\]_config$/)||a.jsonObject||this.addWidgetConfigToConfigTree(a.absolutePath)},a,k,q)))):m&&(c.set(f,"cursor","pointer"),this.own(r(f,"click",g.hitch(this,function(a,b){this._onToRightDiv(a,"notAdd",f);b.stopPropagation()},a))));a.lineDomNode=f;a.subLineDomNode=k;a.showSubDivDomNode=void 0;a.toRightDiv=h;0===a.level&&(b.setStyle(f,"display","none"),b.setStyle(k,
"display","block"));return k},drawCategoryPart:function(){f.forEach(this.categoryManager.displayCategorys,function(a){this.drawCategory(a)},this)},drawCategory:function(a){var b,d,k,h,l,m,q;b=e.create("div",{"class":"category-div",categoryDiv:a.name},this.categoryPart);h=e.create("div",{"class":"category-head-div",categoryHeadDiv:a.name},b);l=e.create("div",{"class":"category-fold-div jimu-float-leading"},h);q=e.create("img",{"class":"category-fold-img",src:this.arrowImgSrc,alt:"img"},l);e.create("div",
{"class":"category-title-div jimu-float-leading",innerHTML:a.title},h);d=e.create("div",{"class":"category-oper-div jimu-float-trailing"},h);l=e.create("div",{"class":"category-oper-item-div category-moveup-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},d);m=e.create("div",{"class":"category-oper-item-div category-movedown-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},
d);d=e.create("div",{"class":"category-oper-item-div category-remove-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},d);k=e.create("div",{"class":"fields-div",fieldsDiv:a.name},b);this.own(r(l,"click",g.hitch(this,function(b){this.categoryManager.moveup(a)&&(e.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(r(m,"click",g.hitch(this,
function(b){this.categoryManager.movedown(a)&&(e.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(r(d,"click",g.hitch(this,function(d){this.categoryManager.removeCategoryFromDisplay(a);e.destroy(b);f.forEach(a.displayFields,function(a){var b=this.configTree.findNode(a.fieldPath);b&&(b.setTemplateField(a.fieldJson),b.toRightDiv&&c.set(b.toRightDiv,"display","block"))},this);a.displayFields=[];d.stopPropagation();
this._checkTemplateStatus()})));this.own(r(h,"click",g.hitch(this,function(){"block"===c.get(k,"display")?(c.set(k,"display","none"),u.set(q,"src",this.arrowImgSrc)):(c.set(k,"display","block"),u.set(q,"src",this.imageFolder+"v.png"));this._changeHeighlightCategoryHead(a.name)})));this.drawFields(a,b,k);c.set(k,"display","none")},drawFields:function(a,b,c){f.forEach(a.displayFields,function(d){this.drawField(a,b,c,d)},this)},addWidgetConfigToConfigTree:function(a){var b=new k,c=a.search(/widgets\[[0-9]+\]/),
d=a.slice(c,a.length).indexOf("]"),c=a.slice(0,c+d+1);a=c+"_config";var c=this.configTree.findNode(c),e=this.configTree.findNode(a);a=this.appConfig.getConfigElementById(c.jsonObject.id);C.getInstance().tryLoadWidgetConfig(a).then(g.hitch(this,function(a){if(a){var c;e.jsonObject=a;a.geocoder&&a.geocoder.geocoders&&delete a.geocoder.geocoders;for(c in a)a.hasOwnProperty(c)&&(c=e.addChild(a[c],c,e.absolutePath,e.level),this.drawTree(c,e.subLineDomNode))}b.resolve()}));return b},drawField:function(a,
d,k,h){var l,m,q,n,v,p,x,A;this.configTree.findNode(h.fieldPath);A=t.getDefaultTemplateField(h.fieldPath,h.fieldJson.type,h.fieldJson.label);for(l in h.fieldJson)h.fieldJson.hasOwnProperty(l)&&(A[l]=h.fieldJson[l]);l=e.create("div",{"class":"field-div",fieldDiv:h.fieldPath},k);this.own(r(l,"click",g.hitch(this,function(a,d){function e(){f=this.configTree.findNode(m);k=b.position(this.treePart).y;h=b.position(f.lineDomNode).y;l=h-k;(0>l||l>c.get(this.categoryPart,"height"))&&f.lineDomNode.scrollIntoView(!1);
this._changeHeighlightFieldDomNode(m);this._changeHeighlightTreeDomNode(f.lineDomNode);this._changeHeighlightCategoryHead(d.name)}var f,k,h,l,m=a.fieldPath;if(f=this.configTree.findNode(m)){for(;f;)c.set(f.subLineDomNode,"display","block"),f=f.parentNode;g.hitch(this,e)()}else this.addWidgetConfigToConfigTree(m).then(g.hitch(this,function(){for(f=this.configTree.findNode(m);f;)c.set(f.subLineDomNode,"display","block"),f=f.parentNode;g.hitch(this,e)()}))},h,a)));a=e.create("div",{"class":"field-head-div"},
l);q=e.create("div",{"class":"field-fold-div"},a);n=e.create("img",{"class":"field-fold-img",src:this.arrowImgSrc,alt:"img"},q);q=g.hitch(this,function(a){var b="",c=a.split("_"),d=g.clone(c);f.forEach(c,function(a,b){var e,f="";if(-1!==a.search(/widgets\[[0-9]+\]$/)||-1!==a.search(/groups\[[0-9]+\]$/)){for(e=0;e<=b;e++)f+=c[e]+"_";e=this.configTree.findNode(f.slice(0,-1));d[b]=e.label}},this);for(a=1;a<d.length;a++)b+=d[a]+"_";return b.slice(0,-1)})(h.fieldPath);e.create("div",{"class":"field-head-title-div",
innerHTML:q,title:q},a);v=e.create("div",{"class":"field-opers-div"},a);q=e.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},v);p=e.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},v);v=e.create("div",{"class":"field-oper-div jimu-float-trailing",
innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},v);var y=e.create("div",{"class":"field-fixed-content-div",style:"display:none;"},l);m=e.create("div",{"class":"field-box-div"},y);e.create("span",{"class":"field-label-span",innerHTML:this.nls.fieldLabel},m);m=e.create("input",{"class":"jimu-input field-label-input",type:"text",value:A.label},m);this.own(r(m,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"label",value:z.stripHTML(b.value)})},
h.fieldPath,m)));m=e.create("div",{"class":"field-box-div"},y);e.create("span",{"class":"field-type-span",innerHTML:this.nls.fieldType},m);m=(new w({name:"selectFieldType","class":"field-type-select",options:[{label:this.nls.typeSelectString,value:"string"},{label:this.nls.typeSelectBoolean,value:"boolean"},{label:this.nls.typeSelectNumber,value:"number"},{label:this.nls.typeSelectOptions,value:"options"},{label:this.nls.typeSelectColor,value:"color"}],value:A.type})).placeAt(m);x=e.create("div",
{"class":"field-content-div",style:"display:none;"},l);this.drawFieldContent(h.fieldPath,A,x,m.getValue());this.own(r(m,"change",g.hitch(this,function(a,b,d,e){this.drawFieldContent(a,b,d,e);this._onFieldChange(a,{key:"type",value:e});c.set(d,"display","block")},h.fieldPath,A,x)));this.own(r(a,"click",g.hitch(this,function(){"block"===c.get(x,"display")?(c.set(x,"display","none"),c.set(y,"display","none"),u.set(n,"src",this.arrowImgSrc)):(c.set(x,"display","block"),c.set(y,"display","block"),u.set(n,
"src",this.imageFolder+"v.png"))})));this.own(r(q,"click",g.hitch(this,function(a,b,d,f){var k=a.fieldPath,h=this.configTree.findNode(k);h?(h.setTemplateField(a.fieldJson),h.toRightDiv&&c.set(h.toRightDiv,"display","block")):this.addWidgetConfigToConfigTree(k).then(g.hitch(this,function(){var b=this.configTree.findNode(k);a.fieldJson&&b.setTemplateField(a.fieldJson)}));h=this.categoryManager.getCategoryByField(k);h.removeFieldFromDisplay(k);e.destroy(b);h.displayIsEmpty()&&(this.categoryManager.removeCategoryFromDisplay(h),
e.destroy(d));f.stopPropagation();this._checkTemplateStatus()},h,l,d)));this.own(r(v,"click",g.hitch(this,function(a,b,c){var f=this.categoryManager.getCategoryByField(a);f.moveup(a)&&(e.empty(b),this.drawFields(f,d,b),this._changeHeighlightFieldDomNode(a));c.stopPropagation();this._checkTemplateStatus()},h.fieldPath,k)));this.own(r(p,"click",g.hitch(this,function(a,b,c){var f=this.categoryManager.getCategoryByField(a);f.movedown(a)&&(e.empty(b),this.drawFields(f,d,b),this._changeHeighlightFieldDomNode(a));
c.stopPropagation();this._checkTemplateStatus()},h.fieldPath,k)))},drawFieldContent:function(a,b,c,d){var k,h,l,m;e.empty(c);"color"!==d&&(e.create("span",{"class":"field-tooltip-span",innerHTML:this.nls.tooltip},c),k=e.create("input",{"class":"jimu-input field-tooltip-input",type:"text",value:b.tooltip},c),this.own(r(k,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"tooltip",value:b.value})},a,k))),e.create("br",{},c),"string"===d?(e.create("span",{"class":"field-string-ph-span",
innerHTML:this.nls.placeholder},c),d=e.create("input",{"class":"jimu-input field-string-ph-input",type:"text",value:b.placeHolder},c),this.own(r(d,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"placeHolder",value:b.value})},a,d))),d=e.create("div",{"class":"field-text-type-div"},c),e.create("span",{"class":"field-text-type-span",innerHTML:this.nls.textBoxType},d),b=(new w({name:"stringOptions","class":"field-string-options",options:[{label:this.nls.textBoxTypeTextbox,value:"textbox"},
{label:this.nls.textBoxTypeTextarea,value:"textarea"},{label:this.nls.textBoxTypeRichtext,value:"richtext"}],value:b.stringFieldOption})).placeAt(d),this.own(r(b,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"stringFieldOption",value:b})},a)))):"number"===d?(e.create("span",{"class":"field-num-min-span",innerHTML:this.nls.minvalue},c),h=e.create("input",{"class":"jimu-input field-num-input field-num-min-input",type:"text",value:b.constraints.min},c),e.create("br",{},c),e.create("span",
{"class":"field-num-max-span",innerHTML:this.nls.maxvalue},c),l=e.create("input",{"class":"jimu-input field-num-input field-num-max-input",type:"text",value:b.constraints.max},c),e.create("br",{},c),e.create("span",{"class":"field-num-places-span",innerHTML:this.nls.places},c),m=e.create("input",{"class":"jimu-input field-num-input field-num-places-input",type:"text",value:b.constraints.places},c),this.own(r(h,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:h.value,
max:l.value,places:m.value}})},a))),this.own(r(l,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:h.value,max:l.value,places:m.value}})},a))),this.own(r(m,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:h.value,max:l.value,places:m.value}})},a)))):"options"===d&&(d=e.create("div",{"class":"field-options-add-div"},c),k=e.create("div",{"class":"field-options-add-content"},d),e.create("div",{"class":"field-options-add-img-div jimu-float-leading",
innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"add_link.png' alt\x3d'img'\x3e\x3c/img\x3e"},k),e.create("div",{"class":"field-options-add-text-div jimu-float-leading",innerHTML:this.nls.addNewOption},k),f.forEach(b.options,function(b){this._onFieldOptionsAdd(a,c,b.label,b.value)},this),this.own(r(d,"click",g.hitch(this,this._onFieldOptionsAdd,a,c,"","")))))},_changeHeighlightFieldDomNode:function(b){q(".field-div",this.categoryPart).removeClass("field-heighlight-div");a.add(q('div[fieldDiv\x3d"'+
b+'"]',this.categoryPart)[0],"field-heighlight-div")},_changeHeighlightTreeDomNode:function(b){this.heighlightTreeDomNode&&a.remove(this.heighlightTreeDomNode,"tree-node-heighlight-div");a.add(b,"tree-node-heighlight-div");this.heighlightTreeDomNode=b},_changeHeighlightCategoryHead:function(a){q(".category-head-div",this.categoryPart).removeClass("category-head-div-selected");a=q("div[categoryHeadDiv\x3d'"+a+"']",this.categoryPart)[0];b.addClass(a,"category-head-div-selected")},_onToRightDiv:function(a,
d,e){var f,g,k=this.categoryManager.getCategoryByField(a.absolutePath);f=this.categoryManager.findDisplayCategory(k.name);g={fieldPath:a.absolutePath,fieldJson:a.getTemplateField()};if(-1===f){if("add"!==d)return;this.categoryManager.addCategoryToDisplay(k);k.addFieldToDisplay(g);this.drawCategory(k);f=q("div[fieldsDiv\x3d'"+k.name+"']",this.categoryPart)[0]}else if(-1===k.findFieldFromDisplay(a.absolutePath)){if("add"!==d)return;k.addFieldToDisplay(g);d=q("div[categoryDiv\x3d'"+k.name+"']",this.categoryPart)[0];
f=q("div[fieldsDiv\x3d'"+k.name+"']",this.categoryPart)[0];this.drawField(k,d,f,g)}else f=q("div[fieldsDiv\x3d'"+k.name+"']",this.categoryPart)[0];c.set(f,"display","block");g=q('div[fieldDiv\x3d"'+a.absolutePath+'"]',this.categoryPart)[0];this._changeHeighlightCategoryHead(k.name);this._changeHeighlightFieldDomNode(a.absolutePath);this._changeHeighlightTreeDomNode(e);a=b.position(this.categoryPart).y;a=b.position(g).y-a;(0>a||a>c.get(this.categoryPart,"height"))&&g.scrollIntoView(!1)},_onFieldChange:function(a,
b){var c=this.configTree.findNode(a),d=this.categoryManager.getCategoryByField(a).getDisplayField(a);d.fieldJson[b.key]=b.value;c.templateField=d.fieldJson;this._checkTemplateStatus()},_onFieldOptionsAdd:function(a,b,c,d){var f=e.create("div",{"class":"field-options-div"},b),k=e.create("div",{"class":"field-box-div"},f);e.create("div",{"class":"field-options-label-div jimu-float-leading",innerHTML:this.nls.labelStr},k);k=e.create("input",{"class":"jimu-input field-options-label-input jimu-float-leading",
type:"text",value:c},k);this.own(r(k,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)));k=e.create("div",{"class":"field-box-div"},f);e.create("div",{"class":"field-options-value-div jimu-float-leading",innerHTML:this.nls.value},k);d=e.create("input",{"class":"jimu-input field-options-value-input jimu-float-leading",type:"text",value:d},k);this.own(r(d,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},
a)));d=e.create("div",{"class":"jimu-icon jimu-icon-delete field-options-remove-div jimu-float-leading"},k);this.own(r(d,"click",g.hitch(this,function(a){e.destroy(f);this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)))},_getFieldOptions:function(a){var b=[];q(".field-options-div",a).forEach(g.hitch(this,function(a){b.push({label:q(".field-options-label-input",a).attr("value")[0],value:q(".field-options-value-input",a).attr("value")[0]})}));return b},_onReviewJsonDivClick:function(){var a=
this.categoryManager.getTemplateJson();this.showJsonWidget.setConfig(a);u.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead2);c.set(this.showJsonDiv,"display","block");c.set(this.reviewJsonDiv,"display","none");c.set(this.reviewJsonBackDiv,"display","block")},_onReviewJsonBackDivClick:function(){u.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead);c.set(this.reviewJsonDiv,"display","block");c.set(this.reviewJsonBackDiv,"display","none");c.set(this.showJsonDiv,"display","none")},
_saveAgolTemplate:function(a){var b=new k,c=v.stringify(this.categoryManager.getTemplateJson("fullJson")),d={itemId:a?a:this.appInfo.agolTemplateInfo?this.appInfo.agolTemplateInfo.itemId:null,json:c};y.saveAgolTemplate(this.appInfo,d).then(g.hitch(this,function(){this.appInfo.agolTemplateInfo=d;this.lastTemplateJson=this.categoryManager.getTemplateJson();b.resolve()}),function(a){new B({message:a});b.reject()});return b},_onDownloadNodeClick:function(){},_updateAgolTemplate:function(){var a=new k,
b=this.hasChanged(),c=v.stringify(this.categoryManager.getTemplateJson());this.loading.show(this.nls.updating);b?this._saveAgolTemplate().then(g.hitch(this,function(){this._checkTemplateStatus();a.resolve()})):a.resolve();a.then(g.hitch(this,function(){G.getPortal(window.portalUrl).getUser().then(g.hitch(this,function(a){a.updateItem(this.appInfo.agolTemplateInfo.itemId,{text:c}).then(g.hitch(this,function(){this.loading.hide();J._exportedMessage({itemId:this.appInfo.agolTemplateInfo.itemId,message:this.nls.exportSuccessfulUpdate},
this.nls.exportMessageTitleUpdate,this.nls)}),g.hitch(this,function(a){this.loading.hide();console.error(a.message||a);J._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed7},this.nls.exportMessageTitleUpdate,this.nls)}))}),g.hitch(this,function(a){this.loading.hide();console.error(a.message||a);J._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed6},this.nls.exportMessageTitleUpdate,this.nls)}))}))},_exportTemplate:function(a){var b="",c=v.stringify(this.categoryManager.getTemplateJson()),
d=v.stringify(this.categoryManager.getTemplateJson("fullJson"));window.isXT?b=E.getProtocol(window.portalUrl)+"://"+window.location.host+path+"apps/"+this.appInfo.id:(b=E.getStandardPortalUrl(window.portalUrl),b="HTML3D"===window.appInfo.appType?b+"/apps/webappviewer3d/index.html?id\x3d"+this.appInfo.id:b+"/apps/webappviewer/index.html?id\x3d"+this.appInfo.id);(new A({_templateUrl:b,_temlateJson:c,_fullTemplateJson:d,nls:this.nls,_afterAddItemOfExportCallback:g.hitch(this,this._afterAddItemOfExportCallback),
appInfo:this.appInfo,appConfig:this.cleanAppConfig,isExportWABTemplate:a})).startup()},_afterAddItemOfExportCallback:function(a){this._saveAgolTemplate(a).then(g.hitch(this,function(){this._checkTemplateStatus();this.emit("exported",!0)}))},_checkTemplateStatus:function(){var a=this.hasChanged();this.emit("hasChanged",a)},exportOrUpdateAGOLTemplate:function(){this.appInfo.agolTemplateInfo&&this.appInfo.agolTemplateInfo.itemId?this._updateAgolTemplate():this._exportTemplate(!1)},exportWABTemplate:function(){this._exportTemplate(!0)},
saveAgolTemplate:function(){return this._saveAgolTemplate()},hasChanged:function(){return!z.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson())},getTemplateConfig:function(){return this.categoryManager.getTemplateJson()},getFullTemplateConfig:function(){return this.categoryManager.getTemplateJson("fullJson")}})})},"builder/dijit/template-config/ConfigNode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array"],function(p,f,b){var m={},l=p([],{id:null,parentNode:null,
keyString:null,absolutePath:null,childs:null,nodeType:null,templateField:null,jsonObject:null,level:null,label:null,isVisible:!1,constructor:function(b,l,m,g,e){var c;this.parentNode=l;this.keyString=m;this.childs=[];this.absolutePath=""===g?m:g+"_"+m;this.jsonObject=b;this.level=e;this.initId();this.initLabel();this.initTemplateField(b);if("object"!==typeof b||null===b)this.nodeType="leaf";else if(f.isArrayLike(b))for(this.nodeType="array",l=0;l<b.length;l++)this.addChild(b[l],this.keyString+"["+
l+"]",g,e);else for(c in this.nodeType="normal",b)b.hasOwnProperty(c)&&"function"!==typeof b[c]&&this.addChild(b[c],c,this.absolutePath,e)},initId:function(){var b,l;b=this.absolutePath.search(/_widgets\[[0-9]+\]/);l=this.absolutePath.search(/_groups\[[0-9]+\]/);-1!==b||-1!==l?-1!==this.absolutePath.search(/_widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/_groups\[[0-9]+\]$/)?this.id=this.parentNode.id+"["+this.jsonObject.id+"]":f.isArrayLike(this.parentNode.jsonObject)?this.id=this.parentNode.parentNode.id+
"_"+this.keyString:this.id=this.parentNode.id+"_"+this.keyString:this.id=this.absolutePath},initLabel:function(){this.label=this.keyString;if(-1!==this.absolutePath.search(/widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/groups\[[0-9]+\]$/))this.label=this.jsonObject.label},initTemplateField:function(b){this.templateField=l.getDefaultTemplateField(this.absolutePath,typeof b,this.label);l.setDefaultValue(this.absolutePath,b,this.id)},getTemplateFieldDefaultValue:function(){return this.templateField.defaultValue},
getTemplateField:function(b){b=b?b:this.templateField;var f={type:b.type,fieldName:this.id,label:b.label,tooltip:b.tooltip};"leaf"!==this.nodeType&&(f.fieldName+="--");switch(f.type){case "string":f.stringFieldOption=b.stringFieldOption;f.placeHolder=b.placeHolder;break;case "number":f.constraints=b.constraints||{min:0,max:100,places:0};break;case "options":f.options=b.options||[{label:"label1",value:"value1"}]}return f},setTemplateField:function(b){this.templateField.type=b.type;this.templateField.label=
b.label;this.templateField.tooltip=b.tooltip;"leaf"!==this.nodeType&&(this.templateField.fieldName=this.templateField.fieldName.slice(0,this.templateField.fieldName.length-2));switch(this.templateField.type){case "string":this.templateField.stringFieldOption=b.stringFieldOption;this.templateField.placeHolder=b.placeHolder;break;case "number":this.templateField.constraints=b.constraints;break;case "options":this.templateField.options=b.options}return b},addChild:function(b,f,m,g){b=new l(b,this,f,
m,g+1);this.childs.push(b);return b},isLeaf:function(){var b=!1;this.childs&&0<this.childs.length&&(b=!0);return b},findNode:function(b){var f=[],h,g,e;b.split("_").forEach(function(b){var a=b.search(/\[[0-9]+\]/);-1!==a&&f.push(b.slice(0,a));f.push(b)});g=this;if(g.keyString!==f[0])return null;for(b=1;b<f.length;b++){e=g.childs.length;for(h=0;h<e;h++)if(g.childs[h].keyString===f[b]){g=g.childs[h];break}if(h===e)return null}return g},setVisible:function(){for(var b=this;b;)b.isVisible=!0,b=b.parentNode},
findNodeById:function(b){var f=null;this.traversal(function(h){if(h.id===b)return f=h,!0});return f},traversal:function(b){if(b(this))return!0;for(var f=0;f<this.childs.length;f++)if(this.childs[f].traversal(b))return!0},deserialize:function(f){f&&b.forEach(f.configurationSettings,function(f){b.forEach(f.fields,function(b){this.findNode(b.fieldName).setTemplateField(b)},this)},this)}});l.getDefaultValue=function(b){return m[b]};l.setDefaultValue=function(b,f,l){var g=null,g=f;"app_portalUrl"===b||
"app_map_itemId"===b?g=null:"app_title"===b?g="":"app_subtitle"===b?g="":"object"===typeof f&&(g=!1);m[l]=g};l.defaultValueExisted=function(b){return void 0===m[b]?!1:!0};l.getDefaultTemplateField=function(b,f,l){b="string";switch(f){case "number":b="number";break;case "boolean":b="boolean";break;case "object":b="boolean",l="disable"}return{type:b,label:l,tooltip:"",stringFieldOption:"textbox",placeHolder:l,constraints:{min:0,max:100,places:0},options:[{label:"label1",value:"value1"}]}};return l})},
"builder/dijit/template-config/CategoryManager":function(){define(["dojo/_base/declare","dojo/_base/array","./ConfigNode","./Category"],function(p,f,b,m){return p([],{categorys:null,displayCategorys:null,constructor:function(b,f,m){this.configTree=b;this.categorys=[];this.displayCategorys=[];this.initCategorys(f,b);this.deserialize(m,b)},initCategorys:function(b,h){var l=new m(h,"Attribute","Attribute",["app_title","app_subtitle","app_logo","app_links"],[],["app_title","app_subtitle"]);this.categorys.push(l);
f.forEach(b.widgetOnScreen.widgets,function(b,f){var e="ScreenWidget_"+b.id,c="app_widgetOnScreen_widgets["+f+"]",c=[c+"_label",c+"_visible",c+"_config",c+"_openAtStart"],a=[];b.uri&&this.categorys.push(new m(h,e,b.label+" widget",c,a))},this);f.forEach(b.widgetOnScreen.groups,function(b,g){var e="ScreenWidgetGroup_"+b.id,c="app_widgetOnScreen_groups["+g+"]",a=[c+"_label",c+"_visible",c+"_openAtStart"];f.forEach(b.widgets,function(b,e){a.push(c+"_widgets["+e+"]_label");a.push(c+"_widgets["+e+"]_visible");
a.push(c+"_widgets["+e+"]_openAtStart");a.push(c+"_widgets["+e+"]_config")});this.categorys.push(new m(h,e,b.label,a,[]))},this);f.forEach(b.widgetPool.widgets,function(b,f){var e="widgetPoolWidget_"+b.id,c="app_widgetPool_widgets["+f+"]",c=[c+"_label",c+"_visible",c+"_config",c+"_openAtStart"],a=[];b.uri&&this.categorys.push(new m(h,e,b.label+" widget",c,a))},this);f.forEach(b.widgetPool.groups,function(b,g){var e="widgetPoolGroup_"+b.id,c="app_widgetPool_groups["+g+"]",a=[c+"_label",c+"_visible",
c+"_openAtStart"];f.forEach(b.widgets,function(b,e){a.push(c+"_widgets["+e+"]_label");a.push(c+"_widgets["+e+"]_visible");a.push(c+"_widgets["+e+"]_openAtStart");a.push(c+"_widgets["+e+"]_config")});this.categorys.push(new m(h,e,b.label,a,[]))},this);this.displayCategorys.push(l)},getCategoryByName:function(b){return this.categorys[this.findCategory(b)]},getCategoryByField:function(b){var f;for(f=0;f<this.categorys.length;f++)if(this.categorys[f].hasField(b))return this.categorys[f];return null},
findCategory:function(b){return this._find(b,this.categorys)},findDisplayCategory:function(b){return this._find(b,this.displayCategorys)},_find:function(b,f){var h;for(h=0;h<f.length&&f[h].name!==b;h++);return h===f.length?-1:h},addCategoryToDisplay:function(b){-1===this.findDisplayCategory(b.name)&&this.displayCategorys.push(b)},removeCategoryFromDisplay:function(b){b=this.findDisplayCategory(b.name);0<=b&&this.displayCategorys.splice(b,1)},moveup:function(b){var f;b=this.findDisplayCategory(b.name);
return 0<b?(f=this.displayCategorys[b],this.displayCategorys[b]=this.displayCategorys[b-1],this.displayCategorys[b-1]=f,!0):!1},movedown:function(b){var f;b=this.findDisplayCategory(b.name);return 0<=b&&b<this.displayCategorys.length-1?(f=this.displayCategorys[b],this.displayCategorys[b]=this.displayCategorys[b+1],this.displayCategorys[b+1]=f,!0):!1},getTemplateJson:function(l){var h={configurationSettings:[],values:{}};f.forEach(this.displayCategorys,function(m,n){var g={category:m.title,fields:[]};
"fullJson"===l&&(g.categoryName=m.name);f.forEach(m.displayFields,function(e,c){var a=this.configTree.findNode(e.fieldPath).getTemplateField(e.fieldJson);g.fields[c]=a;h.values[a.fieldName]=b.getDefaultValue(e.fieldJson.fieldName)},this);h.configurationSettings[n]=g},this);return h},deserialize:function(l,h){if(l){f.forEach(this.displayCategorys,function(b){b.displayFields=[]});this.displayCategorys=[];f.forEach(l.configurationSettings,function(b){var e=this.getCategoryByName(b.categoryName),c=0;
e&&(c=e.deserialize(b.fields,h),0<c&&this.displayCategorys.push(e))},this);var m,n=l.values;for(m in n)n.hasOwnProperty(m)&&"function"!==typeof n[m]&&!b.defaultValueExisted(m)&&b.setDefaultValue(null,n[m],m)}}})})},"builder/dijit/template-config/Category":function(){define(["dojo/_base/declare","dojo/_base/array"],function(p,f){return p([],{name:null,title:null,includeFields:null,excludeFields:null,displayFields:null,constructor:function(b,m,l,h,r,n){this.name=m;this.title=l;this.includeFields=h;
this.excludeFields=r;this.displayFields=[];f.forEach(n,function(f){var e=b.findNode(f);e&&this.displayFields.push({fieldPath:f,fieldJson:e.getTemplateField()})},this)},hasField:function(b){var f=!1,l;for(l=0;l<this.includeFields.length;l++)if(0===b.indexOf(this.includeFields[l])){f=!0;break}for(l=0;l<this.excludeFields.length;l++)if(0===b.indexOf(this.excludeFields[l])){f=!1;break}return f},getDisplayField:function(b){b=this.findFieldFromDisplay(b);return-1!==b?this.displayFields[b]:null},findFieldFromDisplay:function(b){var f;
for(f=0;f<this.displayFields.length;f++)if(this.displayFields[f].fieldPath===b)return f;return-1},addFieldToDisplay:function(b){var f;f=this.findFieldFromDisplay(b.fieldPath);-1===f?this.displayFields.push({fieldPath:b.fieldPath,fieldJson:b.fieldJson}):this.displayFields[f].fieldJson=b.fieldJson},removeFieldFromDisplay:function(b){var f;f=this.findFieldFromDisplay(b);0<=f&&this.displayFields.splice(f,1);return b},moveup:function(b){var f;b=this.findFieldFromDisplay(b);return 0<b?(f=this.displayFields[b],
this.displayFields[b]=this.displayFields[b-1],this.displayFields[b-1]=f,!0):!1},movedown:function(b){var f;b=this.findFieldFromDisplay(b);return 0<=b&&b<this.displayFields.length-1?(f=this.displayFields[b],this.displayFields[b]=this.displayFields[b+1],this.displayFields[b+1]=f,!0):!1},displayIsEmpty:function(){return 0===this.displayFields.length},deserialize:function(b,m){this.displayFields=[];f.forEach(b,function(b){var f;f=b.fieldName.replace(/\//g,"_");(f=m.findNodeById(f))&&this.displayFields.push({fieldPath:f.absolutePath,
fieldJson:b})},this);return this.displayFields.length}})})},"builder/dijit/template-config/Export":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/dijit dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Export.html dojo/Deferred dojo/promise/all dojo/dom-style dojo/dom-attr dojo/json jimu/dijit/Message jimu/dijit/LoadingShelter builder/portalUtils ./ExportMessage jimu/dijit/Popup builder/dijit/ItemInfo builder/serviceUtils builder/PluginManager".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x){return p([l,h],{templateString:r,baseClass:"export-agoltemplate",_templateUrl:null,_temlateJson:null,_fullTemplateJson:null,pluginManager:null,_afterAddItemOfExportCallback:null,isExportWABTemplate:null,appInfo:null,constructor:function(){this.pluginManager=x.getInstance()},startup:function(){this.isExportWABTemplate?this.popupWABTemplateDlg():this.popupAGOLTemplateDlg()},popupAGOLTemplateDlg:function(a){this.isExportWABTemplate=!1;this._initToAGOLTemplateDlgPage();
this.popup=new d({content:this,container:"main-page",titleLabel:this.nls.title2,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:f.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,this._onCancelClick)}]});this.loading=new v({hidden:!0});this.loading.placeAt(this.popup.domNode)},popupWABTemplateDlg:function(){this.isExportWABTemplate=!0;this._initToWABTemplateDlgPage();this.popup=new d({content:this,container:"main-page",titleLabel:this.nls.exportPopupTitleForWab,
width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:f.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,this._onCancelClick)}]});this.loading=new v({hidden:!0});this.loading.placeAt(this.popup.domNode)},_initToAGOLTemplateDlgPage:function(){window.isXT&&(c.set(this.explain1,"innerHTML",this.nls.explain1),e.set(this.explain1,"display","block"));this.itemInfoDijit=new w({itemInfo:this.getDefaultAppInfo()});this.itemInfoDijit.placeAt(this.itemInfoBox)},
_initToWABTemplateDlgPage:function(){var a=this.getDefaultAppInfo();window.isXT&&(c.set(this.templateTitle,"innerHTML",this.nls.templateTitleForWAB),a.tags=void 0,a.folderId=void 0,a.sharing=void 0,a.thumbnail="/webappbuilder/builder/images/templatethumbnail.jpg");this.itemInfoDijit=new w({itemInfo:a});this.itemInfoDijit.placeAt(this.itemInfoBox)},getDefaultAppInfo:function(){return{name:"",description:this.nls.templateDefaultSnippet,tags:["template"],folderId:"",sharing:void 0,thumbnail:void 0}},
_onNextClick:function(){this.isExportWABTemplate?this._exportWABTemplate():this._exportAGOLTemplate()},_onCancelClick:function(){this.close()},close:function(){this.popup.close()},_exportAGOLTemplate:function(){var a=this.itemInfoDijit.getProperties();a.name&&a.tags?(this.loading.show(),this.exportAGOLTemplate(a,this._templateUrl,this._fullTemplateJson,this._afterAddItemOfExportCallback).then(f.hitch(this,function(a){this.close();this.loading.hide();k._exportedMessage(a,this.nls.exportMessageTitle,
this.nls)}),f.hitch(this,function(a){this.close();this.loading.hide();k._exportedMessage(a,this.nls.exportMessageTitle,this.nls)}))):new u({message:this.nls.noTitleMessage})},_exportWABTemplate:function(){var b=this.itemInfoDijit.getProperties();if(b.name){this.loading.show();var c=this.pluginManager.getPluginByName("app-list");this.exportWABTemplate(b,a.parse(this._fullTemplateJson),this._afterAddItemOfExportCallback).then(f.hitch(this,function(){this.close();this.loading.hide();c&&(c._onSwitchToTemplateContent(),
c.refreshTemplatePage());new d({content:this.nls.exportSuccessfulForWab,titleLabel:this.nls.exportPopupTitleForWab,width:"600",autoHeight:!0,buttons:[{label:this.nls.ok}]})}),f.hitch(this,function(){this.close();this.loading.hide()}))}else new u({message:this.nls.noTitleMessage})},exportAGOLTemplate:function(a,b,c,d){var e=new n,k=new n,h=new n,l=new n,m="http://"+window.location.host+window.location.pathname,t=m.indexOf("index.html");-1!==t&&(m=m.slice(0,t));var m=m+"builder/css/images/agoltemplate/templateThumbnail.jpg",
u=q.getPortal(window.portalUrl);u.getUser().then(f.hitch(this,function(b){var c={q:"owner:"+b.username+" title:"+a.name+' type:"Web Mapping Application"'},d=builderNls.titleExist.replace("${TITLE}",a.name);u.queryItems(c).then(f.hitch(this,function(a){0<a.total?(k.reject(),e.reject({itemId:null,message:d})):k.resolve(b)}),f.hitch(this,function(a){k.reject(a);console.error(a.message||a);e.reject({itemId:null,message:this.nls.exportTemplateFailed5})}))}),f.hitch(this,function(a){k.reject(a);console.error(a.message||
a);e.reject({itemId:null,message:this.nls.exportTemplateFailed5})}));k.then(f.hitch(this,function(g){var k={title:a.name,snippet:a.description,tags:a.tags,url:b,thumbnailurl:m,type:"Web Mapping Application",typeKeywords:"Configurable, JavaScript, selfConfigured",text:c},l="";"HTML"===window.appInfo.appType?l="WAB2D":"HTML3D"===window.appInfo.appType&&(l="WAB3D, 3Dscene");k.typeKeywords=(window.isXT?"Configurable, JavaScript, WABTemplate, WABTemplateFromXT, ":"Configurable, JavaScript, selfConfigured, WABTemplate, WABTemplateFromAGOL, ")+
l;a.folderId===g.username&&(a.folderId="");g.addItem(k,a.folderId).then(f.hitch(this,function(a){a.success?(h.resolve(a),d(a.id)):(console.error(a.message||""),h.reject(this.nls.exportTemplateFailed1))}),f.hitch(this,function(a){h.reject(a);console.error(a.message||a);e.reject({itemId:null,message:this.nls.exportTemplateFailed1})}))}));q.getTemplatesGroup(window.portalUrl).then(f.hitch(this,function(a){l.resolve(a)}),f.hitch(this,function(a){l.reject(a);console.error(a.message||a);e.reject({itemId:null,
message:this.nls.exportTemplateFailed2})}));g({user:k,itemRes:h,templateGroup:l}).then(f.hitch(this,function(b){b.user.shareItem({groups:b.templateGroup.id},b.itemRes.id,a.folderId).then(f.hitch(this,function(a){-1===a.notSharedWith.indexOf(b.templateGroup.id)?e.resolve({itemId:b.itemRes.id,message:this.nls.exportSuccessful}):e.reject({itemId:b.itemRes.id,message:this.nls.exportTemplateFailed3,type:"no_permission_to_share"})}),f.hitch(this,function(a){console.error(a.message||a);e.reject({itemId:b.itemRes.id,
message:this.nls.exportTemplateFailed4})}))}));return e},exportWABTemplate:function(a,b,c){var d=new n;a={name:a.name,description:a.description,fromAppId:this.appInfo.id,saveAsTemplate:!0,thumbnail:a.thumbnail};var e=f.clone(window.appConfig);e.templateConfig=b;delete e.isTemplateApp;t.saveAs(a,e.getCleanConfig()).then(f.hitch(this,function(a){a.success?(d.resolve(),c()):(console.error("exportWABTemplate failed: duplicateApp response's success is false"),new u({message:"Exported as web app template failed."}),
d.reject())}),f.hitch(this,function(a){console.error("exportWABTemplate failed: duplicateApp error: "+a);new u({message:"Exported as web app template failed"});d.reject()}));return d}})})},"dijit/dijit":function(){define("./main ./_base dojo/parser ./_Widget ./_TemplatedMixin ./_Container ./layout/_LayoutWidget ./form/_FormWidget ./form/_FormValueWidget".split(" "),function(p){return p})},"dijit/_base":function(){define("./main ./a11y ./WidgetSet ./_base/focus ./_base/manager ./_base/place ./_base/popup ./_base/scroll ./_base/sniff ./_base/typematic ./_base/wai ./_base/window".split(" "),
function(p){return p._base})},"dijit/WidgetSet":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","./registry"],function(p,f,b,m){var l=f("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0},add:function(b){if(this._hash[b.id])throw Error("Tried to register widget with id\x3d\x3d"+b.id+" but that id is already registered");this._hash[b.id]=b;this.length++},remove:function(b){this._hash[b]&&(delete this._hash[b],this.length--)},forEach:function(f,
l){l=l||b.global;var h=0,g;for(g in this._hash)f.call(l,this._hash[g],h++,this._hash);return this},filter:function(f,m){m=m||b.global;var h=new l,g=0,e;for(e in this._hash){var c=this._hash[e];f.call(m,c,g++,this._hash)&&h.add(c)}return h},byId:function(b){return this._hash[b]},byClass:function(b){var f=new l,h,g;for(h in this._hash)g=this._hash[h],g.declaredClass==b&&f.add(g);return f},toArray:function(){var b=[],f;for(f in this._hash)b.push(this._hash[f]);return b},map:function(b,f){return p.map(this.toArray(),
b,f)},every:function(f,l){l=l||b.global;var h=0,g;for(g in this._hash)if(!f.call(l,this._hash[g],h++,this._hash))return!1;return!0},some:function(f,l){l=l||b.global;var h=0,g;for(g in this._hash)if(f.call(l,this._hash[g],h++,this._hash))return!0;return!1}});p.forEach("forEach filter byClass map every some".split(" "),function(b){m[b]=l.prototype[b]});return l})},"dijit/_base/focus":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/topic dojo/_base/window ../focus ../selection ../main".split(" "),
function(p,f,b,m,l,h,r,n){h.focus=function(b){if(b){var e="node"in b?b.node:b,c=b.bookmark;b=b.openedForWindow;var a=c?c.isCollapsed:!1;if(e){var f="iframe"==e.tagName.toLowerCase()?e.contentWindow:e;if(f&&f.focus)try{f.focus()}catch(v){}h._onFocusNode(e)}if(c&&l.withGlobal(b||l.global,n.isCollapsed)&&!a){b&&b.focus();try{l.withGlobal(b||l.global,n.moveToBookmark,null,[c])}catch(v){}}}};h.watch("curNode",function(b,e,c){n._curFocus=c;n._prevFocus=e;c&&m.publish("focusNode",c)});h.watch("activeStack",
function(b,e,c){n._activeStack=c});h.on("widget-blur",function(b,e){m.publish("widgetBlur",b,e)});h.on("widget-focus",function(b,e){m.publish("widgetFocus",b,e)});b.mixin(n,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return n.getBookmark().isCollapsed},getBookmark:function(){return(l.global==window?r:new r.SelectionManager(l.global)).getBookmark()},moveToBookmark:function(b){return(l.global==window?r:new r.SelectionManager(l.global)).moveToBookmark(b)},getFocus:function(b,e){var c=!h.curNode||
b&&f.isDescendant(h.curNode,b.domNode)?n._prevFocus:h.curNode;return{node:c,bookmark:c&&c==h.curNode&&l.withGlobal(e||l.global,n.getBookmark),openedForWindow:e}},_activeStack:[],registerIframe:function(b){return h.registerIframe(b)},unregisterIframe:function(b){b&&b.remove()},registerWin:function(b,e){return h.registerWin(b,e)},unregisterWin:function(b){b&&b.remove()}});return n})},"dijit/_base/place":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/window","../place","../main"],function(p,
f,b,m,l){var h={getViewport:function(){return b.getBox()}};h.placeOnScreen=m.at;h.placeOnScreenAroundElement=function(b,h,g,e){var c;if(f.isArray(g))c=g;else{c=[];for(var a in g)c.push({aroundCorner:a,corner:g[a]})}return m.around(b,h,c,!0,e)};h.placeOnScreenAroundNode=h.placeOnScreenAroundElement;h.placeOnScreenAroundRectangle=h.placeOnScreenAroundElement;h.getPopupAroundAlignment=function(b,f){var g={};p.forEach(b,function(b){var c=f;switch(b){case "after":g[f?"BR":"BL"]=f?"BL":"BR";break;case "before":g[f?
"BL":"BR"]=f?"BR":"BL";break;case "below-alt":c=!c;case "below":g[c?"BL":"BR"]=c?"TL":"TR";g[c?"BR":"BL"]=c?"TR":"TL";break;case "above-alt":c=!c;default:g[c?"TL":"TR"]=c?"BL":"BR",g[c?"TR":"TL"]=c?"BR":"BL"}});return g};f.mixin(l,h);return l})},"dijit/_base/popup":function(){define(["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(p,f,b){var m=b._createWrapper;b._createWrapper=function(b){b.declaredClass||(b={_popupWrapper:b.parentNode&&p.contains(b.parentNode,"dijitPopup")?
b.parentNode:null,domNode:b,destroy:function(){},ownerDocument:b.ownerDocument,ownerDocumentBody:f.body(b.ownerDocument)});return m.call(this,b)};var l=b.open;b.open=function(b){if(b.orient&&"string"!=typeof b.orient&&!("length"in b.orient)){var f=[],h;for(h in b.orient)f.push({aroundCorner:h,corner:b.orient[h]});b.orient=f}return l.call(this,b)};return b})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(p,f){f.scrollIntoView=function(b,f){p.scrollIntoView(b,f)}})},"dijit/_base/sniff":function(){define(["dojo/uacss"],
function(){})},"dijit/_base/typematic":function(){define(["../typematic"],function(){})},"dijit/_base/wai":function(){define(["dojo/dom-attr","dojo/_base/lang","../main","../hccss"],function(p,f,b){f.mixin(b,{hasWaiRole:function(b,f){var h=this.getWaiRole(b);return f?-1<h.indexOf(f):0<h.length},getWaiRole:function(b){return f.trim((p.get(b,"role")||"").replace("wairole:",""))},setWaiRole:function(b,f){p.set(b,"role",f)},removeWaiRole:function(b,l){var h=p.get(b,"role");h&&(l?(h=f.trim((" "+h+" ").replace(" "+
l+" "," ")),p.set(b,"role",h)):b.removeAttribute("role"))},hasWaiState:function(b,f){return b.hasAttribute?b.hasAttribute("aria-"+f):!!b.getAttribute("aria-"+f)},getWaiState:function(b,f){return b.getAttribute("aria-"+f)||""},setWaiState:function(b,f,h){b.setAttribute("aria-"+f,h)},removeWaiState:function(b,f){b.removeAttribute("aria-"+f)}});return b})},"dijit/_base/window":function(){define(["dojo/window","../main"],function(p,f){f.getDocumentWindow=function(b){return p.get(b)}})},"builder/dijit/template-config/ExportMessage":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ExportMessage.html jimu/portalUrlUtils jimu/dijit/Popup".split(" "),
function(p,f,b,m,l,h,r){var n=p([b,m],{baseClass:"agol-template-export-message",templateString:l,constructor:function(){},postCreate:function(){this.inherited(arguments);"no_permission_to_share"===this.exportedInfo.type?(f.setAttr(this.word1,"innerHTML",this.nls.exportTemplateFailed31),this.exportedInfo.itemUrl&&(f.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl21),f.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl)),f.setAttr(this.word2,"innerHTML",this.nls.exportTemplateFailed32)):
(this.exportedInfo.message&&f.setAttr(this.resMessage,"innerHTML",this.exportedInfo.message),this.exportedInfo.itemUrl&&(f.setAttr(this.word1,"innerHTML",this.nls.descriptionTemplateUrl1),f.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl2),f.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl),f.setAttr(this.word2,"innerHTML",this.nls.descriptionTemplateUrl3)))}});n._exportedMessage=function(b,e,c){b.itemId&&(b.itemUrl=h.getItemDetailsPageUrl(window.portalUrl,b.itemId));b=new n({exportedInfo:b,
nls:c});new r({content:b,titleLabel:e,width:"600",autoHeight:!0,buttons:[{label:c.ok}]})};return n})},"builder/dijit/ItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/ItemInfo.html dojo/dom-style dojo/_base/lang dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w){return p([l,h,r],{templateString:g,baseClass:"dijit-item-info",postMixInProperties:function(){this.inherited(arguments);this.nls=c.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.tags.nls=this.nls;this._init(this.itemInfo)},_init:function(d){this.appName.focus();void 0===d.tags&&e.set(this.tagsTr,"display","none");void 0===d.folderId&&e.set(this.folderTr,"display","none");void 0===d.sharing&&e.set(this.sharingTr,"display",
"none");void 0===d.thumbnail&&e.set(this.thumbnailTr,"display","none");void 0!==d.tags||void 0!==d.folder?u.getPortal(v.getStandardPortalUrl(window.portalUrl)).getUser().then(c.hitch(this,function(b){var e=[];this.user=b;if(void 0!==d.folderId)e.push(this._initFolder(b));else{var f=new m;f.resolve();e.push(f)}void 0!==d.tags?e.push(n.byId("publish-webmap-tags").loadTags(b)):(b=new m,b.resolve(),e.push(b));a(e).then(c.hitch(this,function(){this.setProperties(d)}),c.hitch(this,function(a){this.setProperties(d);
console.error(a.message||a)}))}),c.hitch(this,function(a){this.setProperties(d);console.error(a.message||a)})):(void 0!==d.thumbnail&&(this.imageChooser=new w({cropImage:!0,showSelfImg:!0,format:[w.GIF,w.JPEG,w.PNG],goldenWidth:300,goldenHeight:200}),b.place(this.imageChooser.domNode,this.imageChooserBase)),this.setProperties(d))},_initFolder:function(a){var b=new m;a.getContent().then(c.hitch(this,function(d){var e=[{label:a.username,value:""}],e=e.concat(f.map(d.folders,c.hitch(this,function(a){return{label:a.title,
value:a.id}})));n.byId("publish-webmap-folder").set("options",e);n.byId("publish-webmap-folder").set("value","");b.resolve()}),function(a){console.error("get userContent error!",a.message);b.reject()});return b},setProperties:function(a){n.byId("publish-webmap-name").set("value",a.name);n.byId("publish-webmap-tags").set("tags",a.tags||[]);n.byId("publish-webmap-summary").set("value",a.description);n.byId("publish-webmap-folder").set("value",a.folderId);n.byId("publish-webmap-sharing").set("checked",
a.sharing);this.imageChooser&&this.imageChooser.setDefaultSelfSrc(a.thumbnail)},getProperties:function(){return{name:q.stripHTML(n.byId("publish-webmap-name").get("value")),tags:n.byId("publish-webmap-tags").get("tags"),description:q.stripHTML(n.byId("publish-webmap-summary").get("value")),folderId:n.byId("publish-webmap-folder").get("value"),sharing:n.byId("publish-webmap-sharing").get("checked"),thumbnail:this.imageChooser&&this.imageChooser.imageData}}})})},"builder/dijit/Tags":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/dom-construct dojo/store/Memory dojo/Deferred dojo/sniff dijit/_TemplatedMixin dijit/_WidgetBase dijit/form/TextBox ./AutoComplete dojo/text!./templates/Tags.html dojo/domReady!".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){return b([g,n],{templateString:a,baseClass:"esriAGOTags",_minWidth:"100%",_maxWidth:"100%",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._isIE8=r("ie")},startup:function(){this.inherited(arguments)},loadTags:function(a){var b=new h;this._isIE8?(this._textTags||(this.tagsId="userTags-"+(new Date).getTime(),m.create("div",{id:this.tagsId},this.domNode),this._textTags=new e({placeHolder:this.nls.addTags,
trim:!0,style:{minWidth:this._minWidth,maxWidth:this._maxWidth}},this.tagsId)),b.resolve()):a?a.getTags().then(f.hitch(this,function(a){this._handleTags(a);b.resolve()}),f.hitch(this,function(a){console.error("get user tags error: "+a);this._handleTags({tags:[]});b.resolve()})):(this._handleTags({tags:[]}),b.resolve());return b},_handleTags:function(a){if(a){this._autoComplete&&this._autoComplete.clearTags();var b=[];a.tags&&p.forEach(a.tags,f.hitch(this,function(a){b.push(a)}));this._tagStore?(this._tagStore.query({}).forEach(f.hitch(this,
function(a){this._tagStore.remove(a.tag)})),p.forEach(b,f.hitch(this,function(a){this._tagStore.add(a)}))):this._tagStore=new l({idProperty:"tag",data:b});this._autoComplete||(a=(new Date).getTime(),this.tagsId="userTags-"+a,this.gridId="grid-"+a,this.filterId="filter-"+a,m.create("div",{id:this.tagsId,className:"grid_1"},this.domNode),this._autoComplete=new c({placeholder:this.nls.addTags,noDataMsg:this.nls.noTagsFound,idProperty:"tag",gridId:this.gridId,filterId:this.filterId,minWidth:this._minWidth,
maxWidth:this._maxWidth,matchParam:"first",store:this._tagStore,style:{width:this._minWidth}},this.tagsId))}},_getUniqueTags:function(a){return p.filter(a,f.hitch(this,function(b,c){return p.indexOf(a,b)===c}))},_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},_setTagsAttr:function(a){!a||a instanceof Array||(a=a.split(","));this._isIE8?this._textTags&&this._textTags.set("value",this._getUniqueTags(a).join(",")):this._autoComplete&&(this._autoComplete.clearTags(),
this._autoComplete.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):"":this._autoComplete&&this._autoComplete.values?this._autoComplete.values.join(","):""},_setMinWidthAttr:function(a){this._minWidth=a},_setMaxWidthAttr:function(a){this._maxWidth=a}})})},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(p,f,b){return p("dojo.store.Memory",null,{constructor:function(b){for(var f in b)this[f]=
b[f];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:b,get:function(b){return this.data[this.index[b]]},getIdentity:function(b){return b[this.idProperty]},put:function(b,f){var h=this.data,l=this.index,m=this.idProperty,m=b[m]=f&&"id"in f?f.id:m in b?b[m]:Math.random();if(m in l){if(f&&!1===f.overwrite)throw Error("Object already exists");h[l[m]]=b}else l[m]=h.push(b)-1;return m},add:function(b,f){(f=f||{}).overwrite=!1;return this.put(b,f)},remove:function(b){var f=
this.index,h=this.data;if(b in f)return h.splice(f[b],1),this.setData(h),!0},query:function(b,l){return f(this.queryEngine(b,l)(this.data))},setData:function(b){b.items?(this.idProperty=b.identifier||this.idProperty,b=this.data=b.items):this.data=b;this.index={};for(var f=0,h=b.length;f<h;f++)this.index[b[f][this.idProperty]]=f}})})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(p){return function(f,b){function m(h){h=p.filter(h,f);var l=b&&b.sort;l&&h.sort("function"==
typeof l?l:function(b,e){for(var c,a=0;c=l[a];a++){var f=b[c.attribute],g=e[c.attribute],f=null!=f?f.valueOf():f,g=null!=g?g.valueOf():g;if(f!=g)return!!c.descending==(null==f||f>g)?-1:1}return 0});if(b&&(b.start||b.count)){var m=h.length;h=h.slice(b.start||0,(b.start||0)+(b.count||Infinity));h.total=m}return h}switch(typeof f){default:throw Error("Can not query with a "+typeof f);case "object":case "undefined":var l=f;f=function(b){for(var f in l){var h=l[f];if(h&&h.test){if(!h.test(b[f],b))return!1}else if(h!=
b[f])return!1}return!0};break;case "string":if(!this[f])throw Error("No filter function "+f+" was found in store");f=this[f];case "function":}m.matches=f;return m}})},"builder/dijit/AutoComplete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/window dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/html dojo/json dojo/keys dojo/on dojo/query dojo/request dojo/string dijit/focus dijit/form/TextBox dijit/registry dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard dojo/NodeList-traverse dojo/NodeList-manipulate".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B){return f([y,x,A],{_attachmentNode:"",_autocompleteList:"",_grid:"",_store:"",_matchParam:"",_idProperty:"",_gridId:"",_filterId:"",_placeHolder:"",_noDataMsg:"",_maxWidth:"",_minWidth:"",_inputTextBox:"",_gridHasFocus:!1,_metaKeyPressed:!1,_shiftKeyPressed:!1,_CSS_STYLES:{CLASS_SELECTOR:".",ALL_SELECTOR:"\x3e",MULTI:"select2-container select2-container-multi",CHOICES:"select2-choices",CHOICE:"select2-search-choice",SEARCH_CHOICE_FOCUS:"select2-search-choice-focus",
SEARCH_FIELD:"select2-search-field",CLOSE_ICON:"select2-search-choice-close"},values:[],_selRows:[],_CHOICE_SELECTOR:"",_CHOICE_FOCUS:"",_CHOICE_FOCUS_ALL:"",constructor:function(a,b){this._attachmentNode=b;this._idProperty=a.idProperty;this._gridId=a.gridId;this._filterId=a.filterId;this._store=a.store;this._placeHolder=a.placeholder;this._noDataMsg=a.noDataMsg;this._maxWidth=a.maxWidth;this._minWidth=a.minWidth;this._matchParam=a.matchParam;this.values=[];this._selRows=[];this._CHOICE_ALL_SELECTOR=
this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE+this._CSS_STYLES.ALL_SELECTOR;this._CHOICE_FOCUS=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.SEARCH_CHOICE_FOCUS;this._CHOICE_FOCUS_ALL=this._CHOICE_FOCUS+this._CSS_STYLES.ALL_SELECTOR},buildRendering:function(){this._createContainerNode();this._createTagList();this._createDropDownList();this._createInput();var a=b.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";if(1>b.length)return!0;if(!a.tag)return!1;
a=(a.tag+"").toLowerCase().match(new RegExp("^"+b.toLowerCase()));return null!==a&&0<a.length?!0:!1}),c=b.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";return 1>b.length?!0:a.tag?~(a.tag+"").toLowerCase().indexOf(b.toLowerCase())?!0:!1:!1}),d=[{field:this._idProperty}],e=[{attribute:this._idProperty,ascending:!0}];this._grid=new (f([z,C,B]))({store:this._store,showHeader:!1,noDataMessage:this._noDataMsg,selectionMode:"extended",allowSelectAll:!0,cellNavigation:!1,
columns:d,sort:e,renderRow:this._renderItem},this._gridId);r.add(this._gridId,"gridHeightLimiter");this._grid.query="first"===this._matchParam?a:c},postCreate:function(){var a;this._inputTextBox.watch("value",b.hitch(this,function(b,c,d){a&&(clearTimeout(a),a=null);this._grid.refresh()}));this._grid.on(".dgrid-row:click",b.hitch(this,function(a){var b="";this._shiftKeyPressed||this._metaKeyPressed?a.shiftKey||a.metaKey||a.ctrlKey||(b=this._selRows[0],this._createTags(b),this._store.remove(b),this._grid.refresh(),
this._resetInputTextBox()):(b=this._grid.row(a).data.tag,this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox())}));this._grid.on("dgrid-deselect",b.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this._grid.on("dgrid-select",b.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this.connect(this.domNode,"keydown","_keydownHandler");window.onkeydown=b.hitch(this,function(a){if(a.shiftKey||
a.ctrlKey||224===a.keyCode)this._metaKeyPressed=!0});this.connect(document,"onkeydown",b.hitch(this,function(a){this._metaKeyPressed=this._shiftKeyPressed=!0}))},_keydownHandler:function(c){var e;void 0!==d.curNode.value&&(e=d.curNode.value.length);var f=v(this._CHOICE_FOCUS,l.byId(this.id)),h=v(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,l.byId(this.id)).last();switch(c.keyCode){case a.RIGHT_ARROW:this._navigate(f,e,h,"right");this._hideGrid();break;case a.LEFT_ARROW:this._navigate(f,
e,h,"left");this._hideGrid();break;case a.DOWN_ARROW:c.preventDefault();this._unhighlightTag(f);"none"===g.get(this._gridId,"display")&&this._showGrid();this._gridHasFocus||(this._grid.focus(this._setFocusOnFirstRow(this._grid,0)),this._gridHasFocus=!0);break;case a.UP_ARROW:break;case a.BACKSPACE:var m;if(0===e&&0===v(this._CHOICE_FOCUS_ALL).length&&void 0!==v(this._CHOICE_ALL_SELECTOR)[v(this._CHOICE_ALL_SELECTOR).length-1]&&(m=v(this._CHOICE_ALL_SELECTOR)[v(this._CHOICE_ALL_SELECTOR).length-1].title,
0<v("li",this._attachmentNode).length&&(n.destroy(h[0]),void 0!==m)))try{this._store.add({tag:m})}catch(Q){}if(0<v(this._CHOICE_FOCUS_ALL).length&&(m=v(this._CHOICE_FOCUS_ALL).text(),n.destroy(f[0]),void 0!==m))try{this._store.add({tag:m})}catch(Q){}this._grid.refresh();0===e&&this._hideGrid();this._removeTag(m);break;case a.CTRL:this._metaKeyPressed=!0;break;case a.META:this._metaKeyPressed=!0;break;case a.SHIFT:this._shiftKeyPressed=!0;break;case a.ENTER:if(0<e){e=d.curNode.value;e=e.split(",");
var q=[];p.forEach(e,function(a,b){-1===p.indexOf(q,a)&&q.push(k.trim(a))});p.forEach(q,b.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}))}else{for(e=0;e<this._selRows.length;e++)this._createTags(this._selRows[e]),this._store.remove(this._selRows[e]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();c.preventDefault();d.focus(l.byId(this._filterId));break;case a.TAB:if(d.curNode.id!==this._filterId||0!==e){if(0<e)e=d.curNode.value,
e=e.split(","),q=[],p.forEach(e,function(a,b){-1===p.indexOf(q,a)&&q.push(k.trim(a))}),p.forEach(q,b.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(e=0;e<this._selRows.length;e++)this._createTags(this._selRows[e]),this._store.remove(this._selRows[e]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();c.preventDefault();d.focus(l.byId(this._filterId))}break;case a.ESCAPE:this._hideGrid();break;default:-1<e&&("none"===g.get(l.byId(this._gridId),
"display")&&this._showGrid(),this._unhighlightTag(f)),this._metaKeyPressed=!1}},_blurHandler:function(a,c,d){if(!this.focused){if(0<this._inputTextBox.value.length){var e=[];a=this._inputTextBox.value.split(",");p.forEach(a,function(a,b){-1===p.indexOf(e,a)&&e.push(k.trim(a))});p.forEach(e,b.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));this._resetInputTextBox()}this._hideGrid()}},_resetInputTextBox:function(){t.byId(this._filterId).set("value","")},
_isEmpty:function(a){a=a.replace(/^\s+|\s+$/,"");return 0===a.length?!0:!1},_navigate:function(a,b,c,d){0<a.length&&1>b?("right"===d?this._hightlightTag(a.next()):this._hightlightTag(a.prev()),this._unhighlightTag(a)):1>b&&this._hightlightTag(c)},_contains:function(a,b){return 0<=p.indexOf(a,b)},_hightlightTag:function(a){a.addClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_unhighlightTag:function(a){a.removeClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_removeTag:function(a){a&&-1!==p.indexOf(this.values,
a)&&this.values.splice(p.indexOf(this.values,a),1)},_hideGrid:function(){l.byId(this._gridId)&&g.set(l.byId(this._gridId),"display","none");this._gridHasFocus=!1},_showGrid:function(){g.set(l.byId(this._gridId),"display","block");var a=g.get(l.byId(this._attachmentNode),"width");g.set(l.byId(this._gridId),"width",a+"px")},_setFocusOnFirstRow:function(a,b){return v(".dgrid-content .dgrid-cell",this._grid.domNode)[b]||v(".dgrid-content .dgrid-row",this._grid.domNode)[b]},_createTags:function(a){v(this._CHOICE_FOCUS,
l.byId(this.id)).removeClass("select2-search-choice-focus");var c=n.create("li",null,this._autocompleteList);r.add(c,this._CSS_STYLES.CHOICE);c=n.create("div",{title:a},c);e.set(c,this.htmlEncode(a));c=n.create("a",{href:"#"},c);r.add(c,this._CSS_STYLES.CLOSE_ICON);u(c,"click",b.hitch(this,function(a){var b=a.target.parentElement.innerText||a.target.parentElement.textContent;try{this._store.add({tag:b})}catch(L){}this._grid.refresh();this._removeTag(b);n.destroy(a.target.parentNode.parentNode);a.preventDefault()}));
c=t.byId(this._filterId);n.place(c.domNode,this._autocompleteList,"last");this._hideGrid();this.values.push(a)},_renderItem:function(a){return n.create("div",{innerHTML:a.tag})},_createContainerNode:function(){this.domNode=n.create("div",null,this._attachmentNode);r.add(this.domNode,this._CSS_STYLES.MULTI);g.set(this.domNode,"maxWidth",this._maxWidth);g.set(this.domNode,"minWidth",this._minWidth)},_createTagList:function(){this._autocompleteList=n.create("ul",null,this.domNode);r.add(this._autocompleteList,
this._CSS_STYLES.CHOICES)},_createInput:function(){var a=n.create("li",null,this._autocompleteList,"last");r.add(a,this._CSS_STYLES.SEARCH_FIELD);this._inputTextBox=new w({id:this._filterId,placeHolder:this._placeHolder,intermediateChanges:!0,trim:!0,style:{border:"none"}},a);r.add(this._inputTextBox,"inputTextBox");g.set(this._inputTextBox,"width",this._minWidth);d.watch("curNode",b.hitch(this,this._blurHandler))},_createDropDownList:function(){var a=n.create("div",{id:this._gridId},this.domNode);
r.add(a,"dropDownList");g.set(a,"width",this._minWidth)},prepopulate:function(a){p.forEach(a,b.hitch(this,function(a,b){this._createTags(a);this._store.remove(a)}))},clearTags:function(){var a=v(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,l.byId(this.id));0<a.length&&(p.forEach(a,b.hitch(this,function(a,b){try{this._store.add({tag:v(this._CHOICE_ALL_SELECTOR,l.byId(this.id))[0].title})}catch(J){}n.destroy(a)})),this.values=[])},addStyledTags:function(a,b){r.add(l.byId(b),this._CSS_STYLES.MULTI);
var c=n.create("ul",null,l.byId(b));r.add(c,this._CSS_STYLES.CHOICES);g.set(c,"border","none");p.forEach(a,function(a,b){var d=n.create("li",null,c);g.set(d,"padding","3px 5px 3px 5px");r.add(d,"select2-search-resultSet");d=n.create("div",{title:a},d);e.set(d,a)})},htmlEncode:function(a){return a?a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;"):a}})})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(p,
f,b){return p("dgrid.OnDemandGrid",[f,b],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(p,f,b,m,l,h,r){function n(b,a){a&&a.nodeType&&b.appendChild(a)}function g(b,a,e,f){if(this.formatter){f=this.formatter;var c=this.grid.formatterScope;e.innerHTML="string"===typeof f&&c?c[f](a,b):this.formatter(a,b)}else null!=a&&e.appendChild(document.createTextNode(a))}var e=8>m("ie")&&!m("quirks");
f=f("dgrid.Grid",h,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(b){return"object"!=typeof b?this.columns[b]:this.cell(b).column},listType:"grid",cell:function(b,a){if(b.column&&b.element)return b;b.target&&b.target.nodeType&&(b=b.target);var c;if(b.nodeType){do{if(this._rowIdToObject[b.id])break;var e=b.columnId;if(e){a=e;c=b;break}b=b.parentNode}while(b&&b!=this.domNode)}if(!c&&"undefined"!=typeof a){var f=this.row(b);if(e=f&&f.element)for(var e=e.getElementsByTagName("td"),
g=0;g<e.length;g++)if(e[g].columnId==a){c=e[g];break}}if(null!=b)return{row:f||this.row(b),column:a&&this.column(a),element:c}},createRowCells:function(b,a,f,g){var c=l("table.dgrid-row-table[role\x3dpresentation]"),k=9>m("ie")||m("quirks")?l(c,"tbody"):c,d,h,t,n,u,v,p,C,B,E;f=f||this.subRows;h=0;for(t=f.length;h<t;h++)for(v=f[h],d=l(k,"tr"),v.className&&l(d,"."+v.className),n=0,u=v.length;n<u;n++){p=v[n];C=p.id;B=p.field?".field-"+r.escapeCssIdentifier(p.field,"-"):"";(E="function"===typeof p.className?
p.className(g):p.className)&&(B+="."+E);B=l(b+(".dgrid-cell.dgrid-cell-padding"+(C?".dgrid-column-"+r.escapeCssIdentifier(C,"-"):"")+B.replace(/ +/g,"."))+"[role\x3d"+("th"===b?"columnheader":"gridcell")+"]");B.columnId=C;e?(C=l(B,"!dgrid-cell-padding div.dgrid-cell-padding"),B.contents=C):C=B;if(E=p.colSpan)B.colSpan=E;if(E=p.rowSpan)B.rowSpan=E;a(C,p);d.appendChild(B)}return c},left:function(b,a){b.element||(b=this.cell(b));return this.cell(this._move(b,-(a||1),"dgrid-cell"))},right:function(b,
a){b.element||(b=this.cell(b));return this.cell(this._move(b,a||1,"dgrid-cell"))},renderRow:function(b,a){var c=this.createRowCells("td",function(c,e){var f=b;e.get?f=e.get(b):"field"in e&&"_item"!=e.field&&(f=f[e.field]);e.renderCell?n(c,e.renderCell(b,f,c,a)):g.call(e,b,f,c,a)},a&&a.subRows,b);return l("div[role\x3drow]\x3e",c)},renderHeader:function(){var c=this,a=this.headerNode,f=a.childNodes.length;for(a.setAttribute("role","row");f--;)l(a.childNodes[f],"!");f=this.createRowCells("th",function(a,
b){var c=b.headerNode=a;e&&(a=a.parentNode);var d=b.field;d&&(a.field=d);b.renderHeaderCell?n(c,b.renderHeaderCell(c)):("label"in b||b.field)&&c.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&d&&"_item"!=d&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[f.id=this.id+"-header"]=this.columns;a.appendChild(f);this._sortListener&&this._sortListener.remove();this._sortListener=b(f,"click,keydown",function(e){if("click"==
e.type||32==e.keyCode||!m("opera")&&13==e.keyCode){var f=e.target,g,d,h;do if(f.sortable){h=[{attribute:g=f.field||f.columnId,descending:(d=c._sort[0])&&d.attribute==g&&!d.descending}];g={bubbles:!0,cancelable:!0,grid:c,parentType:e.type,sort:h};b.emit(e.target,"dgrid-sort",g)&&(c._sortNode=f,c.set("sort",h));break}while((f=f.parentNode)&&f!=a)}})},resize:function(){var b=this.headerNode.firstChild,a=this.contentNode,e;this.inherited(arguments);if(!m("ie")||7<m("ie")&&!m("quirks"))a.style.width="",
a&&b&&(e=b.offsetWidth)!=a.offsetWidth&&(a.style.width=e+"px")},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(b,a){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(b){var a=this.columns,c;for(c in a){var e=a[c];if(e.field==b)return e.headerNode}},updateSortArrow:function(b,a){this._lastSortedArrow&&(l(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),l(this._lastSortedArrow,
"!"),delete this._lastSortedArrow);a&&(this._sort=b);if(b[0]){var c=b[0].attribute,e=b[0].descending,c=this._sortNode||this._findSortArrowParent(c),f;delete this._sortNode;c&&(c=c.contents||c,f=this._lastSortedArrow=l("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),f.innerHTML="\x26nbsp;",c.insertBefore(f,c.firstChild),l(c,e?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(b,a){return this.addCssRule("#"+r.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+r.escapeCssIdentifier(b,
"-"),a)},_configColumns:function(b,a){var c=[],e=a instanceof Array;r.each(a,function(f,g){"string"==typeof f&&(a[g]=f={label:f});e||f.field||(f.field=g);g=f.id=f.id||(isNaN(g)?g:b+g);this._configColumn&&(this._configColumn(f,g,a,b),g=f.id);e&&(this.columns[g]=f);f.grid=this;"function"===typeof f.init&&f.init();c.push(f)},this);return e?a:c},_destroyColumns:function(){var b=this.subRows,a=b&&b.length,e,f,g,k;this.cleanup();for(e=0;e<a;e++)for(f=0,k=b[e].length;f<k;f++)g=b[e][f],"function"===typeof g.destroy&&
g.destroy()},configStructure:function(){var b=this.subRows,a=this._columns=this.columns;this.columns=!a||a instanceof Array?{}:a;if(b)for(a=0;a<b.length;a++)b[a]=this._configColumns(a+"-",b[a]);else this.subRows=[this._configColumns("",a)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(b){this._destroyColumns();this.subRows=null;this.columns=b;this._updateColumns()},_setSubRows:function(b){this._destroyColumns();this.subRows=b;this._updateColumns()},setColumns:function(b){p.deprecated("setColumns(...)",
'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",b)},setSubRows:function(b){p.deprecated("setSubRows(...)",'use set("subRows", ...) instead',"dgrid 0.4");this.set("subRows",b)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});f.appendIfNode=n;f.defaultRenderCell=g;return f})},"put-selector/put":function(){(function(p){var f,
b=/[-+,> ]/;p([],f=function(m,l){function h(c){function a(){d&&k&&d!=k&&(k==c&&(f||(f=b.test(A)&&m.createDocumentFragment()))?f:k).insertBefore(d,q||null)}for(var f,l,q,k,d,r=arguments,t=r[0],x=0;x<r.length;x++){var A=r[x];if("object"==typeof A){l=!1;if(A instanceof Array){d=m.createDocumentFragment();for(var y=0;y<A.length;y++)d.appendChild(h(A[y]));A=d}if(A.nodeType)d=A,a(),k=A,q=0;else for(y in A)d[y]=A[y]}else if(l)l=!1,d.appendChild(m.createTextNode(A));else{1>x&&(c=null);l=!0;if(t=A.replace(p,
function(b,f,l,t,u,p){f&&(a(),"-"==f||"+"==f?(k=(q=d||k).parentNode,d=null,"+"==f&&(q=q.nextSibling)):("\x3c"==f?k=d=(d||k).parentNode:(","==f?k=c:d&&(k=d),d=null),q=0),d&&(k=d));if((b=!l&&t)||!d&&(l||u))"$"==b?(b=r[++x],k.appendChild(m.createTextNode(b))):(b=b||h.defaultTag,(f=e&&r[x+1]&&r[x+1].name)&&(b="\x3c"+b+' name\x3d"'+f+'"\x3e'),d=g&&~(n=b.indexOf("|"))?m.createElementNS(g[b.slice(0,n)],b.slice(n+1)):m.createElement(b));if(l)if("$"==t&&(t=r[++x]),"#"==l)d.id=t;else if(f=(b=d.className)&&
(" "+b+" ").replace(" "+t+" "," "),"."==l)d.className=b?(f+t).substring(1):t;else if("!"==A){var v;e?h("div",d,"\x3c").innerHTML="":(v=d.parentNode)&&v.removeChild(d)}else f=f.substring(1,f.length-1),f!=b&&(d.className=f);u&&("$"==p&&(p=r[++x]),"style"==u?d.style.cssText=p:(l="!"==u.charAt(0)?(u=u.substring(1))&&"removeAttribute":"setAttribute",p=""===p?u:p,g&&~(n=u.indexOf("|"))?d[l+"NS"](g[u.slice(0,n)],u.slice(n+1),p):d[l](u,p)));return""}))throw new SyntaxError("Unexpected char "+t+" in "+A);
a();k=t=d||k}}c&&f&&c.appendChild(f);return t}b=l||b;var p=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,n,g=!1;m=m||document;var e="object"==typeof m.createElement;h.addNamespace=function(b,a){m.createElementNS?(g||(g={}))[b]=a:m.namespaces.add(b,a)};h.defaultTag="div";h.forDocument=f;return h})})(function(p,f,b){b=b||f;"function"===typeof define?define([],function(){return b()}):"undefined"==typeof window?require("./node-html")(module,b):put=
b()})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),function(p,f,b,m,l,h,r,n,g){function e(a,b){g(document.body,a,".dgrid-scrollbar-measure");var c=a["offset"+b]-a["client"+b];a.className="";document.body.removeChild(a);return c}function c(a){var b=a?"."+a.replace(w,"."):"";this._class&&(b="!"+this._class.replace(w,"!")+
b);g(this.domNode,b);this._class=a}function a(){return this._class}function u(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function v(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)}n("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var q,k;l.add("dom-scrollbar-width",function(a,b,c){return e(c,"Width")});l.add("dom-scrollbar-height",function(a,b,c){return e(c,"Height")});l.add("dom-rtl-scrollbar-left",
function(a,b,c){a=g("div");g(document.body,c,".dgrid-scrollbar-measure[dir\x3drtl]");g(c,a);b=!!l("ie")||!!l("trident")||a.offsetLeft>=l("dom-scrollbar-width");c.className="";document.body.removeChild(c);g(a,"!");c.removeAttribute("dir");return b});var d=0,w=/ +/g,t=7>l("ie")&&!l("quirks")?function(){var a,b,c;this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a)&&(this.resize(),this._prevWinDims=[b,a])}:function(){this._started&&this.resize()};
return f("dgrid.List",l("touch")?r:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,shouldObserveStore:!0,cleanEmptyObservers:!0,highlightDuration:250,postscript:function(a,b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(a,b){var e=
this.domNode=b||g("div"),k;a?(this.params=a,f.safeMixin(this,a),k=a["class"]||a.className||e.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=e.id=e.id||this.id||"dgrid_"+d++;null===this.useTouchScroll&&(this.useTouchScroll=!l("dom-scrollbar-width"));this.buildRendering();k&&c.call(this,k);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&
this.startup()},buildRendering:function(){var a=this.domNode,b=this.addUiClasses,c=this,d,e,f,k;k=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";g(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(b?".ui-widget":""));d=this.headerNode=g(a,"div.dgrid-header.dgrid-header-row"+(b?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(l("quirks")||8>l("ie"))&&g(a,"div.dgrid-spacer");e=this.bodyNode=g(a,"div.dgrid-scroller");
l("ff")&&(e.tabIndex=-1);this.headerScrollNode=g(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(b?".ui-widget-header":""));f=this.footerNode=g("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));g(a,f);k&&(a.className+=" dgrid-rtl"+(l("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));m(e,"scroll",function(b){c.showHeader&&(d.scrollLeft=b.scrollLeft||e.scrollLeft);b.stopPropagation();m.emit(a,"scroll",{scrollTarget:e})});this.configStructure();this.renderHeader();this.contentNode=
this.touchNode=g(this.bodyNode,"div.dgrid-content"+(b?".ui-widget-content":""));this._listeners.push(this._resizeHandle=m(window,"resize",h.throttleDelayed(t,this)))},postCreate:l("touch")?function(){this.useTouchScroll&&this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,b=this.headerNode,c=this.footerNode,d=b.offsetHeight,
e=this.showFooter?c.offsetHeight:0,f=l("quirks")||7>l("ie");this.headerScrollNode.style.height=a.style.marginTop=d+"px";a.style.marginBottom=e+"px";f&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-d-e,0)+"px",e&&(c.style.bottom="1px",setTimeout(function(){c.style.bottom=""},0)));q||(q=l("dom-scrollbar-width"),k=l("dom-scrollbar-height"),l("ie")&&(q++,k++),h.addCssRule(".dgrid-scrollbar-width","width: "+q+"px"),h.addCssRule(".dgrid-scrollbar-height","height: "+k+"px"),17==q||
f||(h.addCssRule(".dgrid-header-row","right: "+q+"px"),h.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+q+"px")));f&&(b.style.width=a.clientWidth+"px",setTimeout(function(){b.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,b){var c=h.addCssRule(a,b);this.cleanAddedRules&&this._listeners.push(c);return c},on:function(a,b){var c=m(this.domNode,a,b);l("dom-addeventlistener")||this._listeners.push(c);return c},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=
this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();g(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";
this.scrollTo({x:0,y:0})},newRow:function(a,b,c,d,e){if(b){var f=this.insertRow(a,b,c,d,e);g(f,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){g(f,"!dgrid-highlight!ui-state-highlight")},this.highlightDuration);return f}},adjustRowIndices:function(a){var b=a.rowIndex;if(-1<b){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&g(a,"."+(1==b%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==b%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=
b++);while((a=a.nextSibling)&&a.rowIndex!=b)}},renderArray:function(a,c,d){function e(){var b=arguments;if(-1<n)for(var c=0;c<b.length;c++){var e=b[c],g=q[e?0:q.length-1];if(g=g&&f(g)){var k=g[e?"previousSibling":"nextSibling"];k&&(k=h.row(k));k&&k.element!=g&&(e=e?"unshift":"push",a[e](k.data),q[e](k.element),d.count++)}}}function f(a){return!b.isDescendant(a,h.domNode)&&document.getElementById(a.id)?h.row(a.id.slice(h.id.length+5)).element:a}function g(a){v=h.insertRow(a,p,null,l++,d);v.observerIndex=
n;return v}function k(a){r=a.slice(0);(t=c?c.parentNode:h.contentNode)&&t.parentNode&&(t!==h.contentNode||a.length)?(t.insertBefore(p,c||null),(v=a[a.length-1])&&h.adjustRowIndices(v)):m[n]&&h.cleanEmptyObservers&&"undefined"!==typeof n&&(m[n].cancel(),m[n]=0,h._numObservers--);q=a;u&&(u.rows=q)}d=d||{};var h=this,l=d.start||0,m=this.observers,q,t,n;c||(this._lastCollection=a);if(a.observe&&this.shouldObserveStore){h._numObservers++;var u=a.observe(function(b,g,k){var l,m,u;-1<g&&q[g]&&(l=q.splice(g,
1)[0],l.parentNode==t&&((m=l.nextSibling)&&g!=k&&m.rowIndex--,h.removeRow(l)),d.count--,h._processScroll&&h._processScroll());if(-1<k){if(q.length)if(0===k)u=(u=q[k])&&f(u);else{if(u=q[k-1])u=f(u),u=(u.connected||u).nextSibling}else u=h._getFirstRowSibling&&h._getFirstRowSibling(t);l&&u&&l.id===u.id&&(u=(u.connected||u).nextSibling);u&&!u.parentNode&&(u=document.getElementById(u.id));l=c&&c.parentNode||u&&u.parentNode||h.contentNode;if(l=h.newRow(b,l,u,d.start+k,d))if(l.observerIndex=n,q.splice(k,
0,l),!m||k<g)m=(m=l.previousSibling)&&m.rowIndex+1!=l.rowIndex&&0!=l.rowIndex?m:l;d.count++}0===g?e(1,1):g===a.length-(-1===k?0:1)&&e(0,0);g!=k&&m&&h.adjustRowIndices(m);h._onNotification(q,b,g,k)},!0);n=m.push(u)-1}var p=document.createDocumentFragment(),v,r;if(a.map){if(q=a.map(g,console.error),q.then)return a.then(function(b){a=b;return q.then(function(a){k(a);e(1,1,0,0);return r})})}else{q=[];for(var w=0,x=a.length;w<x;w++)q[w]=g(a[w])}k(q);e(1,1,0,0);return r},_onNotification:function(a,b,c,
d){},renderHeader:function(){},_autoId:0,insertRow:function(a,b,c,d,e){var f=e.parentId,f=this.id+"-row-"+(f?f+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),g=document.getElementById(f),k=g&&g.previousSibling;g&&(g===c&&(c=(c.connected||c).nextSibling),this.removeRow(g));g=this.renderRow(a,e);g.className=(g.className||"")+" dgrid-row "+(1==d%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[g.id=f]=a;b.insertBefore(g,
c||null);k&&this.adjustRowIndices(k);g.rowIndex=d;return g},renderRow:function(a,b){return g("div",""+a)},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||g(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):
(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,d){var e,f;f=e=a.element;b=b||1;do if(a=e[0>b?"previousSibling":"nextSibling"]){do if((e=a)&&-1<(e.className+" ").indexOf(c+" ")){f=e;b+=0>b?1:-1;break}while(a=(!d||!e.hidden)&&e[0>b?"lastChild":"firstChild"])}else if(e=e.parentNode,!e||e===this.bodyNode||e===this.headerNode)break;while(b);return f},up:function(a,b,c){a.element||
(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:l("touch")?function(a){return this.useTouchScroll?this.inherited(arguments):v.call(this,a)}:v,getScrollPosition:l("touch")?function(){return this.useTouchScroll?this.inherited(arguments):u.call(this)}:u,get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,
1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:a,_setClass:c,_getClassName:a,_setClassName:c,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,
d){var e=c[a],f=d[a];void 0===e&&(e="");void 0===f&&(f="");return e==f?0:e>f==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){p.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;g(b,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){p.deprecated("setShowHeader(...)",
'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;g(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(p,f){p.add("dom-contains",function(b,e,c){return!!c.contains});var b=[],m,l,h,r=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,n={defaultDelay:15,throttle:function(b,e,c){var a=!1;c=c||n.defaultDelay;return function(){a||(a=!0,b.apply(e,arguments),
setTimeout(function(){a=!1},c))}},throttleDelayed:function(b,e,c){var a=!1;c=c||n.defaultDelay;return function(){if(!a){a=!0;var f=arguments;setTimeout(function(){a=!1;b.apply(e,f)},c)}}},debounce:function(b,e,c){var a;c=c||n.defaultDelay;return function(){a&&(clearTimeout(a),a=null);var f=arguments;a=setTimeout(function(){b.apply(e,f)},c)}},each:function(b,e,c){var a,f;if(b)if("number"===typeof b.length)for(a=0,f=b.length;a<f;a++)e.call(c,b[a],a,b);else for(a in b)e.call(c,b[a],a,b)},contains:function(b,
e){return p("dom-contains")?b.contains(e):b.compareDocumentPosition(e)&8},addCssRule:function(g,e){m||(m=f(document.getElementsByTagName("head")[0],"style"),m=m.sheet||m.styleSheet,l=m.deleteRule?"deleteRule":"removeRule",h=m.cssRules?"cssRules":"rules");var c=b.length;b[c]=(m.cssRules||m.rules).length;m.addRule?m.addRule(g,e):m.insertRule(g+"{"+e+"}",b[c]);return{get:function(a){return m[h][b[c]].style[a]},set:function(a,e){"undefined"!==typeof b[c]&&(m[h][b[c]].style[a]=e)},remove:function(){var a=
b[c],e,f;if(void 0!==a)for(m[l](a),b[c]=void 0,e=c+1,f=b.length;e<f;e++)b[e]>a&&b[e]--}}},escapeCssIdentifier:function(b,e){return"string"===typeof b?b.replace(r,e||"\\$1"):b}};return n})},"xstyle/has-class":function(){define(["dojo/has"],function(p){var f={};return function(){for(var b,m=arguments,l=0;l<m.length;l++)if(b=m[l],!f[b]){f[b]=!0;var h=b.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),r=p(h[2]),n=-h[4];(0<n?n<=r&&(-h[5]||n)>=r:!!r)==!h[1]&&(document.documentElement.className+=" has-"+b)}}})},
"xstyle/css":function(){define(["require"],function(p){function f(b,f,l){var h=document.documentElement;b=h.insertBefore(document.createElement(b),h.firstChild);b.id=f;f=(b.currentStyle||getComputedStyle(b,null)||{})[l];h.removeChild(b);return f}return{load:function(b,m,l,h){function r(b){var a=f("x-parse",null,"content"),c=b&&(b.sheet||b.styleSheet);a&&"none"!=a&&"normal"!=a?m([eval(a)],function(a){b?a.process(b,l):(a.processAll(),l(c))}):l(c)}var n=m.toUrl(b),g;n.match(/!$/)&&(g={wait:!1},n=n.slice(0,
-1));var e=m.cache&&m.cache["url:"+n];if(e)e.xCss&&(e=e.cssText),p(["./core/load-css"],function(b){r(b.insertCss(e))});else{if("none"==f("div",b.replace(/\//g,"-").replace(/\..*/,"")+"-loaded","display"))return r();p(["./core/load-css"],function(b){b(n,r,g)})}}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(p,f,b,m,l,h,r,n,g){return b("dgrid.OnDemandList",[p,
f],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:n.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var b=this;r(this.bodyNode,"scroll",n[this.pagingMethod](function(c){b._processScroll(c)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(b,c){function a(a){g(p,
"!");if(a)throw e._refreshDeferred&&(e._refreshDeferred.reject(a),delete e._refreshDeferred),a;}var e=this,f=c&&c.container||this.contentNode,h={query:b,count:0,options:c},k,d=this.preload,n,t={node:g(f,"div.dgrid-preload",{rowIndex:0}),count:0,query:b,next:h,options:c};t.node.style.height="0";h.node=k=g(f,"div.dgrid-preload");h.previous=t;k.rowIndex=this.minRowsPerPage;d?((h.next=d.next)&&k.offsetTop>=d.node.offsetTop?h.previous=d:(h.next=d,h.previous=d.previous),h.previous.next=h,h.next.previous=
h):this.preload=h;var p=g(k,"-div.dgrid-loading");g(p,"div.dgrid-below").innerHTML=this.loadingMessage;c=m.mixin(this.get("queryOptions"),c,{start:0,count:this.minRowsPerPage},"level"in b?{queryLevel:b.level}:null);this._trackError(function(){return n=b(c)});if("undefined"===typeof n)a();else return l.when(e.renderArray(n,k,c),function(b){return l.when("undefined"===typeof n.total?n.length:n.total,function(a){var d=b.length,f=k.parentNode,l=e.noDataNode;g(p,"!");"queryLevel"in c||(e._total=a);0===
a&&f&&(l&&(g(l,"!"),delete e.noDataNode),e.noDataNode=l=g("div.dgrid-no-data"),f.insertBefore(l,e._getFirstRowSibling(f)),l.innerHTML=e.noDataMessage);for(l=f=0;l<d;l++)f+=e._calcRowHeight(b[l]);d&&f&&(e.rowHeight=f/d);f=e.rowHeight*e.bufferRows;f>e.farOffRemoval&&(e.farOffRemoval=f);a-=d;h.count=a;k.rowIndex=d;a?k.style.height=Math.min(a*e.rowHeight,e.maxEmptySpace)+"px":(k.style.display="none",c.count++);e._previousScrollPosition&&(e.scrollTo(e._previousScrollPosition),delete e._previousScrollPosition);
e._processScroll();e._refreshDeferred&&(e._refreshDeferred.resolve(n),delete e._refreshDeferred);return b},a)},a),n},refresh:function(b){var c=this,a=b&&b.keepScrollPosition,e;"undefined"===typeof a&&(a=this.keepScrollPosition);a&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this.store)return a=this._refreshDeferred=new l,e=c.renderQuery(function(a){return c.store.query(c.query,a)}),"undefined"===typeof e&&a.reject(),a.then(function(a){c._refreshTimeout=setTimeout(function(){r.emit(c.domNode,
"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:c,results:a});c._refreshTimeout=null},0);delete c._refreshDeferred;return a},function(a){delete c._refreshDeferred;throw a;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(b){return b.lastChild},_calcRowHeight:function(b){var c=b.nextSibling;return c&&!/\bdgrid-preload\b/.test(c.className)?c.offsetTop-b.offsetTop:b.offsetHeight},lastScrollTop:0,_processScroll:function(b){function c(b,c,d,e){var k=
f.farOffRemoval,h=b.node;if(c>2*k){for(var l,m=h[d],q=0,n=0,t=[];l=m;){var u=f._calcRowHeight(l);if(q+u+k>c||0>m.className.indexOf("dgrid-row")&&0>m.className.indexOf("dgrid-loading"))break;m=l[d];q+=u;n+=l.count||1;f.removeRow(l,!0);t.push(l)}b.count+=n;e?(h.rowIndex-=n,a(b)):h.style.height=h.offsetHeight+q+"px";var p=g("div",t);setTimeout(function(){g(p,"!")},1)}}function a(a,b){a.node.style.height=Math.min(a.count*f.rowHeight,b?Infinity:f.maxEmptySpace)+"px"}function e(a,b){do a=b?a.next:a.previous;
while(a&&!a.node.offsetWidth);return a}var f=this,h=f.bodyNode;b=b&&b.scrollTop||this.getScrollPosition().y;var h=h.offsetHeight+b,k,d,n=f.preload,t=f.lastScrollTop,p=f.bufferRows*f.rowHeight,r=p-f.rowHeight,y,z,C,B=!0;for(f.lastScrollTop=b;n&&!n.node.offsetWidth;)n=n.previous;for(;n&&n!=k;){k=f.preload;f.preload=n;d=n.node;var E=d.offsetTop;if(h+1+r<E)n=e(n,B=!1);else if(b-1-r>E+d.offsetHeight)n=e(n,B=!0);else{var G=((d.rowIndex?b-p:h)-E)/f.rowHeight,E=(h-b+2*p)/f.rowHeight,E=E+Math.min(Math.abs(Math.max(Math.min((b-
t)*f.rowHeight,f.maxRowsPerPage/2),f.maxRowsPerPage/-2)),10);0==d.rowIndex&&(G-=E);G=Math.max(G,0);10>G&&0<G&&E+G<f.maxRowsPerPage&&(E+=Math.max(0,G),G=0);E=Math.min(Math.max(E,f.minRowsPerPage),f.maxRowsPerPage,n.count);if(0==E)n=e(n,B);else{var E=Math.ceil(E),G=Math.min(Math.floor(G),n.count-E),I=m.mixin(f.get("queryOptions"),n.options);n.count-=E;var J=d,L,P=f.queryRowsOverlap,Q=(0<d.rowIndex||d.offsetTop>b)&&n;if(Q){var H=n.previous;H&&(c(H,b-(H.node.offsetTop+H.node.offsetHeight),"nextSibling"),
0<G&&H.node==d.previousSibling?(G=Math.min(n.count,G),n.previous.count+=G,a(n.previous,!0),d.rowIndex+=G,P=0):E+=G,n.count-=G);I.start=d.rowIndex-P;I.count=Math.min(E+P,f.maxRowsPerPage);d.rowIndex=I.start+I.count}else n.next&&(c(n.next,n.next.node.offsetTop-h,"previousSibling",!0),J=d.nextSibling,J==n.next.node?(n.next.count+=n.count-G,n.next.node.rowIndex=G+E,a(n.next),n.count=G,P=0):L=!0),I.start=n.count,I.count=Math.min(E+P,f.maxRowsPerPage);L&&J&&J.offsetWidth&&(L=J.offsetTop);a(n);"level"in
n.query&&(I.queryLevel=n.query.level);if("queryLevel"in I||!(I.start>f._total||0>I.count)){d=g(J,"-div.dgrid-loading[style\x3dheight:"+E*f.rowHeight+"px]");g(d,"div.dgrid-"+(Q?"below":"above")).innerHTML=f.loadingMessage;d.count=E;var K=n.query(I);if(void 0===f._trackError(function(){return K})){g(d,"!");return}(function(b,c,d,e){C=l.when(f.renderArray(e,b,I),function(k){z=e;J=b.nextSibling;g(b,"!");if(d&&J&&J.offsetWidth){var h=f.getScrollPosition();f.scrollTo({x:h.x,y:h.y+J.offsetTop-d,preserveMomentum:!0})}l.when(e.total||
e.length,function(b){"queryLevel"in I||(f._total=b);c&&(c.count=b-c.node.rowIndex,0===c.count&&I.count++,a(c))});f._processScroll();return k},function(a){g(b,"!");throw a;})}).call(this,d,Q,L,K);n=n.previous}}}}C&&(y=this._refreshDeferred)&&(delete this._refreshDeferred,l.when(C,function(){y.resolve(z)}))},removeRow:function(b,c){if(b){var a=b.previousSibling,e=b.nextSibling,f;if(f=a)f=a.observerIndex,f=null!=f?f:a.previousObserverIndex;a=f;if(f=e)f=e.observerIndex,f=null!=f?f:e.nextObserverIndex;
e=b.observerIndex;b.observerIndex=void 0;c&&(b.nextObserverIndex=f,b.previousObserverIndex=a);if(this.cleanEmptyObservers&&-1<e&&e!==a&&e!==f&&(a=this.observers,f=a[e])){if(!c)for(var g=f.rows,k=0;k<g.length;k++)if(g[k]!=b&&h.isDescendant(g[k],this.domNode))return this.inherited(arguments);f.cancel();this._numObservers--;a[e]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),
function(p,f,b,m,l,h,r){function n(b){return b}function g(b){if("object"!==typeof b)b=Error(b);else if("cancel"===b.dojoType)return;b.grid=this;l.emit(this.domNode,"dgrid-error",{grid:this,error:b,cancelable:!0,bubbles:!0})&&console.error(b)}return f("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};h.before(this,"configStructure",
b.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(b){b.set&&(this._columnsWithSet[b.field]=b);this.inherited(arguments)},_updateNotifyHandle:function(e){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);e&&"function"===typeof e.notify&&this.shouldObserveStore&&
(this._notifyHandle=h.after(e,"notify",b.hitch(this,"_onNotify"),!0),(e=this.get("sort"))&&e.length||console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},_setStore:function(b,c,a){this._updateNotifyHandle(b);this.store=b;this.dirty={};this.set("query",c,a)},_setQuery:function(b,c){var a=c&&c.sort;this.query=void 0!==b?b:this.query;this.queryOptions=c||this.queryOptions;
this._started&&(a?this.set("sort",a):this.refresh())},setStore:function(b,c,a){p.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",b,c,a)},setQuery:function(b,c){p.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",b,c)},_getQueryOptions:function(){var e=b.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)e.sort=this._sort;return e},_getQuery:function(){var e=this.query;return"object"==typeof e&&
null!=e?b.delegate(e,{}):e},_setSort:function(b,c){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(b,c){this.inherited(arguments);b&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},refresh:function(){var b=this.inherited(arguments);this.store||(this.noDataNode=r(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return b},renderArray:function(){var b=this,c=this.inherited(arguments);this.store||m.when(c,function(a){a.length&&
b.noDataNode&&r(b.noDataNode,"!")});return c},insertRow:function(e,c,a,f,g){var h=this.store,k=this.dirty,h=h&&h.getIdentity(e),d;h in k&&!(h in this._updating)&&(d=k[h]);d&&(e=b.delegate(e,d));return this.inherited(arguments)},updateDirty:function(b,c,a){var e=this.dirty,f=e[b];f||(f=e[b]={});f[c]=a},setDirty:function(b,c,a){p.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(b,c,a)},save:function(){function b(b,d){return function(e){var g=c._columnsWithSet,k=c._updating,
h,l;if("function"===typeof e.set)e.set(d);else for(h in d)e[h]=d[h];for(h in g)l=g[h].set(e),void 0!==l&&(e[h]=l);k[b]=!0;return m.when(a.put(e),function(){delete f[b];delete k[b]})}}var c=this,a=this.store,f=this.dirty,g=new m,h=g.promise,k=function(b){var d;return c.getBeforePut||!(d=c.row(b).data)?function(){return a.get(b)}:function(){return d}},d;for(d in f)var l=b(d,f[d]),h=h.then(k(d)).then(l);g.resolve();return h},revert:function(){this.dirty={};this.refresh()},_trackError:function(e){var c;
"string"==typeof e&&(e=b.hitch(this,e));try{c=e()}catch(a){g.call(this,a)}return m.when(c,n,b.hitch(this,g))},newRow:function(){var b=this.inherited(arguments);this.noDataNode&&(r(this.noDataNode,"!"),delete this.noDataNode);return b},removeRow:function(b,c){var a={element:b};!c&&this.noDataMessage&&this.up(a).element===b&&this.down(a).element===b&&(this.noDataNode=r(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),
function(p,f,b,m,l,h,r,n,g){function e(a,b){for(var c=a.unselectable=b?"on":"",d=a.getElementsByTagName("*"),e=d.length;--e;)"INPUT"!==d[e].tagName&&"TEXTAREA"!==d[e].tagName&&(d[e].unselectable=c)}function c(a,b){var c=a.bodyNode,d=b?"text":21>l("ff")?"-moz-none":"none";u&&"msUserSelect"!==u?c.style[u]=d:l("dom-selectstart")?b||a._selectstartHandle?b&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):a._selectstartHandle=m(c,"selectstart",function(a){var b=a.target&&
a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):(e(c,!b),b||a._unselectableHandle)?b&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle):a._unselectableHandle=h.after(a,"renderRow",function(a){e(a,!0);return a})}l.add("dom-comparedocumentposition",function(a,b,c){return!!c.compareDocumentPosition});l.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});l.add("css-user-select",function(a,b,c){a=c.style;
b=["Khtml","O","ms","Moz","Webkit"];c=b.length;var d="userSelect";do if("undefined"!==typeof a[d])return d;while(c--&&(d=b[c]+"UserSelect"));return!1});l.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=l("mac")?"metaKey":"ctrlKey",u=l("css-user-select"),v=(r=l("pointer"))&&"MS"===r.slice(0,2),q=r?r+(v?"Down":"down"):"mousedown",k=r?r+(v?"Up":"up"):"mouseup";"WebkitUserSelect"===u&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(u=!1);return f("dgrid.Selection",
null,{selectionDelegate:".dgrid-row",selectionEvents:q+","+k+",dgrid-cellfocusin",selectionTouchEvents:l("touch")?n.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);
this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){p.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");
this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?c(this,a):c(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&("dgrid-cellfocusin"!==a.type||"mousedown"!==a.parentType)&&(a.type!==k||b==this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===q&&this.isSelected(b))this._waitForMouseUp=
b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(b,c){var d=b.keyCode?b.ctrlKey:b[a];this._lastSelected===c?this.select(c,null,!d||!this.isSelected(c)):(this.clearSelection(),this.select(c),this._lastSelected=c)},_multipleSelectionHandler:function(b,c){var d=this._lastSelected,e=b.keyCode?b.ctrlKey:b[a],f;b.shiftKey||(f=e?null:!0,d=null);this.select(c,d,f);d||(this._lastSelected=c)},_extendedSelectionHandler:function(b,c){(2===b.button?
this.isSelected(c):b.keyCode?b.ctrlKey:b[a])||this.clearSelection(null,!0);this._multipleSelectionHandler(b,c)},_toggleSelectionHandler:function(a,b){this.select(b,null,null)},_initSelectionEvents:function(){var b=this,c=this.contentNode,e=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};l("touch")&&!l("pointer")&&this.selectionTouchEvents?(m(c,n.selector(e,this.selectionTouchEvents),function(a){b._handleSelect(a,this);b._ignoreMouseSelect=this}),m(c,m.selector(e,this.selectionEvents),
function(a){b._ignoreMouseSelect!==this?b._handleSelect(a,this):a.type===k&&(b._ignoreMouseSelect=null)})):m(c,m.selector(e,this.selectionEvents),function(a){b._handleSelect(a,this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){b._handleSelect(a,a.target)});if(this.allowSelectAll)this.on("keydown",function(c){c[a]&&65==c.keyCode&&!/\bdgrid-input\b/.test(c.target.className)&&(c.preventDefault(),b[b.allSelected?"clearSelection":"selectAll"]())});this._setStore&&h.after(this,"_setStore",function(){b._updateDeselectionAspect()});
this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(a,c,d){a=c||a&&a[b.idProperty||"id"];if(null!=a&&(c=(a=b.row(a))&&b.selection[a.id]))b[d](a,null,c)}var b=this,c=this.store,e,f;this._removeDeselectSignals&&this._removeDeselectSignals();c&&c.notify?(e=h.before(c,"notify",function(b,c){b||a(b,c,"deselect")}),f=h.after(c,"notify",function(b,c){a(b,c,"select")},!0),this._removeDeselectSignals=function(){e.remove();f.remove()}):(e=h.before(this,"removeRow",function(a,b){var c;
b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)}),this._removeDeselectSignals=function(){e.remove()})},allowSelect:function(a){return!0},_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],c=this._selectionTriggerEvent,d;d={bubbles:!0,grid:this};c&&(d.parentType=c.type);d[this._selectionTargetType]=b;this._selectionEventQueues[a]=[];m.emit(this.contentNode,"dgrid-"+a,d)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},
_select:function(a,b,c){var d,e,f;"undefined"===typeof c&&(c=!0);a.element||(a=this.row(a));if(!1===c||this.allowSelect(a))if(d=this.selection,e=!!d[a.id],null===c&&(c=!e),f=a.element,c||this.allSelected?d[a.id]=c:delete this.selection[a.id],f&&(c?g(f,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):g(f,"!dgrid-selected!ui-state-active")),c!==e&&f&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element)for(d=this._determineSelectionDirection(f,
b),d||(b=document.getElementById(b.id),d=this._determineSelectionDirection(f,b));a.element!=b&&(a=this[d](a));)this._select(a,null,c)}else this._lastSelected=f,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:l("dom-comparedocumentposition")?function(a,
b){var c=b.compareDocumentPosition(a);return c&1?!1:2===c?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=
this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this,c=this.inherited(arguments);b.when(c,function(b){var c=a.selection,
d,e,f;for(d=0;d<b.length;d++)e=a.row(b[d]),(f=e.id in c?c[e.id]:a.allSelected)&&a._select(e,null,f);a._fireSelectionEvents()});return c}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),function(p,f,b,m,l,h,r,n){function g(a){a.preventDefault()}var e={checkbox:1,radio:1,button:1},c=/\bdgrid-cell\b/,a=/\bdgrid-row\b/,u=p("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,
keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=m.mixin({},u.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=m.mixin({},u.defaultHeaderKeyMap))},postCreate:function(){function d(a){var b=a.target;return b.type&&(!e[b.type]||32==a.keyCode)}function g(e){function g(){k._focusedHeaderNode&&(k._focusedHeaderNode.tabIndex=-1);if(k.showHeader){if(h)for(var a=0,b,c=k.headerNode.getElementsByTagName("th");b=c[a];++a){if(l.test(b.className)){k._focusedHeaderNode=
q=b;break}}else k._focusedHeaderNode=q=k.headerNode;q&&(q.tabIndex=k.tabIndex)}}var h=k.cellNavigation,l=h?c:a,m=e===k.headerNode,q=e;m?(g(),f.after(k,"renderHeader",g,!0)):f.after(k,"renderArray",function(a){return n.when(a,function(a){var b=k._focusedNode||q;if(l.test(b.className)&&r.contains(e,b))return a;for(var c=0,d=e.getElementsByTagName("*"),f;f=d[c];++c)if(l.test(f.className)){b=k._focusedNode=f;break}b.tabIndex=k.tabIndex;return a})});k._listeners.push(b(e,"mousedown",function(a){d(a)||
k._focusOnNode(a.target,m,a)}));k._listeners.push(b(e,"keydown",function(a){if(!a.metaKey&&!a.altKey){var b=k[m?"headerKeyMap":"keyMap"][a.keyCode];b&&!d(a)&&b.call(k,a)}}))}this.inherited(arguments);var k=this;this.tabableHeader&&(g(this.headerNode),b(this.headerNode,"dgrid-cellfocusin",function(){k.scrollTo({x:this.scrollLeft})}));g(this.contentNode);this._debouncedEnsureRowScroll=r.debounce(this._ensureRowScroll,this)},removeRow:function(a){if(!this._focusedNode)return this.inherited(arguments);
var b=this,c=document.activeElement===this._focusedNode,d=this[this.cellNavigation?"cell":"row"](this._focusedNode),e=d.row||d,f;a=a.element||a;a===e.element&&((f=this.down(e,!0))&&f.element!==a||(f=this.up(e,!0)),this._removedFocus={active:c,rowId:e.id,columnId:d.column&&d.column.id,siblingId:f&&f.element!==a?f.id:void 0},setTimeout(function(){b._removedFocus&&b._restoreFocus(e.id)},0),this._focusedNode=null);this.inherited(arguments)},insertRow:function(a){var b=this.inherited(arguments);this._removedFocus&&
!this._removedFocus.wait&&this._restoreFocus(b);return b},_restoreFocus:function(a){var b=this._removedFocus,c;if((a=(a=a&&this.row(a))&&a.element&&a.id===b.rowId?a:"undefined"!==typeof b.siblingId&&this.row(b.siblingId))&&a.element){if(!a.element.parentNode.parentNode){b.wait=!0;return}"undefined"!==typeof b.columnId&&(c=this.cell(a,b.columnId))&&c.element&&(a=c);b.active&&0!==a.element.offsetHeight?this._focusOnNode(a,!1,null):(h(a.element,".dgrid-focus"),a.element.tabIndex=this.tabIndex,this._focusedNode=
a.element)}delete this._removedFocus},addKeyHandler:function(a,b,c){return f.after(this[c?"headerKeyMap":"keyMap"],a,b,!0)},_ensureRowScroll:function(a){var b=this.getScrollPosition().y;b>a.offsetTop?this.scrollTo({y:a.offsetTop}):b+this.contentNode.offsetHeight<a.offsetTop+a.offsetHeight&&this.scrollTo({y:a.offsetTop-this.contentNode.offsetHeight+a.offsetHeight})},_focusOnNode:function(d,e,f){var g="_focused"+(e?"Header":"")+"Node",k=this[g],q=this.cellNavigation?"cell":"row",n=this[q](d),t,u,p,
r,v;if(d=n&&n.element){if(this.cellNavigation)for(t=d.getElementsByTagName("input"),v=0,p=t.length;v<p;v++)if(u=t[v],(-1!=u.tabIndex||"_dgridLastValue"in u)&&!u.disabled){8>l("ie")&&(u.style.position="relative");u.focus();8>l("ie")&&(u.style.position="");r=!0;break}null!==f&&(f=m.mixin({grid:this},f),f.type&&(f.parentType=f.type),f.bubbles||(f.bubbles=!0));k&&(h(k,"!dgrid-focus[!tabIndex]"),8>l("ie")&&(k.style.position=""),f&&(f[q]=this[q](k),b.emit(k,"dgrid-cellfocusout",f)));k=this[g]=d;f&&(f[q]=
n);g=this.cellNavigation?c:a;!r&&g.test(d.className)&&(8>l("ie")&&(d.style.position="relative"),d.tabIndex=this.tabIndex,d.focus());h(d,".dgrid-focus");f&&b.emit(k,"dgrid-cellfocusin",f);this.cellNavigation&&(this.columnSets||1<this.subRows.length)&&!e&&this._debouncedEnsureRowScroll(n.row.element)}},focusHeader:function(a){this._focusOnNode(a||this._focusedHeaderNode,!0)},focus:function(a){(a=a||this._focusedNode)?this._focusOnNode(a,!1):this.contentNode.focus()}}),v=u.moveFocusVertical=function(a,
b){var c=this.cellNavigation,d=this[c?"cell":"row"](a),d=c&&d.column.id,e=this.down(this._focusedNode,b,!0);c&&(e=this.cell(e,d));this._focusOnNode(e,!1,a);a.preventDefault()};p=u.moveFocusUp=function(a){v.call(this,a,-1)};var q=u.moveFocusDown=function(a){v.call(this,a,1)},k=u.moveFocusPageUp=function(a){v.call(this,a,-this.pageSkip)},d=u.moveFocusPageDown=function(a){v.call(this,a,this.pageSkip)},w=u.moveFocusHorizontal=function(a,b){if(this.cellNavigation){var c=!this.row(a);this._focusOnNode(this.right(this["_focused"+
(c?"Header":"")+"Node"],b),c,a);a.preventDefault()}},t=u.moveFocusLeft=function(a){w.call(this,a,-1)},x=u.moveFocusRight=function(a){w.call(this,a,1)},A=u.moveHeaderFocusEnd=function(a,b){var c;this.cellNavigation&&(c=this.headerNode.getElementsByTagName("th"),this._focusOnNode(c[b?0:c.length-1],!0,a));a.preventDefault()},y=u.moveHeaderFocusHome=function(a){A.call(this,a,!0)},z=u.moveFocusEnd=function(a,b){var c=this,d=this.cellNavigation,e=this.contentNode,g=e.scrollTop+(b?0:e.scrollHeight),e=e[b?
"firstChild":"lastChild"],k=-1<e.className.indexOf("dgrid-preload"),h=k?e[(b?"next":"previous")+"Sibling"]:e,q=h.offsetTop+(b?0:h.offsetHeight),t;if(k){for(;h&&0>h.className.indexOf("dgrid-row");)h=h[(b?"next":"previous")+"Sibling"];if(!h)return}!k||1>e.offsetHeight?(d&&(h=this.cell(h,this.cell(a).column.id)),this._focusOnNode(h,!1,a)):(l("dom-addeventlistener")||(a=m.mixin({},a)),t=f.after(this,"renderArray",function(e){t.remove();return n.when(e,function(e){e=e[b?0:e.length-1];d&&(e=c.cell(e,c.cell(a).column.id));
c._focusOnNode(e,!1,a)})}));g===q&&a.preventDefault()},C=u.moveFocusHome=function(a){z.call(this,a,!0)};u.defaultKeyMap={32:g,33:k,34:d,35:z,36:C,37:t,38:p,39:x,40:q};u.defaultHeaderKeyMap={32:g,35:A,36:y,37:t,39:x};return u})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(p,f,b,m,l){function h(b){for(;b.childNodes[0]&&1==b.childNodes[0].nodeType;)b=b.childNodes[0];return b}function r(b,e){"string"==
typeof b?(b=m.toDom(b,e&&e.ownerDocument),11==b.nodeType&&(b=b.childNodes[0])):1==b.nodeType&&b.parentNode&&(b=b.cloneNode(!1));return b}var n=p.NodeList;f.extend(n,{_placeMultiple:function(b,e){for(var c="string"==typeof b||b.nodeType?p(b):b,a=[],f=0;f<c.length;f++)for(var g=c[f],h=this.length,k=h-1,d;d=this[k];k--)0<f&&(d=this._cloneNode(d),a.unshift(d)),k==h-1?m.place(d,g,e):g.parentNode.insertBefore(d,g),g=d;a.length&&(a.unshift(0),a.unshift(this.length-1),Array.prototype.splice.apply(this,a));
return this},innerHTML:function(b){return arguments.length?this.addContent(b,"only"):this[0].innerHTML},text:function(b){if(arguments.length){for(var e=0,c;c=this[e];e++)1==c.nodeType&&l.set(c,"textContent",b);return this}for(var a="",e=0;c=this[e];e++)a+=l.get(c,"textContent");return a},val:function(g){if(arguments.length){for(var e=f.isArray(g),c=0,a;a=this[c];c++){var h=a.nodeName.toUpperCase(),l=a.type,m=e?g[c]:g;if("SELECT"==h)for(h=a.options,l=0;l<h.length;l++){var k=h[l];k.selected=a.multiple?
-1!=b.indexOf(g,k.value):k.value==m}else"checkbox"==l||"radio"==l?a.checked=a.value==m:a.value=m}return this}if((a=this[0])&&1==a.nodeType){g=a.value||"";if("SELECT"==a.nodeName.toUpperCase()&&a.multiple){g=[];h=a.options;for(l=0;l<h.length;l++)k=h[l],k.selected&&g.push(k.value);g.length||(g=null)}return g}},append:function(b){return this.addContent(b,"last")},appendTo:function(b){return this._placeMultiple(b,"last")},prepend:function(b){return this.addContent(b,"first")},prependTo:function(b){return this._placeMultiple(b,
"first")},after:function(b){return this.addContent(b,"after")},insertAfter:function(b){return this._placeMultiple(b,"after")},before:function(b){return this.addContent(b,"before")},insertBefore:function(b){return this._placeMultiple(b,"before")},remove:n.prototype.orphan,wrap:function(b){if(this[0]){b=r(b,this[0]);for(var e=0,c;c=this[e];e++){var a=this._cloneNode(b);c.parentNode&&c.parentNode.replaceChild(a,c);h(a).appendChild(c)}}return this},wrapAll:function(b){if(this[0]){b=r(b,this[0]);this[0].parentNode.replaceChild(b,
this[0]);b=h(b);for(var e=0,c;c=this[e];e++)b.appendChild(c)}return this},wrapInner:function(b){if(this[0]){b=r(b,this[0]);for(var e=0;e<this.length;e++){var c=this._cloneNode(b);this._wrap(f._toArray(this[e].childNodes),null,this._NodeListCtor).wrapAll(c)}}return this},replaceWith:function(b){b=this._normalize(b,this[0]);for(var e=0,c;c=this[e];e++)this._place(b,c,"before",0<e),c.parentNode.removeChild(c);return this},replaceAll:function(b){b=p(b);for(var e=this._normalize(this,this[0]),c=0,a;a=
b[c];c++)this._place(e,a,"before",0<c),a.parentNode.removeChild(a);return this},clone:function(){for(var b=[],e=0;e<this.length;e++)b.push(this._cloneNode(this[e]));return this._wrap(b,this,this._NodeListCtor)}});n.prototype.html||(n.prototype.html=n.prototype.innerHTML);return n})},"jimu/dijit/ImageChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff dojo/request esri/lang ../utils ./_CropImage jimu/dijit/Popup jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k){var d=0;p=f([b,m,p],{templateString:n,declaredClass:"jimu.dijit.ImageChooser",cropImage:!0,displayImg:null,defaultSelfSrc:null,showSelfImg:!1,label:null,showTip:!0,goldenWidth:400,goldenHeight:400,maxSize:1024,format:null,imageData:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.imageChooser;this.nls.common=window.jimuNls.common;this.nls.readError=this.nls.readError||"Failed to read the file."},postCreate:function(){this._initial();
a.file.supportHTML5()||g("safari")||!a.file.isEnabledFlash()||a.file.loadFileAPI().then(l.hitch(this,function(){h.setStyle(this.mask,"zIndex",1)}))},setImageSize:function(a){this.goldenWidth=a.width;this.goldenHeight=a.height},disableChooseImage:function(){h.setStyle(this.fileForm,"display","none");this.label&&"string"===typeof this.label&&h.addClass(this.displayText,"disable-label");h.removeAttr(this.domNode,"title")},enableChooseImage:function(){h.setStyle(this.fileForm,"display","block");this.label&&
"string"===typeof this.label&&h.removeClass(this.displayText,"disable-label");this._addTip()},setDefaultSelfSrc:function(a){this.defaultSelfSrc=a;this.imageData=this.selfImg.src=a},getImageData:function(){return this.imageData},_initial:function(){this._processProperties();this._porcessMaskClick();this._setupFileInput();this._addTip()},_processProperties:function(){this.fileProperty={};this.label&&"string"===typeof this.label&&(this.displayText.innerHTML=this.label,h.setStyle(this.hintText,"display",
"block"));this.showSelfImg&&h.setStyle(this.hintImage,"display","block");this.defaultSelfSrc&&(this.imageData=this.selfImg.src=this.defaultSelfSrc);if(this.format){var b="image/*";"string"===typeof this.format&&/^image\/./.test(this.format)?b=this.format:"[object Array]"===Object.prototype.toString.call(this.format)&&0<this.format.length&&(b=this.format.join(","));h.setAttr(this.fileInput,"accept",b)}a.file.supportHTML5()||g("safari")||!a.file.isEnabledFlash()||h.setStyle(this.fileInput,{width:"100%",
height:"100%",position:"absolute",left:0,top:0,opacity:0,zIndex:9})},_porcessMaskClick:function(){h.setAttr(this.fileInput,"id","imageChooser_"+d);h.setAttr(this.mask,"for","imageChooser_"+d);d++;this.maskHandle=r(this.mask,"click",l.hitch(this,function(b){b.stopPropagation();if(g("safari")&&7>g("safari"))new q({message:this.nls.unsupportReaderAPI}),b.preventDefault();else{if(!a.file.supportHTML5()){if(!a.file.isEnabledFlash()){var c=h.create("a",{href:"http://helpx.adobe.com/flash-player.html",innerHTML:this.nls.enableFlash,
target:"_blank"});new q({message:c});b.preventDefault();return}if(!a.file.supportFileAPI()){new q({message:this.nls.unsupportReaderAPI});b.preventDefault();return}}h.setStyle(this.fileInput,"display","none");setTimeout(l.hitch(this,function(){h.setStyle(this.fileInput,"display","block")}),200)}}))},_addTip:function(){if(this.showTip){var a=c.substitute({width:this.goldenWidth||40,height:this.goldenHeight||40},this.nls.toolTip);h.setAttr(this.domNode,"title",a)}else h.setAttr(this.domNode,"title",
"")},_setupFileInput:function(){if(9>=g("ie"))this.own(r(this.fileInput,"change",l.hitch(this,this._onFileInputChange)));else r.once(this.fileInput,"change",l.hitch(this,this._onFileInputChange))},_onFileInputChange:function(b){var c=b.target.files&&b.target.files[0]||b.files&&b.files[0];if(this.format&&-1===this.format.indexOf(c.type))new q({message:this.nls.invalidType}),(!g("ie")||9<g("ie"))&&this._recreateFileForm();else{var d=9>g("ie")?23552:1024*this.maxSize;a.file.readFile(b,"image/*",d,l.hitch(this,
function(a,b,e){a?(b=this.nls[a.errCode],"exceed"===a.errCode&&(b=b.replace("1024",d/1024)),new q({message:b})):(this.fileProperty.fileName=b,window.isXT&&this.cropImage&&"image/gif"!==c.type?this._cropImageByUser(e):this._readFileData(e));(!g("ie")||9<g("ie"))&&this._recreateFileForm()}))}},_recreateFileForm:function(){var a=l.clone(this.mask),b=l.clone(this.fileInput);h.destroy(this.mask);h.destroy(this.fileInput);var c=l.clone(this.fileForm);h.place(a,c);h.place(b,c);h.place(c,this.fileForm,"replace");
this.maskHandle.remove();this.mask=a;this.fileInput=b;h.destroy(this.fileForm);this.fileForm=c;this._porcessMaskClick();this._setupFileInput()},_readFileData:function(a){this.onImageChange(a,this.fileProperty);this.displayImg&&h.setAttr(this.displayImg,"src",a);this.showSelfImg&&(this.selfImg?h.setAttr(this.selfImg,"src",a):this.selfImg.src=a)},_cropImageByUser:function(a){var b=new u({imageSrc:a,nls:l.clone(this.nls),realWidth:this.goldenWidth,realHeight:this.goldenHeight}),c=new k({hidden:!0}),
d=new v({titleLabel:this.nls.cropImage,content:b,width:500,height:480,buttons:[{label:this.nls.common.ok,onClick:l.hitch(this,function(){var f=b.getImageSize(),g=b.getCropSize();c.show();e("/webappbuilder/rest/cropimage",{data:{imageData:a,imageDisplaySize:f.w+","+f.h,cropRectangle:g.w+","+g.h+","+g.t+","+g.l},method:"POST",handleAs:"json",headers:{"X-Requested-With":null}}).then(l.hitch(this,function(a){a.success?(this._readFileData(a.imageData),d.close()):(new q({message:this.nls.unknowError}),
c.hide())}),l.hitch(this,function(a){console.error(a);new q({message:this.nls.unknowError});c.hide()}))})}]});c.placeAt(d.domNode);b.startup();h.addClass(d.domNode,"image-chooser-crop-popup")},onImageChange:function(a){this.imageData=a;this.emit("imageChange",this.imageData,this.fileProperty);this.emit("change",this.imageData,this.fileProperty)}});p.GIF="image/gif";p.JPEG="image/jpeg";p.PNG="image/png";return p})},"jimu/dijit/_CropImage":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_CropImage.html jimu/dijit/Message esri/lang dojo/NodeList-dom".split(" "),
function(p,f,b,m,l,h,r,n,g,e){return p([h,r],{templateString:n,inDrag:!1,inSlider:!1,realWidth:30,realHeight:30,ratio:null,imageSrc:null,_currentX:null,_currentY:null,_currentTop:0,_currentLeft:0,postCreate:function(){this._dragingHandlers=[];this.setImageSrc(this.imageSrc);this.own(m(this.ownerDocument,"mousemove",b.hitch(this,"_onMouseMove")));this.own(m(this.ownerDocument,"mouseup",b.hitch(this,"_onMouseUp")));this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";this.own(m(this.baseImage,
"load",b.hitch(this,function(){this._init();f.setStyle(this.loadingImg,"display","none")})))},setImageSrc:function(b){f.setAttr(this.viewerImage,"src",b);f.setAttr(this.baseImage,"src",b)},getImageSize:function(){return{w:this._currentImageWidth,h:this._currentImageHeight}},getCropSize:function(){return{l:-this._currentLeft,t:-this._currentTop,w:this.idealWidth,h:this.idealHeight}},_init:function(){var c=this._getComputedStyle(this.cropSection),a=f.getContentBox(this.cropSection),h=this._getComputedStyle(this.baseImage),
m=parseFloat(h.width)||this.baseImage.offsetWidth,h=parseFloat(h.height)||this.baseImage.offsetHeight,q=m/h;this._maxImageWidth=m;this._maxImageHeight=h;if(h<this.realHeight&&m<this.realWidth)c=e.substitute({width:this.realWidth,height:this.realHeight},this.nls.cropWaining),setTimeout(b.hitch(this,function(){this.popup.close()}),50),new g({message:c});else{this.idealWidth=this.realWidth;this.idealHeight=this.realHeight;var k=this.ratio=this.ratio?this.ratio:this.realWidth/this.realHeight;1<=this.ratio?
a.h*this.ratio<=a.w?(this.idealHeight=a.h,this.idealWidth=a.h*this.ratio):(this.idealHeight=this._findProperlyValue(0,a.h,a.w-5,function(a){return a*k}),this.idealWidth=this.idealHeight*this.ratio):a.w/this.ratio<=a.h?(this.idealWidth=a.w,this.idealHeight=a.w/this.ratio):(this.idealWidth=this._findProperlyValue(0,a.w,a.h-5,function(a){return a/k}),this.idealHeight=this.idealWidth/this.ratio);f.setStyle(this.viewerBox,{width:this.idealWidth+"px",height:this.idealHeight+"px"});c=Math.abs((parseFloat(c.height)-
this.idealHeight)/2);f.setStyle(this.cropSection,{paddingTop:c+"px",paddingBottom:c+"px"});1<=q?this.idealHeight*q>=this.idealWidth?(f.setStyle(this.viewerImage,"height",this.idealHeight+"px"),f.setStyle(this.baseImage,"height",this.idealHeight+"px")):(c=this._findProperlyValue(0,this.idealWidth,this.idealWidth,function(a){return a*q}),f.setStyle(this.viewerImage,"height",c+"px"),f.setStyle(this.baseImage,"height",c+"px")):this.idealWidth/q>=this.idealHeight?(f.setStyle(this.viewerImage,"width",this.idealWidth+
"px"),f.setStyle(this.baseImage,"width",this.idealWidth+"px")):(c=this._findProperlyValue(0,this.idealHeight,this.idealHeight,function(a){return a/q}),f.setStyle(this.viewerImage,"width",c+"px"),f.setStyle(this.baseImage,"width",c+"px"));l(".hide-status",this.domNode).removeClass("hide-status");h=this._getComputedStyle(this.baseImage);m=parseFloat(h.width)||this.baseImage.offsetWidth;h=parseFloat(h.height)||this.baseImage.offsetHeight;this._minImageWidth=m;this._minImageHeight=h;this._currentImageWidth=
m;this._currentImageHeight=h;this._currentTop=-(h-this.idealHeight)/2;this._currentLeft=-(m-this.idealWidth)/2;f.setStyle(this.baseImage,{top:this._currentTop+"px",left:this._currentLeft+"px"});f.setStyle(this.viewerImage,{top:this._currentTop+"px",left:this._currentLeft+"px"});this._zoomRatio=this._maxImageWidth/this._minImageWidth;1>=this._zoomRatio&&f.addClass(this.zoomInBtn,"disable-zoom");f.addClass(this.zoomOutBtn,"disable-zoom");this._latestPercentage=window.isRTL?100:0}},_findProperlyValue:function(b,
a,e,f,g){g=isFinite(g)?parseFloat(g):1;e=0>e-g||0>e+g?g:e;var c=(b+a)/2,d=f(c);if(d<=e+g&&d>=e-g)return c;if(d>e)return this._findProperlyValue(b,c,e,f);if(d<e)return this._findProperlyValue(c,a,e,f)},_getComputedStyle:function(b){b=f.getMarginBox(b);return{width:b.w,height:b.h,left:b.l,top:b.t}},_onViewerMouseDown:function(b){var a=this._getComputedStyle(this.baseImage),c=this._getComputedStyle(this.viewerContent);this._maxOffsetLeft=parseFloat(c.width)-parseFloat(a.width);this._maxOffsetTop=parseFloat(c.height)-
parseFloat(a.height);this._maxOffsetLeft=0<this._maxOffsetLeft?0:this._maxOffsetLeft;this._maxOffsetTop=0<this._maxOffsetTop?0:this._maxOffsetTop;this.inDrag=!0;this._currentX=b.clientX;this._currentY=b.clientY;this._stopSelect()},_stopSelect:function(){this._dragingHandlers=this._dragingHandlers.concat([m(this.ownerDocument,"dragstart",function(b){b.stopPropagation();b.preventDefault()}),m(this.ownerDocumentBody,"selectstart",function(b){b.stopPropagation();b.preventDefault()})])},_removeStopSelect:function(){for(var b=
this._dragingHandlers.pop();b;)b.remove(),b=this._dragingHandlers.pop()},_onViewerMouseUp:function(b){this.inDrag&&(this.inDrag=!1,this._resetImagePosition(b.clientX,b.clientY),this._removeStopSelect(),b.stopPropagation())},_onSliderMouseDown:function(b){if(!(1>=this._zoomRatio)){this.inSlider=!0;this._currentX=b.clientX;this._currentY=b.clientY;var a=f.position(this.sliderNode);this._startSliderLeft=a.x;this._sliderWidth=a.w;this._stopSelect();b.stopPropagation()}},_onSliderMouseUp:function(b){if(!(1>=
this._zoomRatio)&&this.inSlider){this.inSlider=!1;this._resetSliderButtonPosition(b.clientX);var a=this._getComputedStyle(this.baseImage);this._currentLeft=parseFloat(a.left);this._currentTop=parseFloat(a.top);this._latestPercentage=(b.clientX-this._startSliderLeft)/this._sliderWidth*100;this._latestPercentage=this._normalizePercentage(this._latestPercentage);this._removeStopSelect();b.stopPropagation()}},_onMouseMove:function(b){this.inDrag&&this._resetImagePosition(b.clientX,b.clientY);!this.inSlider||
1>=this._zoomRatio||this._resetSliderButtonPosition(b.clientX,b.clientY)},_onMouseUp:function(b){this.inDrag&&this._onViewerMouseUp(b);this.inSlider&&this._onSliderMouseUp(b)},_onZoomOutClick:function(){1>=this._zoomRatio||this._zoomImage("out")},_onZoomInClick:function(){1>=this._zoomRatio||this._zoomImage("in")},_zoomImage:function(b){var a=0;this._latestPercentage=this._normalizePercentage(this._latestPercentage);"in"===b?a=window.isRTL?this._latestPercentage-20:this._latestPercentage+20:"out"===
b&&(a=window.isRTL?this._latestPercentage+20:this._latestPercentage-20);b=this._normalizePercentage(a);this._moveSliderButton(b,this._latestPercentage);this._latestPercentage=b;b=this._getComputedStyle(this.baseImage);this._currentLeft=parseFloat(b.left);this._currentTop=parseFloat(b.top)},_resetImagePosition:function(b,a){var c=b-this._currentX,e=a-this._currentY;0<=this._currentTop+e?(f.setStyle(this.baseImage,"top",0),f.setStyle(this.viewerImage,"top",0),this._currentY=a,this._currentTop=0):this._currentTop+
e<=this._maxOffsetTop?(f.setStyle(this.baseImage,"top",this._maxOffsetTop+"px"),f.setStyle(this.viewerImage,"top",this._maxOffsetTop+"px"),this._currentY=a,this._currentTop=this._maxOffsetTop):(f.setStyle(this.baseImage,"top",this._currentTop+e+"px"),f.setStyle(this.viewerImage,"top",this._currentTop+e+"px"),this._currentY=a,this._currentTop+=e);0<=this._currentLeft+c?(f.setStyle(this.baseImage,"left",0),f.setStyle(this.viewerImage,"left",0),this._currentX=b,this._currentLeft=0):this._currentLeft+
c<=this._maxOffsetLeft?(f.setStyle(this.baseImage,"left",this._maxOffsetLeft+"px"),f.setStyle(this.viewerImage,"left",this._maxOffsetLeft+"px"),this._currentX=b,this._currentLeft=this._maxOffsetLeft):(f.setStyle(this.baseImage,"left",this._currentLeft+c+"px"),f.setStyle(this.viewerImage,"left",this._currentLeft+c+"px"),this._currentX=b,this._currentLeft+=c)},_normalizePercentage:function(b){b=0>b?0:b;return 100<b?100:b},_resetSliderButtonPosition:function(b){b=(b-this._startSliderLeft)/this._sliderWidth*
100;b=this._normalizePercentage(b);this._moveSliderButton(b,this._latestPercentage)},_moveSliderButton:function(b,a){0>=b?f.addClass(this.zoomOutBtn,"disable-zoom"):f.removeClass(this.zoomOutBtn,"disable-zoom");100<=b?f.addClass(this.zoomInBtn,"disable-zoom"):f.removeClass(this.zoomInBtn,"disable-zoom");f.setStyle(this.sliderButton,"left",b+"%");window.isRTL&&(b=100-b,a=100-a);var c=this._minImageWidth*(this._zoomRatio-1)*b/100,e=this._minImageHeight*(this._zoomRatio-1)*b/100,g=this._getComputedStyle(this.baseImage);
this._currentLeft=parseFloat(g.left);this._currentTop=parseFloat(g.top);var g=(Math.abs(this._currentLeft)+this.idealWidth/2)*((this._minImageWidth+c)/this._currentImageWidth-1),k=(Math.abs(this._currentTop)+this.idealHeight/2)*((this._minImageWidth+c)/this._currentImageWidth-1);f.setStyle(this.baseImage,{width:this._minImageWidth+c+"px",height:this._minImageHeight+e+"px"});f.setStyle(this.viewerImage,{width:this._minImageWidth+c+"px",height:this._minImageHeight+e+"px"});this._currentImageWidth=this._minImageWidth+
c;this._currentImageHeight=this._minImageHeight+e;if(0<=b-a)f.setStyle(this.baseImage,{top:this._currentTop-k+"px",left:this._currentLeft-g+"px"}),f.setStyle(this.viewerImage,{top:this._currentTop-k+"px",left:this._currentLeft-g+"px"});else{var d=0,h=0,d=0<=this._currentTop-k?0:this._currentTop-k+this._minImageHeight+e<=this.idealHeight?this.idealHeight-this._minImageHeight-e:this._currentTop-k,h=0<=this._currentLeft-g?0:this._currentLeft-g+this._minImageWidth+c<=this.idealWidth?this.idealWidth-this._minImageWidth-
c:this._currentLeft-g;f.setStyle(this.baseImage,{top:d+"px",left:h+"px"});f.setStyle(this.viewerImage,{top:d+"px",left:h+"px"})}this._latestPercentage=b}})})},"builder/dijit/template-config/utils":function(){define("dojo/_base/lang dojo/Deferred jimu/utils jimu/dijit/Message jimu/WidgetManager dojo/promise/all dojo/json builder/serviceUtils".split(" "),function(p,f,b,m,l,h,r,n){return{loadAllWidgetConfigs:function(g){var e=new f,c=[];g.visitElement(function(a){if(a.uri){var e=l.getInstance().tryLoadWidgetConfig(a).then(function(c){c&&
(a.config=c,g._originConfig&&(b.getConfigElementById(g._originConfig,a.id).config=c))});c.push(e)}});h(c).then(function(){e.resolve(g)},function(a){e.reject(a)});return e},saveAgolTemplate:function(b,e,c){var a=new f,g={itemId:c?c:this.app.agolTemplateInfo?this.app.agolTemplateInfo.itemId:null,json:e};n.saveAgolTemplate(this.app,g).then(p.hitch(this,function(){this.app.agolTemplateInfo=g;this.lastTemplateJson=this.categoryManager.getTemplateJson();a.resolve()}),function(b){new m({message:b});a.reject()});
return a}}})},"builder/plugins/app-list/_build-generate_module":function(){define(["builder/plugins/app-list/Plugin","dojo/text!builder/plugins/app-list/Plugin.html","dojo/text!builder/plugins/app-list/css/style.css","dojo/i18n!builder/plugins/app-list/nls/strings"],function(){})},"builder/plugins/app-list/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/on dojo/_base/lang dojo/query dojo/topic ./Import ./AppCatalogPage ./CardPageWithBigThumbnail ./CardPageWithSmallThumbnail builder/serviceUtils jimu/dijit/LoadingShelter jimu/utils builder/BasePlugin esri/lang dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t){var x=p([w,l],{baseClass:"plugin-app-list",templateString:h,label:"applist",apps:null,templates:null,_appPages:null,_tempaltePage:null,_appPageState:null,_tempaltePageState:null,_currentPageState:null,_refreshImageFlag:null,postMixInProperties:function(){this.inherited(arguments);this.nls=n.mixin(this.nls,builderNls)},constructor:function(){this.apps=[];this.templates=[];this._appPages=[];this._appPageState={name:x.APP_PAGE,shownType:x.APP_TYPE_ALL,
sortBy:x.SORT_BY_MODIFIED_TIME,searchKey:""};this._tempaltePageState={name:x.TEMPLATE_PAGE,shownType:x.APP_TYPE_ALL,sortBy:x.SORT_BY_MODIFIED_TIME,searchKey:""};this._currentPageState=this._appPageState;this._refreshImageFlag=new Date},startup:function(){this.inherited(arguments);this.loading=new k({hidden:!0});this.loading.placeAt(this.domNode);this.importDijit=(new c({appListWidget:this})).placeAt(this.importBtn);var b=new u({appListWidget:this});this._addAppPage(b,"card-page2",this.nls.gridView);
b=new a({appListWidget:this});this._addAppPage(b,"catalog-page",this.nls.listView);this.refreshAppPage();this._tempaltePage=new v({appListWidget:this});this._tempaltePage.placeAt(this.templateContent);this.refreshTemplatePage();this._bindEvent()},_addAppPage:function(a,b,c){var d=f.create("div",{"class":"app-page-box"},this.appContent);a.placeAt(d);var e=f.create("div",{"class":"switch-app-page-btn jimu-float-leading "+b,title:c},this.switchAppPapgeBox);this.own(r(e,"click",n.hitch(this,function(){g(".app-page-box",
this.contentBox).removeClass("selected");f.addClass(d,"selected");g(".switch-app-page-btn",this.switchAppPapgeBox).removeClass("selected");f.addClass(e,"selected")})));0===this._appPages.length&&(f.addClass(d,"selected"),f.addClass(e,"selected"));this._appPages.push(a)},refreshAppPage:function(a){var c=new m;a?c.resolve():this.getAppList().then(n.hitch(this,function(a){this._currentPageState.sortBy!==x.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initApps(a);c.resolve()}));c.then(n.hitch(this,function(){var a=
this.filter(this.apps),c=this.filter(this.templates);b.forEach(this._appPages,function(b){b.refresh(a,c)},this)}))},refreshTemplatePage:function(a){var b=new m;a?b.resolve():this.getTemplateList().then(n.hitch(this,function(a){this._currentPageState.sortBy!==x.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initTemplates(a);b.resolve()}));b.then(n.hitch(this,function(){var a=this.filter(this.templates);this._tempaltePage.refresh(a)}))},refreshCurrentPage:function(a,b){this._currentPageState.name===
x.APP_PAGE?this.refreshAppPage(a):this._currentPageState.name===x.TEMPLATE_PAGE&&this.refreshTemplatePage(b)},getRefreshImageFlag:function(){return this._refreshImageFlag.getTime()},resetRefreshImageFlag:function(){this._refreshImageFlag=new Date},initApps:function(a){this.apps=this._filterItemByCondition(a);this.apps=this._mixinExtraProperties(this.apps)},initTemplates:function(a){this.templates=this._filterItemByCondition(a);this.templates=this._mixinExtraProperties(this.templates)},setApps:function(a){this.apps=
a},setTemplates:function(a){this.templates=a},_filterItemByCondition:function(a){var c=[];return c=b.filter(a,function(a){return window.isPortalSupport3D||a.appType!==x.APP_TYPE_3D?!0:!1},this)},_mixinExtraProperties:function(a){b.forEach(a,function(a){a.isTemplate||a.icon||(a.icon=a.themeName?"/webappbuilder/apps/"+a.id+"/themes/"+a.themeName+"/images/icon.png":"/webappbuilder/builder/images/logo.png",a._defaultIconClass="default-icon");a.downloadUrl="/webappbuilder/rest/apps/"+a.id+"/download";
var b="stemapp/index.html?id\x3d"+a.id;a.isPredefined&&(b+="\x26ispredefined\x3dtrue");a.appUrl=b;a.styleColor||(a.styleColor=x.DEFAULT_APP_STYLE_COLOR);a.id===x.ID_OF_BASIC_VIEWER_TEMPLATE?a.description=this.nls.basicViewerTemplateDesc:a.id===x.ID_OF_EDITOR_TEMPLATE?a.description=this.nls.editorTemplateDesc:a.id===x.ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE&&(a.description=this.nls.simpleMapViewerTemplateDesc)},this);return a},getAppList:function(){return q.getAppList()},getTemplateList:function(){return q.getTemplateList().then(function(a){return b.filter(a,
function(a){return a.isTemplate})})},updateApp:function(a){return q.updateApp(a)},_getLocaleDateTime:function(a){return d.localizeDate(new Date(a),{fullYear:!0,selector:"date",formatLength:"medium"})},filter:function(a){a=this._filterByType(a);return a=this._filterBySearch(a)},_filterByType:function(a){var c=[];return c=this._currentPageState.shownType===x.APP_TYPE_ALL?a:b.filter(a,function(a){return a.appType===this._currentPageState.shownType},this)},_filterBySearch:function(a){var c=[],d=this._currentPageState.searchKey.toLowerCase();
return d?(b.forEach(a,function(a){0<=(a.name+" "+a.description+""+this._getLocaleDateTime(a.lastUpdated)+" "+a.creator+" "+a.modified).toLowerCase().indexOf(d)&&c.push(a)},this),c):a},_sort:function(a){var b=this._currentPageState.sortBy;a.sort(function(a,c){return a[b]&&c[b]?b===x.SORT_BY_MODIFIED_TIME?a[b]>c[b]?-1:1:a[b]<c[b]?-1:1:a[b]?-1:1});return a},_resetAppStateUI:function(){g(".filter",this.filterBox).removeClass("selected");var a=g("#"+this._currentPageState.shownType,this.filterBox)[0];
a&&f.addClass(a,"selected");g(".sort",this.sortBox).removeClass("selected");(a=g("#"+this._currentPageState.sortBy,this.sortBox)[0])&&f.addClass(a,"selected");this.searchBox.setValue(this._currentPageState.searchKey)},_addEmptyDescription:function(a,b){var c=f.create("div",{"class":"empty-description-box "+(b?b:"")},a),d=this.nls.appCreate,e=t.substitute({action:"\x3cspan\x3e"+d+"\x3c/span\x3e"},this.nls.emptyDescForCreate),d=this.nls.appImport,d=t.substitute({action:"\x3cspan\x3e"+d+"\x3c/span\x3e"},
this.nls.emptyDescForImport);f.create("div",{"class":"empty-description",innerHTML:e+"\x3cbr\x3e"+d},c)},_bindEvent:function(){this.own(e.subscribe("switchToAppListApps",n.hitch(this,this._onSwitchToAppContent)));this.own(e.subscribe("switchToAppListTemplates",n.hitch(this,this._onSwitchToTemplateContent)))},_onSwitchToAppContent:function(){f.removeClass(this.templateContent,"selected");f.addClass(this.appContent,"selected");this._currentPageState=this._appPageState;this._resetAppStateUI();f.removeClass(this.switchAppPapgeBox,
"hidden");f.setStyle(this.importDijit.itemImportBtn,"display","block");f.setStyle(this.createNewBtn,"display","block");f.setStyle(this.sortByAuthorBtn,"display","none")},_onSwitchToTemplateContent:function(){f.removeClass(this.appContent,"selected");f.addClass(this.templateContent,"selected");this._currentPageState=this._tempaltePageState;this._resetAppStateUI();f.addClass(this.switchAppPapgeBox,"hidden");f.setStyle(this.importDijit.itemImportBtn,"display","none");f.setStyle(this.createNewBtn,"display",
"none");f.setStyle(this.sortByAuthorBtn,"display","block")},_onSearchBoxChange:function(){this._currentPageState.searchKey=this.searchBox.getValue();this.refreshCurrentPage(!0,!0)},_filterAllBtnClick:function(){this._filterAppTypeBtnClick(this.filterAllBtn,x.APP_TYPE_ALL)},_filter2dBtnClick:function(){this._filterAppTypeBtnClick(this.filter2dBtn,x.APP_TYPE_2D)},_filter3dBtnClick:function(){this._filterAppTypeBtnClick(this.filter3dBtn,x.APP_TYPE_3D)},_filterAppTypeBtnClick:function(a,b){this._currentPageState.shownType!==
b&&(g(".filter",this.filterBox).removeClass("selected"),f.addClass(a,"selected"),this._currentPageState.shownType=b,this.refreshCurrentPage(!0,!0))},_sortByModifiedTimeBtnClick:function(){this._sortBtnClick(this.sortByModifiedTimeBtn,x.SORT_BY_MODIFIED_TIME)},_sortByNameBtnClick:function(){this._sortBtnClick(this.sortByNameBtn,x.SORT_BY_NAME)},_sortByAuthorBtnClick:function(){this._sortBtnClick(this.sortByAuthorBtn,x.SORT_BY_AUTHOR)},_sortBtnClick:function(a,b){this._currentPageState.sortBy!==b&&
(this._currentPageState.sortBy=b,g(".sort",this.sortBox).removeClass("selected"),f.addClass(a,"selected"),this._currentPageState.name===x.APP_PAGE?this.setApps(this._sort(this.apps)):this._currentPageState.name===x.TEMPLATE_PAGE&&this.setTemplates(this._sort(this.templates)),this.refreshCurrentPage(!0,!0))},_onCreateClick:function(){var a=this.pluginManager.getExtensions("startup.creation-entry")[0],a=this.pluginsMeta[a.pluginName];this.loading.show("");this.pluginManager.loadPlugin(a).then(n.hitch(this,
function(a){a.popupNewCreateDlg();this.loading.hide()}),n.hitch(this,function(){this.loading.hide()}))}});n.mixin(x,{APP_TYPE_ALL:"ALL",APP_TYPE_2D:"HTML",APP_TYPE_3D:"HTML3D",SORT_BY_MODIFIED_TIME:"lastUpdated",SORT_BY_NAME:"name",SORT_BY_AUTHOR:"creator",APP_PAGE:"appPage",TEMPLATE_PAGE:"templatePage",DEFAULT_APP_STYLE_COLOR:"#596679",ID_OF_BASIC_VIEWER_TEMPLATE:"HTML_basic_viewer",ID_OF_EDITOR_TEMPLATE:"HTML_editor",ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE:"HTML_simple_map_viewer"});return x})},"builder/plugins/app-list/Import":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./Import.html dojo/on dojo/_base/lang dojo/sniff builder/serviceUtils dojo/query jimu/dijit/Message jimu/dijit/ItemSelector jimu/dijit/Popup builder/portalUtils esri/lang builder/dijit/FullScreenPopup dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d){return p([b,m,l],{baseClass:"import-app",templateString:h,_itemSelector:null,_importPopup:null,nls:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading},startup:function(){this.inherited(arguments);this.own(r(window.document,"click",n.hitch(this,function(a){a.clickFromSelf||setTimeout(n.hitch(this,function(){f.setStyle(this.actionsMenu,"display","none");window.isRTL?f.setStyle(this.actionsMenu,
{left:"auto",right:0}):f.setStyle(this.actionsMenu,{right:"auto",left:0});f.removeClass(this.actionsNode,"actions-drop-down")}),50)})));this._applyZipToFileInput();this.appPortalUrlInputNode&&(this.appPortalUrlInputNode.value=window.portalUrl);this._keepFileChooserOverItem()},_applyZipToFileInput:function(){c('input[type\x3d"file"]',this.appFileInputNode.domNode).forEach(n.hitch(this,function(a){f.setAttr(a,"accept",".zip")}))},_keepFileChooserOverItem:function(){9>=g("ie")&&c("span.dijitUploader input:first-child",
this.domNode).forEach(n.hitch(this,function(a){window.isRTL?f.setStyle(a,{left:"33px",right:"auto"}):f.setStyle(a,"right","33px")}))},_onActionsLabelClick:function(a){var b=f.getMarginBox(window.jimuConfig.layoutId),c=null;"none"===f.getStyle(this.actionsMenu,"display")?(f.setStyle(this.actionsMenu,"display","block"),c=f.position(this.actionsMenu),window.isRTL?0>c.x&&f.setStyle(this.actionsMenu,{right:"auto",left:0}):c.x+c.w>b.w&&f.setStyle(this.actionsMenu,{left:"auto",right:0})):(f.setStyle(this.actionsMenu,
"display","none"),c=f.position(this.actionsMenu),window.isRTL?f.setStyle(this.actionsMenu,{left:"auto",right:0}):f.setStyle(this.actionsMenu,{right:"auto",left:0}));a.clickFromSelf=!0},_onMenuItemClick:function(a){setTimeout(n.hitch(this,function(){f.setStyle(this.actionsMenu,"display","none");f.removeClass(this.actionsNode,"actions-drop-down");a.stopPropagation()}),50)},_onAppFileUploadError:function(b){console.error(b);new a({message:b.message||b});this._keepFileChooserOverItem();this._applyZipToFileInput();
this.loading.hide()},_onAppFileUploadComplete:function(a){a.success?(this._refreshAppOrTemplatePage(),this._keepFileChooserOverItem(),this._applyZipToFileInput(),this.loading.hide()):this._onAppFileUploadError(a)},_onAppFileChange:function(){var b=this.appFileInputNode.getFileList();b&&0<b.length&&(/.+(\.zip)$/.test(b[0].name)?(this.loading.show(this.nls.uploading),q.getPortal(window.portalUrl).getUser().then(n.hitch(this,function(a){f.setAttr(this.appFileCreatorInputNode,"value",a.username);f.setAttr(this.fromListNode,
"value",this._currentShownList);this.appFileInputNode.submit(this.uploadAppFileFormNode)}),function(b){console.error(b);new a({message:b.message||b});this.loading.hide()})):new a({message:this.nls.fileTypeError}))},_onImportClick:function(){this._itemSelector=new u({portalUrl:window.portalUrl,itemTypes:["Web Mapping Application"],onlyShowOnlineFeaturedItems:!1,typeKeywords:["Web AppBuilder"],showOnlineItems:!1});this.own(r(this._itemSelector,"item-selected",n.hitch(this,function(){this._importPopup.enableButton(0)})));
this.own(r(this._itemSelector,"none-item-selected",n.hitch(this,function(){this._importPopup.disableButton(0)})));var a=c("#main-page")[0];this._importPopup=new d({zIndex:101,titleStr:this.nls.importApp,blurContainer:a.firstElementChild,content:this._itemSelector.domNode,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:n.hitch(this,this._onImportOkClick)},{label:this.nls.cancel,isHighLight:!1,onClick:n.hitch(this,this._onImportCancelClick)}],contentAutoHeight:!0});this._importPopup.placeAt(a);this._importPopup.show();
this._importPopup.disableButton(0);this._itemSelector.startup();this.own(r(this._itemSelector.tab,"tabChanged",n.hitch(this,function(){window.setTimeout(n.hitch(this,function(){this._importPopup.resize()},100))})));this.own(r(this._itemSelector,"update",n.hitch(this,function(){this._importPopup.resize()})))},_onImportOkClick:function(){var a=this._itemSelector.getSelectedItem();this.loading.show();q.getPortal(window.portalUrl).getUser().then(n.hitch(this,function(b){a.getItemData().then(n.hitch(this,
function(c){this.loading.hide();this._importPopup.close();c=n.clone(c);this._checkAppVersion(c,{creator:b.username,name:a.title,description:a.description||"",appType:a.typeKeywords&&0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML",stemappPath:this.appListWidget.pluginManager.getStemappInfo("HTML").appPath,portalUrl:window.portalUrl,isTemplate:!1,isTemplateApp:!1,isPredefined:!1})}),n.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))}),n.hitch(this,function(b){this.loading.hide();
this._checkAppInfoError(a.title,b)}))},_checkAppVersion:function(a,b){this.loading.show(this.nls.importing);e.checkAppVersion(a,b).then(n.hitch(this,function(c){this.loading.hide();c=c.versionInfo;"old"===c.wabVersionStatus?this._doAction("upgrade",a,b):"new"===c.wabVersionStatus?this._showNewer(b.name,c.appVersion):"same"===c.wabVersionStatus&&this._doAction("import",a,b)}),n.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppInfoError:function(b,c){new a({message:k.substitute({APP_NAME:b},
this.nls.checkVersionError)});console.error(c)},_showUpgrade:function(a,b,c){c="\x3cdiv style\x3d'font-size:14px;'\x3e"+k.substitute({OLD_VERSION:c.appVersion,LATEST_VERSION:c.latestVersion},this.nls.upgradeContent)+"\x3cdiv style\x3d'height:24px;'\x3e\x3c/div\x3e"+this.nls.upgradeContentFooter+"\x3c/div\x3e";var d=new v({titleLabel:this.nls.upgradeApp,content:f.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.upgradeBtn,onClick:n.hitch(this,function(){d.close();this._doAction("upgrade",
a,b)})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:n.hitch(this,function(){d.close()})}]})},_showNewer:function(a,b){var c="\x3cdiv style\x3d'font-size:14px;'\x3e"+k.substitute({APP_NAME:a,VERSION_NUMBER:b},this.nls.importUpperVertion)+"\x3c/div\x3e";new v({titleLabel:this.nls.importApp,content:f.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})},_doAction:function(a,b,c){"import"===a?this.loading.show(this.nls.importing):"upgrade"===a&&this.loading.show(this.nls.upgrading);
e.importPortalApp(b,c).then(n.hitch(this,function(){this._importSuccess(c.appName)}),n.hitch(this,function(a){this.loading.hide();this._importError(c.appName,a)}))},_importSuccess:function(a){this.appListWidget.getAppList().then(n.hitch(this,function(){this._refreshAppOrTemplatePage();var b="\x3cdiv style\x3d'font-size:14px;'\x3e"+k.substitute({APP_NAME:a},this.nls.importSuccess)+"\x3c/div\x3e";new v({titleLabel:this.nls.importApp,content:f.toDom(b),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})}),
n.hitch(this,function(a){console.error(a)})).always(n.hitch(this,function(){this.loading.hide()}))},_importError:function(a,b){var c="\x3cdiv style\x3d'font-size:14px;'\x3e"+k.substitute({APP_NAME:a},this.nls.upgradeFailure)+"\x3c/div\x3e";new v({titleLabel:this.nls.importApp,content:f.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]});console.error(b)},_onImportCancelClick:function(){this._importPopup.close()},_refreshAppOrTemplatePage:function(){this.appListWidget.refreshTemplatePage();
this.appListWidget.refreshAppPage()}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z){return p([b,m,l,r],{templateString:h,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,postMixInProperties:function(){this.portalUrl=t.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";e.forEach(this.itemTypes,n.hitch(this,function(a,b){this._itemTypes+='"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+
"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";e.forEach(this.typeKeywords,n.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();this.portal=d.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();
this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=k.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=k.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){this.tab=new y({tabs:[{title:this.nls.myContent,content:this.mycontentTabNode},{title:this.nls.myOrganization,content:this.organizationTabNode},{title:this.nls.myGroup,content:this.groupTabNode},{title:this.nls.publicMap,
content:this.publicTabNode}]},this.tabNode);this.own(q(this.tab,"tabChanged",n.hitch(this,function(a){c.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){c.setStyle(this.signinSection,"display","none");var a=v(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);w.userHaveSignInPortal(this._getPortalUrl())?a.style("display",
"block"):(a.style("display","none"),this._isPublicTabShow||c.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){k.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalPublicLabel);k.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlinePublicLabel);var a=this._getPortalUrl(),a=t.getServerByUrl(a);this.portalPublicRaido.disabled=!1;this.onlinePublicRaido.disabled=!1;this.portalPublicRaido.checked=!0;var b=!1;t.isArcGIScom(a)?(b=!0,this.portalPublicLabel.innerHTML=
"ArcGIS.com"):(this.portalPublicLabel.innerHTML=a,b=this.showOnlineItems?!1:!0);b&&(this.onlinePublicRaido.disabled=!0,c.setStyle(this.onlinePublicRaido,"display","none"),c.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(g.locale&&g.locale.slice(0,2)||"en").toLowerCase(),b=e.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
n.hitch(this,function(b){return b!==a})),c="";e.forEach(b,n.hitch(this,function(a){c+=" -owner:"+a+" "}));b=" ";this.portal&&this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._itemTypeQueryString+" AND access:public "+c+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:b});this._filterPublicPortalQuery=this._getQuery({q:b,basicQ:b});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return n.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return t.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(q(this.publicPortalItemTable,"item-dom-clicked",n.hitch(this,this._onItemDomClicked)));this.own(q(this.publicOnlineItemTable,"item-dom-clicked",n.hitch(this,this._onItemDomClicked)));this.own(q(this.organizationItemTable,"item-dom-clicked",n.hitch(this,this._onItemDomClicked)));this.own(q(this.groupItemTable,"item-dom-clicked",n.hitch(this,this._onItemDomClicked)));
this.own(q(this.mycontentItemTable,"item-dom-clicked",n.hitch(this,this._onItemDomClicked)));this.own(q(this.publicPortalItemTable,"update",n.hitch(this,this._onItemTableUpdate)));this.own(q(this.publicOnlineItemTable,"update",n.hitch(this,this._onItemTableUpdate)));this.own(q(this.organizationItemTable,"update",n.hitch(this,this._onItemTableUpdate)));this.own(q(this.groupItemTable,"update",n.hitch(this,this._onItemTableUpdate)));this.own(q(this.mycontentItemTable,"update",n.hitch(this,this._onItemTableUpdate)));
var a=this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.disabled||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",this._filterPublicOnlineQuery))},
_initPublic:function(){this.own(q(this.portalPublicRaido,"click",n.hitch(this,this._onPublicRaidoClicked)));this.own(q(this.onlinePublicRaido,"click",n.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},_onPublicSearch:function(a){(a=a&&n.trim(a))?
(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=
1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(q(this.groupsSelect,"change",n.hitch(this,this._onGroupsSelectChange)));var a=t.getServerByUrl(this._getPortalUrl());t.isArcGIScom(a)&&(a="ArcGIS.com");w.userHaveSignInPortal(this._getPortalUrl())&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&n.trim(a)){if(this._allOrganizationQuery){var b=
this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&n.trim(a)){if(this._allMyContentQuery){var b=this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+b,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},
_onGroupSearch:function(a){if(a=a&&n.trim(a)){if(this._allGroupQuery){var b=this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=!0;var a=this._getPortalUrl();d.getPortal(a).getUser().then(n.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),
this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();a=" orgid:"+a.orgId+" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=
this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",
b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();c.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){c.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();c.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var d=a[b];c.create("option",{value:d.id,innerHTML:d.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){c.setStyle(this.groupsSection,
"display","none");c.empty(this.groupsSelect);c.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();c.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?c.setStyle(this.groupsSection,"top","15px"):c.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)c.setStyle(this.groupSearch,
"display","none"),this.groupItemTable.hide();else{c.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupItemTable.set("portalUrl",b);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(a){var b=
c.hasClass(a,"jimu-state-active");v(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");b&&c.addClass(a,"jimu-state-active");(a=this.getSelectedItem())?this.emit("item-selected",a):this.emit("none-item-selected")},getSelectedItem:function(){var a=null,b=v(".item.jimu-state-active",this.domNode);0<b.length&&(a=n.mixin({},b[0].item));return a}})})},"jimu/dijit/Search":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/string","dijit/_WidgetBase","dijit/_TemplatedMixin"],
function(p,f,b,m,l){return p([m,l],{baseClass:"jimu-search",declaredClass:"jimu.dijit.Search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn jimu-icon jimu-icon-search" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',
placeholder:"",onSearch:null,searchWhenInput:!1,postCreate:function(){this.inherited(arguments);this.placeholder&&f.setAttr(this.inputSearch,"placeholder",this.placeholder)},getValue:function(){return b.trim(this.inputSearch.value)},doSearch:function(){if(this.onSearch)this.onSearch(this.getValue())},_onKeyDown:function(b){13===(void 0!==b.keyCode?b.keyCode:b.which)&&this.doSearch();b.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()}})})},
"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){return p([n,g,h],{templateString:e,selected:"",tabs:null,average:!1,baseClass:"jimu-tab3",declaredClass:"jimu.dijit.TabContainer3",_currentIndex:-1,postCreate:function(){this.inherited(arguments);this._initSelf();
this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(a){var c=r("td",this.tabTr);b.forEach(c,f.hitch(this,function(b,c){m.removeClass(b,"jimu-state-active");b.label===a&&(m.addClass(b,"jimu-state-active"),this._currentIndex=c)}));this.controlNode.removeChild(this.controlTable);m.place(this.controlTable,this.controlNode);this.viewStack.switchView(a);this.emit("tabChanged",a)},addTab:function(a){if(!this.average){var c=r("td:last-child",
this.tabTr);0<c.length&&m.destroy(c[0])}0<b.filter(this.tabs,function(b){return b.title===a.title}).length?console.error("tab title conflict: "+a.title):(this.tabs.push(a),this._createTab(a),this.average||(c=m.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'),m.place(c,this.tabTr)))},removeTab:function(a){var c=-1;if(b.some(this.tabs,function(b,e){if(b.title===a)return c=e,!0})){var e=this.tabs.splice(c,
1)[0],f=r("td",this.tabTr),g;b.some(f,function(b){if(b.label===a)return g=b,!0})&&m.destroy(g);this.viewStack.removeView(e.content)}},showShelter:function(){m.setStyle(this.shelter,"display","block")},hideShelter:function(){m.setStyle(this.shelter,"display","none")},getSelectedIndex:function(){return this._currentIndex},getSelectedTitle:function(){return this.viewStack.getSelectedLabel()},_initSelf:function(){this.viewStack=new c(null,this.containerNode);b.forEach(this.tabs,function(a){this._createTab(a)},
this);if(this.average)this.controlTable.style.tableLayout="fixed";else{var a=m.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');m.place(a,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},_createTab:function(a){var b=m.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');b.label=a.title||"";m.place(b,this.tabTr);var c=
r(".tab-item-div",b)[0];c.innerHTML=b.label;c.label=b.label;a.content.label=b.label;this.viewStack.addView(a.content);this.own(l(b,"click",f.hitch(this,this._onSelect,a.title)))},_onSelect:function(a){this.selectTab(a)}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k){return p([f,b,m,h],{templateString:l,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"webapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||
(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=q.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},show:function(){g.setStyle(this.domNode,"display","block")},hide:function(){g.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=r.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),
v.getPortal(this.portalUrl).queryItems(this.query).then(r.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),r.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=r.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&
(this.filteredItemShelter.show(),v.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(r.hitch(this,function(b){this.domNode&&(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),this.filteredQuery.start=b.nextStart,this._createItems(b,this.filteredItemsTbody),this._filterItemCallback())}),r.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?
(g.setStyle(this.filteredItemsTableDiv,"display","block"),g.setStyle(this.searchNoneTipSection,"display","none")):(g.setStyle(this.filteredItemsTableDiv,"display","none"),g.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){g.empty(this.allItemTbody)},clearFilteredItemsSection:function(){g.empty(this.filteredItemsTbody)},showAllItemsSection:function(){g.setStyle(this.allItemsSection,
"display","block");g.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){g.setStyle(this.allItemsSection,"display","none");g.setStyle(this.filteredItemsSection,"display","block");g.setStyle(this.filteredItemsTableDiv,"display","block");g.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&
this.searchFilteredItems()},_isScrollToBottom:function(a){return u.isScrollToBottom(a)},_createItems:function(a,b){var d=a.results,e=n.map(this.types,r.hitch(this,function(a){return a.toLowerCase()})),d=n.filter(d,r.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=n.indexOf(e,a)}));if(0!==d.length){var f,k=c("td.empty",b),h;if(0<k.length){var l=Math.min(d.length,k.length),m=d.splice(0,l);for(h=0;h<l;h++){var q=k[h];f=this._createItem(m[h]);g.place(f,q);g.removeClass(q,"empty")}}if(0!==
d.length){k=Math.ceil(d.length/2);for(h=0;h<k;h++)for(f=g.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),g.place(f,b),l=c("td",f),m=0;m<l.length;m++)q=l[m],(f=d[2*h+m])?(f=this._createItem(f),g.place(f,q)):g.addClass(q,"empty");this.emit("update")}}},_getItemCount:function(a){return c(".item",a).length},_createItem:function(a){var b=g.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
b.item=a;var d=c(".item-thumbnail",b)[0],e=c(".item-name",b)[0],f=c(".item-type-owner",b)[0],k=c(".item-date",b)[0],h=c(".item-details",b)[0],l=c(".none-thumbnail-tip",b)[0];if(!a.thumbnailUrl){var m=this._defaultThumbnail[a.type];m&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+m)}a.thumbnailUrl?g.setStyle(d,"backgroundImage","url("+a.thumbnailUrl+")"):l.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(k=c(".item-info",b)[0],this.onCreateItemContent(a,k)):(e.innerHTML=
a.title,e.title=e.innerHTML,f.innerHTML=a.type+" by "+a.owner,f.title=f.innerHTML,d=new Date,d.setTime(a.modified),k.innerHTML=d.toLocaleString(),k.title=k.innerHTML,h.innerHTML=this.nls.moreDetails,h.href=a.detailsPageUrl||"#");return b},_onItemsTableClicked:function(a){var b=a.target||a.srcElement;a=null;g.hasClass(b,"item-thumbnail")?a=b.parentNode:g.hasClass(b,"none-thumbnail-tip")&&(a=b.parentNode.parentNode);a&&(b=g.hasClass(a,"jimu-state-active"),c(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
b?g.removeClass(a,"jimu-state-active"):g.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=null,b=c(".item.jimu-state-active",this.domNode);0<b.length&&(a=r.mixin({},b[0].item));return a}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(p,f,b,m){return p(f,{baseClass:"jimu-loading-indicator",declaredClass:"jimu.dijit.LoadingIndicator",hidden:!1,postCreate:function(){this.inherited(arguments);
(this.hidden=!0===this.hidden)&&b.set(this.domNode,{display:"none"});b.set(this.domNode,{width:"100%",height:"100%"});var f='\x3cdiv class\x3d"loading-section"\x3e\x3cimg class\x3d"jimu-loading" src\x3d"'+require.toUrl("jimu")+'/images/loading2.gif"\x3e\x3c/div\x3e';m.place(f,this.domNode)},show:function(){this.domNode&&b.set(this.domNode,"display","block")},hide:function(){this.domNode&&b.set(this.domNode,"display","none")}})})},"builder/dijit/FullScreenPopup":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/html dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dom-attr dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FullScreenPopup.html dojo/on dojo/throttle".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){return f([n,g,e],{templateString:c,baseClass:"fullscreen-popup-container",isShow:!1,position:{},_zIndexIncrease:0,_btns:[],postCreate:function(){this.inherited(arguments);this._btns=[];this.outerMainPage=this.blurContainer?this.blurContainer:null;this._zIndexIncrease=this.zIndex?this.zIndex:1;h.set(this.domNode,"z-index",this._zIndexIncrease++);h.set(this.background,"display","block");h.set(this.background,"z-index",this._zIndexIncrease++);h.set(this.main,"z-index",
this._zIndexIncrease++);h.set(this.fullscreenPopupBtns,"z-index",this._zIndexIncrease++);if(this.buttons)for(var c=0,e=this.buttons.length;c<e;c++){var f=this.buttons[c],d=b.create("input",{"class":"btn",type:"button",value:f.label},this.fullscreenPopupBtns);f.isHighLight&&m.add(d,"light");f.onClick&&this.own(a(d,"click",f.onClick));this._btns.push(d)}this.contentAutoHeight&&m.add(this.main,"autoHeight");this.own(a(window,"resize",u(p.hitch(this,this.resize)),50));this.own(a(this.fullscreenPopupContent,
"DOMNodeInserted,DOMNodeRemoved",u(p.hitch(this,this.resize)),100))},startup:function(){this.hide();this.refresh()},destroy:function(){this.subDijit&&(this.subDijit.destroy(),this.subDijit=null);this._btns=[];b.destroy(this.domNode);this.inherited(arguments)},refresh:function(){this.fullscreenPopupTitle.innerHTML=this.titleStr;l.place(this.content,this.fullscreenPopupContent);this.resize()},show:function(){b.setStyle(this.domNode,"display","block");this.isShow=!0;this.refresh()},hide:function(){b.setStyle(this.domNode,
"display","none");m.remove(this.outerMainPage,"glass-blur");this.isShow=!1;this.destroy()},enableButton:function(a){a=this._btns[a];r.remove(a,"disabled");return a},disableButton:function(a){a=this._btns[a];r.set(a,{disabled:"disabled"});return a},close:function(){this._onCloseClick()},setTitle:function(a){a&&(this.fullscreenPopupTitle.innerHTML=a)},setSubTitle:function(a){},resize:function(){this.btnsAtuoBottom&&this._setBtnsAutoBottom();this.contentAutoHeight&&this._setContentAutoHeight()},_onContainerClick:function(a){a.stopPropagation();
return!1},_onCloseClick:function(){this.hide()},_ieBlurPolyfill:function(){},_setBtnsAutoBottom:function(){var a=this.head;this._footerMarginTop||(this._footerMarginTop=h.get(this.fullscreenPopupBtns,"margin-top"));this._footerPaddingTopHeight||(this._footerPaddingTopHeight=h.get(this.fullscreenPopupBtnsContainer,"padding-top"));this._footerPaddingBottomHeight||(this._footerPaddingBottomHeight=h.get(this.fullscreenPopupBtnsContainer,"padding-bottom"));this._footerHeight||(this._footerHeight=h.get(this.fullscreenPopupBtns,
"height"));document.body.clientHeight-a.clientHeight-(this._footerMarginTop+this._footerHeight+this._footerPaddingTopHeight+this._footerPaddingBottomHeight)<this.fullscreenPopupContent.scrollHeight?(h.set(this.contentScroller,"height",document.body.clientHeight-a.clientHeight-this._footerMarginTop-this._footerPaddingTopHeight-this._footerPaddingBottomHeight+"px"),h.set(this.fullscreenPopupBtns,"margin-top","0")):(h.set(this.contentScroller,"height",this.fullscreenPopupContent.scrollHeight+"px"),h.set(this.fullscreenPopupBtns,
"margin-top",this._footerMarginTop+"px"))},_setContentAutoHeight:function(){m.add(this.main,"autoHeight");var a=this.head.scrollHeight,b=this.fullscreenPopupBtnsContainer.scrollHeight,c=h.get(this.fullscreenPopupBtns,"margin-top");h.set(this.contentScroller,"height",document.body.clientHeight-a-b-c+"px")}})})},"dojo/throttle":function(){define([],function(){return function(p,f){var b=!0;return function(){b&&(b=!1,p.apply(this,arguments),setTimeout(function(){b=!0},f))}}})},"dojox/form/Uploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/dom-attr dojo/dom-construct dojo/dom-form dijit dijit/form/Button ./uploader/_Base ./uploader/_HTML5 ./uploader/_IFrame ./uploader/_Flash dojo/i18n!./nls/Uploader dojo/text!./resources/Uploader.html".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x){return f("dojox.form.Uploader",[q,v,k,d,w],{uploadOnSelect:!1,tabIndex:0,multiple:!1,label:t.label,url:"",name:"uploadedfile",flashFieldName:"",force:"",uploadType:"",showInput:"",focusedClass:"dijitButtonHover",_nameIndex:0,templateString:x,baseClass:"dijitUploader "+v.prototype.baseClass,postMixInProperties:function(){this._inputs=[];this._cons=[];this.force=this.force.toLowerCase();this.supports("multiple")?this.uploadType="form"===this.force?"form":
"html5":this.uploadType="flash"===this.force?"flash":"iframe";this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);r.set(this.domNode,{overflow:"hidden",position:"relative"});this._buildDisplay();e.set(this.titleNode,"tabIndex",-1)},_buildDisplay:function(){this.showInput&&(this.displayInput=c.create("input",{"class":"dijitUploadDisplayInput",tabIndex:-1,autocomplete:"off",role:"presentation"},this.containerNode,this.showInput),this._attachPoints.push("displayInput"),this.connect(this,
"onChange",function(a){for(var b=0,c,d=[];c=a[b++];)c&&c.name&&d.push(c.name);this.displayInput.value=d.join(", ")}),this.connect(this,"reset",function(){this.displayInput.value=""}))},startup:function(){this._buildInitialized||(this._buildInitialized=!0,this._getButtonStyle(this.domNode),this._setButtonStyle(),this.inherited(arguments))},onChange:function(a){},onBegin:function(a){},onProgress:function(a){},onComplete:function(a){this.reset()},onCancel:function(){},onAbort:function(){},onError:function(a){},
upload:function(a){a=a||{};a.uploadType=this.uploadType;this.inherited(arguments)},submit:function(b){b=b?b.tagName?b:this.getForm():this.getForm();b=a.toObject(b);b.uploadType=this.uploadType;this.upload(b)},reset:function(){delete this._files;this._disconnectButton();m.forEach(this._inputs,c.destroy);this._inputs=[];this._nameIndex=0;this._createInput()},getFileList:function(){var a=[];this.supports("multiple")?m.forEach(this._files,function(b,c){a.push({index:c,name:b.name,size:b.size,type:b.type})},
this):m.forEach(this._inputs,function(b,c){b.value&&a.push({index:c,name:b.value.substring(b.value.lastIndexOf("\\")+1),size:0,type:b.value.substring(b.value.lastIndexOf(".")+1)})},this);return a},_getValueAttr:function(){return this.getFileList()},_setValueAttr:function(a){console.error("Uploader value is read only")},_setDisabledAttr:function(a){this.disabled!=a&&this.inputNode&&(this.inherited(arguments),r.set(this.inputNode,"display",a?"none":""))},_getButtonStyle:function(a){this.btnSize={w:r.get(a,
"width"),h:r.get(a,"height")}},_setButtonStyle:function(){this.inputNodeFontSize=Math.max(2,Math.max(Math.ceil(this.btnSize.w/60),Math.ceil(this.btnSize.h/15)));this._createInput()},_getFileFieldName:function(){return this.supports("multiple")&&this.multiple?this.name+"s[]":this.name+(this.multiple?this._nameIndex:"")},_createInput:function(){this._inputs.length&&(r.set(this.inputNode,{top:"500px"}),this._disconnectButton(),this._nameIndex++);var a=this._getFileFieldName();this.focusNode=this.inputNode=
c.create("input",{type:"file",name:a,"aria-labelledby":this.id+"_label"},this.domNode,"first");this.supports("multiple")&&this.multiple&&e.set(this.inputNode,"multiple",!0);this._inputs.push(this.inputNode);r.set(this.inputNode,{position:"absolute",fontSize:this.inputNodeFontSize+"em",top:"-3px",right:"-3px",opacity:0});this._connectButton()},_connectButton:function(){this._cons.push(l.connect(this.inputNode,"change",this,function(a){this._files=this.inputNode.files;this.onChange(this.getFileList(a));
!this.supports("multiple")&&this.multiple&&this._createInput()}));-1<this.tabIndex&&(this.inputNode.tabIndex=this.tabIndex,this._cons.push(l.connect(this.inputNode,"focus",this,function(){n.add(this.domNode,this.focusedClass)})),this._cons.push(l.connect(this.inputNode,"blur",this,function(){n.remove(this.domNode,this.focusedClass)})))},_disconnectButton:function(){m.forEach(this._cons,l.disconnect);this._cons.splice(0,this._cons.length)}})})},"dojox/form/uploader/_Base":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/has dojo/_base/declare dojo/_base/event dijit/_Widget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin".split(" "),
function(p,f,b,m,l,h,r,n,g,e){l.add("FormData",function(){return!!window.FormData});l.add("xhr-sendAsBinary",function(){var b=window.XMLHttpRequest&&new window.XMLHttpRequest;return b&&!!b.sendAsBinary});l.add("file-multiple",function(){return!!{"true":1,"false":1}[m.get(document.createElement("input",{type:"file"}),"multiple")]});return h("dojox.form.uploader._Base",[n,g,e],{getForm:function(){if(!this.form)for(var b=this.domNode;b&&b.tagName&&b!==document.body;){if("form"==b.tagName.toLowerCase()){this.form=
b;break}b=b.parentNode}return this.form},getUrl:function(){this.uploadUrl&&(this.url=this.uploadUrl);if(this.url)return this.url;this.getForm()&&(this.url=this.form.action);return this.url},connectForm:function(){this.url=this.getUrl();!this._fcon&&this.getForm()&&(this._fcon=!0,this.connect(this.form,"onsubmit",function(b){console.log("SUBMIT");r.stop(b);this.submit(this.form)}))},supports:function(b){switch(b){case "multiple":if("flash"==this.force||"iframe"==this.force)break;return l("file-multiple");
case "FormData":return l(b);case "sendAsBinary":return l("xhr-sendAsBinary")}return!1},getMimeType:function(){return"application/octet-stream"},getFileType:function(b){return b.substring(b.lastIndexOf(".")+1).toUpperCase()},convertBytes:function(b){var a=Math.round(b/1024*1E5)/1E5,c=Math.round(b/1048576*1E5)/1E5,e=Math.round(b/1073741824*1E5)/1E5,f=b;1<a&&(f=a.toFixed(1)+" kb");1<c&&(f=c.toFixed(1)+" mb");1<e&&(f=e.toFixed(1)+" gb");return{kb:a,mb:c,gb:e,bytes:b,value:f}}})})},"dojox/form/uploader/_HTML5":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo"],function(p,f,b,m){return p("dojox.form.uploader._HTML5",[],{errMsg:"Error uploading files. Try checking permissions",uploadType:"html5",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.connectForm();this.inherited(arguments);this.uploadOnSelect&&this.connect(this,"onChange",function(b){this.upload(b[0])})},_drop:function(b){m.stopEvent(b);this._files=b.dataTransfer.files;this.onChange(this.getFileList())},upload:function(b){this.onBegin(this.getFileList());
this.uploadWithFormData(b)},addDropTarget:function(b,f){f||(this.connect(b,"dragenter",m.stopEvent),this.connect(b,"dragover",m.stopEvent),this.connect(b,"dragleave",m.stopEvent));this.connect(b,"drop","_drop")},uploadWithFormData:function(f){if(this.getUrl()){var h=new FormData,l=this._getFileFieldName();b.forEach(this._files,function(b,e){h.append(l,b)},this);if(f){f.uploadType=this.uploadType;for(var m in f)h.append(m,f[m])}this.createXhr().send(h)}else console.error("No upload url found.",this)},
_xhrProgress:function(b){if(b.lengthComputable){var f={bytesLoaded:b.loaded,bytesTotal:b.total,type:b.type,timeStamp:b.timeStamp};"load"==b.type?(f.percent="100%",f.decimal=1):(f.decimal=b.loaded/b.total,f.percent=Math.ceil(b.loaded/b.total*100)+"%");this.onProgress(f)}},createXhr:function(){var b=new XMLHttpRequest,h;b.upload.addEventListener("progress",f.hitch(this,"_xhrProgress"),!1);b.addEventListener("load",f.hitch(this,"_xhrProgress"),!1);b.addEventListener("error",f.hitch(this,function(b){this.onError(b);
clearInterval(h)}),!1);b.addEventListener("abort",f.hitch(this,function(b){this.onAbort(b);clearInterval(h)}),!1);b.onreadystatechange=f.hitch(this,function(){if(4===b.readyState){clearInterval(h);try{this.onComplete(JSON.parse(b.responseText.replace(/^\{\}&&/,"")))}catch(r){console.error("Error parsing server result:",r),console.error(b.responseText),this.onError("Error parsing server result:",r)}}});b.open("POST",this.getUrl());b.setRequestHeader("Accept","application/json");h=setInterval(f.hitch(this,
function(){}),250);return b}})})},"dojox/form/uploader/_IFrame":function(){define("dojo/query dojo/dom-construct dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-form dojo/request/iframe".split(" "),function(p,f,b,m,l,h,r){return b("dojox.form.uploader._IFrame",[],{postMixInProperties:function(){this.inherited(arguments);"iframe"===this.uploadType&&(this.uploadType="iframe",this.upload=this.uploadIFrame)},uploadIFrame:function(b){var g={},e;this.getForm();var c=this.getUrl(),a=this;b=
b||{};b.uploadType=this.uploadType;e=f.place('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e\x3c/form\x3e',this.domNode);l.forEach(this._inputs,function(a,b){""!==a.value&&(e.appendChild(a),g[a.name]=a.value)},this);if(b)for(nm in b)void 0===g[nm]&&f.create("input",{name:nm,value:b[nm],type:"hidden"},e);r.post(c,{form:e,handleAs:"json",content:b}).then(function(b){f.destroy(e);if(b.ERROR||b.error)a.onError(b);else a.onComplete(b)},function(b){console.error("error parsing server result",
b);f.destroy(e);a.onError(b)})}})})},"dojox/form/uploader/_Flash":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/array dojox/embed/Flash".split(" "),function(p,f,b,m,l,h,r,n,g,e){return l("dojox.form.uploader._Flash",[],{swfPath:h.uploaderPath||require.toUrl("dojox/form/resources/uploader.swf"),preventCache:!0,skipServerCheck:!0,serverTimeout:2E3,isDebug:!1,devMode:!1,deferredUploading:0,
postMixInProperties:function(){"flash"===this.uploadType&&(this._files=[],this._fileMap={},this._createInput=this._createFlashUploader,this.getFileList=this.getFlashFileList,this.reset=this.flashReset,this.upload=this.uploadFlash,this.fieldname="flashUploadFiles");this.inherited(arguments)},onReady:function(b){},onLoad:function(b){},onFileChange:function(b){},onFileProgress:function(b){},getFlashFileList:function(){return this._files},flashReset:function(){this.flashMovie.reset();this._files=[];this._fileMap=
{}},uploadFlash:function(b){this.onBegin(this.getFileList());b=b||{};b.returnType="F";b.uploadType=this.uploadType;console.log("flas upload",b);this.flashMovie.doUpload(b)},_change:function(b){this._files=this._files.concat(b);g.forEach(b,function(a){a.bytesLoaded=0;a.bytesTotal=a.size;this._fileMap[a.name+"_"+a.size]=a},this);this.onChange(this._files);this.onFileChange(b)},_complete:function(b){this._getCustomEvent().type="load";this.onComplete(b)},_progress:function(b){this._fileMap[b.name+"_"+
b.bytesTotal].bytesLoaded=b.bytesLoaded;var a=this._getCustomEvent();this.onFileProgress(b);this.onProgress(a)},_error:function(b){this.onError(b)},_onFlashBlur:function(b){},_getCustomEvent:function(){var b={bytesLoaded:0,bytesTotal:0,type:"progress",timeStamp:(new Date).getTime()},a;for(a in this._fileMap)b.bytesTotal+=this._fileMap[a].bytesTotal,b.bytesLoaded+=this._fileMap[a].bytesLoaded;b.decimal=b.bytesLoaded/b.bytesTotal;b.percent=Math.ceil(b.bytesLoaded/b.bytesTotal*100)+"%";return b},_connectFlash:function(){this._subs=
[];this._cons=[];var b=n.hitch(this,function(a,b){this._subs.push(r.subscribe(this.id+a,this,b))});b("/filesSelected","_change");b("/filesUploaded","_complete");b("/filesProgress","_progress");b("/filesError","_error");b("/filesCanceled","onCancel");b("/stageBlur","_onFlashBlur");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&m.set(this.domNode,"tabIndex",this.tabIndex)},_createFlashUploader:function(){var c=this.btnSize.w,a=this.btnSize.h;
if(c){var g=this.getUrl();if(g){if(0>g.toLowerCase().indexOf("http")&&0!=g.indexOf("/")){var h=window.location.href.split("/");h.pop();h=h.join("/")+"/";g=h+g}}else console.warn("Warning: no uploadUrl provided.");this.inputNode=b.create("div",{className:"dojoxFlashNode"},this.domNode,"first");f.set(this.inputNode,{position:"absolute",top:"-2px",width:c+"px",height:a+"px",opacity:0});c={expressInstall:!0,path:(this.swfPath.uri||this.swfPath)+(this.preventCache?"?cb_"+(new Date).getTime():""),width:c,
height:a,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName||this.name+"Flash",uploadUrl:g,uploadOnSelect:this.uploadOnSelect,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.multiple,id:this.id,isDebug:this.isDebug,noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new e(c,this.inputNode);this.flashObject.onError=
n.hitch(function(a){console.error("Flash Error: "+a)});this.flashObject.onReady=n.hitch(this,function(){this.onReady(this)});this.flashObject.onLoad=n.hitch(this,function(a){this.flashMovie=a;this.flashReady=!0;this.onLoad(this)});this._connectFlash()}else setTimeout(dojo.hitch(this,function(){this._getButtonStyle(this.domNode);this._createFlashUploader()}),200)}})})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),
function(p,f,b,m,l,h,r,n,g){function e(a){a=p.delegate(v,a);if(!("path"in a))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),null;"id"in a||(a.id="dojox-embed-flash-"+u++);return a}var c,a,u=0,v={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};l("ie")?(c=function(a){a=e(a);if(!a)return null;var b,c=a.path;if(a.vars){var f=[];for(b in a.vars)f.push(encodeURIComponent(b)+
"\x3d"+encodeURIComponent(a.vars[b]));a.params.FlashVars=f.join("\x26");delete a.vars}c='\x3cobject id\x3d"'+g.escape(String(a.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+g.escape(String(a.width))+'" height\x3d"'+g.escape(String(a.height))+'"'+(a.style?' style\x3d"'+g.escape(String(a.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+g.escape(String(c))+'" /\x3e';if(a.params)for(b in a.params)c+='\x3cparam name\x3d"'+g.escape(b)+'" value\x3d"'+g.escape(String(a.params[b]))+
'" /\x3e';return{id:a.id,markup:c+"\x3c/object\x3e"}},a=function(){for(var a=10,b=null;!b&&7<a;)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a--)}catch(w){}return b?(a=b.GetVariable("$version").split(" ")[1].split(","),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,rev:0}}(),f.addOnWindowUnload(function(){console.warn("***************UNLOAD");var a=function(){};m("object").reverse().style("display","none").forEach(function(b){for(var c in b)if("FlashVars"!=
c&&"function"==typeof b[c])try{b[c]=a}catch(t){}})})):(c=function(a){a=e(a);if(!a)return null;var b,c=a.path;if(a.vars){var f=[];for(b in a.vars)f.push(encodeURIComponent(b)+"\x3d"+encodeURIComponent(a.vars[b]));a.params.flashVars=f.join("\x26");delete a.vars}c='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+g.escape(String(c))+'" id\x3d"'+g.escape(String(a.id))+'" width\x3d"'+g.escape(String(a.width))+'" height\x3d"'+g.escape(String(a.height))+'"'+(a.style?' style\x3d"'+g.escape(String(a.style))+
'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(a.params)for(b in a.params)c+=" "+g.escape(b)+'\x3d"'+g.escape(String(a.params[b]))+'"';return{id:a.id,markup:c+" /\x3e"}},a=function(){var a=navigator.plugins["Shockwave Flash"];return a&&a.description?(a=a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,
rev:0}}());var q=function(b,c){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");this.available=a.major;this.minimumVersion=b.minimumVersion||9;this.domNode=this.movie=this.id=null;c&&(c=h.byId(c));setTimeout(p.hitch(this,function(){if(b.expressInstall||this.available&&this.available>=this.minimumVersion)if(b&&c)this.init(b,c);else this.onError("embed.Flash was not provided with the proper arguments.");
else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),100)};p.extend(q,{onReady:function(a){},onLoad:function(a){},onError:function(a){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(a,b){this.destroy();b=h.byId(b||this.domNode);if(!b)throw Error("dojox.embed.Flash: no domNode reference has been passed.");
var c=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;q.initialized&&(this.id=q.place(a,b),this.domNode=b,setTimeout(p.hitch(this,function(){this.movie=this.byId(this.id,a.doc);this.onReady(this.movie);this._poller=setInterval(p.hitch(this,function(){try{c=this.movie.PercentLoaded()}catch(t){console.warn("this.movie.PercentLoaded() failed",t,this.movie)}if(100==c)this._onload();else if(0==c&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");
}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(k){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var a=p.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),b;for(b in this)a[b]||delete this[b];this._poller?r(this,"Load",this,"_destroy"):this._destroy()}},byId:function(a,b){b=b||document;return b.embeds[a]?b.embeds[a]:b[a]?b[a]:window[a]?window[a]:document[a]?document[a]:null}});p.mixin(q,{minSupported:8,available:a.major,
supported:a.major>=a.required,minimumRequired:a.required,version:a,initialized:!1,onInitialize:function(){q.initialized=!0},__ie_markup__:function(a){return c(a)},proxy:function(a,c){b.forEach(c instanceof Array?c:[c],function(a){this[a]=p.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+a+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+b.map(arguments,function(a){return __flash__toXML(a)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,
arguments||[])})},a)}});q.place=function(a,b){var d=c(a);b=h.byId(b);b||(b=n.doc.createElement("div"),b.id=d.id+"-container",n.body().appendChild(b));return d?(b.innerHTML=d.markup,d.id):null};q.onInitialize();p.setObject("dojox.embed.Flash",q);return q})},"builder/plugins/app-list/AppCatalogPage":function(){define("dojo/_base/declare dojo/_base/html dojo/dom-style dojo/dom dojo/_base/array dojo/on dojo/_base/lang dojo/query dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AppCatalogPage.html ./AppOperMenu".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){return p([c,a,u],{baseClass:"app-catalog-page",templateString:v,_defaultStyleColor:"#31aacd",loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._appOperMenus=[];this._eventHandles=[]},startup:function(){this.inherited(arguments)},
refresh:function(a,b){this.createAppList(a,b);f.setSelectable(this.appContent,!1)},createAppList:function(a){var b;this.cleanAppList();f.setStyle(this.listSectionBodyContent,"display","block");if(0<a.length)for(b=0;b<a.length;b++)this.createAppNode(a[b],b);else this.appListWidget._addEmptyDescription(this.listTableBody)},cleanAppList:function(){f.empty(this.listTableBody);l.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];l.forEach(this._eventHandles,function(a){a.remove()});
this._eventHandles=[]},createAppNode:function(a,b){return this._createItem(a,b)},_createItem:function(a,c){var d=f.create("tr",{"class":"app-catalogs list-table-item"+(c%2?" list-table-item-add ":" "),"data-app-id":a.id,"data-app-name":a.name},this.listTableBody),g=f.create("td",{"class":"item-td"},d),g=f.create("div",{"class":"catalog"},g),k=f.create("div",{"class":"content-theme jimu-float-leading"},g),l=f.create("div",{"class":"content-theme-icon "+(a._defaultIconClass?a._defaultIconClass:""),
title:this.nls.launch},k);a.thumbnail&&b.set(l,"backgroundImage","url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+")");f.create("div",{"class":"content-theme-flagImg content-theme-flagImg-"+this._getType(a.appType)},l);var l=f.create("div",{"class":"content-opers jimu-float-trailing"},g),n=f.create("div",{"class":"content-opers-btns"},l),l=f.create("div",{"class":"content-opers-btn content-opers-btns-edit",title:this.nls.configApp},n),u=f.create("div",{"class":"content-opers-btn content-opers-btns-launch",
title:this.nls.launch},n),p=f.create("div",{"class":"content-opers-btn content-opers-btns-download",title:this.nls.download},n),n=f.create("div",{"class":"content-opers-btn content-opers-btns-more","data-appid":a.id},n),v=(new q({app:a,posNode:n,appListWidget:this.appListWidget,nls:this.nls,isTemplate:!1,appContentNode:this.appContent,height:122,offset:{top:42,left:-16,right:-16}})).placeAt(n);this._appOperMenus.push(v);this._eventHandles.push(h(k,"click",r.hitch(this,this._onAppLaunchClick,a)));
this._eventHandles.push(h(p,"click",r.hitch(this,this._onAppDownloadClick,a)));this._eventHandles.push(h(l,"click",r.hitch(this,this._onAppEditClick,a)));this._eventHandles.push(h(u,"click",r.hitch(this,this._onAppLaunchClick,a)));this._eventHandles.push(h(n,"click",r.hitch(this,this._onAppMoreClick,a,v,n)));g=f.create("div",{"class":"catalog-content"},g);k=f.create("div",{"class":"catalog-content-head"},g);f.create("p",{"class":"catalog-content-appname long-text-ellipsis",innerHTML:a.name,title:a.name},
k);k=f.create("p",{"class":"catalog-content-appinfo long-text-ellipsis jimu-float-trailing"},k);f.create("span",{"class":"catalog-content-appinfo-time jimu-float-leading",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},k);f.create("span",{"class":"catalog-content-appinfo-owner jimu-float-leading",innerHTML:"\x3cp class\x3d'catalog-content-appinfo-owner-name long-text-ellipsis'title\x3d'"+a.creator+"'\x3e"+a.creator+"\x3c/p\x3e"},k);f.create("p",{"class":"catalog-content-dis "+(a.description?
"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,title:a.description},g);this._eventHandles.push(h(m.byId("content-box"),"click",r.hitch(this,this.resetStatus)));this._eventHandles.push(h(this.ownerDocument,"click",r.hitch(this,this.resetStatus)));this._eventHandles.push(e.subscribe("menuAll/hide",r.hitch(this,this.resetStatus)));return d},_getType:function(a){var b="";switch(a){case "HTML":b="2D";break;case "HTML3D":b="3D";break;default:console.error("AppCatalogPage Error _getType")}return b},
resetStatus:function(a){this._hideAllAppOperMenus(a);this._hideBtnsSelect(a)},_hideAllAppOperMenus:function(a){l.forEach(this._appOperMenus,function(b){!b.isShow||"undefined"!==typeof a&&"undefined"!==typeof a.itemId&&a.itemId===b.app.id||b.hide()})},_hideBtnsSelect:function(a){for(var b=n(".content-opers-btns-more"),c=0,e=b.length;c<e;c++){var k=b[c];"undefined"!==typeof a&&"undefined"!==typeof a.itemId&&a.itemId===parseInt(g.get(k,"data-appid"),10)||f.removeClass(k,"content-opers-btns-more-selected")}},
_onAppDownloadClick:function(a){window.open(a.downloadUrl,"downloadTargetFrame")},_onAppEditClick:function(a){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)},_onAppLaunchClick:function(a){window.open(a.appUrl,"_blank")},_onAppMoreClick:function(a,b,c,g){g&&(g.itemId=a.id);b.isShow?b.hide():(e.publish("menuAll/hide"),b.set("app",a),b.show(),f.addClass(c,"content-opers-btns-more-selected"))}})})},"builder/plugins/app-list/AppOperMenu":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./AppOperMenu.html dojo/on dojo/query dojo/keys dojo/_base/lang jimu/dijit/Popup jimu/dijit/Message builder/serviceUtils jimu/dijit/QRCode builder/dijit/FullScreenPopup builder/dijit/EditItemInfo".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){return p([b,m],{templateString:l,baseClass:"app-oper-menu white-style",app:void 0,isShow:!1,position:{},itemDefaultColor:"#ffffff",appListWidget:void 0,loadingDiv:null,_loading:null,_downloadUrl:null,constructor:function(){this.height||(this.height=0);this.offset||(this.offset={top:0,left:0,right:0})},postCreate:function(){this.inherited(arguments);this._loading=this.appListWidget.loading;this._initMenu();this.hide();this._downloadUrl="/webappbuilder/rest/apps/"+
this.app.id+"/download";f.setAttr(this.downloadLinkNode,"href",this._downloadUrl);this.own(h(this.downloadLinkNode,"click",g.hitch(this,function(){this.hide()})));this.app.isTemplate&&f.setAttr(this.editAppInfo,"innerHTML",this.nls.editTemplateInfo)},refresh:function(){var a="",b="";if(this.appContentNode){var a=f.position(this.posNode),b=f.position(this.appContentNode),c=f.getStyle(this.appContentNode,"height");a.y+this.height+25>b.y+c?(b=this.offset.top,a="",f.setStyle(this.upTriangle,"display",
"none"),f.setStyle(this.downTriangle,"top",this.height-4+"px"),f.setStyle(this.downTriangle,"display","block")):(a=this.offset.top,b="")}f.setStyle(this.domNode,isRTL?{top:a+"px",bottom:b+"px",left:this.offset.left+"px"}:{top:a+"px",bottom:b+"px",right:this.offset.right+"px"})},_refreshAppOrTempaltePage:function(){this.appListWidget.resetRefreshImageFlag();this.app.isTemplate?this.appListWidget.refreshTemplatePage():this.appListWidget.refreshAppPage()},show:function(){this.refresh();f.setStyle(this.domNode,
"display","block");this.isShow=!0},hide:function(){f.setStyle(this.domNode,"display","none");this.isShow=!1},_initMenu:function(){this.isTemplate?(f.addClass(this.editAppInfo,"border-top-radius"),this._disableItem(this.createAppFromTemplate),this.app.isPredefined&&(this._disableItem(this.duplicate),this._disableItem(this.editAppInfo),this._disableItem(this.remove),this._disableItem(this.download),this._disableItem(this.duplicate))):(f.addClass(this.editAppInfo,"border-top-radius"),this._disableItem(this.createAppFromTemplate),
this._disableItem(this.download))},_disableItem:function(a){f.setStyle(a,"display","none")},_onMenuClick:function(a){a.stopPropagation()},_onRemoveClick:function(){var b,c;this.app.isTemplate?(b=this.nls.confirmDeleteTemplate,c=this.nls.deleteTemplateTitle):(b=this.nls.confirmDeleteApp,c=this.nls.deleteAppTitle);var f=new e({content:b,titleLabel:c,width:"425",autoHeight:!0,"class":"jimu-popup-in-home",buttons:[{label:this.nls.ok,onClick:g.hitch(this,function(){this._loading.show(this.nls.deleting);
f.close();a.removeApp(this.app.id).then(g.hitch(this,function(a){a.success?(console.log("Removed app successfully, id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):console.error(this.nls.deleteFalse);this._loading.hide()}),function(){console.error(this.nls.deleteError);this._loading.hide()})})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:g.hitch(this,function(){f.close()})}]})},_onDuplicateClick:function(){this._loading.show(this.nls.duplicating);a.duplicateApp({name:this.app.name,
description:this.app.description,fromAppId:this.app.id,appType:this.app.appType,isTemplate:this.app.isTemplate,isPredefined:this.app.isPredefined}).then(g.hitch(this,function(a){this._loading.hide();a.success?(console.log("Duplicated app successfully, app id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):console.error(this.nls.duplicateFalse)}),function(){console.error(this.nls.duplicateError);this._loading.hide()});this.hide()},_onEditClick:function(){this.itemInfoDijit=new q({itemInfo:this.app,
nls:this.nls});var a;a=this.app.isTemplate?this.nls.editTemplateInfo:this.nls.editAppInfo;var b=r("#main-page")[0];this._EditPopup=new v({zIndex:101,titleStr:a,blurContainer:b.firstElementChild,content:this.itemInfoDijit.domNode,subDijit:this.itemInfoDijit,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:g.hitch(this,this._onEditOKClick)},{label:this.nls.cancel,isHighLight:!1,onClick:g.hitch(this,this._onEditCancelClick)}],btnsAtuoBottom:!0});this._EditPopup.placeAt(b);this._EditPopup.show();this.itemInfoDijit.focusItemByName("appName");
this.hide();this.posNode&&f.removeClass(this.posNode,"item-more-selected")},_onEditOKClick:function(){var a=g.clone(this.app),b=this.itemInfoDijit.getProperties();a.name=b.name;a.description=b.description;!0!==this.app.isTemplate&&b.icon&&(a.icon=b.icon);b.thumbnail&&(a.thumbnail=b.thumbnail);this.appListWidget.updateApp(a).then(g.hitch(this,function(a){!0===a.success?(this._refreshAppOrTempaltePage(),this._EditPopup.close()):(console.error(a.message),new c({message:this.nls.editAppFalse}))}),g.hitch(this,
function(a){console.error(a);new c({message:this.nls.editError})}))},_onEditCancelClick:function(){this._EditPopup&&this._EditPopup.close()},_onDownloadClick:function(){},_onAgolTemplateClick:function(){var a=this.appListWidget.pluginsMeta["popup-actions.popup-agoltemplate"];a&&this.appListWidget.pluginManager.loadPlugin(a).then(g.hitch(this,function(a){a.onClickBeforeConfigPage(this.app)}))},_onCreateAppFromTempalteClick:function(){var a=this.appListWidget.pluginManager.getExtensions("startup.creation-entry")[0],
a=this.appListWidget.pluginsMeta[a.pluginName];this._loading.show("");this.appListWidget.pluginManager.loadPlugin(a).then(g.hitch(this,function(a){a.popupNewCreateDlg("",this.app,700);this._loading.hide()}),g.hitch(this,function(){this._loading.hide()}))},_onQRCodeClick:function(){new e({content:new u({text:"http://"+window.location.host+path+"apps/"+this.app.id,width:128,height:128}),container:"main-page",titleLabel:"qrcode-nonls",width:300,autoHeight:!0,buttons:[{label:this.nls.cancel,key:n.ESCAPE}]})}})})},
"builder/dijit/EditItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/EditItemInfo.html dojo/dom-style dojo/dom-class dojo/_base/lang dojo/on dojo/mouse dojo/query dojo/dom-attr dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dojo/has dojo/sniff dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C){return p([l,h,r],{templateString:g,baseClass:"dijit-item-info",_isTemplate:"",postMixInProperties:function(){this.inherited(arguments);this.nls=a.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this._init(this.itemInfo);k.set(this.publishWebmapSummary,"placeholder",this.nls.summaryLabelPlaceHolder)},_init:function(d){var e="";this._isTemplate=!1===d.isTemplate?!1:!0;e="imageChooserTemplate";this.imageChooser=new z({cropImage:!0,
showSelfImg:!0,format:[z.GIF,z.JPEG,z.PNG],goldenWidth:300,goldenHeight:180,maxSize:2048});b.place(this.imageChooser.domNode,this.imageChooserBase);c.add(this.imageChooserContainer,e);c.add(this.imageChooserMasker,e);this.own(u(this.imageChooserContainer,v.enter,a.hitch(this,this._onImageChooserBaseMouseEnter)));this.own(u(this.imageChooserContainer,v.leave,a.hitch(this,this._onImageChooserBaseMouseLeave)));this.own(u(this.imageChooserMasker,"click",a.hitch(this,this._onEmitUploadPic)));this.setProperties(d)},
_onImageChooserBaseMouseEnter:function(a){e.set(this.imageChooserMasker,"display","block");a.stopPropagation();return!1},_onImageChooserBaseMouseLeave:function(a){e.set(this.imageChooserMasker,"display","none");a.stopPropagation();return!1},_onEmitUploadPic:function(){var a=q("form",this.imageChooserBase)[0],a=q("label",a)[0];3<C("ff")||C("chrome")?a.click():u.emit(a,"click",{bubbles:!0,cancelable:!0})},setProperties:function(a){n.byId("publish-webmap-name").set("value",a.name);n.byId("publish-webmap-summary").set("value",
a.description);if(this.imageChooser){var b="",b=a.thumbnail;"undefined"!==typeof b&&this.imageChooser.setDefaultSelfSrc(b)}},getProperties:function(){var a={name:x.stripHTML(n.byId("publish-webmap-name").get("value")),description:x.stripHTML(n.byId("publish-webmap-summary").get("value"))};!0!==this._isTemplate&&(a.icon=this.imageChooser&&this.imageChooser.imageData);a.thumbnail=this.imageChooser&&this.imageChooser.imageData;return a},focusItemByName:function(a){a&&this[a]?this[a].focus():console.log("Error name")}})})},
"builder/plugins/app-list/CardPageWithBigThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithBigThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){return p([n,g,e],{baseClass:"card-page",templateString:c,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,
postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);f.setSelectable(this.domNode,!1)},refresh:function(a){this.createItemList(a)},cleanItemList:function(){f.empty(this.cardPageContent);b.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];b.forEach(this._eventHandles,
function(a){a.remove()});this._eventHandles=[]},createItemList:function(a){this.cleanItemList();0<a.length?b.forEach(a,function(a){this.createItemCard(a)},this):this.appListWidget._addEmptyDescription(this.cardPageContent,"card-page")},createItemCard:function(a){var c=a.isTemplate?this.nls.preview:this.nls.launch,e=f.create("div",{"class":"item-card jimu-float-leading"},this.cardPageContent),g=f.create("a",{"class":"thumbnail-part",style:"background-image: url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")",href:a.appUrl,target:"_blank",title:c},e);f.create("div",{"class":"item-type-div "+("HTML"===a.appType?"item-type-2d":"item-type-3d")},g);g=f.create("div",{"class":"appInfo-part"},e);f.create("div",{"class":"item-name-div",innerHTML:a.name,title:a.name},g);var k=f.create("div",{"class":"item-info-div"},g);f.create("div",{"class":"app-time-div jimu-float-leading",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},k);f.create("div",{"class":"app-creator-div jimu-float-trailing",innerHTML:a.creator},
k);f.create("div",{"class":"item-des-div "+(a.description?"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,title:a.description},g);e=f.create("div",{"class":"item-operation-part"},e);f.create("div",{innerHTML:'\x3ca href\x3d"'+a.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"item-operation launch-operation jimu-float-leading",title:c},e);a.isTemplate||f.create("div",{innerHTML:'\x3ca href\x3d"'+a.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',
"class":"item-operation download-operation jimu-float-leading",title:this.nls.download},e);var c=f.create("div",{"class":"item-operation edit-operation jimu-float-leading "+(a.isPredefined?"disable":""),title:a.isTemplate?this.nls.configTemplate:this.nls.configApp},e),d=f.create("div",{"class":"item-operation more-operation jimu-float-trailing "+(a.isPredefined?"disable":"")},e),n=(new r({app:a,posNode:d,appListWidget:this.appListWidget,nls:this.nls,isTemplate:a.isTemplate,appContentNode:this.cardPageContent,
height:a.isTemplate?a.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(d);this._appOperMenus.push(n);g=l(d,"click",m.hitch(this,function(c){n.isShow?(n.hide(),f.removeClass(d,"item-more-selected")):(b.forEach(this._appOperMenus,function(a){a.hide();f.removeClass(a.posNode,"item-more-selected")}),n.show(),f.addClass(d,"item-more-selected"));c.itemId=a.id}));this._eventHandles.push(g);g=l(c,"click",m.hitch(this,function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)}));
this._eventHandles.push(g);a.isTemplate&&(c=f.create("div",{"class":"item-operation create-app-from-item-operation jimu-float-leading",title:this.nls.createApp},e),g=l(c,"click",m.hitch(this,function(){n._onCreateAppFromTempalteClick()})),this._eventHandles.push(g));g=l(h.byId("content-box"),"click",m.hitch(this,function(b){b.itemId!==a.id&&(n.hide(),f.removeClass(d,"item-more-selected"))}));this._eventHandles.push(g)}})})},"builder/plugins/app-list/CardPageWithSmallThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithSmallThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c){return p([n,g,e],{baseClass:"card-page-with-small-thumbnail",templateString:c,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);f.setSelectable(this.domNode,
!1)},refresh:function(a){this.createAppList(a)},cleanAppList:function(){f.empty(this.appCardPageContent);b.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];b.forEach(this._eventHandles,function(a){a.remove()});this._eventHandles=[]},createAppList:function(a){this.cleanAppList();b.forEach(a,function(a){this.createAppCard(a)},this)},createAppCard:function(a){var c=a.isTemplate?this.nls.preview:this.nls.launch,e=f.create("div",{"class":"app-card-box jimu-float-leading"},this.appCardPageContent),
e=f.create("div",{"class":"card app-info-card"},e),g=f.create("div",{"class":"app-title-part"},e);f.create("div",{"class":"app-type-div "+("HTML"===a.appType?"app-type-2d":"app-type-3d")},g);var g=f.create("table",{"class":"app-title-table"},g),g=f.create("tbody",{"class":"app-title-table-body"},g),g=f.create("tr",{"class":"app-title-table-tr"},g),k=f.create("td",{"class":"app-thumbnail-td"},g);f.create("a",{"class":"app-thumbnail",style:"background-image: url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")",href:a.appUrl,target:"_blank",title:c},k);g=f.create("td",{"class":"app-title-td"},g);f.create("div",{"class":"app-title-div",innerHTML:a.name},g);f.create("div",{"class":"app-time-div",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},g);f.create("div",{"class":"app-creator-div",innerHTML:a.creator},g);g=f.create("div",{"class":"app-desc-box"},e);f.create("div",{"class":"app-desc-part "+(a.description?"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,
title:a.description},g);e=f.create("div",{"class":"app-operation-part"},e);f.create("div",{innerHTML:'\x3ca href\x3d"'+a.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"app-operation launch-operation jimu-float-leading",title:c},e);a.isTemplate||f.create("div",{innerHTML:'\x3ca href\x3d"'+a.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',"class":"app-operation download-operation jimu-float-leading",title:this.nls.download},e);var c=f.create("div",{"class":"app-operation edit-operation jimu-float-leading "+
(a.isPredefined?"disable":""),title:a.isTemplate?this.nls.configTemplate:this.nls.configApp},e),d=f.create("div",{"class":"app-operation more-operation jimu-float-trailing "+(a.isPredefined?"disable":"")},e),n=(new r({app:a,posNode:d,appListWidget:this.appListWidget,nls:this.nls,isTemplate:a.isTemplate,appContentNode:this.appCardPageContent,height:a.isTemplate?a.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(d);this._appOperMenus.push(n);g=l(d,"click",m.hitch(this,function(c){n.isShow?
(n.hide(),f.removeClass(d,"item-more-selected")):(b.forEach(this._appOperMenus,function(a){a.isShow&&(a.hide(),f.removeClass(a.posNode,"item-more-selected"))}),n.show(),f.addClass(d,"item-more-selected"));c.itemId=a.id}));this._eventHandles.push(g);g=l(c,"click",m.hitch(this,function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)}));this._eventHandles.push(g);a.isTemplate&&(c=f.create("div",{"class":"app-operation create-app-from-item-operation jimu-float-leading",
title:this.nls.createApp},e),g=l(c,"click",m.hitch(this,function(){n._onCreateAppFromTempalteClick()})),this._eventHandles.push(g));g=l(h.byId("content-box"),"click",m.hitch(this,function(b){b.itemId!==a.id&&(f.removeClass(n.posNode,"item-more-selected"),n.hide())}));this._eventHandles.push(g)}})})},"builder/plugins/attribute-config/_build-generate_module":function(){define(["builder/plugins/attribute-config/Plugin","dojo/text!builder/plugins/attribute-config/Plugin.html","dojo/text!builder/plugins/attribute-config/css/style.css",
"dojo/i18n!builder/plugins/attribute-config/nls/strings"],function(){})},"builder/plugins/attribute-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/query dojo/sniff dojo/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/dom-style dojo/dom-construct dojo/_base/array builder/portalUtils builder/BasePlugin jimu/utils jimu/portalUrlUtils jimu/dijit/CheckBox jimu/dijit/ImageChooser jimu/dijit/Message jimu/dijit/LoadingIndicator esri/arcgis/AppProxyManager ./AppProxyUtil ./MapProxyItem ./UrlProxyItem builder/dijit/LinkEditor jimu/dijit/Popup dijit/Editor dojo/NodeList-dom dojo/NodeList-data jimu/dijit/ColorPicker dijit/form/Select dijit/_editor/plugins/FontChoice dijit/_editor/plugins/TextColor dijit/ToolbarSeparator jimu/dijit/EditorTextColor jimu/dijit/EditorBackgroundColor".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J){return p([k,e],{templateString:c,appConfig:null,selectLinkNode:null,selectProxyRuleNode:null,initedLinks:!1,initedProxy:!1,_currentPortalUrl:null,showProxySetting:!1,showAlwaysUseProxy:!1,keepAppState:!0,titleNodeClickHandler:null,subtitleNodeClickHandler:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(l.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)));
this.own(l.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)));this.useProxySetting=new t({label:this.nls.useProxySetting,checked:!1},this.useProxySetting);this.alwaysUseProxy=new t({label:this.nls.alwaysUseProxyLabel,checked:!1},this.alwaysUseProxy);this._is3D()?a.set(this.appStateController,"display","none"):(a.set(this.appStateController,"display",""),this.appStateSetting=new t({label:this.nls.keepAppState,checked:!0,onChange:f.hitch(this,this._onAppStateSettingChange)},this.appStateSetting));
window.isXT?(a.set(this.loadingPageController,"display",""),this.bgImageCheckBox=new t({label:this.nls.backgroundImage,checked:!0,onChange:f.hitch(this,this._onBackgroundImageStatusChange)},this.bgCheckBoxDiv),this.gifImageCheckBox=new t({label:this.nls.loadingGifImage,checked:!0,onChange:f.hitch(this,this._onGifImageStatusChange)},this.gifCheckBoxDiv),this._onSelectGifMode()):a.set(this.loadingPageController,"display","none");this.linksEditor=new G({nls:this.nls,linkList:[],btnLabel:this.nls.addLink,
canEdit:!0,canDelete:!0,isRest:!1,afterAdd:f.hitch(this,this._publishLinksChange),afterUpdate:f.hitch(this,this._publishLinksChange),afterDelete:f.hitch(this,this._publishLinksChange)});this.linksEditor.placeAt(this.linksSection);this.bgImageChooser=new x({cropImage:!1,label:this.nls.selectFile,format:["image/png","image/jpeg"]},this.bgImageChooser);b.addClass(this.bgImageChooser.domNode,"jimu-trailing-margin1 loading-image-chooser");this.bgImageChooser.startup();this.gifImageChooser=new x({cropImage:!1,
label:this.nls.selectFile,format:["image/gif"]},this.gifImageChooser);b.addClass(this.gifImageChooser.domNode,"jimu-float-leading jimu-trailing-margin1 loading-image-chooser");this.gifImageChooser.startup();r(".header-section .label",this.domNode).style("display","none");this._bindEvents();window.isRTL?(r(".arrow-forward",this.domNode).addClass("icon-arrow-left"),r(".arrow-back",this.domNode).addClass("icon-arrow-forward")):(r(".arrow-forward",this.domNode).addClass("icon-arrow-right"),r(".arrow-back",
this.domNode).addClass("icon-arrow-back"));this.loading=new y({hidden:!0},this.loadingNode);this.loading.startup()},startup:function(){this.inherited(arguments);this._keepOrder()},destroy:function(){this.inherited(arguments);this.subtitleNodeClickHandler&&(this.subtitleNodeClickHandler.remove(),this.subtitleNodeClickHandler=null);this.titleNodeClickHandler&&(this.titleNodeClickHandler.remove(),this.titleNodeClickHandler=null)},_bindEvents:function(){this.titleChangeHandle=h(this.titleNode,"change",
f.hitch(this,this.onTitleChange));this.subtitleChangeHandle=h(this.subtitleNode,"change",f.hitch(this,this.onSubtitleChange));this.own(this.titleChangeHandle);this.own(this.subtitleChangeHandle);this.own(h(this.imageChooser,"imageChange",f.hitch(this,"onLogoChange")));this.own(h(this.useProxySetting,"click",f.hitch(this,this._onUseProxySettingChange)));this.own(h(this.alwaysUseProxy,"click",f.hitch(this,this._onAlwaysUseProxyChange)));this.own(h(this.proxyUrlNode,"change",f.hitch(this,this._onProxyUrlChange)));
this.own(h(this.proxyUrlNode,"blur",f.hitch(this,this._onProxyUrlBlur)));this.own(h(this.appIdNode,"change",f.hitch(this,this._onAppIdChange)));this.own(h(this.domNode,"click",f.hitch(this,function(){r(".header-button",this.domNode).removeClass("highlight-button");this.selectLinkNode&&(b.removeClass(this.selectLinkNode,"selected-item"),this.selectLinkNode=null);this.selectProxyRuleNode&&(b.removeClass(this.selectProxyRuleNode,"selected-item"),this.selectProxyRuleNode=null)})));window.isXT&&(this.own(h(this.loadingPageController,
"click",f.hitch(this,this._switchToLoading))),this.own(h(this.backController,"click",f.hitch(this,this._switchToApp))),this.own(h(this.bgColorPicker,"change",f.hitch(this,this._onBackgroundColorChange))),this.own(h(this.gifSelect,"change",f.hitch(this,this._onGifSelectChange))),this.own(h(this.bgImageChooser,"change",f.hitch(this,this._onBackgroundImageUpload))),this.own(h(this.gifImageChooser,"change",f.hitch(this,this._onLoadingGifUpload))));this.own(h(this.appProxyController,"click",f.hitch(this,
this._switchToAppProxy)));this.own(h(this.backController2,"click",f.hitch(this,this._switchToApp)))},_createAppProxySection:function(){this.appProxyManager.loaded?(this._checkMapProxy(),this._checkUrlProxy()):this.own(h.once(this.appProxyManager,"load",f.hitch(this,function(){this._checkMapProxy();this._checkUrlProxy()})))},init:function(b){this.appConfig=b||{};this.initHeader(b);this.initLinks(b);this._is3D()||this.initAppStateSetting(b);this.initedProxy||(this.initProxy(b),this.initedProxy=!0);
this._currentPortalUrl!==b.portalUrl&&(this.initAppId(b),this._currentPortalUrl=b.portalUrl);window.isXT&&this.initLoadingPage(b);this._is3D()||!this._isOnline()||window.isXT?a.set(this.appProxyController,"display","none"):(this.appProxyManager||(this.appProxyManager=new z({appid:window.appInfo.id})),a.set(this.appProxyController,"display",""),this._createAppProxySection())},_isOnline:function(){var a=w.getStandardPortalUrl(window.portalUrl);return w.isOnline(a)},_checkMapProxy:function(){this.appConfig&&
this.appConfig.map&&(this.appConfig.map.appProxy?this.appConfig.map.itemId===this.appConfig.map.appProxy.mapItemId?this._createMapProxyTable(this.appConfig.map.appProxy.proxyItems):this._refreshMapProxy():this._refreshMapProxy())},_refreshMapProxy:function(){C.queryForSecureServicesInMap(this.appConfig.map.portalUrl,this.appConfig.map.itemId).then(f.hitch(this,function(a){a&&0<a.length&&this._publishAppProxy(a);this._createMapProxyTable(a)}))},_createMapProxyTable:function(a){b.empty(this.mapProxyContent);
a&&0!==a.length?(b.setStyle(this.mapSection,"display",""),b.addClass(this.urlSection,"double-margin"),v.forEach(a,f.hitch(this,function(a){!0!==a.useProxy||this._proxyExists(a)||(a.useProxy=!1,a.proxyUrl="",a.proxyId="",this._publishAppProxy([{sourceUrl:a.sourceUrl,useProxy:!1}]));a=new B({appProxyManager:this.appProxyManager,sourceUrl:a.sourceUrl,title:a.title,premium:!0===a.premium,consumeCredits:!0===a.consumeCredits,useProxy:!0===a.useProxy,proxyUrl:a.proxyUrl||"",proxyId:a.proxyId||"",nls:this.nls});
this.own(h(a,B.PROCESS_START,f.hitch(this,function(){this.loading.show()})));this.own(h(a,B.PROCESS_END,f.hitch(this,function(){this.loading.hide()})));this.own(h(a,B.PROXY_CREATED,f.hitch(this,function(a){this._publishAppProxy([a])})));this.own(h(a,B.PROXY_DELETED,f.hitch(this,function(a){this._publishAppProxy([a])})));this.own(h(a,B.PROCESS_ERROR,f.hitch(this,function(a){new A({message:a})})));b.place(a.domNode,this.mapProxyContent)}))):(b.setStyle(this.mapSection,"display","none"),b.removeClass(this.urlSection,
"double-margin"))},_proxyExists:function(a){if(this.appProxyManager){var b=this.appProxyManager.get("proxies");if(b&&0<b.length)return v.some(b,function(b){return b.sourceUrl===a.sourceUrl&&b.proxyUrl===a.proxyUrl&&b.proxyId===a.proxyId})}return!1},_checkUrlProxy:function(){this.proxyLinkEditor||(this.proxyLinkEditor=new G({nls:this.nls,linkList:[],btnLabel:this.nls.addUrlProxy,canEdit:!1,canDelete:!0,isRest:!0,beforeAdd:f.hitch(this,this._createUrlAppProxy),afterDelete:f.hitch(this,this._deleteUrlAppProxy)}),
this.proxyLinkEditor.placeAt(this.linkEditorNode));if(this.appConfig&&this.appConfig.appProxies){var a=[];v.forEach(this.appConfig.appProxies,function(b){this._proxyExists(b)?a.push({label:b.title,url:b.sourceUrl}):this._deleteUrlProxy(b.sourceUrl)},this);this.proxyLinkEditor.setItems(a)}},_createUrlAppProxy:function(a){a=new E({appProxyManager:this.appProxyManager,sourceUrl:a.url,title:a.label,nls:this.nls});var b=new g;this.own(h(a,E.PROCESS_START,f.hitch(this,function(){this.loading.show()})));
this.own(h(a,E.PROCESS_END,f.hitch(this,function(){this.loading.hide()})));this.own(h(a,E.PROXY_CREATED,f.hitch(this,function(a){this._addUrlProxy(a);b.resolve(!0)})));this.own(h(a,E.PROCESS_ERROR,f.hitch(this,function(a){b.resolve(!1);new A({message:a})})));a.createProxy();return b},_deleteUrlAppProxy:function(a){var b={appProxyManager:this.appProxyManager,sourceUrl:a.url,title:a.label,nls:this.nls};v.some(this.appConfig.appProxies,function(c){if(c.sourceUrl===a.url)return f.mixin(b,{proxyId:c.proxyId,
proxyUrl:c.proxyUrl,useProxy:c.useProxy}),!0});(new E(b)).deleteProxy();this._deleteUrlProxy(b.sourceUrl)},_publishAppProxy:function(a){l.publish("appProxyForMapChanged",{mapItemId:this.appConfig.map.itemId,proxyItems:a})},_addUrlProxy:function(a){var b=[];this.appConfig.appProxies&&0<this.appConfig.appProxies.length&&(b=f.clone(this.appConfig.appProxies));b.push({sourceUrl:a.sourceUrl,title:a.title,premium:a.premium,consumeCredits:a.consumeCredits,useProxy:a.useProxy,proxyUrl:a.proxyUrl,proxyId:a.proxyId});
setTimeout(function(){l.publish("appProxyForUrlChanged",b)},100)},_deleteUrlProxy:function(a){var b=v.filter(this.appConfig.appProxies,function(b){return b.sourceUrl!==a});setTimeout(function(){l.publish("appProxyForUrlChanged",b)},100)},_onAppConfigLoaded:function(a){this._setAppConfig(a)},_onAppConfigChanged:function(a){this._setAppConfig(a)},_setAppConfig:function(a){this.init(a)},_publishLinksChange:function(){l.publish("appAttributeChanged",{links:this.getLinks()})},initHeader:function(a){var c=
a.logo||"";c?(!c||c.startWith("/")||c.startWith("http")||c.startWith("data")||(c=window.appInfo.appPath+c),this.imageChooser.setDefaultSelfSrc(c),b.addClass(this.logoContainer,"logo"),b.removeClass(this.logoContainer,"no-logo"),b.addClass(this.addLogoNode,"hide"),this._resetLogoBox(50)):(this.imageChooser.setDefaultSelfSrc(c),b.addClass(this.logoContainer,"no-logo"));c="";a.title&&(c=d.stripHTML(a.title),r(this.titleNode).data("config",a.title),/<([a-z]+)\s*.*>/ig.test(a.title)&&(this.titleNode.disabled=
!0,this.titleNode.title=c,this.titleNodeClickHandler||(this.titleNodeClickHandler=h(this.titleNodeDiv,"click",f.hitch(this,this.onTitleEditorClick)))),b.setAttr(this.titleNode,"value",c));a.subtitle&&(c=d.stripHTML(a.subtitle),r(this.subtitleNode).data("config",a.subtitle),/<([a-z]+)\s*.*>/ig.test(a.subtitle)&&(this.subtitleNode.disabled=!0,this.subtitleNode.title=c,this.subtitleNodeClickHandler||(this.subtitleNodeClickHandler=h(this.subtitleNodeDiv,"click",f.hitch(this,this.onSubtitleEditorClick)))),
b.setAttr(this.subtitleNode,"value",c))},onLogoContainerMouseEnter:function(){10>n("ie")&&(this._hasEntered?b.setStyle(this.removeLogoNode,{display:"block"}):(b.setStyle(this.changeLogoNode,{display:"none"}),setTimeout(f.hitch(this,function(){var a=b.position(this.logoContainer);b.place(this.removeLogoNode,this.ownerDocumentBody);b.addClass(this.removeLogoNode,"attribute-config-plugin-logo-options");b.setStyle(this.removeLogoNode,{position:"absolute",display:"block",left:(window.isRTL?a.x+5:a.x+a.w-
35)+"px",top:a.y+5+"px"});this._hasEntered=!0}))))},onMouseLeaveAttributeConfig:function(){10>n("ie")&&(b.setStyle(this.removeLogoNode,{display:"none"}),this._hasEntered=!1)},onRemoveLogo:function(){this.imageChooser.imageData&&(this.imageChooser.setDefaultSelfSrc(""),b.removeClass(this.logoContainer,"logo"),b.removeClass(this.addLogoNode,"hide"),b.addClass(this.logoContainer,"no-logo"),l.publish("appAttributeChanged",{logo:""}))},onChangeLogo:function(){var a=this.imageChooser.mask;if(n("safari")){var b=
document.createEvent("MouseEvents");b.initEvent("click",!0,!0);a.dispatchEvent(b)}else a.click()},onLogoChange:function(a){this._changeLogo();l.publish("appAttributeChanged",{logo:a})},onTitleChange:function(a){l.publish("appAttributeChanged",{title:a.target.disabled?r(a.target).data("config")[0]:a.target.value})},onSubtitleChange:function(a){l.publish("appAttributeChanged",{subtitle:a.target.disabled?r(a.target).data("config")[0]:a.target.value})},onTitleEditorClick:function(a){a.stopPropagation();
this._editText(this.titleNode)},onSubtitleEditorClick:function(a){a.stopPropagation();this._editText(this.subtitleNode)},_editText:function(a){this.editor=new J({plugins:["bold","italic","underline",d.getEditorTextColor("attributeConfig",!0)],extraPlugins:["|",{name:"dijit._editor.plugins.FontChoice",command:"fontName",custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize"],style:"font-family:Verdana;"});var c=b.position(a),e=new I({titleLabel:this.nls.formatStyle,
width:window.isRTL?695:680,height:250,content:this.editor.domNode,buttons:[{label:window.jimuNls.common.reset,title:this.nls.restoreStyle,onClick:f.hitch(this,function(){var a=this.editor.get("value"),a=d.stripHTML(a);this.editor.set("value",a)})},{label:window.jimuNls.common.ok,onClick:f.hitch(this,function(){var b=this.editor.get("value");/"attribute-custom-style"/g.test(b)||(b='\x3cdiv class\x3d"attribute-custom-style"\x3e'+b+"\x3c/div\x3e");r(a).data("config",b);var c=d.stripHTML(b);/<([a-z]+)\s*.*>/ig.test(b)?
(a.disabled=!0,a.title=c,a!==this.titleNode||this.titleNodeClickHandler)?a!==this.subtitleNode||this.subtitleNodeClickHandler||(this.subtitleNodeClickHandler=h(this.subtitleNodeDiv,"click",f.hitch(this,this.onSubtitleEditorClick))):this.titleNodeClickHandler=h(this.titleNodeDiv,"click",f.hitch(this,this.onTitleEditorClick)):""===c&&(a.disabled=!1,a.title="",a===this.titleNode&&this.titleNodeClickHandler?(this.titleNodeClickHandler.remove(),this.titleNodeClickHandler=null):a===this.subtitleNode&&this.subtitleNodeClickHandler&&
(this.subtitleNodeClickHandler.remove(),this.subtitleNodeClickHandler=null));a.value=c;if(a===this.titleNode)this.onTitleChange({target:a});else if(a===this.subtitleNode)this.onSubtitleChange({target:a});this.editor.destroy();this.editor=null;e.close()})},{label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,function(){this.editor.destroy();this.editor=null;e.close()})}],onClose:f.hitch(this,function(){this.editor&&this.editor.destroy();return!0})});window.isRTL?
b.setStyle(e.domNode,{top:c.y+c.h+5+"px",left:c.x+c.w-(window.isRTL?695:680)+"px"}):b.setStyle(e.domNode,{top:c.y+c.h+5+"px",left:c.x+"px"});b.addClass(e.domNode,"format-font-style");b.setStyle(this.editor.domNode,{width:"100%",height:"100%"});this.editor.startup();8!==n("ie")&&this.editor.resize({w:"100%",h:"100%"});this.editor.set("value",r(a).data("config")[0])},initLinks:function(a){a.links&&this.linksEditor.setItems(a.links)},initProxy:function(a){if(a=a.httpProxy)this.useProxySetting.setValue(a.useProxy),
this.showProxySetting=!!a.useProxy,this._onUseProxySettingChange(),this.alwaysUseProxy.setValue(a.alwaysUseProxy),this.showAlwaysUseProxy=!!a.alwaysUseProxy,this._onAlwaysUseProxyChange(),a.url&&b.setAttr(this.proxyUrlNode,"value",a.url),a.rules&&(b.empty(this.proxyRulesListNode),v.forEach(a.rules,f.hitch(this,function(a){this.createProxyRuleNode(a)})))},initAppStateSetting:function(a){this.appStateSetting.setValue(!!a.keepAppState)},initAppId:function(a){q.getPortal(a.portalUrl).loadSelfInfo().then(f.hitch(this,
function(c){c.supportsOAuth?(b.setStyle(this.appIdSection,"display","none"),b.setAttr(this.appIdNode,"value",a.appId)):b.setStyle(this.appIdSection,"display","none")}),f.hitch(this,function(a){this.shelter.hide();console.error(a)}))},getLinks:function(){var a=[];v.forEach(this.linksEditor.getItems(),function(b){a.push({label:b.label,url:b.url})});return a},getProxy:function(){var a=[],c=b.getAttr(this.proxyUrlNode,"value");r(".proxy-rule-list .list-item",this.domNode).forEach(f.hitch(this,function(b){var c=
r(".first input",b).attr("value")[0];b=r(".second input",b).attr("value")[0];c&&a.push({urlPrefix:c,proxyUrl:b})}));return{useProxy:this.useProxySetting.getValue(),alwaysUseProxy:this.alwaysUseProxy.getValue(),url:c,rules:a}},_changeLogo:function(){b.setStyle(this.imageChooser.selfImg,{width:"auto",height:"auto",marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto"});b.removeClass(this.logoContainer,"no-logo");b.addClass(this.logoContainer,"logo");b.addClass(this.addLogoNode,"hide");
b.removeClass(this.imageChooser.domNode,"hide");setTimeout(f.hitch(this,this._resetLogoBox,4),4)},_resetLogoBox:function(a){if(this.domNode&&this.imageChooser){var c=b.getContentBox(this.imageChooser.selfImg);0<c.w?(a=b.getContentBox(this.imageChooser.domNode),c=c.w/c.h,1>=c?(b.setStyle(this.imageChooser.selfImg,"height",a.h+"px"),c=(a.w-a.h*c)/2,b.setStyle(this.imageChooser.selfImg,{marginLeft:c+"px",marginRight:c+"px"})):(b.setStyle(this.imageChooser.selfImg,"width",a.w+"px"),c=(a.h-a.w/c)/2,b.setStyle(this.imageChooser.selfImg,
{marginTop:c+"px",marginBottom:c+"px"}))):setTimeout(f.hitch(this,this._resetLogoBox,a),a)}},_bindNodeEvents:function(a,c,d,e,g,k){this.own(h(a,"click",f.hitch(this,function(c){r(".header-button",this.domNode).addClass("highlight-button");"links"===k?(this.selectLinkNode&&b.removeClass(this.selectLinkNode,"selected-item"),b.addClass(a,"selected-item"),this.selectLinkNode=a):"proxyRules"===k&&(this.selectProxyRuleNode&&b.removeClass(this.selectProxyRuleNode,"selected-item"),b.addClass(a,"selected-item"),
this.selectProxyRuleNode=a);c.stopPropagation()})));this.own(h(c,"dblclick",f.hitch(this,function(){b.setStyle(c,"display","none");b.setStyle(d,"display","block");d.focus();d.select()})));this.own(h(e,"dblclick",f.hitch(this,function(){b.setStyle(e,"display","none");b.setStyle(g,"display","block");g.focus();g.select()})));this.own(h(g,"focus",function(a){a.target.value||(a.target.value="http://")}));this.own(h(d,"blur",f.hitch(this,function(a){b.setAttr(c,{innerHTML:a.target.value||c.innerHTML,style:{display:"block"}});
b.setStyle(d,"display","none");"links"===k?l.publish("appAttributeChanged",{links:this.getLinks()}):"proxyRules"===k&&this._publishProxy()})));this.own(h(g,"blur",f.hitch(this,function(a){b.setAttr(e,{innerHTML:a.target.value||e.innerHTML,style:{display:"block"}});b.setStyle(g,"display","none");"links"===k?(a=this._formatLinkValue(a.target.value),b.setAttr(e,"innerHTML",a),b.setAttr(g,"value",a),l.publish("appAttributeChanged",{links:this.getLinks()})):"proxyRules"===k&&this._publishProxy()})))},
_formatLinkValue:function(a){var b="";return b=/^http(s?):\/\//.test(a)?a:/^\/\//.test(a)?"http:"+a:"http://"+a},_createListItem:function(a,c,d,e,f){var g=b.create("div",{"class":"list-item"}),k=b.create("div",{"class":"first jimu-float-leading"},g);d=b.create("div",{"class":"mask",innerHTML:c||d,title:d},k);var k=b.create("input",{style:{display:"none"}},k),h=b.create("div",{"class":"second jimu-float-leading"},g);f=b.create("div",{"class":"mask",innerHTML:e||f,title:f},h);h=b.create("input",{style:{display:"none"}},
h);b.setAttr(k,"value",c);b.setAttr(h,"value",e);this._bindNodeEvents(g,d,k,f,h,a);c||this.focusNewItem(g,d,k,a);return g},focusNewItem:function(a,c,d,e){"links"===e?(this.selectLinkNode&&b.removeClass(this.selectLinkNode,"selected-item"),b.addClass(a,"selected-item"),this.selectLinkNode=a):"proxyRules"===e&&(this.selectProxyRuleNode&&b.removeClass(this.selectProxyRuleNode,"selected-item"),b.addClass(a,"selected-item"),this.selectProxyRuleNode=a);b.setStyle(c,"display","none");b.setStyle(d,"display",
"block");d.value=c.innerHTML;setTimeout(function(){d.focus();d.select()},0)},createProxyRuleNode:function(a){a=this._createListItem("proxyRules",a.urlPrefix,this.nls.prefixPlaceholder,a.proxyUrl,this.nls.proxyUrlPlaceholder);b.place(a,this.proxyRulesListNode)},_keepOrder:function(){var a=b.getMarginBox(this.headerSection),c=b.getMarginBox(this.linksSection),d=b.getMarginBox(this.appIdSection),e=b.getMarginBox(this.useProxySection),a=a.h+c.h+d.h+e.h,c=b.getMarginBox(this.domNode).h;a>c&&b.setStyle(this.domNode,
"paddingRight","10px")},_onEditItemClick:function(a){var c=r(".first .mask",a)[0];a=r(".first input",a)[0];b.setStyle(c,"display","none");b.setStyle(a,"display","block");a.focus();a.select()},onAddProxyRuleClick:function(a){this.createProxyRuleNode({urlPrefix:"",proxyUrl:""});this._keepOrder();a.stopPropagation()},onEditProxyRuleClick:function(){this.selectProxyRuleNode&&this._onEditItemClick(this.selectProxyRuleNode)},onDeleteProxyRuleClick:function(){this.selectProxyRuleNode&&(b.destroy(this.selectProxyRuleNode),
l.publish("appAttributeChanged",{httpProxy:this.getProxy()}))},_onUseProxySettingChange:function(){this.useProxySetting.checked?b.setStyle(this.proxySection,"display","block"):b.setStyle(this.proxySection,"display","none");this.showProxySetting!==this.useProxySetting.checked&&(this._publishProxy(),this.showProxySetting=this.useProxySetting.checked)},_onAlwaysUseProxyChange:function(){this.showAlwaysUseProxy!==this.alwaysUseProxy.checked&&(this._publishProxy(),this.showAlwaysUseProxy=this.alwaysUseProxy.checked)},
_onProxyUrlChange:function(){this._publishProxy()},_onProxyUrlBlur:function(){this.proxyUrlNode.value?b.removeClass(this.proxyUrlNode,"error-status"):b.addClass(this.proxyUrlNode,"error-status")},_onAppIdChange:function(){l.publish("appAttributeChanged",{appId:this.appIdNode.value})},_onAppStateSettingChange:function(){this.keepAppState!==this.appStateSetting.checked&&(this.keepAppState=this.appStateSetting.checked,l.publish("appAttributeChanged",{keepAppState:this.keepAppState}))},_publishProxy:function(){l.publish("appAttributeChanged",
{httpProxy:this.getProxy()})},initLoadingPage:function(a){this.showLoadingGif=this.showBackgroundImage=!0;"object"===typeof a.loadingPage&&(a=a.loadingPage,/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(a.backgroundColor)&&this.bgColorPicker.setColor(new m(a.backgroundColor)),this._initBackgroundImage(a),this._initLoadingGif(a))},_switchToLoading:function(){a.set(this.attributeSection,"display","none");a.set(this.loadingPageSection,"display","");l.publish("actionTriggered",{action:"showLoading"})},_switchToAppProxy:function(){a.set(this.attributeSection,
"display","none");a.set(this.appProxySection,"display","")},_switchToApp:function(){a.set(this.attributeSection,"display","");a.set(this.loadingPageSection,"display","none");a.set(this.appProxySection,"display","none");l.publish("actionTriggered",{action:"showApp"})},_initBackgroundImage:function(b){b.backgroundImage?b.backgroundImage.visible?(this.showBackgroundImage=!0,this.bgImageCheckBox.check(),a.set(this.bgUploaderDiv,"display","")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),
a.set(this.bgUploaderDiv,"display","none")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),a.set(this.bgUploaderDiv,"display","none"))},_initLoadingGif:function(b){var c=0;b.loadingGif?(b.loadingGif.visible?(this.showLoadingGif=!0,this.gifImageCheckBox.check(),a.set(this.gifModeSection,"display","")):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),a.set(this.gifModeSection,"display","none")),/^configs\/loading\/images/.test(b.loadingGif.uri)&&(b.loadingGif.uri=window.appInfo.appPath+
b.loadingGif.uri),/^data:image\/.*;base64,/.test(b.loadingGif.uri)||/loading\.gif$/.test(b.loadingGif.uri)?(this.uploadMode.checked=!0,this._onUploadGifMode()):(this.selectMode.checked=!0,this._onSelectGifMode(),b=b.loadingGif.uri.match(/images\/(.*)/)[1],c=b.match(/\d+/),this.gifSelect.set("value",c[0]))):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),a.set(this.gifModeSection,"display","none"))},_getLoadingGifSetting:function(){var a={};this.appConfig&&this.appConfig.loadingPage&&this.appConfig.loadingPage.loadingGif&&
(a=this.appConfig.loadingPage.loadingGif);return a},_getLoadingBackgroundColor:function(){return this.appConfig&&this.appConfig.loadingPage&&this.appConfig.loadingPage.backgroundColor?this.appConfig.loadingPage.backgroundColor:""},_onBackgroundColorChange:function(a){u.empty(this.bgColorPicker.domNode);u.create("span",{innerHTML:a.toHex(),style:{color:d.invertColor(a.toHex())}},this.bgColorPicker.domNode);a.toHex()!==this._getLoadingBackgroundColor()&&l.publish("loadingPageChanged",{backgroundColor:this.bgColorPicker.getColor().toHex()})},
_onBackgroundImageStatusChange:function(a){a!==this.showBackgroundImage&&(this.showBackgroundImage=a,l.publish("loadingPageChanged",{backgroundImage:{visible:this.showBackgroundImage}}))},_onBackgroundImageUpload:function(a){var b=new Image;b.src=a;this.own(h(b,"load",f.hitch(this,function(){l.publish("loadingPageChanged",{backgroundImage:{uri:a,width:b.width,height:b.height}})})))},_onSelectGifMode:function(){a.set(this.predefinedGif,"display","");a.set(this.customGif,"display","none")},_onUploadGifMode:function(){a.set(this.predefinedGif,
"display","none");a.set(this.customGif,"display","")},_onGifImageStatusChange:function(a){a!==this.showLoadingGif&&(this.showLoadingGif=a,l.publish("loadingPageChanged",{loadingGif:{visible:this.showLoadingGif}}))},_onGifSelectChange:function(a){if("0"!==a){var b=this._getLoadingGifSetting(),c=null;b.uri&&/images\/.*/.test(b.uri)&&(b=b.uri.match(/images\/(.*)/)[1],c=b.match(/\d+/));if(null===c||a!==c[0])b=[{width:58,height:58},{width:58,height:10},{width:32,height:32},{width:34,height:34}][a-1],l.publish("loadingPageChanged",
{loadingGif:{uri:window.appInfo.appPath+"configs/loading/images/predefined_loading_"+a+".gif",width:b?b.width:0,height:b?b.height:0}})}},_onLoadingGifUpload:function(a){var b=new Image;b.src=a;this.own(h(b,"load",f.hitch(this,function(){l.publish("loadingPageChanged",{loadingGif:{uri:a,width:b.width,height:b.height}});this.gifSelect.set("value",0)})))},_is3D:function(){return"HTML3D"===window.appInfo.appType}})})},"jimu/dijit/CheckBox":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/dom-class dojo/on dojo/Evented".split(" "),
function(p,f,b,m,l,h,r){return p([f,r],{baseClass:"jimu-checkbox",declaredClass:"jimu.dijit.CheckBox",checked:!1,status:!0,label:"",postCreate:function(){this.checkNode=m.create("div",{"class":"checkbox jimu-float-leading"},this.domNode);this.labelNode=m.create("div",{"class":"label jimu-float-leading",innerHTML:this.label||""},this.domNode);this.checked&&m.addClass(this.checkNode,"checked");this.status||m.addClass(this.domNode,"jimu-state-disabled");this.own(h(this.checkNode,"click",b.hitch(this,
function(){this.status&&(this.checked?this.uncheck():this.check())})));this.own(h(this.labelNode,"click",b.hitch(this,function(){this.checked&&this.status?this.uncheck():this.status&&this.check()})));this._udpateLabelClass()},setLabel:function(b){this.label=b;this.labelNode.innerHTML=this.label;this._udpateLabelClass()},_udpateLabelClass:function(){this.labelNode&&(this.labelNode.innerHTML?m.removeClass(this.labelNode,"not-visible"):m.addClass(this.labelNode,"not-visible"))},setValue:function(b){this.status&&
(!0===b?this.check():this.uncheck())},getValue:function(){return this.checked},setStatus:function(b){b=!!b;var f=this.status!==b;(this.status=b)?l.remove(this.domNode,"jimu-state-disabled"):l.add(this.domNode,"jimu-state-disabled");f&&this.emit("status-change",b)},getStatus:function(){return this.status},check:function(){this.status&&(this.checked=!0,m.addClass(this.checkNode,"checked"),this.onStateChange())},uncheck:function(b){if(this.status&&(this.checked=!1,m.removeClass(this.checkNode,"checked"),
!b))this.onStateChange()},onStateChange:function(){if(this.onChange&&b.isFunction(this.onChange))this.onChange(this.checked);this.emit("change",this.checked)}})})},"esri/arcgis/AppProxyManager":function(){define("dojo/_base/declare dojo/_base/lang ../kernel dojo/uacss dojo/Deferred dojo/promise/all dojo/json dojo/Evented dojo/Stateful ../request ./utils".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){return p([n,g],{constructor:function(a){this.defaults={appid:"",hitsPerInterval:100,intervalSeconds:60,
referrers:[],proxies:[]};a=f.mixin({},this.defaults,a);this.set(a);this._init()},createProxies:function(a){var b=new l;this._registerApp(this._appItem).then(f.hitch(this,function(){for(var c={referrers:this.referrers,hitsPerInterval:this.hitsPerInterval,intervalSeconds:this.intervalSeconds},g=[],k=0;k<a.length;k++)g.push({sourceUrl:a[k].sourceUrl});k=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(k+=this._folderId+"/");k+="items/"+this.appid+"/createProxies";e({url:k,content:{proxies:r.stringify(g),
serviceProxyParams:r.stringify(c),f:"json"},callbackParamName:"callback"},{usePost:!0}).then(f.hitch(this,function(a){this.set("proxies",a.appProxies||[]);b.resolve(a.appProxies)}),b.reject)}),b.reject);return b.promise},deleteProxies:function(a){var b=new l,c={f:"json"},g=[];if(a&&a.length)for(var k=0;k<a.length;k++)g.push(a[k].proxyId);g&&g.length&&(c.proxies=g.toString());a=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(a+=this._folderId+"/");a+="items/"+this.appid+"/deleteProxies";
e({url:a,content:c,callbackParamName:"callback"},{usePost:!0}).then(f.hitch(this,function(a){var c=this.proxies.slice();a=a.results;if(c&&c.length&&a&&a.length)for(var d=0;d<c.length;d++)for(var e=c[d],f=e.proxyId,g=0;g<a.length;g++){var k=a[g].proxyId;k&&f&&k===f&&(e.proxied=!1)}this.set("proxies",c);b.resolve(c)}),b.reject);return b.promise},_parseUrl:function(a){var b=document.createElement("a");b.href=a;return b},_init:function(){this.appid?c.getItem(this.appid).then(f.hitch(this,function(a){this._appItem=
a;this._folderId=a.item.ownerFolder;var b=this._parseUrl(a.item.url);this._sharingBaseUrl="https://"+b.hostname+"/sharing/rest/";var c=b.pathname.substring(0,b.pathname.lastIndexOf("/")),c="/"===c.charAt(0)?c:"/"+c,b=b.hostname+c,c="https://"+b;this.referrers.push("http://"+b);this.referrers.push(c);this._owner=a.item.owner;-1!==a.item.typeKeywords.indexOf("App Proxy")&&a.item.appProxies&&this.set("proxies",a.item.appProxies);this.emit("load",{});this.set("loaded",!0)})):console.error("AppProxyManager: appid required.")},
_registerApp:function(a){var b=new l,c=a.item.id,g=this._sharingBaseUrl+"oauth2/",k=this.referrers;this._registered&&this._registered===this.appid?b.resolve(a):-1!==a.item.typeKeywords.indexOf("Registered App")?b.resolve(a):e({url:g+"/registerApp",content:{itemId:c,appType:"browser",redirect_uris:r.stringify(k),f:"json"},callbackParamName:"callback"},{usePost:!0}).then(f.hitch(this,function(a){this._registered=this.appid;b.resolve(a)}),b.reject);return b.promise}})})},"builder/plugins/attribute-config/AppProxyUtil":function(){define(["dojo/_base/array",
"dojo/Deferred","jimu/portalUtils"],function(p,f,b){function m(b){return p.some(r,function(c){return-1<b.search(c)})}function l(b){return p.some(n,function(c){return-1<b.search(c)})}function h(b){var c=new f;if(b){var a=[];p.forEach(b.operationalLayers,function(b){var c,e;c=b.url;e=document.createElement("a");e.href=c;c=m(e.host);e=l(e.host);(c||e)&&a.push({sourceUrl:b.url,title:b.title||b.name,premium:c,consumeCredits:e,useProxy:!1})});c.resolve(a)}else c.resolve([]);return c}var r=[/traffic\w*\.arcgis\.com/i,
/landsat\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/hydro\w*\.arcgis\.com/i,/naip\w*\.arcgis\.com/i,/livefeeds\w*\.arcgis\.com/i,/demographics\w*\.arcgis\.com/i,/landscape\w*\.arcgis\.com/i,/historical\w*\.arcgis\.com/i,/earthobs\w*\.arcgis\.com/i],n=[/demographics\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/route\w*\.arcgis\.com/i,/logistics\w*\.arcgis\.com/i,/analysis\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i],g={queryForSecureServicesInMap:function(e,
c){try{return b.getPortal(e).getItemData(c).then(function(a){return h(a)},function(){return[]})}catch(u){var a=new f;a.resolve([]);return a}}};g.isPremium=m;g.consumesCredits=l;return g})},"builder/plugins/attribute-config/MapProxyItem":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dojo/Evented dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/CheckBox".split(" "),function(p,f,b,m,l,h,r,n,g){p=p([r,n,g,l],{baseClass:"map-proxy-item",
templateString:'\x3cdiv class\x3d"row"\x3e\x3cdiv data-dojo-attach-point\x3d"layerTitle" class\x3d"col" title\x3d"${title}"\x3e${title}\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"consumeCreditsContent" class\x3d"col credits-value"\x3e\x3c/div\x3e\x3cdiv class\x3d"use-proxy col" data-dojo-attach-point\x3d"useProxyCheckBox" data-dojo-type\x3d"jimu/dijit/CheckBox"\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"loading" class\x3d"loading-content"\x3e\x3c/div\x3e\x3c/div\x3e',appProxyManager:null,
sourceUrl:"",title:"",useProxy:!1,proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,postCreate:function(){this.inherited(arguments);!0===this.consumeCredits&&m.addClass(this.consumeCreditsContent,"credits");m.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);!0===this.useProxy&&this.proxyId&&this.proxyUrl?this.useProxyCheckBox.setValue(!0):this.useProxyCheckBox.setValue(!1);this.own(h(this.useProxyCheckBox,"change",b.hitch(this,this._onUseProxyChange)))},_onUseProxyChange:function(b){b&&
!this.proxyId&&this._createProxy();!b&&this.proxyId&&this._deleteProxy()},_createProxy:function(){this._startProcess("Create Proxy");if(this.appProxyManager){var e=!1;this.appProxyManager.proxies&&0<this.appProxyManager.proxies.length&&(e=f.some(this.appProxyManager.proxies,function(b){return b.sourceUrl===this.sourceUrl&&b.proxyId&&b.proxyUrl}));if(e)this._checkCreateProxiesCallback(this.appProxyManager.proxies);else try{this.appProxyManager.createProxies([{sourceUrl:this.sourceUrl}]).then(b.hitch(this,
this._checkCreateProxiesCallback),b.hitch(this,this._createProxiesFail))}catch(c){this._createProxiesFail(c.message)}}else this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess("appProxyManager is undefined",!1)},_checkCreateProxiesCallback:function(e){f.some(e,b.hitch(this,function(b){if(b.sourceUrl===this.sourceUrl)return this.proxyUrl=b.proxyUrl,this.proxyId=b.proxyId,this.useProxy=!0}))?(this.emit("proxyCreated",{sourceUrl:this.sourceUrl,proxyUrl:this.proxyUrl,
proxyId:this.proxyId,title:this.title,useProxy:!0}),this._stopProcess("Create Proxy",!0)):(this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl),this._stopProcess("Create Proxy",!1))},_createProxiesFail:function(b){this.proxyUrl=this.proxyId="";this.useProxy=!1;this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl);this._stopProcess(b||"Create Proxy",!1)},_deleteProxy:function(){var b=this.proxyId;this.proxyId=this.proxyUrl="";this.useProxy=!1;this.emit("proxyDeleted",
{sourceUrl:this.sourceUrl,useProxy:!1});this.useProxyCheckBox.setValue(!1);if(this.appProxyManager)try{this.appProxyManager.deleteProxies([{proxyId:b}])}catch(c){console.error(c)}},_startProcess:function(b){m.setStyle(this.loading,"display","");this.useProxyCheckBox.setStatus(!1);this.emit("processStart",b)},_stopProcess:function(b,c){m.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);"undefined"!==typeof c&&this.useProxyCheckBox.setValue(c);this.emit("processEnd",b)}});
p.PROXY_CREATED="proxyCreated";p.PROXY_DELETED="proxyDeleted";p.PROCESS_START="processStart";p.PROCESS_END="processEnd";p.PROCESS_ERROR="processError";return p})},"builder/plugins/attribute-config/UrlProxyItem":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Evented","./AppProxyUtil"],function(p,f,b,m,l){p=p([m],{appProxyManager:null,title:"",sourceUrl:"",proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,constructor:function(f){b.mixin(this,f);this.premium=l.isPremium(this.sourceUrl);
this.consumeCredits=l.consumesCredits(this.sourceUrl)},createProxy:function(){this._startProcess();if(this.premium||this.consumeCredits)if(this.appProxyManager){var h=!1;this.appProxyManager.proxies&&0<this.appProxyManager.proxies.length&&(h=f.some(this.appProxyManager.proxies,function(b){return b.sourceUrl===this.sourceUrl&&b.proxyId&&b.proxyUrl}));if(h)this._checkCreateProxiesCallback(this.appProxyManager.proxies);else try{this.appProxyManager.createProxies([{sourceUrl:this.sourceUrl}]).then(b.hitch(this,
function(b){this._checkCreateProxiesCallback(b)}),b.hitch(this,function(){this._checkCreateProxiesCallback([])}))}catch(r){this._checkCreateProxiesCallback([])}}else this._checkCreateProxiesCallback([]);else this.emit("processError",this.nls.notValidPremiumUrl+" "+this.sourceUrl),this._stopProcess()},_checkCreateProxiesCallback:function(h){f.some(h,b.hitch(this,function(b){if(b.sourceUrl===this.sourceUrl)return this.proxyUrl=b.proxyUrl,this.proxyId=b.proxyId,!0}))?this.emit("proxyCreated",{sourceUrl:this.sourceUrl,
proxyUrl:this.proxyUrl,proxyId:this.proxyId,title:this.title,premium:this.premium,consumeCredits:this.consumeCredits,useProxy:!0}):(this.proxyUrl=this.proxyId="",this.useProxy=!1,this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl));this._stopProcess()},deleteProxy:function(){this._startProcess();if(this.appProxyManager&&this.proxyId)try{this.appProxyManager.deleteProxies([{proxyId:this.proxyId}]).then(b.hitch(this,function(h){var l=f.some(h,b.hitch(this,function(b){return b.sourceUrl===
this.sourceUrl&&!1===b.proxied}));l||(l=f.every(h,b.hitch(this,function(b){return b.sourceUrl!==this.sourceUrl})));l?(this.proxyId=this.proxyUrl="",this.emit("proxyDeleted",this.sourceUrl)):this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}),b.hitch(this,function(){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}))}catch(h){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()}else this.emit("processError",
this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()},_startProcess:function(){this.emit("processStart")},_stopProcess:function(){this.emit("processEnd")}});p.PROXY_CREATED="proxyCreated";p.PROCESS_START="processStart";p.PROXY_DELETED="proxyDeleted";p.PROCESS_END="processEnd";p.PROCESS_ERROR="processError";return p})},"builder/dijit/LinkEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LinkEditor.html dojo/on dojo/dom-geometry dojo/Evented ./LinkItemEditor ./LinkItem".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){return p([l,h,e],{templateString:r,baseClass:"link-editor",btnLabel:"",linkList:[],canEdit:!0,canDelete:!0,isRest:!1,beforeAdd:null,afterAdd:null,beforeUpdate:null,afterUpdate:null,beforeDelete:null,afterDelete:null,postMixInProperties:function(){this.nls=f.mixin(this.nls,window.jimuNls.common);""===this.btnLabel&&(this.btnLabel="Add Link")},postCreate:function(){this.inherited(arguments);this.labelNode.innerHTML=this.btnLabel;this.setItems(this.linkList);this.editor=
new c({nls:this.nls,isRest:this.isRest});this.editor.placeAt(this.domNode);this.editor.startup();this.editor.hide();this.own(n(this.editor,"updated",f.hitch(this,this._updateLinkItem)));this.own(n(this.addLinkBtn,"click",f.hitch(this,function(){this._showEditor(null)})))},clearItems:function(){this.linkItems=[];b.empty(this.linkListNode)},setItems:function(a){this.clearItems();this.linkList=a;m.forEach(this.linkList,f.hitch(this,function(a){this._addItem(a,!1)}))},getItems:function(){return this.linkItems},
_showEditor:function(a){var b;null!==a?b=g.position(a.domNode):(b=g.position(this.addLinkBtn),b.y+=b.h);this.editor.setLinkItem(a);this.editor.show(b.x,b.y)},_addItem:function(a,b){b&&"function"===typeof this.beforeAdd?this.beforeAdd(a).then(f.hitch(this,function(b){!0===b&&this._doAddItem(a)})):this._doAddItem(a,b)},_doAddItem:function(b,c){var e=new a({nls:this.nls,label:b.label,url:b.url,canEdit:this.canEdit,canDelete:this.canDelete});e.placeAt(this.linkListNode);e.startup();this.linkItems.push(e);
this.own(n(e,"delete",f.hitch(this,this._deleteItem)));this.own(n(e,"edit",f.hitch(this,function(a){this._showEditor(a)})));c&&"function"===typeof this.afterAdd&&this.afterAdd(e)},_updateLinkItem:function(a){null===a.linkItem?this._addItem({label:a.newValue.label,url:a.newValue.url},!0):"function"===typeof this.beforeUpdate?this.beforeUpdate(a.linkItem,a.newValue.label,a.newValue.url).then(f.hitch(this,function(b){!0===b&&this._doUpdateItem(a.linkItem,a.newValue.label,a.newValue.url)})):this._doUpdateItem(a.linkItem,
a.newValue.label,a.newValue.url)},_doUpdateItem:function(a,b,c){a.update(b,c);"function"===typeof this.afterUpdate&&this.afterUpdate(a,b,c)},_deleteItem:function(a){"function"===typeof this.beforeDelete?this.beforeDelete(a).then(f.hitch(this,function(b){!0===b&&this._doDeleteItem(a)})):this._doDeleteItem(a)},_doDeleteItem:function(a){this.linkItems=m.filter(this.linkItems,function(b){return b!==a});b.destroy(a.domNode);"function"===typeof this.afterDelete&&this.afterDelete(a)}})})},"builder/dijit/LinkItemEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/form/ValidationTextBox jimu/dijit/URLInput dojo/text!./templates/LinkItemEditor.html dojo/on dojo/dom-style dojo/Evented".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c){return p([m,l,c],{templateString:n,baseClass:"link-item-editor",linkItem:null,isRest:!1,postCreate:function(){this.inherited(arguments);this.urlInput=new r({required:!0,rest:this.isRest,placeHolder:this.nls.inputURL,value:this.linkItem?this.linkItem.url:"",style:"width:100%",allowNamed:!1});this.urlInput.placeAt(this.urlNode);this.urlInput.startup();this.titleInput=new h({required:!0,trim:!0,placeHolder:this.nls.inputTitle,value:this.linkItem?this.linkItem.label:"",
style:"width: 100%"});this.titleInput.placeAt(this.titleNode);this.titleInput.startup();this.own(g(this.okBtn,"click",f.hitch(this,this._onOkClicked)));this.own(g(this.cancelBtn,"click",f.hitch(this,this.hide)));this.own(g(this.domNode,"click",f.hitch(this,this._onDomClicked)))},setLinkItem:function(a){this.linkItem=a;this.titleInput.set("value",a?a.label:"");this.urlInput.set("value",a?a.url:"")},_onDomClicked:function(a){b.isDescendant(a.target||a.srcElement,this.contentNode)||this.hide()},show:function(a,
b){e.set(this.domNode,"display","");e.set(this.contentNode,{left:a+"px",top:b+"px"})},hide:function(){e.set(this.domNode,"display","none")},_onOkClicked:function(){if(this.urlInput.isValid()&&this.titleInput.isValid()){var a=this.titleInput.get("value"),b=this.urlInput.get("value");-1===b.indexOf("//")&&(b="http://"+b);this.linkItem&&a===this.linkItem.label&&b===this.linkItem.url||(this.emit("updated",{linkItem:this.linkItem,newValue:{label:a,url:b}}),this.hide())}}})})},"jimu/dijit/URLInput":function(){define(["dojo/_base/declare",
"dojo/_base/html","dijit/form/ValidationTextBox","dojox/validate/regexp"],function(p,f,b,m){return p([b],{required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allowLocal:!0,declaredClass:"jimu.dijit.URLInput",postMixInProperties:function(){this.inherited(arguments);this.invalidMessage=(this.nls=window.jimuNls.urlInput)?this.nls.invalidUrl:"Invalid Url"},postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-url-input")},validator:function(b){if(isFinite(b))return!1;
var f="^"+m.url({allowNamed:this.allowNamed,allowLocal:this.allowLocal}),f=(new RegExp(f,"g")).test(b);return this.rest?(b=/\/rest\/services/gi.test(b),f&&b):f}})})},"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp","dojox/main"],function(p,f,b){var m=p.getObject("validate.regexp",!0,b);return m=b.validate.regexp={ipAddress:function(b){b="object"==typeof b?b:{};"boolean"!=typeof b.allowDottedDecimal&&(b.allowDottedDecimal=!0);"boolean"!=typeof b.allowDottedHex&&(b.allowDottedHex=
!0);"boolean"!=typeof b.allowDottedOctal&&(b.allowDottedOctal=!0);"boolean"!=typeof b.allowDecimal&&(b.allowDecimal=!0);"boolean"!=typeof b.allowHex&&(b.allowHex=!0);"boolean"!=typeof b.allowIPv6&&(b.allowIPv6=!0);"boolean"!=typeof b.allowHybrid&&(b.allowHybrid=!0);var f=[];b.allowDottedDecimal&&f.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");b.allowDottedHex&&f.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");b.allowDottedOctal&&
f.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");b.allowDecimal&&f.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");b.allowHex&&f.push("0[xX]0*[\\da-fA-F]{1,8}");b.allowIPv6&&f.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");b.allowHybrid&&f.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");b=
"";0<f.length&&(b="("+f.join("|")+")");return b},host:function(b){b="object"==typeof b?b:{};"boolean"!=typeof b.allowIP&&(b.allowIP=!0);"boolean"!=typeof b.allowLocal&&(b.allowLocal=!1);"boolean"!=typeof b.allowPort&&(b.allowPort=!0);"boolean"!=typeof b.allowNamed&&(b.allowNamed=!1);var f=b.allowPort?"(\\:\\d+)?":"",l="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.?)";b.allowIP&&(l+="|"+m.ipAddress(b));b.allowLocal&&(l+="|localhost");b.allowNamed&&
(l+="|^[^-][a-zA-Z0-9_-]*");return"("+l+")"+f},url:function(b){b="object"==typeof b?b:{};"scheme"in b||(b.scheme=[!0,!1]);return f.buildGroupRE(b.scheme,function(b){return b?"(https?|ftps?)\\://":""})+m.host(b)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},emailAddress:function(b){b="object"==typeof b?b:{};"boolean"!=typeof b.allowCruft&&(b.allowCruft=!1);b.allowPort=!1;var f="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+m.host(b);b.allowCruft&&
(f="\x3c?(mailto\\:)?"+f+"\x3e?");return f},emailAddressList:function(b){b="object"==typeof b?b:{};"string"!=typeof b.listSeparator&&(b.listSeparator="\\s;,");var f=m.emailAddress(b);return"("+f+"\\s*["+b.listSeparator+"]\\s*)*"+f+"\\s*["+b.listSeparator+"]?\\s*"},numberFormat:function(b){b="object"==typeof b?b:{};"undefined"==typeof b.format&&(b.format="###-###-####");return f.buildGroupRE(b.format,function(b){return f.escapeString(b,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},
province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(b){b="object"==typeof b?b:{};"boolean"!=typeof b.allowTerritories&&(b.allowTerritories=!0);"boolean"!=typeof b.allowMilitary&&(b.allowMilitary=!0);var f="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";b.allowTerritories&&(f+="|AS|FM|GU|MH|MP|PW|PR|VI");b.allowMilitary&&(f+="|AA|AE|AP");return"("+f+")"}}}})},
"builder/dijit/LinkItem":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/mouse dojo/dom-style dojo/Evented".split(" "),function(p,f,b,m,l,h,r,n){return p([b,m,n],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"label" data-dojo-attach-point\x3d"titleNode" title\x3d"${url}"\x3e${label}\x3c/div\x3e\x3cdiv class\x3d"action" data-dojo-attach-point\x3d"actionSection" style\x3d"display:none;"\x3e\x3cdiv class\x3d"btn delete-btn" data-dojo-attach-point\x3d"deleteBtn" title\x3d"${nls.deleteLink}"\x3e\x3c/div\x3e\x3cdiv class\x3d"btn edit-btn" data-dojo-attach-point\x3d"editBtn" title\x3d"${nls.editLink}"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
baseClass:"link-item",label:"",url:"",canEdit:!0,canDelete:!0,_tooltipTimeout:200,postCreate:function(){this.inherited(arguments);this.canDelete?(r.set(this.deleteBtn,"display","inline-block"),this.own(l(this.deleteBtn,"click",f.hitch(this,this._deleteLink)))):r.set(this.deleteBtn,"display","none");this.canEdit?(r.set(this.editBtn,"display","inline-block"),this.own(l(this.editBtn,"click",f.hitch(this,this._editLink)))):r.set(this.editBtn,"display","none");this.own(l(this.domNode,h.enter,f.hitch(this,
function(){r.set(this.actionSection,"display","")})));this.own(l(this.domNode,h.leave,f.hitch(this,function(){r.set(this.actionSection,"display","none")})))},update:function(b,e){this.label=b;this.url=e;this.titleNode.innerHTML=this.label;this.titleNode.title=this.url},_deleteLink:function(){this.emit("delete",this)},_editLink:function(){this.emit("edit",this)}})})},"dojo/NodeList-data":function(){define(["./_base/kernel","./query","./_base/lang","./_base/array","./dom-attr"],function(p,f,b,m,l){var h=
f.NodeList,r={},n=0,g=function(a){var b=l.get(a,"data-dojo-dataid");b||(b="pid"+n++,l.set(a,"data-dojo-dataid",b));return b},e=p._nodeData=function(a,c,e){var f=g(a),k;r[f]||(r[f]={});if(1==arguments.length)return r[f];"string"==typeof c?2<arguments.length?r[f][c]=e:k=r[f][c]:k=b.mixin(r[f],c);return k},c=p._removeNodeData=function(a,b){var c=g(a);r[c]&&(b?delete r[c][b]:delete r[c])};h._gcNodeData=p._gcNodeData=function(){var a=f("[data-dojo-dataid]").map(g),b;for(b in r)0>m.indexOf(a,b)&&delete r[b]};
b.extend(h,{data:h._adaptWithCondition(e,function(a){return 0===a.length||1==a.length&&"string"==typeof a[0]}),removeData:h._adaptAsForEach(c)});return h})},"jimu/dijit/ColorPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup dojox/widget/ColorPicker jimu/utils".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){return p([f,b],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",
templateString:"\x3cdiv\x3e\x3c/div\x3e",_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,ensureMode:!1,showLabel:!1,postMixInProperties:function(){this.nls=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof r||(this.color=new r(this.color)):this.color=new r("#ccc");l.setStyle(this.domNode,"backgroundColor",this.color.toHex());this.showLabel&&this._changeLabel(this.color);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},
destroy:function(){g.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var b=this.tooltipDialog.domNode;return a===b||l.isDescendant(a,b)},hideTooltipDialog:function(){this._hideTooltipDialog()},_showTooltipDialog:function(){g.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){g.close(this.tooltipDialog);this._isTooltipDialogOpened=
!1},_createTooltipDialog:function(){var a=l.create("div");this.tooltipDialog=new n({content:a});l.addClass(this.tooltipDialog.domNode,"jimu-color-picker-dialog");var b=new e({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:m.hitch(this,function(a){this.ensureMode||(a=new r(a),this.setColor(a))})});b.placeAt(a);b.startup();if(this.ensureMode){var c=l.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-trailing",title:this.nls.cancel,innerHTML:this.nls.cancel},
a);this.own(h(c,"click",m.hitch(this,function(){this._hideTooltipDialog()})));"undefined"===typeof this.showOk&&(c=l.create("div",{"class":"jimu-btn jimu-float-trailing ok",title:this.nls.ok,innerHTML:this.nls.ok},a),this.own(h(c,"click",m.hitch(this,function(){var a=this.picker.get("value");this.setColor(new r(a));this._hideTooltipDialog()}))));a=l.create("div",{"class":"jimu-btn jimu-float-trailing",title:this.nls.apply,innerHTML:this.nls.apply},a);this.own(h(a,"click",m.hitch(this,function(){var a=
this.picker.get("value");this.setColor(new r(a))})))}this.own(h(this.domNode,"click",m.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(h(document.body,"click",m.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})));this.picker=b},setColor:function(a,b){if(a instanceof r){var c=this.color,e="";c&&(e=c.toHex());c=a.toHex();this.color=a;l.setStyle(this.domNode,
"backgroundColor",c);if(e!==c&&(this.picker.set("value",c),!1!==b))this.onChange(new r(c))}},getColor:function(){return this.color},_changeLabel:function(a){l.empty(this.domNode);l.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:c.invertColor(a.toHex())}},this.domNode)},onChange:function(a){this.showLabel&&this._changeLabel(a)},getPopup:function(){return this.tooltipDialog||null},setLabel:function(a){l.empty(this.domNode);l.create("span",{innerHTML:a||"",className:"text-label"},
this.domNode)}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u){p=p("dijit.TooltipDialog",[n,c,e,g],{title:"",doLayout:!1,autofocus:!0,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:a,_setTitleAttr:"containerNode",
postCreate:function(){this.inherited(arguments);this.own(h(this.domNode,"keydown",l.hitch(this,"_onKey")))},orient:function(a,b,c){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft",
"BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[b+"-"+c];f.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();r.focus(this._firstFocusItem)},onOpen:function(a){this.orient(this.domNode,a.aroundCorner,a.corner);var b=a.aroundNodePos;"M"==a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=b.y+(b.h-this.connectorNode.offsetHeight>>
1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=b.x+(b.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(a){if(a.keyCode==m.ESCAPE)this.defer("onCancel"),a.stopPropagation(),a.preventDefault();else if(a.keyCode==m.TAB){var b=a.target;this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&
a.shiftKey?(r.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b!=this._lastFocusItem||a.shiftKey?a.stopPropagation():(r.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}}});b("dojo-bidi")&&p.extend({_setTitleAttr:function(a){this.containerNode.title=this.textDir&&this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,a):a;this._set("title",a)},_setTextDirAttr:function(a){this._created&&this.textDir==a||(this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=
this.enforceTextDirWithUcc(null,this.title)))}});return p})},"dojox/widget/ColorPicker":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/connect dojo/_base/sniff dojo/_base/window dojo/_base/event dojo/dom dojo/dom-class dojo/keys dojo/fx dojo/dnd/move dijit/registry dijit/_base/focus dijit/form/_FormWidget dijit/typematic dojox/color dojo/i18n dojo/i18n!./nls/ColorPicker dojo/i18n!dojo/cldr/nls/number dojo/text!./ColorPicker/ColorPicker.html".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z){p.experimental("dojox.widget.ColorPicker");return f("dojox.widget.ColorPicker",d,{showRgb:!0,showHsv:!0,showHex:!0,webSafe:!0,animatePoint:!0,slideDuration:250,liveUpdate:!1,PICKER_HUE_H:150,PICKER_SAT_VAL_H:150,PICKER_SAT_VAL_W:150,PICKER_HUE_SELECTOR_H:8,PICKER_SAT_SELECTOR_H:10,PICKER_SAT_SELECTOR_W:10,value:"#ffffff",_underlay:require.toUrl("dojox/widget/ColorPicker/images/underlay.png"),_hueUnderlay:require.toUrl("dojox/widget/ColorPicker/images/hue.png"),
_pickerPointer:require.toUrl("dojox/widget/ColorPicker/images/pickerPointer.png"),_huePickerPointer:require.toUrl("dojox/widget/ColorPicker/images/hueHandle.png"),_huePickerPointerAlly:require.toUrl("dojox/widget/ColorPicker/images/hueHandleA11y.png"),templateString:z,postMixInProperties:function(){c.contains(n.body(),"dijit_a11y")&&(this._huePickerPointer=this._huePickerPointerAlly);this._uId=q.getUniqueId(this.id);b.mixin(this,x.getLocalization("dojox.widget","ColorPicker"));b.mixin(this,x.getLocalization("dojo.cldr",
"number"));this.inherited(arguments)},postCreate:function(){this.inherited(arguments);7>r("ie")&&(this.colorUnderlay.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this._underlay+"', sizingMethod\x3d'scale')",this.colorUnderlay.src=this._blankGif.toString());this.showRgb||(this.rgbNode.style.visibility="hidden");this.showHsv||(this.hsvNode.style.visibility="hidden");this.showHex||(this.hexNode.style.visibility="hidden");this.webSafe||(this.safePreviewNode.style.visibility=
"hidden")},startup:function(){this._started||(this._started=!0,this.set("value",this.value),this._mover=new v.boxConstrainedMoveable(this.cursorNode,{box:{t:-(this.PICKER_SAT_SELECTOR_H/2),l:-(this.PICKER_SAT_SELECTOR_W/2),w:this.PICKER_SAT_VAL_W,h:this.PICKER_SAT_VAL_H}}),this._hueMover=new v.boxConstrainedMoveable(this.hueCursorNode,{box:{t:-(this.PICKER_HUE_SELECTOR_H/2),l:0,w:0,h:this.PICKER_HUE_H}}),this._subs=[],this._subs.push(h.subscribe("/dnd/move/stop",b.hitch(this,"_clearTimer"))),this._subs.push(h.subscribe("/dnd/move/start",
b.hitch(this,"_setTimer"))),this._keyListeners=[],this._connects.push(w.addKeyListener(this.hueCursorNode,{charOrCode:a.UP_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,b.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(w.addKeyListener(this.hueCursorNode,{charOrCode:a.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,b.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(w.addKeyListener(this.cursorNode,{charOrCode:a.UP_ARROW,shiftKey:!1,metaKey:!1,
ctrlKey:!1,altKey:!1},this,b.hitch(this,this._updateCursorNode),25,25)),this._connects.push(w.addKeyListener(this.cursorNode,{charOrCode:a.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,b.hitch(this,this._updateCursorNode),25,25)),this._connects.push(w.addKeyListener(this.cursorNode,{charOrCode:a.LEFT_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,b.hitch(this,this._updateCursorNode),25,25)),this._connects.push(w.addKeyListener(this.cursorNode,{charOrCode:a.RIGHT_ARROW,shiftKey:!1,
metaKey:!1,ctrlKey:!1,altKey:!1},this,b.hitch(this,this._updateCursorNode),25,25)))},_setValueAttr:function(a,b){this._started&&this.setColor(a,b)},setColor:function(a,b){a=t.fromString(a);this._updatePickerLocations(a);this._updateColorInputs(a);this._updateValue(a,b)},_setTimer:function(a){if(a.node==this.cursorNode||a.node==this.hueCursorNode)k.focus(a.node),e.setSelectable(this.domNode,!1),this._timer=setInterval(b.hitch(this,"_updateColor"),45)},_clearTimer:function(a){this._timer&&(clearInterval(this._timer),
this._timer=null,this.onChange(this.value),e.setSelectable(this.domNode,!0))},_setHue:function(a){l.style(this.colorUnderlay,"backgroundColor",t.fromHsv(a,100,100).toHex())},_updateHueCursorNode:function(b,c,d){if(-1!==b){b=l.style(this.hueCursorNode,"top");c=this.PICKER_HUE_SELECTOR_H/2;b+=c;var e=!1;d.charOrCode==a.UP_ARROW?0<b&&(--b,e=!0):d.charOrCode==a.DOWN_ARROW&&b<this.PICKER_HUE_H&&(b+=1,e=!0);e&&l.style(this.hueCursorNode,"top",b-c+"px")}else this._updateColor(!0)},_updateCursorNode:function(b,
c,d){c=this.PICKER_SAT_SELECTOR_H/2;var e=this.PICKER_SAT_SELECTOR_W/2;if(-1!==b){b=l.style(this.cursorNode,"top");var f=l.style(this.cursorNode,"left");b+=c;var f=f+e,g=!1;d.charOrCode==a.UP_ARROW?0<b&&(--b,g=!0):d.charOrCode==a.DOWN_ARROW?b<this.PICKER_SAT_VAL_H&&(b+=1,g=!0):d.charOrCode==a.LEFT_ARROW?0<f&&(--f,g=!0):d.charOrCode==a.RIGHT_ARROW&&f<this.PICKER_SAT_VAL_W&&(f+=1,g=!0);g&&(f-=e,l.style(this.cursorNode,"top",b-c+"px"),l.style(this.cursorNode,"left",f+"px"))}else this._updateColor(!0)},
_updateColor:function(a){var b=this.PICKER_HUE_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_H/2,d=this.PICKER_SAT_SELECTOR_W/2,b=l.style(this.hueCursorNode,"top")+b,c=l.style(this.cursorNode,"top")+c,d=l.style(this.cursorNode,"left")+d,b=Math.round(360-b/this.PICKER_HUE_H*360),d=t.fromHsv(b,d/this.PICKER_SAT_VAL_W*100,100-c/this.PICKER_SAT_VAL_H*100);this._updateColorInputs(d);this._updateValue(d,a);b!=this._hue&&this._setHue(b)},_colorInputChange:function(a){var b,c=!1;switch(a.target){case this.hexCode:b=
t.fromString(a.target.value);c=!0;break;case this.Rval:case this.Gval:case this.Bval:b=t.fromArray([this.Rval.value,this.Gval.value,this.Bval.value]);c=!0;break;case this.Hval:case this.Sval:case this.Vval:b=t.fromHsv(this.Hval.value,this.Sval.value,this.Vval.value),c=!0}c&&(this._updatePickerLocations(b),this._updateColorInputs(b),this._updateValue(b,!0))},_updateValue:function(a,b){var c=a.toHex();this.value=this.valueNode.value=c;if(b&&(!this._timer||this.liveUpdate))this.onChange(c)},_updatePickerLocations:function(a){var b=
this.PICKER_HUE_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_H/2,d=this.PICKER_SAT_SELECTOR_W/2;a=a.toHsv();b=Math.round(this.PICKER_HUE_H-a.h/360*this.PICKER_HUE_H)-b;d=Math.round(a.s/100*this.PICKER_SAT_VAL_W)-d;c=Math.round(this.PICKER_SAT_VAL_H-a.v/100*this.PICKER_SAT_VAL_H)-c;this.animatePoint?(u.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:b,left:0}).play(),u.slideTo({node:this.cursorNode,duration:this.slideDuration,top:c,left:d}).play()):(l.style(this.hueCursorNode,"top",b+"px"),
l.style(this.cursorNode,{left:d+"px",top:c+"px"}));a.h!=this._hue&&this._setHue(a.h)},_updateColorInputs:function(a){var b=a.toHex();this.showRgb&&(this.Rval.value=a.r,this.Gval.value=a.g,this.Bval.value=a.b);this.showHsv&&(a=a.toHsv(),this.Hval.value=Math.round(a.h),this.Sval.value=Math.round(a.s),this.Vval.value=Math.round(a.v));this.showHex&&(this.hexCode.value=b);this.previewNode.style.backgroundColor=b;this.webSafe&&(this.safePreviewNode.style.backgroundColor=b)},_setHuePoint:function(a){a=a.layerY-
this.PICKER_HUE_SELECTOR_H/2;this.animatePoint?u.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:a,left:0,onEnd:b.hitch(this,function(){this._updateColor(!1);k.focus(this.hueCursorNode)})}).play():(l.style(this.hueCursorNode,"top",a+"px"),this._updateColor(!1))},_setPoint:function(a){var c=a.layerY-this.PICKER_SAT_SELECTOR_H/2,d=a.layerX-this.PICKER_SAT_SELECTOR_W/2;a&&k.focus(a.target);this.animatePoint?u.slideTo({node:this.cursorNode,duration:this.slideDuration,top:c,left:d,onEnd:b.hitch(this,
function(){this._updateColor(!0);k.focus(this.cursorNode)})}).play():(l.style(this.cursorNode,{left:d+"px",top:c+"px"}),this._updateColor(!1))},_handleKey:function(a){},focus:function(){this.focused||k.focus(this.focusNode)},_stopDrag:function(a){g.stop(a)},destroy:function(){this.inherited(arguments);m.forEach(this._subs,function(a){h.unsubscribe(a)});delete this._subs}})})},"dojox/color":function(){define(["./color/_base"],function(p){return p})},"dojox/color/_base":function(){define(["../main",
"dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(p,f,b,m){p=f.getObject("color",!0,p);p.Color=b;p.blend=b.blendColors;p.fromRgb=b.fromRgb;p.fromHex=b.fromHex;p.fromArray=b.fromArray;p.fromString=b.fromString;p.greyscale=m.makeGrey;f.mixin(p,{fromCmy:function(l,h,m){f.isArray(l)?(h=l[1],m=l[2],l=l[0]):f.isObject(l)&&(h=l.m,m=l.y,l=l.c);return new b({r:Math.round(255*(1-l/100)),g:Math.round(255*(1-h/100)),b:Math.round(255*(1-m/100))})},fromCmyk:function(l,h,m,n){f.isArray(l)?(h=l[1],m=l[2],
n=l[3],l=l[0]):f.isObject(l)&&(h=l.m,m=l.y,n=l.b,l=l.c);n/=100;return new b({r:Math.round(255*(1-Math.min(1,l/100*(1-n)+n))),g:Math.round(255*(1-Math.min(1,h/100*(1-n)+n))),b:Math.round(255*(1-Math.min(1,m/100*(1-n)+n)))})},fromHsl:function(l,h,m){f.isArray(l)?(h=l[1],m=l[2],l=l[0]):f.isObject(l)&&(h=l.s,m=l.l,l=l.h);h/=100;for(m/=100;0>l;)l+=360;for(;360<=l;)l-=360;var n,g;120>l?(n=(120-l)/60,g=l/60,l=0):240>l?(n=0,g=(240-l)/60,l=(l-120)/60):(n=(l-240)/60,g=0,l=(360-l)/60);n=2*h*Math.min(n,1)+(1-
h);g=2*h*Math.min(g,1)+(1-h);l=2*h*Math.min(l,1)+(1-h);.5>m?(n*=m,g*=m,l*=m):(n=(1-m)*n+2*m-1,g=(1-m)*g+2*m-1,l=(1-m)*l+2*m-1);return new b({r:Math.round(255*n),g:Math.round(255*g),b:Math.round(255*l)})}});p.fromHsv=function(l,h,m){f.isArray(l)?(h=l[1],m=l[2],l=l[0]):f.isObject(l)&&(h=l.s,m=l.v,l=l.h);360==l&&(l=0);h/=100;m/=100;var n,g,e;if(0==h)g=e=n=m;else{var c=l/60;l=Math.floor(c);var a=c-l,c=m*(1-h),p=m*(1-h*a);h=m*(1-h*(1-a));switch(l){case 0:n=m;g=h;e=c;break;case 1:n=p;g=m;e=c;break;case 2:n=
c;g=m;e=h;break;case 3:n=c;g=p;e=m;break;case 4:n=h;g=c;e=m;break;case 5:n=m,g=c,e=p}}return new b({r:Math.round(255*n),g:Math.round(255*g),b:Math.round(255*e)})};f.extend(b,{toCmy:function(){return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*(1-this.g/255)),y:Math.round(100*(1-this.b/255))}},toCmyk:function(){var b,f=this.r/255,m=this.g/255,n=this.b/255;b=Math.min(1-f,1-m,1-n);return{c:Math.round((1-f-b)/(1-b)*100),m:Math.round((1-m-b)/(1-b)*100),y:Math.round((1-n-b)/(1-b)*100),b:Math.round(100*
b)}},toHsl:function(){var b=this.r/255,f=this.g/255,m=this.b/255,n=Math.min(b,m,f),g=Math.max(b,f,m),e=g-n,c=0,a=0,n=(n+g)/2;0<n&&1>n&&(a=e/(.5>n?2*n:2-2*n));0<e&&(g==b&&g!=f&&(c+=(f-m)/e),g==f&&g!=m&&(c+=2+(m-b)/e),g==m&&g!=b&&(c+=4+(b-f)/e),c*=60);return{h:c,s:Math.round(100*a),l:Math.round(100*n)}},toHsv:function(){var b=this.r/255,f=this.g/255,m=this.b/255,n=Math.max(b,f,m),g=n-Math.min(b,m,f),e=null,c=0==n?0:g/n;0==c?e=0:(e=b==n?60*(f-m)/g:f==n?120+60*(m-b)/g:240+60*(b-f)/g,0>e&&(e+=360));return{h:e,
s:Math.round(100*c),v:Math.round(100*n)}}});return p})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v){p=b("dijit._editor.plugins._FontDropDown",[g,e,c],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:p,postMixInProperties:function(){this.inherited(arguments);this.strings=l.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=n.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new r({idProperty:"value",data:f.map(this.values,function(a){var b=this.strings[a]||a;return{label:this.getLabel(a,b),name:b,value:a}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(a,b){b=!1!==b;this.select.set("value",0>f.indexOf(this.values,a)?"":a,b);b||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(a){this._set("disabled",a);this.select.set("disabled",a)}});var q=b("dijit._editor.plugins._FontNameDropDown",p,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(a,b){return this.plainText?b:"\x3cdiv style\x3d'font-family: "+a+"'\x3e"+b+"\x3c/div\x3e"},_setValueAttr:function(a,b){this.generic&&(a={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",
Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[a]||a);this.inherited(arguments,[a,!1!==b])}}),k=b("dijit._editor.plugins._FontSizeDropDown",p,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(a,b){return this.plainText?b:"\x3cfont size\x3d"+a+"'\x3e"+b+"\x3c/font\x3e"},_setValueAttr:function(a,b){b=!1!==b;a.indexOf&&-1!=a.indexOf("px")&&(a={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(a,10)]||a);this.inherited(arguments,[a,b])}}),d=b("dijit._editor.plugins._FormatBlockDropDown",
p,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(a,b){return this.plainText||"noFormat"==a?b:"\x3c"+a+"\x3e"+b+"\x3c/"+a+"\x3e"},_execCommand:function(a,b,c){if("noFormat"===c){var d;if((b=v.getSelection(a.window))&&0<b.rangeCount){c=b.getRangeAt(0);var e;if(c){b=c.startContainer;for(d=c.endContainer;b&&b!==a.editNode&&b!==a.document.body&&1!==b.nodeType;)b=
b.parentNode;for(;d&&d!==a.editNode&&d!==a.document.body&&1!==d.nodeType;)d=d.parentNode;var g=h.hitch(this,function(b,c){if(b.childNodes&&b.childNodes.length){var d;for(d=0;d<b.childNodes.length;d++){var e=b.childNodes[d];if(1==e.nodeType&&a.selection.inSelection(e)){var k=e.tagName?e.tagName.toLowerCase():"";-1!==f.indexOf(this.values,k)&&c.push(e);g(e,c)}}}});c=h.hitch(this,function(b){if(b&&b.length){for(a.beginEditing();b.length;)this._removeFormat(a,b.pop());a.endEditing()}});var k=[];if(b==
d){var l;for(d=b;d&&d!==a.editNode&&d!==a.document.body;){if(1==d.nodeType&&(e=d.tagName?d.tagName.toLowerCase():"",-1!==f.indexOf(this.values,e))){l=d;break}d=d.parentNode}g(b,k);l&&(k=[l].concat(k))}else for(d=b;a.selection.inSelection(d);)1==d.nodeType&&(e=d.tagName?d.tagName.toLowerCase():"",-1!==f.indexOf(this.values,e)&&k.push(d),g(d,k)),d=d.nextSibling;c(k);a.onDisplayChanged()}}}else a.execCommand(b,c)},_removeFormat:function(a,b){if(a.customUndo){for(;b.firstChild;)m.place(b.firstChild,b,
"before");b.parentNode.removeChild(b)}else{a.selection.selectElementChildren(b);var c=a.selection.getSelectedHtml();a.selection.selectElement(b);a.execCommand("inserthtml",c||"")}}}),w=b("dijit._editor.plugins.FontChoice",u,{useDefaultCommand:!1,_initButton:function(){var a={fontName:q,fontSize:k,formatBlock:d}[this.command],b=this.params;this.params.custom&&(b.values=this.params.custom);var c=this.editor;this.button=new a(h.delegate({dir:c.dir,lang:c.lang},b));this.own(this.button.select.on("change",
h.hitch(this,function(a){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=a.indexOf(" ")&&(a="'"+a+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,a):this.editor.execCommand(this.command,a)})))},updateState:function(){var a=this.editor,b=this.command;if(a&&a.isLoaded&&b.length&&this.button){var c=this.get("disabled");this.button.set("disabled",c);if(!c){var d;try{d=a.queryCommandValue(b)||""}catch(C){d=""}(c=h.isString(d)&&(d.match(/'([^']*)'/)||
d.match(/"([^"]*)"/)))&&(d=c[1]);if("formatBlock"===b)if(d&&"p"!=d)0>f.indexOf(this.button.values,d)&&(d="noFormat");else{d=null;var e;(b=v.getSelection(this.editor.window))&&0<b.rangeCount&&(b=b.getRangeAt(0))&&(e=b.endContainer);for(;e&&e!==a.editNode&&e!==a.document;){if((b=e.tagName?e.tagName.toLowerCase():"")&&-1<f.indexOf(this.button.values,b)){d=b;break}e=e.parentNode}d||(d="noFormat")}d!==this.button.get("value")&&this.button.set("value",d,!1)}}}});f.forEach(["fontName","fontSize","formatBlock"],
function(a){u.registry[a]=function(b){return new w({command:a,plainText:b.plainText})}});w._FontDropDown=p;w._FontNameDropDown=q;w._FontSizeDropDown=k;w._FormatBlockDropDown=d;return w})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(p,f,b,m,l){return p("dijit.form.FilteringSelect",[m,l],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||
!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(b,f,l,g){f&&f[this.searchAttr]!==this._lastQuery||!f&&b.length&&this.store.getIdentity(b[0])!=this._lastQuery||(b.length?this.set("item",b[0],g):this.set("value","",g||void 0===g&&!this.focused,this.textbox.value,null))},_openResultList:function(b,f,l){f[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},
_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(h,l,m,g){this._onChangeActive||(l=null);if(void 0===g){if(null===h||""===h)if(h="",!f.isString(m)){this._setDisplayedValueAttr(m||"",l);return}var e=this;this._lastQuery=h;b(this.store.get(h),function(b){e._callbackSetLabel(b?[b]:[],void 0,void 0,l)})}else this.valueNode.value=h,this.inherited(arguments,[h,l,m,g])},_setItemAttr:function(b,f,l){this.inherited(arguments);this._lastDisplayedValue=
this.textbox.value},_getDisplayQueryString:function(b){return b.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(h,l){null==h&&(h="");if(!this._created){if(!("displayedValue"in this.params))return;l=!1}if(this.store){this.closeDropDown();var m=f.clone(this.query),g=this._getDisplayQueryString(h),e;this.store._oldAPI?e=g:(e=this._patternToRegExp(g),e.toString=function(){return g});this._lastQuery=m[this.searchAttr]=e;this._lastDisplayedValue=this.textbox.value=h;this._set("displayedValue",
h);var c=this,a={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};f.mixin(a,this.fetchProperties);this._fetchHandle=this.store.query(m,a);b(this._fetchHandle,function(b){c._fetchHandle=null;c._callbackSetLabel(b||[],m,a,l)},function(a){c._fetchHandle=null;c._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(p,f,b,m,l,h,r,n,g){return p("dijit.form.ComboBoxMixin",[n,h],{dropDownClass:r,hasDownArrow:!0,templateString:g,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(b){this._set("hasDownArrow",b);this._buttonNode.style.display=b?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(b){b.get||m.mixin(b,{_oldAPI:!0,get:function(b){var a=new f;this.fetchItemByIdentity({identity:b,
onItem:function(b){a.resolve(b)},onError:function(b){a.reject(b)}});return a.promise},query:function(b,a){var c=new f(function(){e.abort&&e.abort()});c.total=new f;var e=this.fetch(m.mixin({query:b,onBegin:function(a){c.total.resolve(a)},onComplete:function(a){c.resolve(a)},onError:function(a){c.reject(a)}},a));return l(c)}});this._set("store",b)},postMixInProperties:function(){var e=this.params.store||this.store;e&&this._setStoreAttr(e);this.inherited(arguments);if(!this.params.store&&this.store&&
!this.store._oldAPI){var c=this.declaredClass;m.mixin(this.store,{getValue:function(a,e){b.deprecated(c+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return a[e]},getLabel:function(a){b.deprecated(c+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return a.name},fetch:function(a){b.deprecated(c+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],
m.hitch(this,function(b){(new b({objectStore:this})).fetch(a)}))}})}},buildRendering:function(){this.inherited(arguments);this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list")}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(p,f,b,m,l,h,r,n,g,e,c){f=f("dijit.form._AutoCompleterMixin",c,{item:null,
autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var b=0;if("number"==typeof a.selectionStart)b=a.selectionStart;else if(n("ie")){var c=a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();c.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",c),b=String(a.text).replace(/\r/g,"").length}catch(q){}}return b},_setCaretPos:function(a,b){b=parseInt(b);e.selectInputText(a,b,b)},_setDisabledAttr:function(a){this.inherited(arguments);
this.domNode.setAttribute("aria-disabled",a?"true":"false")},_onKey:function(a){if(!(32<=a.charCode)){var b=a.charCode||a.keyCode;if(b!=m.ALT&&b!=m.CTRL&&b!=m.META&&b!=m.SHIFT){var c=this.dropDown,e=null;this._abortQuery();this.inherited(arguments);if(!(a.altKey||a.ctrlKey||a.metaKey))switch(this._opened&&(e=c.getHighlightedOption()),b){case m.PAGE_DOWN:case m.DOWN_ARROW:case m.PAGE_UP:case m.UP_ARROW:this._opened&&this._announceOption(e);a.stopPropagation();a.preventDefault();break;case m.ENTER:if(e){if(e==
c.nextButton){this._nextSearch(1);a.stopPropagation();a.preventDefault();break}else if(e==c.previousButton){this._nextSearch(-1);a.stopPropagation();a.preventDefault();break}a.stopPropagation();a.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case m.TAB:b=this.get("displayedValue");if(c&&(b==c._messages.previousMessage||b==c._messages.nextMessage))break;e&&this._selectOption(e);case m.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},
_autoCompleteText:function(a){var b=this.focusNode;e.selectInputText(b,b.value.length);var c=this.ignoreCase?"toLowerCase":"substr";0==a[c](0).indexOf(this.focusNode.value[c](0))?(c=this.autoComplete?this._getCaretPos(b):b.value.length,c+1>b.value.length&&(b.value=a,e.selectInputText(b,c))):(b.value=a,e.selectInputText(b))},_openResultList:function(a,b,c){var e=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();a.length||0!=c.start?(this._nextSearch=this.dropDown.onPage=l.hitch(this,
function(b){a.nextPage(-1!==b);this.focus()}),this.dropDown.createOptions(a,c,l.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),"direction"in c?(c.direction?this.dropDown.highlightFirstOption():c.direction||this.dropDown.highlightLastOption(),e&&this._announceOption(this.dropDown.getHighlightedOption())):!this.autoComplete||this._prev_key_backspace||/^[*]+$/.test(b[this.searchAttr].toString())||this._announceOption(this.dropDown.containerNode.firstChild.nextSibling)):this.closeDropDown()},
_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),b=this.dropDown;!b||a!=b._messages.previousMessage&&a!=b._messages.nextMessage?"undefined"==typeof this.item?
(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState()):this._setValueAttr(this._lastValueReported,!0);this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,b,c){var e="";a&&(c||(c=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),e=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):c);this.set("value",e,b,c,a)},_announceOption:function(a){if(a){var c;
if(a==this.dropDown.nextButton||a==this.dropDown.previousButton)c=a.innerHTML,this.item=void 0,this.value="";else{var e=this.dropDown.items[a.getAttribute("item")];c=(this.store._oldAPI?this.store.getValue(e,this.searchAttr):e[this.searchAttr]).toString();this.set("item",e,!1,c)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",b.get(a,"id"));this._autoCompleteText(c)}},_selectOption:function(a){this.closeDropDown();a&&
this._announceOption(a);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var b=this.id+"_popup";this.dropDown=new (l.isString(this.dropDownClass)?l.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:l.hitch(this,
this._selectOption),id:b,dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&this.srcNodeRef&&(this.store=new g({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var b=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,b):a[b]}}},postCreate:function(){var a=h('label[for\x3d"'+
this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",a[0].id));this.inherited(arguments);p.after(this,"onSearch",l.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=this.labelFunc(a,this.store);var b=this.labelType;"none"!=this.highlightMatch&&"text"==this.labelType&&this._lastInput&&(a=this.doHighlight(a,this._lastInput),b="html");return{html:"html"==b,label:a}},doHighlight:function(a,b){var c=(this.ignoreCase?"i":"")+("all"==
this.highlightMatch?"g":""),e=this.queryExpr.indexOf("${0}");b=r.escapeString(b);return this._escapeHtml(a.replace(new RegExp((0==e?"^":"")+"("+b+")"+(e==this.queryExpr.length-4?"$":""),c),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},
labelFunc:function(a,b){return(b._oldAPI?b.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(a,b,c,e){this._set("item",e||null);null==a&&(a="");this.inherited(arguments)}});n("dojo-bidi")&&f.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return f})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),
function(p,f,b,m,l,h){function r(f){return{id:f.value,value:f.value,name:b.trim(f.innerText||f.textContent||"")}}return p("dijit.form.DataList",l,{constructor:function(l,g){this.domNode=f.byId(g);b.mixin(this,l);this.id&&h.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:m("option",this.domNode).map(r)}])},destroy:function(){h.remove(this.id)},fetchSelectedItem:function(){var b=m("\x3e option[selected]",this.domNode)[0]||m("\x3e option",this.domNode)[0];return b&&r(b)}})})},
"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(p,f,b,m,l,h,r){return p("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(b){this._set("list",b)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(b){return new RegExp("^"+b.replace(/(\\.)|(\*)|(\?)|\W/g,function(b,e,c,a){return c?".*":
a?".":e?e:"\\"+b})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(b){if(!this.disabled&&
!this.readOnly){b=b.charOrCode;this._prev_key_backspace=!1;if(b==f.DELETE||b==f.BACKSPACE)this._maskValidSubsetError=this._prev_key_backspace=!0;if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(f){this._abortQuery();var g=this,e=b.clone(this.query),c={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},a=l.substitute(this.queryExpr,
[f.replace(/([\\\*\?])/g,"\\$1")]),m,n=function(){var a=g._fetchHandle=g.store.query(e,c);g.disabled||g.readOnly||m!==g._lastQuery||h(a,function(b){g._fetchHandle=null;g.disabled||g.readOnly||m!==g._lastQuery||h(a.total,function(a){b.total=a;var d=g.pageSize;if(isNaN(d)||d>b.total)d=b.total;b.nextPage=function(a){c.direction=a=!1!==a;c.count=d;a?(c.start+=b.length,c.start>=b.total&&(c.count=0)):(c.start-=d,0>c.start&&(c.count=Math.max(d+c.start,0),c.start=0));0>=c.count?(b.length=0,g.onSearch(b,e,
c)):n()};g.onSearch(b,e,c)})},function(a){g._fetchHandle=null;g._cancelingQuery||console.error(g.declaredClass+" "+a.toString())})};b.mixin(c,this.fetchProperties);this.store._oldAPI?m=a:(m=this._patternToRegExp(a),m.toString=function(){return a});this._lastQuery=e[this.searchAttr]=m;this._queryDeferHandle=this.defer(n,this.searchDelay)},constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var b=this.list;b&&(this.store=r.byId(b))}this.inherited(arguments)}})})},
"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),function(p,f,b,m,l,h,r,n){return p("dijit.form._ComboBoxMenu",[l,h,n,r],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(f.add(this.previousButton,"dijitMenuItemRtl"),f.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var b=this.ownerDocument.createElement("div");b.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");b.setAttribute("role","option");return b},onHover:function(b){f.add(b,"dijitMenuItemHover")},onUnhover:function(b){f.remove(b,
"dijitMenuItemHover")},onSelect:function(b){f.add(b,"dijitMenuItemSelected")},onDeselect:function(b){f.remove(b,"dijitMenuItemSelected")},_page:function(f){var e=0,c=this.domNode.scrollTop,a=b.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();e<a;){var g=this.getHighlightedOption();if(f){if(!g.previousSibling||"none"==g.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!g.nextSibling||"none"==g.nextSibling.style.display)break;this.selectNextNode()}g=
this.domNode.scrollTop;e+=(g-c)*(f?-1:1);c=g}},handleKey:function(b){switch(b.keyCode){case m.DOWN_ARROW:return this.selectNextNode(),!1;case m.PAGE_DOWN:return this._page(!1),!1;case m.UP_ARROW:return this.selectPreviousNode(),!1;case m.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(p,f,b,m,l){var h=f("dijit.form._ComboBoxMenuMixin"+
(m("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=l.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(b){this._set("value",b);this.onChange(b)},onClick:function(b){if(b==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(b==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(b)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(b,f){var g=this._createMenuItem(),e=f(b);e.html?g.innerHTML=e.label:g.appendChild(g.ownerDocument.createTextNode(e.label));""==g.innerHTML&&(g.innerHTML="\x26#160;");return g},createOptions:function(f,h,g){this.items=f;this.previousButton.style.display=0==h.start?"none":"";b.set(this.previousButton,"id",this.id+
"_prev");p.forEach(f,function(c,a){var e=this._createOption(c,g);e.setAttribute("item",a);b.set(e,"id",this.id+a);this.nextButton.parentNode.insertBefore(e,this.nextButton)},this);var e=!1;f.total&&!f.total.then&&-1!=f.total?h.start+h.count<f.total?e=!0:h.start+h.count>f.total&&h.count==f.length&&(e=!0):h.count==f.length&&(e=!0);this.nextButton.style.display=e?"":"none";b.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var b=this.containerNode;2<b.childNodes.length;)b.removeChild(b.childNodes[b.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});m("dojo-bidi")&&(h=f("dijit.form._ComboBoxMenuMixin",
h,{_createOption:function(){var b=this.inherited(arguments);this.applyTextDir(b);return b}}));return h})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(p,f,b,m){return p("dijit.form._ListMouseMixin",m,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover",
"_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(b,f){this._setSelectedAttr(f,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(f)})},_onMouseDown:function(b,f){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(f,!1)},_onMouseUp:function(b,f){this._isDragging=!1;var h=this.selected,l=this._hoveredNode;h&&f==h?this.defer(function(){this._onClick(b,
h)}):l&&this.defer(function(){this._onClick(b,l)})},_onMouseOut:function(b,f){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(b,f){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=f;this.onHover(f);this._isDragging&&this._setSelectedAttr(f,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on",
"dojo/window"],function(p,f,b){return p("dijit.form._ListBase",null,{selected:null,_listConnect:function(b,l){var h=this;return h.own(f(h.containerNode,f.selector(function(b,f,g){return b.parentNode==g},b),function(b){h[l](b,this)}))},selectFirstNode:function(){for(var b=this.containerNode.firstChild;b&&"none"==b.style.display;)b=b.nextSibling;this._setSelectedAttr(b,!0)},selectLastNode:function(){for(var b=this.containerNode.lastChild;b&&"none"==b.style.display;)b=b.previousSibling;this._setSelectedAttr(b,
!0)},selectNextNode:function(){var b=this.selected;if(b){for(b=b.nextSibling;b&&"none"==b.style.display;)b=b.nextSibling;b?this._setSelectedAttr(b,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var b=this.selected;if(b){for(b=b.previousSibling;b&&"none"==b.style.display;)b=b.previousSibling;b?this._setSelectedAttr(b,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(f,l){if(this.selected!=f){var h=this.selected;if(h)this.onDeselect(h);
f&&(l&&b.scrollIntoView(f),this.onSelect(f));this._set("selected",f)}else if(f)this.onSelect(f)}})})},"jimu/dijit/EditorTextColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),function(p,f,b,m,l,h){f.experimental("dijit.editor.plugins.EditorTextColor");var r=m("dijit.editor.plugins.EditorTextColor",l,{buttonClass:h,colorPicker:"jimu/dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command="editorTextColor";
this.hackCommand="foreColor";this.inherited(arguments);var b="",f=!1;this.params.custom&&(this.params.custom.recordUID&&(b=this.params.custom.recordUID),this.params.custom.forceAttr&&(f=this.params.custom.forceAttr));var e=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+"ForeColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(c){function a(a){e.button.dropDown=new a({dir:e.editor.dir,ownerDocument:e.editor.ownerDocument,
value:e.value,appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showCoustomRecord:!0},recordUID:b,onChange:function(a){e.editor.execCommand("useCSS",f);e.editor.execCommand("styleWithCSS",!f);e.editor.execCommand(e.hackCommand,a)}});c()}"string"===typeof e.colorPicker?p([e.colorPicker],a):a(e.colorPicker)}},updateState:function(){var b=this.editor,f=this.hackCommand;if(b&&b.isLoaded&&f.length){var e;if(this.button){var c=this.get("disabled");this.button.set("disabled",c);if(c)return;
try{e=b.queryCommandValue(f)||""}catch(a){e=""}}""===e?e="#000000":"transparent"===e&&(e="rgba(0, 0, 0, 0)");this.value=e;(b=this.button.dropDown)&&b.getColor&&e!==b.getColor()&&(b.refreshRecords(),b.setColor(e))}}});f.subscribe(b._scopeName+".Editor.getPlugin",null,function(b){if(!b.plugin)switch(b.args.name){case "editorTextColor":b.plugin=new r}});return r})},"jimu/dijit/EditorBackgroundColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),
function(p,f,b,m,l,h){f.experimental("dijit.editor.plugins.EditorBackgroundColor");var r=m("dijit.editor.plugins.EditorBackgroundColor",l,{buttonClass:h,colorPicker:"jimu/dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command="editorBackgroundColor";this.hackCommand="hiliteColor";this.inherited(arguments);var b="";this.params.custom&&this.params.custom.recordUID&&(b=this.params.custom.recordUID);var f=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+
"HiliteColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(e){function c(a){f.button.dropDown=new a({dir:f.editor.dir,ownerDocument:f.editor.ownerDocument,value:f.value,appearance:{showTransparent:!0,showColorPalette:!0,showCoustom:!0,showCoustomRecord:!0},recordUID:b,onChange:function(a){f.editor.execCommand("useCSS",!1);f.editor.execCommand("styleWithCSS",!0);f.editor.execCommand(f.hackCommand,a)},onExecute:function(){f.editor.execCommand(f.hackCommand,
this.get("value"))}});e()}"string"===typeof f.colorPicker?p([f.colorPicker],c):c(f.colorPicker)}},updateState:function(){var b=this.editor,f=this.hackCommand;if(b&&b.isLoaded&&f.length){var e;if(this.button){var c=this.get("disabled");this.button.set("disabled",c);if(c)return;try{e=b.queryCommandValue(f)||""}catch(a){e=""}}""===e?e="#000000":"transparent"===e&&(e="rgba(0, 0, 0, 0)");this.value=e;(b=this.button.dropDown)&&b.getColor&&e!==b.getColor()&&(b.refreshRecords(),b.setColor(e))}}});f.subscribe(b._scopeName+
".Editor.getPlugin",null,function(b){if(!b.plugin)switch(b.args.name){case "editorBackgroundColor":b.plugin=new r}});return r})},"builder/plugins/creation-entry/_build-generate_module":function(){define(["builder/plugins/creation-entry/Plugin","dojo/text!builder/plugins/creation-entry/Plugin.html","dojo/text!builder/plugins/creation-entry/css/style.css","dojo/i18n!builder/plugins/creation-entry/nls/strings"],function(){})},"builder/plugins/creation-entry/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/Deferred dojo/keys builder/BasePlugin dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/_base/lang dojo/query dojo/promise/all jimu/dijit/Message jimu/dijit/Popup builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter builder/serviceUtils ./SaveAsPage ./CreateNewAppPage builder/dijit/FullScreenPopup".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t){return p([l,h],{templateString:r,baseClass:"plugin-creation-app",fromAppId:null,postMixInProperties:function(){this.inherited(arguments);this.nls=n.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments)},popupNewCreateDlg:function(a,b){this._getInitAppInfo().then(n.hitch(this,function(c){this.createAppPage=new w({appInfo:c,pluginManager:this.pluginManager,createFromAppInfo:b,nls:this.nls,isPortalSupport3D:window.isPortalSupport3D});
c=g("#main-page")[0];this.createAppPopup=new t({zIndex:101,subDijit:this.createAppPage,titleStr:a||this.nls.appCreateNewAppTitle,content:this.createAppPage.domNode,blurContainer:c.firstElementChild,buttons:[{label:this.nls.next,key:m.ENTER,isHighLight:!0,onClick:n.hitch(this.createAppPage,this.createAppPage._onNextClick)},{label:this.nls.back,key:m.ENTER,isHighLight:!0,onClick:n.hitch(this.createAppPage,this.createAppPage._onBackClick)},{label:this.nls.ok,key:m.ENTER,isHighLight:!0,onClick:n.hitch(this,
this._onCreateNewClick)},{label:this.nls.cancel,key:m.ESCAPE,isHighLight:!1,onClick:n.hitch(this,this._onCreateNewCancelClick)}],btnsAtuoBottom:!0});this.createAppPopup.placeAt(c);this.createAppPopup.show();this.createAppPage.setPopup(this.createAppPopup);this.createAppPage.startup()}))},createNewApp:function(d){var e=new b;k.createApp(d).then(n.hitch(this,function(b){if(b.success){var c=n.clone(d);c.id=b.newAppId;this.pluginManager.getPluginByName("startup").switchToAppConfig(c);e.resolve();d.sharing&&
(d.webmap?this._shareAppWithWebmapOrWebscene(b.newAppId,d.folderId,d.webmap):d.webscene&&this._shareAppWithWebmapOrWebscene(b.newAppId,d.folderId,d.webscene))}else{var g=new a({content:b.message,container:"main-page",titleLabel:builderNls.createError||"",width:400,autoHeight:!0,buttons:[{label:this.nls.ok,key:m.ENTER,onClick:n.hitch(this,function(){b.href&&(f.setStyle(g.domNode,"display","none"),window.location.href=b.href);g.close()})}]});e.reject()}}),n.hitch(this,function(a){new c({message:a.message});
e.reject(a)}));return e},popupSaveAsDlg:function(b,c,e){this._getInitAppInfo(c).then(n.hitch(this,function(f){this.saveAsPage=new d({fromAppId:c,appInfo:f,nls:this.nls});this.saveAsPage.startup();this.saveAsPopup=new a({content:this.saveAsPage,container:"main-page",titleLabel:b||"",width:669,autoHeight:!0,buttons:[{label:this.nls.ok,key:m.ENTER,onClick:n.hitch(this,this._onSaveAsPopupNextClick,e)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:m.ESCAPE,onClick:n.hitch(this,this._onSaveAsPopupCancelClick)}]})}))},
_onSaveAsPopupCancelClick:function(){this._close()},_onSaveAsPopupNextClick:function(a){var b=this.saveAsPage._getAppInfoFromDlg(),d=this.pluginManager.getPluginByName("app-list");if(b.name){var e=new q;e.placeAt(this.saveAsPopup.domNode);e.startup();this._saveAs(b,a).then(n.hitch(this,function(){d&&window.isXT&&(b.isTemplate?d.refreshTemplatePage():d.refreshAppPage());e.destroy()}),function(){e.destroy()})}else new c({message:this.nls.noAppName})},_close:function(){this.saveAsPopup?(this.saveAsPopup.close(),
this.saveAsPopup=null):this.saveAsPage&&this.saveAsPage.destroy();this.createAppPopup&&(this.createAppPopup.close(),this.createAppPopup=null,this.createAppPage.destroy())},_saveAs:function(a,d){var e=new b;k.saveAs(a,d).then(n.hitch(this,function(b){if(b.success){var d=n.clone(a);d.id=b.newAppId;d.name=a.name;this._close();this.pluginManager.getPluginByName("startup").switchToAppConfig(d);e.resolve()}else new c({message:b.message}),e.reject()}),n.hitch(this,function(a){new c({message:a.message});
e.reject()}));return e},_onCreateNewClick:function(){var a=this.createAppPage._getAppInfoFromDlg(),b=this.pluginManager.getPluginByName("app-list");if(a.name){var d=new q;d.placeAt(this.createAppPopup.domNode);d.startup();this.createNewApp(a).then(n.hitch(this,function(){b&&window.isXT&&b.refreshAppPage();d.destroy();setTimeout(n.hitch(this,function(){this._close()}),300)}),function(){d.destroy()})}else new c({message:this.nls.noAppName})},_onCreateNewCancelClick:function(){this._close()},_getInitAppInfo:function(a){var c=
new b,d=this._getEmptyAppInfo();window.isXT?a?k.getAppInfo(a).then(n.hitch(this,function(a){d.name=a.name+this.nls._copy;d.description=a.description;d.appType=a.appType;d.isTemplate=a.isTemplate;d.thumbnail=a.thumbnail;c.resolve(d)}),n.hitch(this,function(a){console.error(this.nls.saveAsFaied,a);c.reject()})):c.resolve(d):a?u.getPortal(v.getPortalUrlFromLocation()).getItemById(a).then(n.hitch(this,function(a){d.name=a.title+this.nls._copy;d.tags=a.tags;d.description=a.snippet;c.resolve(d)}),n.hitch(this,
function(a){console.error(this.nls.saveAsFaied,a);c.reject()})):c.resolve(d);return c},_getEmptyAppInfo:function(){return{name:"",description:"",tags:["AppBuilder App"],folderId:"",sharing:!1,appType:window.appInfo.appType,webmap:null,fromAppId:null,creator:null,isPredefined:!0,isTemplate:!1,thumbnail:"/webappbuilder/builder/images/appthumbnail_2d.jpg",icon:"/webappbuilder/builder/images/logo.png"}},_shareAppWithWebmapOrWebscene:function(a,d,f){var g=u.getPortal(v.getPortalUrlFromLocation()),k=new b,
h=new b,l=new b,m=new b;g.getUser().then(n.hitch(this,function(a){k.resolve(a)}),n.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);k.reject()}));g.getItemById(f).then(n.hitch(this,function(a){h.resolve(a)}),n.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);h.reject(a)}));e({user:k,userItem:l}).then(n.hitch(this,function(b){var e={};switch(b.userItem.sharing.access){case "public":e.everyone=!0;e.groups=b.userItem.sharing.groups.toString();
break;case "account":case "org":e.org=!0;e.groups=b.userItem.sharing.groups.toString();break;case "shared":e.groups=b.userItem.sharing.groups.toString()}b.user.shareItem(e,a,d).then(n.hitch(this,function(a){m.resolve(a)}),n.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);m.reject()}))}));e({user:k,webmapItem:h}).then(n.hitch(this,function(b){if(b.webmapItem.owner===b.user.username)b.user.getItemById(f,b.webmapItem.ownerFolder).then(n.hitch(this,function(a){l.resolve(a)}),
n.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);l.reject(a)}));else{var e={};switch(b.webmapItem.access){case "public":e.everyone=!0;break;case "account":case "org":e.org=!0}b.user.shareItem(e,a,d).then(n.hitch(this,function(a){m.resolve(a)}),n.hitch(this,function(a){new c({message:this.nls.createAppUrlError});console.error(a.message);m.reject()}))}}))}})})},"builder/plugins/creation-entry/SaveAsPage":function(){define(["dojo/_base/declare","builder/BasePlugin",
"dijit/_WidgetsInTemplateMixin","dojo/text!./SaveAsPage.html","builder/dijit/ItemInfo"],function(p,f,b,m,l){return p([f,b],{templateString:m,baseClass:"saveas-app-page",fromAppId:null,appInfo:null,appType:null,_stemappExtensions:null,webmap:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){window.isXT?(this.appInfo.tags=void 0,this.appInfo.folderId=void 0,this.appInfo.sharing=void 0):this.fromAppId&&(this.appInfo.sharing=
void 0,this.appInfo.thumbnail=void 0);this.itemInfoDijit=new l({itemInfo:this.appInfo});this.itemInfoDijit.placeAt(this.itemInfoBox)},_getAppInfoFromDlg:function(){var b=this.itemInfoDijit.getProperties();b.appType=this.appInfo.appType;b.webmap=this.webmap;b.fromAppId=this.fromAppId;b.isPredefined="default"!==this.fromAppId&&this.fromAppId?!1:!0;b.isTemplate=this.appInfo.isTemplate?!0:!1;b.saveAsTemplate=!1;return b}})})},"builder/plugins/creation-entry/CreateNewAppPage":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html builder/BasePlugin dojo/dom-style dijit/_WidgetsInTemplateMixin dojo/text!./CreateNewAppPage.html dojo/query dojo/on dojo/dom-class dojo/_base/lang dojo/Evented builder/dijit/EditItemInfo builder/serviceUtils jimu/portalUrlUtils builder/portalUtils jimu/utils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d){return p([m,h,a],{templateString:r,baseClass:"create-app-page",appInfo:null,pluginManager:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){"undefined"===typeof this.isPortalSupport3D&&(this.isPortalSupport3D=!1);this.isPortalSupport3D=!!this.isPortalSupport3D;this.initAppInfoPage();this.createFromAppInfo?(this.selectedApp=this.createFromAppInfo,this._displaySecondPage(),this._hideButton(1)):
(this.initAppSelectPage(),this._displayFirstPage())},destroy:function(){this.itemInfoDijit&&(this.itemInfoDijit.destroy(),this.itemInfoDijit=null);this.popup&&(this.popup=null);b.destroy(this.domNode);this.inherited(arguments)},initAppSelectPage:function(){this._stemappExtensions=this.pluginManager.getExtensions("startup.stemapps");this._stemappExtensions.sort(function(a,b){return a.parameters.index-b.parameters.index});v.getTemplateList(!0).then(c.hitch(this,function(a){var b=this._filterInfosByIsPortalSupport3D(a);
f.forEach(b,function(a){!a.id||"HTML_default"!==a.id&&"HTML3D_default"!==a.id?this._createAppNodeAndBindEvent(a,this.othersApps):("HTML_default"===a.id?a.name=this.nls.Default2D:"HTML3D_default"===a.id&&(a.name=this.nls.Default3D),this._createAppNodeAndBindEvent(a,this.defaultApps))},this);this._selecteApp(n(".app-image-border-div",this.allAppContent)[0]);b=q.getStandardPortalUrl(window.portalUrl);k.getPortal(b).getUser().then(c.hitch(this,function(b){var c=f.filter(a,function(a){return a.isTemplate&&
a.creator===b.username}),c=this._filterInfosByIsPortalSupport3D(c);f.forEach(c,function(a){this._createAppNodeAndBindEvent(a,this.ownAppContent)},this)}))}))},_filterInfosByIsPortalSupport3D:function(a){var b=this.isPortalSupport3D;return f.filter(a,function(a){return!1===b?"HTML3D"!==a.appType:!0})},initAppInfoPage:function(){this.itemInfoDijit=new u({itemInfo:this.appInfo,nls:this.nls});this.itemInfoDijit.placeAt(this.appInfoTable)},_createAppNode:function(a,c,e){this.zIndex=10;c=b.create("div",
{"class":"app-node jimu-float-leading",style:e},c);e=b.create("div",{"class":"app-image-border-div"},c);b.create("div",{"class":"app-image-div",style:{backgroundImage:"url("+a.thumbnail+")"}},e);var f;"HTML"===a.appType?f="2D":"HTML3D"===a.appType&&(f="3D");f=b.create("div",{"class":"flag-image flag-image-"+f},e);l.set(f,"z-index",this.zIndex++);b.create("div",{"class":"app-name",innerHTML:d.stripHTML(a.name),title:d.stripHTML(a.name)},c);return e},_createAppNodeAndBindEvent:function(a,b){var d=this._createAppNode(a,
b);this.own(g(d,"click",c.hitch(this,this._onAppNodeClick,d)));d.appInfo=a;return d},_onAppNodeClick:function(a){var b=n(".app-image-border-div",this.appSelectPage);f.forEach(b,function(a){this._unselecteApp(a)},this);this._selecteApp(a)},_selecteApp:function(a){this.selectedApp=a.appInfo;e.add(a,"jimu-state-active")},_unselecteApp:function(a){e.remove(a,"jimu-state-active")},_onAllAppBtnClick:function(){var a=n(".app-image-border-div",this.allAppContent)[0];a&&this._onAppNodeClick(a);b.setStyle(this.allAppContent,
"display","block");b.setStyle(this.ownAppContent,"display","none");b.addClass(this.allAppBtn,"selected");b.removeClass(this.ownAppBtn,"selected")},_onOwnAppBtnClick:function(){var a=n(".app-image-border-div",this.ownAppContent)[0];a&&this._onAppNodeClick(a);b.setStyle(this.allAppContent,"display","none");b.setStyle(this.ownAppContent,"display","block");b.addClass(this.ownAppBtn,"selected");b.removeClass(this.allAppBtn,"selected")},_onNextClick:function(){this._displaySecondPage();"HTML"===this.selectedApp.appType?
this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_2d.jpg"):this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_3d.jpg")},_onBackClick:function(){this._displayFirstPage()},_displayFirstPage:function(){b.setStyle(this.appInfoPage,"display","none");b.setStyle(this.appSelectPage,"display","block");this._displayButtion(0);this._hideButton(1);this._hideButton(2);this.popup&&this.popup.resize()},_displaySecondPage:function(){b.setStyle(this.appSelectPage,
"display","none");b.setStyle(this.appInfoPage,"display","block");this._hideButton(0);this._displayButtion(1);this._displayButtion(2);this.popup&&this.popup.resize();this.itemInfoDijit&&this.itemInfoDijit.focusItemByName("appName")},setPopup:function(a){this.popup=a},_hideButton:function(a){b.setStyle(this.popup.enableButton(a),"display","none")},_displayButtion:function(a){b.setStyle(this.popup.enableButton(a),"display","inline-block")},_getAppInfoFromDlg:function(){var a=this.itemInfoDijit.getProperties();
a.appType=this.selectedApp.appType;a.webmap=this.webmap;a.fromAppId=this.selectedApp.id;a.isPredefined=!1;a.isTemplateApp=this.selectedApp.isTemplate;0===a.icon.indexOf("/webappbuilder/builder/images/")&&(a.icon=null);0===a.thumbnail.indexOf("/webappbuilder/builder/images/")&&(a.thumbnail=null);return a}})})},"builder/plugins/header/_build-generate_module":function(){define(["builder/plugins/header/Plugin","dojo/text!builder/plugins/header/Plugin.html","dojo/text!builder/plugins/header/css/style.css",
"dojo/i18n!builder/plugins/header/nls/strings"],function(){})},"builder/plugins/header/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/topic dojo/Deferred dojo/request dojo/request/script builder/portalUtils jimu/portalUrlUtils builder/tokenUtils jimu/utils builder/BasePlugin dojo/_base/config".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v){return p([u],{baseClass:"plugin-header",_trainingUrls:{administrator:"//www.esri.com/training/main/arcgis-online-administrators",
publisher:"//www.esri.com/training/main/arcgis-online-publishers",user:"//www.esri.com/training/main/arcgis-online-users","public":"//www.esri.com/training/main/arcgis-online-training",custom:"//www.esri.com/training/main/arcgis-online-training"},_esriCommunityLink:"https://community.esri.com",_myEsriLink:"https://my.esri.com",postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this._isWebTier(window.portalUrl).then(f.hitch(this,function(a){a&&b.setStyle(this.signOutItem,
"display","none")}));window.isXT?(b.addClass(this.domNode,"xt"),b.destroy(this.homeSection),this._bindXtEvents()):(b.addClass(this.homeLabel,"js-home-dropdown"),b.destroy(this.switchSection),this._bindIntegratedEvents(window.portalUrl));var a=g.getPortal(window.portalUrl);a.haveSignIn()&&a.getUser().then(f.hitch(this,function(a){if(a){var c=a.firstName||a.username;c&&(this.userNameNode.innerHTML=c);if(a.thumbnail&&(c=e.getUserThumbnailUrl(window.portalUrl,a.username,a.thumbnail))){var f=a.credential&&
a.credential.token;f&&(c+="?token\x3d"+f);this.userIcon.src=c;this.profileImg.src=c}this.profileNameNode.innerHTML=a.username;e.isOnline(window.portalUrl)?(c="",c=a.isAdminRole()?this._trainingUrls.administrator:a.isPublisherRole()?this._trainingUrls.publisher:a.isUserRole()?this._trainingUrls.user:this._trainingUrls.custom,this.trainingNode.href=c,b.removeClass(this.trainingNode,"hidden"),"both"===a.userType&&(this.communityNode.href=this._esriCommunityLink,this.myesriNode.href=this._myEsriLink,
b.removeClass(this.communityNode,"hidden"),b.removeClass(this.myesriNode,"hidden"))):a.isAdminRole()&&(this.adminHelpNode.href=e.getPortalAdminHelpUrl(window.portalUrl,v.locale),b.removeClass(this.adminHelpNode,"hidden"))}}),f.hitch(this,function(a){console.error(a)}))},_isWebTier:function(a){var b=new h,d=esri.id.findServerInfo(a);d&&d.webTierAuth?b.resolve(!0):b=c.isWebTierPortal(a);return b},_isUserMenuShow:function(){return b.hasClass(this.userSection,"is-active")},_showUserMenu:function(){b.addClass(this.userSection,
"is-active")},_hideUserMenu:function(){b.removeClass(this.userSection,"is-active")},_bindXtEvents:function(){this.own(m(document.body,"click",f.hitch(this,function(a){a=a.target||a.srcElement;a===this.userSection||b.isDescendant(a,this.userSection)||this._hideUserMenu()})));this.own(l.subscribe("iframeClick",f.hitch(this,function(){this._hideUserMenu()})));this.own(l.subscribe("userSignOut",f.hitch(this,function(){this.userNameNode.innerHTML=""})));this.own(l.subscribe("userSignIn",f.hitch(this,function(a){this.userNameNode.innerHTML=
a.userId||""})));this.logoTitle.title=this.nls.backToHomePage||"";this.own(m(this.logoTitle,"click",f.hitch(this,function(a){a.preventDefault();b.hasClass(this.domNode,"app-opened")&&this.pluginManager.getPluginByName("startup").switchToAppList()})));this.own(m(this.profileItem,"click",f.hitch(this,function(){var a=f.hitch(this,function(){window.location.href=e.getHomeUserUrl(window.portalUrl)});this._isInConfig()?l.publish("closeAppConfigPage",a):a()})));this.helpNode.href="help";this.signOutItem&&
this.own(m(this.signOutItem,"click",f.hitch(this,function(){var b=f.hitch(this,function(){this.userNameNode.innerHTML="";c.signOutAll();var b=e.getOAuth2SignOutUrl(window.portalUrl),b=e.setHttpsProtocol(b),d=function(){var b=a.getLocationUrlWithoutHashAndQueryParams(),b=a.url.addQueryParamToUrl(b,"action","setportalurl");window.location.href=b};this._getSigninInfo(window.portalUrl).then(function(a){if(a.success&&a.info&&a.info.portalUrl&&a.info.supportsOAuth)try{n.get(b).always(function(){d()})}catch(t){console.error(t),
d()}else d()},function(){d()})});this._isInConfig()?l.publish("closeAppConfigPage",b):b()})));this.own(m(window,"resize",f.hitch(this,function(){this._calculateWidth()})));this.own(m(this.appSwitch,"click",f.hitch(this,this._onAppsClicked)));this.own(m(this.templateSwitch,"click",f.hitch(this,this._onTemplatesClicked)));this._calculateWidth()},_calculateWidth:function(){1816>=window.innerWidth?b.addClass(this.domNode,"width-less1816"):b.removeClass(this.domNode,"width-less1816")},_getSigninInfo:function(a){return r("/webappbuilder/rest/signininfo/getsignininfo",
{handleAs:"json",query:"portalUrl\x3d"+a,method:"GET"})},_bindIntegratedEvents:function(a){e.isOnline(window.portalUrl)&&(b.removeClass(this.switchAccountsNode,"hidden"),this.switchAccountsNode.href=e.getSwitchAccoutnsUrl(window.portalUrl,"arcgisonline",""));this.own(m(document.body,"click",f.hitch(this,function(a){a=a.target||a.srcElement;a!==this.homeLabel&&b.removeClass(this.homeSection,"is-active");a===this.userSection||b.isDescendant(a,this.userSection)||this._hideUserMenu()})));this.own(l.subscribe("iframeClick",
f.hitch(this,function(){b.removeClass(this.homeSection,"is-active");this._hideUserMenu()})));this.own(m(this.homeLabel,"click",f.hitch(this,function(a){a.preventDefault();b.hasClass(this.homeSection,"is-active")?b.removeClass(this.homeSection,"is-active"):b.addClass(this.homeSection,"is-active")})));this.own(m(this.homeItem,"click",f.hitch(this,function(){l.publish("closeAppConfigPage",function(){window.location.href=e.getHomeIndexUrl(a)})})));this.own(m(this.galleryItem,"click",f.hitch(this,function(){l.publish("closeAppConfigPage",
function(){window.location.href=e.getHomeGalleryUrl(a)})})));this.own(m(this.mapItem,"click",f.hitch(this,function(){window.appConfig&&window.appConfig.map&&l.publish("closeAppConfigPage",function(){window.location.href=e.getHomeMapViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl,window.appConfig.map.itemId)})})));this.own(m(this.sceneItem,"click",f.hitch(this,function(){window.appConfig&&window.appConfig.map&&l.publish("closeAppConfigPage",function(){window.location.href=e.getHomeSceneViewerUrl(window.appConfig.map.portalUrl||
window.appConfig.portalUrl)})})));this.own(m(this.groupsItem,"click",f.hitch(this,function(){l.publish("closeAppConfigPage",function(){window.location.href=e.getHomeGroupsUrl(a)})})));this.own(m(this.contentItem,"click",f.hitch(this,function(){l.publish("closeAppConfigPage",function(){window.location.href=e.getHomeMyContentUrl(a)})})));this.own(m(this.organizationItem,"click",f.hitch(this,function(){l.publish("closeAppConfigPage",function(){window.location.href=e.getHomeMyOrganizationUrl(a)})})));
this.own(m(this.profileItem,"click",f.hitch(this,function(){l.publish("closeAppConfigPage",function(){window.location.href=e.getHomeUserUrl(a)})})));0<=a.toLowerCase().indexOf(".arcgis.com")?this.helpNode.href="http://doc.arcgis.com/en/web-appbuilder/":this.helpNode.href=e.getPortalHelpUrl(a,v.locale);this.signOutItem&&this.own(m(this.signOutItem,"click",f.hitch(this,function(){l.publish("closeAppConfigPage",function(){c.signOutAll();window.location.href=e.getPortalSignInUrlFromLocation()})})))},
setAppName:function(a){a=a||"";(this.appName.innerHTML=a)?(window.isXT?this.logoTitle.title=this.nls.backToHomePage||"":b.setStyle(this.logoTitle,"color","#4c4c4c"),b.addClass(this.domNode,"app-opened"),b.removeClass(this.domNode,"app-not-opened"),window.isXT||(b.setAttr(this.appName,"href",window.portalUrl+"/home/item.html?id\x3d"+window.appInfo.id),b.setAttr(this.appName,"title",this.nls.showItemDetails),b.addClass(this.appName,"highlight"))):(this.logoTitle.title="",b.removeClass(this.domNode,
"app-opened"),b.addClass(this.domNode,"app-not-opened"))},getAppName:function(){return this.appName.innerHTML||""},_isInConfig:function(){return"appconfig"===this.pluginManager.getPluginByName("startup").getCurrentView().label},_onUserSectionClicked:function(a){a=a.target||a.srcElement;var c=!0;if(b.isDescendant(a,this.userInfoDom)||a===this.userInfoDom)this._isUserMenuShow()||(c=!1);c?this._hideUserMenu():this._showUserMenu()},_onAppsClicked:function(){b.removeClass(this.templateSwitch,"selected");
b.addClass(this.appSwitch,"selected");l.publish("switchToAppListApps")},_onTemplatesClicked:function(){b.removeClass(this.appSwitch,"selected");b.addClass(this.templateSwitch,"selected");l.publish("switchToAppListTemplates")}})})},"builder/plugins/map-config/_build-generate_module":function(){define(["builder/plugins/map-config/Plugin","dojo/text!builder/plugins/map-config/Plugin.html","dojo/text!builder/plugins/map-config/css/style.css","dojo/i18n!builder/plugins/map-config/nls/strings"],function(){})},
"builder/plugins/map-config/Plugin":function(){define("dojo/_base/declare dojo/topic dojo/on dojo/Deferred dojo/text!./Plugin.html dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/event dojo/keys dojo/json dojo/promise/all dojo/dom-construct builder/BasePlugin builder/portalUtils jimu/portalUrlUtils jimu/dijit/Message jimu/Role jimu/utils jimu/dijit/Popup ./MapSelector ./CustomizeScale require".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C){return p([q],
{templateString:l,baseClass:"map-config",appConfig:null,map:null,sceneView:null,item:null,widgetsConfigCache:null,postMixInProperties:function(){var a=h.clone(window.builderNls);this.nls=h.mixin(a,this.nls);this.nls.scaleDisabledTip2=this.nls.scaleDisabledTip.replace("${scaleTitle}",'"'+this.nls.scaleTitle+'"');this._is3D()?(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebScene,this.nls.chooseWebMapOrWebScene=this.nls.chooseWebScene):(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebMap,
this.nls.chooseWebMapOrWebScene=this.nls.selectWebMap)},postCreate:function(){this.inherited(arguments);this._init()},destroy:function(){this.appConfigPlugin=null;this.inherited(arguments)},_is3D:function(){return"HTML3D"===window.appInfo.appType},_init:function(){this.widgetsConfigCache={};this.own(f.subscribe("app/appConfigChanged",h.hitch(this,this.setAppConfig)));this.own(f.subscribe("app/appConfigLoaded",h.hitch(this,this.setAppConfig)));this.own(f.subscribe("app/mapLoaded",h.hitch(this,function(a){this._setMap(a)})));
this.own(f.subscribe("app/mapChanged",h.hitch(this,function(a){this._setMap(a)})));this.own(f.subscribe("app/sceneViewLoaded",h.hitch(this,function(a){this.sceneView=a})));this.own(f.subscribe("app/sceneViewChanged",h.hitch(this,function(a){this.sceneView=a})));this.appConfigPlugin=this.pluginManager.getPluginByName("app-config");this.embeddedMapViewerHelper={portalUrl:void 0,container:void 0,popup:void 0,webmapId:void 0,frameName:"embeddedMapViewer",hideItems:"hide\x3dshare,lnk,analysis,directions",
params:"embedded\x3d1\x26locale\x3d"+dojoConfig.locale,loadingShelter:void 0,loaded:void 0,hasUnsavedChanged:void 0,readyToClose:void 0,loadInterval:void 0,unsavedInterval:void 0,webmapIdInterval:void 0,isClosing:!1};this.own(b(window,"message",h.hitch(this,this.receiveViewerMessage)));this._is3D()?n.addClass(this.mapOptions3D,"enabled"):n.addClass(this.mapOptions2D,"enabled")},_setInitialExtent:function(){try{f.publish("mapOptionsChanged",{extent:this.map.extent.toJson()})}catch(B){console.error(B)}},
_blinkMapContainer:function(){var a=null;if(a=this._is3D()?this.sceneView.container:this.map.container){var b=n.create("div");n.addClass(b,"blink-map-border");n.place(b,a);var c=0,d=setInterval(h.hitch(this,function(){n.toggleClass(b,"blink-map-border-show");c++;6===c&&(b.parentNode.removeChild(b),clearInterval(d))}),200)}},_useCurrentMapExtent:function(){this.map&&(this._setInitialExtent(),this._blinkMapContainer())},_useDefaultMapExtent:function(a){x.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,
this.appConfig&&this.appConfig.geometryService).then(h.hitch(this,function(){this._setInitialExtent();a&&this._blinkMapContainer()}),h.hitch(this,function(a){"string"===typeof a&&new w({message:a});console.error(a)}))},showMapSelector:function(){this.hideMapOptions();var a=new y({nls:this.nls,type:"HTML3D"===window.appInfo.appType?"Web Scene":"Web Map"}),b=new A({width:1024,titleLabel:this.nls.chooseWebMapOrWebScene,content:a,container:"main-page",onClose:h.hitch(this,function(){try{a&&a.domNode&&
a.destroy()}catch(G){console.error(G)}a=null;return!0}),buttons:[{label:this.nls.ok,key:c.ENTER,classNames:["map-selector-btn-ok"],onClick:h.hitch(this,function(){var c=a.getSelectedMapItem();this._selectItem(c,b)})},{label:this.nls.cancel,key:c.ESCAPE,classNames:["map-selector-btn-cancel","jimu-btn-vacation"],onClick:h.hitch(this,function(){b.close()})}]})},embedWebMap:function(a,b,c){this.embeddedMapViewerHelper.portalUrl=d.getStandardPortalUrl(a);a=this.embeddedMapViewerHelper.portalUrl+"/home/webmap/viewer.html?"+
(c?"webmap\x3d"+c+"\x26":"")+this.embeddedMapViewerHelper.params+"\x26"+this.embeddedMapViewerHelper.hideItems;c=k.getPortal(this.embeddedMapViewerHelper.portalUrl);a+="#"+c.credential.token;this.embeddedMapViewerHelper.container=v.create("div",{"class":"embed-mapviewer-content"});v.create("iframe",{src:a,name:this.embeddedMapViewerHelper.frameName,style:"width:100%;height:99%"},this.embeddedMapViewerHelper.container);this.embeddedMapViewerHelper.loadingShelter=v.create("div",{"class":"load-container"},
this.embeddedMapViewerHelper.container);a=v.create("div",{"class":"loader"},this.embeddedMapViewerHelper.loadingShelter);n.setStyle(a,"background","url("+C.toUrl("jimu/css/images/loadingmap.gif")+")");n.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","");b=new A({titleLabel:b,content:this.embeddedMapViewerHelper.container,container:"main-page",onClose:h.hitch(this,function(){if(!0===this.embeddedMapViewerHelper.readyToClose)return!0;this._closeEmbeddedMapViewer();return!1})});n.setStyle(b.domNode,
{top:"5%",left:"5%",width:"90%",height:"90%"});b.startup();this.embeddedMapViewerHelper.popup=b;this.embeddedMapViewerHelper.loaded=!1;this.embeddedMapViewerHelper.readyToClose=!1;this.embeddedMapViewerHelper.isClosing=!1;this.embeddedMapViewerHelper.loadInterval=setInterval(h.hitch(this,function(){this.embeddedMapViewerHelper.loaded?(n.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none"),clearInterval(this.embeddedMapViewerHelper.loadInterval),this.embeddedMapViewerHelper.loadInterval=
null):this.sendPostMessage({type:"isLoaded"})}),500)},showMapOptions:function(a){e.stop(a);n.setStyle(this.webMapEditOptions,"display","");n.setStyle(this.webMapOptionsMask,"display","")},hideMapOptions:function(){n.setStyle(this.webMapEditOptions,"display","none");n.setStyle(this.webMapOptionsMask,"display","none")},editWebMap:function(){this.hideMapOptions();this.embedWebMap(this.appConfig.map.portalUrl,this.nls.editMap,this.appConfig.map.itemId)},createWebMap:function(){this.hideMapOptions();this.embedWebMap(this.appConfig.portalUrl,
this.nls.createMap)},_closeEmbeddedMapViewer:function(){this.embeddedMapViewerHelper.isClosing||(this.embeddedMapViewerHelper.isClosing=!0,n.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display",""),this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.hasUnsavedChanged=void 0,this.embeddedMapViewerHelper.unsavedInterval=setInterval(h.hitch(this,function(){if("undefined"===typeof this.embeddedMapViewerHelper.hasUnsavedChanged)this.sendPostMessage({type:"hasUnsavedChanges"});else if(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),
this.embeddedMapViewerHelper.unsavedInterval=null,this.embeddedMapViewerHelper.hasUnsavedChanged)var a=new A({content:this.nls.hasUnsavedChanges,titleLabel:this.nls.customMap,autoHeight:!0,width:600,buttons:[{label:this.nls.ok,onClick:h.hitch(this,function(){a.close();this._doCloseEmbeddedMapViewer()})},{label:this.nls.cancel,onClick:h.hitch(this,function(){n.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");this.embeddedMapViewerHelper.isClosing=!1;a.close()})}]});else this._doCloseEmbeddedMapViewer()}),
500)):this._doCloseEmbeddedMapViewer())},_doCloseEmbeddedMapViewer:function(){n.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");this.embeddedMapViewerHelper.loadInterval&&(clearInterval(this.embeddedMapViewerHelper.loadInterval),this.embeddedMapViewerHelper.loadInterval=null);this.embeddedMapViewerHelper.unsavedInterval&&(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),this.embeddedMapViewerHelper.unsavedInterval=null);this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.webmapId=
void 0,this.sendPostMessage({type:"getWebmapId"}),this.embeddedMapViewerHelper.webmapIdInterval=setInterval(h.hitch(this,function(){"undefined"!==typeof this.embeddedMapViewerHelper.webmapId&&(clearInterval(this.embeddedMapViewerHelper.webmapIdInterval),this.embeddedMapViewerHelper.webmapIdInterval=null,v.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=null,this.embeddedMapViewerHelper.readyToClose=!0,this.embeddedMapViewerHelper.popup.close(),this.embeddedMapViewerHelper.webmapId&&
k.getPortal(this.embeddedMapViewerHelper.portalUrl).getItemById(this.embeddedMapViewerHelper.webmapId).then(h.hitch(this,function(a){this._updateWebMap(a)})))}),500)):(v.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=null,this.embeddedMapViewerHelper.readyToClose=!0,this.embeddedMapViewerHelper.popup.close())},sendPostMessage:function(b){this.embeddedMapViewerHelper.portalUrl&&window.frames[this.embeddedMapViewerHelper.frameName]&&window.frames[this.embeddedMapViewerHelper.frameName].postMessage(a.stringify(b),
this.embeddedMapViewerHelper.portalUrl)},receiveViewerMessage:function(b){console.log("received",b.origin,b.data);if(!(0>this.embeddedMapViewerHelper.portalUrl.indexOf(b.origin)))switch(b=a.parse(b.data),b.type){case "webmapId":this.embeddedMapViewerHelper.webmapId=b.webmapId;break;case "loaded":this.embeddedMapViewerHelper.loaded=b.value;break;case "unsavedChanges":this.embeddedMapViewerHelper.hasUnsavedChanged=b.value;break;case "message":console.log(b.message)}},_selectItem:function(a,b){a&&(this._hasSameWebMap(this.appConfig,
{map:{portalUrl:a.portalUrl,itemId:a.id}})?b.close():this._updateWebMap(a,b))},_updateWebMap:function(a,b){var c=this.appConfig,c=this._getHttpWebMapItemUrl(c.map.portalUrl||c.portalUrl,c.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]={});var d=this.widgetsConfigCache[c],e=h.clone(this.appConfig);e.map.portalUrl=a.portalUrl;e.map.itemId=a.id;var k=this._tryResetWidgetsConfigWhenMapSwitched(e);if(0<k.length){var c=r.map(k,h.hitch(this,function(a){return a.label})),l=n.toDom("\x3cdiv style\x3d'font-size:14px;line-height:22px;'\x3e\x3cdiv\x3e"+
this.nls.mapSwitchConfimationTip+"\x3c/div\x3e\x3cdiv style\x3d'margin-top:25px;margin-bottom:20px;color:#596679;'\x3e"+this.nls.theseWidgetsAre+":\x3c/div\x3e\x3cul class\x3d'reset-widget-list' style\x3d'color:#596679;'\x3e\x3c/ul\x3e\x3cdiv style\x3d'margin-top:25px;'\x3e"+this.nls.sureToSwitch+"\x3c/div\x3e\x3c/div\x3e"),m=g(".reset-widget-list",l)[0];r.forEach(c,h.hitch(this,function(a,b){var c=n.create("li",{innerHTML:a},m);0!==b&&(c.style.marginTop="8px")}));var q=new A({content:l,titleLabel:this.nls.mapSwitchConfimation,
autoHeight:!0,width:640,buttons:[{label:this.nls.ok,onClick:h.hitch(this,function(){b&&b.close();q.close();this.appConfigPlugin.showLoadingCover();f.publish("new-webmap-item-selected",a);f.publish("setAppConfig",e);r.forEach(k,h.hitch(this,function(a){d[a.id]=a.config}))})},{label:this.nls.cancel,onClick:h.hitch(this,function(){q.close()})}]})}else b&&b.close(),this.appConfigPlugin.showLoadingCover(),this._publishMapChange(a)},_publishMapChange:function(a){f.publish("new-webmap-item-selected",a);
this._is3D()?f.publish("sceneViewChanged",{portalUrl:a.portalUrl,itemId:a.id}):f.publish("mapChanged",{portalUrl:a.portalUrl,itemId:a.id})},_hasSameWebMap:function(a,b){var c=a&&a.map,e=c&&c.itemId,f=b&&b.map,g=f&&f.itemId;return d.isSamePortalUrl(c&&c.portalUrl,f&&f.portalUrl)&&e===g},_setMap:function(a){this.map=a;this._checkCustomScaleAvailablity()},_updateChoseMapButtons:function(a){var b=this._checkUpdatePrivileges(a.map.portalUrl);a=this._checkUpdatePrivileges(a.portalUrl);u([b,a]).then(h.hitch(this,
function(a){var b=a[0];a=a[1];b||a?(n.setStyle(this.mapOptions,"display",""),n.setStyle(this.chooseMapButton,"width","140px"),n.setStyle(this.chooseMapButton,"max-width","140px"),b?n.setStyle(this.btnEditWebMap,"display",""):n.setStyle(this.btnEditWebMap,"display","none"),a?n.setStyle(this.btnCreateWebMap,"display",""):n.setStyle(this.btnCreateWebMap,"display","none")):(n.setStyle(this.mapOptions,"display","none"),n.setStyle(this.chooseMapButton,"width","100%"),n.setStyle(this.chooseMapButton,"max-width",
"100%"))}),h.hitch(this,function(){n.setStyle(this.mapOptions,"display","none");n.setStyle(this.chooseMapButton,"width","100%");n.setStyle(this.chooseMapButton,"max-width","100%")}))},_checkUpdatePrivileges:function(a){var b=new m;this._is3D()||!d.isSameServer(a,window.location.host)?b.resolve(!1):k.getPortal(a).getUser().then(h.hitch(this,function(a){var c=!1;if(a){var d=new t({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&(d.setPrivileges(a.privileges),c=d.canCreateItem())}b.resolve(c)}),
h.hitch(this,function(a){console.error(a);b.resolve(!1)}));return b},setAppConfig:function(a){if(this.appConfig){var b=this._hasSameWebMap(this.appConfig,a);this.appConfig=a;b||this._requestCurrentItem()}else this.appConfig=a,this._requestCurrentItem();this._updateChoseMapButtons(this.appConfig)},_getHttpWebMapItemUrl:function(a,b){var c=d.getItemUrl(a,b);return c=d.setHttpProtocol(c)},_tryResetWidgetsConfigWhenMapSwitched:function(a){var b=[],c=this._getHttpWebMapItemUrl(a.map.portalUrl||a.portalUrl,
a.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]={});var d=this.widgetsConfigCache[c];a.visitElement(h.hitch(this,function(a){if(!a.widgets&&a.uri&&!1===a.keepConfigAfterMapSwitched){var c=a.config,e=d&&d[a.id];e?a.config=e:delete a.config;if(!a.isDefaultConfig||e)a=h.clone(a),a.config=c,b.push(a)}}));return b},_requestCurrentItem:function(){var a=this.appConfig&&this.appConfig.map&&this.appConfig.map.itemId;if(a){var a={q:"id:"+a,num:1,f:"json"},b=k.getPortal(this.appConfig.map&&
this.appConfig.map.portalUrl);b&&b.queryItems(a).then(h.hitch(this,function(a){this.domNode&&(a=a.results,0<a.length&&this._showSelectedItem(a[0]))}),h.hitch(this,function(a){console.debug("query item from portal failed",a)}))}},_tryLocaleDate:function(a){var b=x.localizeDate(a,{selector:"date"});b||(b=a.toLocaleDateString());return b},_showSelectedItem:function(a){this.item=a;var b=a.type.toLowerCase();n.empty(this.thumbnailContainer);n.removeClass(this.webItemIcon,"webmap");n.removeClass(this.webItemIcon,
"webscene");this.webItemType.innerHTML=a.type;var c=n.create("div",{"class":"thumbnail"},this.thumbnailContainer);a.thumbnailUrl?n.setStyle(c,"backgroundImage","url("+a.thumbnailUrl+")"):"web map"===b?n.addClass(c,"default-webmap"):"web scene"===b&&n.addClass(c,"default-webscene");"web map"===b?n.addClass(this.webItemIcon,"webmap"):"web scene"===b&&n.addClass(this.webItemIcon,"webscene");this.snippet.innerHTML=a.snippet||"";this.lastModified.innerHTML=this._tryLocaleDate(new Date(a.modified));this.lastModified.title=
this.lastModified.innerHTML;this.webMapDetails.href=a.detailsPageUrl;b=a.owner||"";this.ownerName.innerHTML=b;this.ownerName.title=b;this.ownerName.href=a.ownerPageUrl||"";this.mapTitle.innerHTML=a.title;this.mapTitle.title=a.title},_checkCustomScaleAvailablity:function(){this._isBasemapLayerSupportLods()?(n.removeClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=""):(n.addClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=this.nls.scaleDisabledTip2)},_isBasemapLayerSupportLods:function(){var a=
!1;if(this.map){var b=this.map.layerIds;b&&0<b.length&&(a=(a=this.map.getLayer(b[0]))&&a.tileInfo&&a.tileInfo.lods)}return a},_onBtnScaleClicked:function(){if(this._isBasemapLayerSupportLods())var a=new z({nls:this.nls,map:this.map}),b=new A({width:640,height:590,titleLabel:this.nls.scaleTitle,content:a,container:"main-page",onClose:h.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(G){console.error(G)}a=null;return!0}),buttons:[{label:this.nls.ok,onClick:h.hitch(this,function(){var c=a.getLodsFromListNode(),
d=a.getLodsFromMap();b.close();var e=!1,e=c.length===d.length?r.every(c,h.hitch(this,function(a,b){var c=d[b],e=a.scale===c.scale,f=a.resolution===c.resolution;return a.level===c.level&&e&&f})):!1;e||(this.appConfigPlugin.showLoadingCover(),f.publish("mapOptionsChanged",{lods:c}))})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:h.hitch(this,function(){b.close()})}]})},_setInitialViewpoint:function(a){try{f.publish("mapOptionsChanged",{initialState:{viewpoint:a}})}catch(E){console.error(E)}},
_useCurrentViewpoint:function(){if(this.sceneView){var a=this.sceneView.viewpoint.toJSON();this._setInitialViewpoint(a);this._blinkMapContainer()}},_useDefaultViewpoint:function(){var a=this.sceneView.map.itemInfo.itemData.initialState.viewpoint,a=h.clone(a);this._setInitialViewpoint(a);this._blinkMapContainer()}})})},"dojo/_base/query":function(){define(["../query","./NodeList"],function(p){return p})},"builder/plugins/map-config/MapSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapSelector.html dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on jimu/utils jimu/dijit/TabContainer3 jimu/portalUrlUtils jimu/dijit/Search builder/portalUtils ./MapTable dijit/form/Select".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w){return p([b,m,l],{templateString:h,baseClass:"map-selector",tab:null,isPublicTabShow:!1,nls:null,type:"",_user:null,_group:null,_webMapQueryString:"",_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_signIn:!1,portal:null,postCreate:function(){this.inherited(arguments);
this._webMapQueryString=" "+u.getItemQueryStringByTypes([this.type])+" ";this.portal=d.getPortal(this._getPortalUrl());this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initMapTables();this._initPrivate();this._initPublic();this._bindMapTableEvents();this._updateUIbySignIn()},startup:function(){this.tab._started||(this.tab.startup(),this.tab._started=!0)},_initTabs:function(){var b={title:this.nls.myContent,content:this.mycontentTabNode},c={title:this.nls.myOrganization,content:this.organizationTabNode},
d={title:this.nls.myGroup,content:this.groupTabNode},f={title:this.nls.publicMap,content:this.publicTabNode};this.isPublicTabShow=!1;this.tab=new v({tabs:[b,c,d,f]},this.tabNode);this.own(a(this.tab,"tabChanged",n.hitch(this,function(a){e.addClass(this.signinSection,"hidden");a!==this.nls.publicMap?(this.isPublicTabShow=!1,this._updateUIbySignIn(),this.portal.getUser().then(n.hitch(this,function(b){a===this.nls.myContent?this._searchMyContent(b):a===this.nls.myOrganization?this._searchOrganization(b):
a===this.nls.myGroup&&this._searchGroups(b)}))):(this.isPublicTabShow=!0,this._searchPublic())})))},_bindMapTableEvents:function(){this.own(a(this.mycontentMapTable,"select",n.hitch(this,this._onMapSelected)));this.own(a(this.organizationMapTable,"select",n.hitch(this,this._onMapSelected)));this.own(a(this.groupMapTable,"select",n.hitch(this,this._onMapSelected)));this.own(a(this.publicPortalMapTable,"select",n.hitch(this,this._onMapSelected)));this.own(a(this.publicOnlineMapTable,"select",n.hitch(this,
this._onMapSelected)))},_onMapSelected:function(a){if(a=a&&a.selectedNode)this.mycontentMapTable.unselect(),this.organizationMapTable.unselect(),this.groupMapTable.unselect(),this.publicPortalMapTable.unselect(),this.publicOnlineMapTable.unselect(),e.addClass(a,"selected")},_updateUIbySignIn:function(){e.addClass(this.signinSection,"hidden");var a=c(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);this.portal.haveSignIn()?e.removeClass(a,"hidden"):
(e.addClass(a,"hidden"),this.isPublicTabShow||e.removeClass(this.signinSection,"hidden"))},_initPortalRadio:function(){u.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalNameLabel);u.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlineNameLabel);var a=this._getPortalUrl(),a=q.getServerByUrl(a);q.isArcGIScom(a)?(this.portalPublicRaido.disabled=!0,this.onlinePublicRaido.checked=!0,e.addClass(this.portalPublicRaido,"hidden"),e.addClass(this.portalNameLabel,"hidden")):(this.portalPublicRaido.disabled=
!1,this.portalPublicRaido.checked=!0,this.portalNameLabel.innerHTML=a)},_initSearchQuery:function(){var a="esri_"+(r.locale&&r.locale.slice(0,2)||"en").toLowerCase(),b=g.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),n.hitch(this,function(b){return b!==a})),c="";g.forEach(b,n.hitch(this,function(a){c+=" -owner:"+
a+" "}));b=" ";this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._webMapQueryString+" AND access:public "+c;this._allPublicPortalQuery=this._getQuery({q:b});this._filterPublicPortalQuery=this._getQuery({q:b});this._allPublicOnlineQuery=this._getQuery({q:'(group:"c755678be14e4a0984af36a15f5b643e" OR  group:"b8787a74b4d74f7fb9b8fac918735153") '+this._webMapQueryString+" AND access:public"});this._filterPublicOnlineQuery=this._getQuery({q:this._webMapQueryString+
" AND access:public"});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return n.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return q.getStandardPortalUrl(window.portalUrl)},_initMapTables:function(){var a=this._getPortalUrl();this.portalPublicRaido.disabled||
(this.publicPortalMapTable.set("portalUrl",a),this.publicPortalMapTable.set("filteredQuery",this._filterPublicPortalQuery));this.publicOnlineMapTable.set("portalUrl",window.location.protocol+"//www.arcgis.com");this.publicOnlineMapTable.set("filteredQuery",this._filterPublicOnlineQuery)},_initPublic:function(){this.own(a(this.portalPublicRaido,"click",n.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this.own(a(this.onlinePublicRaido,"click",n.hitch(this,function(){this._onPublicRaidoClicked();
this._searchPublicByRadio()})));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?(this.publicPortalMapTable.show(),this.publicOnlineMapTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalMapTable.hide(),this.publicOnlineMapTable.show())},_onPublicSearch:function(){var a=this._getSortFieldAndSortOrder(this.publicSelect),b=this.publicSearch.getValue();(b=b&&n.trim(b))?(this.publicPortalMapTable.showFilterMapsSection(),this.publicOnlineMapTable.showFilterMapsSection(),
this._filterPublicPortalQuery.q=b+this._allPublicPortalQuery.q,this._filterPublicPortalQuery.start=1,n.mixin(this._filterPublicPortalQuery,a),this.publicPortalMapTable.searchFilteredMaps(this._filterPublicPortalQuery),this._filterPublicOnlineQuery.q=b+this._webMapQueryString+" AND access:public",this._filterPublicOnlineQuery.start=1,n.mixin(this._filterPublicOnlineQuery,a),this.publicOnlineMapTable.searchFilteredMaps(this._filterPublicOnlineQuery)):(this.publicPortalMapTable.showAllMapsSection(),
this.publicOnlineMapTable.showAllMapsSection(),this._allPublicPortalQuery.start=1,n.mixin(this._allPublicPortalQuery,a),this.publicPortalMapTable.showAllMapsSection(this._allPublicPortalQuery),this._allPublicOnlineQuery.start=1,n.mixin(this._allPublicOnlineQuery,a),this.publicOnlineMapTable.showAllMapsSection(this._allPublicOnlineQuery))},_searchPublic:function(){this.tab.getSelectedTitle()===this.nls.publicMap&&(this.publicTabNode.isSearched||this._searchPublicByRadio())},_searchPublicByRadio:function(){this.portalPublicRaido.checked?
this.publicPortalMapTable.isSearched||(this._onPublicSearch(),this.publicPortalMapTable.isSearched=!0):this.publicOnlineMapTable.isSearched||(this._onPublicSearch(),this.publicOnlineMapTable.isSearched=!0)},_initPrivate:function(){this._resetPortalMaps();this.own(f.subscribe("userSignIn",n.hitch(this,this._onSignIn)));this.own(f.subscribe("userSignOut",n.hitch(this,this._onSignOut)));this.own(a(this.groupsSelect,"change",n.hitch(this,this._onGroupsSelectChange)));var b=q.getServerByUrl(this._getPortalUrl());
q.isArcGIScom(b)&&(b="ArcGIS.com");this.portal.haveSignIn()&&this._onSignIn()},_getSortFieldAndSortOrder:function(a){var b={};a=a.get("value");b.sortField=a;"modified"===a?b.sortOrder="desc":"numviews"===a?b.sortOrder="desc":"avgrating"===a?b.sortOrder="desc":"title"===a?b.sortOrder="asc":"owner"===a&&(b.sortOrder="asc");return b},_onOrganizationSearch:function(){var a=this._getSortFieldAndSortOrder(this.organizationSelect),b=this.organizationSearch.getValue();(b=b&&n.trim(b))?(this._filterOrganizationQuery.q=
b+" "+this._allOrganizationQuery.q,this._filterOrganizationQuery.start=1,n.mixin(this._filterOrganizationQuery,a),this.organizationMapTable.searchFilteredMaps(this._filterOrganizationQuery)):(this._allOrganizationQuery.start=1,n.mixin(this._allOrganizationQuery,a),this.organizationMapTable.showAllMapsSection(this._allOrganizationQuery))},_onMyContentSearch:function(){var a=this._getSortFieldAndSortOrder(this.mycontentSelect),b=this.mycontentSearch.getValue();(b=b&&n.trim(b))?(this._filterMyContentQuery.q=
b+" "+this._allMyContentQuery.q,this._filterMyContentQuery.start=1,n.mixin(this._filterMyContentQuery,a),this.mycontentMapTable.searchFilteredMaps(this._filterMyContentQuery)):(this._allMyContentQuery.start=1,n.mixin(this._allMyContentQuery,a),this.mycontentMapTable.showAllMapsSection(this._allMyContentQuery))},_onGroupSearch:function(){var a=this._getSortFieldAndSortOrder(this.groupSelect),b=this.groupSearch.getValue();(b=b&&n.trim(b))?(this._filterGroupQuery.q=b+" "+this._allGroupQuery.q,this._filterGroupQuery.start=
1,n.mixin(this._filterGroupQuery,a),this.groupMapTable.searchFilteredMaps(this._filterGroupQuery)):(this._allGroupQuery.start=1,n.mixin(this._allGroupQuery,a),this.groupMapTable.showAllMapsSection(this._allGroupQuery))},_onSignIn:function(){this._updateUIbySignIn();this._signIn||(this._signIn=!0,this.portal.getUser().then(n.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))})))},_onSignOut:function(){this._signIn=
!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationMapTable.clear();this.mycontentMapTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){if(this.tab.getSelectedTitle()===this.nls.myOrganization&&!this.organizationTabNode.isSearched){this.organizationMapTable.clear();a=" orgid:"+a.orgId+" AND "+this._webMapQueryString+" AND (access:org OR access:public) ";var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});
this._filterOrganizationQuery=this._getQuery({q:a});this.organizationMapTable.set("portalUrl",b);this._onOrganizationSearch();this.organizationTabNode.isSearched=!0}},_searchMyContent:function(a){if(this.tab.getSelectedTitle()===this.nls.myContent&&!this.mycontentTabNode.isSearched){this.mycontentMapTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._webMapQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentMapTable.set("portalUrl",
b);this._onMyContentSearch();this.mycontentTabNode.isSearched=!0}},_searchGroups:function(a){if(this.tab.getSelectedTitle()===this.nls.myGroup&&!this.groupTabNode.isSearched){this._resetGroupsSection();e.removeClass(this.groupsSection,"hidden");a=a.getGroups();if(0<a.length){e.removeClass(this.groupSearchSection,"hidden");this.groupMapTable.show();e.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var c=a[b];e.create("option",{value:c.id,innerHTML:c.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length);
this.groupTabNode.isSearched=!0}},_resetGroupsSection:function(){e.addClass(this.groupsSection,"hidden");e.empty(this.groupsSelect);e.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupMapTable.clear();e.addClass(this.groupSearchSection,"hidden");this.groupMapTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?e.setStyle(this.groupsSection,"top","15px"):e.setStyle(this.groupsSection,"top","70px")},_onGroupsSelectChange:function(){var a=
this.groupsSelect.value;this.groupMapTable.clear();if("nodata"===a)e.addClass(this.groupSearch,"hidden"),this.groupMapTable.hide();else{e.addClass(this.groupSearch,"hidden");this.groupMapTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._webMapQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupMapTable.set("portalUrl",b);this._onGroupSearch()}},_onMyContentRefreshIconClicked:function(){this._onMyContentSearch()},_onOrgRefreshIconClicked:function(){this._onOrganizationSearch()},
_onGroupRefreshIconClicked:function(){this._onGroupSearch()},_onPublicRefreshIconClicked:function(){this._onPublicSearch()},getSelectedMapItem:function(){var a=null,b=c(".map-item-bg.selected",this.domNode);0<b.length&&(a=b[0].parentNode.item);return a}})})},"builder/plugins/map-config/MapTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dojo/i18n!./nls/strings".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d){return p([f,b,m,h],{templateString:l,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,originalSelectedId:null,type:"",postMixInProperties:function(){this.nls=d},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=q.getStandardPortalUrl(this.portalUrl));this.own(a(this.allMapsTableDiv,"scroll",r.hitch(this,this._onAllMapsSectionScroll)));this.own(a(this.filteredMapsTableDiv,
"scroll",r.hitch(this,this._onFilteredMapsSectionScroll)));this._showAllMapsSection();this.searchAllMaps()},show:function(){g.removeClass(this.domNode,"hidden")},hide:function(){g.addClass(this.domNode,"hidden")},searchAllMaps:function(a){this._showAllMapsSection();a&&(this.query=r.clone(a),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),v.getPortal(this.portalUrl).queryItems(this.query).then(r.hitch(this,function(a){this.domNode&&
(this.allMapsShelter.hide(),this.query.start=a.nextStart,this._createMapItems(a,this.allMapsTbody))}),r.hitch(this,function(a){console.error(a);this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(a){this._showFilterMapsSection();a&&(this.filteredQuery=r.clone(a),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),v.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(r.hitch(this,
function(b){this.domNode&&(this._showFilterMapsSection(),a&&this.clearFilteredMapsSection(),this.filteredQuery.start=b.nextStart,this._createMapItems(b,this.filteredMapsTbody),this._filterMapCallback())}),r.hitch(this,function(a){console.error(a);this.domNode&&this._filterMapCallback()})))},_filterMapCallback:function(){this.filteredMapsShelter.hide();0<this._getWebMapCount(this.filteredMapsTbody)?(g.removeClass(this.filteredMapsTableDiv,"hidden"),g.addClass(this.searchNoneTipSection,"hidden")):(g.addClass(this.filteredMapsTableDiv,
"hidden"),g.removeClass(this.searchNoneTipSection,"hidden"))},clear:function(){this.clearAllMapsSection();this.clearFilteredMapsSection()},clearAllMapsSection:function(){g.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){g.empty(this.filteredMapsTbody)},showAllMapsSection:function(a){this._showAllMapsSection();a&&this.searchAllMaps(a)},_showAllMapsSection:function(){g.removeClass(this.allMapsSection,"hidden");g.addClass(this.filteredMapsSection,"hidden")},showFilterMapsSection:function(a){this._showFilterMapsSection();
a&&this.searchFilteredMaps(a)},_showFilterMapsSection:function(){g.addClass(this.allMapsSection,"hidden");g.removeClass(this.filteredMapsSection,"hidden");g.removeClass(this.filteredMapsTableDiv,"hidden");g.addClass(this.searchNoneTipSection,"hidden")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},_isScrollToBottom:function(a){return u.isScrollToBottom(a)},
_createMapItems:function(a,b){var d=n.filter(a.results,r.hitch(this,function(a){return a.type.toLowerCase()===this.type.toLowerCase()}));if(0!==d.length){var e={},f,k=c("td.empty",b),h;if(0<k.length){var l=Math.min(d.length,k.length),m=d.splice(0,l);for(h=0;h<l;h++){var q=k[h];f=this._createMapItem(m[h]);e[f.item.id]=f;g.place(f,q);g.removeClass(q,"empty")}}if(0!==d.length){k=Math.ceil(d.length/5);for(h=0;h<k;h++)for(f=g.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),
g.place(f,b),l=c("td",f),m=0;m<l.length;m++)q=l[m],(f=d[5*h+m])?(f=this._createMapItem(f),e[f.item.id]=f,g.place(f,q)):g.addClass(q,"empty");!this.getSelectedMapItem()&&this.appConfig&&this.appConfig.map.itemId&&(f=e[this.appConfig.itemId])&&(d=c(".map-item-bg",f),g.addClass(d,"selected"))}}},_getWebMapCount:function(a){return c(".map-item-div",a).length},_createMapItem:function(b){var d=g.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
e=c(".map-item-bg",d)[0],f=c(".map-item-thumbnail",d)[0],k=c(".map-item-title",d)[0],h=c(".map-item-detail-icon",d)[0];c(".none-thumbnail-tip",d);h.href=b.detailsPageUrl;h.title=this.nls.viewItemDetails||"";d.item=b;h=b.thumbnailUrl||u.getDefaultWebMapThumbnail();g.setStyle(f,"backgroundImage","url("+h+")");this.own(a(e,"click",r.hitch(this,this._onMapItemBgClick)));k.innerHTML=b.title;k.title=b.title;return d},unselect:function(){c(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(a){a=
a.target||a.srcElement;var b=null;g.hasClass(a,"map-item-thumbnail")?b=a.parentNode:g.hasClass(a,"none-thumbnail-tip")&&(b=a.parentNode.parentNode);b&&g.hasClass(b,"map-item-bg")&&(this.unselect(),g.addClass(b,"selected"),this.emit("select",{mapTable:this,selectedNode:b}))},getSelectedMapItem:function(){var a=null,b=c(".map-item-bg.selected",this.domNode);0<b.length&&(a=b[0].parentNode.item);return a}})})},"builder/plugins/map-config/CustomizeScale":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomizeScale.html dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/dijit/Message dijit/form/NumberTextBox".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){return p([f,b,m],{templateString:l,baseClass:"mapconfig-customize-scale",map:null,postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.scaleNumberBox=new a({placeholder:this.nls.scale,intermediateChanges:!0,trim:!0,constraints:{min:1,pattern:"###############0.################"},style:"width:550px;height:100%;"});g.addClass(this.scaleNumberBox.domNode,"jimu-float-leading");this.scaleNumberBox.placeAt(this.scaleInputDiv,"first");
var b=this.getLodsFromMap();this._resetLodListByLods(b)},getLodsFromMap:function(){var a=[];this.map._params&&this.map._params.lods&&(a=n.map(this.map._params.lods,r.hitch(this,function(a){return a.toJson()})));return a},_getLodsFromBasemapLayer:function(){var a=[],b=this.map.getLayer(this.map.layerIds[0]);b&&b.tileInfo&&b.tileInfo.lods&&(a=n.map(b.tileInfo.lods,r.hitch(this,function(a){return{level:a.level,resolution:a.resolution,scale:a.scale}})));return a},getLodsFromListNode:function(){for(var a=
this._getLodItems(),b=[],c=null,e=0;e<a.length;e++)c=a[e].lod,b.push({level:c.level,scale:c.scale,resolution:c.resolution});return b},_resetLodListByLods:function(a){g.empty(this.listNode);n.forEach(a,r.hitch(this,function(a){a=this._createLodItem(a);g.place(a,this.listNode)}))},_createLodItem:function(a){var b=g.create("div",{innerHTML:e.localizeNumber(a.scale),"class":"lod-item"});b.lod=a;return b},_getLodItems:function(){return h(".lod-item",this.listNode)},_getSelectedLodItem:function(){var a=
null,b=h(".selected",this.listNode);0<b.length&&(a=b[0]);return a},_selectLodItem:function(a){this._removeSelectedClass();g.addClass(a,"selected");g.addClass(this.btnDelete,"enabled-operation");a.previousSibling||g.setStyle(a,"borderTop","0")},_removeSelectedClass:function(){h(".lod-item",this.listNode).removeClass("selected");g.removeClass(this.btnDelete,"enabled-operation")},_onLodListClicked:function(a){a=a.target||a.srcElement;g.hasClass(a,"lod-item")&&this._selectLodItem(a)},_onBtnAddClicked:function(){if(this.scaleNumberBox.validate()){var a=
this.scaleNumberBox.get("value");this.scaleNumberBox.set("displayedValue","");var b=this._getLodItems();if(0!==b.length&&!n.some(b,r.hitch(this,function(b){return b.lod.scale===a}))){var c=b.length-1,e=b[0].lod,d=b[c].lod,f=null,f={level:null,resolution:e.resolution/e.scale*a,scale:a};if(f.scale>e.scale)f.level=e.level-1,f=this._createLodItem(f),g.place(f,this.listNode,"first");else if(f.scale<d.scale)f.level=d.level+1,f=this._createLodItem(f),g.place(f,this.listNode);else for(var h=null,e=null,d=
c;1<=d;d--)if(h=b[d],e=b[d-1],f.scale>h.lod.scale&&f.scale<e.lod.scale){f.level=h.lod.level;f=this._createLodItem(f);g.place(f,e,"after");for(f=d;f<=c;f++)b[f].lod.level+=1;break}}}},_onBtnDeleteClicked:function(){var a=this._getSelectedLodItem();if(a)if(1===this.getLodsFromListNode().length)new c({message:this.nls.atLeastOneScale});else{var b=a;if(!a.previousSibling)for(;a.nextSibling;)a=a.nextSibling,--a.lod.level;g.destroy(b);this._removeSelectedClass()}},_onBtnResetClicked:function(){this._removeSelectedClass();
var a=this._getLodsFromBasemapLayer();this._resetLodListByLods(a)}})})},"builder/plugins/popup-actions/configmode-switch/_build-generate_module":function(){define(["builder/plugins/popup-actions/configmode-switch/Plugin","dojo/i18n!builder/plugins/popup-actions/configmode-switch/nls/strings"],function(){})},"builder/plugins/popup-actions/configmode-switch/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","builder/BasePlugin"],function(p,f,b,m){return p([m],{baseClass:"plugin-app-actions-popup-saveas",
disabled:null,postCreate:function(){this.inherited(arguments);this._bindEvent();this.label=this.nls.advanceConfigLabel;this.isAdvance=!1},onClick:function(){var b=this.pluginManager.getPluginByName("app-config");this.isAdvance?(this.isAdvance=!1,this.label=this.nls.advanceConfigLabel,b.switchToTemplateConfigPart()):(this.isAdvance=!0,this.label=this.nls.templateConfigLabel,b.switchToPreviewConfig())},_bindEvent:function(){this.own(b.subscribe("app/appConfigLoaded",f.hitch(this,this._setAppConfig)))},
_setAppConfig:function(b){this.appConfig=b;b.templateConfig&&b.isTemplateApp||b.templateConfig&&b._appData?(this.visible=!0,this.isAdvance=!1):(this.visible=!1,this.isAdvance=!0)}})})},"builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-agoltemplate/Plugin","dojo/text!builder/plugins/popup-actions/popup-agoltemplate/css/style.css","dojo/i18n!builder/plugins/popup-actions/popup-agoltemplate/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-agoltemplate/Plugin":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all dojo/Deferred dojo/on dojo/topic dojo/_base/html dojo/json builder/BasePlugin builder/serviceUtils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter jimu/dijit/Popup jimu/Role builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t){return p([e],{baseClass:"plugin-app-actions-popup-template",disabled:null,postMixInProperties:function(){this.inherited(arguments);this.nls=b.mixin(this.nls,builderNls)},constructor:function(){"HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id?this.disabled=!0:a.getPortal(window.portalUrl).getUser().then(b.hitch(this,function(a){this.user=a;var b=new k({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&b.setPrivileges(a.privileges);b.isAdmin()?
this.disabled=!1:a.username===window.appInfo.appOwner&&(window.isXT||b.canCreateItem())?this.disabled=!1:this.disabled=!0}),b.hitch(this,function(a){this.disabled=!0;console.log(a)}))},postCreate:function(){this.inherited(arguments);this.label=this.nls.exportTitle;var a=this.pluginManager.getPluginByName("startup");this.shelter=(new v({hidden:!0})).placeAt(a.domNode);this._bindEvent()},onClick:function(){if(!this.disabled){var d=new l,e=window.appInfo.id;this.shelter.show();window.isXT?c.getAppInfo(e).then(b.hitch(this,
function(a){d.resolve(a)}),function(){d.reject()}):a.getPortal(u.getPortalUrlFromLocation()).getItemData(e).then(b.hitch(this,function(a){a=a.agolTemplateInfo;!a&&this.appConfig.agolTemplateJson&&(a={itemId:null,json:this.appConfig.agolTemplateJson});a={id:e,name:this.pluginManager.getPluginByName("header").getAppName(),agolTemplateInfo:a};d.resolve(a)}),function(){d.reject()});var f=w.loadAllWidgetConfigs(b.clone(this.appConfig)),g=this.pluginManager.getPluginByName("app-actions.save-app").saveApp();
m({app:d,appConfig:f,saveApp:g}).then(b.hitch(this,function(a){var b=a.app;this._createAGOLTemplate(b,a.appConfig);this._createAGOLTemplatePrview();this.popupDlg(b);this.shelter.hide()}),b.hitch(this,function(a){console.error(a.message);this.shelter.hide()}))}},popupDlg:function(a){var c=n.create("div",{"class":"template-popup-content"}),d=n.getMarginBox(window.document.body).w,d=.9*d;1024>d&&(d=1024);this.popup=new q({content:c,"class":"plugin-app-actions-template-popup",container:"main-page",titleLabel:this.nls.title,
width:d,height:668,buttons:[{label:this.nls.exportStr,onClick:b.hitch(this,this._onExportClick)},{label:this.nls.saved,onClick:b.hitch(this,this._onSaveClick)},{label:this.nls.close,classNames:["jimu-btn-vacation"],onClick:b.hitch(this,this._onCancelClick)}]});this._initPopup(a);this.agoltemplateDijit.loading.placeAt(this.popup.domNode);this.popup.configPart=n.create("div",{"class":"config-part jimu-float-leading"},c);a=n.create("div",{"class":"privew-part-box jimu-float-leading"},c);a=n.create("div",
{"class":"privew-part-inset-box"},a);this.popup.previewPart=n.create("div",{"class":"privew-part"},a);n.place(this.agoltemplateDijit.domNode,this.popup.configPart);n.place(this.agoltemplatePrivew.domNode,this.popup.previewPart)},_onExportClick:function(a){window.isXT?n.hasClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")?n.removeClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):n.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):this.agoltemplateDijit.exportOrUpdateAGOLTemplate();
a.stopPropagation()},_onExportAGOLTemplateClick:function(a){this._hasCreateItemPrivilege()?this.agoltemplateDijit.exportOrUpdateAGOLTemplate():a.stopPropagation()},_onExportWABTemplateClick:function(){this.agoltemplateDijit.exportWABTemplate()},_onSaveClick:function(){n.setAttr(this.popup.enabledButtons[1],"innerHTML",this.nls.saving);this.agoltemplateDijit.saveAgolTemplate().then(b.hitch(this,function(){this._disablePopupButton(1,this.nls.saved)}))},_onCancelClick:function(){if(this.agoltemplateDijit.hasChanged())var a=
new q({content:"\x3cdiv\x3e\x3cimg class\x3d'alert-image jimu-float-leading'src\x3d'"+this.folderUrl+"/css/images/alert.png' style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+this.nls.unSaveMeg+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.cancelPopupTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.save,onClick:b.hitch(this,function(){this.agoltemplateDijit.saveAgolTemplate().then(b.hitch(this,function(){a.close();this._closePopup();
this.agoltemplateDijit.destroyRecursive()}))})},{label:this.nls.doNotSave,onClick:b.hitch(this,function(){a.close();this._closePopup();this.agoltemplateDijit.destroyRecursive()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:b.hitch(this,function(){a.close()})}]});else this._closePopup(),this.agoltemplateDijit.destroyRecursive()},_closePopup:function(){this.popup&&(this.popup.closeTemplate=!0,this.popup.close())},_initPopup:function(c){this.popup.disableButton(1);this.popup.onClose=
b.hitch(this,function(){if(this.popup.closeTemplate)return!0;this._onCancelClick();return!1});if(window.isXT){this.popup.exportDrawBoxDomNode=n.create("div",{"class":"export-draw-box export-draw-box-hiden"});var d;d=this._hasCreateItemPrivilege()?"export-draw-box-btn":"export-draw-box-btn export-draw-box-btn-disable";this.popup.exportAGOLTemplateDomNode=n.create("div",{"class":d,innerHTML:this.nls.exportAGOLTemplate},this.popup.exportDrawBoxDomNode);this.popup.exportWABTemplateDomNode=n.create("div",
{"class":"export-draw-box-btn",innerHTML:this.nls.exportWABTemplate},this.popup.exportDrawBoxDomNode);n.addClass(this.popup.domNode,"plugin-app-actions-template-popup-for-xt");n.addClass(this.popup.enabledButtons[0],"export-btn");n.place(this.popup.exportDrawBoxDomNode,this.popup.enabledButtons[0]);this.popup.own(h(this.popup,"click",b.hitch(this,function(){n.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")})));this.popup.own(h(this.popup.exportAGOLTemplateDomNode,"click",b.hitch(this,
this._onExportAGOLTemplateClick)));this.popup.own(h(this.popup.exportWABTemplateDomNode,"click",b.hitch(this,this._onExportWABTemplateClick)))}else this._hasCreateItemPrivilege()||this.popup.disableButton(0);c.agolTemplateInfo&&c.agolTemplateInfo.itemId&&a.getPortal(window.portalUrl).getItemById(c.agolTemplateInfo.itemId).then(b.hitch(this,function(){window.isXT?n.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):n.setAttr(this.popup.enabledButtons[0],"innerHTML",
this.nls.update)}),b.hitch(this,function(){c.agolTemplateInfo.itemId=null;window.isXT?n.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.exportAGOLTemplate):n.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.exportStr)}))},_disablePopupButton:function(a,b){this.popup.disableButton(a);n.setAttr(this.popup.disabledButtons[a],"innerHTML",b)},_enablePopupButton:function(a,b){this.popup.enableButton(a);n.setAttr(this.popup.enabledButtons[a],"innerHTML",b)},_createAGOLTemplate:function(a,
c){var e;e=a.agolTemplateInfo&&a.agolTemplateInfo.json?g.parse(a.agolTemplateInfo.json):c.templateConfig?c.templateConfig:null;this.agoltemplateDijit=new d({appConfig:c,appInfo:a,templateConfig:e});this.own(this.agoltemplateDijit.on("hasChanged",b.hitch(this,function(a){a?this._enablePopupButton(1,this.nls.save):this._disablePopupButton(1,this.nls.saved);this._refreshAGOLTempaltePrview()})));this.own(this.agoltemplateDijit.on("exported",b.hitch(this,function(a){a&&(window.isXT&&this.popup.exportAGOLTemplateDomNode?
n.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):this._enablePopupButton(0,this.nls.update))})));this.agoltemplateDijit.startup()},_createAGOLTemplatePrview:function(){var a;this.agoltemplateDijit&&(a=this.agoltemplateDijit.getTemplateConfig());this.agoltemplatePrivew=new t({templateConfig:a});this.agoltemplatePrivew.startup()},_refreshAGOLTempaltePrview:function(){this.agoltemplatePrivew&&this.agoltemplatePrivew.destroy();this._createAGOLTemplatePrview();n.place(this.agoltemplatePrivew.domNode,
this.popup.previewPart)},_bindEvent:function(){this.own(r.subscribe("app/appConfigLoaded",b.hitch(this,this._setAppConfig)));this.own(r.subscribe("app/appConfigChanged",b.hitch(this,this._setAppConfig)))},_setAppConfig:function(a){this.appConfig=a;this.visible=a.templateConfig&&a.isTemplateApp||!a.templateConfig?!0:!1},_hasCreateItemPrivilege:function(){var a=!1;this.user?f.forEach(this.user.privileges,function(b){0<=b.indexOf("createItem")&&(a=!0)},this):a=!0;return a}})})},"builder/plugins/popup-actions/popup-saveas/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-saveas/Plugin",
"dojo/i18n!builder/plugins/popup-actions/popup-saveas/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-saveas/Plugin":function(){define("dojo/_base/declare dojo/_base/lang builder/BasePlugin jimu/Role jimu/portalUrlUtils builder/portalUtils".split(" "),function(p,f,b,m,l,h){return p([b],{baseClass:"plugin-app-actions-popup-saveas",disabled:null,constructor:function(){if("HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id)this.disabled=!0;else if(window.isXT)this.disabled=!1;
else{var b=l.getStandardPortalUrl(window.portalUrl);h.getPortal(b).getUser().then(f.hitch(this,function(b){var f=new m({id:b.roleId?b.roleId:b.role,role:b.role});b.privileges&&f.setPrivileges(b.privileges);f.canCreateItem()||(this.disabled=!0)}),f.hitch(this,function(){this.disable=!0}))}},postCreate:function(){this.inherited(arguments);this.label=this.nls.label},onClick:function(){if(!this.disabled){var b=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[b.pluginName]).then(f.hitch(this,
function(b){b.popupSaveAsDlg(this.nls.saveAsTitle,window.appInfo.id,window.appConfig)}))}}})})},"builder/plugins/popup-actions/popup-share/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-share/Plugin"],function(){})},"builder/plugins/popup-actions/popup-share/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys jimu/dijit/Popup builder/BasePlugin jimu/portalUrlUtils jimu/dijit/ShareOptions jimu/dijit/ShareLink dojo/topic dojo/query jimu/utils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){return p([r],{baseClass:"plugin-app-actions-popup-share",disabled:null,_isShowFindLocation:!0,postCreate:function(){this.inherited(arguments);this.label=window.jimuNls.common.share;this.own(c.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(c.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(c.subscribe("ShareOptions/onClickEveryone",f.hitch(this,function(a){if(this.shareLink&&this.shareLink.onShareToPublicChanged)this.shareLink.onShareToPublicChanged(a)})));
this.own(c.subscribe("ShareLink/onHideContainer",f.hitch(this,function(){this.hide()})));this.own(c.subscribe("ShareLink/onShowContainer",f.hitch(this,function(){this.show()})));this.own(c.subscribe("ShareLink/onHideLinkOptions",f.hitch(this,function(){this._changeBtnsByShareLink("hide")})));this.own(c.subscribe("ShareLink/onShowLinkOptions",f.hitch(this,function(){this._changeBtnsByShareLink("show")})))},onClick:function(){this.disabled||this.popupDlg()},_onAppConfigLoadedOrChanged:function(a){this._isShowFindLocation=
this._findSearchWidget(a);this.shareLink&&this.shareLink.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation})},_findSearchWidget:function(a){a=a.getConfigElementsByName("Search");return 0<a.length&&a[0].visible},popupDlg:function(){var a=this._initContent(),b=this._initPupupBtns(),c=this._initPopupHeight();this.sharePopup=new h({content:a,"class":"share-container",container:"main-page",titleLabel:window.jimuNls.common.share,width:640,height:c,buttons:b});this.shareLink.startup();
this.shareOptions&&this.shareOptions.startup()},_onOkClick:function(){this.shareOptions&&this.shareOptions.share();this.sharePopup.close()},_onCancelClick:function(){this.sharePopup.close()},_initContent:function(){var a=b.create("div",{"class":"template-popup-content"});b.create("div",{"class":"app-name"},a);window.isXT||(this.shareOptions=new g(window.appConfig.portalUrl),this.shareOptions.placeAt(a));this.shareLink=new e({portalUrl:window.appConfig.portalUrl,appTitle:window.appInfo.name,isOnline:n.isOnline(window.top.location.href),
isShowSocialMediaLinks:!0,isSharedToPublic:!1,isShowBackBtn:!1,isShowFindLocation:this._isShowFindLocation});this.shareLink.placeAt(a);return a},_initPupupBtns:function(){var a=[];this.shareOptions&&a.push({label:window.jimuNls.common.ok,key:l.ENTER,isHighLight:!0,onClick:f.hitch(this,this._onOkClick)});a.push({label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],key:l.ESCAPE,onClick:f.hitch(this,this._onCancelClick)});return a},_initPopupHeight:function(){var a=560;this.shareOptions&&
(a=600);return a},_changeBtnsByShareLink:function(a){var b=this.shareOptions?1:0;"hide"===a?(this.sharePopup.setTitleLabel(window.jimuNls.common.share),this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.cancel}),this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.cancel})):"show"===a&&(this.sharePopup.setTitleLabel(window.jimuNls.shareLink.linkOptions),this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.back}),this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.back}),
this._disableShareBtn(),this.own(m.once(this.sharePopup,"Close",f.hitch(this,function(){this.sharePopup.setTitleLabel(window.jimuNls.common.share);this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.cancel});this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.cancel});this._enableShareBtn();this.shareLink._toggleLinkOptions();return!1}))))},_disableShareBtn:function(){this.shareOptions&&this.sharePopup.hideButton(0)},_enableShareBtn:function(){this.shareOptions&&this.sharePopup.showButton(0)},
hide:function(){a("#main-page \x3e .jimu-overlay").style("display","none");a("#main-page \x3e .jimu-popup").style("display","none")},show:function(){a("#main-page \x3e .jimu-overlay").style("display","block");a("#main-page \x3e .jimu-popup").style("display","block")}})})},"jimu/dijit/ShareOptions":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang esri/lang dojo/_base/array dojo/dom-style dojo/on dojo/dom dojo/query dojo/topic dojo/text!./templates/ShareOptions.html jimu/shareUtils dijit/form/Textarea dijit/form/CheckBox dijit/layout/BorderContainer".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v){return p([f,b,m],{templateString:u,declaredClass:"jimu.dijit.ShareOptions",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.shareOptions},constructor:function(a){this.portalUrl=a},startup:function(){v.getShareInfo(this.portalUrl).then(l.hitch(this,function(a){this._initShow(a);this.own(g(e.byId("share-everyone-check"),"change",l.hitch(this,this.clickEveryone)))}))},_initShow:function(a){this.shareInfo=a;this.shareInfo.items=[this.shareInfo.item];
this.shareInfo.sortField="title";(this.shareInfo.userRole.isAdmin()||this.shareInfo._roleCanUpdateItems&&this.shareInfo._roleCanShare||this.shareInfo._roleCanShareOthersItems)&&this.shareInfo.itemUser?this.showAdmin(this.shareInfo.user.groups,this.shareInfo.itemUser,this.shareInfo.adminGroups):this.shareInfo.user&&v._isUserOwnTheApp(this.shareInfo.user)?this.show(this.shareInfo.user.groups):this.shareInfo.user&&("public"===this.shareInfo.item.access||"shared"===this.shareInfo.item.access||"org"===
this.shareInfo.item.access&&this.shareInfo.currentUser.orgId)?this.showGroups(this.shareInfo.user.groups):this.show(this.shareInfo.user.groups)},clear:function(){e.byId("share-groups-list").innerHTML="";e.byId("share-everyone-check").setAttribute("value",!1);e.byId("share-account-check").setAttribute("value",!1);e.byId("share-groups-check").setAttribute("value",!1);n.set(e.byId("share-everyone-check_div"),"display","none");n.set(e.byId("share-account-check_div"),"display","none");this.shareInfo.shareType=
"item"},showAdmin:function(a,b,c){this.shareInfo.itemUser=b;this.shareInfo.userGroups=r.filter(a||[],l.hitch(this,function(){return!this.shareInfo.item.capabilities||!this.shareInfo.item.capabilities.length}));this.shareInfo.userGroups.sort(l.hitch(this,this._sortFunc));this.shareInfo.adminGroups=this.filterAdminGroups(c);this.checkForAccount("admin")},filterAdminGroups:function(a){if(a){for(var b=[],c=0;c<this.shareInfo.user.groups.length;c++)b.push(this.shareInfo.user.groups[c].id);for(var e=[],
c=0;c<a.length;c++)-1!==r.indexOf(b,a[c].id)||a[c].capabilities&&a[c].capabilities.length||e.push(a[c]);return e}return null},showGroups:function(a){this.shareInfo.userGroups=this.filterOwnedGroups(a);this.shareInfo.userGroups&&this.shareInfo.userGroups.sort(l.hitch(this,this._sortFunc));this.clear();this.shareInfo.shareType="group";this.checkForAccount("group")},filterOwnedGroups:function(a){if(a){for(var b=[],c,e=0;e<a.length;e++)c=a[e],!c.userMembership||"owner"!==c.userMembership.memberType&&
"admin"!==c.userMembership.memberType||c.capabilities&&c.capabilities.length||b.push(c);return b}return null},show:function(a){this.shareInfo.userGroups=this.filterViewOnlyGroups(a);this.shareInfo.userGroups.sort(l.hitch(this,this._sortFunc));this.checkForAccount("item")},filterViewOnlyGroups:function(a){if(a){for(var b=[],c,e=0;e<a.length;e++)c=a[e],c.capabilities&&c.capabilities.length||(!c.userMembership||"owner"!==c.userMembership.memberType&&"admin"!==c.userMembership.memberType)&&h.isDefined(c.isViewOnly)&&
c.isViewOnly||b.push(c);return b}return null},checkForAccount:function(a){e.byId("share-account-check-label").innerHTML=this.shareInfo.organization.name;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg||n.set(e.byId("share-account-check_div"),"display","none");this.clear();this.shareInfo.shareType=a;var b=this.shareInfo.items[0];this.shareInfo.lowestAccess=this.findLowestAccessLevel(this.shareInfo.items);v.getItemById(b,this.portalUrl).then(l.hitch(this,
function(a){b.sharing=a.sharing;"admin"===this.shareInfo.shareType?v.getItemByUserAndItemId(b,this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(l.hitch(this,function(a){b.sharing=a.sharing;this.buildAdminList()})):"group"===this.shareInfo.shareType?v.getItemsGroups(b,this.portalUrl).then(l.hitch(this,function(a){var c=[];if(a.admin)for(var d=0;d<a.admin.length;d++)c.push(a.admin[d].id);b.sharing={groups:c};this.buildGroupList()})):"item"===this.shareInfo.shareType&&v.getItemByUserAndItemId(b,
this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(l.hitch(this,function(a){b.sharing=a.sharing;this.buildList()}))}))},buildAdminList:function(){var a,b,c;if(this.shareInfo.user.groups&&0<this.shareInfo.user.groups.length||this.shareInfo.adminGroups&&0<this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?n.set(e.byId("share-groups-div"),"display","block"):n.set(e.byId("share-groups-div"),
"display","none");this.shareInfo.itemsAreSharedToGroups=",";var f=[],h=null,m=null;b=[];for(a=0;a<this.shareInfo.items.length;a++)if(h=this.shareInfo.items[a],h.sharing)for(c=0;c<h.sharing.groups.length;c++)if(m=h.sharing.groups[c],-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+m+","))this.shareInfo.itemsAreSharedToGroups+=m+",",b=[],b[0]=m,b[1]=1,f[f.length]=b;else for(b=0;b<f.length;b++)if(f[b][0]===m){f[b][1]+=1;break}h="";c=!1;var p,r;for(a=0;a<this.shareInfo.user.groups.length;a++){m=
this.shareInfo.user.groups[a];p="";r=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+m.id+","))for(p="checked",c=!0,b=0;b<f.length;b++)if(f[b][0]===m.id){r=f[b][1];break}h=r<this.shareInfo.items.length?h+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+
'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+m.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"' class\x3d'labels'\x3e"+m.title+"\x3c/label\x3e"):h+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"' class\x3d'labels'\x3e"+m.title+"\x3c/label\x3e");
h=this._addOpenDataStr(m,h);h+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)for(h+='\x3cdiv style\x3d"display:block;"\x3e\x3chr/\x3e\x3c/div\x3e',b=0;b<this.shareInfo.adminGroups.length;b++){m=this.shareInfo.adminGroups[b];p="";r=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+m.id+",")){p="checked";c=!0;for(var u=0;u<f.length;u++)if(f[u][0]===m.id){r=f[u][1];break}}h=
r<this.shareInfo.items.length?h+('\x3cdiv id\x3d"img_group_'+(b+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+(b+a)+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+m.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+(b+a)+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
(b+a)+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+m.title+"\x3c/label\x3e"):h+('\x3cdiv id\x3d"group_'+(b+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+(b+a)+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+m.title+"\x3c/label\x3e");h=this._addOpenDataStr(m,h);h+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(g(e.byId("share-groups-list"),"click",l.hitch(this,this.checkGroup)));e.byId("share-groups-list").innerHTML=h;if(this.shareInfo.organization){for(a=f=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&f++;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg?
(0===f?(dijit.byId("share-account-check").set("checked",!1),dijit.byId("share-account-check").set("disabled",!1)):f===this.shareInfo.items.length?(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!1)):(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0)),n.set(e.byId("share-account-check_div"),"display","block")):(dijit.byId("share-account-check").set("disabled",!0),n.set(e.byId("share-account-check_div"),
"display","none"))}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=f=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&f++;0===f?(dijit.byId("share-everyone-check").set("checked",!1),n.set(e.byId("share-everyone-check_div"),"display","block")):(f===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",!0),n.set(e.byId("share-everyone-check_div"),"display","block")):
dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",dijit.byId("share-everyone-check").get("checked"))));this.clickEveryone()}else dijit.byId("share-everyone-check").set("checked",!1),n.set(e.byId("share-everyone-check_div"),"display","none");c?dijit.byId("share-groups-check").set("checked",
!0):dijit.byId("share-groups-check").set("checked",!1);this.own(g(e.byId("share-groups-check"),"click",l.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&this.own(g(e.byId("share-account-check"),"click",l.hitch(this,this.clickAccount)))},buildList:function(){var a,b;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?
this.shareInfo.userGroups&&0<this.shareInfo.userGroups.length&&n.set(e.byId("share-groups-div"),"display","block"):n.set(e.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var c=[];for(a=0;a<this.shareInfo.items.length;a++){var f=this.shareInfo.items[a];if(f.sharing)for(var h=0;h<f.sharing.groups.length;h++){var m=f.sharing.groups[h];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+m+","))this.shareInfo.itemsAreSharedToGroups+=m+",",b=[],b[0]=m,b[1]=1,
c[c.length]=b;else for(b=0;b<c.length;b++)if(c[b][0]===m){c[b][1]+=1;break}}}h="";f=!1;for(a=0;a<this.shareInfo.userGroups.length;a++){var m=this.shareInfo.userGroups[a],p="",r=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+m.id+","))for(p="checked",f=!0,b=0;b<c.length;b++)if(c[b][0]===m.id){r=c[b][1];break}h=r<this.shareInfo.items.length?h+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+
a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+m.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+m.title+"\x3c/label\x3e"):h+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+m.title+"\x3c/label\x3e");h=this._addOpenDataStr(m,
h);h+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(g(e.byId("share-groups-list"),"click",l.hitch(this,this.checkGroup)));e.byId("share-groups-list").innerHTML=h;if(this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)){for(a=c=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&c++;0===c?dijit.byId("share-account-check").set("checked",
!1):dijit.byId("share-account-check").set("checked",!0);n.set(e.byId("share-account-check_div"),"display","block")}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=c=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&c++;0===c?(dijit.byId("share-everyone-check").set("checked",!1),n.set(e.byId("share-everyone-check_div"),"display","block")):(c===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",
!0),n.set(e.byId("share-everyone-check_div"),"display","block")):dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),n.set(e.byId("share-everyone-check_div"),"display","block")));this.clickEveryone()}else if(this.shareInfo.organization&&!this.shareInfo.organization.canSharePublic){for(a=
c=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&c++;c?(dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),n.set(e.byId("share-account-check_div"),"display","block"))):(dijit.byId("share-everyone-check").set("checked",
!1),n.set(e.byId("share-everyone-check_div"),"display","none"))}else dijit.byId("share-everyone-check").set("checked",!1),n.set(e.byId("share-everyone-check_div"),"display","none");f?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(g(e.byId("share-groups-check"),"click",l.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&
this.own(g(e.byId("share-account-check"),"click",l.hitch(this,this.clickAccount)))},buildGroupList:function(){var a,b;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?0<this.shareInfo.userGroups.length&&n.set(e.byId("share-groups-div"),"display","block"):n.set(e.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var c=[];for(a=0;a<this.shareInfo.items.length;a++){var f=this.shareInfo.items[a];if(f.sharing)for(var h=
0;h<f.sharing.groups.length;h++){var m=f.sharing.groups[h];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+m+","))this.shareInfo.itemsAreSharedToGroups+=m+",",b=[],b[0]=m,b[1]=1,c[c.length]=b;else for(b=0;b<c.length;b++)if(c[b][0]===m){c[b][1]+=1;break}}}var f="",h=!1,p,r;for(a=0;a<this.shareInfo.userGroups.length;a++){m=this.shareInfo.userGroups[a];p="";r=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+m.id+","))for(p="checked",h=!0,b=0;b<c.length;b++)if(c[b][0]===
m.id){r=c[b][1];break}f=r<this.shareInfo.items.length?f+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+m.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\"style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\''+m.id+"'\x3e"+m.title+"\x3c/label\x3e"):f+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+p+' value\x3d"'+m.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+m.title+"\x3c/label\x3e");f=this._addOpenDataStr(m,f);f+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(g(e.byId("share-groups-list"),"click",l.hitch(this,this.checkGroup)));e.byId("share-groups-list").innerHTML=f;h?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(g(e.byId("share-groups-check"),"click",l.hitch(this,this.checkGroups)))},share:function(a){"group"===this.shareInfo.shareType?this.shareItemToGroups():
"admin"===this.shareInfo.shareType?this.shareItemAsAdmin(a):this.shareItem(a)},checkGroup:function(a){-1<a.target.id.indexOf("img_group_")&&(n.set(e.byId(a.target.id+"_div"),"display","none"),n.set(e.byId(a.target.id.substring(4,a.target.id.length)+"_div"),"display","block"));!0===a.target.checked&&-1<a.target.id.indexOf("group_")&&dijit.byId("share-groups-check").set("checked",!0)},checkGroups:function(){},clickEveryone:function(){var b=dijit.byId("share-everyone-check").get("checked");if(!0===b){var c=
e.byId("share-account-check_div");this.shareInfo.organization&&c&&"block"===n.get(c,"display")&&(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0))}else this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&n.set(e.byId("share-account-check_div"),"display","block"),dijit.byId("share-account-check").set("disabled",!1);a.publish("ShareOptions/onClickEveryone",
b)},clickAccount:function(){!0===dijit.byId("share-account-check").get("checked")?(this.shareInfo._orgUserCanSharePublicOrOverride&&("none"===n.get(e.byId("share-everyone-check_div"),"display")&&n.set(e.byId("share-everyone-check_div"),"display","block"),dijit.byId("share-everyone-check").set("checked",!1)),dijit.byId("share-account-check").set("checked",!0)):dijit.byId("share-account-check").set("checked",!1)},shareItemAsAdmin:function(){var a="",b="";r.forEach(this.shareInfo.items,function(c){a+=
b+c.id;b=","});var c=!1,f=!1;e.byId("share-everyone-check_div")&&"block"===n.get(e.byId("share-everyone-check_div"),"display")&&(c=dijit.byId("share-everyone-check").get("checked"));e.byId("share-account-check_div")&&"block"===n.get(e.byId("share-account-check_div"),"display")&&(f=dijit.byId("share-account-check").get("checked"));var g="",h="",m="",p="",u=0;if(dijit.byId("share-groups-check").get("checked")){var C;if(this.shareInfo.user.groups&&this.shareInfo.user.groups.length)for(u=0;u<this.shareInfo.user.groups.length;u++)C=
this.shareInfo.user.groups[u].id,"block"===n.get(e.byId("group_"+u+"_div"),"display")&&(e.byId("group_"+u).checked?(g+=m+C,m=","):(h+=p+C,p=","));if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)for(var B=0;B<this.shareInfo.adminGroups.length;B++)C=this.shareInfo.adminGroups[B].id,"block"===n.get(e.byId("group_"+(B+u)+"_div"),"display")&&(e.byId("group_"+(B+u)).checked?(g+=m+C,m=","):(h+=p+C,p=","))}else p="",this.shareInfo.user.groups&&this.shareInfo.user.groups.length&&
r.forEach(this.shareInfo.user.groups,function(a){h+=p+a.id;p=","}),this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess&&r.forEach(this.shareInfo.adminGroups,function(a){h+=p+a.id;p=","});if(0<h.length)for(m={items:a,groups:h},u=0;u<this.shareInfo.items.length;u++)v._unshareItemById(m,this.shareInfo.items[u].id,this.portalUrl).then(l.hitch(this,this.unShareHandler_admin,this.shareInfo.items,a,g,c,f));else this.unShareHandler_admin(this.shareInfo.items,a,g,c,
f)},unShareHandler_admin:function(a,b,c,e,f){var d=a.length,g=function(){d--};b={items:b,groups:c,everyone:e,account:f};for(c=0;c<a.length;c++)e=a[c],this.shareInfo.user.shareItem(b,e.id,e.folderId).then(l.hitch(this,g))},shareItem:function(){var a="",b="";r.forEach(this.shareInfo.items,function(c){a+=b+c.id;b=","});var c=!1,f=!1;e.byId("share-everyone-check_div")&&"block"===n.get(e.byId("share-everyone-check_div"),"display")&&(c=dijit.byId("share-everyone-check").get("checked"));e.byId("share-account-check_div")&&
"block"===n.get(e.byId("share-account-check_div"),"display")&&(f=dijit.byId("share-account-check").get("checked"));var g=dijit.byId("share-groups-check").get("checked"),h="",m="",p="",u="";this.shareInfo.userGroups=this.shareInfo.user.group;g?this.shareInfo.userGroups&&this.shareInfo.userGroups.length&&r.forEach(this.shareInfo.userGroups,function(a,b){var c=a.id;"block"===n.get(e.byId("group_"+b+"_div"),"display")&&(e.byId("group_"+b).checked?(h+=p+c,p=","):(m+=u+c,u=","))}):(u="",this.shareInfo.userGroups&&
this.shareInfo.userGroups.length&&r.forEach(this.shareInfo.userGroups,function(a){m+=u+a.id;u=","}));0<m.length?(g={items:a,groups:m},this.shareInfo.itemUser&&null!==this.shareInfo.itemUser?v.unshareItemsByUser(this.shareInfo.itemUser.username?this.shareInfo.itemUser.username:this.shareInfo.itemUser.email,g,this.portalUrl).then(l.hitch(this,this.unShareHandler_item,this.shareInfo.itemUser,a,h,c,f)):v.unshareItems(this.shareInfo.itemUser,g,this.portalUrl).then(l.hitch(this,this.unShareHandler_item,
this.shareInfo.itemUser,a,h,c,f))):this.unShareHandler_item(this.shareInfo.itemUser,a,h,c,f)},unShareHandler_item:function(a,b,c,e,f){b={items:b,groups:c,everyone:e,account:f};a&&null!==a?v.shareItemsByUser(a.username?a.username:a.email,b,this.portalUrl).then(l.hitch()):v.shareItems(a,b,this.portalUrl).then()},findLowestAccessLevel:function(a){for(var b=3,c,e,f=0;f<a.length;f++)(e=a[f].access)||(e="private"),1===e.length&&(e=e[0]),"public"===e?c=3:"org"===e?c=2:"shared"===e?c=1:"private"===e&&(c=
0),c<b&&(b=c);return b},_sortFunc:function(a,b){var c=a[this.shareInfo.sortField].toLowerCase(),e=b[this.shareInfo.sortField].toLowerCase();return null===c||null===e||c===e?0:c<e?-1:1},_addOpenDataStr:function(a,b){a.isOpenData&&!v.portal.isPortal&&(b+=" "+this.i18n.openData);return b},_clearGroupCheckboxes:function(){if(!1===dijit.byId("share-groups-check").get("checked"))for(var a=c(".share-groups-input-checkbox"),b=0,d=a.length;b<d;b++)a[b].setAttribute("value",!1)}})})},"jimu/shareUtils":function(){define("dojo/_base/lang esri/request dojo/promise/all jimu/shared/basePortalUrlUtils dojo/Deferred esri/lang jimu/portalUtils jimu/Role jimu/utils esri/urlUtils".split(" "),
function(p,f,b,m,l,h,r,n,g,e){var c={getBaseHrefUrl:function(a){var b="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer",c="";window.isXT?c=window.location.protocol+"//"+window.location.host+window.appInfo.appPath:(c=g.urlToObject(window.location.href).query||{},c=c.appid?a+"apps/"+b+"/index.html?appid\x3d"+c.appid:c.id?a+"apps/"+b+"/index.html?id\x3d"+c.id:g.getAppHref());return c},addQueryParamToUrl:function(a,b,c,f){a=e.urlToObject(a);a.query||(a.query={});a.query[b]=c;b=a.path;
for(var g in a.query)c=a.query[g],!0===f&&(c=encodeURIComponent(c)),b=b===a.path?b+"?"+g+"\x3d"+c:b+"\x26"+g+"\x3d"+c;return b},removeQueryParamFromUrl:function(a,b,c){a=e.urlToObject(a);a.query&&delete a.query[b];b=a.path;for(var f in a.query){var g=a.query[f];!0===c&&(g=encodeURIComponent(g));b=b===a.path?b+"?"+f+"\x3d"+g:b+"\x26"+f+"\x3d"+g}return b},getShareUrlContent:function(a){return"\x3cdiv class\x3d'marker-feature-action-popup'\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title jimu-float-leading'\x3e"+
window.jimuNls.common.url+"\x3c/span\x3e\x3cinput type\x3d'text' class\x3d'jimu-float-leading' readonly\x3d'readonly' value\x3d"+a+"/\x3e\x3c/div\x3e\x3c/div\x3e"},getShareUrl:function(a,b,e,f){var g=c.getBaseHrefUrl(window.portalUrl),d="";b&&(b.x&&b.y&&b.spatialReference&&b.spatialReference.wkid?d=b.x+","+b.y+","+b.spatialReference.wkid:b.longitude&&b.latitude&&(d=b.longitude+","+b.latitude+","));g=c.addQueryParamToUrl(g,"marker",d,!0);g=c.addQueryParamToUrl(g+",,,","markertemplate",encodeURIComponent(JSON.stringify({title:b.title,
content:e,isIncludeShareUrl:f})));b=a.getLevel();return g="number"===typeof b&&-1!==b?c.addQueryParamToUrl(g,"level",a.getLevel(),!0):c.addQueryParamToUrl(g,"scale",a.getScale(),!0)},getXyContent:function(a){var b="\x3cdiv class\x3d'marker-feature-action-popup'\x3e";a.longitude&&a.latitude?b+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+window.jimuNls.common.longitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+parseFloat(a.longitude).toFixed(4)+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+
window.jimuNls.common.latitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+parseFloat(a.latitude).toFixed(4)+"\x3c/span\x3e\x3c/div\x3e":a.x&&a.y&&(b+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3ex\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+parseFloat(a.x).toFixed(4)+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title'\x3ey\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+parseFloat(a.y).toFixed(4)+"\x3c/span\x3e\x3c/div\x3e");return b+"\x3c/div\x3e"},_isUserOwnTheApp:function(a){return a&&
a.username&&a.username===window.appInfo.appOwner?!0:!1},getItemByUserAndItemId:function(a,b,c,e){var g=new l;e=m.getStandardPortalUrl(e);e=e+"/sharing/rest/content/users/"+(b?b.username?b.username:b.email:c.email);if(h.isDefined(a.folderId)&&"/"!==a.folderId||h.isDefined(a.ownerFolder)&&"/"!==a.ownerFolder)e+="/"+(a.folderId||a.ownerFolder);e+="/items/"+a.id;f({url:e,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(a){g.resolve(a)}),p.hitch(this,function(a){console.error(a);
g.reject(a)}));return g},_getProfile:function(a,b){var c=new l,e=m.getUserUrl(b,a.owner);f({url:e,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_unshareItemById:function(a,b,c){var e=new l;c=m.getStandardPortalUrl(c);c+="/sharing/rest/content/items/"+b+"/unshare";b={f:"json"};b=p.mixin(b,a);f({url:c,handleAs:"json",content:b,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,
function(a){e.resolve(a)}),p.hitch(this,function(a){console.error(a);e.reject(a)}));return e},canSharePublic:function(a){return!a.selfUrl||!0!==a.canSharePublic&&!1!==a.canSharePublic?!0:a.canSharePublic},unshareItemsByUser:function(a,b,c){var e=new l;c=m.getStandardPortalUrl(c);c+="/sharing/rest/content/users/"+a+"/unshareItems";a={f:"json"};a=p.mixin(a,b);f({url:c,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){e.resolve(a)}),p.hitch(this,function(a){console.error(a);
e.reject(a)}));return e},unshareItems:function(a,b,c){var e=new l;c=m.getStandardPortalUrl(c);c+="/sharing/rest/content/users/"+(b.owner||a.email)+"/unshareItems";a={f:"json"};a=p.mixin(a,b);f({url:c,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){e.resolve(a)}),p.hitch(this,function(a){console.error(a);e.reject(a)}));return e},shareItemsByUser:function(a,b,c){var e=new l;c=m.getStandardPortalUrl(c);c+="/sharing/rest/content/users/"+a+"/shareItems";
a={f:"json"};a=p.mixin(a,b);f({url:c,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){e.resolve(a)}),p.hitch(this,function(a){console.error(a);e.reject(a)}));return e},shareItems:function(a,b,c){var e=new l;c=m.getStandardPortalUrl(c);c+="/sharing/rest/content/users/"+(b.owner||a.email)+"/shareItems";a={f:"json"};a=p.mixin(a,b);f({url:c,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){e.resolve(a)}),
p.hitch(this,function(a){console.error(a);e.reject(a)}));return e},getItemsGroups:function(a,b){var c=new l,e=m.getStandardPortalUrl(b),e=e+("/sharing/rest/content/items/"+a.id+"/groups");f({url:e,handleAs:"json",content:{f:"json"},callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},isSharedToPublic:function(a){return window.isXT?!1:null===a?!0:"undefined"!==typeof a&&"undefined"!==typeof a.item&&
"undefined"!==typeof a.item.access&&"public"===a.item.access?!0:!1},isShowSocialMediaLinks:function(a){return window.isXT?!0:null===a?!0:"undefined"!==typeof a&&"undefined"!==typeof a.item&&"undefined"!==typeof a.item.access&&"private"===a.item.access?!1:!0},getItemShareInfo:function(a){var b=new l,c="";if(window.isXT)return b.resolve(null);c=g.urlToObject(g.getAppHref()).query||{};c=c.id||c.appid;if("undefined"===typeof c||""===c)return b.resolve(null);r.getPortal(a).getItemById(c).then(p.hitch(this,
function(a){var c={};c.item=a;c.item&&"undefined"===typeof c.item.sharing&&c.item.access&&(c.item.sharing={access:c.item.access});b.resolve(c)}),p.hitch(this,function(a){console.log(a);b.resolve(null)}));return b},getShareInfo:function(a){var e=r.getPortal(a),f=new l,h="";if(window.isXT)return f.resolve(null);h=g.urlToObject(g.getAppHref()).query||{};h=h.id||h.appid;if("undefined"===typeof h||""===h)return f.resolve(null);b({getUser:e.getUser(),loadSelfInfo:e.loadSelfInfo(),getItem:e.getItemById(h)}).then(p.hitch(this,
function(b){var d={};d.item=b.getItem;d.item&&d.item.ownerFolder&&d.item.ownerFolder.length&&"/"!==d.item.ownerFolder&&(d.item.folderId=d.item.ownerFolder);"undefined"===typeof d.item.sharing&&d.item.access&&(d.item.sharing={access:d.item.access});d.user=b.getUser;c._setUserRole(b.loadSelfInfo,d);d.currentUser=d.user;d.isAdmin=!1;d.userRole&&(d.userRole.isAdmin()||d.userRole.isCustom()&&d.userRole.canUpdateOrgItems())?(d.isAdmin=!0,d.item.owner!==d.currentUser.name?c._getProfile(d.item,a).then(p.hitch(this,
function(a){d.itemUser=a;d.itemUser.orgId!==d.currentUser.orgId&&(d.isAdmin=!1);f.resolve(d)})):(d.itemUser=d.currentUser,f.resolve(d))):(d.currentUser&&(d.itemUser=d.currentUser),f.resolve(d))}),p.hitch(this,function(a){console.log(a);f.resolve(null)}));return f},_setUserRole:function(a,b){b.userPortalUrl=a.urlKey?a.urlKey+"."+a.customBaseUrl:this.portalUrl;!a||a.code||a.message||(b.organization=a);if(a&&a.user)b.userRole=new n({id:a.user.roleId?a.user.roleId:a.user.role,role:a.user.role}),b._isCustomRole=
b.userRole.isCustom(),b._roleCanShareToGroup=b._isCustomRole&&b.userRole.canShareItemToGroup(),b._roleCanShareToOrg=b._isCustomRole&&b.userRole.canShareItemToOrg(),b._roleCanSharePublic=b._isCustomRole&&b.userRole.canShareItemToPublic(),b._roleCanShare=b._roleCanShareToGroup||b._roleCanShareToOrg||b._roleCanShareToPublic,b._roleCanUpdateItems=b._isCustomRole&&b.userRole.canUpdateOrgItems(),b._roleCanShareOthersItemsToGroup=b._isCustomRole&&b.userRole.canShareOthersItemsToGroup(),b._roleCanShareOthersItemsToOrg=
b._isCustomRole&&b.userRole.canShareOthersItemsToOrg(),b._roleCanShareOthersItemsToPublic=b._isCustomRole&&b.userRole.canShareOthersItemsToPublic(),b._roleCanShareOthersItems=b._isCustomRole&&(b.userRole.canShareOthersItemsToGroup()||b.userRole.canShareOthersItemsToOrg()||b._roleCanShareOthersItemsToPublic),b._orgUserCanSharePublicOrOverride=b.organization&&(!0===b.organization.canSharePublic&&(!b._isCustomRole||b._roleCanSharePublic||b._roleCanShareOthersItemsToPublic)||b.userRole.isAdmin());else return!1},
getItemById:function(a,b){var c=new l,e=m.getStandardPortalUrl(b),e=e+("/sharing/rest/content/items/"+a.id);f({url:e,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c}};return c})},"dijit/form/Textarea":function(){define(["dojo/_base/declare","dojo/dom-style","./_ExpandingTextAreaMixin","./SimpleTextarea"],function(p,f,b,m){return p("dijit.form.Textarea",[m,b],{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",
cols:"",buildRendering:function(){this.inherited(arguments);f.set(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"})}})})},"dijit/form/_ExpandingTextAreaMixin":function(){define("dojo/_base/declare dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/_base/window ../Viewport".split(" "),function(p,f,b,m,l,h,r){b.add("textarea-needs-help-shrinking",function(){var b=h.body(),g=f.create("textarea",
{rows:"5",cols:"20",value:" ",style:{zoom:1,fontSize:"12px",height:"96px",overflow:"hidden",visibility:"hidden",position:"absolute",border:"5px solid white",margin:"0",padding:"0",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"}},b,"last"),e=g.scrollHeight>=g.clientHeight;b.removeChild(g);return e});return p("dijit.form._ExpandingTextAreaMixin",null,{_setValueAttr:function(){this.inherited(arguments);this.resize()},postCreate:function(){this.inherited(arguments);
var b=this.textbox;b.style.overflowY="hidden";this.own(l(b,"focus, resize",m.hitch(this,"_resizeLater")))},startup:function(){this.inherited(arguments);this.own(r.on("resize",m.hitch(this,"_resizeLater")));this._resizeLater()},_onInput:function(b){this.inherited(arguments);this.resize()},_estimateHeight:function(){var b=this.textbox;b.rows=(b.value.match(/\n/g)||[]).length+1},_resizeLater:function(){this.defer("resize")},resize:function(){function f(){var a=!1;""===g.value&&(g.value=" ",a=!0);var b=
g.scrollHeight;a&&(g.value="");return b}var g=this.textbox;"hidden"==g.style.overflowY&&(g.scrollTop=0);if(!this.busyResizing){this.busyResizing=!0;if(f()||g.offsetHeight){var e=f()+Math.max(g.offsetHeight-g.clientHeight,0),c=e+"px";c!=g.style.height&&(g.style.height=c,g.rows=1);if(b("textarea-needs-help-shrinking")){var a=f(),h=g.style.minHeight,l=4,m=g.scrollTop;g.style.minHeight=c;for(g.style.height="auto";0<e;){g.style.minHeight=Math.max(e-l,4)+"px";c=f();a-=c;e-=a;if(a<l)break;a=c;l<<=1}g.style.height=
e+"px";g.style.minHeight=h;g.scrollTop=m}g.style.overflowY=f()>g.clientHeight?"auto":"hidden";"hidden"==g.style.overflowY&&(g.scrollTop=0)}else this._estimateHeight();this.busyResizing=!1}}})})},"dijit/layout/BorderContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/touch ../_WidgetBase ../_Widget ../_TemplatedMixin ./LayoutContainer ./utils".split(" "),function(p,f,
b,m,l,h,r,n,g,e,c,a,u,v,q,k){var d=b("dijit.layout._Splitter",[u,v],{live:!0,templateString:'\x3cdiv class\x3d"dijitSplitter" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse" tabIndex\x3d"0" role\x3d"separator"\x3e\x3cdiv class\x3d"dijitSplitterThumb"\x3e\x3c/div\x3e\x3c/div\x3e',constructor:function(){this._handlers=[]},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=
/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region},buildRendering:function(){this.inherited(arguments);m.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var a=f(this._cookieName);a&&(this.child.domNode.style[this.horizontal?"height":"width"]=a)}},_computeMaxSize:function(){var a=this.horizontal?"h":"w",b=h.getMarginBox(this.child.domNode)[a],c=p.filter(this.container.getChildren(),function(a){return"center"==a.region})[0],a=
h.getContentBox(c.domNode)[a]-10;return Math.min(this.child.maxSize,b+a)},_startDrag:function(a){this.cover||(this.cover=l.place("\x3cdiv class\x3ddijitSplitterCover\x3e\x3c/div\x3e",this.child.domNode,"after"));m.add(this.cover,"dijitSplitterCoverActive");this.fake&&l.destroy(this.fake);(this._resize=this.live)||((this.fake=this.domNode.cloneNode(!0)).removeAttribute("id"),m.add(this.domNode,"dijitSplitterShadow"),l.place(this.fake,this.domNode,"after"));m.add(this.domNode,"dijitSplitterActive dijitSplitter"+
(this.horizontal?"H":"V")+"Active");this.fake&&m.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");var b=this._factor,d=this.horizontal,f=d?"pageY":"pageX",k=a[f],n=this.domNode.style,d=d?"h":"w",q=r.getComputedStyle(this.child.domNode),p=h.getMarginBox(this.child.domNode,q)[d],t=this._computeMaxSize(),u=Math.max(this.child.minSize,h.getPadBorderExtents(this.child.domNode,q)[d]+10),d=this.region,v="top"==d||"bottom"==d?"top":"left",w=parseInt(n[v],10),P=this._resize,
Q=g.hitch(this.container,"_layoutChildren",this.child.id),d=this.ownerDocument;this._handlers=this._handlers.concat([e(d,c.move,this._drag=function(a,c){var d=a[f]-k,e=b*d+p,g=Math.max(Math.min(e,t),u);(P||c)&&Q(g);n[v]=d+w+b*(g-e)+"px"}),e(d,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),e(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();a.preventDefault()}),e(d,c.release,g.hitch(this,"_stopDrag"))]);a.stopPropagation();a.preventDefault()},_onMouse:function(a){a=
"mouseover"==a.type||"mouseenter"==a.type;m.toggle(this.domNode,"dijitSplitterHover",a);m.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",a)},_stopDrag:function(a){try{this.cover&&m.remove(this.cover,"dijitSplitterCoverActive"),this.fake&&l.destroy(this.fake),m.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow"),this._drag(a),this._drag(a,!0)}finally{this._cleanupHandlers(),delete this._drag}this.container.persist&&
f(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365})},_cleanupHandlers:function(){for(var a;a=this._handlers.pop();)a.remove()},_onKeyDown:function(a){this._resize=!0;var b=this.horizontal,c=1;switch(a.keyCode){case b?n.UP_ARROW:n.LEFT_ARROW:c*=-1;case b?n.DOWN_ARROW:n.RIGHT_ARROW:break;default:return}b=h.getMarginSize(this.child.domNode)[b?"h":"w"]+this._factor*c;this.container._layoutChildren(this.child.id,Math.max(Math.min(b,this._computeMaxSize()),this.child.minSize));
a.stopPropagation();a.preventDefault()},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments)}}),w=b("dijit.layout._Gutter",[u,v],{templateString:'\x3cdiv class\x3d"dijitGutter" role\x3d"presentation"\x3e\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region)},buildRendering:function(){this.inherited(arguments);m.add(this.domNode,"dijitGutter"+(this.horizontal?
"H":"V"))}});b=b("dijit.layout.BorderContainer",q,{gutters:!0,liveSplitters:!0,persist:!1,baseClass:"dijitBorderContainer",_splitterClass:d,postMixInProperties:function(){this.gutters||(this.baseClass+="NoGutter");this.inherited(arguments)},_setupChild:function(a){this.inherited(arguments);var b=a.region,c=a.isLeftToRight();"leading"==b&&(b=c?"left":"right");"trailing"==b&&(b=c?"right":"left");b&&"center"!=b&&(a.splitter||this.gutters)&&!a._splitterWidget&&(c=a.splitter?this._splitterClass:w,g.isString(c)&&
(c=g.getObject(c)),c=new c({id:a.id+"_splitter",container:this,child:a,region:b,live:this.liveSplitters}),c.isSplitter=!0,a._splitterWidget=c,b="bottom"==b||b==(this.isLeftToRight()?"right":"left"),l.place(c.domNode,a.domNode,b?"before":"after"),c.startup())},layout:function(){this._layoutChildren()},removeChild:function(a){var b=a._splitterWidget;b&&(b.destroy(),delete a._splitterWidget);this.inherited(arguments)},getChildren:function(){return p.filter(this.inherited(arguments),function(a){return!a.isSplitter})},
getSplitter:function(a){return p.filter(this.getChildren(),function(b){return b.region==a})[0]._splitterWidget},resize:function(a,b){if(!this.cs||!this.pe){var c=this.domNode;this.cs=r.getComputedStyle(c);this.pe=h.getPadExtents(c,this.cs);this.pe.r=r.toPixelValue(c,this.cs.paddingRight);this.pe.b=r.toPixelValue(c,this.cs.paddingBottom);r.set(c,"padding","0px")}this.inherited(arguments)},_layoutChildren:function(a,b){if(this._borderBox&&this._borderBox.h){var c=[];p.forEach(this._getOrderedChildren(),
function(a){c.push(a);a._splitterWidget&&c.push(a._splitterWidget)});k.layoutChildren(this.domNode,{l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h},c,a,b)}},destroyRecursive:function(){p.forEach(this.getChildren(),function(a){var b=a._splitterWidget;b&&b.destroy();delete a._splitterWidget});this.inherited(arguments)}});b.ChildWidgetProperties={splitter:!1,minSize:0,maxSize:Infinity};g.mixin(b.ChildWidgetProperties,q.ChildWidgetProperties);g.extend(a,b.ChildWidgetProperties);
b._Splitter=d;b._Gutter=w;return b})},"dijit/layout/LayoutContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-style dojo/_base/lang ../_WidgetBase ./_LayoutWidget ./utils".split(" "),function(p,f,b,m,l,h,r,n){f=f("dijit.layout.LayoutContainer",r,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){this._started||(p.forEach(this.getChildren(),this._setupChild,this),this.inherited(arguments))},_setupChild:function(f){this.inherited(arguments);
f.region&&b.add(f.domNode,this.baseClass+"Pane")},_getOrderedChildren:function(){var b=p.map(this.getChildren(),function(b,c){return{pane:b,weight:["center"==b.region?Infinity:0,b.layoutPriority,("sidebar"==this.design?1:-1)*(/top|bottom/.test(b.region)?1:-1),c]}},this);b.sort(function(b,c){for(var a=b.weight,e=c.weight,f=0;f<a.length;f++)if(a[f]!=e[f])return a[f]-e[f];return 0});return p.map(b,function(b){return b.pane})},layout:function(){n.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren())},
addChild:function(b,e){this.inherited(arguments);this._started&&this.layout()},removeChild:function(f){this.inherited(arguments);this._started&&this.layout();b.remove(f.domNode,this.baseClass+"Pane");m.set(f.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});m.set(f.domNode,/top|bottom/.test(f.region)?"width":"height","auto")}});f.ChildWidgetProperties={region:"",layoutAlign:"",layoutPriority:0};l.extend(h,f.ChildWidgetProperties);return f})},"jimu/dijit/ShareLink":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/dom-class dojo/on dojo/topic dojo/query jimu/utils jimu/shareUtils dojo/_base/config dojo/cookie dojo/text!./templates/ShareLink.html dojo/string dijit/form/Select dijit/form/NumberTextBox dojo/dom-attr dojo/Deferred esri/request esri/tasks/query esri/tasks/QueryTask esri/symbols/PictureMarkerSymbol esri/graphic esri/layers/GraphicsLayer jimu/dijit/FeaturelayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox dijit/form/TextBox dijit/form/Textarea dijit/form/RadioButton dijit/form/Select dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/SimpleTextarea dijit/form/ValidationTextBox".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I){return p([f,b,m],{templateString:q,declaredClass:"jimu.dijit.ShareLink",bitlyUrl:"http://api.bit.ly/v3/shorten?login\x3darcgisdev\x26apiKey\x3dR_18b3867d45854ba98d9e0e7c20dbf6d3",bitlyUrlSSL:"https://api-ssl.bitly.com/v3/shorten?login\x3darcgisdev\x26apiKey\x3dR_18b3867d45854ba98d9e0e7c20dbf6d3",share:{shareEmailSubject:"",shareTwitterTxt:"",languages:"ar cs da de en el es et fi fr he hr it ja ko lt lv nb nl pl pt-br pt-pt ro ru sr sv th tr zh-cn vi zh-hk zh-tw".split(" "),
DEFAULT_MOBILE_LAYOUT:600},_hasZoomLevelMarkerAdded:!1,_hasMapScaleMarkerAdded:!1,_hasAddMarkerMarkerAdded:!1,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.shareLink;this.nls.symbol=window.jimuNls.common.symbol;this.nls.label=window.jimuNls.common.label;this.nls.WKID=window.jimuNls.common.wkid||"wkid";this.nls.popupTitle=window.jimuNls.shareLink.popupTitle||"Pop-up title";this.nls.zoomLevel=window.jimuNls.shareLink.zoomLevel||"Zoom level";this.share.shareEmailSubject=
this.nls.shareEmailSubject+" ${appTitle} ";this.share.shareTwitterTxt=this.nls.shareEmailSubject+"${appTitle}\n"},postCreate:function(){this.inherited(arguments);this._initUI();this._initMap();this._showSocialMediaLinksByConfig()},constructor:function(a){a&&(this._portalUrl=a.portalUrl,this._isOnline=a.isOnline,this._appTitle=a.appTitle,this._isShowBackBtn=a.isShowBackBtn,this._isShowSocialMediaLinks=a.isShowSocialMediaLinks,this._isSharedToPublic=a.isSharedToPublic,this._isShowFindLocation=a.isShowFindLocation,
this._config=a.config)},startup:function(){this.baseHrefUrl=a.getBaseHrefUrl(this._portalUrl);"undefined"===typeof this.optionSrc&&(this.optionSrc="currentMapExtent");this.updateUrl(null);this._initOptions();this._initOptionsEvent()},destroy:function(){this._cleanMarkerStatus();this._mapClickHandler&&(this._mapClickHandler=null);this.inherited(arguments)},onShareToPublicChanged:function(a){this._isSharedToPublic=a;this.updateUrl(null);this._isSharedToPublic?r.add(this.shareTips,"displaynone"):r.remove(this.shareTips,
"displaynone")},onCloseContainer:function(){this._cleanMarkerStatus()},updateShareLinkOptionsUI:function(a){a&&"undefined"!==typeof a.isShowFindLocation&&this.findLocationRow&&(!1===a.isShowFindLocation?r.add(this.findLocationRow,"displaynone"):!0===a.isShowFindLocation&&r.remove(this.findLocationRow,"displaynone"))},_initMap:function(){window.isBuilder?(this.own(g.subscribe("app/mapLoaded",l.hitch(this,this._onMapLoaded))),this.own(g.subscribe("app/mapChanged",l.hitch(this,this._onMapLoaded)))):
(this.own(g.subscribe("mapLoaded",l.hitch(this,this._onMapLoaded))),this.own(g.subscribe("mapChanged",l.hitch(this,this._onMapLoaded))));window._widgetManager.map&&(this.map=window._widgetManager.map,this._mapEventUpdateUrls(),this._addGraphicsLayer())},_onMapLoaded:function(a){this.map=a;this._mapEventUpdateUrls();this._addGraphicsLayer()},_mapEventUpdateUrls:function(){this.map&&(this.own(n(this.map,"pan-end",l.hitch(this,function(){this._mapEventHandler("pan-end")}))),this.own(n(this.map,"resize",
l.hitch(this,function(){this._mapEventHandler("resize")}))),this.own(n(this.map,"zoom-end",l.hitch(this,function(){this._mapEventHandler("zoom-end")}))))},_mapEventHandler:function(){this._isShareLinkOptionsShow()&&this.updateUrl()},_showSocialMediaLinksByConfig:function(){this._config&&this._config.socialMedias&&("undefined"!==typeof this._config.socialMedias.email&&!1===this._config.socialMedias.email&&r.add(this.emailShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.facebook&&
!1===this._config.socialMedias.facebook&&r.add(this.FacebookShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.twitter&&!1===this._config.socialMedias.twitter&&r.add(this.TwitterShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.googlePlus&&!1===this._config.socialMedias.googlePlus&&r.add(this.googlePlusShare,"displaynone"))},_initUI:function(){this._isShowBackBtn?(t.set(this.backBtn,"title",window.jimuNls.common.back),this.own(n(this.backBtn,"click",l.hitch(this,
this._toggleLinkOptions)))):r.add(this.backBtn,"displaynone");!1===this._isShowSocialMediaLinks&&r.toggle(this.socialNetworkLinks,"displaynone");!0===this._isSharedToPublic&&r.toggle(this.shareTips,"displaynone");this.own(n(this.linkOptions,"click",l.hitch(this,this._toggleLinkOptions)));this._setInputsClicktoSelect(this._linkUrlTextBox);this.own(n(this.googlePlusShare,"click",l.hitch(this,this._toGooglePlus)));this._setInputsClicktoSelect(this._embedCodeTextArea);this._sizeOptions=new d({options:[{label:this.nls.smallSize,
value:"small",selected:!0},{label:this.nls.mediumSize,value:"medium",selected:!1},{label:this.nls.largeSize,value:"large",selected:!1},{label:this.nls.customSize,value:"custom",selected:!1}],"class":"sizeOptionsSelect"});this._sizeOptions.placeAt(this.SizeSelect);this.own(n(this._sizeOptions,"change",function(a){switch(a){case "small":this._widthTextBox.set("value",300);this._heightTextBox.set("value",200);r.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "medium":this._widthTextBox.set("value",
800);this._heightTextBox.set("value",600);r.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "large":this._widthTextBox.set("value",1080);this._heightTextBox.set("value",720);r.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "custom":r.remove(this.CustomSizeContainer,"disable")}}.bind(this)));this._widthTextBox=new w({"class":"sizeTextBox inputsText",value:300,constraints:{pattern:"#",places:0}});this._widthTextBox.placeAt(this.CustomSizeContainer,
1);this.own(n(this._widthTextBox,"change",function(a){200>a?this._widthTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this._heightTextBox=new w({"class":"sizeTextBox inputsText",value:200,constraints:{pattern:"#",places:0}});this._heightTextBox.placeAt(this.CustomSizeContainer,3);this.own(n(this._heightTextBox,"change",function(a){200>a?this._heightTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this.mobileLayout.set("value",this.share.DEFAULT_MOBILE_LAYOUT);
this.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation});this._setInputsClicktoSelect(this.preview)},_setLinkUrl:function(a){this._linkUrlTextBox.set("value",a);t.set(this._linkUrlTextBox.domNode,"data-old",a)},_setEmbedCode:function(a){this._embedCodeTextArea.set("value",'\x3ciframe width\x3d"'+this._widthTextBox.value+'" height\x3d"'+this._heightTextBox.value+'" frameborder\x3d"0" scrolling\x3d"no" allowfullscreen src\x3d"'+a+'"\x3e\x3c/iframe\x3e');t.set(this._embedCodeTextArea.domNode,
"data-old-shortened",a)},_updateEmbedCodeFrameSize:function(a){a=this._embedCodeTextArea.get("value");a=a.replace(/width=\"[0-9]*\"/i,'width\x3d"'+this._widthTextBox.value+'"');a=a.replace(/height=\"[0-9]*\"/i,'height\x3d"'+this._heightTextBox.value+'"');this._embedCodeTextArea.set("value",a)},_initOptions:function(){var a=[],b=this.map.getLevel();"number"===typeof b&&-1!==b?r.remove(this.chooseCenterWithLevelRow,"displaynone"):r.add(this.chooseCenterWithLevelRow,"displaynone");a=[];this.setlanguage_languages.removeOption(this.setlanguage_languages.getOptions());
h.forEach(this.share.languages,function(b){var c={label:b,value:b};c.selected=b===u.locale?!0:!1;a.push(c)});this.setlanguage_languages.addOption(a);b="";try{b=JSON.parse(v("esri_auth")).token}catch(P){console.log("ShareLink can't parse Auth:"+P)}b&&this.authtoken.set("value",b);b=new G({createMapResponse:this.map.webMapResponse,showLayerFromFeatureSet:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1});r.add(b.domNode,"share-layerChooser-dropbox");this.layerChooserFromMapWithDropbox=
new I({layerChooser:b});this.layerChooserFromMapWithDropbox.placeAt(this.queryFeature_layer);this.own(n(this.layerChooserFromMapWithDropbox,"selection-change",l.hitch(this,this._updateQueryFeature_Layer)));"undefined"!==typeof this.map.spatialReference&&"undefined"!==typeof this.map.spatialReference.wkid&&this.addMarker_spatialReference.set("value",this.map.spatialReference.wkid)},_initOptionsEvent:function(){var a=c.has("ie")||c.has("edge")?"change":"KeyUp",b=e(".shareRadios",this.domNode);this.own(n(b,
"change",l.hitch(this,function(a){this.optionSrc=t.get(a.srcElement||a.target,"data-id");this.updateUrl()})));b=e(".shareCheckBoxes",this.domNode);this.own(n(b,"click",l.hitch(this,function(){this.updateUrl()})));this.own(n(this.chooseCenterWithLevel_levels,"change",l.hitch(this,function(){this.updateUrl()})));this.own(n(this.chooseCenterWithScale_scales,"change",l.hitch(this,function(){this.updateUrl()})));this.own(n(this.setlanguage_languages,"change",l.hitch(this,function(){this.updateUrl()})));
this.own(n(this.findLocation_input,a,l.hitch(this,this.updateUrl)));this.own(n(this.queryFeature_field,"change",l.hitch(this,this._updateQueryFeature_Value)));this.own(n(this.queryFeature_value,"change",l.hitch(this,this.updateUrl)));this.own(n(this.mobileLayout,a,l.hitch(this,this.updateUrl)));this.own(n(this.authtoken,a,l.hitch(this,this.updateUrl)));this.own(n(this.addMarker_marker,"click",l.hitch(this,function(a){this._onMarkersClick(a)})));this.own(n(this.addMarker_spatialReference,"change",
l.hitch(this,this.updateUrl)));this.own(n(this.addMarker_title,a,l.hitch(this,this.updateUrl)));this.own(n(this.addMarker_symbolURL,a,l.hitch(this,this.updateUrl)));this.own(n(this.addMarker_label,a,l.hitch(this,this.updateUrl)));this.own(n(this.addMarker_level,"change",l.hitch(this,this.updateUrl)));this.own(n(this.chooseCenterWithLevel_marker,"click",l.hitch(this,function(a){this._onMarkersClick(a)})));this.own(n(this.chooseCenterWithScale_marker,"click",l.hitch(this,function(a){this._onMarkersClick(a)})))},
_onMarkersClick:function(a){this._unselectMarkerBtn();this._selectMarkerBtn(a);this._hidePopup();this._removeGraphicsLayer();this._mapClickHandler=n.once(this.map,"click",l.hitch(this,this._onMapClick))},_onMapClick:function(a){var b=a.mapPoint;this._addGraphicsLayerMarker(a);"chooseCenterWithLevel"===this.optionSrc?this._hasZoomLevelMarkerAdded=!1:"chooseCenterWithScale"===this.optionSrc?this._hasMapScaleMarkerAdded=!1:"addMarker"===this.optionSrc&&(this._hasAddMarkerMarkerAdded=!1);this._unselectMarkerBtn();
this.updateUrl(b);this._showPopup()},_hidePopup:function(){g.publish("ShareLink/onHideContainer")},_showPopup:function(){g.publish("ShareLink/onShowContainer")},_updateResUrls:function(b){"currentMapExtent"===this.optionSrc?(b=this.getMapExtent(this.map),this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"extent",b,!0)):"chooseCenterWithLevel"===this.optionSrc?(!1===this._hasZoomLevelMarkerAdded&&(this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,b),!0),b&&
b.x&&b.y&&(this._hasZoomLevelMarkerAdded=!0)),this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0)):"chooseCenterWithScale"===this.optionSrc?(!1===this._hasMapScaleMarkerAdded&&(this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,b),!0),b&&b.x&&b.y&&(this._hasMapScaleMarkerAdded=!0)),this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"scale",this._getMapScale(),!0)):"findLocation"===this.optionSrc?(b=this.findLocation_input.get("value"),
this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"find",b,!0)):"queryFeature"===this.optionSrc?this._updateUrlByQueryFeatures():"addMarker"===this.optionSrc&&(!1===this._hasAddMarkerMarkerAdded?(this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,b,null,this._getWkid()),!0),this.resultUrl+=",",b&&b.x&&b.y&&(this._hasAddMarkerMarkerAdded=!0,this._lastAddMarkerParamObj=b)):(this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,
this._lastAddMarkerParamObj,null,this._getWkid()),!0),this.resultUrl+=","),this.resultUrl+=encodeURIComponent(this.addMarker_title.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_symbolURL.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_label.get("value")||""),b=this._getMapLevel(),this.resultUrl="number"===typeof b&&-1!==b?a.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0):a.addQueryParamToUrl(this.resultUrl,
"scale",this._getMapScale(),!0));this.resultUrl=a.removeQueryParamFromUrl(this.resultUrl,"mobileBreakPoint",!0);this.resultUrl=a.removeQueryParamFromUrl(this.resultUrl,"locale",!0);this.resultUrl=a.removeQueryParamFromUrl(this.resultUrl,"token",!0);this.overwirteMobileLayout.checked&&(this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"mobileBreakPoint",this.mobileLayout.getValue(),!0));this.setlanguage.checked&&(this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"locale",this.setlanguage_languages.getValue(),
!0));this.auth.checked&&(this.resultUrl=a.addQueryParamToUrl(this.resultUrl,"token",this.authtoken.getValue(),!0))},_updateUrlByQueryFeatures:function(){var b=this._getIdFromLayerChoose()||"",c=this.queryFeature_field.get("value"),d=this.queryFeature_value.get("value");this.resultUrl=a.addQueryParamToUrl(this.baseHrefUrl,"query",b,!0);c&&(this.resultUrl+=",",this.resultUrl+=c,d&&(this.resultUrl+=",",this.resultUrl+=d))},_updateQueryFeature_Layer:function(){this._updateUrlByQueryFeatures();this._updateQueryFeature_Field();
this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Field:function(){var a=this._getFieldsFromLayerChoose(),b=[];this.queryFeature_field.removeOption(this.queryFeature_field.getOptions());h.forEach(a,l.hitch(this,function(a){-1<"esriFieldTypeString esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble".split(" ").indexOf(a.type)&&b.push({label:a.name,value:a.name})}));this.queryFeature_field.addOption(b);this._updateUrlByQueryFeatures();
this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Value:function(){var a=[],b=this.queryFeature_field.get("value");a.push(b);this._query(a,this._getUrlFromLayerChoose(),this.map).then(l.hitch(this,function(a){var c=[],c=this._getQueryedValues(b,a);this.queryFeature_value.removeOption(this.queryFeature_value.getOptions());this.queryFeature_value.addOption(c);this._updateUrlByQueryFeatures();this.updateUrl()}))},_getIdFromLayerChoose:function(){var a=null,b=this.layerChooserFromMapWithDropbox.getSelectedItem();
b&&b.layerInfo&&b.layerInfo.id&&(a=b.layerInfo.id);return a},_getFieldsFromLayerChoose:function(){var a=[],b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.layerInfo&&b.layerInfo.layerObject&&b.layerInfo.layerObject.fields&&(a=b.layerInfo.layerObject.fields);return a},_getUrlFromLayerChoose:function(){var a="",b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.url&&(a=b.url);return a},_updateLinkOptionsUI:function(){e(".optionsMore",this.domNode).style("display","none");e("."+
this.optionSrc+"_optionsMore",this.domNode).style("display","block");this.overwirteMobileLayout.checked&&e(".share-options-overwirteMobileLayout_optionsMore",this.domNode).style("display","block");this.setlanguage.checked&&e(".share-options-language_optionsMore",this.domNode).style("display","block");this.auth.checked&&e(".share-options-auth_optionsMore",this.domNode).style("display","block")},_fixUrlIfIsOnline:function(a){if(this._isOnline&&this._isSharedToPublic){var b="",b=window.isBuilder?window.top.location.protocol:
window.location.protocol,c=this._getUrlQueryString(a);a=this._getOnlinePublicUrl(a);a=b+"//"+a+"/apps/webappviewer/index.html"+c}return a},updateUrl:function(a){this._updateResUrls(a);this._updateLinkOptionsUI();this.preview.set("value",this._fixUrlIfIsOnline(this.resultUrl));null===a&&this._generateShortenUrl()},_generateShortenUrl:function(){var a=this.preview.get("value");try{this.isUseShortenUrl()?this.shortenUrl(a,this.bitlyUrl,this.bitlyUrlSSL).then(l.hitch(this,function(a){this._useShortenUrl(a)}),
l.hitch(this,function(b){this._useLengthenUrl(a,b)})):this._useLengthenUrl(a)}catch(L){console.error(L)}},_useShortenUrl:function(a){this.shortenedUrl=a;this._setLinkUrl(a);this._setEmbedCode(a)},_useLengthenUrl:function(a){a=a||"";this._setLinkUrl(a);this._setEmbedCode(a)},_toFacebook:function(){var a="http://www.facebook.com/sharer/sharer.php?s\x3d100\x26u\x3d"+encodeURIComponent(this._linkUrlTextBox.get("value"))+"\x26t\x3d"+encodeURIComponent(c.stripHTML(this.socialNetworkTitle(this._appTitle)));
window.open(a,"_blank")},_toTwitter:function(){var a=k.substitute(this.share.shareTwitterTxt,{appTitle:c.stripHTML(this._appTitle)}),b=this._linkUrlTextBox.get("value");window.open("http://twitter.com/home?status\x3d"+encodeURIComponent(a+b+"\n@ArcGISOnline"),"_blank")},_toEmail:function(){var a="mailto:?subject\x3d"+k.substitute(this.share.shareEmailSubject,{appTitle:c.stripHTML(this._appTitle)}),b=this.preview.get("value"),a=a+("\x26body\x3d"+encodeURIComponent(this.nls.shareEmailTxt1)+"%0D%0A%0D%0A"+
c.stripHTML(this._appTitle)),a=a+("%0D%0A"+encodeURIComponent(b)),a=a+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt2)),a=a+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt3));window.top.location.href=a},_toGooglePlus:function(){var a=this._linkUrlTextBox.get("value"),a="http://plus.google.com/share?url\x3d"+encodeURIComponent(a);window.open(a,"_blank")},_toggleLinkOptions:function(){var a=e(".shareOptionsWrapper",this.domNode.parentNode||this.domNode.parentElement),b=e(".shareUrlsWrapper",
this.domNode),c=e(".shareLinkOptionsWrapper",this.domNode);this._isShareLinkOptionsShow()?(g.publish("ShareLink/onHideLinkOptions"),this._cleanMarkerStatus(),this._generateShortenUrl()):g.publish("ShareLink/onShowLinkOptions");a&&a[0]&&r.toggle(a[0],"displaynone");r.toggle(b[0],"displaynone");r.toggle(c[0],"displaynone")},_moreOptionsExpandCollapse:function(){r.toggle(this.MoreOptionsContainer,"displaynone");r.toggle(this.MoreOptionsIcon,"rotate")},_setInputsClicktoSelect:function(a){t.set(a,"onclick",
"this.select()");t.set(a,"onmouseup","return false;")},isUseShortenUrl:function(){return location.hostname.endWith("esri.com")||location.hostname.endWith("arcgis.com")?!0:!1},shortenUrl:function(a,b,c){var d=new x;"https:"===location.protocol&&(b=c);b+="\x26longUrl\x3d"+escape(a)+"\x26format\x3djson";A({url:b,handleAs:"json",callbackParamName:"callback"}).then(l.hitch(this,function(a){a&&200===a.status_code&&a.data&&a.data.url&&0<a.data.url.length?d.resolve(a.data.url):d.reject(a)}),l.hitch(this,
function(a){console.log("can't fetch shortenUrl "+a);d.reject(a)}));return d},socialNetworkTitle:function(a){100<a.length&&(a=a.substring(0,97)+"...");return a},getMapExtent:function(a){a=a.extent;return null!==a?this._roundValue(a.xmin,1E4)+","+this._roundValue(a.ymin,1E4)+","+this._roundValue(a.xmax,1E4)+","+this._roundValue(a.ymax,1E4)+","+a.spatialReference.wkid:""},_roundValue:function(a,b){return Math.round(a*b)/b},getMapCenter:function(a,b,c,d){c=c?c:",";var e=null;b&&b.x&&b.y?e=b:a.extent.getCenter()&&
(e=a.extent.getCenter());a=d||e.spatialReference.wkid;return null!==e?this._roundValue(e.x,1E4)+c+this._roundValue(e.y,1E4)+c+a:""},_getMapLevel:function(){return this.map.getLevel()},_getMapScale:function(){return this.map.getScale()},_getWkid:function(){return this.addMarker_spatialReference.get("value")||""},_query:function(a,b,c){var d=new y;d.where="1\x3d1";d.outSpatialReference=c.spatialReference;d.outFields=a;return(new z(b)).execute(d)},_getQueryedValues:function(a,b){var c=[];h.forEach(b.features,
l.hitch(this,function(b){b=b.attributes[a]+"";c.push({label:b,value:b})}));return c},_addGraphicsLayer:function(){window.isBuilder||"undefined"!==typeof this._graphicsLayer||(this._graphicsLayer=new E,this.map.addLayer(this._graphicsLayer))},_removeGraphicsLayer:function(){window.isBuilder||"undefined"===typeof this._graphicsLayer||(this._graphicsLayer.remove(this._markerGraphic),this._markerGraphic=null)},_addGraphicsLayerMarker:function(a){window.isBuilder||"undefined"===typeof this._graphicsLayer||
(this._markerGraphic=this._getMarkerGraphic(a.mapPoint),this._graphicsLayer.add(this._markerGraphic))},_getMarkerGraphic:function(a){var b=new C(require.toUrl("jimu")+"/images/EsriBluePinCircle26.png",26,26);b.setOffset(0,12);return new B(a,b)},_unselectMarkerBtn:function(){for(var a=e(".markers",this.domNode),b=0,c=a.length;b<c;b++)r.remove(a[b],"selected")},_selectMarkerBtn:function(a){r.add(a.srcElement||a.target,"selected")},_cleanMarkerStatus:function(){this._mapClickHandler&&this._mapClickHandler.remove&&
this._mapClickHandler.remove();this._unselectMarkerBtn();this._removeGraphicsLayer()},_isShareLinkOptionsShow:function(){var a=e(".shareLinkOptionsWrapper",this.domNode);return!r.contains(a[0],"displaynone")},_getUrlQueryString:function(a){var b="";-1!==a.indexOf("?")&&(b=a.substring(a.indexOf("?")));return b},_getOnlinePublicUrl:function(){var a="www.arcgis.com",b=this._portalUrl;b&&"string"===typeof b&&(-1<b.indexOf("devext.arcgis.com")?a="devext.arcgis.com":-1<b.indexOf("qaext.arcgis.com")&&(a=
"qaext.arcgis.com"));return a}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare","dojo/Deferred","dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(p,f,b,m,l){return p([l],{baseClass:"jimu-featurelayer-chooser-from-map",declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,postMixInProperties:function(){this.inherited(arguments);this.ignoredFeaturelayerIds||
(this.ignoredFeaturelayerIds=[]);this.basicFilter=m.hitch(this,this.basicFilter);this.filter=l.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable)},postCreate:function(){this.inherited(arguments);b.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},basicFilter:function(b){var h=new f;0<=this.ignoredFeaturelayerIds.indexOf(b.id)?h.resolve(!1):this.onlyShowVisible&&"Table"!==b.getLayerType()?h.resolve(b.isShowInMap()):h.resolve(!0);return h},getHandledItem:function(b){var f=
this.inherited(arguments),h=b&&b.layerInfo,h=h&&h.layerObject;f.url=h&&h.url||"";return f}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/on dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w){var t=p([f,b,m,l],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);u.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new w({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=a.hitch(this,this.basicFilter);this.filter=t.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&
this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(a){var b=new n;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new n;a.resolve(!0);return a},getSelectedItems:function(){var b=this.tree.getSelectedItems();return v.map(b,a.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var b=this.tree.getAllItems(),c=[];v.forEach(b,a.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),c.push(a))}));return c},
getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(b){this.createMapResponse=b;d.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(a.hitch(this,function(b){this.layerInfosObj=b;this.own(h(this.layerInfosObj,"layerInfosChanged",a.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(h(this.layerInfosObj,"layerInfosIsShowInMapChanged",a.hitch(this,
this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(b){this._clear();u.setStyle(this.errorTipSection,"display","block");var c=b.getLayerInfoArray(),c=c.concat(b.getTableInfoArray());0!==c.length&&(u.setStyle(this.errorTipSection,"display","none"),v.forEach(c,a.hitch(this,
function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(b){b&&b.getLayerObject().then(a.hitch(this,function(){this._addItem("root",b)}),a.hitch(this,function(a){console.error(a)}))},_clear:function(){var b=this._store.query({parent:"root"});v.forEach(b,a.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(b,d){var e=null,f=d.getLayerType(),g=this.filter(d);c({layerType:f,valid:g}).then(a.hitch(this,function(f){if(f.valid){var g=a.hitch(this,function(a,
c){this._id++;e={name:d.title||"",parent:b,layerInfo:d,type:f.layerType,layerClass:d.layerObject.declaredClass,id:this._id.toString(),isLeaf:a,hasChildren:c};this._store.add(e)}),k=d.getSubLayers(),h=0===k.length;h?g(h,!1):(k=v.map(k,a.hitch(this,function(a){return this.filter(a)})),c(k).then(a.hitch(this,function(a){(a=v.some(a,function(a){return a}))&&g(h,a)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var b=this._getRootItem(),
b=new r({data:[b],getChildren:function(a){return this.query({parent:a.id})}});this._store=new g(b);b=new e({store:this._store,query:{id:"root"},mayHaveChildren:a.hitch(this,this._mayHaveChildren)});this.tree=new k({multiple:this.multiple,model:b,showRoot:!1,isLeafItem:a.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:a.hitch(this,function(a,b){"root"!==a.id&&this._onTreeOpen(a,b)}),onClick:a.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,b,c)}),getIconStyle:a.hitch(this,
function(a,b){var c=null;if(!a||"root"===a.id)return null;var d={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),f=this._getIconImageName(a,b);f&&(d.backgroundImage="url("+e+"/css/images/"+f+")",c=d);return c})});u.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconImageName:function(a,
b){var c="";if("ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type)c=b?"mapserver_open.png":"mapserver_close.png";else if("GroupLayer"===a.type)c=b?"group_layer2.png":"group_layer1.png";else if("FeatureLayer"===a.type){var d=q.getTypeByGeometryType(a.layerInfo.layerObject.geometryType);"point"===d?c="point_layer1.png":"polyline"===d?c="line_layer1.png":"polygon"===d&&(c="polygon_layer1.png")}else c="Table"===a.type?"table.png":"ArcGISImageServiceLayer"===a.type||"ArcGISImageServiceVectorLayer"===
a.type?"image_layer.png":b?"mapserver_open.png":"mapserver_close.png";return c},_onTreeOpen:function(b,d){if("root"!==b.id){var e=[],f=[],e=b.layerInfo.getSubLayers();b.checked||(this.shelter.show(),f=v.map(e,a.hitch(this,function(a){return a.getLayerObject()})),c(f).then(a.hitch(this,function(){this.domNode&&(v.forEach(e,a.hitch(this,function(a){this._addItem(b.id,a)})),b.checked=!0,this.shelter.hide())}),a.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,
b,c){},destroy:function(){this.shelter&&this.shelter.destroy();this.tree&&this.tree.destroy();this.shelter=null;this.tree.destroy();this.inherited(arguments)}});t.createFilterByLayerType=function(b){a.isArrayLike(b)||(b=[]);return function(a){var d=new n;if(0===b.length)d.resolve(!0);else{var e=[];a.traversal(function(a){e.push(a.getLayerType())});c(e).then(function(a){for(var c=0;c<a.length;c++)for(var e=0;e<b.length;e++)if(a[c]===b[e]){d.resolve(!0);return}d.resolve(!1)},function(a){console.error(a);
d.reject(a)})}return d}};t.createFeaturelayerFilter=function(a,b,d){var e=["point","polyline","polygon"];a&&0<a.length?(a=v.filter(a,function(a){return 0<=e.indexOf(a)}),0===a.length&&(a=e)):a=e;return function(e){var f=new n,g=e.getLayerType();e=e.getLayerObject();c({layerType:g,layerObject:e}).then(function(c){var e=c.layerType;c=c.layerObject;"ArcGISDynamicMapServiceLayer"===e?f.resolve(!0):"ArcGISTiledMapServiceLayer"===e?f.resolve(!0):"GroupLayer"===e?f.resolve(!0):"FeatureCollection"===e?f.resolve(!0):
"FeatureLayer"===e?(e=q.getTypeByGeometryType(c.geometryType),e=0<=v.indexOf(a,e),c.url?(c=q.isFeaturelayerUrlSupportQuery(c.url,c.capabilities),f.resolve(e&&c)):f.resolve(b&&e)):"Table"===e?(c=q.isFeaturelayerUrlSupportQuery(c.url,c.capabilities),f.resolve(d&&c)):f.resolve(!1)},function(a){console.log(a);f.reject(a)});return f}};t.createImageServiceLayerFilter=function(a){return function(b){var d=new n,e=b.getLayerType();b=b.getLayerObject();c({layerType:e,layerObject:b}).then(function(b){var c=
b.layerType;"ArcGISImageServiceLayer"===c||"ArcGISImageServiceVectorLayer"===c?a?q.isImageServiceSupportQuery(b.layerObject.capabilities)?d.resolve(!0):d.resolve(!1):d.resolve(!0):d.resolve(!1)},function(a){console.log(a);d.reject(a)});return d}};t.createQueryableLayerFilter=function(){var a=t.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0),b=t.createImageServiceLayerFilter(!0);return t.orCombineFilters([a,b])};t.andCombineFilters=function(a){return t._combineFilters(a,!0)};t.orCombineFilters=
function(a){return t._combineFilters(a,!1)};t._combineFilters=function(a,b){return function(d){var e=new n,f=v.map(a,function(a){return a(d)});c(f).then(function(a){var c=!1,c=b?v.every(a,function(a){return a}):v.some(a,function(a){return a});e.resolve(c)},function(a){console.error(a);e.reject(a)});return e}};return t})},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../when","../_base/array"],function(p,f,b,m){p=function(l){function h(c,a){var f=l[c];f&&(l[c]=function(g){var h;
"put"===c&&(h=l.getIdentity(g));if(e)return f.apply(this,arguments);e=!0;try{var k=f.apply(this,arguments);b(k,function(b){a("object"==typeof b&&b||g,h)});return k}finally{e=!1}})}var p=[],n=0;l=f.delegate(l);l.notify=function(b,a){n++;for(var c=p.slice(),e=0,f=c.length;e<f;e++)c[e](b,a)};var g=l.query;l.query=function(c,a){a=a||{};var e=g.apply(this,arguments);if(e&&e.forEach){var h=f.mixin({},a);delete h.start;delete h.count;var q=l.queryEngine&&l.queryEngine(c,h),k=n,d=[],r;e.observe=function(c,
f){1==d.push(c)&&p.push(r=function(c,g){b(e,function(b){var e=b.length!=a.count,h,p;if(++k!=n)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var t,r=-1,u=-1;if(void 0!==g){var v=[].concat(b);q&&!c&&(v=q(b));h=0;for(p=b.length;h<p;h++){var w=b[h];if(l.getIdentity(w)==g&&!(0>v.indexOf(w))){t=w;r=h;!q&&c||b.splice(h,1);break}}}q?c&&(q.matches?q.matches(c):q([c]).length)&&(h=-1<r?r:b.length,b.splice(h,0,c),u=m.indexOf(q(b),c),b.splice(h,1),a.start&&0==
u||!e&&u==b.length?u=-1:b.splice(u,0,c)):c&&(void 0!==g?u=r:a.start||(u=l.defaultIndex||0,b.splice(u,0,c)));if((-1<r||-1<u)&&(f||!q||r!=u))for(e=d.slice(),h=0;b=e[h];h++)b(c||t,r,u)})});var g={};g.remove=g.cancel=function(){var a=m.indexOf(d,c);-1<a&&(d.splice(a,1),d.length||p.splice(m.indexOf(p,r),1))};return g}}return e};var e;h("put",function(b,a){l.notify(b,a)});h("add",function(b){l.notify(b)});h("remove",function(b){l.notify(void 0,b)});return l};f.setObject("dojo.store.Observable",p);return p})},
"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(p,f,b,m,l,h,r){return b("dijit.tree.ObjectStoreModel",r,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(b){l.mixin(this,b);this.childrenCache={}},getRoot:function(b,f){if(this.root)b(this.root);else{var e=this.store.query(this.query);e.then&&this.own(e);h(e,l.hitch(this,function(c){if(1!=
c.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+c.length+" items, but must return exactly one");this.root=c[0];b(this.root);e.observe&&e.observe(l.hitch(this,function(a){this.onChange(a)}),!0)}),f)}},mayHaveChildren:function(){return!0},getChildren:function(b,f,e){var c=this.store.getIdentity(b);if(this.childrenCache[c])h(this.childrenCache[c],f,e);else{var a=this.childrenCache[c]=this.store.getChildren(b);a.then&&this.own(a);a.observe&&this.own(a.observe(l.hitch(this,function(c,
e,f){this.onChange(c);e!=f&&h(a,l.hitch(this,"onChildrenChange",b))}),!0));h(a,f,e)}},isItem:function(){return!0},getIdentity:function(b){return this.store.getIdentity(b)},getLabel:function(b){return b[this.labelAttr]},newItem:function(b,f,e,c){return this.store.put(b,{parent:f,before:c})},pasteItem:function(b,f,e,c,a,h){var g=new m;if(f===e&&!c&&!h)return g.resolve(!0),g;f&&!c?this.getChildren(f,l.hitch(this,function(a){a=[].concat(a);var c=p.indexOf(a,b);a.splice(c,1);this.onChildrenChange(f,a);
g.resolve(this.store.put(b,{overwrite:!0,parent:e,oldParent:f,before:h}))})):g.resolve(this.store.put(b,{overwrite:!0,parent:e,oldParent:f,before:h}));return g},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){var k=p([v._TreeNode,a],{templateString:m,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=h.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=h.toDom('\x3cinput type\x3d"checkbox" /\x3e');h.addClass(this.checkNode,"jimu-tree-check-node");h.place(this.checkNode,this.contentNode,
"first");this.own(c(this.checkNode,"click",l.hitch(this,this._onClick)));this.isLeaf?this.groupId?h.setStyle(this.checkNode,"display","none"):h.setStyle(this.checkNode,"display","inline"):h.setStyle(this.checkNode,"display","none");this.isLeaf?h.addClass(this.domNode,"jimu-tree-leaf-node"):h.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&(this.checkNode.checked=!0,h.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=
!1,h.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(l.hitch(this,function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;
this.inherited(arguments)}});return p([v,a],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+q.getRandomString()},postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-tree");this.own(e.before(this,"onClick",l.hitch(this,this._jimuBeforeClick)));this.rootLoadingIndicator&&h.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0},removeItem:function(a){this.model.store.remove(a)},
getAllItems:function(){var a=this.getAllTreeNodeWidgets();return r.map(a,l.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=r.filter(a,l.hitch(this,function(a){return a.checkNode.checked}));return r.map(a,l.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var b=this.getAllTreeNodeWidgets(),b=r.map(b,l.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return r.filter(b,
l.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),c=0;c<b.length;c++){var d=u.byNode(b[c]);if(d.item.id.toString()===a.toString())return d}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return r.filter(a,l.hitch(this,function(a){return a.isLeaf}))},
getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return r.map(a,l.hitch(this,function(a){return u.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return g(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);this.multiple||(a.groupId=this.uniqueId);return new k(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",
{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,b,c){b.isLeaf&&(h.hasClass(c.target||c.srcElement,"jimu-tree-check-node")||(this.multiple?b.toggleSelect():this.selectNodeWidget(b)));return arguments},_onCheckNodeClick:function(a,b,c){!this.multiple&&b&&this.unselectAllLeafNodeWidgets();n.stop(c);this.focusNode(a);setTimeout(l.hitch(this,function(){b?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,
a,c)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();r.forEach(a,l.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J,L,P,Q,H,K,V){function S(a){return k.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var ba=m("dijit._TreeNode",[B,E,G,I,J],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);u("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:P,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";e.set(this.domNode,
"backgroundPosition",b+" 0px");e.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);p.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,c){var d="_"+b+"Class";b+="Node";var f=this[d];this[d]=this.tree["get"+c+"Class"](a,this.isExpanded);n.replace(this[b],this[d]||"",f||"");e.set(this[b],this.tree["get"+c+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;n.toggle(this.domNode,"dijitTreeIsRoot",a);n.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;n.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return S(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");n.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var b=a.wipeIn({node:this.containerNode,duration:C.defaultDuration}),c=this._expandDeferred=new l(function(){b.stop()});f.after(b,"onEnd",function(){c.resolve(!0)},!0);b.play();return S(c)},collapse:function(){if(this._collapseDeferred)return S(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");n.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var b=a.wipeOut({node:this.containerNode,duration:C.defaultDuration}),c=this._collapseDeferred=new l(function(){b.stop()});f.after(b,"onEnd",
function(){c.resolve(!0)},!0);b.play();return S(c)},indent:0,setChildItems:function(a){var b=this.tree,c=b.model,d=[],e=b.focusedChild,f=this.getChildren();p.forEach(f,function(a){G.prototype.removeChild.call(this,a)},this);this.defer(function(){p.forEach(f,function(a){if(!a._destroyed&&!a.getParent()){var d=function(a){var e=c.getIdentity(a.item),f=b._itemNodesMap[e];1==f.length?delete b._itemNodesMap[e]:(e=p.indexOf(f,a),-1!=e&&f.splice(e,1));p.forEach(a.getChildren(),d)};b.dndController.removeTreeNode(a);
d(a);if(b.persist){var f=p.map(a.getTreePath(),function(a){return b.model.getIdentity(a)}).join("/"),g;for(g in b._openedNodes)g.substr(0,f.length)==f&&delete b._openedNodes[g];b._saveExpandedNodes()}b.lastFocusedChild&&!r.isDescendant(b.lastFocusedChild.domNode,b.domNode)&&delete b.lastFocusedChild;e&&!r.isDescendant(e.domNode,b.domNode)&&b.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,p.forEach(a,function(a){var e=c.getIdentity(a),f=b._itemNodesMap[e],
g;if(f)for(var k=0;k<f.length;k++)if(f[k]&&!f[k].getParent()){g=f[k];g.set("indent",this.indent+1);break}g||(g=this.tree._createTreeNode({item:a,tree:b,isExpandable:c.mayHaveChildren(a),label:b.getLabel(a),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(a),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),f?f.push(g):b._itemNodesMap[e]=[g]);this.addChild(g);(this.tree.autoExpand||this.tree._state(g))&&d.push(b._expandNode(g))},this),p.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=h(d);this.tree._startPaint(a);return S(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());p.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");n.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){y.focus(this.focusNode)}});u("dojo-bidi")&&ba.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),p.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var N=m("dijit.Tree",[B,L,E,J],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:Q,persist:!1,autoExpand:!1,dndController:V,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){w.publish(this.id,k.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new l;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(d(this.containerNode,
d.selector(".dijitTreeNode",t.enter),function(b){a._onNodeMouseEnter(z.byNode(this),b)}),d(this.containerNode,d.selector(".dijitTreeNode",t.leave),function(b){a._onNodeMouseLeave(z.byNode(this),b)}),d(this.containerNode,d.selector(".dijitTreeRow",A.press),function(b){a._onNodePress(z.getEnclosingWidget(this),b)}),d(this.containerNode,d.selector(".dijitTreeRow",A),function(b){a._onClick(z.getEnclosingWidget(this),b)}),d(this.containerNode,d.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(z.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(f.after(this.model,"onChange",k.hitch(this,"_onItemChange"),!0),f.after(this.model,"onChildrenChange",k.hitch(this,"_onItemChildrenChange"),!0),f.after(this.model,"onDelete",k.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){k.isString(this.dndController)&&(this.dndController=k.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=S(this.pendingCommandsPromise);this.onLoadDeferred.then(k.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;v.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=k.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=k.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new K(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(k.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(k.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),k.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=k.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(k.hitch(this,function(){var c=
p.map(a,function(a){return!a||k.isString(a)?a:b.model.getIdentity(a)}),d=[];p.forEach(c,function(a){d=d.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",d)}))},_setPathAttr:function(a){return a.length?S(this.set("paths",[a]).then(function(a){return a[0]})):S(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function b(a,d){var e=a.shift(),f=p.filter(d,function(a){return a.getIdentity()==e})[0];if(f)return a.length?c._expandNode(f).then(function(){return b(a,
f.getChildren())}):f;throw new N.PathError("Could not expand path at "+e);}var c=this;return S(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return h(p.map(a,function(a){a=p.map(a,function(a){return a&&k.isObject(a)?c.model.getIdentity(a):a});if(a.length)return b(a,[c.rootNode]);throw new N.PathError("Empty path");}))}).then(function(a){c.set("selectedNodes",a);return c.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(c){return b._expandNode(c).then(function(){var b=p.filter(c.getChildren()||[],function(a){return a.isExpandable});return h(p.map(b,a))})}var b=this;return S(a(this.rootNode))},collapseAll:function(){function a(c){var d=p.filter(c.getChildren()||[],function(a){return a.isExpandable}),d=h(p.map(d,a));return!c.isExpanded||c==b.rootNode&&!b.showRoot?d:d.then(function(){return b._collapseNode(c)})}var b=this;return S(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){var c=this._getNext(b);c&&c.isTreeNode&&this.focusNode(c)},_onUpArrow:function(a,b){var c=b.getPreviousSibling();if(c)for(b=c;b.isExpandable&&
b.isExpanded&&b.hasChildren();)c=b.getChildren(),b=c[c.length-1];else if(c=b.getParent(),this.showRoot||c!==this.rootNode)b=c;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){if(b.isExpandable&&b.isExpanded)this._collapseNode(b);else{var c=b.getParent();c&&c.isTreeNode&&(this.showRoot||c!==this.rootNode)&&this.focusNode(c)}},focusLastChild:function(){var a=
this._getLast();a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,
b){return r.isDescendant(a,b.expandoNode)||r.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,c,d){var e=this.isExpandoNode(b.target,a);a.isExpandable&&(c||e)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[d](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,
"onDblClick")},_onExpandoClick:function(a){a=a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){v.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){v.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","",
"2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,c=a.item,d=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new l,b.getChildren(c,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},
function(b){console.error(d,": error loading "+a.label+" children: ",b);a._loadDeferred.reject(b)}));b=a._loadDeferred.then(k.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){var b=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=b},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var c=this.getLabel(a),
d=this.getTooltip(a);p.forEach(b,function(b){b.set({item:a,label:c,tooltip:d});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){var c=this.model.getIdentity(a);(c=this._itemNodesMap[c])&&p.forEach(c,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];b&&(p.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!r.isDescendant(this.lastFocusedChild.domNode,
this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!r.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=b(this.cookieName);a&&p.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,b){if(!this.persist)return!1;var c=p.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");
if(1===arguments.length)return this._openedNodes[c];b?this._openedNodes[c]=!0:delete this._openedNodes[c];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],c;for(c in this._openedNodes)a.push(c);b(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!k.isString(this.dndController)&&this.dndController.destroy();
this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&g.setMarginBox(this.domNode,a);this._nodePixelIndent=g.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(k.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),
delete this._adjustWidthsTimer);var b=k.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});x(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new ba(a)},
focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});u("dojo-bidi")&&N.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});N.PathError=c("TreePathError");N._TreeNode=ba;return N})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(p,f,b,m){return b("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],
newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(b){m.mixin(this,b);this.connects=[];b=this.store;if(!b.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");b.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([f.after(b,"onNew",m.hitch(this,"onNewItem"),!0),f.after(b,"onDelete",m.hitch(this,"onDeleteItem"),!0),f.after(b,"onSet",m.hitch(this,"onSetItem"),
!0)]))},destroy:function(){for(var b;b=this.connects.pop();)b.remove()},getRoot:function(b,f){this.root?b(this.root):this.store.fetch({query:this.query,onComplete:m.hitch(this,function(f){if(1!=f.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+f.length+" items, but must return exactly one");this.root=f[0];b(this.root)}),onError:f})},mayHaveChildren:function(b){return p.some(this.childrenAttrs,function(f){return this.store.hasAttribute(b,f)},this)},getChildren:function(b,f,r){var h=
this.store;if(h.isItemLoaded(b)){for(var g=[],e=0;e<this.childrenAttrs.length;e++)var c=h.getValues(b,this.childrenAttrs[e]),g=g.concat(c);var a=0;this.deferItemLoadingUntilExpand||p.forEach(g,function(b){h.isItemLoaded(b)||a++});0==a?f(g):p.forEach(g,function(b,c){h.isItemLoaded(b)||h.loadItem({item:b,onItem:function(b){g[c]=b;0==--a&&f(g)},onError:r})})}else{var l=m.hitch(this,arguments.callee);h.loadItem({item:b,onItem:function(a){l(a,f,r)},onError:r})}},isItem:function(b){return this.store.isItem(b)},
fetchItemByIdentity:function(b){this.store.fetchItemByIdentity(b)},getIdentity:function(b){return this.store.getIdentity(b)},getLabel:function(b){return this.labelAttr?this.store.getValue(b,this.labelAttr):this.store.getLabel(b)},newItem:function(b,f,m){var h={parent:f,attribute:this.childrenAttrs[0]},g;this.newItemIdAttr&&b[this.newItemIdAttr]?this.fetchItemByIdentity({identity:b[this.newItemIdAttr],scope:this,onItem:function(e){e?this.pasteItem(e,null,f,!0,m):(g=this.store.newItem(b,h))&&void 0!=
m&&this.pasteItem(g,f,f,!1,m)}}):(g=this.store.newItem(b,h))&&void 0!=m&&this.pasteItem(g,f,f,!1,m)},pasteItem:function(b,f,m,n,g){var e=this.store,c=this.childrenAttrs[0];f&&p.forEach(this.childrenAttrs,function(a){if(e.containsValue(f,a,b)){if(!n){var g=p.filter(e.getValues(f,a),function(a){return a!=b});e.setValues(f,a,g)}c=a}});if(m)if("number"==typeof g){var a=e.getValues(m,c).slice();a.splice(g,0,b);e.setValues(m,c,a)}else e.setValues(m,c,e.getValues(m,c).concat(b))},onChange:function(){},onChildrenChange:function(){},
onDelete:function(){},onNewItem:function(b,f){f&&this.getChildren(f.item,m.hitch(this,function(b){this.onChildrenChange(f.item,b)}))},onDeleteItem:function(b){this.onDelete(b)},onSetItem:function(b,f){if(-1!=p.indexOf(this.childrenAttrs,f))this.getChildren(b,m.hitch(this,function(f){this.onChildrenChange(b,f)}));else this.onChange(b)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(p,f,
b,m,l){return f("dijit.tree.ForestStoreModel",l,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(b){this.root={store:this,root:!0,id:b.rootId,label:b.rootLabel,children:b.rootChildren}},mayHaveChildren:function(b){return b===this.root||this.inherited(arguments)},getChildren:function(b,f,l){b===this.root?this.root.children?f(this.root.children):this.store.fetch({query:this.query,onComplete:m.hitch(this,function(b){this.root.children=b;f(b)}),onError:l}):this.inherited(arguments)},
isItem:function(b){return b===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(f){if(f.identity==this.root.id){var h=f.scope||b.global;f.onItem&&f.onItem.call(h,this.root)}else this.inherited(arguments)},getIdentity:function(b){return b===this.root?this.root.id:this.inherited(arguments)},getLabel:function(b){return b===this.root?this.root.label:this.inherited(arguments)},newItem:function(b,f,l){return f===this.root?(this.onNewRootItem(b),this.store.newItem(b)):this.inherited(arguments)},
onNewRootItem:function(){},pasteItem:function(b,f,l,g,e){if(f===this.root&&!g)this.onLeaveRoot(b);this.inherited(arguments,[b,f===this.root?null:f,l===this.root?null:l,g,e]);if(l===this.root)this.onAddToRoot(b)},onAddToRoot:function(b){console.log(this,": item ",b," added to root")},onLeaveRoot:function(b){console.log(this,": item ",b," removed from root")},_requeryTop:function(){var b=this.root.children||[];this.store.fetch({query:this.query,onComplete:m.hitch(this,function(f){this.root.children=
f;if(b.length!=f.length||p.some(b,function(b,g){return f[g]!=b}))this.onChildrenChange(this.root,f)})})},onNewItem:function(b,f){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(b){-1!=p.indexOf(this.root.children,b)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(b,f,l,g){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c){return f("dijit.tree._dndSelector",c,{constructor:function(){this.selection={};this.anchor=null;this.events.push(n(this.tree.domNode,g.press,m.hitch(this,"onMouseDown")),n(this.tree.domNode,g.release,m.hitch(this,"onMouseUp")),n(this.tree.domNode,g.move,m.hitch(this,"onMouseMove")),n(this.tree.domNode,e.press,m.hitch(this,"onClickPress")),n(this.tree.domNode,e.release,m.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,
c;for(c in b)a.push(b[c]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(a){var b=p.filter(this.getSelectedTreeNodes(),function(b){return!h.isDescendant(b.domNode,a.domNode)});this.setSelection(b);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var b=this.getSelectedTreeNodes();p.forEach(this._setDifference(b,a),m.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));p.forEach(this._setDifference(a,b),m.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){p.forEach(b,function(a){a.__exclude__=!0});var c=p.filter(a,function(a){return!a.__exclude__});p.forEach(b,function(a){delete a.__exclude__});
return c},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],c=[];p.forEach(a,function(a){var e=a.getTreePath();c.push(a);b.push(e)},this);a=p.map(c,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,
this.current))){"mousedown"==a.type&&r.isLeft(a)&&a.preventDefault();var b="keydown"==a.type?this.tree.focusedChild:this.current;if(b){var c=l.getCopyKeyState(a),e=b.id;this.singular||a.shiftKey||!this.selection[e]?(this._doDeselect=!1,this.userSelect(b,c,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,l.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);var e=doc.createRange();e.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,e)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,b,c){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);c=this.anchor;0>b?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNext(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
c){c=c||b.global;for(var e in this.selection)a.call(c,this.getItem(e),e,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(p,f,b,m,l,h){return f("dijit.tree._dndContainer",null,{constructor:function(f,n){this.tree=f;this.node=f.domNode;m.mixin(this,n);this.containerState="";b.add(this.node,"dojoDndContainer");this.events=[l(this.node,h.enter,m.hitch(this,"onOverEvent")),l(this.node,h.leave,
m.hitch(this,"onOutEvent")),p.after(this.tree,"_onNodeMouseEnter",m.hitch(this,"onMouseOver"),!0),p.after(this.tree,"_onNodeMouseLeave",m.hitch(this,"onMouseOut"),!0),l(this.node,"dragstart, selectstart",function(b){b.preventDefault()})]},destroy:function(){for(var b;b=this.events.pop();)b.remove();this.node=this.parent=null},onMouseOver:function(b){this.current=b},onMouseOut:function(){this.current=null},_changeState:function(f,h){var g="dojoDnd"+f,e=f.toLowerCase()+"State";b.replace(this.node,g+
h,g+this[e]);this[e]=h},_addItemClass:function(f,h){b.add(f,"dojoDndItem"+h)},_removeItemClass:function(f,h){b.remove(f,"dojoDndItem"+h)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c){return p([n,g,l],{templateString:e,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,postCreate:function(){this.inherited(arguments);this.layerInfosObj=c.getInstanceSync();this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";this.own(m(this.layerChooser,
"tree-click",f.hitch(this,this._onTreeClick)));this.own(m(this.layerChooser,"update",f.hitch(this,this._onLayerChooserUpdate)));this.own(m(document.body,"click",f.hitch(this,this._onBodyClicked)))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(a){var b=new h;if(a){var c=this.layerInfosObj.getLayerInfoById(a.id);c?this.layerChooser.filter(c).then(f.hitch(this,
function(e){e?(this._onSelectNewItem({layerInfo:c,name:c.title,url:a.url}),b.resolve(!0)):b.resolve(!1)}),f.hitch(this,function(){b.resolve(!1)})):b.resolve(!1)}else this._onSelectNewItem(null),b.resolve(!0);return b},getSelectedItem:function(){return this._selectedItem},getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(a){a=a.target||a.srcElement;a===this.domNode||b.isDescendant(a,this.domNode)||a===this.layerChooser.domNode||b.isDescendant(a,this.layerChooser.domNode)||
this.hideLayerChooser()},_onDropDownClick:function(a){a.stopPropagation();a.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():this.showLayerChooser()},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},showLayerChooser:function(){this.layerChooser.domNode.style.width=this.domNode.clientWidth+2+"px";r.open({parent:this,popup:this.layerChooser,around:this.domNode});var a=this.layerChooser.domNode.parentNode;a&&b.addClass(a,"jimu-layer-chooser-from-map-withdropbox-popup");
this._isLayerChooserShow=!0},hideLayerChooser:function(){r.close(this.layerChooser);this._isLayerChooserShow=!1},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(a){var b=f.getObject("layerInfo.id",!1,this._selectedItem)||-1,c=f.getObject("layerInfo.id",!1,a)||-1,b=b!==c;this._selectedItem=a;this.hideLayerChooser();a=f.getObject("layerInfo.title",
!1,this._selectedItem)||"";this.layerNameNode.innerHTML=a;a=f.getObject("layerInfo.layerObject",!1,this._selectedItem);b&&this.emit("selection-change",[a])},_onTreeClick:function(){var a=this._getSelectedItems();this._onSelectNewItem(0<a.length?a[0]:null)}})})},"builder/plugins/startup/_build-generate_module":function(){define(["builder/plugins/startup/Plugin","dojo/text!builder/plugins/startup/Plugin.html","dojo/text!builder/plugins/startup/css/style.css"],function(){})},"builder/plugins/startup/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/serviceUtils jimu/dijit/ViewStack jimu/utils".split(" "),
function(p,f,b,m,l,h,r,n){return p([l],{baseClass:"plugin-startup",constructor:function(){this.appTypes=["HTML","HTML3D"]},postCreate:function(){this.main=new r({viewType:"dijit",views:[]},this.viewStackNode)},startup:function(){this.main.startup();this._loadHeaderPlugin().then(f.hitch(this,function(){this._afterHeaderLoaded()}))},getCurrentView:function(){return this.main.getSelectedView()},switchToAppList:function(){var g=f.hitch(this,function(){if(window.history&&window.history.pushState){this._switchToAppList();
var b=n.url.removeQueryParamFromUrl(window.location.href,"id");window.history.pushState({path:b},"",b)}else window.location.href="index.html"});document.title="Web AppBuilder for ArcGIS";"appconfig"===this.main.getSelectedLabel()?m.publish("closeAppConfigPage",g):""===this.main.getSelectedLabel()&&(b.empty(this.viewStackNode),g())},switchToAppConfig:function(b){var e=window.location.href;window.queryObject.id?(e=n.url.removeQueryParamFromUrl(e,"id"),e=n.url.addQueryParamToUrl(e,"id",b.id)):window.queryObject.appid?
(e=n.url.removeQueryParamFromUrl(e,"appid"),e=n.url.addQueryParamToUrl(e,"appid",b.id)):(e=n.url.removeQueryParamFromUrl(e,"title"),e=n.url.removeQueryParamFromUrl(e,"tags"),e=n.url.removeQueryParamFromUrl(e,"summary"),e=n.url.removeQueryParamFromUrl(e,"folder"),e=n.url.removeQueryParamFromUrl(e,"sharewithwebmap"),e=n.url.removeQueryParamFromUrl(e,"webmap"),e=n.url.removeQueryParamFromUrl(e,"sharewithwebscene"),e=n.url.removeQueryParamFromUrl(e,"webscene"),e=n.url.removeQueryParamFromUrl(e,"appType"),
e=n.url.addQueryParamToUrl(e,"id",b.id));if(window.location.href!==e)if(window.history&&window.history.pushState)window.history.pushState({path:e},"",e);else{window.location.href=e;return}this._switchToApp(b)},_afterHeaderLoaded:function(){var b;if(window.isXT)queryObject.id?(b={id:queryObject.id.replace("#","")},this._switchToApp(b)):this._switchToAppList();else if(queryObject.id)b={id:queryObject.id.replace("#","")},this._switchToApp(b);else if(queryObject.appid)b={appid:queryObject.appid.replace("#",
"")},this._switchToApp(b);else if(queryObject.title){b={name:queryObject.title};queryObject.tags&&(b.tags=queryObject.tags);queryObject.summary&&(b.description=queryObject.summary);queryObject.folder&&(b.folderId=queryObject.folder);if(queryObject.sharewithwebmap||queryObject.sharewithwebscene)b.sharing="true"===queryObject.sharewithwebmap||"true"===queryObject.sharewithwebscene;queryObject.appType?(b.appType=queryObject.appType,queryObject.webmap&&(b.webmap=queryObject.webmap),queryObject.webscene&&
(b.webscene=queryObject.webscene)):queryObject.webmap?(b.webmap=queryObject.webmap,b.appType="HTML"):queryObject.webscene?(b.webscene=queryObject.webscene,b.appType="HTML3D"):b.appType="HTML";this._createApp(b)}else window.location.href=window.portalUrl},_switchToApp:function(b){var e=this.main.getViewByLabel("appconfig");e&&this.main.removeView(e);"stemapp"===b.id&&(b.id="HTML");"stemapp3d"===b.id&&(b.id="HTML3D");h.getAppInfo(b.id||b.appid).then(f.hitch(this,function(c){if("undefined"===typeof c.id)this.viewStackNode.innerHTML=
'\x3cimg class\x3d"image-404" src\x3d"'+this.folderUrl+'images/404.png"\x3e';else{var a=this.pluginManager.getStemappInfo(c.appType);a.name="HTML3D"===a.appType?"stemapp3d":"stemapp";var e;e=-1<this.appTypes.indexOf(b.id)?a.appPath:window.isXT?window.path+"apps/"+c.id+"/":"HTML3D"===c.appType?window.path+"stemapp3d/":window.path+"stemapp/";window.stemappInfo=a;window.appInfo={appType:c.appType,appPath:e,appOwner:c.creator||c.owner,id:c.id,name:c.name,isPredefined:c.isPredefined,isTemplate:c.isTemplate,
isTemplateApp:c.isTemplateApp};a=this.filterExtensionsByAppType("app-config",c.appType);0===a.length?console.error("Do not find app-config extension."):1<a.length?console.error("Find more than one app-config extension."):(a=this.pluginsMeta[a[0].pluginName],a.options={appInfo:c},this.pluginManager.loadPlugin(a).then(f.hitch(this,function(a){a.label="appconfig";this.main.addView(a);this.main.switchView("appconfig")})),this._showAppName(c))}}))},_showAppName:function(b){"stemapp"===b.id?this.header.setAppName("stemapp"):
b.isTemplate?this.header.setAppName(builderNls.templateLabel+" "+b.name):this.header.setAppName(b.name);document.title=b.name+" - Web AppBuilder for ArcGIS"},_hideAppName:function(){this.header.setAppName("")},_createApp:function(b){var e=this.pluginManager.getStemappInfo(b.appType);e.name="HTML3D"===e.appType?"stemapp3d":"stemapp";window.stemappInfo=e;e=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[e.pluginName]).then(f.hitch(this,function(c){c.createNewApp(b)}))},
_switchToAppList:function(){if(this.main.getViewByLabel("applist"))this.main.switchView("applist");else{var b=this.getPluginsMetaByExtensionPoint("app-list")[0];this.pluginManager.loadPlugin(b).then(f.hitch(this,function(b){b.label="applist";this.main.addView(b);this.main.switchView("applist")}))}this._hideAppName()},_loadHeaderPlugin:function(){var g=this.getPluginsMetaByExtensionPoint("header")[0];return this.pluginManager.loadPlugin(g).then(f.hitch(this,function(e){b.place(e.domNode,this.headerNode);
e.startup();return this.header=e}))}})})},"builder/plugins/stemapps/web2d/_build-generate_module":function(){define([],function(){})},"builder/plugins/stemapps/web3d/_build-generate_module":function(){define([],function(){})},"builder/plugins/theme-config/_build-generate_module":function(){define(["builder/plugins/theme-config/Plugin","dojo/text!builder/plugins/theme-config/Plugin.html","dojo/text!builder/plugins/theme-config/css/style.css","dojo/i18n!builder/plugins/theme-config/nls/strings"],function(){})},
"builder/plugins/theme-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/dom dojo/cookie dojo/text!./Plugin.html dojo/dom-construct dojo/dom-style dojo/_base/array dojo/Deferred jimu/dijit/Message jimu/dijit/CheckBox jimu/dijit/ColorPickerPopup ./ThemeManager builder/serviceUtils builder/BasePlugin jimu/utils".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x){return p([t],{baseClass:"plugin-theme-config",templateString:g,
themeLoadDef:void 0,_themePageDef:void 0,_disableShowThemeSwitchMessage:null,constructor:function(){this._themePageDef=new u;this._disableShowThemeSwitchMessage=!0},postMixInProperties:function(){this.inherited(arguments);this.nls=f.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.own(l.subscribe("app/appConfigLoaded",f.hitch(this,this._onAppConfigLoaded)));this.own(l.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)))},startup:function(){this.inherited(arguments);
this.themeManager=new d;this.themeLoadDef=this.themeManager.loadThemes();this.themeLoadDef.then(f.hitch(this,function(a){this.initThemePage(a);this._themePageDef.resolve()}))},initThemePage:function(c){var d,g,k,l,m,n;a.forEach(c,function(a){l=b.create("div",{"class":"catalog-theme-content-div jimu-float-leading"},this.themeList);d=b.create("div",{"class":"catalog-theme-div","data-themeName":a.getName()},l);b.create("div",{"class":"catalog-theme-name-div",innerHTML:a.getLabel(),title:a.getLabel()},
l);m=b.create("div",{"class":"catalog-theme-img-box-div"},d);n=b.create("div",{"class":"catalog-theme-img-div"},m);e.create("img",{src:a.getIcon(),"class":"catalog-theme-img"},n);h(d,"click",f.hitch(this,this._onStartChangeTheme,a.getName()));g=e.create("div",{"class":""},this.styleList);this.initStyle(a,g);k=e.create("div",{"class":""},this.layoutList);this.initLayout(a,k);a.domNodes.theme=d;a.domNodes.themeImgBox=m;a.domNodes.themeSL=void 0;a.domNodes.styleList=g;a.domNodes.layoutList=k},this)},
initStyle:function(d,g){var l,n,p;l=e.create("div",{"class":"style-section"},g);e.create("div",{innerHTML:this.nls.styleTitle,"class":"style-text"},l);p=e.create("div",{"class":"style-color-content"},l);l=d.getStyles().slice();var q=l.pop();a.forEach(l,function(a){n=e.create("div",{"class":"style-div jimu-float-leading"},p);c.set(n,"backgroundColor",a.styleColor);a.domNode=n;h(n,"click",f.hitch(this,this._onStyleChanged,a.name))},this);n=e.create("div",{"class":"style-div jimu-float-leading"},p);
var t=new k({showColorPickerOK:!0,showLabel:!0,recordUID:x.getColorRecordName("theme-config-Plugin")},n);q.domNode=t.domNode;q.isCustom=!0;t.domNode.className+=" style-div jimu-float-leading";t.setColor(new m(q.styleColor));t.setTitle(this.nls.setCustomColor);this.own(h(t.domNode,"click",f.hitch(this,function(a){var b=d.getCurrentStyle().name,c=new m(a.styleColor);b!==a.name&&(t.picker.set("value",c.toHex()),t.onChange(c))},q)));this.own(h(t,"change",f.hitch(this,function(a,b){b.toHex()!==(d.appConfig.theme.customStyles&&
d.appConfig.theme.customStyles.mainBackgroundColor)&&(a.styleColor=b.toHex(),a.isCustom=!0,this._onStyleChanged(a.name))},q)));d._cp=t;b.setStyle(g,"display","none")},initLayout:function(c,d){var f;f=e.create("div",{"class":"layout-section",id:c.getName()+"-layout-section"},d);e.create("div",{innerHTML:this.nls.layoutTitle,"class":"layout-text"},f);a.forEach(c.getLayouts(),function(a){this._drawLayout(c,a,f)},this);b.setStyle(d,"display","none")},_drawLayout:function(a,b,c){var d;b.domClass||(b.domClass=
" ");c=e.create("div",{"class":"layout-out-div jimu-float-leading "},c);d=e.create("div",{"class":"layout-box-div "},c);c=e.create("div",{"class":"layout-div "+b.domClass},d);a=isRTL?b.RTLIcon?a.getUrl()+b.RTLIcon:this.folderUrl+"css/images/current_layout.png":b.icon?a.getUrl()+b.icon:this.folderUrl+"css/images/current_layout.png";e.create("img",{"class":"layout-image",src:a},c);b.domNode=c;b.boxDomNode=d;h(c,"click",f.hitch(this,this._onLayoutChanged,b.name));a=e.create("div",{"class":"layout-selected-div"},
c);e.create("img",{"class":"layout-selected-img",src:this.folderUrl+"css/images/check.png"},a);b.selectedNode=a},_onStyleChanged:function(a){this.changeStyle(a,null,!0)},_onLayoutChanged:function(a){this.changeLayout(a,null,!0)},_onStartChangeTheme:function(a){if(this.themeManager.currentThemeName!==a)if(this._disableShowThemeSwitchMessage)this.changeTheme(a,!0);else if(n("disable_theme_switch_Message"))this.changeTheme(a,!0);else{var b=new v({message:"\x3cdiv\x3e"+this.nls.themeChangeMessage+"\x3c/div\x3e",
width:500,buttons:[{label:this.nls.ok,onClick:f.hitch(this,function(){c.checked&&n("disable_theme_switch_Message",!0);b.close();this.changeTheme(a,!0)})},{label:this.nls.cancel}]}),c=new q({label:this.nls.disableThemeSwitchMessage,"class":"jimu-float-leading",style:{marginTop:"10px"}});c.placeAt(b.contentContainerNode)}},changeStyle:function(a,c,d){c||(c=this.themeManager.getCurrentTheme());var e=c.getCurrentStyle();if(c.currentStyleName!==a||e&&e.name===a&&e.isCustom)c.currentStyleName&&b.removeClass(c.getCurrentStyle().domNode,
"style-selected"),c.changeCurrentStyle(a),b.addClass(c.getCurrentStyle().domNode,"style-selected"),d&&l.publish("styleChanged",f.clone(c.getCurrentStyle()))},changeLayout:function(a,c,d){c||(c=this.themeManager.getCurrentTheme());c.currentLayoutName!==a&&(c.currentLayoutName&&(b.removeClass(c.getCurrentLayout().domNode,"layout-selected"),b.removeClass(c.getCurrentLayout().boxDomNode,"layout-box-selected")),c.changeCurrentLayout(a),b.addClass(c.getCurrentLayout().domNode,"layout-selected"),b.addClass(c.getCurrentLayout().boxDomNode,
"layout-box-selected"),d&&l.publish("layoutChanged",f.clone(c.getCurrentLayout())))},_copyThemeFromRepo:function(a){var b=new u,c=this.themeManager.getThemeByName(a);c.loadLayouts().then(f.hitch(this,function(){var d=c.getLayoutByName("default");w.copyThemeToApp(window.appInfo.id,a,c.appConfig?c.appConfig.getCleanConfig():d.layoutConfig).then(f.hitch(this,function(a){a.success?b.resolve():(b.reject(),console.error("change theme error, response of 'copytheme' unsuccess"))}),function(a){b.reject(a);
console.error("change theme error"+a)})}));return b},changeTheme:function(a,c){var d=new u;this.themeManager.currentThemeName!==a?(c&&this.pluginManager.getPluginByName("app-config").showLoadingCover(),this._copyThemeFromRepo(a).then(f.hitch(this,function(){this.themeManager.currentThemeName&&(b.removeClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected"),b.removeClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected"),b.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,
"display","none"),b.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","none"));this.themeManager.changeCurrentTheme(a);if(c){var e=this.themeManager.getCurrentTheme(),g=e._cp;delete e._cp;l.publish("themeChanged",f.clone(e));e._cp=g}b.addClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected");b.addClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected");b.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display",
"block");b.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","block");d.resolve()}))):d.resolve();return d},_onAppConfigLoaded:function(a){this._setAppConfig(a,!0)},_onAppConfigChanged:function(a){this._setAppConfig(a,!1)},_setAppConfig:function(c,d){var e,g;this._themePageDef.then(f.hitch(this,function(){d?(a.forEach(this.themeManager.themes,function(a){this.changeStyle("default",a,!1);this.changeLayout("default",a,!1);a.clear()},this),this.changeTheme(c.theme.name,!1).then(f.hitch(this,
function(){c.theme.styles&&c.theme.styles[0]&&this.changeStyle(c.theme.styles[0],this.themeManager.getCurrentTheme(),!1);e=r.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");g=this.themeManager.getCurrentTheme().getLayoutByAppConfig(c.getCleanConfig());g||(g=this.themeManager.getCurrentTheme().addLayout("appLayout",c.getCleanConfig(),"app-layout",this.nls.appLayout),this._drawLayout(this.themeManager.getCurrentTheme(),g,e));this.changeLayout(g.name,this.themeManager.getCurrentTheme(),
!1);var a=this.themeManager.getCurrentTheme();a.setAppConfig(c);var d=f.getObject("theme.customStyles.mainBackgroundColor",!1,c);d&&a._cp.setColor(new m(d));b.setStyle(this.themeList,"display","block")}))):this.themeManager.getCurrentTheme()&&this.themeManager.getCurrentTheme().setAppConfig(c)}))}})})},"jimu/dijit/ColorPickerPopup":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorPalette jimu/utils".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c){return p([f,b],{baseClass:"jimu-color-pickerPopup",declaredClass:"jimu.dijit.ColorPickerPopup",templateString:'\x3cdiv class\x3d"jimu-color-picker"\x3e\x3c/div\x3e',_isTooltipDialogOpened:!1,color:null,showLabel:!1,recordUID:"",postCreate:function(){this.inherited(arguments);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},destroy:function(){g.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var b=
this.tooltipDialog.domNode,b=a===b||l.isDescendant(a,b),c=null;this.picker&&this.picker.getPickerTooltipDialog&&(c=this.picker.getPickerTooltipDialog().domNode);a=a===c||l.isDescendant(a,c);return b||a},hideTooltipDialog:function(){this._hideTooltipDialog()},_showTooltipDialog:function(){g.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){g.close(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){var a=
l.create("div");this.tooltipDialog=new n({content:a});l.addClass(this.tooltipDialog.domNode,"jimu-color-picker-popup-dialog");var b=new e({appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showCoustomRecord:!0},recordUID:this.recordUID,onChange:m.hitch(this,function(a){a&&(a=new r(a),this.setColor(a),this.onChange(a))})});b.placeAt(a);b.startup();this.own(h(this.domNode,"click",m.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():
this._showTooltipDialog()})));this.own(h(document,"click",m.hitch(this,function(a){this.isPartOfPopup(a.srcElement||a.target)||this._hideTooltipDialog()})));this.picker=b},setColor:function(a){if(a instanceof r){null===this.color&&!0===this.showLabel&&this._changeLabel(a);var b=a.toHex();this.color=a;l.setStyle(this.domNode,"backgroundColor",b);this.picker&&(this.picker.refreshRecords(),this.picker.setColor(b,!1,!0));this.showLabel&&this._changeLabel(this.color)}},getColor:function(){return this.color},
_changeLabel:function(a){l.empty(this.domNode);l.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:c.invertColor(a.toHex())}},this.domNode)},onChange:function(a){a&&this.showLabel&&this._changeLabel(a)},changeColor:function(){this.picker&&this.picker.changeColor();this.showLabel&&this._changeLabel(this.color)},setTitle:function(a){this.domNode.title=a}})})},"jimu/dijit/ColorPalette":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dojo/query jimu/dijit/ColorChooser jimu/dijit/ColorPicker jimu/dijit/ColorRecords dijit/popup jimu/utils dijit/a11yclick".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){return p([f,m,b],{templateString:"\x3cdiv\x3e\x3c/div\x3e",baseClass:"jimu-color-palette",declaredClass:"jimu.dijit.ColorPalette",_TRANSPARENT_STR:"rgba(0, 0, 0, 0)",value:"",_defaultAppearance:{showTransparent:!0,showColorPalette:!0,showColorPickerOK:!1,showCoustom:!0,showCoustomRecord:!0},recordUID:"",postMixInProperties:function(){this.nls=window.jimuNls.colorPalette},postCreate:function(){this.inherited(arguments);this.value=this.value?new n(this.value):
new n("#fff");this._createContent()},_createContent:function(){this.appearance=l.mixin(this._defaultAppearance,this.appearance);var a=h.create("div",{"class":"jimu-colorpalette"},this.domNode);this.appearance.showTransparent&&this._createSpecialColors(a);this.appearance.showColorPalette&&this._createColorChooser(a);this.appearance.showCoustom&&this._createJimuColorPicker(a);this.appearance.showCoustom&&this.appearance.showCoustomRecord&&this._createCoustomRecord(a)},setColor:function(a){this._isColorEqual(a)||
(this.value=new n(a),this._setSpatialColor(this.value),"undefined"!==typeof this.value.a&&0===this.value.a?(this.colorChooser.setColor(new n("transparent"),!1),this.picker.setColor(new n("#fff"),!1)):(this.colorChooser.setColor(this.value.toHex(),!1),this.picker.setColor(this.value,!1)),this.colorRecords&&this.colorRecords.selecteColor(this.value))},getColor:function(){return this.value},changeColor:function(){if("undefined"!==typeof this.value.a&&0===this.value.a)this.onChange(this.value);else this.onChange(this.value.toHex())},
refreshRecords:function(){this.colorRecords&&this.colorRecords.refresh()},destroy:function(){u.close(this.tooltipDialog);this.picker.destroy();this.inherited(arguments)},_createSpecialColors:function(a){a=h.create("div",{"class":"special-color"},a);this.transparentBtn=h.create("div",{"class":"transparent btn",innerHTML:'\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"transparent icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"transparent text jimu-float-leading"\x3e'+this.nls.transparent+
"\x3c/div\x3e\x3c/div\x3e"},a);this.own(r(this.transparentBtn,q,l.hitch(this,this._onTransparentClick)))},_onTransparentClick:function(){this.setColor(new n("transparent"));this.changeColor()},_setSpatialColor:function(a){if(this.transparentBtn){var b=g(".btn-wapper",this.transparentBtn)[0];h.removeClass(b,"selected");a&&a.toString&&a.toString()===this._TRANSPARENT_STR&&h.addClass(b,"selected")}},_createColorChooser:function(a){this.colorChooser=new e({});this.colorChooser.placeAt(a);this.own(r(this.colorChooser,
"change",l.hitch(this,function(a){a=new n(a);this.setColor(a);this.changeColor()})))},_createJimuColorPicker:function(a){this.coustomtBtn=h.create("div",{"class":"coustom btn"},a);a='\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"custom icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"custom text jimu-float-leading"\x3e'+this.nls.custom+"\x3c/div\x3e\x3c/div\x3e";this.picker=new c({ensureMode:!0,showOk:this.appearance.showColorPickerOK,showLabel:!1,value:this.value.toHex(),onChange:l.hitch(this,
function(a){a=new n(a);this.setColor(a);this.changeColor();this.colorRecords&&this.colorRecords.push&&this.colorRecords.push(a)})});this.picker.placeAt(this.coustomtBtn);this.picker.setLabel(a);this.picker.setColor(this.value)},_createCoustomRecord:function(b){this.colorRecords=new a({recordsLength:10,uid:this.recordUID||""});this.colorRecords.placeAt(b);this.own(r(this.colorRecords,"choose",l.hitch(this,function(a){this.setColor(new n(a));this.changeColor()})))},_isColorEqual:function(a){return this.value.toString()===
(new n(a)).toString()?!0:!1},_changeLabel:function(a){h.empty(this.domNode);h.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:v.invertColor(a.toHex())}},this.domNode)},getPickerTooltipDialog:function(){var a=null;this.picker&&this.picker.tooltipDialog&&(a=this.picker.tooltipDialog);return a}})})},"jimu/dijit/ColorChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/i18n dojo/_base/Color dijit/a11yclick dojo/i18n!dojo/nls/colors".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){return f([b,m,l,p],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\x3ctable class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e',baseClass:"jimu-color-chooser",declaredClass:"jimu.dijit.ColorChooser",uid:"",colorsArray:["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "),
"lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "),"silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "),"gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),"dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "),"darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "),
"rgb(0,0,1) darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")],postCreate:function(){this.inherited(arguments);this.colorTitleNls=e.getLocalization("dojo","colors");this._createColorsBlocks()},_createColorsBlocks:function(){this._row=this.colorsArray.length;this._col=this.colorsArray[0].length;for(var b=0;b<this._row;b++)for(var e=r.create("tr",{role:"row"},this.gridNode),f=0;f<this._col;f++){var g=this.colorsArray[b][f],d=c.named[g],l="";d?l=g:"rgb(0,0,1)"===
g&&(l="black",d="rgb(0,0,1)");g=this.colorTitleNls[l];d=(new c(d)).toString();this["record"+f]=r.create("td",{"class":"dijitPaletteCell","data-title":d,role:"gridcell"},e);var m=r.create("span",{"class":"dijitInline dijitPaletteImg"},this["record"+f]);r.create("img",{"class":"dijitColorPaletteSwatch",src:require.toUrl("dojo/resources/blank.gif"),alt:g,title:g,"data-title":l,width:"16px",height:"16px",style:"background-color: "+d},m)}this.own(n(this.gridNode,a,h.hitch(this,this.onColorClick)))},onColorClick:function(a){for(var b=
a.target;"TD"!==b.tagName;){if(!b.parentNode||b===this.gridNode)return;b=b.parentNode}b=r.getAttr(b,"data-title");b=(new c(b)).toString();this.setColor(b);a.stopPropagation();a.preventDefault()},_onChange:function(a){this.emit("change",a)},setColor:function(a,b){for(var e=new c(a),f=null,d=g("td",this.domNode),h=0,l=d.length;h<l;h++)r.removeClass(d[h],"dijitPaletteCellSelected");h=0;for(l=d.length;h<l;h++)if(e.toString()===r.getAttr(d[h],"data-title")){f=d[h];break}f&&r.addClass(f,"dijitPaletteCellSelected");
(f&&"undefined"===typeof b||!0===b)&&this._onChange(e)}})})},"jimu/dijit/ColorRecords":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/_base/Color dojo/cookie dojo/text!./templates/ColorRecords.html dijit/a11yclick".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u){return f([b,m,l,p],{templateString:a,baseClass:"jimu-color-records",declaredClass:"jimu.dijit.ColorRecords",uid:"",
recordsLength:10,colorList:null,postCreate:function(){this.inherited(arguments);this.colorList=[];this._createCoustomRecord();""===this.uid&&(this.uid="wab_colorRecords");this.refresh()},push:function(a){this.colorList.unshift(a);this.colorList.length>this.recordsLength&&this.colorList.pop();this._setColors()},selecteColor:function(a){a=new e(a);for(var b=null,c=g("td",this.domNode),d=0,f=c.length;d<f;d++)r.removeClass(c[d],"dijitPaletteCellSelected");d=0;for(f=c.length;d<f;d++)if(a.toString()===
r.getAttr(c[d],"title")){b=c[d];break}b&&(r.addClass(b,"dijitPaletteCellSelected"),this.onChoose(a))},refresh:function(){this._getCookie(this.uid);this._setColors()},_setColors:function(){for(var a=0;a<this.recordsLength;a++){var b=this["record"+a];if(b&&this.colorList[a]&&this.colorList[a].toString){var c=this.colorList[a].toString();r.setAttr(b,"title",c);b=this._findImg(b);r.setStyle(b,"background-color",c);r.setAttr(b,"alt",c);r.setAttr(b,"title",c)}}this._setCookie(this.uid)},_createCoustomRecord:function(){for(var a=
0;a<this.recordsLength;a++){this["record"+a]=r.create("td",{"class":"dijitPaletteCell",tabindex:a,title:"",role:"gridcell"},this.container);var b=r.create("span",{"class":"dijitInline dijitPaletteImg"},this["record"+a]);r.create("img",{"class":"dijitColorPaletteSwatch",src:require.toUrl("dojo/resources/blank.gif"),style:"background-color: #ffffff"},b)}this.own(n(this.gridNode,u,h.hitch(this,this.onRecordClick)))},onRecordClick:function(a){for(var b=a.target;"TD"!==b.tagName;){if(!b.parentNode||b===
this.gridNode)return;b=b.parentNode}b=r.getAttr(b,"title");b=(new e(b)).toString();this.onChoose(b);a.stopPropagation();a.preventDefault()},onChoose:function(a){this.emit("choose",a)},_findImg:function(a){var b=null;return a.nodeName&&"IMG"===a.nodeName.toUpperCase()?a:b=g(".dijitColorPaletteSwatch",a)[0]},_setCookie:function(a){for(var b=[],e=0,d=this.recordsLength;e<d;e++){var f=this.colorList[e];f&&f.toString&&(b[e]=f.toString())}this._cleanCookie(a);try{var g=JSON.stringify(b);c(a,g,{expires:1E3,
path:"/"})}catch(x){console.error("ColorRecords: cookieList JSON.stringify error."+x.stack)}},_getCookie:function(a){a=c(a);if("undefined"!==typeof a)try{var b=JSON.parse(a);if(b&&"undefined"!==typeof b.length){a=0;for(var f=this.recordsLength;a<f;a++){var d=b[a];d&&d.toString&&(this.colorList[a]=new e(d.toString()))}}}catch(w){console.error("ColorRecords: cookieList JSON.parse error."+w.stack)}},_cleanCookie:function(a){c(a,null,{expires:-1})}})})},"builder/plugins/theme-config/ThemeManager":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred ./Theme builder/serviceUtils".split(" "),
function(p,f,b,m,l,h){return p(null,{themes:void 0,constructor:function(){this.currentThemeName=null;this.themes=[]},loadThemes:function(){var p=new m;h.getAllThemes().then(b.hitch(this,function(b){b.success?(b.themes=b.themes.sort(function(b,e){return b.label.localeCompare(e.label)}),f.forEach(b.themes,function(b){this.themes.push(new l(b))},this),p.resolve(this.themes)):(console.error("Gets themes failed! The response of getThemes is 'unsuccess'!"),p.reject(this.themes))}),function(b){console.error("Gets themes failed!"+
b);p.reject(this.themes)});return p},changeCurrentTheme:function(b){this.currentThemeName=b},getCurrentTheme:function(){return this.getThemeByName(this.currentThemeName)},getThemeByName:function(b){for(var f=0;f<this.themes.length;f++)if(b===this.themes[f].getName())return this.themes[f]}})})},"builder/plugins/theme-config/Theme":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/request jimu/utils".split(" "),function(p,f,b,
m,l,h,r,n){return p(null,{appConfig:void 0,currentStyleName:void 0,currentLayoutName:void 0,_manifest:void 0,constructor:function(b){this._manifest=b;this.domNodes={}},clear:function(){var f;this.appConfig=null;for(f=0;f<this._manifest.layouts.length;f++)if("appLayout"===this._manifest.layouts[f].name){this._manifest.layouts[f].domNode&&b.destroy(this._manifest.layouts[f].domNode);this._manifest.layouts.splice(f,1);break}},loadLayouts:function(){var b=new l,e=[],c=m.filter(this._manifest.layouts,
function(a){return"appLayout"!==a.name});m.forEach(c,function(a){e.push(r(this._manifest.url+a.uri,{handleAs:"json"}))},this);h(e).then(f.hitch(this,function(a){var e;m.forEach(c,function(b,c){b.layoutConfig=a[c];"default"===b.name?e=b.layoutConfig:b.layoutConfig=n.mixinAppConfigPosition(e,b.layoutConfig);b.layoutConfig.mobileLayout&&(b.layoutConfig.mobileLayout=n.mixinAppConfigPosition(b.layoutConfig,b.layoutConfig.mobileLayout),delete b.layoutConfig.mobileLayout.mobileLayout)},this);b.resolve()}),
function(){b.reject()});return b},_processLayoutConfig:function(b,e){return n.mixinAppConfigPosition(b,e)},setAppConfig:function(b){this.appConfig=b},getName:function(){return this._manifest.name},getVersion:function(){return this._manifest.version},getLabel:function(){return this._manifest.label},getIcon:function(){return this._manifest.icon},getLayouts:function(){return this._manifest.layouts},getStyles:function(){return this._manifest.styles},getUrl:function(){return this._manifest.url},getCurrentStyle:function(){return this.getStyleByName(this.currentStyleName)},
getCurrentLayout:function(){return this.getLayoutByName(this.currentLayoutName)},changeCurrentStyle:function(b){this.currentStyleName=b},changeCurrentLayout:function(b){this.currentLayoutName=b},addLayout:function(b,e,c,a){var f,g=this.getLayouts();for(f=0;f<g.length;f++)if(g[f].name===b)return null;b={description:"this is current app layout",name:b,label:a,layoutConfig:e,domClass:c};this._manifest.layouts.push(b);return b},getStyleByName:function(b){var e,c=null;for(e=0;e<this._manifest.styles.length;e++)if(this._manifest.styles[e].name===
b){c=this._manifest.styles[e];break}return c},getLayoutByName:function(b){var e,c=null;for(e=0;e<this._manifest.layouts.length;e++)if(this._manifest.layouts[e].name===b){c=this._manifest.layouts[e];break}return c},getLayoutByAppConfig:function(b){var e,c=null;for(e=0;e<this._manifest.layouts.length;e++)if(this.isAppUseLayout(b,this._manifest.layouts[e].layoutConfig)){c=this._manifest.layouts[e];break}return c},isAppUseLayout:function(b,e){var c=f.clone(b),a=f.clone(e);c.map||(c.map={});a.map||(a.map=
c.map);c.map.position||(c.map.position={left:0,top:0});a.map.position||(a.map.position=c.map.position);if(!n.isEqual(c.map.position,a.map.position))return!1;c.widgetOnScreen||(c.widgetOnScreen={});a.widgetOnScreen||(a.widgetOnScreen={});c.widgetOnScreen.widgets||(c.widgetOnScreen.widgets=[]);a.widgetOnScreen.widgets||(a.widgetOnScreen.widgets=[]);c.widgetOnScreen.groups||(c.widgetOnScreen.groups=[]);a.widgetOnScreen.groups||(a.widgetOnScreen.groups=[]);var g,h;g=c.widgetOnScreen.widgets.length<a.widgetOnScreen.widgets.length?
c.widgetOnScreen.widgets.length:a.widgetOnScreen.widgets.length;for(h=0;h<g;h++)if(c.widgetOnScreen.widgets[h].position||(c.widgetOnScreen.widgets[h].position={}),a.widgetOnScreen.widgets[h].position||(a.widgetOnScreen.widgets[h].position=c.widgetOnScreen.widgets[h].position),a.widgetOnScreen.widgets[h].position.relativeTo||(a.widgetOnScreen.widgets[h].position.relativeTo=c.widgetOnScreen.widgets[h].position.relativeTo),!n.isEqual(c.widgetOnScreen.widgets[h].position,a.widgetOnScreen.widgets[h].position))return!1;
g=c.widgetOnScreen.groups.length<a.widgetOnScreen.groups.length?c.widgetOnScreen.groups.length:a.widgetOnScreen.groups.length;for(h=0;h<g;h++)if(c.widgetOnScreen.groups[h].panel||(c.widgetOnScreen.groups[h].panel={}),a.widgetOnScreen.groups[h].panel||(a.widgetOnScreen.groups[h].panel=c.widgetOnScreen.groups[h].panel),c.widgetOnScreen.groups[h].panel.position||(c.widgetOnScreen.groups[h].panel.position={}),a.widgetOnScreen.groups[h].panel.position||(a.widgetOnScreen.groups[h].panel.position=c.widgetOnScreen.groups[h].panel.position),
a.widgetOnScreen.groups[h].panel.position.relativeTo||(a.widgetOnScreen.groups[h].panel.position.relativeTo=c.widgetOnScreen.groups[h].panel.position.relativeTo),!n.isEqual(c.widgetOnScreen.groups[h].panel.position,a.widgetOnScreen.groups[h].panel.position))return!1;return!0},getLayoutFromConfig:function(b){var e={};b=f.clone(b);b.widgetOnScreen&&(e.widgetOnScreen={},b.widgetOnScreen.widgets&&(e.widgetOnScreen.widgets=[],m.forEach(b.widgetOnScreen.widgets,function(b,a){e.widgetOnScreen.widgets[a]=
{position:b.position?b.position:{left:0,top:0}}})),b.widgetOnScreen.groups&&(e.widgetOnScreen.groups=[],m.forEach(b.widgetOnScreen.groups,function(b,a){e.widgetOnScreen.groups[a]={position:b.position?b.position:{left:0,top:0}}})));b.map&&(e.map={position:b.map.position});return e}})})},"builder/plugins/widget-config/_build-generate_module":function(){define(["builder/plugins/widget-config/Plugin","dojo/text!builder/plugins/widget-config/Plugin.html","dojo/text!builder/plugins/widget-config/css/style.css",
"dojo/i18n!builder/plugins/widget-config/nls/strings"],function(){})},"builder/plugins/widget-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/fx dojo/topic dojo/on dijit/_WidgetBase ./WidgetsList ./MoveableNode ./WidgetSettingPage ./GroupSettingPage ./WidgetChoosePage jimu/utils jimu/PoolControllerMixin jimu/dijit/ViewStack jimu/dijit/Popup builder/BasePlugin".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w){return p([w],{baseClass:"plugin-widget-config app-widgets",
postMixInProperties:function(){this.nls=f.mixin(this.nls,window.builderNls)},postCreate:function(){this.inherited(arguments);this.notRemoveableWidgetOnScreen=new g({name:"notRemoveableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.notRemoveableOnScreenWidgetsListNode);this.removeableWidgetOnScreen=new g({name:"removeableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.removeableOnScreenWidgetsListNode);this.poolWidgets=new g({name:"poolWidgets",nls:this.nls,folderUrl:this.folderUrl},
this.poolWidgetsListNode);this.viewStack=new k({viewType:"dom",views:[this.preloadWidgetsNode,this.poolWidgetsNode]});this.viewStack.placeAt(this.domNode);this.poolControllerClass=p([n,q]);this.own(h.subscribe("editWidget",f.hitch(this,this._onEditWidget)));this.own(h.subscribe("chooseWidget",f.hitch(this,this._onChooseWidget)));this.own(h.subscribe("editGroup",f.hitch(this,this._onEditGroup)));this.own(h.subscribe("app/appConfigChanged",f.hitch(this,this._onAppConfigChanged)));this.own(h.subscribe("app/appConfigLoaded",
f.hitch(this,this._onAppConfigChanged)));this.own(h.subscribe("widgetSettingPageOk",f.hitch(this,this._onWidgetSettingPageOk)));this.own(r(this.poolWidgets,"offpanel-group-error",f.hitch(this,this._onOffPanelGroupError)));window.isRTL&&(b.removeClass(this.backArrowNode,"icon-arrow-back"),b.addClass(this.backArrowNode,"icon-arrow-forward"))},startup:function(){this.inherited(arguments);this.viewStack.startup();this.poolWidgets.opened=!1;this._init(this.appConfig)},destroy:function(){m.forEach(this.controllers,
function(a){a.destroy()});this.controllers=[];this.inherited(arguments)},_onAppConfigChanged:function(a){this._started?this.appConfig&&v.isEqual(this.appConfig.widgetOnScreen,a.widgetOnScreen)&&v.isEqual(this.appConfig.widgetPool,a.widgetPool)?this.appConfig=a:this._init(a):this.appConfig=a},_init:function(a){this.appConfig=a;this._createControllerWidgetNodes();this.poolWidgets.opened?0<this.controllers.length?m.some(this.controllers,function(a){if(this.poolWidgets.controller.id===a.id)return this._initWidgetPool(a),
!0},this)||this._initWidgetPool(this.controllers[0]):(this._initWidgetPool(null),this._onBackWidgetsClick()):this._initOnScreenWidget(a);this.widgetChoosePage&&this.widgetChoosePage.setAppConfig(a);this.widgetSettingPage&&this.widgetSettingPage.setAppConfig(a)},_setHeight:function(){b.setStyle(this.notRemoveableOnScreenWidgetsListNode,{height:this.notRemoveableWidgetOnScreen.getListHeight()+"px"});b.setStyle(this.removeableOnScreenWidgetsListNode,{height:this.removeableWidgetOnScreen.getListHeight()+
"px"})},_onOffPanelGroupError:function(){b.setStyle(this.offPanelToGroupErrorNode,"opacity",1);l.fadeOut({node:this.offPanelToGroupErrorNode,duration:5E3}).play()},_getNonControllerAndNotRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];m.forEach(a.widgetOnScreen.widgets,function(a){a.isController||!1!==a.inPanel||!0===a.closeable||b.push(a)},this);return b},_getNonControllerAndRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];m.forEach(a.widgetOnScreen.widgets,
function(a){a.isController||(!1!==a.inPanel||!0!==a.closeable)&&!0!==a.inPanel&&a.uri||b.push(a)},this);m.forEach(a.widgetOnScreen.groups,function(a){b.push(a)},this);return b},_createControllerWidgetNodes:function(){m.forEach(this.controllers,function(a){b.destroy(a.node);a.destroy()},this);this.controllers=[];m.forEach(this.appConfig.widgetOnScreen.widgets,function(a){a.isController&&this._createControllerWidgetNode(a)},this);this.controllerWidgetsHeight=118*this.controllers.length;b.setStyle(this.controllerWidgetsNode,
{height:this.controllerWidgetsHeight+"px"})},_createControllerWidgetNode:function(a){var c=b.create("div",{"class":"controller-widget"},this.controllerWidgetsNode),d={};window.isRTL?d.right="30px":d.left="30px";d=new e({type:"widget",w:74,h:118,setting:a,listName:"controllerWidgets",style:d,nls:this.nls});b.place(d.domNode,c);d.startup();d=b.create("div",{"class":"action-node"},c);b.create("div",{"class":"action-text jimu-float-leading jimu-leading-margin1",title:this.nls.setControlledWidgets,innerHTML:this.nls.setControlledWidgets},
d);window.isRTL?b.create("div",{"class":"action-arrow feature-action icon-arrow-left jimu-float-trailing jimu-trailing-margin2"},d):b.create("div",{"class":"action-arrow feature-action icon-arrow-right jimu-float-trailing jimu-trailing-margin2"},d);a=new this.poolControllerClass(a);a.appConfig=this.appConfig;a.node=c;this.controllers.push(a);this.own(r(d,"click",f.hitch(this,this._openWidgetPool,a)))},_openWidgetPool:function(a){!1!==a.visible&&(this.currentController=a,this.viewStack.switchView(this.poolWidgetsNode),
this.poolWidgets.opened=!0,this.removeableWidgetOnScreen.opened=!1,this.notRemoveableWidgetOnScreen.opened=!1,this.controllerLabelNode.innerHTML=v.stripHTML(a.label),this.poolWidgets._started||this.poolWidgets.startup(),this._initWidgetPool(a))},_initWidgetPool:function(a){this.poolWidgets.controller=a;this.poolWidgets.setSettings(a?a.getAllConfigs():[]);this.poolWidgets.setAppConfig(this.appConfig)},_initOnScreenWidget:function(a){this.notRemoveableWidgetOnScreen._started||this.notRemoveableWidgetOnScreen.startup();
this.notRemoveableWidgetOnScreen.setSettings(this._getNonControllerAndNotRemoveableOnScreenWidgets(a));this.notRemoveableWidgetOnScreen.setAppConfig(a);0<this.controllers.length&&0<this.notRemoveableWidgetOnScreen.settings.length?b.setStyle(this.notRemoveableOnScreenWidgetsHline,"display",""):b.setStyle(this.notRemoveableOnScreenWidgetsHline,"display","none");this.removeableWidgetOnScreen._started||this.removeableWidgetOnScreen.startup();this.removeableWidgetOnScreen.setSettings(this._getNonControllerAndRemoveableOnScreenWidgets(a));
this.removeableWidgetOnScreen.setAppConfig(a);0<this.removeableWidgetOnScreen.settings.length&&(0<this.controllers.length||0<this.notRemoveableWidgetOnScreen.settings.length)?b.setStyle(this.removeableOnScreenWidgetsHline,"display",""):b.setStyle(this.removeableOnScreenWidgetsHline,"display","none");this._setHeight()},_onBackWidgetsClick:function(){this._createControllerWidgetNodes();this.viewStack.switchView(this.preloadWidgetsNode);this.poolWidgets.opened=!1;this.removeableWidgetOnScreen.opened=
!0;this.notRemoveableWidgetOnScreen.opened=!0;this._initOnScreenWidget(this.appConfig)},_onEditWidget:function(a,e){this.widgetSettingPage=new c({appConfig:this.appConfig,nls:this.nls},this.widgetSettingPageNode);this.widgetSettingPage.setting=f.clone(a);this.widgetSettingPage.fromNode=e;var g=new d({titleLabel:this.nls.configLabel+" "+a.label,content:this.widgetSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:f.hitch(this.widgetSettingPage,this.widgetSettingPage.onOk)},{label:this.nls.cancel,
classNames:["jimu-btn-vacation"],onClick:f.hitch(this.widgetSettingPage,this.widgetSettingPage.onCancel)}],onClose:f.hitch(this.widgetSettingPage,this.widgetSettingPage.onClose)});b.addClass(g.domNode,"widget-setting-popup");this.widgetSettingPage.startup()},_onChooseWidget:function(a,b){this.widgetChoosePage=new u({appConfig:this.appConfig,nls:this.nls,options:{includeOffPanel:"group"===a.type?!1:!0}},this.widgetChoosePageNode);this.widgetChoosePage.fromNode=a;this.widgetChoosePage.fromList=b;new d({titleLabel:this.nls.chooseWidget,
content:this.widgetChoosePage,container:"main-page",buttons:[{label:this.nls.ok,onClick:f.hitch(this.widgetChoosePage,this.widgetChoosePage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});this.widgetChoosePage.startup()},_onEditGroup:function(b,c){this.groupSettingPage=new a({setting:f.clone(c),nls:this.nls});new d({titleLabel:c.label,content:this.groupSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:f.hitch(this.groupSettingPage,this.groupSettingPage.onOk)},
{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});this.groupSettingPage.startup()},_onWidgetSettingPageOk:function(a){a.isController&&h.publish("widgetChanged",a)},_getPopupSize:function(){var a=b.getContentBox("main-page"),c={};1024>=a.w?(c.width=a.w-20,c.height=a.h-20):(c.width=1024,c.height=768);return c}})})},"builder/plugins/widget-config/WidgetsList":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/aspect dojo/Evented dojo/query dojo/NodeList-dom dijit/_WidgetBase ./MoveableNode ./LinkList".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a){function u(a){var b={};isFinite(a.l)&&(b.left=a.l+"px");isFinite(a.t)&&(b.top=a.t+"px");isFinite(a.w)&&(b.width=a.w+"px");isFinite(a.h)&&(b.height=a.h+"px");return b}var v,q=p([e],{box:null,postCreate:function(){this.inherited(arguments);this.domNode=b.create("div",{"class":"node-margin"});this.type="addBtn"===this.node.type?"addMargin":"margin"}});return p([e,r],{postCreate:function(){this.nodeList=new a({name:this.name});this.own(l.subscribe("widgetChoosePageOk",
f.hitch(this,this._onWidgetChoosePageOk)));this.own(l.subscribe("widgetSettingPageOk",f.hitch(this,this._onWidgetSettingPageOk)))},startup:function(){this.inherited(arguments);this.box=b.getContentBox(this.domNode);this.position=b.position(this.domNode);v=Math.floor(this.box.w/89);this.settings&&this.initNodes()},setSettings:function(a){this.settings=a;this.initNodes()},setAppConfig:function(a){this.appConfig=a},addWidget:function(a){a=this.createMoveableNode("widget",a);this.nodeList.insertNode(a);
this.placeNodes()},createMoveableNode:function(a,d){var e=f.clone(this.box);e.h=Infinity;var g=new c({type:a,w:74,h:118,setting:d,listName:this.name,parentBox:e,nls:this.nls,folderUrl:this.folderUrl});b.place(g.domNode,this.domNode);g.startup();this.bindMoveEvent(g);"group"===a&&(h.after(g,"openGroup",f.hitch(this,this.openGroup,g)),h.after(g,"closeGroup",f.hitch(this,this.closeGroup,g)));g.on("removeNode",f.hitch(this,function(){"poolWidgets"===this.name&&(g.gnode?(this.nodeList.removeNode(g),this._reopenGroup()):
this.nodeList.removeNode(g),this.placeNodes(),this.publishPoolChangeEvent())}));g.on("clickOpenAtStart",f.hitch(this,function(){var a={id:g.setting.id,openAtStart:!g.setting.openAtStart};a.isOnScreen="poolWidgets"===this.name?!1:!0;l.publish("openAtStartChange",a)}));this.createMarginNode(g);return g},openGroup:function(a){var b,c,e,g,k,h,l;this.openedGNode&&this.openedGNode!==a&&this.openedGNode.closeGroup(this.openedGNode);b=a.setting.widgets;k=this.getNodePosition(this.nodeList.getNodeIndex(a)).r;
h=Math.ceil(b.length/v);c=k*v+1;e=this.nodeList.getNodeByIndex(c);for(g=this.nodeList.getCount()+1;g<c;g++)l=this.createMoveableNode("empty"),l.gnode=a,this.nodeList.insertNode(l,e);this.openedGNode=a;this.openedGNode.panelRow=k+1;this.createGroupPanel(k+1,h);b.forEach(f.hitch(this,function(b){b=this.createMoveableNode("widget",b);b.gnode=a;this.nodeList.insertNode(b,e)}));b=v*h-b.length;for(g=0;g<b;g++)l=this.createMoveableNode("empty"),l.gnode=a,this.nodeList.insertNode(l,e);this.placeNodes()},
createGroupPanel:function(a,c){this.groupPanel=b.create("div",{"class":"widget-group-panel",style:u({l:5,t:118*(a-1)-10,h:118*c+0*(c-1),w:89*v-15+20})},this.domNode);var d=(this.openedGNode.pos.c-1)%v*89+37;window.isRTL&&(d=1===this.openedGNode.pos.c?89*v-37:(v-this.openedGNode.pos.c+1)%v*89-37);b.create("div",{"class":"group-triangle",style:{left:d+"px"}},this.groupPanel);this.groupPanel.type="panel"},closeGroup:function(a){var c=[];a.setting.widgets=[];this.nodeList.visitNodes(f.hitch(this,function(b){b.gnode===
a&&("empty"!==b.type&&a.setting.widgets.push(b.setting),c.push(b))}));c.forEach(f.hitch(this,function(a){this.nodeList.removeNode(a)}));0===a.setting.widgets.length?this.nodeList.removeNode(a):a.updateSmallWidgets();this.placeNodes();b.destroy(this.groupPanel);this.openedGNode=null},initNodes:function(){this.destroyShadowNode();var a=this.settings;if("notRemoveableWidgetOnScreen"===this.name)a=a.sort(function(a,b){return a.label.localeCompare(b.label)});else if("removeableWidgetOnScreen"===this.name)var b=
m.filter(a,function(a){return a.widgets}),b=b.sort(function(a,b){return a.label.localeCompare(b.label)}),c=m.filter(a,function(a){return a.uri}),c=c.sort(function(a,b){return a.label.localeCompare(b.label)}),a=m.filter(a,function(a){return!a.widgets&&!a.uri}),a=a.sort(function(a,b){return a.placeholderIndex-b.placeholderIndex}),a=[].concat(b,c,a);else a=a.sort(function(a,b){return a.index-b.index});var e;this.openedGNode&&(e=this.openedGNode.label,this.closeGroup(this.openedGNode));this.nodeList.destroyAllNodes();
"poolWidgets"===this.name&&(this.addBtn=this.createMoveableNode("addBtn"),this.nodeList.insertNode(this.addBtn));a.forEach(f.hitch(this,function(a){if(a.widgets){if("poolWidgets"!==this.name&&1!==a.maxWidgets)return;a=this.createMoveableNode("group",a)}else a=a.uri?this.createMoveableNode("widget",a):this.createMoveableNode("placeholder",a);a&&this.nodeList.insertNode(a)}));"poolWidgets"===this.name&&this.nodeList.insertNode(this.createMoveableNode("empty"));this.placeNodes();e&&(b=this.nodeList.getNodeByLabel(e))&&
(this.openGroup(b),b.status="open")},getListHeight:function(){var a=0;this.nodeList.visitNodes(function(b){a=Math.max(b.pos.r,a)});return 118*a},_removeActive:function(){n(".node-margin-active",this.domNode).removeClass("node-margin-active");n(".empty-node-active",this.domNode).removeClass("empty-node-active");n(".node-active",this.domNode).removeClass("node-active")},bindMoveEvent:function(a){"addBtn"!==a.type&&a.dnd&&(h.after(a.dnd,"onMove",f.hitch(this,function(c,e,f){c=this.getMousePosition(f);
this.mouseNode=this.getNodeByMousePosition(a,c);this._removeActive();this.mouseNode&&"margin"===this.mouseNode.type?b.addClass(this.mouseNode.domNode,"node-margin-active"):this.mouseNode&&"empty"===this.mouseNode.type?b.addClass(this.mouseNode.domNode,"empty-node-active"):!this.mouseNode||"group"!==this.mouseNode.type&&"widget"!==this.mouseNode.type||b.addClass(this.mouseNode.domNode,"node-active")}),!0),h.after(a.dnd,"onMoveStart",f.hitch(this,function(){this.destroyShadowNode();this.createShadowNode(a);
b.setStyle(a.boxNode,"cursor","move")}),!0),h.after(a.dnd,"onMoveStop",f.hitch(this,this._onMoveStop,a),!0))},_onMoveStop:function(a){var c=!1;b.setStyle(a.boxNode,"cursor","pointer");this.mouseNode&&(a===this.mouseNode?console.log("move to the same node"):"margin"===this.mouseNode.type?(this.moveNodeToMargin(a,this.mouseNode),c=!0):"empty"===this.mouseNode.type?this.mouseNode.gnode&&"group"===a.type?console.log("not allow move group to opened group, revert"):(this.moveNodeToEmpty(a,this.mouseNode),
c=!0):"group"===this.mouseNode.type?"group"===a.type?console.log("not allow move group to closed group, revert"):"open"===this.mouseNode.status?console.log("please put widget into the opened group panel"):!1===a.setting.inPanel?this._showOffPanelToGroupError():a.gnode&&a.gnode===this.mouseNode?console.log("the moving widget is already in the group"):(this.moveWidgetToGroup(a,this.mouseNode),c=!0):"widget"===this.mouseNode.type&&("group"===a.type?console.log("not allow move group to widget, revert"):
!1===a.setting.inPanel||!1===this.mouseNode.setting.inPanel?this._showOffPanelToGroupError():a.gnode||this.mouseNode.gnode?console.log("can not nest group"):(this.moveWidgetToWidget(a,this.mouseNode),c=!0)),this._reopenGroup());this.destroyShadowNode();c&&this.publishPoolChangeEvent();this.placeNodes()},_reopenGroup:function(){if(this.openedGNode){var a=this.openedGNode;this.closeGroup(a);this.nodeList.isExist(a)&&this.openGroup(a)}},getNodePosition:function(a){var b={},c;c=Math.ceil(a/v);a%=v;0===
a&&(a=v);b.t=118*(c-1);var e=89*(a-1)+15;b.l=window.isRTL?this.box.w-e-74:e;b.w=74;b.h=118;b.r=c;b.c=a;return b},getMarginNodePosition:function(a){var b={};a=a.pos;b.l=window.isRTL?a.l+74+7.5:a.l-7.5-2.5;b.t=a.t;b.w=5;b.h=118;return b},createMarginNode:function(a){var c=new q({label:a.label,node:a});b.place(c.domNode,this.domNode);return a.margin=c},getMousePosition:function(a){return{x:a.pageX-this.position.x,y:a.pageY-this.position.y+this.domNode.scrollTop}},moveNodeToMargin:function(a,b){var c=
this.getNodeByMarginNode(b);console.log("moveNodeToMargin");n(".node-margin-active",this.domNode).removeClass("node-margin-active");c.gnode&&!a.gnode?a.gnode=c.gnode:!c.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,c)},moveNodeToEmpty:function(a,b){n(".empty-node-active",this.domNode).removeClass("empty-node-active");b.gnode&&!a.gnode?a.gnode=b.gnode:!b.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,b)},getNodeByMarginNode:function(a){var b;this.nodeList.visitNodes(function(c){c.margin===
a&&(b=c)});return b},placeNodes:function(){var a,c;this.nodeList.visitNodes(f.hitch(this,function(d,e){a=this.getNodePosition(e);d.pos=a;b.setStyle(d.domNode,u(a));c=this.getMarginNodePosition(d);d.margin.pos=c;b.setStyle(d.margin.domNode,u(c))}));this.nodeList.printNodeList()},moveWidgetToGroup:function(a,b){a&&a.setting&&delete a.setting.openAtStart;b.addWidget(a);this.nodeList.removeNode(a)},moveWidgetToWidget:function(a,b){var c;a&&a.setting&&delete a.setting.openAtStart;c=this.createMoveableNode("group",
{label:this._getGroupLabel(),widgets:[a.setting,b.setting]});this.nodeList.insertNode(c,b);this.nodeList.removeNode(a);this.nodeList.removeNode(b)},createShadowNode:function(a){this.shadowNode=b.create("div",{"class":"node-shadow",style:u(b.getMarginBox(a.domNode))},this.domNode)},destroyShadowNode:function(){this.shadowNode&&b.destroy(this.shadowNode)},getNodeByMousePosition:function(a,b){var c;this.nodeList.visitNodes(function(d){if("addBtn"!==d.type){if(b.x>d.pos.l+10&&b.x<d.pos.l+d.pos.w-10&&
b.y>d.pos.t+10&&b.y<d.pos.t+d.pos.h-10&&d!==a)return c=d,!0;if(b.x>d.margin.pos.l&&b.x<d.margin.pos.l+d.margin.pos.w&&b.y>d.margin.pos.t&&b.y<d.margin.pos.t+d.margin.pos.h&&d.margin!==a)return c=d.margin,!0}});return c},_getGroupLabel:function(){var a=-1;this.appConfig.visitElement(f.hitch(this,function(b){if(b.widgets)if(b.label===this.nls.newGroup)a=0;else if(b.label.startWith(this.nls.newGroup)){var c=b.label.lastIndexOf("_");-1<c&&(b=parseInt(b.label.substr(c+1,b.label.length),10),a=Math.max(a,
b))}}));return-1===a?this.nls.newGroup:this.nls.newGroup+"_"+(a+1)},_showOffPanelToGroupError:function(){console.log("Off panel widget is not allowed in group.");this.emit("offpanel-group-error")},_onWidgetChoosePageOk:function(a,b){if(b.listName===this.name)if(1===a.length){var c;"addBtn"===b.type?c=a[0]:"group"===b.type?c=a[0]:(c=f.clone(b.setting),f.mixin(c,a[0]));l.publish("editWidget",c,b)}else"addBtn"===b.type&&(m.forEach(a,function(a){this.addWidget(a)},this),this.publishPoolChangeEvent())},
_onWidgetSettingPageOk:function(a,b){if(b.listName===this.name)if(a.id)l.publish("widgetChanged",a);else if("poolWidgets"===this.name)this.addWidget(a),this.publishPoolChangeEvent();else if("group"===b.type){var c=f.clone(this.appConfig.getConfigElementById(b.setting.id));c.widgets=[a];l.publish("groupChanged",c)}},publishPoolChangeEvent:function(){var a=[],b=[];this.nodeList.visitNodes(function(c,d){"widget"!==c.type||c.gnode?"group"===c.type&&(c.setting.index=d,a.push(c.setting)):(c.setting.index=
d,b.push(c.setting))});l.publish("widgetPoolChanged",{widgets:b,groups:a,controllerId:this.controller.id})}})})},"builder/plugins/widget-config/MoveableNode":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Evented dojo/aspect dojo/mouse dojo/touch dojo/topic dojo/query ./Mover dojo/dnd/move dijit/_WidgetBase jimu/dijit/Message jimu/utils dojo/NodeList-dom dojo/NodeList-manipulate".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q){var k="click",d=r.enter,w=r.leave;
"ontouchstart"in document&&(k=n.press,d=n.enter,w=n.leave);return p([u,l],{type:"",label:"",isMoving:!1,isMouseDown:!1,postCreate:function(){this.inherited(arguments);"addBtn"===this.type?(this.label="addBtn",this.createAddBtn()):"empty"===this.type?(this.label="empty",this.createEmptyNode()):"widget"===this.type?(this.createWidgetNode(),"poolWidgets"===this.listName&&(this.dnd=new a.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:c}),this.bindMoveEvent())):
"placeholder"===this.type?this.createPlaceholderNode():(this.createGroupNode(),"poolWidgets"===this.listName&&(this.dnd=new a.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:c}),this.bindMoveEvent()));f.addClass(this.domNode,"moveable");f.setStyle(this.domNode,{width:this.w+"px",height:this.h+"px"})},bindMoveEvent:function(){h.after(this.dnd,"onMoveStart",b.hitch(this,function(){this.isMoving=!0}),!0);h.after(this.dnd,"onMoveStop",b.hitch(this,function(){this.isMoving=
!1}),!0)},_createWidgetIconNode:function(){var a=q.processUrlInAppConfig(this.setting.icon);this.iconNode=f.create("img",{"class":"icon",src:a,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode)},_createPlaceholderNode:function(){this.placeholderNode=f.create("div",{"class":"placeholder",style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode);f.create("div",{"class":"placeholder-inner",innerHTML:this.setting.placeholderIndex,style:{width:"16px",height:"16px",
lineHeight:"16px",borderRadius:"8px",margin:"7px"}},this.placeholderNode)},createWidgetNode:function(){f.addClass(this.domNode,"widget-node");f.setAttr(this.domNode,"data-widget-name",this.setting.name);this.boxNode=f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this._createWidgetIconNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=
f.create("div",{"class":"label",innerHTML:q.stripHTML(this.label),title:this.label},this.domNode);!1===this.setting.visible&&f.addClass(this.domNode,"hide");this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(m(this.openAtStartNode,k,b.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.own(m(this.boxNode,d,b.hitch(this,function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});this.editNode=this._createEditNode();
this.own(m(this.editNode,k,b.hitch(this,function(a){a.stopPropagation();g.publish("editWidget",this.setting,this)})));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(m(this.openAtStartNode,k,b.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.setting.isThemeWidget||(!1===this.setting.inPanel&&this.setting.isOnScreen&&"undefined"===typeof this.setting.closeable?(this.switchNode=this._createSwitchNode(),
this.own(m(this.switchNode,k,b.hitch(this,function(a){a.stopPropagation();a=b.clone(this.setting);!1===a.visible?(a.visible=!0,f.removeClass(this.domNode,"hide")):(a.visible=!1,f.addClass(this.domNode,"hide"));g.publish("widgetChanged",a)})))):(this.dropNode=this._createDropNode(),this.own(m(this.dropNode,k,b.hitch(this,function(a){a.stopPropagation();var c=new v({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:b.hitch(this,function(){"poolWidgets"===this.listName?this.emit("removeNode"):
(this.setting.uri="",this.setting.label=this.nls.defaultWidgetLabel,this.setting.name=void 0,this.setting.placeholderIndex="?",this.setting.config=void 0,this.label=this.nls.defaultWidgetLabel,this.labelNode.innerHTML=q.stripHTML(this.label),q.widgetJson.removeManifestFromWidgetJson(this.setting),g.publish("widgetChanged",this.setting));c.close()})},{label:this.nls.cancel}]})})))))})));this.own(m(this.boxNode,w,b.hitch(this,function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});
this.editNode&&f.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&f.destroy(this.openAtStartNode);this.dropNode&&f.destroy(this.dropNode);this.switchNode&&f.destroy(this.switchNode)})))},createPlaceholderNode:function(){f.addClass(this.domNode,"widget-node");f.addClass(this.domNode,"placeholder");f.setAttr(this.domNode,"data-placeholder-index",this.setting.placeholderIndex);this.boxNode=f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);
this._createPlaceholderNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=f.create("div",{"class":"label",innerHTML:q.stripHTML(this.label),title:this.label},this.domNode);this.own(m(this.boxNode,d,b.hitch(this,function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"})})));this.own(m(this.boxNode,w,b.hitch(this,function(){g.publish("actionTriggered",
{elementId:this.setting.id,action:"removeHighLight"})})));this.own(m(this.domNode,k,b.hitch(this,function(){g.publish("chooseWidget",this,this.listName)})))},createGroupNode:function(){"poolWidgets"===this.listName?this._createPoolGroupNode():this._createOnScreenGroupNode()},_createOnScreenGroupNode:function(){if(1===this.setting.maxWidgets){f.addClass(this.domNode,"group-node");this.boxNode=f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);if(0===this.setting.widgets.length)this.iconNode=
f.create("img",{src:this.folderUrl+"css/images/add_onscreen_widget.png","class":"add-button",title:this.nls.addWidget},this.boxNode),this.name=this.label=this.nls.defaultWidgetLabel;else{var a=q.processUrlInAppConfig(this.setting.widgets[0].icon);this.iconNode=f.create("img",{"class":"icon",src:a,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode);a=this.setting.widgets[0];this.label=a.label;this.name=a.name}this.labelNode=f.create("div",{"class":"label",innerHTML:q.stripHTML(this.label),
title:this.label},this.domNode);this.own(m(this.boxNode,d,b.hitch(this,function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});0!==this.setting.widgets.length&&(this.editNode=this._createEditNode(),this.own(m(this.editNode,k,b.hitch(this,function(a){a.stopPropagation();g.publish("editWidget",this.setting.widgets[0],this)}))),this.own(m(this.editNode,"mousedown",function(a){a.stopPropagation()})),this.own(m(this.editNode,"mouseup",function(a){a.stopPropagation()})),this.dropNode=
this._createDropNode(),this.own(m(this.dropNode,k,b.hitch(this,function(a){var c=new v({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:b.hitch(this,function(){var a=b.clone(this.setting);a.widgets=[];g.publish("groupChanged",a);c.close()})},{label:this.nls.cancel}]});a.stopPropagation()}))),this.own(m(this.dropNode,"mousedown",function(a){a.stopPropagation()})),this.own(m(this.dropNode,"mouseup",function(a){a.stopPropagation()})))})));this.own(m(this.boxNode,w,b.hitch(this,
function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&f.destroy(this.editNode);this.dropNode&&f.destroy(this.dropNode)})));this.own(m(this.boxNode,k,b.hitch(this,function(){g.publish("chooseWidget",this,this.listName)})))}},_createPoolGroupNode:function(){f.addClass(this.domNode,"group-node");this.boxNode=f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this.label=this.setting.label?this.setting.label:"Group";
this.name=this.setting.name?this.setting.name:"Group";this.labelNode=f.create("div",{"class":"label",innerHTML:q.stripHTML(this.setting.label),title:this.setting.label},this.domNode);this._createSmallWidgets();this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(m(this.openAtStartNode,k,b.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.own(m(this.boxNode,d,b.hitch(this,function(){g.publish("actionTriggered",{elementId:this.setting.id,
action:"highLight"});this.editNode=this._createEditNode();this.own(m(this.editNode,k,b.hitch(this,function(a){a.stopPropagation();g.publish("editGroup",this,this.setting)})));this.own(m(this.editNode,"mousedown",function(a){a.stopPropagation()}));this.own(m(this.editNode,"mouseup",function(a){a.stopPropagation()}));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(m(this.openAtStartNode,k,b.hitch(this,function(a){a.stopPropagation();
this.emit("clickOpenAtStart")}))));this.dropNode=this._createDropNode();this.own(m(this.dropNode,k,b.hitch(this,function(a){var c=new v({message:this.nls.dropGroupMessage,buttons:[{label:this.nls.ok,onClick:b.hitch(this,function(){this.emit("removeNode");c.close()})},{label:this.nls.cancel}]});a.stopPropagation()})));this.own(m(this.dropNode,"mousedown",function(a){a.stopPropagation()}));this.own(m(this.dropNode,"mouseup",function(a){a.stopPropagation()}))})));this.own(m(this.boxNode,w,b.hitch(this,
function(){g.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&f.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&f.destroy(this.openAtStartNode);this.dropNode&&f.destroy(this.dropNode)})));this.own(m(this.boxNode,k,b.hitch(this,function(a){a.preventDefault();a.stopPropagation();"open"===this.status?this.closeGroup():this.openGroup()})))},closeGroup:function(){this.status="close"},openGroup:function(){this.status="open"},createAddBtn:function(){f.addClass(this.domNode,
"add-widget-node");var a=f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"},title:this.nls.addWidget},this.domNode);f.create("img",{src:this.folderUrl+"css/images/add_widget.png"},a);this.own(m(this.domNode,k,b.hitch(this,function(){g.publish("chooseWidget",this,this.listName)})))},createEmptyNode:function(){f.addClass(this.domNode,"empty-node");f.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode)},_createEditNode:function(){var a={bottom:"0",
width:"20px",height:"20px"};a[window.isRTL?"left":"right"]="0";return f.create("div",{"class":"edit-btn",style:a,title:this.nls.configureWidget},this.boxNode)},supportOpenAtStart:function(){var a=this.setting;return!a.isController&&!a.isThemeWidget&&a.visible&&(a.isOnScreen&&a.closeable||a.inPanel&&a.isOnScreen||!a.isOnScreen&&!this.gnode||"group"===this.type)},_createOpenAtStartNode:function(){var a={bottom:"4px",width:"12px",height:"12px"};a[window.isRTL?"right":"left"]="4px";return f.create("div",
{"class":this.setting.openAtStart?"open-at-start-btn active":"open-at-start-btn deactive",style:a,title:this.setting.openAtStart?this.nls.activeOpenAtStart:this.nls.deactiveOpenAtStart},this.boxNode)},_createDropNode:function(){var a={top:"0",width:"20px",height:"20px"};a[window.isRTL?"left":"right"]="0";return f.create("div",{"class":"drop-btn",style:a,title:this.nls.removeWidget},this.boxNode)},_createSwitchNode:function(){var a=f.hasClass(this.domNode,"hide")?this.nls.showWidget:this.nls.hideWidget,
b={top:"3px",width:"15px",height:"10px"};b[window.isRTL?"left":"right"]="3px";return f.create("div",{"class":"switch-btn",style:b,title:a},this.boxNode)},_createSmallWidgets:function(){e(".small",this.boxNode).remove();var a=[],c=!1;4<this.setting.widgets.length?(a=this.setting.widgets.slice(0,3),c=!0):(a=this.setting.widgets,c=!1);a.forEach(b.hitch(this,function(a){this._createSmallWidget(a)}));c&&this._createSmallMore()},_createSmallWidget:function(a){var b;b=f.create("div",{"class":"small small-widget",
"data-wid":a.id,style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);var c=a.icon;if(a.icon.startWith("widgets")||a.icon.startWith("configs")||a.icon.startWith("themes"))c=require(q.getRequireConfig()).toUrl(a.icon);f.create("img",{src:c,style:{width:"20px",height:"20px"}},b);return b},_createSmallMore:function(){var a;a=f.create("div",{"class":"small small-more",style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-
40)/3+"px"}},this.boxNode);f.create("img",{src:"builder/images/more_widget.png",style:{width:"20px"}},a);return a},addWidget:function(a){"group"!==this.type?console.log("can not add widget to widget"):(this.setting.widgets.push(a.setting),this._createSmallWidgets())},updateSmallWidgets:function(){this._createSmallWidgets()},destroy:function(){this.margin&&this.margin.destroy();this.inherited(arguments)}})})},"builder/plugins/widget-config/Mover":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/sniff dojo/_base/window dojo/dom dojo/dom-geometry dojo/dom-style dojo/Evented dojo/on dojo/touch dojo/dnd/common dojo/dnd/autoscroll".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){m.add("ie11",function(){var a=-1,b="",c=null;"Microsoft Internet Explorer"===navigator.appName?(b=navigator.userAgent,c=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(b=navigator.userAgent,c=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1)));return a});return f("dojo.dnd.Mover",[g],{constructor:function(a,f,g){function d(a){a.preventDefault();a.stopPropagation()}this.node=
h.byId(a);this.marginBox={l:f.pageX,t:f.pageY};this.mouseButton=f.button;f=this.host=g;a=a.ownerDocument;this.events=[e(a,c.move,b.hitch(this,"onFirstMove")),e(a,c.move,b.hitch(this,"onMouseMove")),e(a,c.release,b.hitch(this,"onMouseUp")),e(a,"dragstart",d),e(a.body,"selectstart",d)];u.autoScrollStart(a);if(f&&f.onMoveStart)f.onMoveStart(this)},onMouseMove:function(a){u.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},
onMouseUp:function(a){var b=m("webkit")&&m("mac")&&2===this.mouseButton,c=(m("ie")||m("ie11"))&&-1===this.mouseButton;(b||c?0===a.button:this.mouseButton===a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,c,d=this.host;switch(b.position){case "relative":case "absolute":c=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;default:b.position="absolute";b=r.getMarginBox(this.node);c=l.doc.body;var e=n.getComputedStyle(c),
f=r.getMarginBox(c,e),e=r.getContentBox(c,e);c=b.l-(e.l-f.l);b=b.t-(e.t-f.t)}this.marginBox.l=c-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(d&&d.onFirstMove)d.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){p.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"builder/plugins/widget-config/LinkList":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/_base/array"],
function(p){return p(null,{headNode:null,currentNode:null,constructor:function(f){this.name=f.name},visitNodes:function(f){for(var b=this.headNode,m=1;b;)f(b,m),m++,b=b.next},destroyAllNodes:function(){for(var f=this.headNode,b;f;)b=f.next,f.destroy(),f=null,f=b;this.headNode=null},getCount:function(){var f=0;this.visitNodes(function(b,m){f=m});return f},isExist:function(f){var b=!1;this.visitNodes(function(m){m===f&&(b=!0)});return b},printNodeList:function(){this.visitNodes(function(f){})},getPreNode:function(f){var b;
this.visitNodes(function(m){m.next===f&&(b=m)});return b},getNodeByIndex:function(f){var b;this.visitNodes(function(m,l){l===f&&(b=m)});return b},getNodeByLabel:function(f){var b;this.visitNodes(function(m){m.label===f&&(b=m)});return b},getNodeIndex:function(f){var b;this.visitNodes(function(m,l){m===f&&(b=l)});return b},removeNode:function(f){var b;(b=this.getPreNode(f))?b.next=f.next:this.headNode=f.next;f.destroy()},removeNodeByIndex:function(f){this.removeNode(this.getNodeByIndex(f))},insertNode:function(f,
b){var m,l;m="number"===typeof b?this.getNodeByIndex(b):b;(l=this.getPreNode(m))?l.next=f:this.headNode=f;f.next=m},moveNode:function(f,b){var m=this.getPreNode(f),l=this.getPreNode(b);f!==b&&f!==l&&(m?m.next=f.next:this.headNode=f.next,f.next=b,l?l.next=f:this.headNode=f)}})})},"builder/plugins/widget-config/WidgetSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/config dojo/Deferred dojo/request dojo/topic dojo/aspect dojo/on dojo/mouse dojo/query dojo/string dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./WidgetSettingPage.html ./WidgetDefaultSettingPage jimu/utils jimu/WidgetManager jimu/portalUrlUtils jimu/portalUtils jimu/dijit/ViewStack jimu/dijit/ImageChooser jimu/dijit/LoadingIndicator jimu/dijit/Message dijit/form/CheckBox esri/request".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z,C,B,E,G,I,J){var L="en de es fr ja ru zh-cn zh-tw zh-hk ar it ko pl pt-br pt-pt ro".split(" "),P=[],Q=null;return p([q,k,d],{templateString:w,startup:function(){this.inherited(arguments);this.own(r("builder/widgethelp.json",{handleAs:"json"}).then(function(a){Q=a},function(a){console.error(a)}).always(f.hitch(this,function(){this.domNode&&(this.own(e(window,"resize",f.hitch(this,this.resize))),this.init())})))},init:function(){this.loading=new E;
b.addClass(this.loading.domNode,"load-widget-setting");this.loading.placeAt(this.widgetSettingNode);this.initCommonAttr();this.initWidgetAttr();this.resize()},resize:function(){var a=b.getContentBox(this.domNode);b.setStyle(this.widgetSettingNode,{height:a.h-90+"px"})},onCancel:function(){this.onClose();this.popup.close()},onOk:function(){var a=this._checkLabelExist();if(a)return new G({message:a}),!1;this.imageChooser.imageData&&(this.setting.icon=this.imageChooser.imageData);this.setting.label=
x.stripHTML(this.labelNode.get("value"));if(this.settingDijit){a=this.settingDijit.getConfig(!0);if(!1===a)return!1;this.setting.config=a}delete this.setting.isDefaultConfig;n.publish("widgetSettingPageOk",this.setting,this.fromNode);this.onClose();this.popup.close()},_checkLabelExist:function(){var a=0,b=this.labelNode.get("value");if(""===u.trim(b))return this.nls.labelRequired;var c=x.getControllerWidgets(this.appConfig);this.appConfig.visitElement(f.hitch(this,function(d){this.setting.id!==d.id&&
d.label===b&&(0<c.length?a++:d.isOnScreen&&a++)}));return 0<a?this.nls.labelExists:""},onClose:function(){this.settingViewStack?(this.settingDijitUI.destroy(),this.settingDijitJSON.destroy(),this.settingViewStack.destroy()):this.settingDijit&&this.settingDijit.destroy()},_getHelpLink:function(a,b){var c=new h,d=null;a=a.toLowerCase();b="html"===(b||"html").toLowerCase()?"widgets2d":"widgets3d";if(window.isXT)r("/webappbuilder/help/exists",{handleAs:"json"}).then(f.hitch(this,function(e){e&&e.exists?
r("/webappbuilder/help/cxhelp.js",{handleAs:"json"}).then(f.hitch(this,function(e){var g="#";d=f.getObject("dev."+b+"."+a,!1,Q);e&&e.m&&d&&e.m[d]?g="/webappbuilder/help/"+e.m[d]:d&&(g="/webappbuilder/help/"+d);c.resolve(g)}),f.hitch(this,function(a){console.warn(a);c.resolve("#")})):c.resolve("#")}),function(a){console.error(a);c.resolve("#")});else{var e=y.getPortalUrlFromLocation();if(-1<e.indexOf("arcgis.com")){var g="#",d=f.getObject("online."+b+"."+a,!1,Q);"widgets3d"===b||l.locale.toLowerCase().startWith("en")||
-1<P.indexOf(a)||-1===L.indexOf(l.locale.toLowerCase())?(d&&(g="http://"+(-1<e.indexOf("maps.arcgis.com")?"doc":"docdev")+".arcgis.com/en/web-appbuilder/create-apps/"+d),c.resolve(g)):(g={url:y.getPortalSelfInfoUrl(e),content:{f:"json",culture:l.locale},handleAs:"json",callbackParamName:"callback",preventCache:!0},J(g).then(f.hitch(this,function(a){var b="#";if(a&&a.helpBase&&d)try{b=a.helpBase.split("/").slice(0,4).join("/")+"/web-appbuilder/create-apps/"+d}catch(D){b="http://doc.arcgis.com/en/web-appbuilder/create-apps/"+
d}c.resolve(b)}),f.hitch(this,function(a){console.warn(a);c.resolve("#")})))}else{var k=l.locale||"en",d=f.getObject("portal."+b+"."+a,!1,Q);r(e+"portalhelp/en/website/help/cxhelp.js",{handleAs:"json"}).then(f.hitch(this,function(a){var b="#";a&&a.m&&d&&a.m[d]&&(b=e+"portalhelp/"+k+"/website/help/"+a.m[d]);c.resolve(b)}),f.hitch(this,function(a){console.warn(a);c.resolve("#")}))}}return c},initCommonAttr:function(){var a=x.processUrlInAppConfig(this.setting.icon);b.setAttr(this.iconNode,"src",a);
this.labelNode.set("value",this.setting.label);this._getHelpLink(this.setting.name,f.getObject("manifest.platform",!1,this.setting)).then(f.hitch(this,function(a){"#"!==a&&(b.setStyle(this.helpNode,"display","inline-block"),b.setAttr(this.helpNode,"href",a))}));this.imageChooser=new B({goldenWidth:24,goldenHeight:24,format:[B.GIF,B.JPEG,B.PNG],label:this.nls.changeIcon},this.imageChooserPlaceholder);b.addClass(this.imageChooser.domNode,"jimu-float-leading");!1===this.setting.inPanel&&!0===this.setting.isOnScreen&&
!0!==this.setting.closeable?(this.imageChooser.disableChooseImage(),b.setAttr(this.imageChooser.domNode,"title",this.nls.unableChangeIcon)):(this.imageChooser.enableChooseImage(),this.own(e(this.imageChooser,"imageChange",f.hitch(this,function(a){this.iconNode.src=a;this.setting.icon=a}))))},initWidgetAttr:function(){!1===this.setting.hasConfig?this.widgetSettingNode.innerHTML='\x3cdiv class\x3d"noconfig-info"\x3e'+this.nls.noConfig+"\x3c/div\x3e":A.getInstance().tryLoadWidgetConfig(this.setting).then(f.hitch(this,
function(a){this.setting.hasSettingPage?A.getInstance().loadWidgetSettingPage(this.setting).then(f.hitch(this,function(a){this.widgetSettingNode?(this.settingDijit=a,b.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy(),b.setAttr(this.widgetSettingNode,"data-widget-loaded","true")):a.destroy()})):this.widgetSettingNode&&(this.settingDijit=new t({config:this.setting.config}),b.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),
this.loading.destroy())}))},setAppConfig:function(a){this.appConfig=a}})})},"builder/plugins/widget-config/WidgetDefaultSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dijit/_WidgetBase ./JSONEditor".split(" "),function(p,f,b,m,l,h){return p([l],{baseClass:"widget-default-setting",postCreate:function(){this.inherited(arguments);this.jsonEditor=new h({json:this.config});this.jsonEditor.placeAt(this.domNode);this.own(b(this.domNode,"keydown",f.hitch(this,"_onEnterPress")))},
_onEnterPress:function(b){(void 0!==b.keyCode?b.keyCode:b.which)===m.ENTER&&b.stopPropagation()},setConfig:function(b){return this.jsonEditor.setJSON(b)},getConfig:function(){return this.jsonEditor.getJSON()}})})},"builder/plugins/widget-config/JSONEditor":function(){define(["dojo/_base/declare","dijit/_WidgetBase"],function(p,f){return p([f],{baseClass:"json-editor",postCreate:function(){this.inherited(arguments);this.editor=ace.edit(this.domNode);this.editor.setTheme("ace/theme/textmate");this.editor.setHighlightActiveLine(!0);
this.editor.setValue(JSON.stringify(this.json,null,2));this.editor.getSession().setMode("ace/mode/json")},setJSON:function(b){this.json=b;this.editor.setValue(JSON.stringify(this.json,null,2))},getJSON:function(){return JSON.parse(this.editor.getValue())}})})},"builder/plugins/widget-config/GroupSettingPage":function(){define("dojo/_base/declare dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./GroupSettingPage.html".split(" "),function(p,f,b,m,l,h){return p([m,l],{templateString:h,
baseClass:"group-setting-page",startup:function(){this.labelNode.value=this.setting.label},onOk:function(){this.setting.label=f.get(this.labelNode,"value");b.publish("groupChanged",this.setting);this.popup.close()},onCancel:function(){}})})},"builder/plugins/widget-config/WidgetChoosePage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/on dojo/Deferred dojo/promise/all dojo/query dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./WidgetChoosePage.html jimu/dijit/Search jimu/WidgetManager jimu/dijit/LoadingShelter jimu/dijit/Message jimu/dijit/TabContainer3 jimu/utils jimu/portalUtils jimu/portalUrlUtils builder/serviceUtils ./CustomWidgets".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y,z){return p([c,a],{templateString:u,showCustomWidgets:!1,postMixInProperties:function(){this.widgetManager=q.getInstance()},startup:function(){this.inherited(arguments);this.showCustomWidgets||b.addClass(this.domNode,"hide-custom-widgets");this.tab=new w({tabs:[{title:this.nls.officialWidgets,content:this.officialSection},{title:this.nls.customWidgets,content:this.customSection}]});this.tab.placeAt(this.domNode);this.searchDijit1=new v({placeholder:this.nls.widgetSearchHint,
onSearch:f.hitch(this,this.searchWidget),searchWhenInput:!0},this.searchInputNode);this._getWidgets();this.own(h(window,"resize",f.hitch(this,this.resize)));setTimeout(f.hitch(this,function(){this.resize()}),100);this.loading=new k({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup();this.showCustomWidgets&&(this.searchDijit2=new v({placeholder:this.nls.widgetSearchHint,onSearch:f.hitch(this,this._onSearchCustomWidget),searchWhenInput:!1},this.customSearchInputNode),this.allCustomWidgets=
new z({portalUrl:window.portalUrl}),this.allCustomWidgets.placeAt(this.customSection),this.filterCustomWidgets=new z({portalUrl:window.portalUrl,hidden:!0}),this.filterCustomWidgets.placeAt(this.customSection),this.own(h(this.tab,"tabChanged",f.hitch(this,function(a){a!==this.nls.customWidgets||this.allCustomWidgets.queried||(this.allCustomWidgets.queried=!0,this.allCustomWidgets.queryItems())}))))},_onSearchCustomWidget:function(a){a?(this.allCustomWidgets.hide(),this.filterCustomWidgets.show(),
this.filterCustomWidgets.queryItems({q:'title:"'+a+'"'})):(this.allCustomWidgets.show(),this.filterCustomWidgets.hide())},searchWidget:function(a){var b;b=""===a?this.allWidgets:m.filter(this.allWidgets,function(b){if(-1<b.label.toUpperCase().indexOf(a.toUpperCase()))return!0});this._createWidgetNodes(b)},resize:function(){var a=b.getContentBox(this.domNode).h,c=a-60;b.setStyle(this.searchSectionNode,{height:a+"px"});b.setStyle(this.widgetListNode,{height:c+"px"})},setAppConfig:function(a){this.appConfig=
a},_getWidgets:function(){var a={};this.appConfig.map["2D"]&&(a.support2D=!0);this.appConfig.map["3D"]&&(a.support3D=!0);this.appConfig.map["2D"]&&this.appConfig.map["3D"]&&(a.support2D=!0,a.support3D=!0);a.platform=window.stemappInfo.appType;this.options.includeOffPanel||(a["properties.inPanel"]=!0);y.searchWidgets(a).then(f.hitch(this,function(a){a.success?(this.allWidgets=this._filterSingletonWidgets(a.widgets),this._createWidgetNodes(this.allWidgets)):console.log(a.message)}))},_filterSingletonWidgets:function(a){return m.filter(a,
function(a){return!1===a.properties.supportMultiInstance&&this._checkWidgetIsInAppConfig(this.appConfig,a.name)?!1:!0},this)},_checkWidgetIsInAppConfig:function(a,b){var c=[];0===t.getControllerWidgets(a).length?a.visitElement(f.hitch(this,function(a){a.isOnScreen&&a.name===b&&c.push(a)})):c=a.getConfigElementsByName(b);return 0<c.length},_createWidgetNodes:function(a){b.empty(this.widgetListNode);m.forEach(a,function(a){this._createWidgetNode(a)},this)},_createWidgetNode:function(a){var c,d;c=b.create("div",
{"class":"widget-node","data-widget-name":a.name},this.widgetListNode);d=b.create("div",{"class":"box"},c);b.create("div",{"class":"box-selected"},c);b.create("img",{"class":"icon",src:a.icon},d);b.create("div",{"class":"label",innerHTML:t.stripHTML(a.label),title:a.label},c);c.setting={name:a.name,label:a.label,version:a.version,closeable:"removeableWidgetOnScreen"===this.fromList?!0:void 0};t.widgetJson.addManifest2WidgetJson(c.setting,a);c.setting.uri=a.amdFolder+"Widget";c.box=d;this.own(h(c,
"click",f.hitch(this,this._onWidgetClick,c)));return c},_onWidgetClick:function(a){"addBtn"===this.fromNode.type?b.hasClass(a,"jimu-state-selected")?b.removeClass(a,"jimu-state-selected"):b.addClass(a,"jimu-state-selected"):(g(".jimu-state-selected",this.domNode).removeClass("jimu-state-selected"),b.addClass(a,"jimu-state-selected"))},onOk:function(){(0===this.tab.getSelectedIndex()?this._getOfficialSelection():this._getCustomSelection()).then(f.hitch(this,function(a){var b=[];m.forEach(a,function(a){b.push(this._copyWidget(a))},
this);n(b).then(f.hitch(this,function(b){var c;for(c=0;c<b.length;c++)if(!b[c].success){new d({message:b[c].message});this.loading.hide();return}this.loading.hide();l.publish("widgetChoosePageOk",a,this.fromNode);this.popup.close()}))}),function(a){console.error(a.stack)})},_getOfficialSelection:function(){var a=new r,b=g(".jimu-state-selected",this.domNode);if(0===b.length)return new d({message:this.nls.emptyMessage}),a.reject({message:this.nls.emptyMessage}),a;this.loading.show();b=m.map(b,function(a){return f.clone(a.setting)});
a.resolve(b);return a},_getCustomSelection:function(){var a=[],a=this.allCustomWidgets.isVisible()?this.allCustomWidgets.getSelectedWidgetItems():this.filterCustomWidgets.getSelectedWidgetItems();return n(a.map(function(a){return y.getManifestFromItem(a.id).then(function(a){var b={name:a.name,label:a.label,version:a.version};t.widgetJson.addManifest2WidgetJson(b,a);b.uri=a.amdFolder+"Widget";return b})}))},_copyWidget:function(a){var b=0,c,d=[],e=t.getControllerWidgets(this.appConfig);this.appConfig.visitElement(f.hitch(this,
function(c){if(0!==e.length||c.isOnScreen)c.name===a.name&&b++,d.push(c.label)}));a.icon=a.manifest.folderUrl+"images/icon.png?wab_dv\x3d"+window.deployVersion;if(0===b)a.label=a.label,c=y.copyWidgetToApp(window.appInfo.id,a.name);else if(0<b){c=new r;for(var g=a.label+"_"+(b+1);-1<d.indexOf(g);)b++,g=a.label+"_"+(b+1);a.label=g;c.resolve({success:!0})}return c}})})},"builder/plugins/widget-config/CustomWidgets":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomWidgets.html dojo/Evented dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){return p([f,b,m,h],{templateString:l,baseClass:"custom-widgets",query:null,nls:null,type:"Code Sample",portalUrl:null,hidden:!1,postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this.portalUrl=u.getStandardPortalUrl(this.portalUrl);this.portal=a.getPortal(this.portalUrl);this.baseQ='type:"'+this.type+'" ';this.hidden&&this.hide()},queryItems:function(a){a=a||{};this.loading.show();this.clear();n.mixin(this.query,
a);this.query.start=1;this.query.q=a.q?this.baseQ+" AND "+a.q:this.baseQ;return this.portal.queryItems(this.query).then(n.hitch(this,function(a){if(this.domNode)return this.domNode&&this.loading.hide(),this.query.start=a.nextStart,this._createItemsNode(a)}),n.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))},_createItemsNode:function(a){a=a.results;var b=this.type.toLowerCase();a=g.filter(a,n.hitch(this,function(a){return(a.type&&a.type.toLowerCase()||"")===b}));g.forEach(a,
n.hitch(this,function(a){this._createItemNode(a)}));return a},_createItemNode:function(a){var b=e.toDom('\x3cdiv class\x3d"widget-node"\x3e\x3cdiv class\x3d"box"\x3e\x3cimg class\x3d"icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"box-selected"\x3e\x3c/div\x3e\x3cdiv class\x3d"label"\x3e\x3c/div\x3e\x3c/div\x3e');b.item=a;r("img",b)[0].src=a.itemUrl+"/info/images/icon.png";r(".label",b)[0].innerHTML=a.title||"";e.place(b,this.list)},clear:function(){this.query={q:this.baseQ,sortField:"title",sortOrder:"asc",
num:100,start:1};e.empty(this.list)},_onClick:function(a){a=a.target||a.srcElement;var b=null;(b=e.hasClass(a,"widget-node")?a:c.getAncestorDom(a,function(a){return e.hasClass(a,"widget-node")},this.list))&&e.toggleClass(b,"jimu-state-selected")},_onScroll:function(){this._isScrollToBottom(this.domNode)},_isScrollToBottom:function(a){return c.isScrollToBottom(a)},getSelectedWidgetItems:function(){var a=r(".widget-node.jimu-state-selected",this.domNode);return g.map(a,n.hitch(this,function(a){return a.item}))},
isVisible:function(){return!e.hasClass(this.domNode,"hidden")},show:function(){e.removeClass(this.domNode,"hidden")},hide:function(){e.addClass(this.domNode,"hidden")}})})},"jimu/PoolControllerMixin":function(){define(["dojo/_base/declare","dojo/_base/array","jimu/PanelManager"],function(p,f,b){return p(null,{constructor:function(){this.panelManager=b.getInstance()},postCreate:function(){this.controlledWidgets||(this.controlledWidgets="all");this.controlledGroups||(this.controlledGroups="all")},getOpenedIds:function(){},
setOpenedIds:function(b){},getConfigById:function(b){for(var f=this.getAllConfigs(),h=0;h<f.length;h++)if(f[h].id===b)return f[h]},getAllConfigs:function(){var b=[],b=b.concat(this.getWidgetConfigs(),this.getGroupConfigs()),b=f.filter(b,function(b){return b.visible});return b.sort(function(b,f){return b.index-f.index})},getAllConfigsIncludeInvisible:function(){var b=[],b=b.concat(this.getWidgetConfigs(),this.getGroupConfigs());return b.sort(function(b,f){return b.index-f.index})},isControlled:function(b){return f.some(this.getAllConfigsIncludeInvisible(),
function(f){return f.id===b})},widgetIsControlled:function(b){return f.some(this.getAllConfigsIncludeInvisible(),function(l){return l.id===b?!0:f.some(l.widgets,function(f){return f.id===b})})},getGroupConfigs:function(){var b=[];if(!this.appConfig.widgetPool)return b;this.appConfig.widgetPool.groups&&f.forEach(this.appConfig.widgetPool.groups,function(f){this.controlledGroups&&(Array.isArray(this.controlledGroups)?-1<this.controlledGroups.indexOf(f.id)&&b.push(f):"all"===this.controlledGroups&&b.push(f))},
this);return b},getWidgetConfigs:function(){var b=[];if(!this.appConfig.widgetPool)return b;this.appConfig.widgetPool.widgets&&f.forEach(this.appConfig.widgetPool.widgets,function(f){this.controlledWidgets&&(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(f.id)&&b.push(f):"all"===this.controlledWidgets&&b.push(f))},this);return b}})})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/promise/all dojo/on dojo/topic dojo/when require ./utils ./WidgetManager".split(" "),
function(p,f,b,m,l,h,r,n,g,e,c,a,u){var v,q=null;v=p(null,{constructor:function(){this.panels=[];this.widgetManager=u.getInstance();n(window,"resize",f.hitch(this,this.onWindowResize));this.activePanel=null;g.subscribe("/dnd/move/start",f.hitch(this,this._onMoveStart));g.subscribe("widgetActived",f.hitch(this,this._onWidgetActived))},showPanel:function(b){var c=new h,e=this.getPanelById(b.id+"_panel");e?("closed"===e.state&&this.openPanel(e),c.resolve(e)):r({Panel:this._loadPanelClass(b.panel.uri),
nls:this._loadThemeI18N(b.panel.uri)}).then(f.hitch(this,function(d){var e=b.id+"_panel",g=this.getPanelById(e),h={label:b.label,config:b,uri:b.panel.uri,position:b.panel.position,map:this.map,widgetManager:this.widgetManager,panelManager:this,id:e,gid:b.gid,nls:d.nls};f.mixin(h,b.panel.options);try{g=new d.Panel(h),console.log("panel ["+e+"] created.")}catch(z){console.log("create panel error: "+z+", panelId: "+e);c.reject(z);return}g.setPosition(b.panel.position);a.setVerticalCenter(g.domNode);
this.openPanel(g);this.panels.push(g);n(g.domNode,"click",f.hitch(this,this._onPanelClick,g));c.resolve(g)}));return c},setMap:function(a){this.map=a;n(this.map,"resize",f.hitch(this,this.onMapResize))},closeOtherPanelsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;for(var b=0;b<this.panels.length;b++)this.panels[b].gid===a.gid&&this.panels[b].id!==a.id&&this.closePanel(this.panels[b])},closeAllPanelsInGroup:function(a){for(var b=0;b<this.panels.length;b++)this.panels[b].gid===
a&&this.closePanel(this.panels[b])},openPanel:function(a){var b=new h;if("string"===typeof a&&(a=this.getPanelById(a),!a))return b.reject(),b;if(!a.started)try{a.started=!0,a.startup()}catch(w){console.error("fail to startup panel "+a.id+". "+w.stack)}if("opened"===a.state)return b.resolve(a),b;a.setState("opened");return this.playOpenPanelAnimation(a).then(f.hitch(this,function(){m.setStyle(a.domNode,"display","");a.onOpen();this._activePanel(a);return a}))},closePanel:function(a){var b=new h;return"string"===
typeof a&&(a=this.getPanelById(a),!a)||"closed"===a.state?(b.resolve(),b):this.playClosePanelAnimation(a).then(function(){this.activePanel&&this.activePanel.id===a.id&&(this.activePanel.onDeActive(),this.activePanel=null);a.setState("closed");a.onClose();a.domNode&&m.setStyle(a.domNode,"display","none")})},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(d){console.log(console.error("fail to minimize panel "+
a.id+". "+d.stack))}},maximizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");try{a.onMaximize()}catch(d){console.log(console.error("fail to maximize panel "+a.id+". "+d.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(d){console.log(console.error("fail to noralize panel "+
a.id+". "+d.stack))}},changeWindowStateTo:function(a,b){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"normal"===b?this.normalizePanel(a):"minimized"===b?this.minimizePanel(a):"maximized"===b?this.maximizePanel(a):console.log("error state: "+b)},getPanelById:function(a){for(var b=0;b<this.panels.length;b++)if(this.panels[b].id===a)return this.panels[b]},onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"!==this.panels[a].position.relativeTo&&
this.panels[a].resize()},onMapResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"===this.panels[a].position.relativeTo&&this.panels[a].resize()},destroyPanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a);this._removePanel(a);try{a.destroy()}catch(d){console.log(console.error("fail to destroy panel "+a.id+". "+d.stack))}}},destroyAllPanels:function(){var a=b.map(this.panels,function(a){return a.id});
b.forEach(a,function(a){this.destroyPanel(a)},this);this.panels=[]},playOpenPanelAnimation:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a)||!a.openAnimation||0===a.animationDuration)return e();var b=new h;"string"===typeof a.openAnimation?"fadeIn"===a.openAnimation?(m.setStyle(a.domNode,{opacity:0,display:""}),l.fadeIn({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play()):b.resolve():b.resolve();return b},playClosePanelAnimation:function(a){if("string"===
typeof a&&(a=this.getPanelById(a),!a)||!a.closeAnimation||0===a.animationDuration)return e();var b=new h;"string"===typeof a.closeAnimation&&("fadeOut"===a.closeAnimation?l.fadeOut({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play():b.resolve());return b},getPositionOnMobile:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return{};var b=m.getMarginBox(window.jimuConfig.layoutId),c=b.h/2;a.titleHeight||(a.titleHeight=35);return"maximized"===a.windowState?
{left:0,right:0,top:0,bottom:0,width:"auto",height:"auto",contentHeight:b.h-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomLeftRadius:0,borderBottomRightRadius:0}}:"minimized"===a.windowState?b.h>b.w?{left:0,right:0,top:"auto",bottom:0,width:"auto",height:a.titleHeight,contentHeight:0,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0}}:{left:b.w-b.w/2,right:0,top:"auto",bottom:0,width:b.w/
2,height:a.titleHeight,contentHeight:b.h,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}:b.h>b.w?{left:0,right:0,top:c,bottom:0,width:"auto",height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0}}:
{left:b.w-b.w/2,right:0,top:0,bottom:0,width:b.w/2,height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}},_onPanelClick:function(a){this._activePanel(a)},_activePanel:function(a){if(this.activePanel){if(this.activePanel.id===a.id){this.activePanel.moveTopOnActive&&
m.setStyle(this.activePanel.domNode,"zIndex",101);return}"active"===this.activePanel.state&&(this.activePanel.setState("opened"),m.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive())}var b=this.widgetManager.activeWidget;b&&"active"===b.state&&b.getPanel()!==a&&(b.setState("opened"),!1===b.inPanel&&m.setStyle(b.domNode,"zIndex","undefined"!==typeof b.position.zIndex?b.position.zIndex:
"auto"),b.onDeActive(),this.widgetManager.activeWidget=null);this.activePanel=a;"active"!==this.activePanel.state&&(this.activePanel.setState("active"),this.activePanel.moveTopOnActive&&m.setStyle(this.activePanel.domNode,"zIndex",101),this.activePanel.onActive())},_removePanel:function(a){var b=this.panels.indexOf(a);-1<b&&this.panels.splice(b,1);this.activePanel&&this.activePanel.id===a.id&&(this.activePanel=null)},_onMoveStart:function(a){b.forEach(this.panels,function(b){b.domNode===a.node&&this._activePanel(b)},
this)},_onWidgetActived:function(a){this.activePanel&&"active"===this.activePanel.state&&a.getPanel()!==this.activePanel&&(this.activePanel.setState("opened"),m.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive(),this.activePanel=null)},_loadPanelClass:function(a){var b=new h;c([a],function(a){b.resolve(a)});return b},_loadThemeI18N:function(a){var b=new h;a.startWith("themes")?(a=a.split("/"),
c(["dojo/i18n!"+(a[0]+"/"+a[1]+"/nls/strings")],function(a){b.resolve(a)})):b.resolve({});return b}});v.getInstance=function(){null===q&&(q=new v,window._panelManager=q);return q};return v})},"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/plugins/plugins.json":'{\n  "app-actions.launch-app": {\n    "name": "app-actions.launch-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.launch-app"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-actions.preview-app": {\n    "name": "app-actions.preview-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "HTML",\n          "index": 2\n        },\n        "pluginName": "app-actions.preview-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.save-app": {\n    "name": "app-actions.save-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 3\n        },\n        "pluginName": "app-actions.save-app"\n      },\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "_onClick",\n          "index": 1\n        },\n        "pluginName": "app-actions.save-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.to-template-config": {\n    "name": "app-actions.to-template-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.to-template-config"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-config": {\n    "name": "app-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-template": {\n        "description": "Config template",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-template",\n        "name": "config-template",\n        "extensions": [\n          {\n            "point": "app-config.config-template",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-templateconfig"\n          }\n        ]\n      },\n      "config-part": {\n        "description": "The config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-part",\n        "name": "config-part",\n        "extensions": [\n          {\n            "point": "app-config.config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-configpart"\n          }\n        ]\n      },\n      "morepreview-selction-part": {\n        "description": "The more preview selection part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.morepreview-selction-part",\n        "name": "morepreview-selction-part",\n        "extensions": [\n          {\n            "point": "app-config.morepreview-selction-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-morepreview-selectionpart"\n          }\n        ]\n      },\n      "template-config-part": {\n        "description": "The Template config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.template-config-part",\n        "name": "template-config-part",\n        "extensions": [\n          {\n            "point": "app-config.template-config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-template-configpart"\n          }\n        ]\n      },\n      "main-app-actions": {\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.main-app-actions",\n        "name": "main-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.launch-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "HTML",\n              "index": 2\n            },\n            "pluginName": "app-actions.preview-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 3\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.to-template-config"\n          }\n        ]\n      },\n      "popup-app-actions": {\n        "parameters": {\n          "onClickAction": {\n            "type": "function",\n            "name": "onClickAction"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.popup-app-actions",\n        "name": "popup-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "_onClick",\n              "index": 1\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 4\n            },\n            "pluginName": "popup-actions.configmode-switch"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 3\n            },\n            "pluginName": "popup-actions.popup-agoltemplate"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 2\n            },\n            "pluginName": "popup-actions.popup-saveas"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "startup.app-config",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config"\n      }\n    ],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-configpart": {\n    "name": "app-config-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-sections": {\n        "description": "The config page for section of full config",\n        "parameters": {\n          "label": {\n            "type": "string",\n            "required": true,\n            "name": "label"\n          },\n          "icon": {\n            "type": "url",\n            "required": true,\n            "name": "icon"\n          },\n          "selectedIcon": {\n            "type": "url",\n            "required": true,\n            "name": "selectedIcon"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "republishEvents": {\n            "type": "string",\n            "required": true,\n            "description": "The events that change app config. These events will be pushed to preview window",\n            "name": "republishEvents"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config-configpart.config-sections",\n        "name": "config-sections",\n        "extensions": [\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n              "index": 4\n            },\n            "pluginName": "attribute-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged",\n              "index": 2\n            },\n            "pluginName": "map-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "themeChanged,styleChanged,layoutChanged",\n              "index": 1\n            },\n            "pluginName": "theme-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged",\n              "index": 3\n            },\n            "pluginName": "widget-config"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "app-config.config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-morepreview-selectionpart": {\n    "name": "app-config-morepreview-selectionpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.morepreview-selction-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-morepreview-selectionpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-template-configpart": {\n    "name": "app-config-template-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the template config part.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.template-config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-template-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-templateconfig": {\n    "name": "app-config-templateconfig",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.config-template",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-templateconfig"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-list": {\n    "name": "app-list",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "startup.app-list",\n        "description": "",\n        "pluginName": "app-list"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "attribute-config": {\n    "name": "attribute-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n          "index": 4\n        },\n        "pluginName": "attribute-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "creation-entry": {\n    "name": "creation-entry",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.creation-entry",\n        "description": "",\n        "pluginName": "creation-entry"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "header": {\n    "name": "header",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.header",\n        "description": "",\n        "pluginName": "header"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "map-config": {\n    "name": "map-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged",\n          "index": 2\n        },\n        "pluginName": "map-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "popup-actions.configmode-switch": {\n    "name": "popup-actions.configmode-switch",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 4\n        },\n        "pluginName": "popup-actions.configmode-switch"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-agoltemplate": {\n    "name": "popup-actions.popup-agoltemplate",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 3\n        },\n        "pluginName": "popup-actions.popup-agoltemplate"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-saveas": {\n    "name": "popup-actions.popup-saveas",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 2\n        },\n        "pluginName": "popup-actions.popup-saveas"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-share": {\n    "name": "popup-actions.popup-share",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 1,\n          "republishEvents": "SharePluginOnClickEveryone"\n        },\n        "pluginName": "popup-actions.popup-share"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": false,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "startup": {\n    "name": "startup",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "app-list": {\n        "description": "the app list page.",\n        "id": "startup.app-list",\n        "name": "app-list",\n        "extensions": [\n          {\n            "point": "startup.app-list",\n            "description": "",\n            "pluginName": "app-list"\n          }\n        ]\n      },\n      "header": {\n        "description": "the header.",\n        "id": "startup.header",\n        "name": "header",\n        "extensions": [\n          {\n            "point": "startup.header",\n            "description": "",\n            "pluginName": "header"\n          }\n        ]\n      },\n      "app-config": {\n        "description": "the app config page.",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "startup.app-config",\n        "name": "app-config",\n        "extensions": [\n          {\n            "point": "startup.app-config",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config"\n          }\n        ]\n      },\n      "creation-entry": {\n        "description": "The create new entry point.",\n        "id": "startup.creation-entry",\n        "name": "creation-entry",\n        "extensions": [\n          {\n            "point": "startup.creation-entry",\n            "description": "",\n            "pluginName": "creation-entry"\n          }\n        ]\n      },\n      "stemapps": {\n        "description": "the stemapp.",\n        "parameters": {\n          "appType": {\n            "type": "string",\n            "required": true,\n            "name": "appType"\n          },\n          "appPath": {\n            "type": "string",\n            "description": "By default, it\'s plugin\'s folder path",\n            "name": "appPath"\n          },\n          "appVersionManager": {\n            "type": "string",\n            "description": "path relative to app path. required if app config is old.",\n            "name": "appVersionManager"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "startup.stemapps",\n        "name": "stemapps",\n        "extensions": [\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML",\n              "appPath": "../../../../stemapp/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 1\n            },\n            "pluginName": "stemapps.web2d"\n          },\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML3D",\n              "appPath": "../../../../stemapp3d/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 2\n            },\n            "pluginName": "stemapps.web3d"\n          }\n        ]\n      }\n    },\n    "extensions": [],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web2d": {\n    "name": "stemapps.web2d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML",\n          "appPath": "../../../../stemapp/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 1\n        },\n        "pluginName": "stemapps.web2d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web3d": {\n    "name": "stemapps.web3d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML3D",\n          "appPath": "../../../../stemapp3d/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 2\n        },\n        "pluginName": "stemapps.web3d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "theme-config": {\n    "name": "theme-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "themeChanged,styleChanged,layoutChanged",\n          "index": 1\n        },\n        "pluginName": "theme-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "widget-config": {\n    "name": "widget-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged",\n          "index": 3\n        },\n        "pluginName": "widget-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  }\n}\n',
"url:builder/plugins/app-actions/launch-app/css/style.css":".plugin-app-actions-launch-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-launch-app .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-launch-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-launch-app a{color: inherit; display: block; text-decoration: none; height: 47px;}.plugin-app-actions-launch-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.png);}",
"url:builder/plugins/app-actions/preview-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button  preview-button" data-dojo-attach-point\x3d"btnPreview" title\x3d${nls.previewMore}\x3e${nls.previewMore}\x3c/div\x3e\r\n  \x3cdiv class\x3d"footer-button  config-button" style\x3d"display:none" data-dojo-attach-point\x3d"btnConfig" title\x3d${nls.back2Configure}\x3e${nls.back2Configure}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/preview-app/css/style.css":".plugin-app-actions-preview-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-preview-app .footer-button{background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-preview-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-preview-app:hover .footer-button {color:#24B5CC;}.plugin-app-actions-preview-app .footer-button.preview-button{background-image: url(images/icon.png);}.plugin-app-actions-preview-app:hover .footer-button.preview-button{background-image: url(images/hover_icon.png);}.plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure01.png);}.jimu-rtl .plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure03.png);}.plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure02.png);}.jimu-rtl .plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure04.png);}",
"url:builder/plugins/app-actions/save-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button" title\x3d${nls.label} data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/save-app/css/style.css":".plugin-app-actions-save-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-save-app .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-save-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-save-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.png);}.plugin-app-actions-save-app .footer-button.save-enable{background-image:url(images/hover_icon.png); background-repeat: no-repeat; color: #24B5CC;}.plugin-app-actions-save-app .footer-button.save-block{color: #d2dae2; background-image: url(images/block_icon.png);}",
"url:builder/plugins/app-actions/to-template-config/css/style.css":".plugin-app-actions-to-template-config{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-to-template-config .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-to-template-config .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-to-template-config:hover .footer-button{color:#15a4fa; background-image: url(images/hover_icon.png);}",
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imgDiv" class\x3d"img-div"\x3e\r\n        \x3cimg data-dojo-attach-point\x3d"loadingImg"/\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-config/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"at-view-stack" data-dojo-attach-point\x3d"atViewStackNode"\x3e\r\n    \x3cdiv class\x3d"config-app-pane" data-dojo-attach-point\x3d"configAppNode"\x3e\r\n      \x3cdiv class\x3d"left-pane" data-dojo-attach-point\x3d"leftPaneNode"\x3e\r\n        \x3cdiv class\x3d"opts-viewstack" data-dojo-attach-point\x3d"optsViewStackNode"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"configOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"morePreviewOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv data-dojo-attach-point\x3d"templateOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"actions-pane" data-dojo-attach-point\x3d"actionsPaneNode"\x3e\r\n          \x3cdiv class\x3d"main-action-box" data-dojo-attach-point\x3d"mainActionBoxNode"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"footer-button-arrow jimu-float-leading" data-dojo-attach-point\x3d"btnArrow" data-dojo-attach-event\x3d"onclick: _onBtnArrowClick"\x3e\r\n            \x3cdiv class\x3d"foot-menu" data-dojo-attach-point\x3d"popupActionsMenu"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-preview-section" data-dojo-attach-point\x3d"rightPreviewSection"\x3e\r\n        \x3cdiv class\x3d"preview-config" data-dojo-attach-point\x3d"previewConfig"\x3e\r\n          \x3ciframe name\x3d"previewConfigFrame" data-dojo-attach-point\x3d"previewConfigFrameNode" style\x3d"border:none" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"preview-more" data-dojo-attach-point\x3d"previewMore"\x3e\r\n          \x3cdiv class\x3d"preview-more-iframe-section" data-dojo-attach-point\x3d"previewMoreIframeSection"\x3e\r\n            \x3cdiv class\x3d"preview-more-iframe-container" data-dojo-attach-point\x3d"previewMoreContainer"\x3e\r\n              \x3ciframe name\x3d"previewMoreFrame" data-dojo-attach-point\x3d"previewMoreFrameNode" style\x3d"border-color:#cad1d9;" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"description" data-dojo-attach-point\x3d"previewMoreDes"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"screen-switch-section"\x3e\r\n            \x3cdiv class\x3d"portrait jimu-float-leading selected" data-dojo-attach-point\x3d"btnPortrait"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"landscape jimu-float-trailing" data-dojo-attach-point\x3d"btnLandscape"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-template-pane" data-dojo-attach-point\x3d"configTemplateNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config/css/style.css":".plugin-config-app .at-view-stack{width: 100%; height: 100%; position: relative;}.plugin-config-app .at-view-stack \x3e .view{position: absolute; left: 0; top: 0;}.plugin-config-app .at-view-stack \x3e .view.config-app-pane{display: block !important; visibility: hidden;}.plugin-config-app .at-view-stack \x3e .view.config-template-pane{z-index: 2;}.plugin-config-app .left-pane{font-size: 20px; width: 400px; height: 100%; position: absolute; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-app .left-pane .opts-viewstack{position: absolute; left: 0; right: 0; top: 0; bottom: 50px;}.plugin-config-app .right-preview-section{position: absolute; left: 400px; top: 0; right: 0; height: 100%;}.plugin-config-app .right-preview-section .preview-viewstack{width:100%; height:100%;}.plugin-config-app .preview-config,.plugin-config-app .preview-more{width:100%; height:100%;}.plugin-config-app .preview-config iframe{width: 100%; height: 100%;}.plugin-config-app .preview-more{position:relative; background-color:#f3f3f3; overflow:auto;}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container{margin-left:auto; margin-right:auto; background:#eaecee; padding:20px; border:2px solid #666; -webkit-border-radius:15px; -moz-border-radius:15px; -o-border-radius:15px; -ms-border-radius:15px; border-radius:15px; -webkit-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -moz-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -o-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -ms-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9);}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container iframe{width:100%; height:100%;}.plugin-config-app .preview-more .description{display:none; text-align:center; font-size:15px; margin-top:20px;}.plugin-config-app .preview-more .screen-switch-section{position:absolute; right:12px; top:12px; height:38px;}.jimu-rtl .plugin-config-app .preview-more .screen-switch-section{right: auto; left: 12px;}.plugin-config-app .preview-more .screen-switch-section div{width:38px; height:100%; background-repeat:no-repeat; background-position:center center; cursor:pointer; background-color:#FFFFFF;}.plugin-config-app .preview-more .screen-switch-section div.selected{background-color:#F7F8F8;}.plugin-config-app .preview-more .screen-switch-section .portrait{border-top-left-radius:3px; border-bottom-left-radius:3px; background-image:url(images/portrait.png);}.plugin-config-app .preview-more .screen-switch-section .landscape{border-top-right-radius:3px; border-bottom-right-radius:3px; background-image:url(images/landscape.png);}.plugin-config-app .preview-more .screen-switch-section .portrait.selected{background-image:url(images/portrait_selected.png);}.plugin-config-app .preview-more .screen-switch-section .landscape.selected{background-image:url(images/landscape_selected.png);}.jimu-rtl .plugin-config-app .right-preview-section{left: 0; right: 400px;}.plugin-config-app .actions-pane{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color:#F3F3F3; font-size:14px;}.plugin-config-app .actions-pane .footer-button-box{height: 47px; font-family: Avenir Medium;}.plugin-config-app .actions-pane .seprate{width:1px; height: 35px; background-image:url(images/seprate.png); background-position: 0 20px; background-repeat:no-repeat;}.plugin-config-app .actions-pane .footer-button-arrow{width: 39px; height: 100%; background-image: url(images/arrow.png); background-position: 17px 25px; background-repeat: no-repeat; position: absolute; left: 360px; cursor: pointer; z-index: 10;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow{right: 360px; left: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu{display: none; position: absolute; right: 1px; box-shadow: 0 0 4px #646464;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow .foot-menu{left: 1px; right: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div{display: block; height: 30px; line-height: 30px; padding-left: 25px; padding-right: 25px; cursor: pointer; white-space: nowrap; font-size: 14px; background-color: #fafafc; text-decoration: none; color: #4d4d4d;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div:hover{background-color: #edf2f5; color: #24B5CC;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div.disable{color: #d2dae2;}",
"url:builder/plugins/app-config-configpart/TabContainer2.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable class\x3d"control-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-viewstack2" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-config-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"config-section" data-dojo-attach-point\x3d"configSection"\x3e\r\n    \x3cdiv class\x3d"tabs" data-dojo-attach-point\x3d"tabsNode"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-configpart/css/style.css":'.plugin-appconfig-configpart{font-size: 20px; width: 400px; height: 100%; position: relative; box-shadow: 4px 0px 8px -4px rgba(0,0,0,0.4); z-index: 2;}.plugin-appconfig-configpart .config-section{width:100%; height:100%;}.jimu-tab2 .control-table{width: 100%; table-layout: fixed; background: #5E5E5E; border-collapse: collapse; font-size: 12px; text-align: center; color: #fff;}.jimu-tab2 .tab-item-div{position: relative; width: 100%; height: 80px; cursor: pointer; font-family: "Avenir Medium";}.jimu-tab2 .tab-item-div:hover{color: #fff; background-color: #444;}.jimu-tab2 .selected-tab-item-div{background-color: #24B5CC; background-size: 100% 100%; background-origin: content-box; background-repeat: no-repeat; font-family: "Avenir Medium"; color: #fff;}.jimu-tab2 .selected-tab-item-div:hover{background-color: #24B5CC;}.jimu-tab2 .tab-item-icon{display: inline-block; margin-left: auto; margin-right: auto; margin-top: 20px; margin-bottom: 6px; width: 24px; height: 24px; background-repeat: no-repeat; background-position: center center;}.jimu-tab2 .tab-item-title{width: 99%; margin: auto; white-space: pre-line; overflow: hidden; text-overflow: ellipsis; height: 16px;}.jimu-tab2 .jimu-viewstack2{background-color:#fff; position:absolute; left:0; right:0; top:80px; bottom:0; height:auto;}',
"url:builder/plugins/app-config-morepreview-selectionpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preview-section" data-dojo-attach-point\x3d"previewSection"\x3e\r\n    \x3cdiv class\x3d"preview-header"\x3e\r\n      \x3cdiv class\x3d"header-item size-section"\x3e\r\n        \x3ctable class\x3d"size-table"\x3e\r\n          \x3ccolgroup\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"20px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n          \x3c/colgroup\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"width-tip jimu-ellipsis" title\x3d"${nls.width}"\x3e${nls.width}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"1024" data-dojo-attach-point\x3d"customWidth" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"height-tip jimu-ellipsis" title\x3d"${nls.height}"\x3e${nls.height}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cinput class\x3d"jimu-float-leading" type\x3d"text" value\x3d"768"  data-dojo-attach-point\x3d"customHeight" /\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"preview-body"\x3e\r\n      \x3cdiv class\x3d"preview-items-section"\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"previewTbody"\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"preview-qrcode-section" \x3e\r\n        \x3cdiv class\x3d"qrcode-image jimu-float-leading" data-dojo-attach-point\x3d"qrcodeImage"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"qrcode-description jimu-float-leading" data-dojo-attach-point\x3d"qrcodeDescription"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-morepreview-selectionpart/css/style.css":".left-pane .plugin-appconfig-morepreview-selectionpart .preview-section{position:relative; width:100%; height:100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header{position: relative; width: 100%; height: 52px; background-color: #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .header-item{position:absolute; top: 0; margin: auto; bottom:0;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .size-section{width:100%; height: 32px; color:#444444;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table td *{height: 32px; line-height: 32px; text-align: center; font-size: 14px; color: #fff;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .width-tip{width: 100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div{width: 110px; overflow: hidden;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div input{width: 54px; color: #444444; border-style: none;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div .pixel{width: 32px; text-align: center; margin: 0; color: white; background-color: #d2dae2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body{position:absolute; width:100%; top: 52px; bottom:0; background-color: white;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .operation-tip{font-size:14px; margin-left:22px; margin-top:28px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{position:absolute; left:0; right:0; top:0; bottom:120px; overflow-x:hidden; overflow-y:auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section{position: absolute; left: 2px; right: 2px; bottom: 0; height: 116px; border-top: 1px solid; border-color: #e3ecf2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-image{margin: 20px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-description{width: 277px; height: 100%; padding-top: 25px; font-size: 14px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section table{width:370px; table-layout:fixed; margin-left: auto; margin-right: auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td{vertical-align:top; padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item{margin-left: auto; margin-right: auto; width:74px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg{position:relative; width:100%; height:74px; cursor:pointer; border:1px solid #ccc;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected{border:3px solid #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-selected-icon{display:none; position:absolute; left:41px; top:42px; width:30px; height:26px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/check.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6{background-image: url(images/preview/iPhone6.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6-plus{background-image: url(images/preview/iPhone6_Plus.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone5{background-image:url(images/preview/iPhone5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone4{background-image:url(images/preview/iPhone4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-Air{background-image: url(images/preview/iPad_Air.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad4{background-image: url(images/preview/iPad4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .new-iPad{background-image:url(images/preview/iPad3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-mini{background-image:url(images/preview/iPad-Mini.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Galaxy-S4{background-image: url(images/preview/Samsung_Galaxy_S4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Note-3{background-image: url(images/preview/Samsung_Note_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-5{background-image: url(images/preview/Nexus_5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-4{background-image: url(images/preview/Nexus_4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-7{background-image: url(images/preview/Nexus_7.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .htc-one{background-image: url(images/preview/HTC_One.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .xiaomi-3{background-image: url(images/preview/Xiaomi_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .LG-G2{background-image: url(images/preview/LG_G2.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected .preview-selected-icon{display:none; left:38px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-title{display:inline-block; width:100%; text-align:center; color:#666; font-size:12px; margin-top:10px; line-height: 13px;}",
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',
"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:esri/dijit/ColorPicker/templates/ColorPicker.html":'\x3cdiv class\x3d"${css.container}"\x3e\r\n  \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_header"\x3e\r\n    \x3cspan class\x3d"${css.swatchPreview} ${css.container}"\x3e\r\n      \x3cspan class\x3d"${css.swatch} ${css.swatchTransparencyBackground}"\x3e\x3c/span\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"dap_previewSwatch" class\x3d"${css.swatch}"\x3e\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.middle}"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dap_paletteContainer" class\x3d"${css.palette} ${css.container}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_primaryPalette" class\x3d"${css.palette}"\x3e\x3c/div\x3e\x3c!--\r\n      --\x3e\x3cdiv data-dojo-attach-point\x3d"dap_secondaryPalette" class\x3d"${css.palette}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.paletteOptions}"\x3e\r\n      \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"dap_hexInput" class\x3d"${css.hexInput}"/\x3e\r\n      \x3cinput class\x3d"${css.paletteToggle}" type\x3d"button" data-dojo-type\x3d"dijit/form/ToggleButton" data-dojo-attach-point\x3d"dap_paletteToggle" label\x3d"${labels.more}"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.footer}" data-dojo-attach-point\x3d"dap_footer"\x3e\r\n    \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_suggestedColorSection"\x3e\r\n      \x3cdiv class\x3d"${css.label}"\x3e${labels.suggested}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_suggestedColorPalette" class\x3d"${css.suggested} ${css.palette} ${css.swatchRow}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_recentColorSection"\x3e\r\n      \x3cdiv class\x3d"${css.label}"\x3e${labels.recent}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_recentColorPalette" class\x3d"${css.recent} ${css.palette} ${css.swatchRow}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_transparencySection"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_transparencyLabel" class\x3d"${css.label}"\x3e${labels.transparency}\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.transparencySlider}"\r\n           data-dojo-attach-point\x3d"dap_transparencySlider"\r\n           data-dojo-type\x3d"esri/dijit/HorizontalSlider"\r\n           data-dojo-props\x3d"minimum: 0, maximum: 1, discreteValues: 100, labels: [\'0%\', \'50%\', \'100%\']"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/DropDownButton.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d\'dijitReset dijitInline dijitButtonNode\'\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" data-dojo-attach-point\x3d"_buttonNode"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon"\r\n\t\t\t\tdata-dojo-attach-point\x3d"iconNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonInner"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonChar"\x3e\x26#9660;\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick" data-dojo-attach-point\x3d"valueNode" aria-hidden\x3d"true"\r\n/\x3e\x3c/span\x3e\r\n',
"url:builder/plugins/app-config-template-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"head-part"\x3e\r\n    \x3cdiv class\x3d"decorator"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"description data-dojo-attach-point\x3d"description"" \x3e${nls.description}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-part-box"\x3e\r\n    \x3cdiv class\x3d"config-part" data-dojo-attach-point\x3d"configPart"\x3e\r\n      \x3cdiv class\x3d"map-category"\x3e\r\n        \x3cdiv class\x3d"map-title" data-dojo-attach-point\x3d"mapTitle"\x3e${nls.map}\x3c/div\x3e\r\n        \x3cdiv class\x3d"select-part"\x3e\r\n          \x3cdiv class\x3d"jimu-btn select-map" data-dojo-attach-point\x3d"selectMapBtn" data-dojo-attach-event\x3d"click:_onSelectMapClick"\x3e${nls.changeWebMap}\x3c/div\x3e\r\n          \x3cdiv class\x3d"map-name" data-dojo-attach-point\x3d"mapName"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"control-part" data-dojo-attach-point\x3d"controlPart"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-template-configpart/css/style.css":".plugin-appconfig-template-configpart {background-color: #ffffff; font-size: 12px; overflow-y: auto;}.plugin-appconfig-template-configpart .header-line {width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0); display: none;}.plugin-appconfig-template-configpart .head-part {position: absolute; top: 0; height: 80px; background-color: #f3f3f3; width: 100%; z-index: 1;}.plugin-appconfig-template-configpart .head-part .decorator {height: 16px; background-color: #24B5CC;}.plugin-appconfig-template-configpart .head-part .description {height: 58px; padding-top: 18px; color: #666666; font-size: 14px; width: 90%; margin: 0 auto;}.plugin-appconfig-template-configpart .config-part-box {width: 100%; overflow: auto; height: 100%;}.plugin-appconfig-template-configpart .config-part {width: 90%; height: 100%; margin: 0 auto; padding-top: 80px;}.plugin-appconfig-template-configpart .config-part .map-category .map-title{border-bottom: 1px solid #eaeaea; margin: 12px 0 10px 0; font-weight: bold; font-size: 14px; color: #565656; padding-bottom: 0.3em;}.plugin-appconfig-template-configpart .config-part .map-category {overflow: hidden;}.plugin-appconfig-template-configpart .config-part .map-category .select-map{padding: 0 15px; font-size: 14px; line-height: 33px; text-align: center; color: #ffffff; float: left; max-width: 50%;}.plugin-appconfig-template-configpart .config-part .map-category .map-name{margin-top: 10px; color: #596679; font-size: 12px; max-width: 100%; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; float: right; width: 50%;}",
"url:builder/dijit/template-config/templates/Template.html":'\x3cdiv\x3e\r\n\r\n    \x3cdiv class\x3d"content-part" data-dojo-attach-point\x3d"contentPart"\x3e\r\n      \x3cdiv class\x3d"tree-part jimu-float-leading" data-dojo-attach-point\x3d"treePart"\x3e\r\n        \x3cdiv class\x3d"left-part-title"\x3e${nls.appProperties}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-part jimu-float-leading" data-dojo-attach-point\x3d"leftPart"\x3e\r\n        \x3cdiv class\x3d"right-part-content"\x3e\r\n          \x3cdiv class\x3d"right-part-head" \x3e\r\n            \x3cspan data-dojo-attach-point\x3d"rightPartHeadText"\x3e${nls.rightPartHead}\x3c/span\x3e\r\n            \x3cdiv class\x3d"review-json-div" data-dojo-attach-point\x3d"reviewJsonDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonDivClick" style\x3d"display:none"\x3e${nls.viewJsonCode}\x3c/div\x3e\r\n            \x3cdiv class\x3d"review-json-back-div" style\x3d"display: none" data-dojo-attach-point\x3d"reviewJsonBackDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonBackDivClick"\x3e${nls.viewJsonBack}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv class\x3d"right-part-subhead"\x3e\r\n            ${nls.rightPartSubhead}\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"category-part" data-dojo-attach-point\x3d"categoryPart"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"show-json-div" data-dojo-attach-point\x3d"showJsonDiv"\x3e\r\n            \x3cdiv class\x3d"show-json-content-div" data-dojo-attach-point\x3d"showJsonContentDiv"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/template-config/templates/Export.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:block;" class\x3d"message-div" data-dojo-attach-point\x3d"templateTitle"\x3e${nls.templateTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"message-div" data-dojo-attach-point\x3d"message1"\x3e\x3c/p\x3e\r\n  \x3cdiv style\x3d"display:none;" class\x3d"explain-div" data-dojo-attach-point\x3d"explain1"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/template-config/templates/ExportMessage.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"element resMessage" data-dojo-attach-point\x3d"resMessage"\x3e\x3c/div\x3e\r\n    \x3c!--div class\x3d"element" data-dojo-attach-point\x3d"message1"\x3e\x3c/div--\x3e\r\n    \x3cdiv class\x3d"element itemLink"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word1" \x3e\x3c/span\x3e\r\n      \x3ca class\x3d"download-a" target\x3d"_blank" data-dojo-attach-point\x3d"itemLink"\x3e\x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word2" \x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/ItemInfo.html":'\x3cdiv\x3e\r\n        \x3cdiv\x3e\r\n          \x3ctable style\x3d"width:100%" cellspacing\x3d"6"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" width\x3d"10%"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-name"\x3e\r\n                    ${nls.nameLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd width\x3d"90%"\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;padding:2px;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"tagsTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n                    ${nls.tagsLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags" style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" valign\x3d"top"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n                    ${nls.summaryLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;max-width:95%;min-width:95%;height:200px;max-height:200px;min-height:200px;padding:2px;resize:none;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"thumbnailTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-thumbnail"\x3e\r\n                    ${nls.thumbnailLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"folderTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-folder"\x3e\r\n                    ${nls.saveFolderLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-folder" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:96%;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"sharingTr"\x3e\r\n                \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-sharing" data-dojo-type\x3d"dijit/form/CheckBox" checked\x3e\x3c/div\x3e\r\n                  \x3clabel for\x3d"publish-webmap-sharing"\x3e${nls.shareSameLevel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/Tags.html":'\x3cdiv class\x3d"${baseClass}" style\x3d"outline:none;"\x3e\x3c/div\x3e\r\n',"url:jimu/dijit/templates/ImageChooser.html":'\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintText"\x3e\r\n\t\t\x3cspan class\x3d"display-text" data-dojo-attach-point\x3d"displayText"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintImage"\x3e\r\n\t\t\x3cimg class\x3d"display-image" data-dojo-attach-point\x3d"selfImg"\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"fileForm"\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"mask"\x3e\x3c/label\x3e\r\n    \x3cinput type\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_CropImage.html":'\x3cdiv class\x3d"jimu-crop-image"\x3e\r\n\t\x3cdiv class\x3d"crop-section" data-dojo-attach-point\x3d"cropSection"\x3e\r\n\t\t\x3cdiv class\x3d"viewer-box hide-status" data-dojo-attach-point\x3d"viewerBox"\x3e\r\n\t\t\t\x3cdiv class\x3d"viewer-content" data-dojo-attach-point\x3d"viewerContent"\x3e\r\n\t\t\t\t\x3cimg class\x3d"viewer-image hide-status" data-dojo-attach-point\x3d"viewerImage" src\x3d""\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cimg class\x3d"base-image hide-status" data-dojo-attach-point\x3d"baseImage" data-dojo-attach-event\x3d"mousedown:_onViewerMouseDown,mouseup:_onViewerMouseUp"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cimg class\x3d"loading-image" data-dojo-attach-point\x3d"loadingImg" src\x3d""\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"controller hide-status" data-dojo-attach-point\x3d"zoomController"\x3e\r\n\t\t\x3cdiv class\x3d"zoom-out" data-dojo-attach-point\x3d"zoomOutBtn" data-dojo-attach-event\x3d"click:_onZoomOutClick"\x3e-\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"slider" data-dojo-attach-point\x3d"sliderNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"button" data-dojo-attach-point\x3d"sliderButton" data-dojo-attach-event\x3d"mousedown:_onSliderMouseDown,mouseup:_onSliderMouseUp"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"horizontal"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"zoom-in" data-dojo-attach-point\x3d"zoomInBtn" data-dojo-attach-event\x3d"click:_onZoomInClick"\x3e+\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-templateconfig/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"left-part jimu-float-leading"\x3e\r\n    \x3cdiv class\x3d"config-panel" data-dojo-attach-point\x3d"configPanel"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-panel"\x3e\r\n      \r\n      \x3cdiv class\x3d"to-app-btn jimu-float-leading" title\x3d"${nls.toConfigApp}" data-dojo-attach-event\x3d"onclick:_onToAppClick" \x3e${nls.toConfigApp}\x3c/div\x3e\r\n      \x3cdiv class\x3d"save-btn jimu-float-trailing" data-dojo-attach-point\x3d"savePluginNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"separate jimu-float-trailing"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e    \r\n  \x3c/div\x3e\r\n\r\n \x3cdiv class\x3d"preview-panel jimu-float-leading" \x3e\r\n    \x3cdiv class\x3d"preview-content" data-dojo-attach-point\x3d"previewPanel"\x3e\r\n    \x3c/div\x3e\r\n \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:builder/plugins/app-config-templateconfig/css/style.css":".plugin-config-template {background-color: #ffffff; position: relative;}.plugin-config-template .header-line{width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0);}.plugin-config-template .left-part{width: 60%; height: 100%; position: relative; box-shadow: 0px 0px 8px rgba(0,0,0,0.4);}.plugin-config-template .config-panel{position: absolute; left: 0; right: 0; top: 0; bottom: 50px; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-template .action-panel{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color: #F3F3F3; font-size: 14px;}.plugin-config-template .action-panel .to-app-btn{background-image: url(../../../../stemapp/jimu.js/css/images/setting_disabled.png); height: 100%; line-height: 52px; padding-left: 50px; background-repeat: no-repeat; background-position: 25px center; cursor: pointer;}.jimu-rtl .plugin-config-template .action-panel .to-app-btn{padding-right: 50px; padding-left: auto; background-position: right 25px center;}.plugin-config-template .action-panel .to-app-btn:hover{background-image: url(../../../../stemapp/jimu.js/css/images/setting_hover.png); color: #15a4fa;}.plugin-config-template .action-panel .separate{border: 1px solid #a3a3a3; height: 20px; margin-top: 16px;}.plugin-config-template .action-panel .save-btn{margin-right: 40px; margin-left: 40px;}.plugin-config-template .preview-panel{width: 40%; height: 100%; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-config-template .preview-panel .preview-content{width: 80%; margin: 0 auto; min-width: 300px;}",
"url:builder/plugins/app-list/Plugin.html":'\x3cdiv\x3e\r\n  \x3c!--header\x3e\x3c--\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"header"\x3e\r\n    \x3cdiv class\x3d"navigator-box" data-dojo-attach-point\x3d"navigatorBox"\x3e\r\n      \x3c!--div class\x3d"switch-app" style\x3d"float: left; cursor: pointer; margin-right: 5px" data-dojo-attach-point\x3d"switchApps"  data-dojo-attach-event\x3d"onclick:_onSwitchToAppContent"\x3eapps\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-template" style\x3d"float: left; cursor: pointer;" data-dojo-attach-point\x3d"switchTemplates" data-dojo-attach-event\x3d"onclick:_onSwitchToTemplateContent"\x3etempaltes\x3c/div--\x3e    \r\n      \x3cdiv class\x3d"navigator" data-dojo-attach-point\x3d"navigator"\x3e\r\n        \x3cdiv class\x3d"filter-box jimu-float-leading" data-dojo-attach-point\x3d"filterBox"\x3e\r\n          \x3cdiv class\x3d"filter all selected jimu-float-leading" id\x3d"ALL" data-dojo-attach-point\x3d"filterAllBtn" data-dojo-attach-event\x3d"onclick:_filterAllBtnClick"\x3e${nls.all}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 2d jimu-float-leading" id\x3d"HTML" data-dojo-attach-point\x3d"filter2dBtn" data-dojo-attach-event\x3d"onclick:_filter2dBtnClick"\x3e${nls.d2}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 3d jimu-float-leading" id\x3d"HTML3D" data-dojo-attach-point\x3d"filter3dBtn" data-dojo-attach-event\x3d"onclick:_filter3dBtnClick"\x3e${nls.d3}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"search jimu-float-trailing" data-dojo-attach-point\x3d"search"\x3e\r\n          \x3cdiv class\x3d"search-box jimu-float-leading" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"searchBox" trim\x3d"true" maxlength\x3d"250" required\x3d"true" placeholder\x3d${nls.searchPlaceholder} data-dojo-attach-event\x3d"onKeyUp:_onSearchBoxChange"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"search-btn jimu-float-leading" data-dojo-attach-point\x3d"searchBtn"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"sort-box jimu-float-trailing" data-dojo-attach-point\x3d"sortBox"\x3e\r\n          \x3cdiv class\x3d"sort by-modified-time selected jimu-float-leading" id\x3d"lastUpdated" data-dojo-attach-point\x3d"sortByModifiedTimeBtn" data-dojo-attach-event\x3d"onclick:_sortByModifiedTimeBtnClick" title\x3d"${nls.sortByModifiedTime}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-name jimu-float-leading" id\x3d"name" data-dojo-attach-point\x3d"sortByNameBtn"  data-dojo-attach-event\x3d"onclick:_sortByNameBtnClick" title\x3d"${nls.sortByName}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-author jimu-float-leading" id\x3d"creator" data-dojo-attach-point\x3d"sortByAuthorBtn" data-dojo-attach-event\x3d"onclick:_sortByAuthorBtnClick" style\x3d"display: none" title\x3d"${nls.sortByAuthor}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"content-box" id\x3d"content-box" data-dojo-attach-point\x3d"contentBox"\x3e\r\n    \x3c!--operation\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"operation-box" data-dojo-attach-point\x3d"operationBox"\x3e\r\n      \x3cdiv class\x3d"create jimu-float-leading" data-dojo-attach-point\x3d"createNewBtn" data-dojo-attach-event\x3d"onclick:_onCreateClick" title\x3d${nls.appCreate}\x3e${nls.appCreate}\x3c/div\x3e\r\n      \x3cdiv class\x3d"import jimu-float-leading" data-dojo-attach-point\x3d"importBtn"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-app-page-box" data-dojo-attach-point\x3d"switchAppPapgeBox"\x3e \x3c/div\x3e\r\n    \x3c/div\x3e  \r\n    \x3c!--content\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"content app-content selected" id\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"content tempalte-content" id\x3d"template-content" data-dojo-attach-point\x3d"templateContent"\x3e\x3c/div\x3e\r\n    \x3c!--footer\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"footer" data-dojo-attach-point\x3d"footer"\x3e\r\n      \x3cdiv class\x3d"footer-text"\x3e\r\n        \x3cspan class\x3d"jimu-float-leading"\x3e\u00a9 Copyright 2016 Environmental Systems Research Institute, Inc.\x3c/span\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/privacy"\x3ePrivacy\x3c/a\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/software-license"\x3eLegal\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:builder/plugins/app-list/Import.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"actions jimu-float-trailing" data-dojo-attach-point\x3d"actionsNode"\x3e\r\n    \x3cspan class\x3d"actions-label jimu-ellipsis" title\x3d"${nls.actionsLabel}" data-dojo-attach-event\x3d"onclick:_onActionsLabelClick"\x3e${nls.actionsLabel}\x3c/span\x3e\r\n    \x3cdiv class\x3d"actions-menu" data-dojo-attach-point\x3d"actionsMenu"\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-import" data-dojo-attach-point\x3d"itemImportBtn" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"import-button jimu-ellipsis" title\x3d"${nls.importAction}" data-dojo-attach-event\x3d"onclick:_onImportClick"\x3e${nls.importAction}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-upload" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"upload-button-div"\x3e\r\n          \x3cdiv class\x3d"upload-button jimu-ellipsis" title\x3d"${nls.uploadAction}"\x3e${nls.uploadAction}\x3c/div\x3e\r\n          \x3cform enctype\x3d"multipart/form-data" encoding\x3d"multipart/form-data" title\x3d"${nls.uploadAction}" method\x3d"post" action\x3d"/webappbuilder/rest/apps/upload" data-dojo-attach-point\x3d"uploadAppFileFormNode"\x3e\r\n            \x3cinput class\x3d"file-input" title\x3d"${nls.uploadAction}" name\x3d"app" type\x3d"file" data-dojo-attach-point\x3d"appFileInputNode" data-dojo-type\x3d"dojox/form/Uploader" data-dojo-attach-event\x3d"onChange:_onAppFileChange,onError:_onAppFileUploadError,onComplete:_onAppFileUploadComplete" accept\x3d".zip" style\x3d"width:100%;height:100%;"\x3e\r\n            \x3cinput name\x3d"creator" type\x3d"text" value\x3d"1234" style\x3d"display:none;" data-dojo-attach-point\x3d"appFileCreatorInputNode"\x3e\r\n            \x3cinput name\x3d"portalUrl" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"appPortalUrlInputNode"\x3e\r\n            \x3cinput name\x3d"fromList" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"fromListNode"\x3e\r\n          \x3c/form\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:jimu/dijit/templates/ItemSelector.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:50px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRadio" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" class\x3d"jimu-float-leading online-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/FullScreenPopup.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onContainerClick"\x3e\r\n  \x3cdiv class\x3d"background" data-dojo-attach-point\x3d"background"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"main" data-dojo-attach-point\x3d"main"\x3e\r\n    \x3cdiv class\x3d"head" data-dojo-attach-point\x3d"head"\x3e\r\n      \x3cdiv class\x3d"head-underline"\x3e\r\n        \x3cspan class\x3d"title" data-dojo-attach-point\x3d"fullscreenPopupTitle"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"close" data-dojo-attach-point\x3d"fullscreenPopupClose"\r\n             data-dojo-attach-event\x3d"onclick:_onCloseClick"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"content-scroller" data-dojo-attach-point\x3d"contentScroller"\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"fullscreenPopupContent"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btnsContainer" data-dojo-attach-point\x3d"fullscreenPopupBtnsContainer"\x3e\r\n      \x3cdiv class\x3d"btns" data-dojo-attach-point\x3d"fullscreenPopupBtns"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dojox/form/resources/Uploader.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e \r\n\t\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1" data-dojo-attach-point\x3d"valueNode" /\x3e\r\n\x3c/span\x3e\r\n',
"url:builder/plugins/app-list/AppCatalogPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\r\n    \x3cdiv class\x3d"list-section" id\x3d"list-section" data-dojo-attach-point\x3d"listSection"\x3e\r\n      \x3cdiv class\x3d"list-section-body-content" id\x3d"list-section-body-content" data-dojo-attach-point\x3d"listSectionBodyContent"\x3e\r\n        \x3ctable class\x3d"list-table" data-dojo-attach-point\x3d"listTable"\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"listTableBody"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--iframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe--\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/AppOperMenu.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onMenuClick"\x3e\r\n  \x3cdiv class\x3d"up-triangle" data-dojo-attach-point\x3d"upTriangle"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"down-triangle" data-dojo-attach-point\x3d"downTriangle"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item item-createApp-from-template" data-dojo-attach-point\x3d"createAppFromTemplate" data-dojo-attach-event\x3d"onclick:_onCreateAppFromTempalteClick"\x3e${nls.createApp}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-editAppInfo" data-dojo-attach-point\x3d"editAppInfo" data-dojo-attach-event\x3d"onclick:_onEditClick"\x3e${nls.editAppInfo}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-download" data-dojo-attach-point\x3d"download" data-dojo-attach-event\x3d"onclick:_onDownloadClick"\x3e\r\n    \x3ca data-dojo-attach-point\x3d"downloadLinkNode" style\x3d"display:inline-block;width:100%;height:100%;" target\x3d"downloadTargetFrame"\x3e${nls.download}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-duplicate" data-dojo-attach-point\x3d"duplicate" data-dojo-attach-event\x3d"onclick:_onDuplicateClick"\x3e${nls.duplicate}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-remove" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"remove" data-dojo-attach-event\x3d"onclick:_onRemoveClick"\x3e${nls.deleteMenu}\x3c/div\x3e\r\n  \x3c!--div class\x3d"item item-agol-template" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"agolTemplate" data-dojo-attach-event\x3d"onclick:_onAgolTemplateClick"\x3e${nls.agolTemp}\x3c/div\x3e \r\n  \x3cdiv class\x3d"item item-qrcode" style\x3d"" data-dojo-attach-point\x3d"qrcode" data-dojo-attach-event\x3d"onclick:_onQRCodeClick"\x3eqrcodeeeeeee-nonls\x3c/div--\x3e \r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/EditItemInfo.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"image-chooser-container" data-dojo-attach-point\x3d"imageChooserContainer"\x3e\r\n    \x3cdiv class\x3d"chooser-border"\x3e\r\n      \x3cdiv class\x3d"image-chooser-masker" data-dojo-attach-point\x3d"imageChooserMasker"\x3e${nls.change}\x3c/div\x3e\r\n      \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-edit" data-dojo-attach-point\x3d"appInfoEdit"\x3e\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-name"\x3e\r\n        ${nls.nameLabel}\r\n      \x3c/label\x3e\r\n      \x3cinput id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName"\r\n             maxlength\x3d"250" required\x3d"true" placeHolder\x3d"${nls.nameLabelPlaceHolder}"\r\n             class\x3d"app-info-edit-name"\x3e\r\n      \x3c/input\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n        ${nls.summaryLabel}\r\n      \x3c/label\x3e\r\n      \x3ctextarea id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true"\r\n                maxlength\x3d"250" required\x3d"true" style\x3d"resize:none;" class\x3d"app-info-edit-summary"\r\n                data-dojo-attach-point\x3d"publishWebmapSummary"\x3e\x3c/textarea\x3e\r\n    \x3c/div\x3e\r\n    \x3c!--\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n        ${nls.tagsLabel}\r\n      \x3c/label\x3e\r\n      \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags"\r\n           style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e--\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/CardPageWithBigThumbnail.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"card-page-content" data-dojo-attach-point\x3d"cardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/app-list/CardPageWithSmallThumbnail.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-card-page-content" id\x3d"app-card-page-content" data-dojo-attach-point\x3d"appCardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',"url:builder/plugins/app-list/css/style.css":'.app-oper-menu {position: absolute; background-color:#354052; min-width:160px; max-width: 300px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-oper-menu.white-style {background-color:#ffffff; box-shadow: 0 0 8px rgba(0, 0, 0, 0.2)}.app-oper-menu .item{width: 100%; height: 40px; min-height: 30px; padding-left: 20px; padding-right: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; line-height: 40px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.app-oper-menu.white-style .item{color: #333333; border-bottom: 1px solid #e4e7e7;}.app-oper-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.app-oper-menu.white-style .item:hover{background-color: #f8f9fb; color: #31aacd;}.jimu-rtl .app-oper-menu .item{padding-right: 20px; padding-left: 0px;}.app-oper-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-oper-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-oper-menu .item a{text-decoration: none; color: inherit;}.app-oper-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -11px; right: 20px; background: url("images/up_triangle.png");}.app-oper-menu.white-style .up-triangle{background: url("images/up_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .up-triangle{left: 20px; right: auto;}.app-oper-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.app-oper-menu.white-style .down-triangle{background: url("images/down_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .down-triangle{left: 20px; right: auto;}.import-app .actions{margin-right:2px; position: relative; display: inline-block; background-color: #ffffff; border-radius: 2px; border: 1px solid #31aacd; height: 40px;}.import-app .actions:hover{background-color: #f4f4f4;}.jimu-rtl .import-app .actions{margin-left:2px;}.import-app .actions-label{display: inline-block; width: 120px; margin: 0 15px; padding-right: 8px; background: url("images/v_blue.png") right no-repeat; color: #31aacd; line-height: 35px; font-size: 14px; font-weight: bold; text-align: center; cursor: pointer;}.jimu-rtl .import-app .actions-label{padding-left: 8px; padding-right: 0; background-position: left center;}.import-app .actions-menu {display: none; position: absolute; top: 41px; left: 0; z-index: 9999; background: #fff; box-shadow: 0 0 4px #646464; color: #333333; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; border-radius: 5px;}.jimu-rtl .import-app .actions-menu{left: auto; right: 0;}.import-app .actions-menu-item{position: relative; width: 250px; height: 30px; overflow: hidden; white-space: nowrap; padding: 0 25px; background-color: #ffffff; border-bottom: 1px solid #e4e7e7; border-radius: 5px; font-size: 14px;}.import-app .actions-menu-item .upload-button,.import-app .actions-menu-item .import-button {line-height: 30px; padding-left: 18px; background-repeat: no-repeat; background-position: left center;}.jimu-rtl .import-app .item-import .import-button,.jimu-rtl .import-app .item-upload .upload-button{padding-right: 18px; padding-left: 0; background-position: right center;}.import-app .item-import .import-button{background-image: url("images/clouda.png"); cursor: pointer;}.import-app .item-import:hover .import-button{background-image: url("images/cloudb.png");}.import-app .item-upload .upload-button{background-image: url("images/computera.png");}.import-app .item-upload:hover .upload-button{background-image: url("images/computerb.png");}.import-app .actions-menu-item:hover{background-color: #f8f9fb; color: #31aacd;}.import-app .upload-button-div form{position:absolute; top:0; bottom:0; width:100%; opacity:0; overflow: hidden; width: 200px; filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButtonNode{filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButton input{cursor: pointer; font-size: 20em\\9\\0 !important;}.jimu-rtl .import-app .upload-button-div form span.dijitButton input{left:-3px; right:auto !important;}.fullscreen-popup-container .content .control-node {line-height: 30px; height: 30px; width: 470px;}.fullscreen-popup-container .content .control-node .jimu-item-selector .jimu-tab3\x3e.container-node {top: 62px;}.fullscreen-popup-container .control-node .control-table {font-size: 14px; color: #999; line-height: 14px;}.fullscreen-popup-container .control-node .tab-item-td {width: 100px; padding: 0 10px; border: none;}.fullscreen-popup-container .control-node .tab-item-td:last-child {display: none;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node{top:54px;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node .jimu-item-table{top:40px; height: 100%;}.fullscreen-popup-container .control-node .jimu-state-active {color: #d84b28; border: none; border-bottom: 2px solid #d84b28;}.fullscreen-popup-container .container-node {min-height: 400px;}.fullscreen-popup-container .jimu-item-table .items-section {bottom:70px;}.fullscreen-popup-container .container-node .jimu-item-table .items-table-div {}.fullscreen-popup-container .container-node .tab-content .jimu-search {height: 40px; margin-top: 12px;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search {width: 16px; height: 16px; background: url("images/search.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search:hover {background: url("images/search_selected.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .public-item-section{top: 35px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table {margin-top: 20px;}.fullscreen-popup-container .container-node .tab-content .items-table .jimu-item-table .item-thumbnail {width: 180px; height: 120px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-thumbnail:hover {border: 2px solid #0f95bc; border-radius: 0px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-info{left: 180px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .items-table td {padding-bottom: 20px;}.fullscreen-popup-container .container-node .jimu-item-table .item-thumbnail{border: 2px solid transparent;}.fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{left: 2px; top: 1px; width: 176px; height: 112px;}.jimu-rtl .fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{right: 2px; left: auto;}.fullscreen-popup-container .container-node .jimu-item-table .item-border {border: 2px solid #15a4fa;;}.fullscreen-popup-container .container-node .item-info{width:180px; height:100px; margin: 10px 30px 0 10px;}.fullscreen-popup-container .container-node .item-border {border: 3px solid #15a4fa; -webkit-border-radius: 0; -moz-border-radius: 0; -o-border-radius: 0; -ms-border-radius: 0; border-radius: 0;}.fullscreen-popup-container .container-node .item-info .item-name{font-size: 18px; font-family: "Avenir Medium"; color: #333; line-height: 18px;}.fullscreen-popup-container .container-node .item-info .item-type-owner,.fullscreen-popup-container .container-node .item-info .item-date {margin-top: 10px; font-size: 12px; color: #666; line-height: 18px; overflow:hidden;}.fullscreen-popup-container .container-node .item-info .item-date{margin-top: 8px;}.app-list-page{width: 100%; height: 100%; position: relative;}.app-list-page .separate-line {height: 47px; border-bottom: 1px solid #cfd7d7;}.app-list-page .switch-app-template {top: 16px; position: relative; max-width: 1180px; min-width: 1024px; margin: 0 auto; font-size: 16px; color: #a3a3a3; font-weight: bold;}.app-list-page .switch-app-template .switch-btn-box {position: relative; display: inline-block; margin-right: 1px;}.app-list-page .switch-app-template .switch-btn {margin-right: 8px; margin-left: 8px; cursor: pointer; min-width: 80px; text-align: center;}.app-list-page .switch-app-template .switch-btn-box:hover {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box .blue-block {position: absolute; width: 100%; height: 4px; bottom: -8px;}.app-list-page .switch-app-template .switch-btn-box:hover .blue-block{background-color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected .blue-block{background-color: #508dca;}.app-list-page .app-content{position: relative; max-width: 1180px; min-width: 1024px; margin: 50px auto; height: 100%;}.app-list-page .head-section {display: inline-block; width: 100%; padding-bottom: 30px;}.app-list-page .head-section .textPart1{margin-top: 15px; color: #6f7a8b; font-size: 18px;}.app-list-page .head-section .textPart2{margin-top: 20px; margin-left: 3px; color: #002157; font-size: 14px;}.jimu-rtl .app-list-page .head-section .textPart2{margin-right: 3px;}.app-list-page .head-section .create-button-div{height: 50px; position: relative; left: -16px; display: inline-block; padding-top: 8px;}.jimu-rtl .app-list-page .head-section .create-button-div{right: -16px;}.app-list-page .head-section .create-button{width: 140px; height: 37px; background-color: #518dca; border: 1px solid #348599; color: #ffffff; font-size: 15px; font-weight: bold; border-radius: 4px; cursor: pointer; box-shadow: 0px 1px 2px #a0acbf;} .app-list-page .app-content .list-section{position: absolute; top: 78px; width: 100%;} .app-list-page .app-content .list-section-head {table-layout: fixed; border-spacing: 0px; background-color: #6f7e95; width: 100%; height: 49px; border-top-left-radius: 4px; border-top-right-radius: 4px; box-shadow: 1px 1px 2px #a0acbf;}.app-list-page .app-content .list-section .head-content {}.app-list-page .app-content .list-section .head-content .name{width: 270px; color: #ffffff; font-size: 14px; border: 0px solid; padding-left: 25px;}.jimu-rtl .app-list-page .app-content .list-section .head-content .name{padding-right: 25px;}.app-list-page .app-content .list-section .head-content .desc{width: 300px; color: #ffffff; font-size: 14px; border: 0px solid;}.app-list-page .app-content .list-section .head-content .time{color: #ffffff; font-size: 14px; border: 0px solid; width: 150px;}.app-list-page .app-content .list-section .head-content .modified{color: #ffffff; font-size: 14px; border: 0px solid; width: 100px; display: none;}.app-list-page .app-content .list-section .head-content .creator{color: #ffffff; font-size: 14px; border: 0px solid;} .app-list-page .app-content .list-section-body{position: absolute; top: 127px; bottom: 150px; width: 100%; overflow: hidden;}.app-list-page .app-content .list-section-body-content{max-height: 100%; border: 1px solid #a0acbf; box-shadow: 1px 1px 2px #a0acbf; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;}.app-list-page .app-content .list-table{table-layout: fixed; border-spacing: 0px; width: 100%;}.app-list-page .app-content .list-table-item{height: 40px; background-color: #fafafa;}.app-list-page .app-content .list-table-item-add{}.app-list-page .app-content .list-table-item-mouseover{background-color: #e3ecf2;}.app-list-page .app-content .list-table-next-item-mouseover td{border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item-dbclick{background-color: #fffce4;}.app-list-page .app-content .list-table-item .item-first-td{width: 4px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-second-td{width: 16px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-first-td-selected {background-color: #15a4fa;}.app-list-page .app-content .list-table-item .item-end-td{width: 4px;}.app-list-page .app-content .list-table-item .item-name-td{width: 250px; vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-name{overflow: hidden; color: #596679; font-size: 14px; border: 0px solid; width: 230px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-input-name{width: 230px; height: 30px; margin-left: 10px; margin-top: 5px; border: 1px solid #999999; background-color: #ffffff}.app-list-page .app-content .list-table-item .item-desc-td{width:300px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-desc{overflow: hidden; color: #596979; font-size: 14px; border: 0px solid; margin-right: 5px; width: 270px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-textarea-description{width: 285px; height: 82px; border: 1px solid #999999; resize: none; margin-top: 7px; margin-bottom: 7px;}.app-list-page .app-content .list-table-item .item-time-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 150px;}.app-list-page .app-content .list-table-item .item-time{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px; height: 40px;}.app-list-page .app-content .list-table-item .item-modified-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 100px; display: none;}.app-list-page .app-content .list-table-item .item-modified{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-creator-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 83px;}.app-list-page .app-content .list-table-item .item-creator{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-loading-td{width: 14px; max-width: 14px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-loading-td .loading-div{display: none; width: 14px;}.app-list-page .app-content .list-table-item .item-operations-td{vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-operations-div{border: 0px solid; width: 190px; margin: 0px 0px 0px auto; color: #A0acbf; font-size: 14px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-operations-div{margin: 0px auto 0px 0px;}.app-list-page .app-content .list-table-item .item-edit{border: 0px solid; margin-right: 5px; cursor: pointer; height: 40px; width: 65px; background-image: url("images/edit_icon01.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit{margin-left: 5px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-edit:hover{background-image: url("images/edit_icon02.png"); color: #518dca !important;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-image{}.app-list-page .app-content .list-table-item .item-edit-text{line-height: 40px; padding-left: 17px; width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-text{padding-right: 17px; padding-left: 0;}.app-list-page .app-content .list-table-item .item-preview{border: 0px solid; margin-right: 0px; cursor: pointer; width: 80px; height: 40px; line-height: 40px; background-image: url("images/launch2.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview{margin-left: 0px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-preview:hover{background-image: url("images/launch3.png"); color: #518dca !important;}.app-list-page .app-content .list-table-item .item-preview a{text-decoration: none; color: inherit; display: inline-block; padding-left: 19px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 100%;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview a{padding-right: 24px; padding-left: 0px;}.app-list-page .app-content .list-table-item .item-preview img{margin-top: 13px; margin-right: 5px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview img{margin-left: 13px; margin-right: auto;}.app-list-page .app-content .list-table-item .item-more{height: 40px; width: 38px; text-align: center; cursor: pointer; background-image: url("images/moreaction_icon.png"); background-repeat: no-repeat; background-position: center center; overflow: hidden;}.app-list-page .app-content .list-table-item .item-more-selected{background-image: url("images/moreaction_icon1.png") !important;}.app-list-page .app-content .list-table-item .item-more:hover{background-image: url("images/moreaction_icon1.png");}.app-list-page .app-content .list-table-item .item-more-image{margin-top: 18px;}.app-list-page .app-menu {position: absolute; background-color:#354052; width:160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-list-page .app-menu .item{width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-list-page .app-menu .item{padding-right: 20px; padding-left: 0px;}.app-list-page .app-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-list-page .app-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-list-page .app-menu .item a{text-decoration: none; color: inherit;}.app-list-page .app-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-list-page .app-menu .up-triangle{left: 20px; right: auto;}.app-list-page .app-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-list-page .app-menu .down-triangle{left: 20px; right: auto;}.app-list-page .app-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.edit-app-info-content {color: #4d4d4d; font-size: 14px; font-family: monospace;}.edit-app-info-content .app-thumbnail {width: 200px; height: 133px; margin-top:20px; margin-left: 30px; display: inline-block;}.edit-app-info-content .app-name {margin-left: 30px;}.edit-app-info-content .app-description {margin-left: 30px; margin-top: 20px;}.edit-app-info-content .dijitTextBox {}.edit-app-info-content .dijitTextBoxFocused {border-color: #406b9b !important; box-shadow: 0 0 0 #ffffff !important;}.edit-app-info-content .dijitTextBoxHover{background-color: #ffffff; background-image: none;}.edit-app-info-content .dijitInputField {line-height: 15px !important; padding: 0 0 0 !important;}.edit-app-info-content .dijitTextBox .dijitInputInner{height: 23px;}.edit-app-info-content .app-name .name-text-box{width: 95%; padding: 2px;}.edit-app-info-content .app-description .desc-text-area{width: 95%; max-width: 95%; min-width: 95%; height: 200px; max-height: 200px; min-height: 200px; padding: 2px; resize: none;}.dj_ie8 .app-list-page .app-content .list-section-head,.dj_ie8 .app-list-page .app-content .list-section-body-content{filter: progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue); -ms-filter: "progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue)";}.app-catalog-page {width: 100%; height: 100%; position: relative; overflow: hidden; background-color: #f8f9fb;}.app-catalog-page .app-content {position: relative; max-width: 1300px; min-width: 1024px; margin: 0 auto; height: 100%; min-height: 340px; padding-top: 20px; padding-left: 20px; padding-right: 20px;}.app-catalog-page .app-content .list-table {table-layout: fixed; border-spacing: 0; width: 100%;}.app-catalogs.list-table-item {}.item-td {}.app-catalog-page .app-catalogs .catalog {background-color: #fff; height: 120px; width: 100%; margin: 0 auto 10px; -moz-box-shadow: 0 0 12px rgba(0, 0, 0, .1); -webkit-box-shadow: 0 0 12px rgba(0, 0, 0, .1); box-shadow: 0 0 12px rgba(0, 0, 0, .1);}.app-catalog-page .app-catalogs .catalog .content-theme {height: 100%; width: 180px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {width: 4px; position: absolute; left: 0; height: 100%;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {right: 0;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {position: absolute; top: 0px; left: 0px; width: 100%; height: 120px; background-size: 100% 100%; background-repeat: no-repeat; background-position: center; cursor: pointer;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg{position: absolute; width: 26px; height: 22px; bottom: 10px; left: 140px; background-position: center; background-repeat: repeat; display: block; z-index: 10;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-2D{background-image: url("images/flag_2d.png");}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-3D{background-image: url("images/flag_3d.png");}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {left: auto; right: 0px;} .app-catalog-page .app-catalogs .catalog .content-opers {height: 100%; width: 198px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-opers:before {background-color: #e5e5e5; content: ""; position: absolute; top: 20px; width: 1px; height: 80px;}.app-catalog-page .app-catalogs .catalog .content-opers-btns {margin: 44px 0 44px 20px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-opers-btns {margin-left: 0; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn {display: inline-block; position: relative; width: 32px; height: 32px; border: 2px solid #999; -moz-border-radius: 16px; -webkit-border-radius: 16px; border-radius: 16px; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn:hover {cursor: pointer; border: 2px solid #333;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download {background: url("images/download.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download:hover {background: url("images/download_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit {background: url("images/edit.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit:hover {background: url("images/edit_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch {background: url("images/view.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch:hover {background: url("images/view_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more {background: url("images/more.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more:hover {background: url("images/more_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more.content-opers-btns-more-selected {border: 2px solid #0f95bc; background: url("images/more_selected.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content {margin: 20px 20px 20px 30px;}.catalog-content {padding: 20px 20px 20px 200px;}.jimu-rtl .catalog-content {padding-right: 180px; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head {}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {left: 0px; font-family: "Avenir Medium"; font-size: 14px; color: #333; display: inline-block; max-width: 550px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {padding-right: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 20px; font-size: 12px; display: inline-block;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 0; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-time {font-family: "Avenir Light"; color: #999; padding-top: 1px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner {font-family: "Avenir Light"; color: #999; position: relative; padding: 0 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {background-color: #e5e5e5; content: ""; position: absolute; top: 5px; left: 10px; width: 1px; height: 10px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {content: ""; left: 0; right: 10px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {font-family: "Avenir Light"; color: #999; line-height: 18px; display: inline-block; vertical-align: top; padding-right: 6px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {padding-left: 6px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-name{display: inline-block; max-width: 100px; padding-top: 1px; height: 18px; line-height: 18px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-type {font-family: "Avenir Medium"; color: #31a6e0;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis {padding: 10px 20px 0 0; font-family: "Avenir Light"; font-size: 14px; color: #333; word-wrap: break-word; word-break: break-all; overflow: hidden; height: 70px;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis.place-holder-class {color: #cccccc;}.app-catalog-page .app-menu {position: absolute; background-color: #354052; width: 160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-catalog-page .app-menu .item {width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-catalog-page .app-menu .item {padding-right: 20px; padding-left: 0px;}.app-catalog-page .app-menu .item.border-top-radius {border-top-left-radius: 5px; border-top-right-radius: 5px;}.app-catalog-page .app-menu .item.border-bottom-radius {border-bottom-left-radius: 5px; border-bottom-right-radius: 5px;}.app-catalog-page .app-menu .item a {text-decoration: none; color: inherit;}.app-catalog-page .app-menu .up-triangle {position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-catalog-page .app-menu .up-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .down-triangle {position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-catalog-page .app-menu .down-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .item:hover {background-color: #6f7e95; color: #ffffff;}.app-card-page {position: relative; overflow: hidden;}.app-card-page .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.app-card-page .app-card-box {position: relative; width: 300px; height: 170px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.app-card-page .app-card-box .card {height: 100%; width: 100%;}.app-card-page .app-card-box .app-info-card {}.app-card-page .app-card-box .app-info-card .app-style-part {width: 100%; height: 4px;}.app-card-page .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 125px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon-td {width: 110px; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon {width: 80px; height: 80px; border: 2px solid #e5e5e5; border-radius: 10px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon.default-icon {background-size: 50px 50px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 20px; max-height: 38px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 16px; color: #333333; font-weight: bold;}.app-card-page .app-card-box .app-info-card .app-title-part .app-time-div {margin-top: 20px; color: #999999; font-size: 12px; line-height: 12px;}.app-card-page .app-card-box .app-des-card {position: absolute; width: 100%; height: 125px; top: 4px; left: 0; display: block; opacity: 0;}.app-card-page .app-card-box .app-des-card .app-des-part {width: 100%; height: 100%;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name{width: 100%; height: 75px;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name-div{max-height: 48px; line-height: 16px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.app-card-page .app-card-box .app-des-card .app-des-part .app-info-div{padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; line-height: 13px; margin-top: 10px; overflow: hidden;}.app-card-page .app-card-box .app-des-card .app-des-part .app-des{width: 100%; height: 50px; overflow: hidden; line-height: 16px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.app-card-page .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .app-card-page .app-card-box .app-operation-part {right: 10px; left: auto;}.app-card-page .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.app-card-page .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.app-card-page .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.app-card-page .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.app-card-page .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.app-card-page .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.app-card-page .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.app-card-page .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.app-card-page .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.app-card-page .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.app-card-page .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}.template-card-page {position: relative; overflow: hidden;}.template-card-page .template-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.template-card-page .template-card {position: relative; width: 300px; height: 320px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.template-card-page .template-card .template-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .template-card-page .template-card .template-type-div {right: auto; left: 5px;}.template-card-page .template-card .template-type-2d {background-image: url("images/flag_2d.png");}.template-card-page .template-card .template-type-3d {background-image: url("images/flag_3d.png");}.template-card-page .template-card .thumbnail-part {width: 100%; height: 180px; background-repeat: no-repeat; background-position: center;}.template-card-page .template-card .appInfo-part {width: 100%; height: 99px;}.template-card-page .template-card .appInfo-part .template-name {width: 100%; height: 40px;}.template-card-page .template-card .appInfo-part .template-name-div {max-height: 40px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 18px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.template-card-page .template-card .appInfo-part .template-des-div {width: 100%; height: 57px; overflow: hidden; line-height: 18px; font-size: 14px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.template-card-page .template-card .template-operation-part {position: relative; position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .template-card-page .template-card .template-operation-part {right: 10px; left: auto;}.template-card-page .template-card .template-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.template-card-page .template-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.template-card-page .template-card .launch-operation:hover {background-image: url("images/view_hover.png");}.template-card-page .template-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.template-card-page .template-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.template-card-page .template-card .edit-operation.disable {display: none;}.template-card-page .template-card .template-operation a{display: inline-block; width: 100%; height: 100%;}.template-card-page .template-card .create-app-from-template-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.template-card-page .template-card .create-app-from-template-operation:hover {background-image: url("images/add_hover.png");}.template-card-page .template-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.template-card-page .template-card .more-operation:hover {background-image: url("images/more_hover.png");}.template-card-page .template-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.template-card-page .template-card .more-operation.disable {display: none;}.card-page {position: relative; overflow: hidden;}.card-page .card-page-content {max-width: 1300px; min-width: 1024px; margin: 0px auto 0; padding-top: 20px; overflow: hidden; padding-left: 20px; min-height: 340px;}.card-page .item-card {position: relative; width: 300px; height: 350px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page .item-card .item-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 22px; bottom: 10px; right: 5px;}.jimu-rtl .card-page .item-card .item-type-div {right: auto; left: 5px;}.card-page .item-card .item-type-2d {background-image: url("images/flag_2d.png");}.card-page .item-card .item-type-3d {background-image: url("images/flag_3d.png");}.card-page .item-card .thumbnail-part {position: relative; display: inline-block; width: 100%; height: 200px; background-repeat: no-repeat; background-position: center; background-size: 100% 100%;}.card-page .item-card .appInfo-part {width: 100%; height: 109px; overflow: hidden;}.card-page .item-card .appInfo-part .item-name {width: 100%; height: 60px;}.card-page .item-card .appInfo-part .item-name-div {max-height: 39px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold; margin-top: 9px;}.card-page .item-card .appInfo-part .item-info-div {padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; line-height: 13px; margin-top: 12px; margin-bottom: 9px; overflow: hidden;}.card-page .item-card .appInfo-part .item-des-div {width: 100%; overflow: hidden; line-height: 22px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.card-page .item-card .appInfo-part .item-des-div.place-holder-class {color: #cccccc;}.card-page .item-card .item-operation-part {position: relative; position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page .item-card .item-operation-part {right: 10px; left: auto;}.card-page .item-card .item-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page .item-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page .item-card .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page .item-card .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page .item-card .download-operation:hover {background-image: url("images/download_hover.png");}.card-page .item-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page .item-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page .item-card .edit-operation.disable {display: none;}.card-page .item-card .item-operation a{display: inline-block; width: 100%; height: 100%;}.card-page .item-card .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page .item-card .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page .item-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page .item-card .more-operation:hover {background-image: url("images/more_hover.png");}.card-page .item-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.card-page .item-card .more-operation.disable {display: none;}.card-page-with-small-thumbnail {position: relative; overflow: hidden;}.card-page-with-small-thumbnail .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 0 auto 0; overflow: hidden; padding-left: 20px; padding-top: 20px; min-height: 340px;}.card-page-with-small-thumbnail .app-card-box {position: relative; width: 300px; height: 220px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page-with-small-thumbnail .app-card-box .card {height: 100%; width: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card {}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 120px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail-td {width: 155px; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {width: 120px; height: 80px; border-radius: 4px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {margin-left: auto; margin-right: 20px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-td {display: inline-block;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 16px; max-height: 32px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 14px; color: #333333; font-weight: bold; margin-top: 25px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-time-div {color: #999999; font-size: 12px; line-height: 12px; margin-top: 14px; margin-bottom: 10px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-creator-div {color: #999999; font-size: 12px; line-height: 12px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-box {position: relative; width: 100%; height: 59px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {width: 100%; height: 42px; overflow: hidden; line-height: 18px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; padding-top: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part.place-holder-class {color: #cccccc;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {}.card-page-with-small-thumbnail .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-operation-part {right: 10px; left: auto;}.card-page-with-small-thumbnail .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page-with-small-thumbnail .app-card-box .app-operation.disable {display: none;}.card-page-with-small-thumbnail .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page-with-small-thumbnail .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page-with-small-thumbnail .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page-with-small-thumbnail .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}body{background-color: white;}#main-view-stack{position: absolute; top: 40px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #E3ECF2;}.plugin-app-list {position: relative; background-color: #f8f9fb;}.plugin-app-list .header {width: 100%; background-color: #ffffff;}.plugin-app-list .header .navigator-box{width: 100%; height: 50px; border-bottom: 1px solid #e5e5e5;}.plugin-app-list .header .navigator{position: relative; min-width: 1024px; max-width: 1300px; padding-left: 20px; padding-right: 20px; height: 50px; margin: 0 auto;}.plugin-app-list .header .navigator .filter-box{}.plugin-app-list .header .navigator .filter{margin-right:10px; height: 50px; line-height: 50px; color: #999999; font-size: 14px; min-width: 40px; text-align: center;}.jimu-rtl .plugin-app-list .header .navigator .filter{margin-left: 10px; margin-right: auto;}.plugin-app-list .header .navigator .filter.selected{color: #d84b28; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .filter:hover{color: #d84b28; cursor: pointer; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .sort-box{padding-left: 20px; padding-right: 20px;}.plugin-app-list .header .navigator .sort {margin-right: 15px; height: 50px; width: 16px; background-repeat: no-repeat; background-position: center; cursor: pointer;}.plugin-app-list .header .navigator .sort-box .by-modified-time {background-image: url(images/most_recent.png);}.plugin-app-list .header .navigator .sort.by-modified-time.selected{background-image: url(images/most_recent_selected.png);}.plugin-app-list .header .navigator .sort.by-modified-time:hover{background-image: url(images/most_recent_hover.png);}.plugin-app-list .header .navigator .sort-box .by-name {background-image: url(images/by_name.png);}.plugin-app-list .header .navigator .sort.by-name.selected{background-image: url(images/by_name_selected.png);}.plugin-app-list .header .navigator .sort.by-name:hover{background-image: url(images/by_name_hover.png);}.plugin-app-list .header .navigator .sort-box .by-author {background-image: url(images/by_author.png);}.plugin-app-list .header .navigator .sort.by-author.selected{background-image: url(images/by_author_selected.png);}.plugin-app-list .header .navigator .sort.by-author:hover{background-image: url(images/by_author_hover.png);}.plugin-app-list .header .navigator .search{width: 300px; border: 1px solid #e5e5e5; border-radius: 15px; margin-top: 10px; padding-left: 5px;}.plugin-app-list .header .navigator .search .search-box{height: 30px; width: 250px; border: 0 solid; border-radius: 25px;}.plugin-app-list .header .navigator .search .search-box.dijitText{border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxFocused {border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxHover{background-color: #ffffff !important; border-color: #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box .dijitInputContainer {margin: 1px 5px;}.plugin-app-list .header .navigator .search .search-box .dijitInputInner{box-shadow: 0px 0px 0px #FFF !important;}.plugin-app-list .header .navigator .search .search-box .dijitPlaceHolder{font-style: normal;}.plugin-app-list .header .navigator .search .search-btn{width: 40px; height: 30px; background-image: url(images/search.png); background-repeat: no-repeat; background-position: center center;}.plugin-app-list .switch-app-page-box {position: absolute; right: 20px; bottom: 20px; z-index: 1;}.jimu-rtl .plugin-app-list .switch-app-page-box {left: 20px; right: auto;}.plugin-app-list .switch-app-page-box.hidden {display: none;}.plugin-app-list .switch-app-page-box .switch-app-page-btn {width: 21px; height: 21px; background-repeat: no-repeat; background-position: center center; cursor: pointer;}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page:hover {background-image: url(images/card_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page {background-image: url(images/catalog.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page.selected {background-image: url(images/catalog_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page:hover {background-image: url(images/catalog_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2 {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2:hover {background-image: url(images/card_hover.png);}.plugin-app-list .operation-box{position: relative; min-width: 1024px; max-width: 1300px; margin: 0 auto; height: 60px; padding-left: 20px; padding-right: 20px; padding-top: 20px;}.plugin-app-list .create{width: 150px; height: 40px; line-height: 40px; background-color: #31aacd; color: #ffffff; font-size: 14px; font-weight: bold; border-radius: 2px; cursor: pointer; text-align: center; margin-right: 20px;}.plugin-app-list .create:hover{background-color: #1b91b3;}.jimu-rtl .plugin-app-list .create{margin-left: 20px; margin-right: auto;}.plugin-app-list .content-box {position: absolute; left: 0; right: 0; top: 50px; bottom: 0; overflow: auto;}.plugin-app-list .content {display: none; min-height: 540px;}.plugin-app-list .content.selected{display: block;}.plugin-app-list .content .app-page-box {height: 100%; display: none;}.plugin-app-list .content .app-page-box.selected {display: block;}.plugin-app-list .footer {color: #999999; font-size: 12px; overflow: hidden; text-align: center;}.plugin-app-list .footer .footer-text {padding-left: 20px; padding-right: 20px; margin: 120px auto 30px; text-align: center; display: inline-block;}.plugin-app-list .footer .separator {margin-left: 5px; margin-right: 5px; font-weight: bold;}.plugin-app-list .footer a {text-decoration: none; color: #999999;}.plugin-app-list .empty-description-box {text-align: center; margin-top: 210px;}.plugin-app-list .empty-description-box.card-page{padding-right: 20px;}.plugin-app-list .empty-description {display: inline-block; text-align: left; color: #999999; font-size: 16px; font-family: "Avenir Medium"; line-height: 26px;}.plugin-app-list .empty-description span{color: #000000;}.fullscreen-popup-container .content .image-chooser-container{width: 150px; margin: 0 auto; padding: 30px 0; text-align: center; position: relative;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate{width: 300px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker{position: absolute; display: none; background-color: rgba(0,0,0,.8); text-align: center; font-size: 14px; color: #fff; z-index: 9999; cursor:pointer;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .image-chooser-base{width: 150px; height: 150px; background-color: #31aacd; border-radius: 50%;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .jimu-image-chooser{width: 80px; height: 80px; background-color: #f7fafa; border-radius: 10px; margin-top: 35px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserApp{width: 150px; height: 150px; border-radius: 50%; line-height: 150px;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .image-chooser-base{width: 330px; height: 230px; border: 1px solid #ccc; border-radius: 4px; background-size: 100% 100%; padding: 10px; background-color: #fff;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .jimu-image-chooser{width: 100%; height: 100%;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserTemplate{width: 330px; height: 230px; line-height: 210px; border-radius: 5px;}.fullscreen-popup-container .content .app-info-edit label{display: block; font-size: 14px; color:#333;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-name{height:40px; line-height: 40px; width: 100%; margin: 15px 0 30px 0;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-summary{height:100px; width: 100%; margin: 15px 0 30px 0; padding: 5px 10px; font-size: 12px; font-family: "Avenir Light";}.jimu-popup.jimu-popup-in-home .jimu-btn{background-color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn:hover{background-color: #1b91b3;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation{background-color: #FFFFFF; border: 1px solid #31aacd; color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation:hover{background-color: #f4f4f4;}',
"url:builder/plugins/attribute-config/Plugin.html":'\x3cdiv class\x3d"attribute-config" data-dojo-attach-event\x3d"onmouseleave:onMouseLeaveAttributeConfig"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"attributeSection"\x3e\r\n    \x3cdiv class\x3d"section jimu-float-leading header-section" data-dojo-attach-point\x3d"headerSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.headerTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.headerDesc}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading jimu-trailing-margin1 logo-container no-logo" data-dojo-attach-point\x3d"logoContainer" data-dojo-attach-event\x3d"onmouseenter:onLogoContainerMouseEnter"\x3e\r\n        \x3cdiv data-dojo-type\x3d"jimu/dijit/ImageChooser" data-dojo-attach-point\x3d"imageChooser" data-dojo-props\x3d"cropImage:false,showSelfImg:true,goldenWidth:30,goldenHeight:30,format:[\'image/gif\',\'image/png\',\'image/jpeg\']"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"add-logo"  data-dojo-attach-point\x3d"addLogoNode"\x3e\r\n          \x3cdiv class\x3d"image"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"remove-logo" title\x3d"${nls.removeLogo}" data-dojo-attach-point\x3d"removeLogoNode"data-dojo-attach-event\x3d"onclick:onRemoveLogo"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"change-logo" title\x3d"${nls.changeLogo}" data-dojo-attach-point\x3d"changeLogoNode"data-dojo-attach-event\x3d"onclick:onChangeLogo"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"titles jimu-float-leading"\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"title" data-dojo-attach-point\x3d"titleNodeDiv"\x3e\r\n          \x3cinput placeholder\x3d"${nls.title}" data-dojo-attach-point\x3d"titleNode" maxLength\x3d"100" class\x3d"styled-text"\x3e\r\n          \x3cspan class\x3d"label-editor" title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onTitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"subtitle" data-dojo-attach-point\x3d"subtitleNodeDiv"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.subtitle}" data-dojo-attach-point\x3d"subtitleNode" maxLength\x3d"100"  class\x3d"styled-text"\x3e\r\n          \x3cspan class\x3d"label-editor"  title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onSubtitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading links-section" data-dojo-attach-point\x3d"linksSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.linksTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cdiv class\x3d"list-header"\x3e\r\n          \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddLinkClick"\x3e${nls.addLink}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditLinkClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteLinkClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"links-list" data-dojo-attach-point\x3d"linksListNode"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading appId-section" data-dojo-attach-point\x3d"appIdSection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appIdTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3ca target\x3d"_blank" href\x3d"http://doc.arcgis.com/en/arcgis-online/share-maps/add-items.htm#ESRI_SECTION2_20AF85308FD548B5ADBAE28836F66D3F"\x3e${nls.appIdAbout}\x3c/a\x3e\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cinput type\x3d"text" placeholder\x3d"AppId" data-dojo-attach-point\x3d"appIdNode" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading" data-dojo-attach-point\x3d"useProxySection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"proxy-setting" data-dojo-attach-point\x3d"useProxySetting"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"proxy-section" data-dojo-attach-point\x3d"proxySection"\x3e\r\n        \x3clabel class\x3d"rules-label"\x3e${nls.proxyRulesLabel}\x3c/label\x3e\r\n        \x3cdiv class\x3d"attribute-content"\x3e\r\n          \x3cdiv class\x3d"list-header"\x3e\r\n            \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddProxyRuleClick"\x3e${nls.addProxyRule}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditProxyRuleClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteProxyRuleClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-header"\x3e\r\n            \x3cdiv class\x3d"prefix"\x3e${nls.prefixHeader}\x3c/div\x3e\r\n            \x3cdiv class\x3d"proxy-url"\x3e${nls.proxyUrlHeader}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-list" data-dojo-attach-point\x3d"proxyRulesListNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"always-use-proxy" data-dojo-attach-point\x3d"alwaysUseProxy"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"attribute-content" data-dojo-attach-point\x3d"proxyUrlSection" \x3e\r\n          \x3cinput type\x3d"text" placeholder\x3d"${nls.proxyUrl}" data-dojo-attach-point\x3d"proxyUrlNode" /\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading section-appstate"\r\n         data-dojo-attach-point\x3d"appStateController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appState}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e\r\n        \x3cdiv class\x3d"appstate-check" data-dojo-attach-point\x3d"appStateSetting"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-loading"\r\n         data-dojo-attach-point\x3d"loadingPageController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n        \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.setLoadingPage}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-appproxy"\r\n         data-dojo-attach-point\x3d"appProxyController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n        \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.configureAppProxy}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading loadingpage-section"\r\n       data-dojo-attach-point\x3d"loadingPageSection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading" data-dojo-attach-point\x3d"backController"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.backgroudColor}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgColorPicker"\r\n             data-dojo-type\x3d"jimu/dijit/ColorPicker" title\x3d"${nls.selectBackgoundColor}"\r\n             class\x3d"bgColor-control" class\x3d"jimu-float-trailing"\r\n             data-dojo-props\x3d"showLabel:true"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgUploaderDiv" class\x3d"jimu-leading-margin2"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgImageChooser"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifModeSection" class\x3d"jimu-leading-margin2" style\x3d"margin-top:10px;"\x3e\r\n        \x3cinput name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"selectMode"\r\n            data-dojo-attach-event\x3d"onclick: _onSelectGifMode"/\x3e\r\n        \x3clabel\x3e${nls.selectPredefinedGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"predefinedGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifSelect" style\x3d"margin-top:10px;"\r\n                  data-dojo-type\x3d"dijit/form/Select"\x3e\r\n            \x3cspan value\x3d"0"\x3e${nls.selectGif}\x3c/span\x3e\r\n            \x3cspan value\x3d"1"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"29" style\x3d"margin-top:2px;" src\x3d"${folderUrl}images/loading1.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"2"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"10" style\x3d"margin-top:12px;" src\x3d"${folderUrl}images/loading2.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"3"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"32" height\x3d"32" src\x3d"${folderUrl}images/loading3.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"4"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"34" height\x3d"34" src\x3d"${folderUrl}images/loading4.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cinput name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"uploadMode"\r\n            data-dojo-attach-event\x3d"onclick: _onUploadGifMode"\r\n            style\x3d"margin-top:10px;"/\x3e\r\n        \x3clabel\x3e${nls.uploadCustomGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"customGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifImageChooser"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading appproxy-section"\r\n       data-dojo-attach-point\x3d"appProxySection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading" data-dojo-attach-point\x3d"backController2"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section" data-dojo-attach-point\x3d"mapSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.mapLayers}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.mapLayersNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"header"\x3e\r\n        \x3cdiv class\x3d"sepeartor"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"row"\x3e\r\n          \x3cdiv class\x3d"col col-layername"\x3e${nls.layerName}\x3c/div\x3e\r\n          \x3cdiv class\x3d"col col-credits"\x3e${nls.consumeCredits}\x3c/div\x3e\r\n          \x3cdiv class\x3d"col col-proxy"\x3e${nls.useProxy}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"sepeartor"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"mapProxyContent"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin" data-dojo-attach-point\x3d"urlSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.customUrls}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.customUrlsNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"linkEditorNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.note}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note-content"\x3e\r\n        ${nls.creditsNote}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"loading"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/LinkEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"addLinkBtn"\x3e\r\n    \x3cdiv class\x3d"add-icon"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"text" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"link-list" data-dojo-attach-point\x3d"linkListNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/dijit/templates/LinkItemEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"mask"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cdiv class\x3d"input-section"\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"urlNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btn-section jimu-float-trailing"\x3e\r\n      \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"okBtn"\x3e${nls.ok}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-btn-vacation" data-dojo-attach-point\x3d"cancelBtn"\x3e${nls.cancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\t\t\t${!actionBarTemplate}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dojox/widget/ColorPicker/ColorPicker.html":'\x3ctable class\x3d"dojoxColorPicker" dojoAttachEvent\x3d"onkeypress: _handleKey" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\x3ctr\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxColorPickerBox"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg title\x3d"${saturationPickerTitle}" alt\x3d"${saturationPickerTitle}" class\x3d"dojoxColorPickerPoint" src\x3d"${_pickerPointer}" tabIndex\x3d"0" dojoAttachPoint\x3d"cursorNode" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cimg role\x3d"presentation" alt\x3d"" dojoAttachPoint\x3d"colorUnderlay" dojoAttachEvent\x3d"onclick: _setPoint, onmousedown: _stopDrag" class\x3d"dojoxColorPickerUnderlay" src\x3d"${_underlay}" ondragstart\x3d"return false"\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxHuePicker"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg dojoAttachPoint\x3d"hueCursorNode" tabIndex\x3d"0" class\x3d"dojoxHuePickerPoint" title\x3d"${huePickerTitle}" alt\x3d"${huePickerTitle}" src\x3d"${_huePickerPointer}" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dojoxHuePickerUnderlay" dojoAttachPoint\x3d"hueNode"\x3e\r\n\t\t\t\t    \x3cimg role\x3d"presentation" alt\x3d"" dojoAttachEvent\x3d"onclick: _setHuePoint, onmousedown: _stopDrag" src\x3d"${_hueUnderlay}"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerPreviewContainer"\x3e\r\n\t\t\t\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"previewNode" class\x3d"dojoxColorPickerPreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"safePreviewNode" class\x3d"dojoxColorPickerWebSafePreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"bottom"\x3e\r\n\t\t\t\t\t\t\x3ctable class\x3d"dojoxColorPickerOptional" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerRgb" dojoAttachPoint\x3d"rgbNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_r"\x3e${redLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_r" dojoAttachPoint\x3d"Rval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_g"\x3e${greenLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_g" dojoAttachPoint\x3d"Gval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_b"\x3e${blueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_b" dojoAttachPoint\x3d"Bval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerHsv" dojoAttachPoint\x3d"hsvNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_h"\x3e${hueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_h" dojoAttachPoint\x3d"Hval"size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${degLabel}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_s"\x3e${saturationLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_s" dojoAttachPoint\x3d"Sval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_v"\x3e${valueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_v" dojoAttachPoint\x3d"Vval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxColorPickerHex" dojoAttachPoint\x3d"hexNode" aria-live\x3d"polite"\x3e\t\r\n\t\t\t\t\t\t\t\t\t\t\x3clabel for\x3d"${_uId}_hex"\x3e\x26nbsp;${hexLabel}\x26nbsp;\x3c/label\x3e\x3cinput id\x3d"${_uId}_hex" dojoAttachPoint\x3d"hexCode, focusNode, valueNode" size\x3d"6" class\x3d"dojoxColorPickerHexCode" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/td\x3e\r\n\t\x3c/tr\x3e\r\n\x3c/table\x3e\r\n\r\n',
"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}"\r\n\trole\x3d"combobox"\r\n\taria-haspopup\x3d"true"\r\n\tdata-dojo-attach-point\x3d"_popupStateNode"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"${type}" autocomplete\x3d"off"\r\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/plugins/attribute-config/css/style.css":'.attribute-config{overflow-x: hidden; overflow-y: auto; font-size: 14px;}.attribute-config .section{padding: 15px 30px;}.header-section input,.links-section input,.appId-section input,.proxy-section input{height: 30px; border: 1px solid #d2dae2; padding: 5px; margin: 0; font-size: 12px; color: #232323; width: 100%; background-color: #fafafc; font-family: "Avenir Light";}.header-section input:focus,.links-section input:focus,.appId-section input:focus,.proxy-section input:focus{border: 1px solid #15a4fa; background-color: white; color: black;} .attribute-config .header-section{border: 0 solid;}.attribute-config .header-section .header-title,.attribute-config .title{color: #596679; line-height: 1.0; display: inline-block; width: 100%;}.attribute-config .styled-text {padding-right: 30px;}.jimu-rtl .attribute-config .styled-text {padding-left: 20px; padding-right: 0;}.attribute-config .header-section .logo-container {position: relative; font-size: 10px; width: 82px; height: 82px; margin-top: 10px; cursor: pointer; background-color: #ececec;}.attribute-config .header-section .logo-container:hover{background-color: #dcdcdc;}.attribute-config .header-section .logo-container.logo{border: 1px solid #d2dae2;}.attribute-config .header-section .logo-container.no-logo{border: 1px dashed #d2dae2;}.attribute-config .header-section .logo-container .hide{display: none;}.attribute-config .header-section .logo-container .jimu-image-chooser{width: 100%;}.attribute-config .header-section .logo-container.no-logo .jimu-image-chooser{position: absolute !important; opacity: 0; -ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.attribute-config .header-section .logo-container .jimu-image-chooser .hint .display-image {width: auto; height: auto;}.attribute-config .header-section .logo-container .add-logo{text-align: center; margin-top: 31px; cursor: pointer;}.attribute-config .header-section .logo-container .add-logo .image{margin: auto; margin-top: 10px; background: url(images/add_header.png) no-repeat center; width: 20px; height: 20px;}.attribute-config .header-section .logo-container .add-logo .text{font-size: 12px; color: #aaaaaa; text-align: center;}.attribute-config .header-section .logo-container .remove-logo,.attribute-config .header-section .logo-container .change-logo{display: none; position: absolute; width: 25px; height: 25px; right: 0px; z-index: 9999; cursor: pointer; background-color: rgba(0,0,0,.4); background-repeat: no-repeat; background-position: center;}.attribute-config .header-section .logo-container .remove-logo{top: 0px; background-image: url(images/remove_logo.png);}.attribute-config .header-section .logo-container .change-logo{bottom: 0px; background-image: url(images/change_logo.png);}.attribute-config .header-section .logo-container.logo:hover .remove-logo,.attribute-config .header-section .logo-container.logo:hover .change-logo {display: block;}.attribute-config .header-section .logo-container.logo .remove-logo:hover,.attribute-config .header-section .logo-container.logo .change-logo:hover{background-color: rgba(0,0,0,.6);}.attribute-config-plugin-logo-options.remove-logo{width: 25px; height: 25px; border-radius: 4px; background-repeat: no-repeat; background-position: center; background-image: url(images/remove_logo.png); z-index: 10000000; cursor: pointer; -ms-filter: "Alpha(opacity\x3d40)"; filter: Alpha(opacity\x3d40); background-color: rgb(0,0,0);}.attribute-config-plugin-logo-options.remove-logo:hover{-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60); background-color: rgb(0,0,0);}.attribute-config .header-section .titles{font-size: 10px; margin-top: 10px; width: calc(100% - 82px - 1em);}.attribute-config .header-section .titles input{height: 36px; background-color: white;}.attribute-config .header-section .titles .title{width: 100%; position: relative;}.attribute-config .header-section\x3e.title{width: 100%; height: 20px; position: relative;}.attribute-config .header-section .subtitle{width: 100%; height: 32px; margin-top: 10px; position: relative;}.attribute-config .header-section .label-editor{position: absolute; width: 12px; height: 12px; background: url("./images/A.png") no-repeat center; top: 12px; right: 10px; cursor: pointer; background-color: white;}.attribute-config .header-section .label-editor:hover{background: url("./images/A_hover.png") no-repeat center; background-color: #fafafc;}.jimu-rtl .attribute-config .header-section .label-editor{right: auto; left: 1px;}.format-font-style .dijitEditorIFrameContainer{position: absolute; top: 36px; left: 1px; right: 1px; bottom: 3px;}.format-font-style .dijitToolbar .dijitTextBox{width: 180px !important;}.el .format-font-style .dijitToolbar .dijitTextBox{width: 150px !important;}.pt-pt .format-font-style .dijitToolbar .dijitTextBox{width: 160px !important;}.it .format-font-style .dijitToolbar .dijitTextBox{width: 160px !important;}.format-font-style .dijitToolbar{font-size: 12px;}.appId-section .attribute-content{margin-top: 10px;}.appId-section a{color: #7EC6F8; float: right; cursor: pointer;}.proxy-section{display: none;}.attribute-config .sub-title{padding: 15px 0 10px 0;}.links-section .attribute-content{width: 340px; padding-top: 15px;}.links-section, .proxy-section{color: #a0acbf;}.attribute-config .attribute-content .links-list,.attribute-config .attribute-content .proxy-rule-list{padding-top: 10px;}.attribute-config .attribute-content .list-item.selected-item,.attribute-config .attribute-content .list-item:hover{background-color: #e3ecf2;}.attribute-config .attribute-content .list-item.selected-item .mask,.attribute-config .attribute-content .list-item:hover .mask{background-color: #e3ecf2;}.attribute-config .attribute-content .list-item{overflow: hidden; border-top-style: none; border: 1px solid #d2dae2; border-bottom-color: #eef2f5;}.attribute-config .attribute-content .list-item+.list-item{border-top-style: none;}.attribute-config .attribute-content .list-item:last-child{border-bottom-color: #dad2de;}.attribute-config .attribute-content .list-item:first-child{border-top-color: #dad2de;}.attribute-config .attribute-content .list-item .mask{width: 100%; height: 30px; color: #a0acbf; font-size: 12px; line-height: 30px; padding-left: 10px; border-width: 1px; background-color: #fafafc;}.attribute-config .attribute-content .list-item .mask:first-child{font-size: 14px;}.attribute-config .attribute-content .list-item .first,.attribute-config .attribute-content .list-item .second{height: 30px;}.proxy-rule-header{width: 100%; height: 30px; line-height: 30px; background-color: #518dca; color: white; margin: 10px 0 -10px;}.proxy-rule-header div{float: left; border-style: none; padding-left: 10px;}.attribute-content .list-item .first,.proxy-rule-header .prefix{width: 110px;}.proxy-rule-header .proxy-url{width: 228px;}.attribute-content .list-item .second{width: 228px; border-left: 1px solid #eef2f5;}.attribute-config .attribute-content .list-item .first input{border-right-style: none;}.attribute-config .attribute-content .list-header{}.attribute-config .list-header .header-button{display: inline-block; padding: 0 15px 0px 19px; color: #a0acbf; cursor: default;}.attribute-config .list-header .header-button.add{color: #518dca; cursor: pointer; background: url(images/add_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.add:hover{background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .header-button.edit{background: url(images/edit_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.delete{background: url(images/delete_icon01.png) no-repeat left;}.attribute-config .list-header .highlight-button{color: #518dca; cursor: pointer;}.attribute-config .list-header .highlight-button.add{color: #518dca; background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.edit{background: url(images/edit_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.delete{background: url(images/delete_icon02.png) no-repeat left;}.jimu-rtl .attribute-config .list-header .header-button,.jimu-rtl .attribute-config .list-header .highlight-button {background-position: right !important;}.attribute-config .section .always-use-proxy{color: #596679; cursor: pointer; display: inline-block; margin-top: 15px; margin-bottom: 6px;}.attribute-config .section .always-use-proxy .label{display: inline; float: none;}.proxy-section .rules-label{color: #596679; font-size: 12px; margin: 10px 0 12px 0; display: block; line-height: 12px;}.proxy-section .error-status{border: 1px solid #e84b4b; background-color: #fff;}.controller-loading,.controller-appproxy {cursor: pointer;}.controller-loading:hover,.controller-appproxy:hover {background: #F3F3F3;}.controller-loading .action-content{padding-top: 15px; height: 48px;}.section-appstate .action-content{padding-top: 15px;}.section-appstate .appstate-check .label{float: none !important; font-size: 12px !important; margin-left: 30px; color: #000;}.jimu-rtl .section-appstate .appstate-check .label{margin-right: 30px; margin-left: auto;}.loadingpage-section,.appproxy-section{margin-top: 25px; width: 100%; padding: 0 30px;}.appproxy-section .attribute-link,.loadingpage-section .attribute-link{text-align: center; font-family: "Avenir Medium"; font-size: 16px; color: #232323; height: 22px; width: 100%;}.loadingpage-section .config-part{margin-top: 10px; font-size: 14px; color: #7889a0; width: 300px;}.loadingpage-section .bgColor-control{height: 30px; width: 340px; margin-top: 10px; text-align: center; line-height: 30px; color: #000000;}.loadingpage-section .bgUploaderDiv{width: 300px; height: 30px;}.loadingpage-section .loading-image-chooser{width: auto; height: 30px; line-height: 30px; margin-top: 10px;}.loadingpage-section .jimu-btn{padding-top: 1px;}.loadingpage-section .config-part .label{font-family: "Avenir Medium"; font-size: 14px; color: #000000;}.loadingpage-section .config-part .jimu-checkbox .label{font-family: "Avenir Light"; font-size: 12px; color: #000000;}.loadingpage-section .config-part label{font-family: "Avenir Light"; font-size: 12px; color: #333333;}.loadingpage-section .config-part .value{font-size: 14px; color: #000000; margin-left: 15px;}.loadingpage-section .gif_select{width: 100px; height: 32px;}.section {width: 100%;}.section .title \x3e span {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323}.section .action-text,.sub-section .note {margin-top: 5px; line-height: 16px; font-size: 12px; color: #A7A7A7;}.appproxy-section {width: 100%;}.appproxy-section .sub-section {margin-top: 20px; width: 100%;}.appproxy-section .sub-section.double-margin {margin-top: 40px;}.appproxy-section .sub-section .title {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323;}.appproxy-section .sub-section .row {height: 16px; margin-top: 13px;}.appproxy-section .sub-section .row \x3e .col:first-child {text-align: left;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:first-child {text-align: right;}.appproxy-section .sub-section .row \x3e .col:last-child {text-align: right;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:last-child {text-align: left;}.appproxy-section .sub-section .col {width: 32%; line-height: 16px; font-family: "Avenir-Book"; font-size: 12px; color: #232323; display: inline-block; text-align: center; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;}.appproxy-section .sub-section .col.credits {background: url(images/PremiumContentUserCredit16.png) no-repeat center; height: 16px;}.appproxy-section .sub-section .col .checkbox {float: right !important;}.jimu-rtl .appproxy-section .sub-section .col .checkbox {float: left !important;}.appproxy-section .sub-section .header {height: 36px; margin: 10px 0;}.appproxy-section .sub-section .header .row {height: 36px; margin: 0;}.appproxy-section .sub-section .header .row .col {color: #898989; height: 36px; line-height: 36px;}.appproxy-section .sub-section .sepeartor {width: 100%; height: 1px; background: #EFEFEF;}.appproxy-section .note-content {font-family: "Avenir Medium"; font-size: 12px; color: #232323;}.loading {background: transparent;}',
"url:builder/plugins/creation-entry/Plugin.html":"\x3cdiv\x3e\r\n\r\n\x3c/div\x3e\r\n","url:builder/plugins/creation-entry/SaveAsPage.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"configureApp"\x3e${nls.savePublish}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderMsg}\x3c/p\x3e\r\n\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/creation-entry/CreateNewAppPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-select-page" data-dojo-attach-point\x3d"appSelectPage"\x3e\r\n    \x3cdiv class\x3d"switch-btn-box-container"\x3e\r\n      \x3cdiv class\x3d"switch-btn-box"\x3e\r\n        \x3cdiv class\x3d"switch-btn all-app-btn selected" data-dojo-attach-point\x3d"allAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onAllAppBtnClick"\x3e ${nls.all}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"separate"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"switch-btn own-app-btn" data-dojo-attach-point\x3d"ownAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onOwnAppBtnClick"\x3e ${nls.myTemplates}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content all-app-content" data-dojo-attach-point\x3d"allAppContent"\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"defaultApps"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"othersApps"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content own-app-content" data-dojo-attach-point\x3d"ownAppContent"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-page" data-dojo-attach-point\x3d"appInfoPage"\x3e\r\n    \x3cdiv class\x3d"app-info-table" data-dojo-attach-point\x3d"appInfoTable"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/creation-entry/css/style.css":".create-app-page {border: 0px solid; position: relative; margin: 0 auto;}.create-app-page .app-select-page {min-height: 200px;}.create-app-page .app-select-page .switch-btn-box-container {height: 50px; position: relative; margin-bottom: 10px; margin-left: 10px;}.create-app-page .app-select-page .switch-btn-box {position: absolute; left: 0; top: 20px; font-size: 14px; color: #999; font-weight: bold; line-height: 20px;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {right: 0; left: auto;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {margin-right: 8px; margin-left: auto;}.create-app-page .app-select-page .switch-btn-box .switch-btn {display: inline-block; cursor: pointer; font-size: 14px; text-align: center; min-width: 40px; border-bottom: 2px solid transparent;}.create-app-page .app-select-page .switch-btn-box .switch-btn:hover {color: #d84b28;}.create-app-page .app-select-page .switch-btn-box .switch-btn.selected {color: #d84b28; border-bottom: 2px solid #d84b28; min-width: 40px; text-align: center;}.create-app-page .app-select-page .switch-btn-box .separate {display: inline-block; width: 30px;}.create-app-page .app-info-page {width: 100%; border: 0px solid; top: 70px; margin: 0 auto;}.app-select-page .app-content {overflow: hidden;}.jimu-rtl .app-select-page .app-content {margin-right: 6px; margin-left: auto;}.app-select-page .all-app-content {overflow: auto; padding: 10px;}.app-select-page .own-app-content {overflow: auto; display: none; padding: 10px;}.app-select-page .app-content .app-line {float: left; width: 100%;}.jimu-rtl .app-select-page .app-content .app-line {float: right;}.app-select-page .app-content .app-node {border: 0px solid; text-align: center; position: relative; margin-right: 14px; cursor: pointer; max-width: 182px;}.app-select-page .app-content .app-node .flag-image {position: absolute; width: 26px; height: 22px; top: 86px; right: 10px; background-position: center; background-repeat: repeat; display: block;}.app-select-page .app-content .app-node .jimu-state-active .flag-image {}.app-select-page .app-content .app-node .flag-image-2D{background-image: url(images/flag_2d.png);}.app-select-page .app-content .app-node .flag-image-3D{background-image: url(images/flag_3d.png);}.app-select-page .app-content .app-node .app-image-border-div {position: relative; width: 180px; height: 120px; border: 2px solid transparent; border-radius: 4px; -webkit-box-shadow:0 0 10px rgba(0, 0, 0, .1); -moz-box-shadow:0 0 10px rgba(0, 0, 0, .1); box-shadow: 0 0 10px rgba(0, 0, 0, .1); background-color: #fff;}.app-select-page .app-content .app-node .app-image-div {width: 120px; height: 80px; background-repeat: no-repeat; background-color: #f2f2f2; background-position: center; margin: 0 auto; margin-top: 18px; background-size: 100% 100%;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-container {width: 180px; height: 120px; background-color: rgba(255,255,255,0.6); position: absolute;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-icon{position: absolute; width: 24px; height: 24px; top: 10px; right: 10px; background-position: center;}.app-select-page .app-content .app-node .app-name {color: #333; max-height: 50px; min-height: 20px; padding-top: 10px; padding-bottom: 10px; height: 40px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.app-select-page .app-content .app-node .jimu-state-active {border: 2px solid #31aacd; border-radius: 4px;}",
"url:builder/plugins/header/Plugin.html":'\x3cdiv class\x3d"top-nav clearfix"\x3e\r\n  \x3cdiv class\x3d"switch-section" data-dojo-attach-point\x3d"switchSection"\x3e\r\n    \x3cdiv class\x3d"switch-container"\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading applist-switch apps selected" data-dojo-attach-point\x3d"appSwitch"\x3e${nls.apps}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading applist-switch templates" data-dojo-attach-point\x3d"templateSwitch"\x3e${nls.templates}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dropdown left dropdown-home" data-dojo-attach-point\x3d"homeSection"\x3e\r\n    \x3ca class\x3d"dropdown-btn top-nav-title site_logo" data-dojo-attach-point\x3d"homeLabel"\x3e${nls.home}\x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu" data-dojo-attach-point\x3d"homeMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"homeItem"\x3e${nls.home}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"galleryItem"\x3e${nls.gallery}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"mapItem"\x3e${nls.map}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"sceneItem"\x3e${nls.scene}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"groupsItem"\x3e${nls.groups}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"contentItem"\x3e${nls.content}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"organizationItem"\x3e${nls.organization}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ca class\x3d"top-nav-link top-nav-logo left" data-dojo-attach-point\x3d"logoTitle"\x3e\r\n    Web AppBuilder for ArcGIS\r\n  \x3c/a\x3e\r\n\r\n  \x3ch1 class\x3d"avenir-light left text-ellipsis font-size-1 leader-1 app-name"\x3e\x3ca target\x3d"_blank" data-dojo-attach-point\x3d"appName"\x3e\x3c/a\x3e\x3c/h1\x3e\r\n\r\n  \x3cdiv class\x3d"dropdown right" data-dojo-attach-point\x3d"userSection" data-dojo-attach-event\x3d"onclick:_onUserSectionClicked"\x3e\r\n    \x3ca class\x3d"top-nav-link dropdown-btn top-nav-username text-ellipsis" data-dojo-attach-point\x3d"userInfoDom"\x3e\r\n      \x3cimg data-dojo-attach-point\x3d"userIcon" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" width\x3d"16" height\x3d"16"/\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"userNameNode"\x3e\x3c/span\x3e\r\n    \x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu dropdown-right text-ellipsis" data-dojo-attach-point\x3d"userMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" data-dojo-attach-point\x3d"profileItem"\x3e\r\n        \x3cimg width\x3d"32" height\x3d"32" class\x3d"gutter-right-half gutter-left-0 content-box left" data-dojo-attach-point\x3d"profileImg" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" /\x3e\r\n        \x3cspan\x3e${nls.profile}\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"profileNameNode" class\x3d"profile-name"\x3e\x3c/span\x3e\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"communityNode" class\x3d"hidden dropdown-link dropdown-link-external communityNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.communityAndForums}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"myesriNode" class\x3d"hidden dropdown-link dropdown-link-external myesriNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.myesri}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"trainingNode" class\x3d"hidden dropdown-link dropdown-link-external trainingNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.training}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"switchAccountsNode" class\x3d"hidden dropdown-link"\x3e${nls.switchAccounts}\x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"helpNode" class\x3d"dropdown-link"\x3e${nls.help}\x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"adminHelpNode" class\x3d"hidden dropdown-link admin-guide"\x3e${nls.administratorGuide}\x3c/a\x3e\r\n      \x3ca class\x3d"sign-out dropdown-link" data-dojo-attach-point\x3d"signOutItem"\x3e${nls.signOut}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/header/css/style.css":'.plugin-header .switch-section{position: absolute; left: 0; right: 0; height: 100%; z-index: -1;}.plugin-header.app-opened .switch-section{display: none;}.plugin-header .switch-section .switch-container{min-width: 1024px; max-width: 1260px; height: 100%; margin-left: auto; margin-right: auto; overflow: hidden;}.plugin-header.width-less1816 .switch-section .switch-container{margin-left: 280px; margin-right: 0;}.jimu-rtl .plugin-header.width-less1816 .switch-section .switch-container{margin-right: 280px; margin-left: 0;}.plugin-header .switch-section .switch-container .applist-switch{height: 100%; line-height: 60px; cursor: pointer; color: #999999; font-size: 14px;}.plugin-header .switch-section .switch-container .applist-switch.selected{color: #31aacd;}.plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 40px;}.jimu-rtl .plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 0; margin-left: 40px;}.plugin-header.clearfix:after {content: \'\'; display: table; clear: both;}.plugin-header .left {float: left;}.plugin-header .right {float: right;}.plugin-header .avenir-light {letter-spacing: 0em; font-weight: 300; font-style: normal;}.plugin-header .avenir-light b, .plugin-header .avenir-light strong {font-weight: 500;}.plugin-header .avenir-regular,.plugin-header.top-nav,.plugin-header .top-nav-link,.plugin-header .dropdown-link {letter-spacing: 0em; font-weight: 400; font-style: normal;}.plugin-header .avenir-regular b,.plugin-header.top-nav b,.plugin-header .top-nav-link b,.plugin-header .avenir-regular strong,.plugin-header.top-nav strong,.plugin-header .top-nav-link strong {font-weight: 500;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header [class^\x3d"esri-icon-"]:before,.plugin-header [class*\x3d" esri-icon-"]:before,.plugin-header [class^\x3d"icon-ui-"]:before,.plugin-header [class*\x3d" icon-ui-"]:before {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .esri-icon-link-external:before,.plugin-header .icon-ui-link-external:before {content: "\\e65c";}.plugin-header .esri-icon-down-arrow:before,.plugin-header .icon-ui-down-arrow:before,.plugin-header .dropdown-btn:after {content: "\\e608";}.plugin-header .esri-icon-user:before,.plugin-header .icon-ui-user:before {content: "\\e675";}.plugin-header .esri-icon-menu:before,.plugin-header .icon-ui-menu:before {content: "\\e663";}.plugin-header .top-nav-username {max-width: 175px; margin-bottom: -4px;}@media screen and (max-width: 1080px) {.plugin-header .top-nav-username {max-width: 130px;}}.plugin-header.top-nav {font-size: 17px; background-color: white;}.plugin-header.top-nav a {text-decoration: none;}.plugin-header.top-nav .dropdown-btn:after {top: 22px;}.plugin-header.top-nav {padding: 0 .5em; overflow: visible; z-index: 100;}.plugin-header .dropdown {position: relative; display: inline-block;}.plugin-header .dropdown.is-active .dropdown-menu {pointer-events: auto; display: block;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header .dropdown-btn {padding-right: 2em; cursor: pointer; position: relative;}.jimu-rtl .plugin-header .dropdown-btn{padding-right: 0; padding-left: 2em;}.plugin-header .dropdown-btn:after {font-size: 0.8125em; line-height: 1.55em; position: absolute; right: .75em;}.jimu-rtl .plugin-header .dropdown-btn:after{right: auto; left: 0.75em;}.plugin-header .dropdown-menu {position: absolute; left: 0; right: auto; min-width: 200px; max-width: 300px; margin-top: -12px; top: 100%; -webkit-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); -moz-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); z-index: 1000; pointer-events: none; display: none;}.jimu-rtl .plugin-header .dropdown-menu {left: auto; right: 0;}.plugin-header .dropdown-menu.dropdown-right {left: auto; right: 0;}.jimu-rtl .plugin-header .dropdown-menu.dropdown-right {left: 0; right: auto;}.plugin-header .dropdown-home .dropdown-btn {padding-top: 1em;}.plugin-header .side-nav, .plugin-header .dropdown-menu {-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; border: 1px solid #efefef; border-top: none; background-color: white;}.plugin-header .side-nav-title {margin: 0; padding: 0.5166666667em; font-size: 0.9375em; line-height: 1.55em; background-color: #f8f8f8; border-top: 1px solid #efefef;}.plugin-header .side-nav-link, .plugin-header .dropdown-link {position: relative; display: block; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0.5166666667em 1.55em 0.5166666667em 0.5166666667em; font-size: 0.875em; line-height: 1.55em; color: #6e6e6e; background-color: white; border-top: 1px solid #efefef; -webkit-transition: all 150ms linear; transition: all 150ms linear; text-decoration: none; cursor: pointer;}.plugin-header .side-nav-link:after, .plugin-header .dropdown-link:after {content: "\\00BB"; opacity: 0; position: absolute; right: 0; top: .5em; padding: 0 0.3875em; -webkit-transition: all 150ms linear; transition: all 150ms linear;}.plugin-header .side-nav-link:hover, .plugin-header .dropdown-link:hover {text-decoration: none; color: #828282;}.plugin-header .side-nav-link:hover:after, .plugin-header .dropdown-link:hover:after {opacity: 1;}.plugin-header .side-nav-link.is-active, .plugin-header .is-active.dropdown-link {background-color: #d2e9f9; font-weight: inherit !important;}.plugin-header .dropdown-link {white-space: nowrap;}.plugin-header .dropdown-link-external {padding: 0.5166666667em 2em !important;}.plugin-header .dropdown-link-external-icon {position: absolute; left: .5em;}.plugin-header.top-nav {border-bottom: 1px solid #efefef;}.plugin-header.top-nav .esri-logo {margin-top: 1em;}.plugin-header.top-nav .sign-in {padding-top: 1.55em;}.plugin-header .top-nav-title {font-size: 1em; float: left; padding-top: 15px; padding-bottom: 15px; line-height: 1.5em; color: #4c4c4c;}.plugin-header .top-nav-title:hover {color: #3b8fc4; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-title.icon-ui-menu:before {vertical-align: -1px; padding-right: .5em;}.plugin-header .top-nav-list {padding: 0; float: left;}.plugin-header .top-nav-list .top-nav-link + .top-nav-link {margin-left: .75em;}.plugin-header .top-nav-link {font-size: 0.9375em; line-height: 1.55em; color: #4c4c4c; padding: 19px 0; line-height: 1.5em; display: inline-block;}.plugin-header .top-nav-link:hover, .plugin-header .top-nav-link:focus {color: #3b8fc4; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-link:hover a, .plugin-header .top-nav-link:focus a {color: #3b8fc4;}.plugin-header .top-nav-link:focus {outline: none;}.plugin-header .top-nav-link.is-active {background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent;}.plugin-header .top-nav-link a {color: #4c4c4c;}.plugin-header .top-nav-link a:hover {text-decoration: none;}.plugin-header .top-nav-link.dropdown-btn {padding-right: 1em;}.plugin-header .top-nav-link.dropdown-btn:after {right: 0;}.plugin-header .user-nav-name {padding: 0.3875em;}.plugin-header .user-nav-image {width: 1.55em; height: 1.55em; margin-right: 0.3875em; vertical-align: -0.3875em;}.plugin-header .link-blue a, .plugin-header a.link-blue {color: #3b8fc4;}.plugin-header .link-blue a:hover, .plugin-header a.link-blue:hover {color: #196fa6;}.plugin-header .link-darkest-gray a,.plugin-header a.link-darkest-gray {color: #595959;}.plugin-header .link-darkest-gray a:hover, .plugin-header a.link-darkest-gray:hover {color: #4c4c4c;}.plugin-header .text-ellipsis {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.plugin-header .font-size--3 {font-size: 0.8125em; line-height: 1.55em;}.plugin-header .font-size--2 {font-size: 0.875em; line-height: 1.55em;}.plugin-header .font-size--1 {font-size: 0.9375em; line-height: 1.55em;}.plugin-header .font-size-0 {font-size: 1em; line-height: 1.55em;}.plugin-header .font-size-1 {font-size: 1.1875em; line-height: 1.55em;}.plugin-header .font-size-2 {font-size: 1.25em;}.plugin-header .font-size-3 {font-size: 1.484375em; line-height: 2.325em;}.plugin-header .leader-half {margin-top: 11px;}.plugin-header .trailer-half {margin-bottom: 0.775em;}.plugin-header .padding-leader-half {padding-top: 0.775em;}.plugin-header .padding-trailer-half {padding-bottom: 0.775em;}.plugin-header .leader-0 {margin-top: 0em;}.plugin-header .trailer-0 {margin-bottom: 0em;}.plugin-header .padding-leader-0 {padding-top: 0em;}.plugin-header .padding-trailer-0 {padding-bottom: 0em;}.plugin-header .leader-1 {margin-top: 14px;}.plugin-header .padding-leader-1 {padding-top: 22px;}.plugin-header .gutter-left-half {padding-left: 0.5em;}.plugin-header .gutter-right-half {padding-right: 0.5em;}.plugin-header .gutter-left-0 {padding-left: 0em;}.plugin-header .gutter-right-0 {padding-right: 0em;}.plugin-header .gutter-left-1 {padding-left: 1em;}.plugin-header .gutter-right-1 {padding-right: 1em;}.plugin-header .gutter-right-2 {padding-right: 2em;}.jimu-rtl .plugin-header .gutter-left-half {padding-left: 0; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-right: 0; padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-left-1 {padding-left: 0; padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-right: 0; padding-left: 1em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-right: 0; padding-left: 2em;}.jimu-rtl .plugin-header .left {float: right;}.jimu-rtl .plugin-header .right {float: left;}.jimu-rtl .plugin-header .top-nav-title {float: right;}.jimu-rtl .plugin-header .top-nav-link {float: right;}.jimu-rtl .plugin-header .top-nav-list {float: right;}.jimu-rtl .plugin-header .top-nav-link + .top-nav-link {margin-left: 0; margin-right: .75em;}.jimu-rtl .plugin-header .gutter-left-half {padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-right: 0em;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0em;}.jimu-rtl .plugin-header .gutter-left-1 {padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-left: 1em; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-left: 2em;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn:after {left: 0; right: auto; padding-right: 0.5166666667em; padding-left: 0;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn {padding-left: 1em; padding-right: 0;}.jimu-rtl .plugin-header .side-nav-link:after, .jimu-rtl .plugin-header .dropdown-link:after {left: 0; right: auto;}.jimu-rtl .plugin-header .side-nav-link, .jimu-rtl .plugin-header .dropdown-link {padding: 0.5166666667em 0.5166666667em 0.5166666667em 2.5em;}.jimu-rtl .plugin-header [class^\x3d"icon-ui-"]:before, .jimu-rtl .plugin-header [class*\x3d" icon-ui-"]:before {padding-right: 0; padding-left: 0.5166666667em;}.jimu-rtl .plugin-header .sub-nav-link, .jimu-rtl .plugin-header a.sub-nav-link {float: right;}.jimu-rtl .plugin-header .dropdown-link-external-icon {left: auto; right: .5em;}.plugin-header.top-nav .hidden {display: none;}.plugin-header .top-nav-logo {padding-left: 36px; padding-right: 15px; background: url(images/logo.png) no-repeat left center;}.plugin-header .top-nav-logo:hover {background: url(images/logo.png) no-repeat left center;}.plugin-header.xt.app-opened .top-nav-logo{cursor: pointer;}.jimu-rtl .plugin-header .top-nav-logo {padding-left: 15px; padding-right: 36px; background: url(images/logo.png) no-repeat right center;}.jimu-rtl .plugin-header .top-nav-logo {background: url(images/logo.png) no-repeat right center;}.plugin-header .content-box {box-sizing: content-box !important;}.plugin-header .app-name {max-width: 60%;}.plugin-header .app-name a{color: black;}.plugin-header .app-name a.highlight:hover{color: #3b8fc4;}@media screen and (max-width: 960px) {.plugin-header .app-name {max-width: 40%;}}@media screen and (max-width: 720px) {.plugin-header .app-name {max-width: 30%;}}.plugin-header .top-nav-logo{position: relative; top: 1px;}.plugin-header .top-nav-username{font-size: 14px;}.plugin-header .top-nav-username img{position: relative; top: 3px;}.plugin-header .top-nav-username span{position: relative;}.plugin-header.app-not-opened{background-color: #333333;}.plugin-header.app-not-opened .top-nav-link.top-nav-logo{color: #ffffff !important;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch{color: #999999;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch.selected{color: #ffffff;}.plugin-header.app-not-opened .top-nav-link.top-nav-username{color: #999999 !important;}',
"url:builder/plugins/map-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"map-info-section"\x3e\r\n    \x3cdiv class\x3d"map-selected-meta-data"\x3e\r\n      \x3cdiv class\x3d"thumbnail-container" data-dojo-attach-point\x3d"thumbnailContainer" data-dojo-attach-event\x3d"click:showMapSelector" title\x3d"${nls.clickChooseWebMapOrWebScene}"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"detail-info"\x3e\r\n        \x3cdiv style\x3d"overflow:hidden;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webItemIcon" class\x3d"web-item-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"owner-div jimu-float-leading" style\x3d"width:140px;"\x3e\r\n            \x3cspan class\x3d"item-type" data-dojo-attach-point\x3d"webItemType"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"owner-link-div"\x3e\r\n          \x3cspan class\x3d"owner-tip"\x3e${nls.owner}\x3c/span\x3e\r\n          \x3ca class\x3d"owner-name" href\x3d"#" target\x3d"_blank" data-dojo-attach-point\x3d"ownerName"\x3e\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"margin-top:5px;color:#596679;"\x3e\r\n          \x3cspan\x3e${nls.lastModified}:\x3c/span\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"lastModified" class\x3d"last-modified"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"webmap-details-div"\x3e\r\n          \x3ca data-dojo-attach-point\x3d"webMapDetails" href\x3d"#" target\x3d"_blank" class\x3d"webmap-details" title\x3d"${nls.moreDetails}"\x3e${nls.moreDetails}...\x3c/a\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"map-chooser"\x3e\r\n          \x3cdiv nowrap class\x3d"choose-map-btn" data-dojo-attach-event\x3d"click:showMapSelector"\x3e\r\n            \x3cdiv class\x3d"label" data-dojo-attach-point\x3d"chooseMapButton" title\x3d"${nls.chooseWebMapOrWebScene}"\x3e${nls.chooseWebMapOrWebScene}\x3c/div\x3e\r\n            \x3cdiv class\x3d"options jimu-float-trailing" data-dojo-attach-point\x3d"mapOptions" data-dojo-attach-event\x3d"click:showMapOptions"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapEditOptions" class\x3d"edit-options" style\x3d"display: none;"\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-point\x3d"btnEditWebMap" data-dojo-attach-event\x3d"click:editWebMap" title\x3d"${nls.editMap}"\x3e${nls.editMap}\x3c/div\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-point\x3d"btnCreateWebMap" data-dojo-attach-event\x3d"click:createWebMap" title\x3d"${nls.createMap}"\x3e${nls.createMap}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapOptionsMask" class\x3d"overlay-mask" data-dojo-attach-event\x3d"click:hideMapOptions" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"map-info-content"\x3e\r\n      \x3cdiv class\x3d"map-info-title option-title" data-dojo-attach-point\x3d"mapTitle"\x3e\x3c/div\x3e\r\n      \x3cp class\x3d"snippet" data-dojo-attach-point\x3d"snippet"\x3e\x3c/p\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions2D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialExtent}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.statement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useCurrentMapExtent"\x3e${nls.useCurrentExtent}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useDefaultMapExtent"\x3e${nls.restoreInitialExtent}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"map-option scale-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.scaleTitle}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.scaleStatement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn scale-btn jimu-btn-vacation" data-dojo-attach-point\x3d"btnScale" data-dojo-attach-event\x3d"onclick:_onBtnScaleClicked"\x3e${nls.customize}...\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions3D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialSceneState}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.sceneStateTip}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" title\x3d"${nls.useCurrentSceneState}" data-dojo-attach-event\x3d"onclick:_useCurrentViewpoint"\x3e${nls.useCurrentSceneState}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" title\x3d"${nls.useWebSceneDefaultState}" data-dojo-attach-event\x3d"onclick:_useDefaultViewpoint"\x3e${nls.useWebSceneDefaultState}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapSelector.html":'\x3cdiv style\x3d"position:relative;width:100%;height:100%;"\x3e\r\n\t\x3cdiv class\x3d"map-setting-tab-container" style\x3d"width:100%;height:100%;"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onMyContentRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"mycontentSelect" data-dojo-attach-event\x3d"change:_onMyContentSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\t\t\t\t\t\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"  style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onOrgRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"organizationSelect" data-dojo-attach-event\x3d"change:_onOrganizationSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\t\t\t\t\t\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:70px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section" data-dojo-attach-point\x3d"groupSearchSection"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onGroupRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"groupSelect" data-dojo-attach-event\x3d"change:_onGroupSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\t\t\t\t\t\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:113px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onPublicRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"publicSelect" data-dojo-attach-event\x3d"change:_onPublicSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews" selected\x3d"true"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\t\t\t\t\t\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel  data-dojo-attach-point\x3d"portalNameLabel" class\x3d"jimu-float-leading portal-name"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlineNameLabel" class\x3d"jimu-float-leading online-name"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicMapSection" class\x3d"public-map-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section hidden" data-dojo-attach-point\x3d"signinSection"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section hidden" data-dojo-attach-point\x3d"filteredMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section hidden" data-dojo-attach-point\x3d"searchNoneTipSection"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/CustomizeScale.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"scale-input-div" data-dojo-attach-point\x3d"scaleInputDiv"\x3e\r\n    \x3cdiv class\x3d"add-btn jimu-float-leading" data-dojo-attach-point\x3d"btnAdd" data-dojo-attach-event\x3d"onclick:_onBtnAddClicked"\x3e+\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"operations-div"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn delete-btn" data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_onBtnDeleteClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.deleteTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn reset-btn" data-dojo-attach-event\x3d"onclick:_onBtnResetClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.resetTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"list" data-dojo-attach-point\x3d"listNode" data-dojo-attach-event\x3d"onclick:_onLodListClicked"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/css/style.css":".map-config{margin: 0; padding: 0; overflow-y: hidden;}.map-config .map-info-section{position:absolute; left: 20px; right: 20px; top: 20px; bottom: 0;}.map-config .big-img{position:relative; width:100%; height:240px; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background:#e5e5e5;}.map-config .add-map-tip{margin-top:13px; padding-left:6px; padding-right:6px; color:#999999; font-size:12px;}.map-config .map-selected-meta-data{position: relative; width: 100%; height: 133px;}.map-config .thumbnail-container{position:absolute; left: 0; right: auto; top: 0; width:190px; height:133px; cursor: pointer;}.jimu-rtl .map-config .thumbnail-container{left: auto; right: 0;}.map-config .thumbnail-container .thumbnail{width: 100%; height: 100%; background-color:#e5e5e5; border:1px solid #d2dae2; background-repeat:no-repeat; background-position:center center; background-size:cover;}.map-config .thumbnail-container .thumbnail.default-webmap{background-image: url(images/WebMapThumbnail.png);}.map-config .thumbnail-container .thumbnail.default-webscene{background-image: url(images/WebSceneThumbnail.jpeg);}.map-config .detail-info{position: absolute; left: 200px; top: 0; right: 0; height: 100%; color: #333333; font-size: 12px;}.has-mozilla .map-config .detail-info{font-size: 12px;}.jimu-rtl .map-config .detail-info{left: 0; right: 200px;}.map-config .web-item-icon{display: inline-block; width: 16px; height: 16px; background-position: center center; background-repeat: no-repeat;}.map-config .web-item-icon.webmap{background-image: url(images/WebMapIcon.png);}.map-config .web-item-icon.webscene{background-image: url(images/WebSceneIcon.png);}.map-config .owner-div{padding-left: 5px; color: #596679;}.jimu-rtl .map-config .owner-div{padding-left: 0; padding-right: 5px;}.map-config .owner-link-div{white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-top: 5px;}.map-config .owner-link-div .owner-name{color: #24B5CC; text-decoration: none;}.map-config .last-modified{white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .webmap-details-div{margin-top:5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .webmap-details{text-decoration: none; color: #24B5CC;}.map-config .map-info-content{position: absolute; width: 100%; left: 0; right: 0; top: 143px; bottom: 0; overflow: auto;}.map-config .snippet{max-height:115px; overflow: hidden; text-overflow: ellipsis; margin-top: 10px; font-size:12px; color: #666;}.map-config .map-options{display: none;}.map-config .map-options.enabled{display: block;}.map-config .extent-option{margin-top: 33px;}.map-config .option-title{font-size: 14px; color: #000; font-family: 'Avenir Medium';}.map-config .option-statement{font-size: 12px; color: #666; margin-top: 9px;}.map-config .init-ext-btn{margin-top:10px;}.map-config .restore-ext-btn{margin-top:10px;}.map-config .scale-option{margin-top: 38px;}.map-config .scale-btn{margin-top: 10px;}.map-config .map-chooser{position: absolute; left: 0; bottom: 0; width: 100%;}.map-config .overlay-mask{position: fixed; width: 100%; height: 100%; left: 0; top: 0; z-index: 119;}.map-config .edit-options{box-shadow: 0 0 16px rgba(160,160,160,0.4); background-color: white; z-index: 120; width: 160px; position: absolute; left: 0; top: 40px;}.jimu-rtl .map-config .edit-options{left: auto; right: 0;}.map-config .edit-options \x3e .option-item{width: 100%; height: 40px; cursor: pointer; line-height: 40px; font-size: 14px; white-space:nowrap; overflow:hidden; text-align: left; text-overflow: ellipsis; background-color: #24B5CC; color: #ffffff; border-top: 2px solid #ffffff; padding: 0 10px;}.jimu-rtl .map-config .edit-options \x3e .option-item{text-align: right;}.map-config .edit-options \x3e .option-item:hover{background-color: #0090A7;}.map-config .choose-map-btn{width: 160px; height: 40px; overflow:hidden; text-align: center; background-color: #24B5CC; cursor: pointer;}.map-config .choose-map-btn .label{display: inline-block; line-height: 40px; text-overflow: ellipsis; white-space:nowrap; font-size: 14px; color: #ffffff; max-width: 140px; padding: 0 5px; overflow: hidden;}.map-config .choose-map-btn .label:hover{background-color: #0090A7;}.map-config .choose-map-btn .options{display: inline-block; height: 40px; background: url('images/v-White.png') no-repeat center; width: 20px; border-left: 1px solid rgba(255, 255, 255, 0.3);}.map-config .choose-map-btn .options:hover{background-color: #0090A7;}.jimu-rtl .map-config .choose-map-btn .options{border-left: none; border-right: 1px solid rgba(255, 255, 255, 0.3);}.map-config .jimu-btn{padding: 0 15px; font-size: 14px; line-height: 33px; text-align: center; max-width: 100%;}.map-config .jimu-btn.jimu-state-disabled{color: #d9dde0;}.map-config .map-info-title{margin-top:10px;}.map-config .set-extent-tip{color:#999999; font-size:12px;}.map-config .description{position:absolute; top:420px; bottom:0; width:100%; overflow:auto; color:#999999; font-size:12px;}.map-table{position:absolute; width: 100%; top:0; bottom: 0; height: auto;}.map-table .maps-section{position: absolute; width: 100%; top: 0; bottom: 0;}.map-table .maps-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto;}.map-table .maps-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.map-table .maps-table td{vertical-align:top;}.map-table .map-item-div{width:176px; padding:3px;}.map-table .map-item-div .map-item-bg{position:relative; width:100%; height:118px; text-align:center; color:#999999; font-size:13px;}.map-table .map-item-div .map-item-bg .map-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center; border:1px solid #d2dae2; background-size:cover;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-thumbnail{left: auto; right: 0;}.map-table .map-item-div .map-item-bg.selected .map-item-thumbnail{border:3px solid #24B5CC; -webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.map-table .map-item-div .map-item-bg .map-item-detail-icon{display: none; position:absolute; right:7px; bottom:7px; width:15px; height:15px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/info.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-detail-icon{right: auto; left: 7px;}.map-table .map-item-div .map-item-bg:hover .map-item-detail-icon{display: block;}.map-table .map-item-div .map-item-title{display:inline-block; width:100%; max-height: 31px; text-align:center; color:#596679; font-size:13px; margin-top: 10px; overflow: hidden; word-wrap: break-word;}.map-table .search-none-tip-section .search-none-icon{margin-left:5px;}.jimu-rtl .map-table .search-none-tip-section .search-none-icon{margin-left: 0; margin-right: 5px;}.map-table .search-none-tip-section .search-none-tip{font-size:13px; color:#ff0000; margin-left:10px;}.jimu-rtl .map-table .search-none-tip-section .search-none-tip{margin-left: 0; margin-right: 10px;}.map-selector .hidden{display: none;}.map-selector .jimu-tab3{height: 100%;}.map-selector .jimu-tab3\x3e.container-node{position:absolute; width:100%; left:0; right:0; top:60px; bottom:0;}.map-selector .jimu-tab3 .tab-item-div{height: 48px; line-height: 48px;}.map-selector .tab-content{position: relative;}.map-selector .tab-content .tab-content-main{position: absolute; width: 100%; top:0; bottom:0;}.map-selector .search-section{position:absolute; width:100%; height:45px; top: 15px; font-size: 12px;}.map-selector .search-section .jimu-search{width: 81%;}.map-selector .search-section .dijitSelect{box-sizing: border-box;}.map-selector .refresh-icon{width: 16px; height: 16px; cursor: pointer; background: url(images/reset1.png) center center no-repeat; margin-top: 12px; margin-left: 7px;}.jimu-rtl .map-selector .refresh-icon{margin-left: auto; margin-right: 7px;}.map-selector .search-section .restrict-select-width{position: relative; width: 146px; top: 5px;}.map-selector .public-search-radios{position:absolute; width:100%; top:75px; height: 20px; line-height:1em; font-size: 14px;}.map-selector .public-search-radios span{display: inline-block;}.map-selector .public-search-radios .portal-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .portal-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-search-radios .portal-name{margin-right: 28px;}.jimu-rtl .map-selector .public-search-radios .portal-name{margin-right: 0; margin-left: 28px;}.map-selector .public-search-radios .online-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .online-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-map-section{position:absolute; width:100%; top:100px; bottom:0;}.map-selector .signin-section{position: absolute; top:75px; width:100%;}.map-selector .signin-section .signin-tip{width:100%; color:#d6d6d6; font-size:13px;}.map-selector .groups-section{font-size: 14px;}.map-selector .groups-section .groups-select{height: 30px; padding: 0 5px;}.mapconfig-customize-scale{width: 100%; height: 100%;}.mapconfig-customize-scale .scale-input-div{position:relative; height:30px;}.mapconfig-customize-scale .add-btn{width: 30px; height: 100%; line-height: 30px; color: #ffffff; font-size: 28px; text-align: center; vertical-align: center; cursor: default; background-color: #d2dae2;}.claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: left;}.jimu-rtl .claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: right;}.mapconfig-customize-scale .scale-input-div:hover .add-btn{background-color: #24B5CC;}.mapconfig-customize-scale .operations-div{height: 24px; margin-top: 13px; margin-bottom: 2px;}.mapconfig-customize-scale .operation-btn{display: inline-block; overflow: hidden; height: 24px; cursor: default; font-size: 13px;}.mapconfig-customize-scale .operation-btn .icon{width: 14px; height: 100%; background-repeat: no-repeat; background-position: center center;}.mapconfig-customize-scale .delete-btn{color: #a0acbf; cursor: default;}.mapconfig-customize-scale .delete-btn.enabled-operation{color: #518dca; cursor: pointer;}.mapconfig-customize-scale .delete-btn .icon{background-image: url(images/delete1.png);}.mapconfig-customize-scale .delete-btn.enabled-operation .icon{background-image: url(images/delete2.png);}.mapconfig-customize-scale .reset-btn .icon{background-image: url(images/reset2.png);}.mapconfig-customize-scale .reset-btn{margin-left: 15px; color: #24B5CC; cursor: pointer;}.jimu-rtl .mapconfig-customize-scale .reset-btn{margin-left: 0; margin-right: 15px;}.mapconfig-customize-scale .operation-btn .label{height: 100%; line-height: 24px; vertical-align: middle; margin-left: 7px;}.jimu-rtl .mapconfig-customize-scale .operation-btn .label{margin-left: 0; margin-right: 7px;}.mapconfig-customize-scale .list{width: 100%; height: 395px; border: 1px solid #dfe4ea; background-color: #fafafc; color: #7989a0; font-size: 14px; overflow: auto;}.mapconfig-customize-scale .list .lod-item{height: 30px; line-height: 30px; padding-left: 10px; cursor: default; border-bottom: 1px solid #f2f4f7;}.mapconfig-customize-scale .list .lod-item.selected{background-color: #e3ecf2; color: #596670;}.embed-mapviewer-content {width: 100%; height: 100%; position: relative;}.embed-mapviewer-content .load-container {float: left; position: absolute; overflow: hidden; bottom: 30px; right: 20px;}.embed-mapviewer-content .load-container .loader {font-size: 20px; width: 1.5em; height: 1.5em; border-radius: 50%; position: relative; text-indent: -9999em;}",
"url:builder/plugins/popup-actions/popup-agoltemplate/css/style.css":".plugin-app-actions-template-popup .template-popup-content {height: 100%;}.plugin-app-actions-template-popup .template-popup-content .config-part {width: 70%; height: 100%;}.plugin-app-actions-template-popup .template-popup-content .privew-part-box {height: 100%; width: 30%; padding: 10px 0 10px 0;}.plugin-app-actions-template-popup .template-popup-content .privew-part-inset-box {height: 100%; width: 100%; box-shadow: 0px 0px 8px rgba(0,0,0,0.4) inset; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-app-actions-template-popup .template-popup-content .privew-part {width: 90%; height: 100%; min-width: 275px; max-width: 500px; margin: 0 auto;}.plugin-app-actions-template-popup-for-xt .button-container {overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-btn {position: relative; overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-draw-box {position: absolute; height: 60px; background-color: #cccccc; top: -61px; left: 0; cursor: default; background: #fff; box-shadow: 0 0 4px #646464; color: #7989a0; text-align: left; max-width: 270px; overflow: hidden;}.jimu-rtl .plugin-app-actions-template-popup-for-xt .export-draw-box {right: 0; left: auto;}.plugin-app-actions-template-popup-for-xt .export-draw-box.export-draw-box-hiden{display: none;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn{cursor: pointer; height: 30px; padding-left: 20px; padding-right: 20px;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn:hover{background: #edf2f5; color: #15a4fa;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn.export-draw-box-btn-disable{color: #d2dae2;}",
"url:jimu/dijit/templates/ShareOptions.html":'\x3cdiv class\x3d"shareOptions"\x3e\r\n  \x3cdiv class\x3d"shareOptionsWrapper"\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.shareMap}\x3c/div\x3e\r\n    \x3cdiv class\x3d"tips"\x3e${nls.shareMapTips}\x3c/div\x3e\r\n    \x3cdiv id\x3d"share-everyone-check_div" class\x3d"shareOptionItems" data-dojo-attach-point\x3d"share-everyone-check_div"\x3e\r\n      \x3cinput id\x3d"share-everyone-check" data-dojo-attach-point\x3d"shareEveryoneCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-everyone-check-label" for\x3d"share-everyone-check" class\x3d"labels"\x3e${nls.everyone}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-account-check_div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-account-check_div"\x3e\r\n      \x3cinput id\x3d"share-account-check" data-dojo-attach-point\x3d"share-account-check" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-account-check-label" for\x3d"share-account-check" class\x3d"labels"\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-groups-div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-groups-div"\x3e\r\n      \x3cinput id\x3d"share-groups-check" data-dojo-attach-point\x3d"shareGroupsCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-groups-check-label" for\x3d"share-groups-check" class\x3d"labels"\x3e${nls.theseGroups}\x3c/label\x3e\r\n      \x3cdiv class\x3d"share-groups-wrapper"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false" design\x3d"headline" class\x3d"borderContainer"\x3e\r\n          \x3cdiv id\x3d"share-groups-list" class\x3d"share-groups-list" dojotype\x3d"dijit.layout.ContentPane" region\x3d"middle" splitter\x3d"false"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ShareLink.html":'\x3cdiv class\x3d"shareLink"\x3e\r\n  \x3cdiv class\x3d"shareLinkOptionsWrapper displaynone"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"backBtn" class\x3d"backBtn"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkOptionsTitle"\x3e${nls.linkOptions}\x3c/div\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.linkOptionsUrlParameters}\x3c/div\x3e\r\n    \x3cform data-id\x3d"shareOptionsRadios" data-dojo-attach-point\x3d"shareOptionsRadios"\x3e\r\n      \x3cfieldset\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"currentMapExtent" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"currentMapExtent" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-props\x3d\'checked:true\' checked\x3e\r\n          \x3cdiv class\x3d"labels" data-forid\x3d"currentMapExtent"\x3e${nls.currentMapExtent}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"chooseCenterWithLevelRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"chooseCenterWithLevel" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithLevel" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels" data-forid\x3d"chooseCenterWithLevel"\x3e${nls.chooseCenterWithLevel}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithLevel_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithLevel_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithLevel_levels" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"chooseCenterWithScale" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithScale" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.chooseCenterWithScale}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithScale_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithScale_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithScale_scales" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"findLocationRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"findLocation" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"findLocation" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.findLocation}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore findLocation_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"findLocation_input" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.findLocation_inputPlaceholder}"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"queryFeature" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"queryFeature" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.queryFeature}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore queryFeature_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"queryFeature_layer" name\x3d"queryFeature_layer" class\x3d"queryFeature_layer"\x3e\x3c/div\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_field" name\x3d"queryFeature_field" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_value" name\x3d"queryFeature_value" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"addMarker" class\x3d"shareRadios jimu-float-leading" type\x3d"radio" name\x3d"radios" data-id\x3d"addMarker" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n          \x3cdiv class\x3d"labels"\x3e${nls.addMarker}\x3c/div\x3e\r\n          \x3cdiv class\x3d"optionsMore addMarker_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"addMarker_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"moreOptions addMarker_moreOptions"\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.WKID}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_spatialReference" name\x3d"spatialReference" data-dojo-type\x3d"dijit.form.TextBox"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.popupTitle}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_title" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_titlePlaceholder}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.symbol}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_symbolURL" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_symbolURL}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e${nls.label}\x3c/label\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"addMarker_label" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_label}"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow displaynone"\x3e\r\n                \x3clabel\x3e${nls.zoomLevel}\x3c/label\x3e\r\n                \x3cdiv class\x3d"table-for-select"\x3e\r\n                  \x3cselect data-dojo-attach-point\x3d"addMarker_level" name\x3d"addMarker_level" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/form\x3e\r\n\r\n    \x3cfieldset\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-overwirteMobileLayout" data-dojo-attach-point\x3d"overwirteMobileLayout" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.overwirteMobileLayout}\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsMore share-options-overwirteMobileLayout_optionsMore"\x3e\r\n          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" required\x3d"true"\r\n                 data-dojo-attach-point\x3d"mobileLayout" data-dojo-props\x3d\'style:{width:"100px"}, constraints:{min:300}\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-language" data-dojo-attach-point\x3d"setlanguage" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.language}\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsMore share-options-language_optionsMore"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"setlanguage_languages" class\x3d"shareSelects" style\x3d"display:inline-block;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cinput data-id\x3d"share-options-auth" data-dojo-attach-point\x3d"auth" class\x3d"shareCheckBoxes jimu-float-leading" data-dojo-type\x3d"dijit.form.CheckBox" type\x3d"checkbox"\x3e\r\n        \x3cdiv class\x3d"labels"\x3e${nls.auth}\x3c/div\x3e\r\n        \x3cdiv  class\x3d"optionsMore share-options-auth_optionsMore"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"authtoken" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv class\x3d"subTitle"\x3e${nls.linkPreview}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"preview" class\x3d"preview inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"shareUrlsWrapper"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"Text"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkShare" data-dojo-attach-point\x3d"LinkShareContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"LinkText" class\x3d"subTitle linkToApp"\x3e${nls.shareLinkText}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_linkUrlTextBox" class\x3d"shareLinkUrl inputsText" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3cdiv class\x3d"shareClearFix"\x3e\r\n        \x3cspan class\x3d"optionsText jimu-float-leading" data-dojo-attach-point\x3d"linkOptions"\x3e${nls.linkOptions}\x3c/span\x3e\r\n        \x3cdiv class\x3d"shareLinkIcons jimu-float-trailing" data-dojo-attach-point\x3d"socialNetworkLinks"\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons email" data-dojo-attach-event\x3d"click:_toEmail" data-dojo-attach-point\x3d"emailShare" title\x3d"${nls.email}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons facebook" data-dojo-attach-event\x3d"click:_toFacebook" data-dojo-attach-point\x3d"FacebookShare" title\x3d"${nls.facebook}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons twitter" data-dojo-attach-event\x3d"click:_toTwitter" data-dojo-attach-point\x3d"TwitterShare" title\x3d"${nls.twitter}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"socialNetworkIcons googlePlus" data-dojo-attach-point\x3d"googlePlusShare" title\x3d"${nls.googlePlus}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"embedShare" data-dojo-attach-point\x3d"EmbedShareContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"embedText" class\x3d"subTitle"\x3e${nls.embed}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"_embedCodeTextArea" class\x3d"shareEmbedCode inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3cdiv class\x3d"moreOptions" data-dojo-attach-event\x3d"click:_moreOptionsExpandCollapse"\x3e\r\n        \x3cdiv class\x3d"moreOptionsIcon" data-dojo-attach-point\x3d"MoreOptionsIcon"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsText"\x3e${nls.more}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"MoreOptionsContainer" class\x3d"moreOptionsContainer inputsText displaynone"\x3e\r\n        \x3cdiv class\x3d"sizeSelect" data-dojo-attach-point\x3d"SizeSelect"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"customSize disable" data-dojo-attach-point\x3d"CustomSizeContainer"\x3e\r\n          \x3cdiv class\x3d"timesConnector"\x3eX\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"shareTips" data-dojo-attach-point\x3d"shareTips"\x3e\r\n      \x3c!--\x3cdiv class\x3d"infoIcon"\x3e\x3c/div\x3e--\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"shareTipsText" class\x3d"shareTipsText"\x3e${nls.shareToWebTips}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n  \x3ctable data-dojo-attach-event\x3d"onclick: _onDropDownClick"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/startup/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"viewStackNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/startup/css/style.css":".plugin-startup\x3e.jimu-viewstack{position: absolute; top: 61px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #f3f3f3;}.plugin-startup .image-404{position: absolute; top: 50%; margin-top: -80px; left: 50%; margin-left: -238px;}",
"url:builder/plugins/theme-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"theme-list" data-dojo-attach-point\x3d"themeList"\x3e\r\n    \x3cdiv class\x3d"theme-title"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separate-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"style-list" data-dojo-attach-point\x3d"styleList"\x3e\r\n    \x3c!--div class\x3d"style-text"\x3e${nls.styleTitle}\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layout-list" data-dojo-attach-point\x3d"layoutList"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"theme-loading-cover" style\x3d"display:none" data-dojo-attach-point\x3d"themeCoverNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ColorRecords.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\t\t\x3ctr tabindex\x3d"0" role\x3d"row" data-dojo-attach-point\x3d"container"\x3e\r\n\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/theme-config/css/style.css":'.plugin-theme-config{overflow: auto; position: relative;}.plugin-theme-config .section {}.plugin-theme-config .theme-section{}.plugin-theme-config .theme-list{overflow: auto; display: none; padding-left: 30px; padding-right: 14px; border: 0px solid;}.jimu-rtl .plugin-theme-config .theme-list{padding-left: 14px; padding-right: 30px;}.plugin-theme-config .theme-title{margin-top: 20px; margin-left: 18px; font-size: 14px; color: #015574;}.plugin-theme-config .theme-catalog{border: 0px solid; display: none; overflow: hidden;}.plugin-theme-config .catalog-theme-content-div{border: 0px solid; width: 33.333%; height: 114px; overflow: hidden;}.plugin-theme-config .catalog-theme-div{position: relative; width: 106px; height: 78px; cursor: pointer; border: 2px solid #ffffff;}.plugin-theme-config .catalog-theme-div:hover{border-color: #24B5CC;}.plugin-theme-config .catalog-theme-selected {border-color: #24B5CC;}.plugin-theme-config .catalog-theme-img-box-div{width: 102px; height: 74px; border: 1px solid #ddd;}.plugin-theme-config .catalog-theme-img-box-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-box-div.selected{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-div{text-align: center; width: 84px; height: 56px; display: block; margin-top: 8px; margin-left: auto; margin-right: auto;}.plugin-theme-config .catalog-theme-img{text-align: center; width: 84px; height: 56px;}.plugin-theme-config .catalog-theme-name-div{border: 0px solid; width: 106px; overflow: hidden; text-align: center; padding-top: 5px; font-size: 12px; color: #333; cursor: default; text-overflow: ellipsis; line-height: 17px;}.plugin-theme-config .theme-cl-selected-div{position: absolute; left: 21px; top: 21px; width: 40px; height: 34px; border: 0px solid; text-align: center; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .theme-cl-selected-img{margin-top: 10px;}.plugin-theme-config .separate-line{margin-left: 10px; margin-right: 10px; border-top: 1px solid #ddd;}.plugin-theme-config .style-list{border: 0px solid; padding-right: 30px; padding-left: 30px;}.plugin-theme-config .style-section{border: 0px solid; overflow: auto;}.plugin-theme-config .style-text{margin-top: 20px; margin-bottom: 15px; font-size: 14px; font-family: "Avenir Medium"}.plugin-theme-config .style-color-content{}.plugin-theme-config .style-div{position: relative; width: 25%; height: 30px; margin-bottom: 12px; cursor: pointer; padding: 4px; background-clip: content-box; border: 2px solid rgba(0,0,0,0);}.plugin-theme-config .style-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .style-image{}.plugin-theme-config .style-selected{border: 2px solid #24B5CC;}.plugin-theme-config .style-selected-div{position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.65); text-align: center; display: none;}.plugin-theme-config .layout-list{border: 0px solid;}.plugin-theme-config .layout-section{border: 0px solid; overflow: hidden; margin-top: 28px; padding-left: 30px;}.jimu-rtl .plugin-theme-config .layout-section{padding-right: 30px; padding-left: auto;}.plugin-theme-config .layout-text{margin-bottom: 16px; font-size: 14px; font-family: "Avenir Medium"}.plugin-theme-config .layout-out-div{position: relative; margin-bottom: 15px; width: 33%;}.plugin-theme-config .layout-box-div{width: 106px; height: 80px; border: 2px solid #ffffff;}.plugin-theme-config .layout-box-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .layout-box-selected{border: 2px solid #24B5CC;}.plugin-theme-config .layout-div{width: 102px; height: 76px; border: 1px solid #ddd; text-align: center; cursor: pointer;}.plugin-theme-config .app-layout{background-color: #6f7e95;}.plugin-theme-config .layout-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .layout-selected{border: 1px solid #ffffff;}.plugin-theme-config .layout-image{width: 80px; height: 54px; margin-top: 10px;}.plugin-theme-config .layout-selected-div{position: absolute; left: 28px; top: 24px; width: 40px; height: 34px; border: 0px solid; text-align: center; padding-top: 6px; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .layout-selected-img{}.plugin-theme-config .theme-loading-cover{position: absolute; z-index: 999; left: 0; right: 0; top: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.3);}.plugin-theme-config .style-div .color-label{margin-top: -8px;}.plugin-theme-config .jimu-color-picker{border-radius: 0;}',
"url:builder/plugins/widget-config/WidgetSettingPage.html":'\x3cdiv class\x3d"widget-setting-page"\x3e\r\n  \x3cdiv class\x3d"section common-setting" data-dojo-attach-point\x3d"commonSettingNode"\x3e\r\n    \x3cdiv class\x3d"basic"\x3e\r\n      \x3cdiv class\x3d"icon jimu-float-leading"\x3e\r\n        \x3cimg class\x3d"real-icon"  data-dojo-attach-point\x3d"iconNode"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"right jimu-float-trailing jimu-leading-margin1"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"labelNode" placeholder\x3d"${nls.widgetLabel}" required\x3d"true" class\x3d"widget-setting-input"\x3e\r\n        \x3cdiv class\x3d"right-foot" data-dojo-attach-point\x3d"rightFooterNode"\x3e\r\n          \x3cdiv class\x3d"image-container"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooserPlaceholder"\x3e\x3c/div\x3e\r\n            \x3c!-- \x3cspan nowrap class\x3d"change-icon" data-dojo-attach-point\x3d"changeNode"\x3e${nls.changeIcon}\x3c/span\x3e --\x3e\r\n            \x3ca class\x3d"help-link jimu-float-trailing" target\x3d"_blank" data-dojo-attach-point\x3d"helpNode"\x3e${nls.more}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layout"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"section widget-setting" data-dojo-attach-point\x3d"widgetSettingNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/GroupSettingPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"label-div"\x3e\r\n    \x3cspan\x3e${nls.label}\x3c/span\x3e\r\n    \x3cinput class\x3d"jimu-input" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/input\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/widget-config/WidgetChoosePage.html":'\x3cdiv class\x3d"widget-choose-page"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"officialSection" class\x3d"official-section"\x3e\r\n    \x3cdiv class\x3d"section search" data-dojo-attach-point\x3d"searchSectionNode"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"searchInputNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"list widget-list" data-dojo-attach-point\x3d"widgetListNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"customSection" class\x3d"custom-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"customSearchInputNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/CustomWidgets.html":'\x3cdiv data-dojo-attach-event\x3d"onscroll:_onScroll"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"list" class\x3d"list widget-list" data-dojo-attach-event\x3d"onclick:_onClick"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"loading" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/widget-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preload-widgets-list" data-dojo-attach-point\x3d"preloadWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"controller-widgets-list" data-dojo-attach-point\x3d"controllerWidgetsNode"\x3e\x3c/div\x3e\r\n    \x3chr  data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"not-removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n    \x3chr  data-dojo-attach-point\x3d"removeableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"removeableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"pool-widgets-list" data-dojo-attach-point\x3d"poolWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"widgets-link" data-dojo-attach-point\x3d"backWidgetsNode" data-dojo-attach-event\x3d"onclick: _onBackWidgetsClick"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"backArrowNode" class\x3d"jimu-float-leading feature-action icon-arrow-back"\x3e\x3c/div\x3e\r\n      \x26nbsp;\r\n      ${nls.widgets}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-title" data-dojo-attach-point\x3d"poolTitleNode"\x3e${nls.setControlledWidgetsBy}\x3cspan data-dojo-attach-point\x3d"controllerLabelNode"\x3e\x3c/span\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-list-wrapper"\x3e\x3cdiv class\x3d"widget-pool-list" data-dojo-attach-point\x3d"poolWidgetsListNode"\x3e\x3c/div\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"offpanel-group-error jimu-state-error" data-dojo-attach-point\x3d"offPanelToGroupErrorNode"\x3e\r\n      \x3cspan class\x3d"jimu-icon jimu-icon-alert"\x3e\x3c/span\x3e\r\n      \x3cspan\x3e${nls.offPanelToGroupError}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/css/style.css":'.json-editor{width: 100%; height: 100%; position: relative;}.app-widgets{width: 100%; height: 100%;}.app-widgets\x3e.jimu-viewstack{width: 100%; height: 100%;}.app-widgets .preload-widgets-list, .app-widgets .pool-widgets-list{position: relative; width: 100%; height: 100%; padding: 10px 0px; -ms-overflow-x: hidden; -ms-overflow-y: auto; overflow-x: hidden; overflow-y: auto;}.app-widgets .preload-widgets-list hr{margin: 10px 15px -5px 15px; border: none; border-top: 1px solid #ddd;}.app-widgets .controller-widget{position: relative; height: 118px; padding-top: 20px;}.app-widgets .controller-widget:hover{background-color: #F3F3F3;}.app-widgets .controller-widget .action-node{position: absolute; left: 96px; top: 20px; height: 74px; right: 0; line-height: 74px; cursor: pointer; font-size: 14px;}.app-widgets .controller-widget .action-node .action-text{white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 230px; font-family: "Avenir Medium"}.app-widgets .controller-widget .action-node .action-arrow{margin-top: 30px;}.app-widgets .not-removeable-onscreen-widgets-list,.app-widgets .removeable-onscreen-widgets-list{position: relative; left: 15px; right: 0; margin-top: 20px;}.app-widgets .widget-pool-list-wrapper{position: absolute; top: 95px; left: 15px; right: 0; bottom: 0; overflow-x: hidden; overflow-y: auto;}.app-widgets .widget-pool-list-wrapper .widget-pool-list{width: 100%; height: 100%;}.app-widgets .pool-widgets-list .offpanel-group-error{position: absolute; z-index: 1; left: 0; top: 42px; height: 30px; line-height: 30px; width: 100%; padding: 0 10px; filter:alpha(opacity\x3d0); opacity: 0;}.app-widgets .widgets-link{font-size: 14px; margin-left: 30px; cursor: pointer; font-family: "Avenir Medium"; margin-top: 20px; color: #333;}.app-widgets .widgets-link:hover{color: black;}.app-widgets .widget-pool-title{margin-top: 15px; font-size: 12px; color: #666; margin-left: 30px;}.app-widgets .moveable{position: absolute; font-size: 12px; float: left; z-index: 3;}.app-widgets .moveable.dojoMoveItem{z-index: 4;}.app-widgets .moveable .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 112px; height: 112px; overflow: hidden; cursor: pointer;}.app-widgets .moveable.placeholder .box{background-color: #bbb; border: 1px solid #bbb;}.app-widgets .moveable.placeholder .box:hover{background-color: #aaa;}.app-widgets .preload-widgets-list .moveable.group-node .box{background-color: #bbb; border: 1px solid #bbb;}.app-widgets .preload-widgets-list .moveable.group-node .box:hover{background-color: #aaa;}.app-widgets .moveable.node-active .box{border: 3px solid #15a4fa;}.app-widgets .moveable .box.jimu-state-active{border: 2px solid red;}.app-widgets .moveable .label{text-align: center; width: 100%; height: 30px; margin-top: 6px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; color: #333;}.app-widgets .moveable .edit-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/edit_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .open-at-start-btn{position: absolute; border-radius: 6px; border: 2px solid white;}.app-widgets .moveable .open-at-start-btn.active{background-color: #336666; filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .open-at-start-btn.deactive{filter:alpha(opacity\x3d50); opacity: 0.5;}.app-widgets .moveable .drop-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/delete_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .switch-btn{position: absolute; border-radius: 2px; background: url(images/eye_open.png) no-repeat center center;}.app-widgets .moveable.hide .switch-btn{background-image: url(images/eye_close.png);}.app-widgets .moveable.hide{opacity: 0.5;}.app-widgets .moveable .edit-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .moveable .open-at-start-btn:hover{filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .drop-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .moveable .switch-btn:hover{background-image: url(images/eye_open_hover.png);}.app-widgets .moveable.hide .switch-btn:hover{background-image: url(images/eye_close_hover.png);}.app-widgets .moveable .switch-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .node-shadow{position: absolute; border: 1px dashed;}.app-widgets .node-margin{position: absolute; z-index: 2;}.app-widgets .node-margin-active{background: red;}.app-widgets .add-widget-node{position: absolute; font-size: 12px; float: left;}.app-widgets .add-widget-node .box{background-color: #fafafc; border: 1px dashed #d2dae2; color: #596679;}.app-widgets .add-widget-node .box:hover{background-color: #eaeaea;}.app-widgets .add-widget-node img{width: 20px; height: 20px; display: block; margin: 27px;}.app-widgets .empty-node .box{opacity: 0; cursor: normal;}.app-widgets .empty-node-active .box{opacity: 0.4;}.app-widgets .widget-node .placeholder{overflow: hidden;}.app-widgets .widget-node .placeholder-inner{text-align: center; color: white; font-size: 14px;}.app-widgets .group-node .small{float: left;}.app-widgets .group-node .add-button{width: 20px; height: 20px; margin: auto; display: block; margin-top: 25px;}.app-widgets .widget-group-panel{position: absolute; background-color: #E3ECF2;}.app-widgets .group-triangle{position: absolute; width: 0px; height: 0px; top: -8px; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 8px solid #E3ECF2;}.widget-setting-popup .content{overflow-y: hidden;}.widget-setting-page{width: 100%; height: 100%;}.widget-setting-page .common-setting{height: 74px; margin-bottom: 20px;}.widget-setting-page .common-setting .basic{overflow: hidden;}.widget-setting-page .common-setting .label input{width: 224px; height: 32px;}.widget-setting-page .opts-section{padding: 5px;}.widget-setting-page .common-setting .icon{background-color: #80C6D1; border: 1px solid #80C6D1; width: 74px; height: 74px; display: inline-block;}.widget-setting-page .common-setting .icon img{width: 40px; height: 40px; margin: 17px;}.widget-setting-page .common-setting .right{font-size: 10px; width: 875px; display: inline-block;}.widget-setting-page .common-setting .right .widget-setting-input{width: 100%; color: black; display: block; background-color: #fafafc;}.widget-setting-page .image-container{overflow:hidden; min-width: 100px; width: 100%; display: inline-block; position: relative; height: 30px; margin-top: 14px;}.widget-setting-page .image-container .help-link{color: #24B5CC; display:none;}.widget-setting-page .image-container .help-link:hover{color: #0090A7;}.widget-setting-page .jimu-image-chooser{height: 30px; padding: 0;}.widget-setting-page .common-setting .right .change-icon{white-space:nowrap; color: white; cursor: pointer; display: inline-block; background-color: #518dca; text-align: center; vertical-align: middle; height: 30px; line-height: 30px; padding-left: 6px; padding-right: 6px; box-shadow: 0 0 2px gray; position: relative;}.widget-setting-page .common-setting .right .disable-change-icon{background-color: #a0acbf; cursor: default;}.widget-setting-page .common-setting .right .more{float: right; color: #15a4fa; display: inline-block; margin-top: 20px;}.widget-setting-page .common-setting .right-foot{position: relative; font-size: 14px;}.widget-setting-page .common-setting .right .state{font-size: 14px; margin-top: 10px;}.widget-setting-page .widget-setting{overflow-x: hidden; overflow-y: auto; position: relative;}.widget-setting-page .widget-default-setting{width: 100%; height: 100%;}.widget-setting-page .opts-section{height: 50px;}.widget-setting-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-setting-page .noconfig-info{font-size: 16px; position: absolute; left: 50%; top: 50%; margin-left: -100px;}.widget-choose-page{width: 100%; height: 100%;}.widget-choose-page \x3e .jimu-tab3 \x3e .container-node{height: 635px; overflow: hidden;}.widget-choose-page .jimu-item-selector .setting-tab-container{height: 98%; margin-top: 2%;}.widget-choose-page .jimu-search{margin: 10px 0;}.widget-choose-page .jimu-search .jimu-input{font-size: 12px;}.widget-choose-page .widget-node{width: 78px; height: 118px; margin: 10px 8px 0 0px; float: left; font-size: 12px; cursor: pointer; position: relative;}.widget-choose-page .widget-node .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 78px; height: 78px; overflow: hidden;}.widget-choose-page .widget-node .box-selected{position: absolute; width: 16px; height: 16px; left: 5px; top: 5px; display: none; background: url(images/checked.svg);}.widget-choose-page .widget-node.jimu-state-selected .box-selected{display: block;}.widget-choose-page .widget-node .icon{width: 32px; height: 32px; display: block; margin: auto; margin-top: 23px;}.widget-choose-page .widget-node .label{text-align: center; width: 100%; height: 30px; margin-top: 10px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.widget-choose-page .search{width: 100%; overflow-x: hidden; overflow-y: hidden;}.widget-choose-page .list{height: 100%; margin-right: -10px; padding-left: 1px; overflow-y: auto; width: 965px;}.widget-choose-page .opts-section{overflow: hidden; margin-top: 10px;}.widget-choose-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-choose-page .custom-section{position: relative;}.widget-choose-page .custom-widgets{display: block; position: absolute; width: 100%; left: 0; right: 0; top: 50px; bottom: 0;}.widget-choose-page .custom-widgets.hidden{display: none;} .group-setting-page {margin: 20px 10px; font-size: 16px;}.group-setting-page .label-div input{margin-left: 10px; color: #000000;}.jimu-rtl .app-widgets .controller-widget .action-node{right: 96px; left: 0;}.jimu-rtl .widget-choose-page .widget-node{margin: 10px 0 0 8px; float: right;}.jimu-rtl .widget-choose-page .list{margin-right: 0; padding-left: 0; overflow-x: hidden;}.jimu-rtl .app-widgets .widgets-link{margin-left: auto; margin-right: 30px;}.jimu-rtl .app-widgets .widget-pool-title{margin-left: auto; margin-right: 30px;}.jimu-rtl .app-widgets .not-removeable-onscreen-widgets-list,.jimu-rtl .app-widgets .removeable-onscreen-widgets-list,.jimu-rtl .app-widgets .widget-pool-list-wrapper{right: 15px; left: 0;}.jimu-rtl .widget-choose-page .widget-node .box-selected{right: 5px; left: auto;}.dj_ie8 .app-widgets .empty-node .box {-ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.dj_ie8 .app-widgets .moveable .edit-btn{-ms-filter: "Alpha(opacity\x3d30)"; filter: Alpha(opacity\x3d30);}.dj_ie8 .app-widgets .moveable .edit-btn:hover{-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60);}.dj_ie8 .app-widgets .moveable.hide {-ms-filter: "Alpha(opacity\x3d50)"; filter: Alpha(opacity\x3d50);}.widget-choose-page.hide-custom-widgets .jimu-tab3{height: 100%;}.widget-choose-page.hide-custom-widgets .jimu-tab3 .control-node{display: none;}.widget-choose-page.hide-custom-widgets .jimu-tab3 .jimu-viewstack{height: 100%;}',
"*now":function(p){p(['dojo/i18n!*preload*builder/nls/main*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/config dojo/_base/html dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/cookie dojo/topic dojo/json dojo/request/script jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/dijit/Message ./tokenUtils ./utils ./PluginManager require esri/request esri/IdentityManager dojo/text!./plugins/plugins.json dojo/i18n!./nls/builder".split(" "),function(p,f,b,m,l,h,r,n,g,e,c,a,u,v,q,k,d,w,t,x,A,y){function z(b){f.setStyle("pre-main-page","display","none");f.setStyle("main-page",
"display","block");window.portalUrl=b.portalUrl;q.setPortalUrl(window.portalUrl);var c=a.getSharingUrl(window.portalUrl);x.checkSignInStatus(c).then(function(){B(b)},function(){if(window.isXT)q.xtGetCredentialFromCookie(window.portalUrl)&&B(b);else{var c=a.getPortalSignInUrlFromLocation(),d=encodeURIComponent(window.location.href);window.location.href=c+"?returnUrl\x3d"+d}})}function C(a){f.create("div",{className:"app-error",innerHTML:a},document.body)}function B(e){var g="";!window.isXT&&window.queryObject&&
(window.queryObject.id&&!/^(stemapp|stemapp3d)$/gi.test(window.queryObject.id)?g=window.queryObject.id:window.queryObject.appid&&(g=window.queryObject.appid));var m=I(),n=G(),t=J(g),v=function(){q.signOutAll();if(window.isXT)window.location.href=window.location.href;else{var b=a.getPortalSignInUrlFromLocation(),c=encodeURIComponent(window.location.href);window.location.href=b+"?returnUrl\x3d"+c}};l([m,n,t]).then(b.hitch(this,function(m){var n=m[1],t=m[2];m[0]&&n?"string"===typeof t?(q.signOutAll(),
C(t)):L(g).then(function(g){if(g){var m=u.getPortal(window.portalUrl);g=m.loadSelfInfo();var n=E(window.portalUrl),t;l([g,n]).then(function(a){t=a[0];window.portalSelf=t;window.isXT?a=k.checkProtocolAndUpdateSigninInfo(t,e):(a=new h,a.resolve({success:!0}));return a}).then(function(g){if(g.success){var h=t.user&&t.user.culture||t.culture||p.locale;h&&(h=h.toLowerCase());g=null;!window.queryObject.locale&&c.isLocaleChanged(p.locale,h)&&(r("wab_locale",h),g=window.location.href);window.isXT&&/[\?|\&](action=)(.+)/gi.test(window.location.href)&&
(g||(g=window.location.href),g=k.removeActionFromUrl(g));h="https:"===window.location.protocol;if(t.allSSL||h)window.portalUrl=e.portalUrl=a.setHttpsProtocol(e.portalUrl);m.portalUrl=window.portalUrl;var l=0===window.portalUrl.toLowerCase().indexOf("https:");!h&&l&&(g||(g=window.location.href),g=g.replace(/^http:/i,"https:"));g?window.location.href=g:(g=H.startup,g.options={signinInfo:e},d.getInstance(H).loadPlugin(g).then(b.hitch(this,function(a){a.placeAt(f.byId("main-page"));a.startup()})))}else console.log("Update signin info error.")})}else C(window.jimuNls.noEditPrivileges),
q.signOutAll()}):v()}),v)}function E(c){var d=a.getSharingUrl(c),e=new h;t({url:d,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0}).then(b.hitch(this,function(b){window.portalVersion=b.currentVersion;a.isOnline(c)?window.isPortalSupport3D=!0:window.isPortalSupport3D=0<=u.comparePortalVersion(window.portalVersion,"3.7");e.resolve()}),b.hitch(this,function(a){console.error(a);e.reject(a)}));return e}function G(){var c=new h,d=q.getPortalCredential(window.portalUrl);d&&
d.token?(d=a.getPortalSelfInfoUrl(window.portalUrl)+"?f\x3djson\x26token\x3d"+d.token,d=a.setHttpsProtocol(d),e.get(d,{handleAs:"json",jsonp:"callback",timeout:6E4}).then(b.hitch(this,function(a){a&&!a.error?c.resolve(!0):c.resolve(!1)}),b.hitch(this,function(a){console.error(a);c.reject(a)}))):c.resolve(!1);return c}function I(){var a=new h;window.isXT?u.getPortal(window.portalUrl).getUser().then(function(c){if(c)if("1"===c.level||1===c.level)var d=new v({message:window.builderNls.userLevelTip,buttons:[{label:window.jimuNls.common.ok,
onClick:b.hitch(this,function(){a.resolve(!1);d.close()})}]});else a.resolve(!0);else a.resolve(!1)},function(b){a.reject(b)}):a.resolve(!0);return a}function J(a){var b=new h;window.isXT?b.resolve(!0):a?u.getPortal(window.portalUrl).getItemById(a).then(function(a){403===a.httpCode&&"GWM_0003"===a.messageCode?b.resolve(a.message):b.resolve(!0)},function(a){a&&403===a.httpCode&&"GWM_0003"===a.messageCode?b.resolve(a.message):b.reject(a)}):b.resolve(!0);return b}function L(){var a=new h;if(window.isXT)a.resolve(!0);
else return u.getPortal(window.portalUrl).getUser().then(function(a){return a?a.canCreateItem():!1});return a}function P(a,b){m.forEach(b,function(b){var d=H[b.pluginName],e;for(e in b.parameters)if(e===a.name){var f=b.parameters[e];c.url.isAbsolute(f)||(b.parameters[e]=d.folderUrl+f)}})}function Q(a){var b=new h;if(!a.parameters||null===g.stringify(a.parameters).match(/\$\{(\w)+\}/g))return b.resolve(!0),b;var e=H[a.pluginName];d.getInstance().loadPluginI18n(e).then(function(d){a.parameters=c.replacePlaceHolder(a.parameters,
d);b.resolve(!0)});return b}var H=g.parse(A);window.builderNls=y;window.pluginsMeta=H;"function"!==typeof r.getAll&&(r.getAll=function(a){var b=[];(a=r(a))&&b.push(a);return b});jimuConfig.layoutId=jimuConfig.mainPageId;n.subscribe("switchToMainPage",function(a){var b=k.removeActionFromUrl(window.location.href);c.changeLocation(b);z(a)});(function(){for(var a in H){var b=H[a];b.amdFolder="builder/plugins/"+a.replace(/\./g,"/")+"/";b.folderUrl=w.toUrl(b.amdFolder);b.uri=b.amdFolder+"Plugin"}a=[];for(var c in H){var b=
H[c],d;for(d in b.extensionPoints){var e=b.extensionPoints[d],f;for(f in e.parameters){var g=e.parameters[f];"url"===g.type&&P(g,e.extensions)}if(e.extensions)for(g=0;g<e.extensions.length;g++)a.push(Q(e.extensions[g]))}}return l(a)})().then(function(){f.setStyle("main-loading","display","none");window.isXT?w(["./xtMain"]):n.publish("switchToMainPage",{portalUrl:a.getPortalUrlFromLocation()})})});